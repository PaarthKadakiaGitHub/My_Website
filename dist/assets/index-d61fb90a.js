var Ase=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var CWe=Ase((Qo,Ko)=>{function Mse(t,e){for(var i=0;i<e.length;i++){const n=e[i];if(typeof n!="string"&&!Array.isArray(n)){for(const r in n)if(r!=="default"&&!(r in t)){const s=Object.getOwnPropertyDescriptor(n,r);s&&Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:()=>n[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function i(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=i(r);fetch(r.href,s)}})();function xF(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var PX={exports:{}},WT={},DX={exports:{}},gi={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rw=Symbol.for("react.element"),Ese=Symbol.for("react.portal"),Tse=Symbol.for("react.fragment"),Cse=Symbol.for("react.strict_mode"),Pse=Symbol.for("react.profiler"),Dse=Symbol.for("react.provider"),Rse=Symbol.for("react.context"),Ise=Symbol.for("react.forward_ref"),Lse=Symbol.for("react.suspense"),Bse=Symbol.for("react.memo"),Ose=Symbol.for("react.lazy"),fG=Symbol.iterator;function Fse(t){return t===null||typeof t!="object"?null:(t=fG&&t[fG]||t["@@iterator"],typeof t=="function"?t:null)}var RX={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},IX=Object.assign,LX={};function J0(t,e,i){this.props=t,this.context=e,this.refs=LX,this.updater=i||RX}J0.prototype.isReactComponent={};J0.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};J0.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function BX(){}BX.prototype=J0.prototype;function _F(t,e,i){this.props=t,this.context=e,this.refs=LX,this.updater=i||RX}var wF=_F.prototype=new BX;wF.constructor=_F;IX(wF,J0.prototype);wF.isPureReactComponent=!0;var pG=Array.isArray,OX=Object.prototype.hasOwnProperty,bF={current:null},FX={key:!0,ref:!0,__self:!0,__source:!0};function NX(t,e,i){var n,r={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)OX.call(e,n)&&!FX.hasOwnProperty(n)&&(r[n]=e[n]);var a=arguments.length-2;if(a===1)r.children=i;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(n in a=t.defaultProps,a)r[n]===void 0&&(r[n]=a[n]);return{$$typeof:rw,type:t,key:s,ref:o,props:r,_owner:bF.current}}function Nse(t,e){return{$$typeof:rw,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function SF(t){return typeof t=="object"&&t!==null&&t.$$typeof===rw}function Use(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(i){return e[i]})}var mG=/\/+/g;function TP(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Use(""+t.key):e.toString(36)}function dM(t,e,i,n,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case rw:case Ese:o=!0}}if(o)return o=t,r=r(o),t=n===""?"."+TP(o,0):n,pG(r)?(i="",t!=null&&(i=t.replace(mG,"$&/")+"/"),dM(r,e,i,"",function(c){return c})):r!=null&&(SF(r)&&(r=Nse(r,i+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(mG,"$&/")+"/")+t)),e.push(r)),1;if(o=0,n=n===""?".":n+":",pG(t))for(var a=0;a<t.length;a++){s=t[a];var l=n+TP(s,a);o+=dM(s,e,i,l,r)}else if(l=Fse(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=n+TP(s,a++),o+=dM(s,e,i,l,r);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Fb(t,e,i){if(t==null)return t;var n=[],r=0;return dM(t,n,"","",function(s){return e.call(i,s,r++)}),n}function kse(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(i){(t._status===0||t._status===-1)&&(t._status=1,t._result=i)},function(i){(t._status===0||t._status===-1)&&(t._status=2,t._result=i)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Xs={current:null},fM={transition:null},zse={ReactCurrentDispatcher:Xs,ReactCurrentBatchConfig:fM,ReactCurrentOwner:bF};gi.Children={map:Fb,forEach:function(t,e,i){Fb(t,function(){e.apply(this,arguments)},i)},count:function(t){var e=0;return Fb(t,function(){e++}),e},toArray:function(t){return Fb(t,function(e){return e})||[]},only:function(t){if(!SF(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};gi.Component=J0;gi.Fragment=Tse;gi.Profiler=Pse;gi.PureComponent=_F;gi.StrictMode=Cse;gi.Suspense=Lse;gi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zse;gi.cloneElement=function(t,e,i){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=IX({},t.props),r=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=bF.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)OX.call(e,l)&&!FX.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=i;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];n.children=a}return{$$typeof:rw,type:t.type,key:r,ref:s,props:n,_owner:o}};gi.createContext=function(t){return t={$$typeof:Rse,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Dse,_context:t},t.Consumer=t};gi.createElement=NX;gi.createFactory=function(t){var e=NX.bind(null,t);return e.type=t,e};gi.createRef=function(){return{current:null}};gi.forwardRef=function(t){return{$$typeof:Ise,render:t}};gi.isValidElement=SF;gi.lazy=function(t){return{$$typeof:Ose,_payload:{_status:-1,_result:t},_init:kse}};gi.memo=function(t,e){return{$$typeof:Bse,type:t,compare:e===void 0?null:e}};gi.startTransition=function(t){var e=fM.transition;fM.transition={};try{t()}finally{fM.transition=e}};gi.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};gi.useCallback=function(t,e){return Xs.current.useCallback(t,e)};gi.useContext=function(t){return Xs.current.useContext(t)};gi.useDebugValue=function(){};gi.useDeferredValue=function(t){return Xs.current.useDeferredValue(t)};gi.useEffect=function(t,e){return Xs.current.useEffect(t,e)};gi.useId=function(){return Xs.current.useId()};gi.useImperativeHandle=function(t,e,i){return Xs.current.useImperativeHandle(t,e,i)};gi.useInsertionEffect=function(t,e){return Xs.current.useInsertionEffect(t,e)};gi.useLayoutEffect=function(t,e){return Xs.current.useLayoutEffect(t,e)};gi.useMemo=function(t,e){return Xs.current.useMemo(t,e)};gi.useReducer=function(t,e,i){return Xs.current.useReducer(t,e,i)};gi.useRef=function(t){return Xs.current.useRef(t)};gi.useState=function(t){return Xs.current.useState(t)};gi.useSyncExternalStore=function(t,e,i){return Xs.current.useSyncExternalStore(t,e,i)};gi.useTransition=function(){return Xs.current.useTransition()};gi.version="18.2.0";DX.exports=gi;var ye=DX.exports;const Ul=xF(ye),Gse=Mse({__proto__:null,default:Ul},[ye]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hse=ye,Vse=Symbol.for("react.element"),jse=Symbol.for("react.fragment"),Wse=Object.prototype.hasOwnProperty,Xse=Hse.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qse={key:!0,ref:!0,__self:!0,__source:!0};function UX(t,e,i){var n,r={},s=null,o=null;i!==void 0&&(s=""+i),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)Wse.call(e,n)&&!qse.hasOwnProperty(n)&&(r[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)r[n]===void 0&&(r[n]=e[n]);return{$$typeof:Vse,type:t,key:s,ref:o,props:r,_owner:Xse.current}}WT.Fragment=jse;WT.jsx=UX;WT.jsxs=UX;PX.exports=WT;var rt=PX.exports,dI={},kX={exports:{}},aa={},zX={exports:{}},GX={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(B,j){var z=B.length;B.push(j);e:for(;0<z;){var k=z-1>>>1,G=B[k];if(0<r(G,j))B[k]=j,B[z]=G,z=k;else break e}}function i(B){return B.length===0?null:B[0]}function n(B){if(B.length===0)return null;var j=B[0],z=B.pop();if(z!==j){B[0]=z;e:for(var k=0,G=B.length,Z=G>>>1;k<Z;){var K=2*(k+1)-1,re=B[K],J=K+1,le=B[J];if(0>r(re,z))J<G&&0>r(le,re)?(B[k]=le,B[J]=z,k=J):(B[k]=re,B[K]=z,k=K);else if(J<G&&0>r(le,z))B[k]=le,B[J]=z,k=J;else break e}}return j}function r(B,j){var z=B.sortIndex-j.sortIndex;return z!==0?z:B.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,u=null,d=3,f=!1,p=!1,m=!1,v=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(B){for(var j=i(c);j!==null;){if(j.callback===null)n(c);else if(j.startTime<=B)n(c),j.sortIndex=j.expirationTime,e(l,j);else break;j=i(c)}}function b(B){if(m=!1,x(B),!p)if(i(l)!==null)p=!0,Q(S);else{var j=i(c);j!==null&&X(b,j.startTime-B)}}function S(B,j){p=!1,m&&(m=!1,g(M),M=-1),f=!0;var z=d;try{for(x(j),u=i(l);u!==null&&(!(u.expirationTime>j)||B&&!R());){var k=u.callback;if(typeof k=="function"){u.callback=null,d=u.priorityLevel;var G=k(u.expirationTime<=j);j=t.unstable_now(),typeof G=="function"?u.callback=G:u===i(l)&&n(l),x(j)}else n(l);u=i(l)}if(u!==null)var Z=!0;else{var K=i(c);K!==null&&X(b,K.startTime-j),Z=!1}return Z}finally{u=null,d=z,f=!1}}var A=!1,E=null,M=-1,T=5,P=-1;function R(){return!(t.unstable_now()-P<T)}function U(){if(E!==null){var B=t.unstable_now();P=B;var j=!0;try{j=E(!0,B)}finally{j?F():(A=!1,E=null)}}else A=!1}var F;if(typeof y=="function")F=function(){y(U)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,W=N.port2;N.port1.onmessage=U,F=function(){W.postMessage(null)}}else F=function(){v(U,0)};function Q(B){E=B,A||(A=!0,F())}function X(B,j){M=v(function(){B(t.unstable_now())},j)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,Q(S))},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return i(l)},t.unstable_next=function(B){switch(d){case 1:case 2:case 3:var j=3;break;default:j=d}var z=d;d=j;try{return B()}finally{d=z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(B,j){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var z=d;d=B;try{return j()}finally{d=z}},t.unstable_scheduleCallback=function(B,j,z){var k=t.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?k+z:k):z=k,B){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=z+G,B={id:h++,callback:j,priorityLevel:B,startTime:z,expirationTime:G,sortIndex:-1},z>k?(B.sortIndex=z,e(c,B),i(l)===null&&B===i(c)&&(m?(g(M),M=-1):m=!0,X(b,z-k))):(B.sortIndex=G,e(l,B),p||f||(p=!0,Q(S))),B},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(B){var j=d;return function(){var z=d;d=j;try{return B.apply(this,arguments)}finally{d=z}}}})(GX);zX.exports=GX;var Yse=zX.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HX=ye,ta=Yse;function it(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var VX=new Set,$1={};function dm(t,e){s0(t,e),s0(t+"Capture",e)}function s0(t,e){for($1[t]=e,t=0;t<e.length;t++)VX.add(e[t])}var sh=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fI=Object.prototype.hasOwnProperty,Qse=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,gG={},vG={};function Kse(t){return fI.call(vG,t)?!0:fI.call(gG,t)?!1:Qse.test(t)?vG[t]=!0:(gG[t]=!0,!1)}function Jse(t,e,i,n){if(i!==null&&i.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:i!==null?!i.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Zse(t,e,i,n){if(e===null||typeof e>"u"||Jse(t,e,i,n))return!0;if(n)return!1;if(i!==null)switch(i.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function qs(t,e,i,n,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=i,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var ts={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ts[t]=new qs(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ts[e]=new qs(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ts[t]=new qs(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ts[t]=new qs(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ts[t]=new qs(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ts[t]=new qs(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ts[t]=new qs(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ts[t]=new qs(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ts[t]=new qs(t,5,!1,t.toLowerCase(),null,!1,!1)});var AF=/[\-:]([a-z])/g;function MF(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(AF,MF);ts[e]=new qs(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(AF,MF);ts[e]=new qs(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(AF,MF);ts[e]=new qs(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ts[t]=new qs(t,1,!1,t.toLowerCase(),null,!1,!1)});ts.xlinkHref=new qs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ts[t]=new qs(t,1,!1,t.toLowerCase(),null,!0,!0)});function EF(t,e,i,n){var r=ts.hasOwnProperty(e)?ts[e]:null;(r!==null?r.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Zse(e,i,r,n)&&(i=null),n||r===null?Kse(e)&&(i===null?t.removeAttribute(e):t.setAttribute(e,""+i)):r.mustUseProperty?t[r.propertyName]=i===null?r.type===3?!1:"":i:(e=r.attributeName,n=r.attributeNamespace,i===null?t.removeAttribute(e):(r=r.type,i=r===3||r===4&&i===!0?"":""+i,n?t.setAttributeNS(n,e,i):t.setAttribute(e,i))))}var gh=HX.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Nb=Symbol.for("react.element"),$g=Symbol.for("react.portal"),ev=Symbol.for("react.fragment"),TF=Symbol.for("react.strict_mode"),pI=Symbol.for("react.profiler"),jX=Symbol.for("react.provider"),WX=Symbol.for("react.context"),CF=Symbol.for("react.forward_ref"),mI=Symbol.for("react.suspense"),gI=Symbol.for("react.suspense_list"),PF=Symbol.for("react.memo"),Zh=Symbol.for("react.lazy"),XX=Symbol.for("react.offscreen"),yG=Symbol.iterator;function jy(t){return t===null||typeof t!="object"?null:(t=yG&&t[yG]||t["@@iterator"],typeof t=="function"?t:null)}var En=Object.assign,CP;function Yx(t){if(CP===void 0)try{throw Error()}catch(i){var e=i.stack.trim().match(/\n( *(at )?)/);CP=e&&e[1]||""}return`
`+CP+t}var PP=!1;function DP(t,e){if(!t||PP)return"";PP=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),s=n.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{PP=!1,Error.prepareStackTrace=i}return(t=t?t.displayName||t.name:"")?Yx(t):""}function $se(t){switch(t.tag){case 5:return Yx(t.type);case 16:return Yx("Lazy");case 13:return Yx("Suspense");case 19:return Yx("SuspenseList");case 0:case 2:case 15:return t=DP(t.type,!1),t;case 11:return t=DP(t.type.render,!1),t;case 1:return t=DP(t.type,!0),t;default:return""}}function vI(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ev:return"Fragment";case $g:return"Portal";case pI:return"Profiler";case TF:return"StrictMode";case mI:return"Suspense";case gI:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case WX:return(t.displayName||"Context")+".Consumer";case jX:return(t._context.displayName||"Context")+".Provider";case CF:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case PF:return e=t.displayName||null,e!==null?e:vI(t.type)||"Memo";case Zh:e=t._payload,t=t._init;try{return vI(t(e))}catch{}}return null}function eoe(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return vI(e);case 8:return e===TF?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function jd(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function qX(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function toe(t){var e=qX(t)?"checked":"value",i=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var r=i.get,s=i.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ub(t){t._valueTracker||(t._valueTracker=toe(t))}function YX(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var i=e.getValue(),n="";return t&&(n=qX(t)?t.checked?"true":"false":t.value),t=n,t!==i?(e.setValue(t),!0):!1}function ZM(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function yI(t,e){var i=e.checked;return En({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??t._wrapperState.initialChecked})}function xG(t,e){var i=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;i=jd(e.value!=null?e.value:i),t._wrapperState={initialChecked:n,initialValue:i,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function QX(t,e){e=e.checked,e!=null&&EF(t,"checked",e,!1)}function xI(t,e){QX(t,e);var i=jd(e.value),n=e.type;if(i!=null)n==="number"?(i===0&&t.value===""||t.value!=i)&&(t.value=""+i):t.value!==""+i&&(t.value=""+i);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?_I(t,e.type,i):e.hasOwnProperty("defaultValue")&&_I(t,e.type,jd(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function _G(t,e,i){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,i||e===t.value||(t.value=e),t.defaultValue=e}i=t.name,i!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,i!==""&&(t.name=i)}function _I(t,e,i){(e!=="number"||ZM(t.ownerDocument)!==t)&&(i==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+i&&(t.defaultValue=""+i))}var Qx=Array.isArray;function Rv(t,e,i,n){if(t=t.options,e){e={};for(var r=0;r<i.length;r++)e["$"+i[r]]=!0;for(i=0;i<t.length;i++)r=e.hasOwnProperty("$"+t[i].value),t[i].selected!==r&&(t[i].selected=r),r&&n&&(t[i].defaultSelected=!0)}else{for(i=""+jd(i),e=null,r=0;r<t.length;r++){if(t[r].value===i){t[r].selected=!0,n&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function wI(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(it(91));return En({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function wG(t,e){var i=e.value;if(i==null){if(i=e.children,e=e.defaultValue,i!=null){if(e!=null)throw Error(it(92));if(Qx(i)){if(1<i.length)throw Error(it(93));i=i[0]}e=i}e==null&&(e=""),i=e}t._wrapperState={initialValue:jd(i)}}function KX(t,e){var i=jd(e.value),n=jd(e.defaultValue);i!=null&&(i=""+i,i!==t.value&&(t.value=i),e.defaultValue==null&&t.defaultValue!==i&&(t.defaultValue=i)),n!=null&&(t.defaultValue=""+n)}function bG(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function JX(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bI(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?JX(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var kb,ZX=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,i,n,r){MSApp.execUnsafeLocalFunction(function(){return t(e,i,n,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(kb=kb||document.createElement("div"),kb.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=kb.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function e_(t,e){if(e){var i=t.firstChild;if(i&&i===t.lastChild&&i.nodeType===3){i.nodeValue=e;return}}t.textContent=e}var p1={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ioe=["Webkit","ms","Moz","O"];Object.keys(p1).forEach(function(t){ioe.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),p1[e]=p1[t]})});function $X(t,e,i){return e==null||typeof e=="boolean"||e===""?"":i||typeof e!="number"||e===0||p1.hasOwnProperty(t)&&p1[t]?(""+e).trim():e+"px"}function eq(t,e){t=t.style;for(var i in e)if(e.hasOwnProperty(i)){var n=i.indexOf("--")===0,r=$X(i,e[i],n);i==="float"&&(i="cssFloat"),n?t.setProperty(i,r):t[i]=r}}var noe=En({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function SI(t,e){if(e){if(noe[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(it(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(it(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(it(61))}if(e.style!=null&&typeof e.style!="object")throw Error(it(62))}}function AI(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var MI=null;function DF(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var EI=null,Iv=null,Lv=null;function SG(t){if(t=aw(t)){if(typeof EI!="function")throw Error(it(280));var e=t.stateNode;e&&(e=KT(e),EI(t.stateNode,t.type,e))}}function tq(t){Iv?Lv?Lv.push(t):Lv=[t]:Iv=t}function iq(){if(Iv){var t=Iv,e=Lv;if(Lv=Iv=null,SG(t),e)for(t=0;t<e.length;t++)SG(e[t])}}function nq(t,e){return t(e)}function rq(){}var RP=!1;function sq(t,e,i){if(RP)return t(e,i);RP=!0;try{return nq(t,e,i)}finally{RP=!1,(Iv!==null||Lv!==null)&&(rq(),iq())}}function t_(t,e){var i=t.stateNode;if(i===null)return null;var n=KT(i);if(n===null)return null;i=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(i&&typeof i!="function")throw Error(it(231,e,typeof i));return i}var TI=!1;if(sh)try{var Wy={};Object.defineProperty(Wy,"passive",{get:function(){TI=!0}}),window.addEventListener("test",Wy,Wy),window.removeEventListener("test",Wy,Wy)}catch{TI=!1}function roe(t,e,i,n,r,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(i,c)}catch(h){this.onError(h)}}var m1=!1,$M=null,eE=!1,CI=null,soe={onError:function(t){m1=!0,$M=t}};function ooe(t,e,i,n,r,s,o,a,l){m1=!1,$M=null,roe.apply(soe,arguments)}function aoe(t,e,i,n,r,s,o,a,l){if(ooe.apply(this,arguments),m1){if(m1){var c=$M;m1=!1,$M=null}else throw Error(it(198));eE||(eE=!0,CI=c)}}function fm(t){var e=t,i=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(i=e.return),t=e.return;while(t)}return e.tag===3?i:null}function oq(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function AG(t){if(fm(t)!==t)throw Error(it(188))}function loe(t){var e=t.alternate;if(!e){if(e=fm(t),e===null)throw Error(it(188));return e!==t?null:t}for(var i=t,n=e;;){var r=i.return;if(r===null)break;var s=r.alternate;if(s===null){if(n=r.return,n!==null){i=n;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===i)return AG(r),t;if(s===n)return AG(r),e;s=s.sibling}throw Error(it(188))}if(i.return!==n.return)i=r,n=s;else{for(var o=!1,a=r.child;a;){if(a===i){o=!0,i=r,n=s;break}if(a===n){o=!0,n=r,i=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===i){o=!0,i=s,n=r;break}if(a===n){o=!0,n=s,i=r;break}a=a.sibling}if(!o)throw Error(it(189))}}if(i.alternate!==n)throw Error(it(190))}if(i.tag!==3)throw Error(it(188));return i.stateNode.current===i?t:e}function aq(t){return t=loe(t),t!==null?lq(t):null}function lq(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=lq(t);if(e!==null)return e;t=t.sibling}return null}var cq=ta.unstable_scheduleCallback,MG=ta.unstable_cancelCallback,coe=ta.unstable_shouldYield,uoe=ta.unstable_requestPaint,Yn=ta.unstable_now,hoe=ta.unstable_getCurrentPriorityLevel,RF=ta.unstable_ImmediatePriority,uq=ta.unstable_UserBlockingPriority,tE=ta.unstable_NormalPriority,doe=ta.unstable_LowPriority,hq=ta.unstable_IdlePriority,XT=null,Oc=null;function foe(t){if(Oc&&typeof Oc.onCommitFiberRoot=="function")try{Oc.onCommitFiberRoot(XT,t,void 0,(t.current.flags&128)===128)}catch{}}var Rl=Math.clz32?Math.clz32:goe,poe=Math.log,moe=Math.LN2;function goe(t){return t>>>=0,t===0?32:31-(poe(t)/moe|0)|0}var zb=64,Gb=4194304;function Kx(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function iE(t,e){var i=t.pendingLanes;if(i===0)return 0;var n=0,r=t.suspendedLanes,s=t.pingedLanes,o=i&268435455;if(o!==0){var a=o&~r;a!==0?n=Kx(a):(s&=o,s!==0&&(n=Kx(s)))}else o=i&~r,o!==0?n=Kx(o):s!==0&&(n=Kx(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&r)&&(r=n&-n,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(n&4&&(n|=i&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)i=31-Rl(e),r=1<<i,n|=t[i],e&=~r;return n}function voe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yoe(t,e){for(var i=t.suspendedLanes,n=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Rl(s),a=1<<o,l=r[o];l===-1?(!(a&i)||a&n)&&(r[o]=voe(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function PI(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function dq(){var t=zb;return zb<<=1,!(zb&4194240)&&(zb=64),t}function IP(t){for(var e=[],i=0;31>i;i++)e.push(t);return e}function sw(t,e,i){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Rl(e),t[e]=i}function xoe(t,e){var i=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<i;){var r=31-Rl(i),s=1<<r;e[r]=0,n[r]=-1,t[r]=-1,i&=~s}}function IF(t,e){var i=t.entangledLanes|=e;for(t=t.entanglements;i;){var n=31-Rl(i),r=1<<n;r&e|t[n]&e&&(t[n]|=e),i&=~r}}var Vi=0;function fq(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var pq,LF,mq,gq,vq,DI=!1,Hb=[],wd=null,bd=null,Sd=null,i_=new Map,n_=new Map,rd=[],_oe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function EG(t,e){switch(t){case"focusin":case"focusout":wd=null;break;case"dragenter":case"dragleave":bd=null;break;case"mouseover":case"mouseout":Sd=null;break;case"pointerover":case"pointerout":i_.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":n_.delete(e.pointerId)}}function Xy(t,e,i,n,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:i,eventSystemFlags:n,nativeEvent:s,targetContainers:[r]},e!==null&&(e=aw(e),e!==null&&LF(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function woe(t,e,i,n,r){switch(e){case"focusin":return wd=Xy(wd,t,e,i,n,r),!0;case"dragenter":return bd=Xy(bd,t,e,i,n,r),!0;case"mouseover":return Sd=Xy(Sd,t,e,i,n,r),!0;case"pointerover":var s=r.pointerId;return i_.set(s,Xy(i_.get(s)||null,t,e,i,n,r)),!0;case"gotpointercapture":return s=r.pointerId,n_.set(s,Xy(n_.get(s)||null,t,e,i,n,r)),!0}return!1}function yq(t){var e=dp(t.target);if(e!==null){var i=fm(e);if(i!==null){if(e=i.tag,e===13){if(e=oq(i),e!==null){t.blockedOn=e,vq(t.priority,function(){mq(i)});return}}else if(e===3&&i.stateNode.current.memoizedState.isDehydrated){t.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}t.blockedOn=null}function pM(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var i=RI(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(i===null){i=t.nativeEvent;var n=new i.constructor(i.type,i);MI=n,i.target.dispatchEvent(n),MI=null}else return e=aw(i),e!==null&&LF(e),t.blockedOn=i,!1;e.shift()}return!0}function TG(t,e,i){pM(t)&&i.delete(e)}function boe(){DI=!1,wd!==null&&pM(wd)&&(wd=null),bd!==null&&pM(bd)&&(bd=null),Sd!==null&&pM(Sd)&&(Sd=null),i_.forEach(TG),n_.forEach(TG)}function qy(t,e){t.blockedOn===e&&(t.blockedOn=null,DI||(DI=!0,ta.unstable_scheduleCallback(ta.unstable_NormalPriority,boe)))}function r_(t){function e(r){return qy(r,t)}if(0<Hb.length){qy(Hb[0],t);for(var i=1;i<Hb.length;i++){var n=Hb[i];n.blockedOn===t&&(n.blockedOn=null)}}for(wd!==null&&qy(wd,t),bd!==null&&qy(bd,t),Sd!==null&&qy(Sd,t),i_.forEach(e),n_.forEach(e),i=0;i<rd.length;i++)n=rd[i],n.blockedOn===t&&(n.blockedOn=null);for(;0<rd.length&&(i=rd[0],i.blockedOn===null);)yq(i),i.blockedOn===null&&rd.shift()}var Bv=gh.ReactCurrentBatchConfig,nE=!0;function Soe(t,e,i,n){var r=Vi,s=Bv.transition;Bv.transition=null;try{Vi=1,BF(t,e,i,n)}finally{Vi=r,Bv.transition=s}}function Aoe(t,e,i,n){var r=Vi,s=Bv.transition;Bv.transition=null;try{Vi=4,BF(t,e,i,n)}finally{Vi=r,Bv.transition=s}}function BF(t,e,i,n){if(nE){var r=RI(t,e,i,n);if(r===null)HP(t,e,n,rE,i),EG(t,n);else if(woe(r,t,e,i,n))n.stopPropagation();else if(EG(t,n),e&4&&-1<_oe.indexOf(t)){for(;r!==null;){var s=aw(r);if(s!==null&&pq(s),s=RI(t,e,i,n),s===null&&HP(t,e,n,rE,i),s===r)break;r=s}r!==null&&n.stopPropagation()}else HP(t,e,n,null,i)}}var rE=null;function RI(t,e,i,n){if(rE=null,t=DF(n),t=dp(t),t!==null)if(e=fm(t),e===null)t=null;else if(i=e.tag,i===13){if(t=oq(e),t!==null)return t;t=null}else if(i===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return rE=t,null}function xq(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hoe()){case RF:return 1;case uq:return 4;case tE:case doe:return 16;case hq:return 536870912;default:return 16}default:return 16}}var cd=null,OF=null,mM=null;function _q(){if(mM)return mM;var t,e=OF,i=e.length,n,r="value"in cd?cd.value:cd.textContent,s=r.length;for(t=0;t<i&&e[t]===r[t];t++);var o=i-t;for(n=1;n<=o&&e[i-n]===r[s-n];n++);return mM=r.slice(t,1<n?1-n:void 0)}function gM(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Vb(){return!0}function CG(){return!1}function la(t){function e(i,n,r,s,o){this._reactName=i,this._targetInst=r,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(i=t[a],this[a]=i?i(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Vb:CG,this.isPropagationStopped=CG,this}return En(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=Vb)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=Vb)},persist:function(){},isPersistent:Vb}),e}var Z0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},FF=la(Z0),ow=En({},Z0,{view:0,detail:0}),Moe=la(ow),LP,BP,Yy,qT=En({},ow,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:NF,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Yy&&(Yy&&t.type==="mousemove"?(LP=t.screenX-Yy.screenX,BP=t.screenY-Yy.screenY):BP=LP=0,Yy=t),LP)},movementY:function(t){return"movementY"in t?t.movementY:BP}}),PG=la(qT),Eoe=En({},qT,{dataTransfer:0}),Toe=la(Eoe),Coe=En({},ow,{relatedTarget:0}),OP=la(Coe),Poe=En({},Z0,{animationName:0,elapsedTime:0,pseudoElement:0}),Doe=la(Poe),Roe=En({},Z0,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Ioe=la(Roe),Loe=En({},Z0,{data:0}),DG=la(Loe),Boe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ooe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Foe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Noe(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Foe[t])?!!e[t]:!1}function NF(){return Noe}var Uoe=En({},ow,{key:function(t){if(t.key){var e=Boe[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=gM(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Ooe[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:NF,charCode:function(t){return t.type==="keypress"?gM(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?gM(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),koe=la(Uoe),zoe=En({},qT,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),RG=la(zoe),Goe=En({},ow,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:NF}),Hoe=la(Goe),Voe=En({},Z0,{propertyName:0,elapsedTime:0,pseudoElement:0}),joe=la(Voe),Woe=En({},qT,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Xoe=la(Woe),qoe=[9,13,27,32],UF=sh&&"CompositionEvent"in window,g1=null;sh&&"documentMode"in document&&(g1=document.documentMode);var Yoe=sh&&"TextEvent"in window&&!g1,wq=sh&&(!UF||g1&&8<g1&&11>=g1),IG=String.fromCharCode(32),LG=!1;function bq(t,e){switch(t){case"keyup":return qoe.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Sq(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var tv=!1;function Qoe(t,e){switch(t){case"compositionend":return Sq(e);case"keypress":return e.which!==32?null:(LG=!0,IG);case"textInput":return t=e.data,t===IG&&LG?null:t;default:return null}}function Koe(t,e){if(tv)return t==="compositionend"||!UF&&bq(t,e)?(t=_q(),mM=OF=cd=null,tv=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return wq&&e.locale!=="ko"?null:e.data;default:return null}}var Joe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function BG(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Joe[t.type]:e==="textarea"}function Aq(t,e,i,n){tq(n),e=sE(e,"onChange"),0<e.length&&(i=new FF("onChange","change",null,i,n),t.push({event:i,listeners:e}))}var v1=null,s_=null;function Zoe(t){Oq(t,0)}function YT(t){var e=rv(t);if(YX(e))return t}function $oe(t,e){if(t==="change")return e}var Mq=!1;if(sh){var FP;if(sh){var NP="oninput"in document;if(!NP){var OG=document.createElement("div");OG.setAttribute("oninput","return;"),NP=typeof OG.oninput=="function"}FP=NP}else FP=!1;Mq=FP&&(!document.documentMode||9<document.documentMode)}function FG(){v1&&(v1.detachEvent("onpropertychange",Eq),s_=v1=null)}function Eq(t){if(t.propertyName==="value"&&YT(s_)){var e=[];Aq(e,s_,t,DF(t)),sq(Zoe,e)}}function eae(t,e,i){t==="focusin"?(FG(),v1=e,s_=i,v1.attachEvent("onpropertychange",Eq)):t==="focusout"&&FG()}function tae(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return YT(s_)}function iae(t,e){if(t==="click")return YT(e)}function nae(t,e){if(t==="input"||t==="change")return YT(e)}function rae(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var kl=typeof Object.is=="function"?Object.is:rae;function o_(t,e){if(kl(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var i=Object.keys(t),n=Object.keys(e);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++){var r=i[n];if(!fI.call(e,r)||!kl(t[r],e[r]))return!1}return!0}function NG(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function UG(t,e){var i=NG(t);t=0;for(var n;i;){if(i.nodeType===3){if(n=t+i.textContent.length,t<=e&&n>=e)return{node:i,offset:e-t};t=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=NG(i)}}function Tq(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Tq(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Cq(){for(var t=window,e=ZM();e instanceof t.HTMLIFrameElement;){try{var i=typeof e.contentWindow.location.href=="string"}catch{i=!1}if(i)t=e.contentWindow;else break;e=ZM(t.document)}return e}function kF(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function sae(t){var e=Cq(),i=t.focusedElem,n=t.selectionRange;if(e!==i&&i&&i.ownerDocument&&Tq(i.ownerDocument.documentElement,i)){if(n!==null&&kF(i)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in i)i.selectionStart=e,i.selectionEnd=Math.min(t,i.value.length);else if(t=(e=i.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=i.textContent.length,s=Math.min(n.start,r);n=n.end===void 0?s:Math.min(n.end,r),!t.extend&&s>n&&(r=n,n=s,s=r),r=UG(i,s);var o=UG(i,n);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=i;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<e.length;i++)t=e[i],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var oae=sh&&"documentMode"in document&&11>=document.documentMode,iv=null,II=null,y1=null,LI=!1;function kG(t,e,i){var n=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;LI||iv==null||iv!==ZM(n)||(n=iv,"selectionStart"in n&&kF(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),y1&&o_(y1,n)||(y1=n,n=sE(II,"onSelect"),0<n.length&&(e=new FF("onSelect","select",null,e,i),t.push({event:e,listeners:n}),e.target=iv)))}function jb(t,e){var i={};return i[t.toLowerCase()]=e.toLowerCase(),i["Webkit"+t]="webkit"+e,i["Moz"+t]="moz"+e,i}var nv={animationend:jb("Animation","AnimationEnd"),animationiteration:jb("Animation","AnimationIteration"),animationstart:jb("Animation","AnimationStart"),transitionend:jb("Transition","TransitionEnd")},UP={},Pq={};sh&&(Pq=document.createElement("div").style,"AnimationEvent"in window||(delete nv.animationend.animation,delete nv.animationiteration.animation,delete nv.animationstart.animation),"TransitionEvent"in window||delete nv.transitionend.transition);function QT(t){if(UP[t])return UP[t];if(!nv[t])return t;var e=nv[t],i;for(i in e)if(e.hasOwnProperty(i)&&i in Pq)return UP[t]=e[i];return t}var Dq=QT("animationend"),Rq=QT("animationiteration"),Iq=QT("animationstart"),Lq=QT("transitionend"),Bq=new Map,zG="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function sf(t,e){Bq.set(t,e),dm(e,[t])}for(var kP=0;kP<zG.length;kP++){var zP=zG[kP],aae=zP.toLowerCase(),lae=zP[0].toUpperCase()+zP.slice(1);sf(aae,"on"+lae)}sf(Dq,"onAnimationEnd");sf(Rq,"onAnimationIteration");sf(Iq,"onAnimationStart");sf("dblclick","onDoubleClick");sf("focusin","onFocus");sf("focusout","onBlur");sf(Lq,"onTransitionEnd");s0("onMouseEnter",["mouseout","mouseover"]);s0("onMouseLeave",["mouseout","mouseover"]);s0("onPointerEnter",["pointerout","pointerover"]);s0("onPointerLeave",["pointerout","pointerover"]);dm("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));dm("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));dm("onBeforeInput",["compositionend","keypress","textInput","paste"]);dm("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));dm("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));dm("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jx="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cae=new Set("cancel close invalid load scroll toggle".split(" ").concat(Jx));function GG(t,e,i){var n=t.type||"unknown-event";t.currentTarget=i,aoe(n,e,void 0,t),t.currentTarget=null}function Oq(t,e){e=(e&4)!==0;for(var i=0;i<t.length;i++){var n=t[i],r=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;GG(r,a,c),s=l}else for(o=0;o<n.length;o++){if(a=n[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;GG(r,a,c),s=l}}}if(eE)throw t=CI,eE=!1,CI=null,t}function sn(t,e){var i=e[UI];i===void 0&&(i=e[UI]=new Set);var n=t+"__bubble";i.has(n)||(Fq(e,t,2,!1),i.add(n))}function GP(t,e,i){var n=0;e&&(n|=4),Fq(i,t,n,e)}var Wb="_reactListening"+Math.random().toString(36).slice(2);function a_(t){if(!t[Wb]){t[Wb]=!0,VX.forEach(function(i){i!=="selectionchange"&&(cae.has(i)||GP(i,!1,t),GP(i,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Wb]||(e[Wb]=!0,GP("selectionchange",!1,e))}}function Fq(t,e,i,n){switch(xq(e)){case 1:var r=Soe;break;case 4:r=Aoe;break;default:r=BF}i=r.bind(null,e,i,t),r=void 0,!TI||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),n?r!==void 0?t.addEventListener(e,i,{capture:!0,passive:r}):t.addEventListener(e,i,!0):r!==void 0?t.addEventListener(e,i,{passive:r}):t.addEventListener(e,i,!1)}function HP(t,e,i,n,r){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=dp(a),o===null)return;if(l=o.tag,l===5||l===6){n=s=o;continue e}a=a.parentNode}}n=n.return}sq(function(){var c=s,h=DF(i),u=[];e:{var d=Bq.get(t);if(d!==void 0){var f=FF,p=t;switch(t){case"keypress":if(gM(i)===0)break e;case"keydown":case"keyup":f=koe;break;case"focusin":p="focus",f=OP;break;case"focusout":p="blur",f=OP;break;case"beforeblur":case"afterblur":f=OP;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=PG;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=Toe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=Hoe;break;case Dq:case Rq:case Iq:f=Doe;break;case Lq:f=joe;break;case"scroll":f=Moe;break;case"wheel":f=Xoe;break;case"copy":case"cut":case"paste":f=Ioe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=RG}var m=(e&4)!==0,v=!m&&t==="scroll",g=m?d!==null?d+"Capture":null:d;m=[];for(var y=c,x;y!==null;){x=y;var b=x.stateNode;if(x.tag===5&&b!==null&&(x=b,g!==null&&(b=t_(y,g),b!=null&&m.push(l_(y,b,x)))),v)break;y=y.return}0<m.length&&(d=new f(d,p,null,i,h),u.push({event:d,listeners:m}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",d&&i!==MI&&(p=i.relatedTarget||i.fromElement)&&(dp(p)||p[oh]))break e;if((f||d)&&(d=h.window===h?h:(d=h.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=i.relatedTarget||i.toElement,f=c,p=p?dp(p):null,p!==null&&(v=fm(p),p!==v||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(m=PG,b="onMouseLeave",g="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(m=RG,b="onPointerLeave",g="onPointerEnter",y="pointer"),v=f==null?d:rv(f),x=p==null?d:rv(p),d=new m(b,y+"leave",f,i,h),d.target=v,d.relatedTarget=x,b=null,dp(h)===c&&(m=new m(g,y+"enter",p,i,h),m.target=x,m.relatedTarget=v,b=m),v=b,f&&p)t:{for(m=f,g=p,y=0,x=m;x;x=Hm(x))y++;for(x=0,b=g;b;b=Hm(b))x++;for(;0<y-x;)m=Hm(m),y--;for(;0<x-y;)g=Hm(g),x--;for(;y--;){if(m===g||g!==null&&m===g.alternate)break t;m=Hm(m),g=Hm(g)}m=null}else m=null;f!==null&&HG(u,d,f,m,!1),p!==null&&v!==null&&HG(u,v,p,m,!0)}}e:{if(d=c?rv(c):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var S=$oe;else if(BG(d))if(Mq)S=nae;else{S=tae;var A=eae}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(S=iae);if(S&&(S=S(t,c))){Aq(u,S,i,h);break e}A&&A(t,d,c),t==="focusout"&&(A=d._wrapperState)&&A.controlled&&d.type==="number"&&_I(d,"number",d.value)}switch(A=c?rv(c):window,t){case"focusin":(BG(A)||A.contentEditable==="true")&&(iv=A,II=c,y1=null);break;case"focusout":y1=II=iv=null;break;case"mousedown":LI=!0;break;case"contextmenu":case"mouseup":case"dragend":LI=!1,kG(u,i,h);break;case"selectionchange":if(oae)break;case"keydown":case"keyup":kG(u,i,h)}var E;if(UF)e:{switch(t){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else tv?bq(t,i)&&(M="onCompositionEnd"):t==="keydown"&&i.keyCode===229&&(M="onCompositionStart");M&&(wq&&i.locale!=="ko"&&(tv||M!=="onCompositionStart"?M==="onCompositionEnd"&&tv&&(E=_q()):(cd=h,OF="value"in cd?cd.value:cd.textContent,tv=!0)),A=sE(c,M),0<A.length&&(M=new DG(M,t,null,i,h),u.push({event:M,listeners:A}),E?M.data=E:(E=Sq(i),E!==null&&(M.data=E)))),(E=Yoe?Qoe(t,i):Koe(t,i))&&(c=sE(c,"onBeforeInput"),0<c.length&&(h=new DG("onBeforeInput","beforeinput",null,i,h),u.push({event:h,listeners:c}),h.data=E))}Oq(u,e)})}function l_(t,e,i){return{instance:t,listener:e,currentTarget:i}}function sE(t,e){for(var i=e+"Capture",n=[];t!==null;){var r=t,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=t_(t,i),s!=null&&n.unshift(l_(t,s,r)),s=t_(t,e),s!=null&&n.push(l_(t,s,r))),t=t.return}return n}function Hm(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function HG(t,e,i,n,r){for(var s=e._reactName,o=[];i!==null&&i!==n;){var a=i,l=a.alternate,c=a.stateNode;if(l!==null&&l===n)break;a.tag===5&&c!==null&&(a=c,r?(l=t_(i,s),l!=null&&o.unshift(l_(i,l,a))):r||(l=t_(i,s),l!=null&&o.push(l_(i,l,a)))),i=i.return}o.length!==0&&t.push({event:e,listeners:o})}var uae=/\r\n?/g,hae=/\u0000|\uFFFD/g;function VG(t){return(typeof t=="string"?t:""+t).replace(uae,`
`).replace(hae,"")}function Xb(t,e,i){if(e=VG(e),VG(t)!==e&&i)throw Error(it(425))}function oE(){}var BI=null,OI=null;function FI(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var NI=typeof setTimeout=="function"?setTimeout:void 0,dae=typeof clearTimeout=="function"?clearTimeout:void 0,jG=typeof Promise=="function"?Promise:void 0,fae=typeof queueMicrotask=="function"?queueMicrotask:typeof jG<"u"?function(t){return jG.resolve(null).then(t).catch(pae)}:NI;function pae(t){setTimeout(function(){throw t})}function VP(t,e){var i=e,n=0;do{var r=i.nextSibling;if(t.removeChild(i),r&&r.nodeType===8)if(i=r.data,i==="/$"){if(n===0){t.removeChild(r),r_(e);return}n--}else i!=="$"&&i!=="$?"&&i!=="$!"||n++;i=r}while(i);r_(e)}function Ad(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function WG(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var i=t.data;if(i==="$"||i==="$!"||i==="$?"){if(e===0)return t;e--}else i==="/$"&&e++}t=t.previousSibling}return null}var $0=Math.random().toString(36).slice(2),Mc="__reactFiber$"+$0,c_="__reactProps$"+$0,oh="__reactContainer$"+$0,UI="__reactEvents$"+$0,mae="__reactListeners$"+$0,gae="__reactHandles$"+$0;function dp(t){var e=t[Mc];if(e)return e;for(var i=t.parentNode;i;){if(e=i[oh]||i[Mc]){if(i=e.alternate,e.child!==null||i!==null&&i.child!==null)for(t=WG(t);t!==null;){if(i=t[Mc])return i;t=WG(t)}return e}t=i,i=t.parentNode}return null}function aw(t){return t=t[Mc]||t[oh],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function rv(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(it(33))}function KT(t){return t[c_]||null}var kI=[],sv=-1;function of(t){return{current:t}}function cn(t){0>sv||(t.current=kI[sv],kI[sv]=null,sv--)}function nn(t,e){sv++,kI[sv]=t.current,t.current=e}var Wd={},Ss=of(Wd),fo=of(!1),Qp=Wd;function o0(t,e){var i=t.type.contextTypes;if(!i)return Wd;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in i)r[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function po(t){return t=t.childContextTypes,t!=null}function aE(){cn(fo),cn(Ss)}function XG(t,e,i){if(Ss.current!==Wd)throw Error(it(168));nn(Ss,e),nn(fo,i)}function Nq(t,e,i){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return i;n=n.getChildContext();for(var r in n)if(!(r in e))throw Error(it(108,eoe(t)||"Unknown",r));return En({},i,n)}function lE(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Wd,Qp=Ss.current,nn(Ss,t),nn(fo,fo.current),!0}function qG(t,e,i){var n=t.stateNode;if(!n)throw Error(it(169));i?(t=Nq(t,e,Qp),n.__reactInternalMemoizedMergedChildContext=t,cn(fo),cn(Ss),nn(Ss,t)):cn(fo),nn(fo,i)}var Uu=null,JT=!1,jP=!1;function Uq(t){Uu===null?Uu=[t]:Uu.push(t)}function vae(t){JT=!0,Uq(t)}function af(){if(!jP&&Uu!==null){jP=!0;var t=0,e=Vi;try{var i=Uu;for(Vi=1;t<i.length;t++){var n=i[t];do n=n(!0);while(n!==null)}Uu=null,JT=!1}catch(r){throw Uu!==null&&(Uu=Uu.slice(t+1)),cq(RF,af),r}finally{Vi=e,jP=!1}}return null}var ov=[],av=0,cE=null,uE=0,Oa=[],Fa=0,Kp=null,ju=1,Wu="";function qf(t,e){ov[av++]=uE,ov[av++]=cE,cE=t,uE=e}function kq(t,e,i){Oa[Fa++]=ju,Oa[Fa++]=Wu,Oa[Fa++]=Kp,Kp=t;var n=ju;t=Wu;var r=32-Rl(n)-1;n&=~(1<<r),i+=1;var s=32-Rl(e)+r;if(30<s){var o=r-r%5;s=(n&(1<<o)-1).toString(32),n>>=o,r-=o,ju=1<<32-Rl(e)+r|i<<r|n,Wu=s+t}else ju=1<<s|i<<r|n,Wu=t}function zF(t){t.return!==null&&(qf(t,1),kq(t,1,0))}function GF(t){for(;t===cE;)cE=ov[--av],ov[av]=null,uE=ov[--av],ov[av]=null;for(;t===Kp;)Kp=Oa[--Fa],Oa[Fa]=null,Wu=Oa[--Fa],Oa[Fa]=null,ju=Oa[--Fa],Oa[Fa]=null}var Jo=null,Ho=null,dn=!1,Sl=null;function zq(t,e){var i=Ha(5,null,null,0);i.elementType="DELETED",i.stateNode=e,i.return=t,e=t.deletions,e===null?(t.deletions=[i],t.flags|=16):e.push(i)}function YG(t,e){switch(t.tag){case 5:var i=t.type;return e=e.nodeType!==1||i.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Jo=t,Ho=Ad(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Jo=t,Ho=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(i=Kp!==null?{id:ju,overflow:Wu}:null,t.memoizedState={dehydrated:e,treeContext:i,retryLane:1073741824},i=Ha(18,null,null,0),i.stateNode=e,i.return=t,t.child=i,Jo=t,Ho=null,!0):!1;default:return!1}}function zI(t){return(t.mode&1)!==0&&(t.flags&128)===0}function GI(t){if(dn){var e=Ho;if(e){var i=e;if(!YG(t,e)){if(zI(t))throw Error(it(418));e=Ad(i.nextSibling);var n=Jo;e&&YG(t,e)?zq(n,i):(t.flags=t.flags&-4097|2,dn=!1,Jo=t)}}else{if(zI(t))throw Error(it(418));t.flags=t.flags&-4097|2,dn=!1,Jo=t}}}function QG(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Jo=t}function qb(t){if(t!==Jo)return!1;if(!dn)return QG(t),dn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!FI(t.type,t.memoizedProps)),e&&(e=Ho)){if(zI(t))throw Gq(),Error(it(418));for(;e;)zq(t,e),e=Ad(e.nextSibling)}if(QG(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(it(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var i=t.data;if(i==="/$"){if(e===0){Ho=Ad(t.nextSibling);break e}e--}else i!=="$"&&i!=="$!"&&i!=="$?"||e++}t=t.nextSibling}Ho=null}}else Ho=Jo?Ad(t.stateNode.nextSibling):null;return!0}function Gq(){for(var t=Ho;t;)t=Ad(t.nextSibling)}function a0(){Ho=Jo=null,dn=!1}function HF(t){Sl===null?Sl=[t]:Sl.push(t)}var yae=gh.ReactCurrentBatchConfig;function _l(t,e){if(t&&t.defaultProps){e=En({},e),t=t.defaultProps;for(var i in t)e[i]===void 0&&(e[i]=t[i]);return e}return e}var hE=of(null),dE=null,lv=null,VF=null;function jF(){VF=lv=dE=null}function WF(t){var e=hE.current;cn(hE),t._currentValue=e}function HI(t,e,i){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===i)break;t=t.return}}function Ov(t,e){dE=t,VF=lv=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ao=!0),t.firstContext=null)}function Ka(t){var e=t._currentValue;if(VF!==t)if(t={context:t,memoizedValue:e,next:null},lv===null){if(dE===null)throw Error(it(308));lv=t,dE.dependencies={lanes:0,firstContext:t}}else lv=lv.next=t;return e}var fp=null;function XF(t){fp===null?fp=[t]:fp.push(t)}function Hq(t,e,i,n){var r=e.interleaved;return r===null?(i.next=i,XF(e)):(i.next=r.next,r.next=i),e.interleaved=i,ah(t,n)}function ah(t,e){t.lanes|=e;var i=t.alternate;for(i!==null&&(i.lanes|=e),i=t,t=t.return;t!==null;)t.childLanes|=e,i=t.alternate,i!==null&&(i.childLanes|=e),i=t,t=t.return;return i.tag===3?i.stateNode:null}var $h=!1;function qF(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vq(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Zu(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Md(t,e,i){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Ei&2){var r=n.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),n.pending=e,ah(t,i)}return r=n.interleaved,r===null?(e.next=e,XF(n)):(e.next=r.next,r.next=e),n.interleaved=e,ah(t,i)}function vM(t,e,i){if(e=e.updateQueue,e!==null&&(e=e.shared,(i&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,i|=n,e.lanes=i,IF(t,i)}}function KG(t,e){var i=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,i===n)){var r=null,s=null;if(i=i.firstBaseUpdate,i!==null){do{var o={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};s===null?r=s=o:s=s.next=o,i=i.next}while(i!==null);s===null?r=s=e:s=s.next=e}else r=s=e;i={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=i;return}t=i.lastBaseUpdate,t===null?i.firstBaseUpdate=e:t.next=e,i.lastBaseUpdate=e}function fE(t,e,i,n){var r=t.updateQueue;$h=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=c:a.next=c,h.lastBaseUpdate=l))}if(s!==null){var u=r.baseState;o=0,h=c=l=null,a=s;do{var d=a.lane,f=a.eventTime;if((n&d)===d){h!==null&&(h=h.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(d=e,f=i,m.tag){case 1:if(p=m.payload,typeof p=="function"){u=p.call(f,u,d);break e}u=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,d=typeof p=="function"?p.call(f,u,d):p,d==null)break e;u=En({},u,d);break e;case 2:$h=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,d=r.effects,d===null?r.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(c=h=f,l=u):h=h.next=f,o|=d;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;d=a,a=d.next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}while(1);if(h===null&&(l=u),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=h,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Zp|=o,t.lanes=o,t.memoizedState=u}}function JG(t,e,i){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],r=n.callback;if(r!==null){if(n.callback=null,n=i,typeof r!="function")throw Error(it(191,r));r.call(n)}}}var jq=new HX.Component().refs;function VI(t,e,i,n){e=t.memoizedState,i=i(n,e),i=i==null?e:En({},e,i),t.memoizedState=i,t.lanes===0&&(t.updateQueue.baseState=i)}var ZT={isMounted:function(t){return(t=t._reactInternals)?fm(t)===t:!1},enqueueSetState:function(t,e,i){t=t._reactInternals;var n=Hs(),r=Td(t),s=Zu(n,r);s.payload=e,i!=null&&(s.callback=i),e=Md(t,s,r),e!==null&&(Il(e,t,r,n),vM(e,t,r))},enqueueReplaceState:function(t,e,i){t=t._reactInternals;var n=Hs(),r=Td(t),s=Zu(n,r);s.tag=1,s.payload=e,i!=null&&(s.callback=i),e=Md(t,s,r),e!==null&&(Il(e,t,r,n),vM(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var i=Hs(),n=Td(t),r=Zu(i,n);r.tag=2,e!=null&&(r.callback=e),e=Md(t,r,n),e!==null&&(Il(e,t,n,i),vM(e,t,n))}};function ZG(t,e,i,n,r,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!o_(i,n)||!o_(r,s):!0}function Wq(t,e,i){var n=!1,r=Wd,s=e.contextType;return typeof s=="object"&&s!==null?s=Ka(s):(r=po(e)?Qp:Ss.current,n=e.contextTypes,s=(n=n!=null)?o0(t,r):Wd),e=new e(i,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ZT,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function $G(t,e,i,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(i,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(i,n),e.state!==t&&ZT.enqueueReplaceState(e,e.state,null)}function jI(t,e,i,n){var r=t.stateNode;r.props=i,r.state=t.memoizedState,r.refs=jq,qF(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=Ka(s):(s=po(e)?Qp:Ss.current,r.context=o0(t,s)),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(VI(t,e,s,i),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&ZT.enqueueReplaceState(r,r.state,null),fE(t,i,r,n),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Qy(t,e,i){if(t=i.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(it(309));var n=i.stateNode}if(!n)throw Error(it(147,t));var r=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;a===jq&&(a=r.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(it(284));if(!i._owner)throw Error(it(290,t))}return t}function Yb(t,e){throw t=Object.prototype.toString.call(e),Error(it(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function eH(t){var e=t._init;return e(t._payload)}function Xq(t){function e(g,y){if(t){var x=g.deletions;x===null?(g.deletions=[y],g.flags|=16):x.push(y)}}function i(g,y){if(!t)return null;for(;y!==null;)e(g,y),y=y.sibling;return null}function n(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function r(g,y){return g=Cd(g,y),g.index=0,g.sibling=null,g}function s(g,y,x){return g.index=x,t?(x=g.alternate,x!==null?(x=x.index,x<y?(g.flags|=2,y):x):(g.flags|=2,y)):(g.flags|=1048576,y)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,y,x,b){return y===null||y.tag!==6?(y=JP(x,g.mode,b),y.return=g,y):(y=r(y,x),y.return=g,y)}function l(g,y,x,b){var S=x.type;return S===ev?h(g,y,x.props.children,b,x.key):y!==null&&(y.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Zh&&eH(S)===y.type)?(b=r(y,x.props),b.ref=Qy(g,y,x),b.return=g,b):(b=SM(x.type,x.key,x.props,null,g.mode,b),b.ref=Qy(g,y,x),b.return=g,b)}function c(g,y,x,b){return y===null||y.tag!==4||y.stateNode.containerInfo!==x.containerInfo||y.stateNode.implementation!==x.implementation?(y=ZP(x,g.mode,b),y.return=g,y):(y=r(y,x.children||[]),y.return=g,y)}function h(g,y,x,b,S){return y===null||y.tag!==7?(y=Dp(x,g.mode,b,S),y.return=g,y):(y=r(y,x),y.return=g,y)}function u(g,y,x){if(typeof y=="string"&&y!==""||typeof y=="number")return y=JP(""+y,g.mode,x),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Nb:return x=SM(y.type,y.key,y.props,null,g.mode,x),x.ref=Qy(g,null,y),x.return=g,x;case $g:return y=ZP(y,g.mode,x),y.return=g,y;case Zh:var b=y._init;return u(g,b(y._payload),x)}if(Qx(y)||jy(y))return y=Dp(y,g.mode,x,null),y.return=g,y;Yb(g,y)}return null}function d(g,y,x,b){var S=y!==null?y.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return S!==null?null:a(g,y,""+x,b);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Nb:return x.key===S?l(g,y,x,b):null;case $g:return x.key===S?c(g,y,x,b):null;case Zh:return S=x._init,d(g,y,S(x._payload),b)}if(Qx(x)||jy(x))return S!==null?null:h(g,y,x,b,null);Yb(g,x)}return null}function f(g,y,x,b,S){if(typeof b=="string"&&b!==""||typeof b=="number")return g=g.get(x)||null,a(y,g,""+b,S);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Nb:return g=g.get(b.key===null?x:b.key)||null,l(y,g,b,S);case $g:return g=g.get(b.key===null?x:b.key)||null,c(y,g,b,S);case Zh:var A=b._init;return f(g,y,x,A(b._payload),S)}if(Qx(b)||jy(b))return g=g.get(x)||null,h(y,g,b,S,null);Yb(y,b)}return null}function p(g,y,x,b){for(var S=null,A=null,E=y,M=y=0,T=null;E!==null&&M<x.length;M++){E.index>M?(T=E,E=null):T=E.sibling;var P=d(g,E,x[M],b);if(P===null){E===null&&(E=T);break}t&&E&&P.alternate===null&&e(g,E),y=s(P,y,M),A===null?S=P:A.sibling=P,A=P,E=T}if(M===x.length)return i(g,E),dn&&qf(g,M),S;if(E===null){for(;M<x.length;M++)E=u(g,x[M],b),E!==null&&(y=s(E,y,M),A===null?S=E:A.sibling=E,A=E);return dn&&qf(g,M),S}for(E=n(g,E);M<x.length;M++)T=f(E,g,M,x[M],b),T!==null&&(t&&T.alternate!==null&&E.delete(T.key===null?M:T.key),y=s(T,y,M),A===null?S=T:A.sibling=T,A=T);return t&&E.forEach(function(R){return e(g,R)}),dn&&qf(g,M),S}function m(g,y,x,b){var S=jy(x);if(typeof S!="function")throw Error(it(150));if(x=S.call(x),x==null)throw Error(it(151));for(var A=S=null,E=y,M=y=0,T=null,P=x.next();E!==null&&!P.done;M++,P=x.next()){E.index>M?(T=E,E=null):T=E.sibling;var R=d(g,E,P.value,b);if(R===null){E===null&&(E=T);break}t&&E&&R.alternate===null&&e(g,E),y=s(R,y,M),A===null?S=R:A.sibling=R,A=R,E=T}if(P.done)return i(g,E),dn&&qf(g,M),S;if(E===null){for(;!P.done;M++,P=x.next())P=u(g,P.value,b),P!==null&&(y=s(P,y,M),A===null?S=P:A.sibling=P,A=P);return dn&&qf(g,M),S}for(E=n(g,E);!P.done;M++,P=x.next())P=f(E,g,M,P.value,b),P!==null&&(t&&P.alternate!==null&&E.delete(P.key===null?M:P.key),y=s(P,y,M),A===null?S=P:A.sibling=P,A=P);return t&&E.forEach(function(U){return e(g,U)}),dn&&qf(g,M),S}function v(g,y,x,b){if(typeof x=="object"&&x!==null&&x.type===ev&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Nb:e:{for(var S=x.key,A=y;A!==null;){if(A.key===S){if(S=x.type,S===ev){if(A.tag===7){i(g,A.sibling),y=r(A,x.props.children),y.return=g,g=y;break e}}else if(A.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Zh&&eH(S)===A.type){i(g,A.sibling),y=r(A,x.props),y.ref=Qy(g,A,x),y.return=g,g=y;break e}i(g,A);break}else e(g,A);A=A.sibling}x.type===ev?(y=Dp(x.props.children,g.mode,b,x.key),y.return=g,g=y):(b=SM(x.type,x.key,x.props,null,g.mode,b),b.ref=Qy(g,y,x),b.return=g,g=b)}return o(g);case $g:e:{for(A=x.key;y!==null;){if(y.key===A)if(y.tag===4&&y.stateNode.containerInfo===x.containerInfo&&y.stateNode.implementation===x.implementation){i(g,y.sibling),y=r(y,x.children||[]),y.return=g,g=y;break e}else{i(g,y);break}else e(g,y);y=y.sibling}y=ZP(x,g.mode,b),y.return=g,g=y}return o(g);case Zh:return A=x._init,v(g,y,A(x._payload),b)}if(Qx(x))return p(g,y,x,b);if(jy(x))return m(g,y,x,b);Yb(g,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,y!==null&&y.tag===6?(i(g,y.sibling),y=r(y,x),y.return=g,g=y):(i(g,y),y=JP(x,g.mode,b),y.return=g,g=y),o(g)):i(g,y)}return v}var l0=Xq(!0),qq=Xq(!1),lw={},Fc=of(lw),u_=of(lw),h_=of(lw);function pp(t){if(t===lw)throw Error(it(174));return t}function YF(t,e){switch(nn(h_,e),nn(u_,t),nn(Fc,lw),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:bI(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=bI(e,t)}cn(Fc),nn(Fc,e)}function c0(){cn(Fc),cn(u_),cn(h_)}function Yq(t){pp(h_.current);var e=pp(Fc.current),i=bI(e,t.type);e!==i&&(nn(u_,t),nn(Fc,i))}function QF(t){u_.current===t&&(cn(Fc),cn(u_))}var vn=of(0);function pE(t){for(var e=t;e!==null;){if(e.tag===13){var i=e.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var WP=[];function KF(){for(var t=0;t<WP.length;t++)WP[t]._workInProgressVersionPrimary=null;WP.length=0}var yM=gh.ReactCurrentDispatcher,XP=gh.ReactCurrentBatchConfig,Jp=0,Mn=null,xr=null,Or=null,mE=!1,x1=!1,d_=0,xae=0;function cs(){throw Error(it(321))}function JF(t,e){if(e===null)return!1;for(var i=0;i<e.length&&i<t.length;i++)if(!kl(t[i],e[i]))return!1;return!0}function ZF(t,e,i,n,r,s){if(Jp=s,Mn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,yM.current=t===null||t.memoizedState===null?Sae:Aae,t=i(n,r),x1){s=0;do{if(x1=!1,d_=0,25<=s)throw Error(it(301));s+=1,Or=xr=null,e.updateQueue=null,yM.current=Mae,t=i(n,r)}while(x1)}if(yM.current=gE,e=xr!==null&&xr.next!==null,Jp=0,Or=xr=Mn=null,mE=!1,e)throw Error(it(300));return t}function $F(){var t=d_!==0;return d_=0,t}function yc(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Or===null?Mn.memoizedState=Or=t:Or=Or.next=t,Or}function Ja(){if(xr===null){var t=Mn.alternate;t=t!==null?t.memoizedState:null}else t=xr.next;var e=Or===null?Mn.memoizedState:Or.next;if(e!==null)Or=e,xr=t;else{if(t===null)throw Error(it(310));xr=t,t={memoizedState:xr.memoizedState,baseState:xr.baseState,baseQueue:xr.baseQueue,queue:xr.queue,next:null},Or===null?Mn.memoizedState=Or=t:Or=Or.next=t}return Or}function f_(t,e){return typeof e=="function"?e(t):e}function qP(t){var e=Ja(),i=e.queue;if(i===null)throw Error(it(311));i.lastRenderedReducer=t;var n=xr,r=n.baseQueue,s=i.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}n.baseQueue=r=s,i.pending=null}if(r!==null){s=r.next,n=n.baseState;var a=o=null,l=null,c=s;do{var h=c.lane;if((Jp&h)===h)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var u={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=u,o=n):l=l.next=u,Mn.lanes|=h,Zp|=h}c=c.next}while(c!==null&&c!==s);l===null?o=n:l.next=a,kl(n,e.memoizedState)||(ao=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=l,i.lastRenderedState=n}if(t=i.interleaved,t!==null){r=t;do s=r.lane,Mn.lanes|=s,Zp|=s,r=r.next;while(r!==t)}else r===null&&(i.lanes=0);return[e.memoizedState,i.dispatch]}function YP(t){var e=Ja(),i=e.queue;if(i===null)throw Error(it(311));i.lastRenderedReducer=t;var n=i.dispatch,r=i.pending,s=e.memoizedState;if(r!==null){i.pending=null;var o=r=r.next;do s=t(s,o.action),o=o.next;while(o!==r);kl(s,e.memoizedState)||(ao=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),i.lastRenderedState=s}return[s,n]}function Qq(){}function Kq(t,e){var i=Mn,n=Ja(),r=e(),s=!kl(n.memoizedState,r);if(s&&(n.memoizedState=r,ao=!0),n=n.queue,eN($q.bind(null,i,n,t),[t]),n.getSnapshot!==e||s||Or!==null&&Or.memoizedState.tag&1){if(i.flags|=2048,p_(9,Zq.bind(null,i,n,r,e),void 0,null),zr===null)throw Error(it(349));Jp&30||Jq(i,e,r)}return r}function Jq(t,e,i){t.flags|=16384,t={getSnapshot:e,value:i},e=Mn.updateQueue,e===null?(e={lastEffect:null,stores:null},Mn.updateQueue=e,e.stores=[t]):(i=e.stores,i===null?e.stores=[t]:i.push(t))}function Zq(t,e,i,n){e.value=i,e.getSnapshot=n,eY(e)&&tY(t)}function $q(t,e,i){return i(function(){eY(e)&&tY(t)})}function eY(t){var e=t.getSnapshot;t=t.value;try{var i=e();return!kl(t,i)}catch{return!0}}function tY(t){var e=ah(t,1);e!==null&&Il(e,t,1,-1)}function tH(t){var e=yc();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:f_,lastRenderedState:t},e.queue=t,t=t.dispatch=bae.bind(null,Mn,t),[e.memoizedState,t]}function p_(t,e,i,n){return t={tag:t,create:e,destroy:i,deps:n,next:null},e=Mn.updateQueue,e===null?(e={lastEffect:null,stores:null},Mn.updateQueue=e,e.lastEffect=t.next=t):(i=e.lastEffect,i===null?e.lastEffect=t.next=t:(n=i.next,i.next=t,t.next=n,e.lastEffect=t)),t}function iY(){return Ja().memoizedState}function xM(t,e,i,n){var r=yc();Mn.flags|=t,r.memoizedState=p_(1|e,i,void 0,n===void 0?null:n)}function $T(t,e,i,n){var r=Ja();n=n===void 0?null:n;var s=void 0;if(xr!==null){var o=xr.memoizedState;if(s=o.destroy,n!==null&&JF(n,o.deps)){r.memoizedState=p_(e,i,s,n);return}}Mn.flags|=t,r.memoizedState=p_(1|e,i,s,n)}function iH(t,e){return xM(8390656,8,t,e)}function eN(t,e){return $T(2048,8,t,e)}function nY(t,e){return $T(4,2,t,e)}function rY(t,e){return $T(4,4,t,e)}function sY(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function oY(t,e,i){return i=i!=null?i.concat([t]):null,$T(4,4,sY.bind(null,e,t),i)}function tN(){}function aY(t,e){var i=Ja();e=e===void 0?null:e;var n=i.memoizedState;return n!==null&&e!==null&&JF(e,n[1])?n[0]:(i.memoizedState=[t,e],t)}function lY(t,e){var i=Ja();e=e===void 0?null:e;var n=i.memoizedState;return n!==null&&e!==null&&JF(e,n[1])?n[0]:(t=t(),i.memoizedState=[t,e],t)}function cY(t,e,i){return Jp&21?(kl(i,e)||(i=dq(),Mn.lanes|=i,Zp|=i,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ao=!0),t.memoizedState=i)}function _ae(t,e){var i=Vi;Vi=i!==0&&4>i?i:4,t(!0);var n=XP.transition;XP.transition={};try{t(!1),e()}finally{Vi=i,XP.transition=n}}function uY(){return Ja().memoizedState}function wae(t,e,i){var n=Td(t);if(i={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null},hY(t))dY(e,i);else if(i=Hq(t,e,i,n),i!==null){var r=Hs();Il(i,t,n,r),fY(i,e,n)}}function bae(t,e,i){var n=Td(t),r={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null};if(hY(t))dY(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,i);if(r.hasEagerState=!0,r.eagerState=a,kl(a,o)){var l=e.interleaved;l===null?(r.next=r,XF(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}i=Hq(t,e,r,n),i!==null&&(r=Hs(),Il(i,t,n,r),fY(i,e,n))}}function hY(t){var e=t.alternate;return t===Mn||e!==null&&e===Mn}function dY(t,e){x1=mE=!0;var i=t.pending;i===null?e.next=e:(e.next=i.next,i.next=e),t.pending=e}function fY(t,e,i){if(i&4194240){var n=e.lanes;n&=t.pendingLanes,i|=n,e.lanes=i,IF(t,i)}}var gE={readContext:Ka,useCallback:cs,useContext:cs,useEffect:cs,useImperativeHandle:cs,useInsertionEffect:cs,useLayoutEffect:cs,useMemo:cs,useReducer:cs,useRef:cs,useState:cs,useDebugValue:cs,useDeferredValue:cs,useTransition:cs,useMutableSource:cs,useSyncExternalStore:cs,useId:cs,unstable_isNewReconciler:!1},Sae={readContext:Ka,useCallback:function(t,e){return yc().memoizedState=[t,e===void 0?null:e],t},useContext:Ka,useEffect:iH,useImperativeHandle:function(t,e,i){return i=i!=null?i.concat([t]):null,xM(4194308,4,sY.bind(null,e,t),i)},useLayoutEffect:function(t,e){return xM(4194308,4,t,e)},useInsertionEffect:function(t,e){return xM(4,2,t,e)},useMemo:function(t,e){var i=yc();return e=e===void 0?null:e,t=t(),i.memoizedState=[t,e],t},useReducer:function(t,e,i){var n=yc();return e=i!==void 0?i(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=wae.bind(null,Mn,t),[n.memoizedState,t]},useRef:function(t){var e=yc();return t={current:t},e.memoizedState=t},useState:tH,useDebugValue:tN,useDeferredValue:function(t){return yc().memoizedState=t},useTransition:function(){var t=tH(!1),e=t[0];return t=_ae.bind(null,t[1]),yc().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,i){var n=Mn,r=yc();if(dn){if(i===void 0)throw Error(it(407));i=i()}else{if(i=e(),zr===null)throw Error(it(349));Jp&30||Jq(n,e,i)}r.memoizedState=i;var s={value:i,getSnapshot:e};return r.queue=s,iH($q.bind(null,n,s,t),[t]),n.flags|=2048,p_(9,Zq.bind(null,n,s,i,e),void 0,null),i},useId:function(){var t=yc(),e=zr.identifierPrefix;if(dn){var i=Wu,n=ju;i=(n&~(1<<32-Rl(n)-1)).toString(32)+i,e=":"+e+"R"+i,i=d_++,0<i&&(e+="H"+i.toString(32)),e+=":"}else i=xae++,e=":"+e+"r"+i.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Aae={readContext:Ka,useCallback:aY,useContext:Ka,useEffect:eN,useImperativeHandle:oY,useInsertionEffect:nY,useLayoutEffect:rY,useMemo:lY,useReducer:qP,useRef:iY,useState:function(){return qP(f_)},useDebugValue:tN,useDeferredValue:function(t){var e=Ja();return cY(e,xr.memoizedState,t)},useTransition:function(){var t=qP(f_)[0],e=Ja().memoizedState;return[t,e]},useMutableSource:Qq,useSyncExternalStore:Kq,useId:uY,unstable_isNewReconciler:!1},Mae={readContext:Ka,useCallback:aY,useContext:Ka,useEffect:eN,useImperativeHandle:oY,useInsertionEffect:nY,useLayoutEffect:rY,useMemo:lY,useReducer:YP,useRef:iY,useState:function(){return YP(f_)},useDebugValue:tN,useDeferredValue:function(t){var e=Ja();return xr===null?e.memoizedState=t:cY(e,xr.memoizedState,t)},useTransition:function(){var t=YP(f_)[0],e=Ja().memoizedState;return[t,e]},useMutableSource:Qq,useSyncExternalStore:Kq,useId:uY,unstable_isNewReconciler:!1};function u0(t,e){try{var i="",n=e;do i+=$se(n),n=n.return;while(n);var r=i}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:r,digest:null}}function QP(t,e,i){return{value:t,source:null,stack:i??null,digest:e??null}}function WI(t,e){try{console.error(e.value)}catch(i){setTimeout(function(){throw i})}}var Eae=typeof WeakMap=="function"?WeakMap:Map;function pY(t,e,i){i=Zu(-1,i),i.tag=3,i.payload={element:null};var n=e.value;return i.callback=function(){yE||(yE=!0,tL=n),WI(t,e)},i}function mY(t,e,i){i=Zu(-1,i),i.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var r=e.value;i.payload=function(){return n(r)},i.callback=function(){WI(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(i.callback=function(){WI(t,e),typeof n!="function"&&(Ed===null?Ed=new Set([this]):Ed.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),i}function nH(t,e,i){var n=t.pingCache;if(n===null){n=t.pingCache=new Eae;var r=new Set;n.set(e,r)}else r=n.get(e),r===void 0&&(r=new Set,n.set(e,r));r.has(i)||(r.add(i),t=zae.bind(null,t,e,i),e.then(t,t))}function rH(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function sH(t,e,i,n,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(e=Zu(-1,1),e.tag=2,Md(i,e,1))),i.lanes|=1),t)}var Tae=gh.ReactCurrentOwner,ao=!1;function Us(t,e,i,n){e.child=t===null?qq(e,null,i,n):l0(e,t.child,i,n)}function oH(t,e,i,n,r){i=i.render;var s=e.ref;return Ov(e,r),n=ZF(t,e,i,n,s,r),i=$F(),t!==null&&!ao?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,lh(t,e,r)):(dn&&i&&zF(e),e.flags|=1,Us(t,e,n,r),e.child)}function aH(t,e,i,n,r){if(t===null){var s=i.type;return typeof s=="function"&&!cN(s)&&s.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(e.tag=15,e.type=s,gY(t,e,s,n,r)):(t=SM(i.type,null,n,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&r)){var o=s.memoizedProps;if(i=i.compare,i=i!==null?i:o_,i(o,n)&&t.ref===e.ref)return lh(t,e,r)}return e.flags|=1,t=Cd(s,n),t.ref=e.ref,t.return=e,e.child=t}function gY(t,e,i,n,r){if(t!==null){var s=t.memoizedProps;if(o_(s,n)&&t.ref===e.ref)if(ao=!1,e.pendingProps=n=s,(t.lanes&r)!==0)t.flags&131072&&(ao=!0);else return e.lanes=t.lanes,lh(t,e,r)}return XI(t,e,i,n,r)}function vY(t,e,i){var n=e.pendingProps,r=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},nn(uv,No),No|=i;else{if(!(i&1073741824))return t=s!==null?s.baseLanes|i:i,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,nn(uv,No),No|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:i,nn(uv,No),No|=n}else s!==null?(n=s.baseLanes|i,e.memoizedState=null):n=i,nn(uv,No),No|=n;return Us(t,e,r,i),e.child}function yY(t,e){var i=e.ref;(t===null&&i!==null||t!==null&&t.ref!==i)&&(e.flags|=512,e.flags|=2097152)}function XI(t,e,i,n,r){var s=po(i)?Qp:Ss.current;return s=o0(e,s),Ov(e,r),i=ZF(t,e,i,n,s,r),n=$F(),t!==null&&!ao?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,lh(t,e,r)):(dn&&n&&zF(e),e.flags|=1,Us(t,e,i,r),e.child)}function lH(t,e,i,n,r){if(po(i)){var s=!0;lE(e)}else s=!1;if(Ov(e,r),e.stateNode===null)_M(t,e),Wq(e,i,n),jI(e,i,n,r),n=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=i.contextType;typeof c=="object"&&c!==null?c=Ka(c):(c=po(i)?Qp:Ss.current,c=o0(e,c));var h=i.getDerivedStateFromProps,u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";u||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||l!==c)&&$G(e,o,n,c),$h=!1;var d=e.memoizedState;o.state=d,fE(e,n,o,r),l=e.memoizedState,a!==n||d!==l||fo.current||$h?(typeof h=="function"&&(VI(e,i,h,n),l=e.memoizedState),(a=$h||ZG(e,i,a,n,d,l,c))?(u||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),o.props=n,o.state=l,o.context=c,n=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,Vq(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:_l(e.type,a),o.props=c,u=e.pendingProps,d=o.context,l=i.contextType,typeof l=="object"&&l!==null?l=Ka(l):(l=po(i)?Qp:Ss.current,l=o0(e,l));var f=i.getDerivedStateFromProps;(h=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==u||d!==l)&&$G(e,o,n,l),$h=!1,d=e.memoizedState,o.state=d,fE(e,n,o,r);var p=e.memoizedState;a!==u||d!==p||fo.current||$h?(typeof f=="function"&&(VI(e,i,f,n),p=e.memoizedState),(c=$h||ZG(e,i,c,n,d,p,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=p),o.props=n,o.state=p,o.context=l,n=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return qI(t,e,i,n,s,r)}function qI(t,e,i,n,r,s){yY(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return r&&qG(e,i,!1),lh(t,e,s);n=e.stateNode,Tae.current=e;var a=o&&typeof i.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=l0(e,t.child,null,s),e.child=l0(e,null,a,s)):Us(t,e,a,s),e.memoizedState=n.state,r&&qG(e,i,!0),e.child}function xY(t){var e=t.stateNode;e.pendingContext?XG(t,e.pendingContext,e.pendingContext!==e.context):e.context&&XG(t,e.context,!1),YF(t,e.containerInfo)}function cH(t,e,i,n,r){return a0(),HF(r),e.flags|=256,Us(t,e,i,n),e.child}var YI={dehydrated:null,treeContext:null,retryLane:0};function QI(t){return{baseLanes:t,cachePool:null,transitions:null}}function _Y(t,e,i){var n=e.pendingProps,r=vn.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),nn(vn,r&1),t===null)return GI(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=iC(o,n,0,null),t=Dp(t,n,i,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=QI(i),e.memoizedState=YI,t):iN(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return Cae(t,e,o,n,a,r,i);if(s){s=n.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&e.child!==r?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Cd(r,l),n.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=Cd(a,s):(s=Dp(s,o,i,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?QI(i):{baseLanes:o.baseLanes|i,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~i,e.memoizedState=YI,n}return s=t.child,t=s.sibling,n=Cd(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=i),n.return=e,n.sibling=null,t!==null&&(i=e.deletions,i===null?(e.deletions=[t],e.flags|=16):i.push(t)),e.child=n,e.memoizedState=null,n}function iN(t,e){return e=iC({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Qb(t,e,i,n){return n!==null&&HF(n),l0(e,t.child,null,i),t=iN(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Cae(t,e,i,n,r,s,o){if(i)return e.flags&256?(e.flags&=-257,n=QP(Error(it(422))),Qb(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,r=e.mode,n=iC({mode:"visible",children:n.children},r,0,null),s=Dp(s,r,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&l0(e,t.child,null,o),e.child.memoizedState=QI(o),e.memoizedState=YI,s);if(!(e.mode&1))return Qb(t,e,o,null);if(r.data==="$!"){if(n=r.nextSibling&&r.nextSibling.dataset,n)var a=n.dgst;return n=a,s=Error(it(419)),n=QP(s,n,void 0),Qb(t,e,o,n)}if(a=(o&t.childLanes)!==0,ao||a){if(n=zr,n!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(n.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,ah(t,r),Il(n,t,r,-1))}return lN(),n=QP(Error(it(421))),Qb(t,e,o,n)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=Gae.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,Ho=Ad(r.nextSibling),Jo=e,dn=!0,Sl=null,t!==null&&(Oa[Fa++]=ju,Oa[Fa++]=Wu,Oa[Fa++]=Kp,ju=t.id,Wu=t.overflow,Kp=e),e=iN(e,n.children),e.flags|=4096,e)}function uH(t,e,i){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),HI(t.return,e,i)}function KP(t,e,i,n,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=i,s.tailMode=r)}function wY(t,e,i){var n=e.pendingProps,r=n.revealOrder,s=n.tail;if(Us(t,e,n.children,i),n=vn.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&uH(t,i,e);else if(t.tag===19)uH(t,i,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(nn(vn,n),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(i=e.child,r=null;i!==null;)t=i.alternate,t!==null&&pE(t)===null&&(r=i),i=i.sibling;i=r,i===null?(r=e.child,e.child=null):(r=i.sibling,i.sibling=null),KP(e,!1,r,i,s);break;case"backwards":for(i=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&pE(t)===null){e.child=r;break}t=r.sibling,r.sibling=i,i=r,r=t}KP(e,!0,i,null,s);break;case"together":KP(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function _M(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function lh(t,e,i){if(t!==null&&(e.dependencies=t.dependencies),Zp|=e.lanes,!(i&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(it(153));if(e.child!==null){for(t=e.child,i=Cd(t,t.pendingProps),e.child=i,i.return=e;t.sibling!==null;)t=t.sibling,i=i.sibling=Cd(t,t.pendingProps),i.return=e;i.sibling=null}return e.child}function Pae(t,e,i){switch(e.tag){case 3:xY(e),a0();break;case 5:Yq(e);break;case 1:po(e.type)&&lE(e);break;case 4:YF(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,r=e.memoizedProps.value;nn(hE,n._currentValue),n._currentValue=r;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(nn(vn,vn.current&1),e.flags|=128,null):i&e.child.childLanes?_Y(t,e,i):(nn(vn,vn.current&1),t=lh(t,e,i),t!==null?t.sibling:null);nn(vn,vn.current&1);break;case 19:if(n=(i&e.childLanes)!==0,t.flags&128){if(n)return wY(t,e,i);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),nn(vn,vn.current),n)break;return null;case 22:case 23:return e.lanes=0,vY(t,e,i)}return lh(t,e,i)}var bY,KI,SY,AY;bY=function(t,e){for(var i=e.child;i!==null;){if(i.tag===5||i.tag===6)t.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};KI=function(){};SY=function(t,e,i,n){var r=t.memoizedProps;if(r!==n){t=e.stateNode,pp(Fc.current);var s=null;switch(i){case"input":r=yI(t,r),n=yI(t,n),s=[];break;case"select":r=En({},r,{value:void 0}),n=En({},n,{value:void 0}),s=[];break;case"textarea":r=wI(t,r),n=wI(t,n),s=[];break;default:typeof r.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=oE)}SI(i,n);var o;i=null;for(c in r)if(!n.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(o in a)a.hasOwnProperty(o)&&(i||(i={}),i[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&($1.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(a=r!=null?r[c]:void 0,n.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(i||(i={}),i[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(i||(i={}),i[o]=l[o])}else i||(s||(s=[]),s.push(c,i)),i=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&($1.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&sn("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}i&&(s=s||[]).push("style",i);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};AY=function(t,e,i,n){i!==n&&(e.flags|=4)};function Ky(t,e){if(!dn)switch(t.tailMode){case"hidden":e=t.tail;for(var i=null;e!==null;)e.alternate!==null&&(i=e),e=e.sibling;i===null?t.tail=null:i.sibling=null;break;case"collapsed":i=t.tail;for(var n=null;i!==null;)i.alternate!==null&&(n=i),i=i.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function us(t){var e=t.alternate!==null&&t.alternate.child===t.child,i=0,n=0;if(e)for(var r=t.child;r!==null;)i|=r.lanes|r.childLanes,n|=r.subtreeFlags&14680064,n|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)i|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=n,t.childLanes=i,e}function Dae(t,e,i){var n=e.pendingProps;switch(GF(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return us(e),null;case 1:return po(e.type)&&aE(),us(e),null;case 3:return n=e.stateNode,c0(),cn(fo),cn(Ss),KF(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(qb(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Sl!==null&&(rL(Sl),Sl=null))),KI(t,e),us(e),null;case 5:QF(e);var r=pp(h_.current);if(i=e.type,t!==null&&e.stateNode!=null)SY(t,e,i,n,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(it(166));return us(e),null}if(t=pp(Fc.current),qb(e)){n=e.stateNode,i=e.type;var s=e.memoizedProps;switch(n[Mc]=e,n[c_]=s,t=(e.mode&1)!==0,i){case"dialog":sn("cancel",n),sn("close",n);break;case"iframe":case"object":case"embed":sn("load",n);break;case"video":case"audio":for(r=0;r<Jx.length;r++)sn(Jx[r],n);break;case"source":sn("error",n);break;case"img":case"image":case"link":sn("error",n),sn("load",n);break;case"details":sn("toggle",n);break;case"input":xG(n,s),sn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},sn("invalid",n);break;case"textarea":wG(n,s),sn("invalid",n)}SI(i,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(s.suppressHydrationWarning!==!0&&Xb(n.textContent,a,t),r=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Xb(n.textContent,a,t),r=["children",""+a]):$1.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&sn("scroll",n)}switch(i){case"input":Ub(n),_G(n,s,!0);break;case"textarea":Ub(n),bG(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=oE)}n=r,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=JX(i)),t==="http://www.w3.org/1999/xhtml"?i==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(i,{is:n.is}):(t=o.createElement(i),i==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,i),t[Mc]=e,t[c_]=n,bY(t,e,!1,!1),e.stateNode=t;e:{switch(o=AI(i,n),i){case"dialog":sn("cancel",t),sn("close",t),r=n;break;case"iframe":case"object":case"embed":sn("load",t),r=n;break;case"video":case"audio":for(r=0;r<Jx.length;r++)sn(Jx[r],t);r=n;break;case"source":sn("error",t),r=n;break;case"img":case"image":case"link":sn("error",t),sn("load",t),r=n;break;case"details":sn("toggle",t),r=n;break;case"input":xG(t,n),r=yI(t,n),sn("invalid",t);break;case"option":r=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},r=En({},n,{value:void 0}),sn("invalid",t);break;case"textarea":wG(t,n),r=wI(t,n),sn("invalid",t);break;default:r=n}SI(i,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?eq(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&ZX(t,l)):s==="children"?typeof l=="string"?(i!=="textarea"||l!=="")&&e_(t,l):typeof l=="number"&&e_(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&($1.hasOwnProperty(s)?l!=null&&s==="onScroll"&&sn("scroll",t):l!=null&&EF(t,s,l,o))}switch(i){case"input":Ub(t),_G(t,n,!1);break;case"textarea":Ub(t),bG(t);break;case"option":n.value!=null&&t.setAttribute("value",""+jd(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?Rv(t,!!n.multiple,s,!1):n.defaultValue!=null&&Rv(t,!!n.multiple,n.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=oE)}switch(i){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return us(e),null;case 6:if(t&&e.stateNode!=null)AY(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(it(166));if(i=pp(h_.current),pp(Fc.current),qb(e)){if(n=e.stateNode,i=e.memoizedProps,n[Mc]=e,(s=n.nodeValue!==i)&&(t=Jo,t!==null))switch(t.tag){case 3:Xb(n.nodeValue,i,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Xb(n.nodeValue,i,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(i.nodeType===9?i:i.ownerDocument).createTextNode(n),n[Mc]=e,e.stateNode=n}return us(e),null;case 13:if(cn(vn),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(dn&&Ho!==null&&e.mode&1&&!(e.flags&128))Gq(),a0(),e.flags|=98560,s=!1;else if(s=qb(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(it(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(it(317));s[Mc]=e}else a0(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;us(e),s=!1}else Sl!==null&&(rL(Sl),Sl=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=i,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||vn.current&1?wr===0&&(wr=3):lN())),e.updateQueue!==null&&(e.flags|=4),us(e),null);case 4:return c0(),KI(t,e),t===null&&a_(e.stateNode.containerInfo),us(e),null;case 10:return WF(e.type._context),us(e),null;case 17:return po(e.type)&&aE(),us(e),null;case 19:if(cn(vn),s=e.memoizedState,s===null)return us(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)Ky(s,!1);else{if(wr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=pE(t),o!==null){for(e.flags|=128,Ky(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=i,i=e.child;i!==null;)s=i,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),i=i.sibling;return nn(vn,vn.current&1|2),e.child}t=t.sibling}s.tail!==null&&Yn()>h0&&(e.flags|=128,n=!0,Ky(s,!1),e.lanes=4194304)}else{if(!n)if(t=pE(o),t!==null){if(e.flags|=128,n=!0,i=t.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),Ky(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!dn)return us(e),null}else 2*Yn()-s.renderingStartTime>h0&&i!==1073741824&&(e.flags|=128,n=!0,Ky(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(i=s.last,i!==null?i.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Yn(),e.sibling=null,i=vn.current,nn(vn,n?i&1|2:i&1),e):(us(e),null);case 22:case 23:return aN(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?No&1073741824&&(us(e),e.subtreeFlags&6&&(e.flags|=8192)):us(e),null;case 24:return null;case 25:return null}throw Error(it(156,e.tag))}function Rae(t,e){switch(GF(e),e.tag){case 1:return po(e.type)&&aE(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return c0(),cn(fo),cn(Ss),KF(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return QF(e),null;case 13:if(cn(vn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(it(340));a0()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return cn(vn),null;case 4:return c0(),null;case 10:return WF(e.type._context),null;case 22:case 23:return aN(),null;case 24:return null;default:return null}}var Kb=!1,gs=!1,Iae=typeof WeakSet=="function"?WeakSet:Set,_t=null;function cv(t,e){var i=t.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(n){In(t,e,n)}else i.current=null}function JI(t,e,i){try{i()}catch(n){In(t,e,n)}}var hH=!1;function Lae(t,e){if(BI=nE,t=Cq(),kF(t)){if("selectionStart"in t)var i={start:t.selectionStart,end:t.selectionEnd};else e:{i=(i=t.ownerDocument)&&i.defaultView||window;var n=i.getSelection&&i.getSelection();if(n&&n.rangeCount!==0){i=n.anchorNode;var r=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{i.nodeType,s.nodeType}catch{i=null;break e}var o=0,a=-1,l=-1,c=0,h=0,u=t,d=null;t:for(;;){for(var f;u!==i||r!==0&&u.nodeType!==3||(a=o+r),u!==s||n!==0&&u.nodeType!==3||(l=o+n),u.nodeType===3&&(o+=u.nodeValue.length),(f=u.firstChild)!==null;)d=u,u=f;for(;;){if(u===t)break t;if(d===i&&++c===r&&(a=o),d===s&&++h===n&&(l=o),(f=u.nextSibling)!==null)break;u=d,d=u.parentNode}u=f}i=a===-1||l===-1?null:{start:a,end:l}}else i=null}i=i||{start:0,end:0}}else i=null;for(OI={focusedElem:t,selectionRange:i},nE=!1,_t=e;_t!==null;)if(e=_t,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,_t=t;else for(;_t!==null;){e=_t;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,v=p.memoizedState,g=e.stateNode,y=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:_l(e.type,m),v);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(it(163))}}catch(b){In(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,_t=t;break}_t=e.return}return p=hH,hH=!1,p}function _1(t,e,i){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var r=n=n.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,s!==void 0&&JI(e,i,s)}r=r.next}while(r!==n)}}function eC(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var i=e=e.next;do{if((i.tag&t)===t){var n=i.create;i.destroy=n()}i=i.next}while(i!==e)}}function ZI(t){var e=t.ref;if(e!==null){var i=t.stateNode;switch(t.tag){case 5:t=i;break;default:t=i}typeof e=="function"?e(t):e.current=t}}function MY(t){var e=t.alternate;e!==null&&(t.alternate=null,MY(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Mc],delete e[c_],delete e[UI],delete e[mae],delete e[gae])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function EY(t){return t.tag===5||t.tag===3||t.tag===4}function dH(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||EY(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function $I(t,e,i){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?i.nodeType===8?i.parentNode.insertBefore(t,e):i.insertBefore(t,e):(i.nodeType===8?(e=i.parentNode,e.insertBefore(t,i)):(e=i,e.appendChild(t)),i=i._reactRootContainer,i!=null||e.onclick!==null||(e.onclick=oE));else if(n!==4&&(t=t.child,t!==null))for($I(t,e,i),t=t.sibling;t!==null;)$I(t,e,i),t=t.sibling}function eL(t,e,i){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?i.insertBefore(t,e):i.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(eL(t,e,i),t=t.sibling;t!==null;)eL(t,e,i),t=t.sibling}var Yr=null,bl=!1;function Ph(t,e,i){for(i=i.child;i!==null;)TY(t,e,i),i=i.sibling}function TY(t,e,i){if(Oc&&typeof Oc.onCommitFiberUnmount=="function")try{Oc.onCommitFiberUnmount(XT,i)}catch{}switch(i.tag){case 5:gs||cv(i,e);case 6:var n=Yr,r=bl;Yr=null,Ph(t,e,i),Yr=n,bl=r,Yr!==null&&(bl?(t=Yr,i=i.stateNode,t.nodeType===8?t.parentNode.removeChild(i):t.removeChild(i)):Yr.removeChild(i.stateNode));break;case 18:Yr!==null&&(bl?(t=Yr,i=i.stateNode,t.nodeType===8?VP(t.parentNode,i):t.nodeType===1&&VP(t,i),r_(t)):VP(Yr,i.stateNode));break;case 4:n=Yr,r=bl,Yr=i.stateNode.containerInfo,bl=!0,Ph(t,e,i),Yr=n,bl=r;break;case 0:case 11:case 14:case 15:if(!gs&&(n=i.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){r=n=n.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&JI(i,e,o),r=r.next}while(r!==n)}Ph(t,e,i);break;case 1:if(!gs&&(cv(i,e),n=i.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=i.memoizedProps,n.state=i.memoizedState,n.componentWillUnmount()}catch(a){In(i,e,a)}Ph(t,e,i);break;case 21:Ph(t,e,i);break;case 22:i.mode&1?(gs=(n=gs)||i.memoizedState!==null,Ph(t,e,i),gs=n):Ph(t,e,i);break;default:Ph(t,e,i)}}function fH(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var i=t.stateNode;i===null&&(i=t.stateNode=new Iae),e.forEach(function(n){var r=Hae.bind(null,t,n);i.has(n)||(i.add(n),n.then(r,r))})}}function al(t,e){var i=e.deletions;if(i!==null)for(var n=0;n<i.length;n++){var r=i[n];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Yr=a.stateNode,bl=!1;break e;case 3:Yr=a.stateNode.containerInfo,bl=!0;break e;case 4:Yr=a.stateNode.containerInfo,bl=!0;break e}a=a.return}if(Yr===null)throw Error(it(160));TY(s,o,r),Yr=null,bl=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){In(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)CY(e,t),e=e.sibling}function CY(t,e){var i=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(al(e,t),rc(t),n&4){try{_1(3,t,t.return),eC(3,t)}catch(m){In(t,t.return,m)}try{_1(5,t,t.return)}catch(m){In(t,t.return,m)}}break;case 1:al(e,t),rc(t),n&512&&i!==null&&cv(i,i.return);break;case 5:if(al(e,t),rc(t),n&512&&i!==null&&cv(i,i.return),t.flags&32){var r=t.stateNode;try{e_(r,"")}catch(m){In(t,t.return,m)}}if(n&4&&(r=t.stateNode,r!=null)){var s=t.memoizedProps,o=i!==null?i.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&QX(r,s),AI(a,o);var c=AI(a,s);for(o=0;o<l.length;o+=2){var h=l[o],u=l[o+1];h==="style"?eq(r,u):h==="dangerouslySetInnerHTML"?ZX(r,u):h==="children"?e_(r,u):EF(r,h,u,c)}switch(a){case"input":xI(r,s);break;case"textarea":KX(r,s);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?Rv(r,!!s.multiple,f,!1):d!==!!s.multiple&&(s.defaultValue!=null?Rv(r,!!s.multiple,s.defaultValue,!0):Rv(r,!!s.multiple,s.multiple?[]:"",!1))}r[c_]=s}catch(m){In(t,t.return,m)}}break;case 6:if(al(e,t),rc(t),n&4){if(t.stateNode===null)throw Error(it(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(m){In(t,t.return,m)}}break;case 3:if(al(e,t),rc(t),n&4&&i!==null&&i.memoizedState.isDehydrated)try{r_(e.containerInfo)}catch(m){In(t,t.return,m)}break;case 4:al(e,t),rc(t);break;case 13:al(e,t),rc(t),r=t.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(sN=Yn())),n&4&&fH(t);break;case 22:if(h=i!==null&&i.memoizedState!==null,t.mode&1?(gs=(c=gs)||h,al(e,t),gs=c):al(e,t),rc(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!h&&t.mode&1)for(_t=t,h=t.child;h!==null;){for(u=_t=h;_t!==null;){switch(d=_t,f=d.child,d.tag){case 0:case 11:case 14:case 15:_1(4,d,d.return);break;case 1:cv(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){n=d,i=d.return;try{e=n,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){In(n,i,m)}}break;case 5:cv(d,d.return);break;case 22:if(d.memoizedState!==null){mH(u);continue}}f!==null?(f.return=d,_t=f):mH(u)}h=h.sibling}e:for(h=null,u=t;;){if(u.tag===5){if(h===null){h=u;try{r=u.stateNode,c?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=u.stateNode,l=u.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=$X("display",o))}catch(m){In(t,t.return,m)}}}else if(u.tag===6){if(h===null)try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(m){In(t,t.return,m)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===t)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===t)break e;for(;u.sibling===null;){if(u.return===null||u.return===t)break e;h===u&&(h=null),u=u.return}h===u&&(h=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:al(e,t),rc(t),n&4&&fH(t);break;case 21:break;default:al(e,t),rc(t)}}function rc(t){var e=t.flags;if(e&2){try{e:{for(var i=t.return;i!==null;){if(EY(i)){var n=i;break e}i=i.return}throw Error(it(160))}switch(n.tag){case 5:var r=n.stateNode;n.flags&32&&(e_(r,""),n.flags&=-33);var s=dH(t);eL(t,s,r);break;case 3:case 4:var o=n.stateNode.containerInfo,a=dH(t);$I(t,a,o);break;default:throw Error(it(161))}}catch(l){In(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Bae(t,e,i){_t=t,PY(t)}function PY(t,e,i){for(var n=(t.mode&1)!==0;_t!==null;){var r=_t,s=r.child;if(r.tag===22&&n){var o=r.memoizedState!==null||Kb;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||gs;a=Kb;var c=gs;if(Kb=o,(gs=l)&&!c)for(_t=r;_t!==null;)o=_t,l=o.child,o.tag===22&&o.memoizedState!==null?gH(r):l!==null?(l.return=o,_t=l):gH(r);for(;s!==null;)_t=s,PY(s),s=s.sibling;_t=r,Kb=a,gs=c}pH(t)}else r.subtreeFlags&8772&&s!==null?(s.return=r,_t=s):pH(t)}}function pH(t){for(;_t!==null;){var e=_t;if(e.flags&8772){var i=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:gs||eC(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!gs)if(i===null)n.componentDidMount();else{var r=e.elementType===e.type?i.memoizedProps:_l(e.type,i.memoizedProps);n.componentDidUpdate(r,i.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&JG(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(i=null,e.child!==null)switch(e.child.tag){case 5:i=e.child.stateNode;break;case 1:i=e.child.stateNode}JG(e,o,i)}break;case 5:var a=e.stateNode;if(i===null&&e.flags&4){i=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&i.focus();break;case"img":l.src&&(i.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var h=c.memoizedState;if(h!==null){var u=h.dehydrated;u!==null&&r_(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(it(163))}gs||e.flags&512&&ZI(e)}catch(d){In(e,e.return,d)}}if(e===t){_t=null;break}if(i=e.sibling,i!==null){i.return=e.return,_t=i;break}_t=e.return}}function mH(t){for(;_t!==null;){var e=_t;if(e===t){_t=null;break}var i=e.sibling;if(i!==null){i.return=e.return,_t=i;break}_t=e.return}}function gH(t){for(;_t!==null;){var e=_t;try{switch(e.tag){case 0:case 11:case 15:var i=e.return;try{eC(4,e)}catch(l){In(e,i,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var r=e.return;try{n.componentDidMount()}catch(l){In(e,r,l)}}var s=e.return;try{ZI(e)}catch(l){In(e,s,l)}break;case 5:var o=e.return;try{ZI(e)}catch(l){In(e,o,l)}}}catch(l){In(e,e.return,l)}if(e===t){_t=null;break}var a=e.sibling;if(a!==null){a.return=e.return,_t=a;break}_t=e.return}}var Oae=Math.ceil,vE=gh.ReactCurrentDispatcher,nN=gh.ReactCurrentOwner,Xa=gh.ReactCurrentBatchConfig,Ei=0,zr=null,cr=null,$r=0,No=0,uv=of(0),wr=0,m_=null,Zp=0,tC=0,rN=0,w1=null,eo=null,sN=0,h0=1/0,Iu=null,yE=!1,tL=null,Ed=null,Jb=!1,ud=null,xE=0,b1=0,iL=null,wM=-1,bM=0;function Hs(){return Ei&6?Yn():wM!==-1?wM:wM=Yn()}function Td(t){return t.mode&1?Ei&2&&$r!==0?$r&-$r:yae.transition!==null?(bM===0&&(bM=dq()),bM):(t=Vi,t!==0||(t=window.event,t=t===void 0?16:xq(t.type)),t):1}function Il(t,e,i,n){if(50<b1)throw b1=0,iL=null,Error(it(185));sw(t,i,n),(!(Ei&2)||t!==zr)&&(t===zr&&(!(Ei&2)&&(tC|=i),wr===4&&sd(t,$r)),mo(t,n),i===1&&Ei===0&&!(e.mode&1)&&(h0=Yn()+500,JT&&af()))}function mo(t,e){var i=t.callbackNode;yoe(t,e);var n=iE(t,t===zr?$r:0);if(n===0)i!==null&&MG(i),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(i!=null&&MG(i),e===1)t.tag===0?vae(vH.bind(null,t)):Uq(vH.bind(null,t)),fae(function(){!(Ei&6)&&af()}),i=null;else{switch(fq(n)){case 1:i=RF;break;case 4:i=uq;break;case 16:i=tE;break;case 536870912:i=hq;break;default:i=tE}i=NY(i,DY.bind(null,t))}t.callbackPriority=e,t.callbackNode=i}}function DY(t,e){if(wM=-1,bM=0,Ei&6)throw Error(it(327));var i=t.callbackNode;if(Fv()&&t.callbackNode!==i)return null;var n=iE(t,t===zr?$r:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=_E(t,n);else{e=n;var r=Ei;Ei|=2;var s=IY();(zr!==t||$r!==e)&&(Iu=null,h0=Yn()+500,Pp(t,e));do try{Uae();break}catch(a){RY(t,a)}while(1);jF(),vE.current=s,Ei=r,cr!==null?e=0:(zr=null,$r=0,e=wr)}if(e!==0){if(e===2&&(r=PI(t),r!==0&&(n=r,e=nL(t,r))),e===1)throw i=m_,Pp(t,0),sd(t,n),mo(t,Yn()),i;if(e===6)sd(t,n);else{if(r=t.current.alternate,!(n&30)&&!Fae(r)&&(e=_E(t,n),e===2&&(s=PI(t),s!==0&&(n=s,e=nL(t,s))),e===1))throw i=m_,Pp(t,0),sd(t,n),mo(t,Yn()),i;switch(t.finishedWork=r,t.finishedLanes=n,e){case 0:case 1:throw Error(it(345));case 2:Yf(t,eo,Iu);break;case 3:if(sd(t,n),(n&130023424)===n&&(e=sN+500-Yn(),10<e)){if(iE(t,0)!==0)break;if(r=t.suspendedLanes,(r&n)!==n){Hs(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=NI(Yf.bind(null,t,eo,Iu),e);break}Yf(t,eo,Iu);break;case 4:if(sd(t,n),(n&4194240)===n)break;for(e=t.eventTimes,r=-1;0<n;){var o=31-Rl(n);s=1<<o,o=e[o],o>r&&(r=o),n&=~s}if(n=r,n=Yn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Oae(n/1960))-n,10<n){t.timeoutHandle=NI(Yf.bind(null,t,eo,Iu),n);break}Yf(t,eo,Iu);break;case 5:Yf(t,eo,Iu);break;default:throw Error(it(329))}}}return mo(t,Yn()),t.callbackNode===i?DY.bind(null,t):null}function nL(t,e){var i=w1;return t.current.memoizedState.isDehydrated&&(Pp(t,e).flags|=256),t=_E(t,e),t!==2&&(e=eo,eo=i,e!==null&&rL(e)),t}function rL(t){eo===null?eo=t:eo.push.apply(eo,t)}function Fae(t){for(var e=t;;){if(e.flags&16384){var i=e.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var n=0;n<i.length;n++){var r=i[n],s=r.getSnapshot;r=r.value;try{if(!kl(s(),r))return!1}catch{return!1}}}if(i=e.child,e.subtreeFlags&16384&&i!==null)i.return=e,e=i;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function sd(t,e){for(e&=~rN,e&=~tC,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var i=31-Rl(e),n=1<<i;t[i]=-1,e&=~n}}function vH(t){if(Ei&6)throw Error(it(327));Fv();var e=iE(t,0);if(!(e&1))return mo(t,Yn()),null;var i=_E(t,e);if(t.tag!==0&&i===2){var n=PI(t);n!==0&&(e=n,i=nL(t,n))}if(i===1)throw i=m_,Pp(t,0),sd(t,e),mo(t,Yn()),i;if(i===6)throw Error(it(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Yf(t,eo,Iu),mo(t,Yn()),null}function oN(t,e){var i=Ei;Ei|=1;try{return t(e)}finally{Ei=i,Ei===0&&(h0=Yn()+500,JT&&af())}}function $p(t){ud!==null&&ud.tag===0&&!(Ei&6)&&Fv();var e=Ei;Ei|=1;var i=Xa.transition,n=Vi;try{if(Xa.transition=null,Vi=1,t)return t()}finally{Vi=n,Xa.transition=i,Ei=e,!(Ei&6)&&af()}}function aN(){No=uv.current,cn(uv)}function Pp(t,e){t.finishedWork=null,t.finishedLanes=0;var i=t.timeoutHandle;if(i!==-1&&(t.timeoutHandle=-1,dae(i)),cr!==null)for(i=cr.return;i!==null;){var n=i;switch(GF(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&aE();break;case 3:c0(),cn(fo),cn(Ss),KF();break;case 5:QF(n);break;case 4:c0();break;case 13:cn(vn);break;case 19:cn(vn);break;case 10:WF(n.type._context);break;case 22:case 23:aN()}i=i.return}if(zr=t,cr=t=Cd(t.current,null),$r=No=e,wr=0,m_=null,rN=tC=Zp=0,eo=w1=null,fp!==null){for(e=0;e<fp.length;e++)if(i=fp[e],n=i.interleaved,n!==null){i.interleaved=null;var r=n.next,s=i.pending;if(s!==null){var o=s.next;s.next=r,n.next=o}i.pending=n}fp=null}return t}function RY(t,e){do{var i=cr;try{if(jF(),yM.current=gE,mE){for(var n=Mn.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}mE=!1}if(Jp=0,Or=xr=Mn=null,x1=!1,d_=0,nN.current=null,i===null||i.return===null){wr=1,m_=e,cr=null;break}e:{var s=t,o=i.return,a=i,l=e;if(e=$r,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,h=a,u=h.tag;if(!(h.mode&1)&&(u===0||u===11||u===15)){var d=h.alternate;d?(h.updateQueue=d.updateQueue,h.memoizedState=d.memoizedState,h.lanes=d.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=rH(o);if(f!==null){f.flags&=-257,sH(f,o,a,s,e),f.mode&1&&nH(s,c,e),e=f,l=c;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){nH(s,c,e),lN();break e}l=Error(it(426))}}else if(dn&&a.mode&1){var v=rH(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),sH(v,o,a,s,e),HF(u0(l,a));break e}}s=l=u0(l,a),wr!==4&&(wr=2),w1===null?w1=[s]:w1.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var g=pY(s,l,e);KG(s,g);break e;case 1:a=l;var y=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Ed===null||!Ed.has(x)))){s.flags|=65536,e&=-e,s.lanes|=e;var b=mY(s,a,e);KG(s,b);break e}}s=s.return}while(s!==null)}BY(i)}catch(S){e=S,cr===i&&i!==null&&(cr=i=i.return);continue}break}while(1)}function IY(){var t=vE.current;return vE.current=gE,t===null?gE:t}function lN(){(wr===0||wr===3||wr===2)&&(wr=4),zr===null||!(Zp&268435455)&&!(tC&268435455)||sd(zr,$r)}function _E(t,e){var i=Ei;Ei|=2;var n=IY();(zr!==t||$r!==e)&&(Iu=null,Pp(t,e));do try{Nae();break}catch(r){RY(t,r)}while(1);if(jF(),Ei=i,vE.current=n,cr!==null)throw Error(it(261));return zr=null,$r=0,wr}function Nae(){for(;cr!==null;)LY(cr)}function Uae(){for(;cr!==null&&!coe();)LY(cr)}function LY(t){var e=FY(t.alternate,t,No);t.memoizedProps=t.pendingProps,e===null?BY(t):cr=e,nN.current=null}function BY(t){var e=t;do{var i=e.alternate;if(t=e.return,e.flags&32768){if(i=Rae(i,e),i!==null){i.flags&=32767,cr=i;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{wr=6,cr=null;return}}else if(i=Dae(i,e,No),i!==null){cr=i;return}if(e=e.sibling,e!==null){cr=e;return}cr=e=t}while(e!==null);wr===0&&(wr=5)}function Yf(t,e,i){var n=Vi,r=Xa.transition;try{Xa.transition=null,Vi=1,kae(t,e,i,n)}finally{Xa.transition=r,Vi=n}return null}function kae(t,e,i,n){do Fv();while(ud!==null);if(Ei&6)throw Error(it(327));i=t.finishedWork;var r=t.finishedLanes;if(i===null)return null;if(t.finishedWork=null,t.finishedLanes=0,i===t.current)throw Error(it(177));t.callbackNode=null,t.callbackPriority=0;var s=i.lanes|i.childLanes;if(xoe(t,s),t===zr&&(cr=zr=null,$r=0),!(i.subtreeFlags&2064)&&!(i.flags&2064)||Jb||(Jb=!0,NY(tE,function(){return Fv(),null})),s=(i.flags&15990)!==0,i.subtreeFlags&15990||s){s=Xa.transition,Xa.transition=null;var o=Vi;Vi=1;var a=Ei;Ei|=4,nN.current=null,Lae(t,i),CY(i,t),sae(OI),nE=!!BI,OI=BI=null,t.current=i,Bae(i),uoe(),Ei=a,Vi=o,Xa.transition=s}else t.current=i;if(Jb&&(Jb=!1,ud=t,xE=r),s=t.pendingLanes,s===0&&(Ed=null),foe(i.stateNode),mo(t,Yn()),e!==null)for(n=t.onRecoverableError,i=0;i<e.length;i++)r=e[i],n(r.value,{componentStack:r.stack,digest:r.digest});if(yE)throw yE=!1,t=tL,tL=null,t;return xE&1&&t.tag!==0&&Fv(),s=t.pendingLanes,s&1?t===iL?b1++:(b1=0,iL=t):b1=0,af(),null}function Fv(){if(ud!==null){var t=fq(xE),e=Xa.transition,i=Vi;try{if(Xa.transition=null,Vi=16>t?16:t,ud===null)var n=!1;else{if(t=ud,ud=null,xE=0,Ei&6)throw Error(it(331));var r=Ei;for(Ei|=4,_t=t.current;_t!==null;){var s=_t,o=s.child;if(_t.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(_t=c;_t!==null;){var h=_t;switch(h.tag){case 0:case 11:case 15:_1(8,h,s)}var u=h.child;if(u!==null)u.return=h,_t=u;else for(;_t!==null;){h=_t;var d=h.sibling,f=h.return;if(MY(h),h===c){_t=null;break}if(d!==null){d.return=f,_t=d;break}_t=f}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(m!==null)}}_t=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,_t=o;else e:for(;_t!==null;){if(s=_t,s.flags&2048)switch(s.tag){case 0:case 11:case 15:_1(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,_t=g;break e}_t=s.return}}var y=t.current;for(_t=y;_t!==null;){o=_t;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,_t=x;else e:for(o=y;_t!==null;){if(a=_t,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:eC(9,a)}}catch(S){In(a,a.return,S)}if(a===o){_t=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,_t=b;break e}_t=a.return}}if(Ei=r,af(),Oc&&typeof Oc.onPostCommitFiberRoot=="function")try{Oc.onPostCommitFiberRoot(XT,t)}catch{}n=!0}return n}finally{Vi=i,Xa.transition=e}}return!1}function yH(t,e,i){e=u0(i,e),e=pY(t,e,1),t=Md(t,e,1),e=Hs(),t!==null&&(sw(t,1,e),mo(t,e))}function In(t,e,i){if(t.tag===3)yH(t,t,i);else for(;e!==null;){if(e.tag===3){yH(e,t,i);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ed===null||!Ed.has(n))){t=u0(i,t),t=mY(e,t,1),e=Md(e,t,1),t=Hs(),e!==null&&(sw(e,1,t),mo(e,t));break}}e=e.return}}function zae(t,e,i){var n=t.pingCache;n!==null&&n.delete(e),e=Hs(),t.pingedLanes|=t.suspendedLanes&i,zr===t&&($r&i)===i&&(wr===4||wr===3&&($r&130023424)===$r&&500>Yn()-sN?Pp(t,0):rN|=i),mo(t,e)}function OY(t,e){e===0&&(t.mode&1?(e=Gb,Gb<<=1,!(Gb&130023424)&&(Gb=4194304)):e=1);var i=Hs();t=ah(t,e),t!==null&&(sw(t,e,i),mo(t,i))}function Gae(t){var e=t.memoizedState,i=0;e!==null&&(i=e.retryLane),OY(t,i)}function Hae(t,e){var i=0;switch(t.tag){case 13:var n=t.stateNode,r=t.memoizedState;r!==null&&(i=r.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(it(314))}n!==null&&n.delete(e),OY(t,i)}var FY;FY=function(t,e,i){if(t!==null)if(t.memoizedProps!==e.pendingProps||fo.current)ao=!0;else{if(!(t.lanes&i)&&!(e.flags&128))return ao=!1,Pae(t,e,i);ao=!!(t.flags&131072)}else ao=!1,dn&&e.flags&1048576&&kq(e,uE,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;_M(t,e),t=e.pendingProps;var r=o0(e,Ss.current);Ov(e,i),r=ZF(null,e,n,t,r,i);var s=$F();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,po(n)?(s=!0,lE(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,qF(e),r.updater=ZT,e.stateNode=r,r._reactInternals=e,jI(e,n,t,i),e=qI(null,e,n,!0,s,i)):(e.tag=0,dn&&s&&zF(e),Us(null,e,r,i),e=e.child),e;case 16:n=e.elementType;e:{switch(_M(t,e),t=e.pendingProps,r=n._init,n=r(n._payload),e.type=n,r=e.tag=jae(n),t=_l(n,t),r){case 0:e=XI(null,e,n,t,i);break e;case 1:e=lH(null,e,n,t,i);break e;case 11:e=oH(null,e,n,t,i);break e;case 14:e=aH(null,e,n,_l(n.type,t),i);break e}throw Error(it(306,n,""))}return e;case 0:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:_l(n,r),XI(t,e,n,r,i);case 1:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:_l(n,r),lH(t,e,n,r,i);case 3:e:{if(xY(e),t===null)throw Error(it(387));n=e.pendingProps,s=e.memoizedState,r=s.element,Vq(t,e),fE(e,n,null,i);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=u0(Error(it(423)),e),e=cH(t,e,n,i,r);break e}else if(n!==r){r=u0(Error(it(424)),e),e=cH(t,e,n,i,r);break e}else for(Ho=Ad(e.stateNode.containerInfo.firstChild),Jo=e,dn=!0,Sl=null,i=qq(e,null,n,i),e.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(a0(),n===r){e=lh(t,e,i);break e}Us(t,e,n,i)}e=e.child}return e;case 5:return Yq(e),t===null&&GI(e),n=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,o=r.children,FI(n,r)?o=null:s!==null&&FI(n,s)&&(e.flags|=32),yY(t,e),Us(t,e,o,i),e.child;case 6:return t===null&&GI(e),null;case 13:return _Y(t,e,i);case 4:return YF(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=l0(e,null,n,i):Us(t,e,n,i),e.child;case 11:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:_l(n,r),oH(t,e,n,r,i);case 7:return Us(t,e,e.pendingProps,i),e.child;case 8:return Us(t,e,e.pendingProps.children,i),e.child;case 12:return Us(t,e,e.pendingProps.children,i),e.child;case 10:e:{if(n=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,nn(hE,n._currentValue),n._currentValue=o,s!==null)if(kl(s.value,o)){if(s.children===r.children&&!fo.current){e=lh(t,e,i);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Zu(-1,i&-i),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var h=c.pending;h===null?l.next=l:(l.next=h.next,h.next=l),c.pending=l}}s.lanes|=i,l=s.alternate,l!==null&&(l.lanes|=i),HI(s.return,i,e),a.lanes|=i;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(it(341));o.lanes|=i,a=o.alternate,a!==null&&(a.lanes|=i),HI(o,i,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Us(t,e,r.children,i),e=e.child}return e;case 9:return r=e.type,n=e.pendingProps.children,Ov(e,i),r=Ka(r),n=n(r),e.flags|=1,Us(t,e,n,i),e.child;case 14:return n=e.type,r=_l(n,e.pendingProps),r=_l(n.type,r),aH(t,e,n,r,i);case 15:return gY(t,e,e.type,e.pendingProps,i);case 17:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:_l(n,r),_M(t,e),e.tag=1,po(n)?(t=!0,lE(e)):t=!1,Ov(e,i),Wq(e,n,r),jI(e,n,r,i),qI(null,e,n,!0,t,i);case 19:return wY(t,e,i);case 22:return vY(t,e,i)}throw Error(it(156,e.tag))};function NY(t,e){return cq(t,e)}function Vae(t,e,i,n){this.tag=t,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ha(t,e,i,n){return new Vae(t,e,i,n)}function cN(t){return t=t.prototype,!(!t||!t.isReactComponent)}function jae(t){if(typeof t=="function")return cN(t)?1:0;if(t!=null){if(t=t.$$typeof,t===CF)return 11;if(t===PF)return 14}return 2}function Cd(t,e){var i=t.alternate;return i===null?(i=Ha(t.tag,e,t.key,t.mode),i.elementType=t.elementType,i.type=t.type,i.stateNode=t.stateNode,i.alternate=t,t.alternate=i):(i.pendingProps=e,i.type=t.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=t.flags&14680064,i.childLanes=t.childLanes,i.lanes=t.lanes,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,e=t.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},i.sibling=t.sibling,i.index=t.index,i.ref=t.ref,i}function SM(t,e,i,n,r,s){var o=2;if(n=t,typeof t=="function")cN(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ev:return Dp(i.children,r,s,e);case TF:o=8,r|=8;break;case pI:return t=Ha(12,i,e,r|2),t.elementType=pI,t.lanes=s,t;case mI:return t=Ha(13,i,e,r),t.elementType=mI,t.lanes=s,t;case gI:return t=Ha(19,i,e,r),t.elementType=gI,t.lanes=s,t;case XX:return iC(i,r,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case jX:o=10;break e;case WX:o=9;break e;case CF:o=11;break e;case PF:o=14;break e;case Zh:o=16,n=null;break e}throw Error(it(130,t==null?t:typeof t,""))}return e=Ha(o,i,e,r),e.elementType=t,e.type=n,e.lanes=s,e}function Dp(t,e,i,n){return t=Ha(7,t,n,e),t.lanes=i,t}function iC(t,e,i,n){return t=Ha(22,t,n,e),t.elementType=XX,t.lanes=i,t.stateNode={isHidden:!1},t}function JP(t,e,i){return t=Ha(6,t,null,e),t.lanes=i,t}function ZP(t,e,i){return e=Ha(4,t.children!==null?t.children:[],t.key,e),e.lanes=i,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Wae(t,e,i,n,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=IP(0),this.expirationTimes=IP(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=IP(0),this.identifierPrefix=n,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function uN(t,e,i,n,r,s,o,a,l){return t=new Wae(t,e,i,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Ha(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},qF(s),t}function Xae(t,e,i){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$g,key:n==null?null:""+n,children:t,containerInfo:e,implementation:i}}function UY(t){if(!t)return Wd;t=t._reactInternals;e:{if(fm(t)!==t||t.tag!==1)throw Error(it(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(po(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(it(171))}if(t.tag===1){var i=t.type;if(po(i))return Nq(t,i,e)}return e}function kY(t,e,i,n,r,s,o,a,l){return t=uN(i,n,!0,t,r,s,o,a,l),t.context=UY(null),i=t.current,n=Hs(),r=Td(i),s=Zu(n,r),s.callback=e??null,Md(i,s,r),t.current.lanes=r,sw(t,r,n),mo(t,n),t}function nC(t,e,i,n){var r=e.current,s=Hs(),o=Td(r);return i=UY(i),e.context===null?e.context=i:e.pendingContext=i,e=Zu(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Md(r,e,o),t!==null&&(Il(t,r,o,s),vM(t,r,o)),o}function wE(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function xH(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var i=t.retryLane;t.retryLane=i!==0&&i<e?i:e}}function hN(t,e){xH(t,e),(t=t.alternate)&&xH(t,e)}function qae(){return null}var zY=typeof reportError=="function"?reportError:function(t){console.error(t)};function dN(t){this._internalRoot=t}rC.prototype.render=dN.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(it(409));nC(t,e,null,null)};rC.prototype.unmount=dN.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;$p(function(){nC(null,t,null,null)}),e[oh]=null}};function rC(t){this._internalRoot=t}rC.prototype.unstable_scheduleHydration=function(t){if(t){var e=gq();t={blockedOn:null,target:t,priority:e};for(var i=0;i<rd.length&&e!==0&&e<rd[i].priority;i++);rd.splice(i,0,t),i===0&&yq(t)}};function fN(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function sC(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function _H(){}function Yae(t,e,i,n,r){if(r){if(typeof n=="function"){var s=n;n=function(){var c=wE(o);s.call(c)}}var o=kY(e,n,t,0,null,!1,!1,"",_H);return t._reactRootContainer=o,t[oh]=o.current,a_(t.nodeType===8?t.parentNode:t),$p(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof n=="function"){var a=n;n=function(){var c=wE(l);a.call(c)}}var l=uN(t,0,!1,null,null,!1,!1,"",_H);return t._reactRootContainer=l,t[oh]=l.current,a_(t.nodeType===8?t.parentNode:t),$p(function(){nC(e,l,i,n)}),l}function oC(t,e,i,n,r){var s=i._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=wE(o);a.call(l)}}nC(e,o,t,r)}else o=Yae(i,e,t,r,n);return wE(o)}pq=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var i=Kx(e.pendingLanes);i!==0&&(IF(e,i|1),mo(e,Yn()),!(Ei&6)&&(h0=Yn()+500,af()))}break;case 13:$p(function(){var n=ah(t,1);if(n!==null){var r=Hs();Il(n,t,1,r)}}),hN(t,1)}};LF=function(t){if(t.tag===13){var e=ah(t,134217728);if(e!==null){var i=Hs();Il(e,t,134217728,i)}hN(t,134217728)}};mq=function(t){if(t.tag===13){var e=Td(t),i=ah(t,e);if(i!==null){var n=Hs();Il(i,t,e,n)}hN(t,e)}};gq=function(){return Vi};vq=function(t,e){var i=Vi;try{return Vi=t,e()}finally{Vi=i}};EI=function(t,e,i){switch(e){case"input":if(xI(t,i),e=i.name,i.type==="radio"&&e!=null){for(i=t;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<i.length;e++){var n=i[e];if(n!==t&&n.form===t.form){var r=KT(n);if(!r)throw Error(it(90));YX(n),xI(n,r)}}}break;case"textarea":KX(t,i);break;case"select":e=i.value,e!=null&&Rv(t,!!i.multiple,e,!1)}};nq=oN;rq=$p;var Qae={usingClientEntryPoint:!1,Events:[aw,rv,KT,tq,iq,oN]},Jy={findFiberByHostInstance:dp,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Kae={bundleType:Jy.bundleType,version:Jy.version,rendererPackageName:Jy.rendererPackageName,rendererConfig:Jy.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:gh.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=aq(t),t===null?null:t.stateNode},findFiberByHostInstance:Jy.findFiberByHostInstance||qae,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zb=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zb.isDisabled&&Zb.supportsFiber)try{XT=Zb.inject(Kae),Oc=Zb}catch{}}aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Qae;aa.createPortal=function(t,e){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!fN(e))throw Error(it(200));return Xae(t,e,null,i)};aa.createRoot=function(t,e){if(!fN(t))throw Error(it(299));var i=!1,n="",r=zY;return e!=null&&(e.unstable_strictMode===!0&&(i=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=uN(t,1,!1,null,null,i,!1,n,r),t[oh]=e.current,a_(t.nodeType===8?t.parentNode:t),new dN(e)};aa.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(it(188)):(t=Object.keys(t).join(","),Error(it(268,t)));return t=aq(e),t=t===null?null:t.stateNode,t};aa.flushSync=function(t){return $p(t)};aa.hydrate=function(t,e,i){if(!sC(e))throw Error(it(200));return oC(null,t,e,!0,i)};aa.hydrateRoot=function(t,e,i){if(!fN(t))throw Error(it(405));var n=i!=null&&i.hydratedSources||null,r=!1,s="",o=zY;if(i!=null&&(i.unstable_strictMode===!0&&(r=!0),i.identifierPrefix!==void 0&&(s=i.identifierPrefix),i.onRecoverableError!==void 0&&(o=i.onRecoverableError)),e=kY(e,null,t,1,i??null,r,!1,s,o),t[oh]=e.current,a_(t),n)for(t=0;t<n.length;t++)i=n[t],r=i._getVersion,r=r(i._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[i,r]:e.mutableSourceEagerHydrationData.push(i,r);return new rC(e)};aa.render=function(t,e,i){if(!sC(e))throw Error(it(200));return oC(null,t,e,!1,i)};aa.unmountComponentAtNode=function(t){if(!sC(t))throw Error(it(40));return t._reactRootContainer?($p(function(){oC(null,null,t,!1,function(){t._reactRootContainer=null,t[oh]=null})}),!0):!1};aa.unstable_batchedUpdates=oN;aa.unstable_renderSubtreeIntoContainer=function(t,e,i,n){if(!sC(i))throw Error(it(200));if(t==null||t._reactInternals===void 0)throw Error(it(38));return oC(t,e,i,!1,n)};aa.version="18.2.0-next-9e3b772b8-20220608";function GY(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(GY)}catch(t){console.error(t)}}GY(),kX.exports=aa;var Jae=kX.exports,HY,wH=Jae;HY=dI.createRoot=wH.createRoot,dI.hydrateRoot=wH.hydrateRoot;/**
 * @remix-run/router v1.7.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bE(){return bE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},bE.apply(this,arguments)}var mp;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(mp||(mp={}));const bH="popstate";function Zae(t){t===void 0&&(t={});function e(n,r){let{pathname:s,search:o,hash:a}=n.location;return sL("",{pathname:s,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function i(n,r){return typeof r=="string"?r:jY(r)}return ele(e,i,null,t)}function VY(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function $ae(){return Math.random().toString(36).substr(2,8)}function SH(t,e){return{usr:t.state,key:t.key,idx:e}}function sL(t,e,i,n){return i===void 0&&(i=null),bE({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?WY(e):e,{state:i,key:e&&e.key||n||$ae()})}function jY(t){let{pathname:e="/",search:i="",hash:n=""}=t;return i&&i!=="?"&&(e+=i.charAt(0)==="?"?i:"?"+i),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function WY(t){let e={};if(t){let i=t.indexOf("#");i>=0&&(e.hash=t.substr(i),t=t.substr(0,i));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function ele(t,e,i,n){n===void 0&&(n={});let{window:r=document.defaultView,v5Compat:s=!1}=n,o=r.history,a=mp.Pop,l=null,c=h();c==null&&(c=0,o.replaceState(bE({},o.state,{idx:c}),""));function h(){return(o.state||{idx:null}).idx}function u(){a=mp.Pop;let v=h(),g=v==null?null:v-c;c=v,l&&l({action:a,location:m.location,delta:g})}function d(v,g){a=mp.Push;let y=sL(m.location,v,g);i&&i(y,v),c=h()+1;let x=SH(y,c),b=m.createHref(y);try{o.pushState(x,"",b)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;r.location.assign(b)}s&&l&&l({action:a,location:m.location,delta:1})}function f(v,g){a=mp.Replace;let y=sL(m.location,v,g);i&&i(y,v),c=h();let x=SH(y,c),b=m.createHref(y);o.replaceState(x,"",b),s&&l&&l({action:a,location:m.location,delta:0})}function p(v){let g=r.location.origin!=="null"?r.location.origin:r.location.href,y=typeof v=="string"?v:jY(v);return VY(g,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,g)}let m={get action(){return a},get location(){return t(r,o)},listen(v){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(bH,u),l=v,()=>{r.removeEventListener(bH,u),l=null}},createHref(v){return e(r,v)},createURL:p,encodeLocation(v){let g=p(v);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:d,replace:f,go(v){return o.go(v)}};return m}var AH;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(AH||(AH={}));function tle(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let i=e.endsWith("/")?e.length-1:e.length,n=t.charAt(i);return n&&n!=="/"?null:t.slice(i)||"/"}const XY=["post","put","patch","delete"];new Set(XY);const ile=["get",...XY];new Set(ile);/**
 * React Router v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const nle=ye.createContext(null),qY=ye.createContext(null);function rle(){return ye.useContext(qY)!=null}var MH;(function(t){t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate"})(MH||(MH={}));var EH;(function(t){t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId"})(EH||(EH={}));function sle(t){let{basename:e="/",children:i=null,location:n,navigationType:r=mp.Pop,navigator:s,static:o=!1}=t;rle()&&VY(!1);let a=e.replace(/^\/*/,"/"),l=ye.useMemo(()=>({basename:a,navigator:s,static:o}),[a,s,o]);typeof n=="string"&&(n=WY(n));let{pathname:c="/",search:h="",hash:u="",state:d=null,key:f="default"}=n,p=ye.useMemo(()=>{let m=tle(c,a);return m==null?null:{location:{pathname:m,search:h,hash:u,state:d,key:f},navigationType:r}},[a,c,h,u,d,f,r]);return p==null?null:ye.createElement(nle.Provider,{value:l},ye.createElement(qY.Provider,{children:i,value:p}))}var TH;(function(t){t[t.pending=0]="pending",t[t.success=1]="success",t[t.error=2]="error"})(TH||(TH={}));new Promise(()=>{});/**
 * React Router DOM v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const ole="startTransition",CH=Gse[ole];function ale(t){let{basename:e,children:i,future:n,window:r}=t,s=ye.useRef();s.current==null&&(s.current=Zae({window:r,v5Compat:!0}));let o=s.current,[a,l]=ye.useState({action:o.action,location:o.location}),{v7_startTransition:c}=n||{},h=ye.useCallback(u=>{c&&CH?CH(()=>l(u)):l(u)},[l,c]);return ye.useLayoutEffect(()=>o.listen(h),[o,h]),ye.createElement(sle,{basename:e,children:i,location:a.location,navigationType:a.action,navigator:o})}var PH;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher"})(PH||(PH={}));var DH;(function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(DH||(DH={}));/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const cw="154",Qf={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Kf={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},YY=0,oL=1,QY=2,lle=3,KY=0,aC=1,S1=2,wl=3,jc=0,Vs=1,ka=2,cle=2,$u=0,Rp=1,aL=2,lL=3,cL=4,JY=5,sp=100,ZY=101,$Y=102,uL=103,hL=104,eQ=200,tQ=201,iQ=202,nQ=203,pN=204,mN=205,rQ=206,sQ=207,oQ=208,aQ=209,lQ=210,cQ=0,uQ=1,hQ=2,SE=3,dQ=4,fQ=5,pQ=6,mQ=7,uw=0,gQ=1,vQ=2,Ll=0,yQ=1,xQ=2,_Q=3,gN=4,wQ=5,lC=300,Xd=301,qd=302,g_=303,v_=304,ey=306,Yd=1e3,Jr=1001,d0=1002,Ln=1003,y_=1004,ule=1004,Nv=1005,hle=1005,xn=1006,cC=1007,dle=1007,Wc=1008,fle=1008,Nc=1009,bQ=1010,SQ=1011,uC=1012,vN=1013,Xu=1014,Dc=1015,f0=1016,yN=1017,xN=1018,Pd=1020,AQ=1021,no=1023,MQ=1024,EQ=1025,Dd=1026,em=1027,TQ=1028,_N=1029,CQ=1030,wN=1031,bN=1033,AM=33776,MM=33777,EM=33778,TM=33779,dL=35840,fL=35841,pL=35842,mL=35843,PQ=36196,gL=37492,vL=37496,yL=37808,xL=37809,_L=37810,wL=37811,bL=37812,SL=37813,AL=37814,ML=37815,EL=37816,TL=37817,CL=37818,PL=37819,DL=37820,RL=37821,CM=36492,DQ=36283,IL=36284,LL=36285,BL=36286,RQ=2200,IQ=2201,LQ=2202,p0=2300,tm=2301,PM=2302,gp=2400,vp=2401,x_=2402,hC=2500,SN=2501,BQ=0,AN=1,AE=2,MN=3e3,Rd=3001,OQ=3200,FQ=3201,lf=0,NQ=1,Id="",ni="srgb",zl="srgb-linear",EN="display-p3",ple=0,DM=7680,mle=7681,gle=7682,vle=7683,yle=34055,xle=34056,_le=5386,wle=512,ble=513,Sle=514,Ale=515,Mle=516,Ele=517,Tle=518,UQ=519,kQ=512,zQ=513,GQ=514,HQ=515,VQ=516,jQ=517,WQ=518,XQ=519,__=35044,Cle=35048,Ple=35040,Dle=35045,Rle=35049,Ile=35041,Lle=35046,Ble=35050,Ole=35042,Fle="100",OL="300 es",ME=1035,Rc=2e3,w_=2001;class $c{addEventListener(e,i){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(i)===-1&&n[e].push(i)}hasEventListener(e,i){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(i)!==-1}removeEventListener(e,i){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(i);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const hs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let RH=1234567;const Ip=Math.PI/180,m0=180/Math.PI;function Zo(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(hs[t&255]+hs[t>>8&255]+hs[t>>16&255]+hs[t>>24&255]+"-"+hs[e&255]+hs[e>>8&255]+"-"+hs[e>>16&15|64]+hs[e>>24&255]+"-"+hs[i&63|128]+hs[i>>8&255]+"-"+hs[i>>16&255]+hs[i>>24&255]+hs[n&255]+hs[n>>8&255]+hs[n>>16&255]+hs[n>>24&255]).toLowerCase()}function Bn(t,e,i){return Math.max(e,Math.min(i,t))}function TN(t,e){return(t%e+e)%e}function Nle(t,e,i,n,r){return n+(t-e)*(r-n)/(i-e)}function Ule(t,e,i){return t!==e?(i-t)/(e-t):0}function A1(t,e,i){return(1-i)*t+i*e}function kle(t,e,i,n){return A1(t,e,1-Math.exp(-i*n))}function zle(t,e=1){return e-Math.abs(TN(t,e*2)-e)}function Gle(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e),t*t*(3-2*t))}function Hle(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e),t*t*t*(t*(t*6-15)+10))}function Vle(t,e){return t+Math.floor(Math.random()*(e-t+1))}function jle(t,e){return t+Math.random()*(e-t)}function Wle(t){return t*(.5-Math.random())}function Xle(t){t!==void 0&&(RH=t);let e=RH+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function qle(t){return t*Ip}function Yle(t){return t*m0}function FL(t){return(t&t-1)===0&&t!==0}function qQ(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function EE(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function Qle(t,e,i,n,r){const s=Math.cos,o=Math.sin,a=s(i/2),l=o(i/2),c=s((e+n)/2),h=o((e+n)/2),u=s((e-n)/2),d=o((e-n)/2),f=s((n-e)/2),p=o((n-e)/2);switch(r){case"XYX":t.set(a*h,l*u,l*d,a*c);break;case"YZY":t.set(l*d,a*h,l*u,a*c);break;case"ZXZ":t.set(l*u,l*d,a*h,a*c);break;case"XZX":t.set(a*h,l*p,l*f,a*c);break;case"YXY":t.set(l*f,a*h,l*p,a*c);break;case"ZYZ":t.set(l*p,l*f,a*h,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Vo(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function ui(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}const YQ={DEG2RAD:Ip,RAD2DEG:m0,generateUUID:Zo,clamp:Bn,euclideanModulo:TN,mapLinear:Nle,inverseLerp:Ule,lerp:A1,damp:kle,pingpong:zle,smoothstep:Gle,smootherstep:Hle,randInt:Vle,randFloat:jle,randFloatSpread:Wle,seededRandom:Xle,degToRad:qle,radToDeg:Yle,isPowerOfTwo:FL,ceilPowerOfTwo:qQ,floorPowerOfTwo:EE,setQuaternionFromProperEuler:Qle,normalize:ui,denormalize:Vo};class Qe{constructor(e=0,i=0){Qe.prototype.isVector2=!0,this.x=e,this.y=i}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,i){return this.x=e,this.y=i,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const i=this.x,n=this.y,r=e.elements;return this.x=r[0]*i+r[3]*n+r[6],this.y=r[1]*i+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const n=this.dot(e)/i;return Math.acos(Bn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,n=this.y-e.y;return i*i+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this}rotateAround(e,i){const n=Math.cos(i),r=Math.sin(i),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*r+e.x,this.y=s*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ci{constructor(e,i,n,r,s,o,a,l,c){ci.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,i,n,r,s,o,a,l,c)}set(e,i,n,r,s,o,a,l,c){const h=this.elements;return h[0]=e,h[1]=r,h[2]=a,h[3]=i,h[4]=s,h[5]=l,h[6]=n,h[7]=o,h[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const i=this.elements,n=e.elements;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],this}extractBasis(e,i,n){return e.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const i=e.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const n=e.elements,r=i.elements,s=this.elements,o=n[0],a=n[3],l=n[6],c=n[1],h=n[4],u=n[7],d=n[2],f=n[5],p=n[8],m=r[0],v=r[3],g=r[6],y=r[1],x=r[4],b=r[7],S=r[2],A=r[5],E=r[8];return s[0]=o*m+a*y+l*S,s[3]=o*v+a*x+l*A,s[6]=o*g+a*b+l*E,s[1]=c*m+h*y+u*S,s[4]=c*v+h*x+u*A,s[7]=c*g+h*b+u*E,s[2]=d*m+f*y+p*S,s[5]=d*v+f*x+p*A,s[8]=d*g+f*b+p*E,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=e,i[4]*=e,i[7]*=e,i[2]*=e,i[5]*=e,i[8]*=e,this}determinant(){const e=this.elements,i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8];return i*o*h-i*a*c-n*s*h+n*a*l+r*s*c-r*o*l}invert(){const e=this.elements,i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8],u=h*o-a*c,d=a*l-h*s,f=c*s-o*l,p=i*u+n*d+r*f;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return e[0]=u*m,e[1]=(r*c-h*n)*m,e[2]=(a*n-r*o)*m,e[3]=d*m,e[4]=(h*i-r*l)*m,e[5]=(r*s-a*i)*m,e[6]=f*m,e[7]=(n*l-c*i)*m,e[8]=(o*i-n*s)*m,this}transpose(){let e;const i=this.elements;return e=i[1],i[1]=i[3],i[3]=e,e=i[2],i[2]=i[6],i[6]=e,e=i[5],i[5]=i[7],i[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const i=this.elements;return e[0]=i[0],e[1]=i[3],e[2]=i[6],e[3]=i[1],e[4]=i[4],e[5]=i[7],e[6]=i[2],e[7]=i[5],e[8]=i[8],this}setUvTransform(e,i,n,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(n*l,n*c,-n*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+i,0,0,1),this}scale(e,i){return this.premultiply($P.makeScale(e,i)),this}rotate(e){return this.premultiply($P.makeRotation(-e)),this}translate(e,i){return this.premultiply($P.makeTranslation(e,i)),this}makeTranslation(e,i){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,i,0,0,1),this}makeRotation(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,-n,0,n,i,0,0,0,1),this}makeScale(e,i){return this.set(e,0,0,0,i,0,0,0,1),this}equals(e){const i=this.elements,n=e.elements;for(let r=0;r<9;r++)if(i[r]!==n[r])return!1;return!0}fromArray(e,i=0){for(let n=0;n<9;n++)this.elements[n]=e[n+i];return this}toArray(e=[],i=0){const n=this.elements;return e[i]=n[0],e[i+1]=n[1],e[i+2]=n[2],e[i+3]=n[3],e[i+4]=n[4],e[i+5]=n[5],e[i+6]=n[6],e[i+7]=n[7],e[i+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const $P=new ci;function QQ(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}const Kle={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function hv(t,e){return new Kle[t](e)}function b_(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}const IH={};function M1(t){t in IH||(IH[t]=!0,console.warn(t))}function Uv(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function eD(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}const Jle=new ci().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),Zle=new ci().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]);function $le(t){return t.convertSRGBToLinear().applyMatrix3(Zle)}function ece(t){return t.applyMatrix3(Jle).convertLinearToSRGB()}const tce={[zl]:t=>t,[ni]:t=>t.convertSRGBToLinear(),[EN]:$le},ice={[zl]:t=>t,[ni]:t=>t.convertLinearToSRGB(),[EN]:ece},Ea={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(t){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!t},get workingColorSpace(){return zl},set workingColorSpace(t){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(t,e,i){if(this.enabled===!1||e===i||!e||!i)return t;const n=tce[e],r=ice[i];if(n===void 0||r===void 0)throw new Error(`Unsupported color space conversion, "${e}" to "${i}".`);return r(n(t))},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)}};let Vm;class CN{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{Vm===void 0&&(Vm=b_("canvas")),Vm.width=e.width,Vm.height=e.height;const n=Vm.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),i=Vm}return i.width>2048||i.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),i.toDataURL("image/jpeg",.6)):i.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const i=b_("canvas");i.width=e.width,i.height=e.height;const n=i.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=Uv(s[o]/255)*255;return n.putImageData(r,0,0),i}else if(e.data){const i=e.data.slice(0);for(let n=0;n<i.length;n++)i instanceof Uint8Array||i instanceof Uint8ClampedArray?i[n]=Math.floor(Uv(i[n]/255)*255):i[n]=Uv(i[n]);return{data:i,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let nce=0;class yp{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:nce++}),this.uuid=Zo(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(tD(r[o].image)):s.push(tD(r[o]))}else s=tD(r);n.url=s}return i||(e.images[this.uuid]=n),n}}function tD(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?CN.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let rce=0;class pn extends $c{constructor(e=pn.DEFAULT_IMAGE,i=pn.DEFAULT_MAPPING,n=Jr,r=Jr,s=xn,o=Wc,a=no,l=Nc,c=pn.DEFAULT_ANISOTROPY,h=Id){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:rce++}),this.uuid=Zo(),this.name="",this.source=new yp(e),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Qe(0,0),this.repeat=new Qe(1,1),this.center=new Qe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ci,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof h=="string"?this.colorSpace=h:(M1("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=h===Rd?ni:Id),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),i||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==lC)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Yd:e.x=e.x-Math.floor(e.x);break;case Jr:e.x=e.x<0?0:1;break;case d0:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Yd:e.y=e.y-Math.floor(e.y);break;case Jr:e.y=e.y<0?0:1;break;case d0:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return M1("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===ni?Rd:MN}set encoding(e){M1("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===Rd?ni:Id}}pn.DEFAULT_IMAGE=null;pn.DEFAULT_MAPPING=lC;pn.DEFAULT_ANISOTROPY=1;class zi{constructor(e=0,i=0,n=0,r=1){zi.prototype.isVector4=!0,this.x=e,this.y=i,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,i,n,r){return this.x=e,this.y=i,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this.w=e.w+i.w,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this.w+=e.w*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this.w=e.w-i.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const i=this.x,n=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*i+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*i+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*i+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*i+o[7]*n+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const i=Math.sqrt(1-e.w*e.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/i,this.y=e.y/i,this.z=e.z/i),this}setAxisAngleFromRotationMatrix(e){let i,n,r,s;const l=e.elements,c=l[0],h=l[4],u=l[8],d=l[1],f=l[5],p=l[9],m=l[2],v=l[6],g=l[10];if(Math.abs(h-d)<.01&&Math.abs(u-m)<.01&&Math.abs(p-v)<.01){if(Math.abs(h+d)<.1&&Math.abs(u+m)<.1&&Math.abs(p+v)<.1&&Math.abs(c+f+g-3)<.1)return this.set(1,0,0,0),this;i=Math.PI;const x=(c+1)/2,b=(f+1)/2,S=(g+1)/2,A=(h+d)/4,E=(u+m)/4,M=(p+v)/4;return x>b&&x>S?x<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(x),r=A/n,s=E/n):b>S?b<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(b),n=A/r,s=M/r):S<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(S),n=E/s,r=M/s),this.set(n,r,s,i),this}let y=Math.sqrt((v-p)*(v-p)+(u-m)*(u-m)+(d-h)*(d-h));return Math.abs(y)<.001&&(y=1),this.x=(v-p)/y,this.y=(u-m)/y,this.z=(d-h)/y,this.w=Math.acos((c+f+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this.w=Math.max(e.w,Math.min(i.w,this.w)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this.w=Math.max(e,Math.min(i,this.w)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this.w+=(e.w-this.w)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this.z=e.z+(i.z-e.z)*n,this.w=e.w+(i.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this.w=e[i+3],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e[i+3]=this.w,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this.w=e.getW(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Gl extends $c{constructor(e=1,i=1,n={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=i,this.depth=1,this.scissor=new zi(0,0,e,i),this.scissorTest=!1,this.viewport=new zi(0,0,e,i);const r={width:e,height:i,depth:1};n.encoding!==void 0&&(M1("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),n.colorSpace=n.encoding===Rd?ni:Id),this.texture=new pn(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.internalFormat=n.internalFormat!==void 0?n.internalFormat:null,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:xn,this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!1,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null,this.samples=n.samples!==void 0?n.samples:0}setSize(e,i,n=1){(this.width!==e||this.height!==i||this.depth!==n)&&(this.width=e,this.height=i,this.depth=n,this.texture.image.width=e,this.texture.image.height=i,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,i),this.scissor.set(0,0,e,i)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const i=Object.assign({},e.texture.image);return this.texture.source=new yp(i),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class dC extends pn{constructor(e=null,i=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:i,height:n,depth:r},this.magFilter=Ln,this.minFilter=Ln,this.wrapR=Jr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class sce extends Gl{constructor(e=1,i=1,n=1){super(e,i),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new dC(null,e,i,n),this.texture.isRenderTargetTexture=!0}}class PN extends pn{constructor(e=null,i=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:i,height:n,depth:r},this.magFilter=Ln,this.minFilter=Ln,this.wrapR=Jr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class oce extends Gl{constructor(e=1,i=1,n=1){super(e,i),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new PN(null,e,i,n),this.texture.isRenderTargetTexture=!0}}class ace extends Gl{constructor(e=1,i=1,n=1,r={}){super(e,i,r),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<n;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,i,n=1){if(this.width!==e||this.height!==i||this.depth!==n){this.width=e,this.height=i,this.depth=n;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=i,this.texture[r].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,i),this.scissor.set(0,0,e,i),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let i=0,n=e.texture.length;i<n;i++)this.texture[i]=e.texture[i].clone(),this.texture[i].isRenderTargetTexture=!0;return this}}class Gr{constructor(e=0,i=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=i,this._z=n,this._w=r}static slerpFlat(e,i,n,r,s,o,a){let l=n[r+0],c=n[r+1],h=n[r+2],u=n[r+3];const d=s[o+0],f=s[o+1],p=s[o+2],m=s[o+3];if(a===0){e[i+0]=l,e[i+1]=c,e[i+2]=h,e[i+3]=u;return}if(a===1){e[i+0]=d,e[i+1]=f,e[i+2]=p,e[i+3]=m;return}if(u!==m||l!==d||c!==f||h!==p){let v=1-a;const g=l*d+c*f+h*p+u*m,y=g>=0?1:-1,x=1-g*g;if(x>Number.EPSILON){const S=Math.sqrt(x),A=Math.atan2(S,g*y);v=Math.sin(v*A)/S,a=Math.sin(a*A)/S}const b=a*y;if(l=l*v+d*b,c=c*v+f*b,h=h*v+p*b,u=u*v+m*b,v===1-a){const S=1/Math.sqrt(l*l+c*c+h*h+u*u);l*=S,c*=S,h*=S,u*=S}}e[i]=l,e[i+1]=c,e[i+2]=h,e[i+3]=u}static multiplyQuaternionsFlat(e,i,n,r,s,o){const a=n[r],l=n[r+1],c=n[r+2],h=n[r+3],u=s[o],d=s[o+1],f=s[o+2],p=s[o+3];return e[i]=a*p+h*u+l*f-c*d,e[i+1]=l*p+h*d+c*u-a*f,e[i+2]=c*p+h*f+a*d-l*u,e[i+3]=h*p-a*u-l*d-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,i,n,r){return this._x=e,this._y=i,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,i){const n=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(n/2),h=a(r/2),u=a(s/2),d=l(n/2),f=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=d*h*u+c*f*p,this._y=c*f*u-d*h*p,this._z=c*h*p+d*f*u,this._w=c*h*u-d*f*p;break;case"YXZ":this._x=d*h*u+c*f*p,this._y=c*f*u-d*h*p,this._z=c*h*p-d*f*u,this._w=c*h*u+d*f*p;break;case"ZXY":this._x=d*h*u-c*f*p,this._y=c*f*u+d*h*p,this._z=c*h*p+d*f*u,this._w=c*h*u-d*f*p;break;case"ZYX":this._x=d*h*u-c*f*p,this._y=c*f*u+d*h*p,this._z=c*h*p-d*f*u,this._w=c*h*u+d*f*p;break;case"YZX":this._x=d*h*u+c*f*p,this._y=c*f*u+d*h*p,this._z=c*h*p-d*f*u,this._w=c*h*u-d*f*p;break;case"XZY":this._x=d*h*u-c*f*p,this._y=c*f*u-d*h*p,this._z=c*h*p+d*f*u,this._w=c*h*u+d*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return i!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,i){const n=i/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const i=e.elements,n=i[0],r=i[4],s=i[8],o=i[1],a=i[5],l=i[9],c=i[2],h=i[6],u=i[10],d=n+a+u;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(h-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(n>a&&n>u){const f=2*Math.sqrt(1+n-a-u);this._w=(h-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>u){const f=2*Math.sqrt(1+a-n-u);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+h)/f}else{const f=2*Math.sqrt(1+u-n-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+h)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,i){let n=e.dot(i)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*i.z-e.z*i.y,this._y=e.z*i.x-e.x*i.z,this._z=e.x*i.y-e.y*i.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Bn(this.dot(e),-1,1)))}rotateTowards(e,i){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,i/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,i){const n=e._x,r=e._y,s=e._z,o=e._w,a=i._x,l=i._y,c=i._z,h=i._w;return this._x=n*h+o*a+r*c-s*l,this._y=r*h+o*l+s*a-n*c,this._z=s*h+o*c+n*l-r*a,this._w=o*h-n*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,i){if(i===0)return this;if(i===1)return this.copy(e);const n=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+n*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-i;return this._w=f*o+i*this._w,this._x=f*n+i*this._x,this._y=f*r+i*this._y,this._z=f*s+i*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),h=Math.atan2(c,a),u=Math.sin((1-i)*h)/c,d=Math.sin(i*h)/c;return this._w=o*u+this._w*d,this._x=n*u+this._x*d,this._y=r*u+this._y*d,this._z=s*u+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,i,n){return this.copy(e).slerp(i,n)}random(){const e=Math.random(),i=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(i*Math.cos(r),n*Math.sin(s),n*Math.cos(s),i*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,i=0){return this._x=e[i],this._y=e[i+1],this._z=e[i+2],this._w=e[i+3],this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._w,e}fromBufferAttribute(e,i){return this._x=e.getX(i),this._y=e.getY(i),this._z=e.getZ(i),this._w=e.getW(i),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class te{constructor(e=0,i=0,n=0){te.prototype.isVector3=!0,this.x=e,this.y=i,this.z=n}set(e,i,n){return n===void 0&&(n=this.z),this.x=e,this.y=i,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,i){return this.x=e.x*i.x,this.y=e.y*i.y,this.z=e.z*i.z,this}applyEuler(e){return this.applyQuaternion(LH.setFromEuler(e))}applyAxisAngle(e,i){return this.applyQuaternion(LH.setFromAxisAngle(e,i))}applyMatrix3(e){const i=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*i+s[3]*n+s[6]*r,this.y=s[1]*i+s[4]*n+s[7]*r,this.z=s[2]*i+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const i=this.x,n=this.y,r=this.z,s=e.elements,o=1/(s[3]*i+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*i+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*i+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*i+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(e){const i=this.x,n=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*i+o*r-a*n,h=l*n+a*i-s*r,u=l*r+s*n-o*i,d=-s*i-o*n-a*r;return this.x=c*l+d*-s+h*-a-u*-o,this.y=h*l+d*-o+u*-s-c*-a,this.z=u*l+d*-a+c*-o-h*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const i=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*i+s[4]*n+s[8]*r,this.y=s[1]*i+s[5]*n+s[9]*r,this.z=s[2]*i+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this.z=e.z+(i.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,i){const n=e.x,r=e.y,s=e.z,o=i.x,a=i.y,l=i.z;return this.x=r*l-s*a,this.y=s*o-n*l,this.z=n*a-r*o,this}projectOnVector(e){const i=e.lengthSq();if(i===0)return this.set(0,0,0);const n=e.dot(this)/i;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return iD.copy(this).projectOnVector(e),this.sub(iD)}reflect(e){return this.sub(iD.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const n=this.dot(e)/i;return Math.acos(Bn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return i*i+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,i,n){const r=Math.sin(i)*e;return this.x=r*Math.sin(n),this.y=Math.cos(i)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,i,n){return this.x=e*Math.sin(i),this.y=n,this.z=e*Math.cos(i),this}setFromMatrixPosition(e){const i=e.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}setFromMatrixScale(e){const i=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=i,this.y=n,this.z=r,this}setFromMatrixColumn(e,i){return this.fromArray(e.elements,i*4)}setFromMatrix3Column(e,i){return this.fromArray(e.elements,i*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,i=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(i),this.y=n*Math.sin(i),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const iD=new te,LH=new Gr;class jl{constructor(e=new te(1/0,1/0,1/0),i=new te(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=i}set(e,i){return this.min.copy(e),this.max.copy(i),this}setFromArray(e){this.makeEmpty();for(let i=0,n=e.length;i<n;i+=3)this.expandByPoint(hu.fromArray(e,i));return this}setFromBufferAttribute(e){this.makeEmpty();for(let i=0,n=e.count;i<n;i++)this.expandByPoint(hu.fromBufferAttribute(e,i));return this}setFromPoints(e){this.makeEmpty();for(let i=0,n=e.length;i<n;i++)this.expandByPoint(e[i]);return this}setFromCenterAndSize(e,i){const n=hu.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,i=!1){return this.makeEmpty(),this.expandByObject(e,i)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,i=!1){if(e.updateWorldMatrix(!1,!1),e.boundingBox!==void 0)e.boundingBox===null&&e.computeBoundingBox(),jm.copy(e.boundingBox),jm.applyMatrix4(e.matrixWorld),this.union(jm);else{const r=e.geometry;if(r!==void 0)if(i&&r.attributes!==void 0&&r.attributes.position!==void 0){const s=r.attributes.position;for(let o=0,a=s.count;o<a;o++)hu.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(hu)}else r.boundingBox===null&&r.computeBoundingBox(),jm.copy(r.boundingBox),jm.applyMatrix4(e.matrixWorld),this.union(jm)}const n=e.children;for(let r=0,s=n.length;r<s;r++)this.expandByObject(n[r],i);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,i){return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,hu),hu.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let i,n;return e.normal.x>0?(i=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(i=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(i+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(i+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(i+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(i+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),i<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Zy),$b.subVectors(this.max,Zy),Wm.subVectors(e.a,Zy),Xm.subVectors(e.b,Zy),qm.subVectors(e.c,Zy),Dh.subVectors(Xm,Wm),Rh.subVectors(qm,Xm),Ef.subVectors(Wm,qm);let i=[0,-Dh.z,Dh.y,0,-Rh.z,Rh.y,0,-Ef.z,Ef.y,Dh.z,0,-Dh.x,Rh.z,0,-Rh.x,Ef.z,0,-Ef.x,-Dh.y,Dh.x,0,-Rh.y,Rh.x,0,-Ef.y,Ef.x,0];return!nD(i,Wm,Xm,qm,$b)||(i=[1,0,0,0,1,0,0,0,1],!nD(i,Wm,Xm,qm,$b))?!1:(eS.crossVectors(Dh,Rh),i=[eS.x,eS.y,eS.z],nD(i,Wm,Xm,qm,$b))}clampPoint(e,i){return i.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,hu).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(hu).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(uu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),uu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),uu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),uu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),uu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),uu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),uu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),uu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(uu),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const uu=[new te,new te,new te,new te,new te,new te,new te,new te],hu=new te,jm=new jl,Wm=new te,Xm=new te,qm=new te,Dh=new te,Rh=new te,Ef=new te,Zy=new te,$b=new te,eS=new te,Tf=new te;function nD(t,e,i,n,r){for(let s=0,o=t.length-3;s<=o;s+=3){Tf.fromArray(t,s);const a=r.x*Math.abs(Tf.x)+r.y*Math.abs(Tf.y)+r.z*Math.abs(Tf.z),l=e.dot(Tf),c=i.dot(Tf),h=n.dot(Tf);if(Math.max(-Math.max(l,c,h),Math.min(l,c,h))>a)return!1}return!0}const lce=new jl,$y=new te,rD=new te;class nl{constructor(e=new te,i=-1){this.center=e,this.radius=i}set(e,i){return this.center.copy(e),this.radius=i,this}setFromPoints(e,i){const n=this.center;i!==void 0?n.copy(i):lce.setFromPoints(e).getCenter(n);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const i=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=i*i}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,i){const n=this.center.distanceToSquared(e);return i.copy(e),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;$y.subVectors(e,this.center);const i=$y.lengthSq();if(i>this.radius*this.radius){const n=Math.sqrt(i),r=(n-this.radius)*.5;this.center.addScaledVector($y,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(rD.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint($y.copy(e.center).add(rD)),this.expandByPoint($y.copy(e.center).sub(rD))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const du=new te,sD=new te,tS=new te,Ih=new te,oD=new te,iS=new te,aD=new te;class ty{constructor(e=new te,i=new te(0,0,-1)){this.origin=e,this.direction=i}set(e,i){return this.origin.copy(e),this.direction.copy(i),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,i){return i.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,du)),this}closestPointToPoint(e,i){i.subVectors(e,this.origin);const n=i.dot(this.direction);return n<0?i.copy(this.origin):i.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const i=du.subVectors(e,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(e):(du.copy(this.origin).addScaledVector(this.direction,i),du.distanceToSquared(e))}distanceSqToSegment(e,i,n,r){sD.copy(e).add(i).multiplyScalar(.5),tS.copy(i).sub(e).normalize(),Ih.copy(this.origin).sub(sD);const s=e.distanceTo(i)*.5,o=-this.direction.dot(tS),a=Ih.dot(this.direction),l=-Ih.dot(tS),c=Ih.lengthSq(),h=Math.abs(1-o*o);let u,d,f,p;if(h>0)if(u=o*l-a,d=o*a-l,p=s*h,u>=0)if(d>=-p)if(d<=p){const m=1/h;u*=m,d*=m,f=u*(u+o*d+2*a)+d*(o*u+d+2*l)+c}else d=s,u=Math.max(0,-(o*d+a)),f=-u*u+d*(d+2*l)+c;else d=-s,u=Math.max(0,-(o*d+a)),f=-u*u+d*(d+2*l)+c;else d<=-p?(u=Math.max(0,-(-o*s+a)),d=u>0?-s:Math.min(Math.max(-s,-l),s),f=-u*u+d*(d+2*l)+c):d<=p?(u=0,d=Math.min(Math.max(-s,-l),s),f=d*(d+2*l)+c):(u=Math.max(0,-(o*s+a)),d=u>0?s:Math.min(Math.max(-s,-l),s),f=-u*u+d*(d+2*l)+c);else d=o>0?-s:s,u=Math.max(0,-(o*d+a)),f=-u*u+d*(d+2*l)+c;return n&&n.copy(this.origin).addScaledVector(this.direction,u),r&&r.copy(sD).addScaledVector(tS,d),f}intersectSphere(e,i){du.subVectors(e.center,this.origin);const n=du.dot(this.direction),r=du.dot(du)-n*n,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=n-o,l=n+o;return l<0?null:a<0?this.at(l,i):this.at(a,i)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const i=e.normal.dot(this.direction);if(i===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/i;return n>=0?n:null}intersectPlane(e,i){const n=this.distanceToPlane(e);return n===null?null:this.at(n,i)}intersectsPlane(e){const i=e.distanceToPoint(this.origin);return i===0||e.normal.dot(this.direction)*i<0}intersectBox(e,i){let n,r,s,o,a,l;const c=1/this.direction.x,h=1/this.direction.y,u=1/this.direction.z,d=this.origin;return c>=0?(n=(e.min.x-d.x)*c,r=(e.max.x-d.x)*c):(n=(e.max.x-d.x)*c,r=(e.min.x-d.x)*c),h>=0?(s=(e.min.y-d.y)*h,o=(e.max.y-d.y)*h):(s=(e.max.y-d.y)*h,o=(e.min.y-d.y)*h),n>o||s>r||((s>n||isNaN(n))&&(n=s),(o<r||isNaN(r))&&(r=o),u>=0?(a=(e.min.z-d.z)*u,l=(e.max.z-d.z)*u):(a=(e.max.z-d.z)*u,l=(e.min.z-d.z)*u),n>l||a>r)||((a>n||n!==n)&&(n=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(n>=0?n:r,i)}intersectsBox(e){return this.intersectBox(e,du)!==null}intersectTriangle(e,i,n,r,s){oD.subVectors(i,e),iS.subVectors(n,e),aD.crossVectors(oD,iS);let o=this.direction.dot(aD),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Ih.subVectors(this.origin,e);const l=a*this.direction.dot(iS.crossVectors(Ih,iS));if(l<0)return null;const c=a*this.direction.dot(oD.cross(Ih));if(c<0||l+c>o)return null;const h=-a*Ih.dot(aD);return h<0?null:this.at(h/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Wt{constructor(e,i,n,r,s,o,a,l,c,h,u,d,f,p,m,v){Wt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,i,n,r,s,o,a,l,c,h,u,d,f,p,m,v)}set(e,i,n,r,s,o,a,l,c,h,u,d,f,p,m,v){const g=this.elements;return g[0]=e,g[4]=i,g[8]=n,g[12]=r,g[1]=s,g[5]=o,g[9]=a,g[13]=l,g[2]=c,g[6]=h,g[10]=u,g[14]=d,g[3]=f,g[7]=p,g[11]=m,g[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Wt().fromArray(this.elements)}copy(e){const i=this.elements,n=e.elements;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this}copyPosition(e){const i=this.elements,n=e.elements;return i[12]=n[12],i[13]=n[13],i[14]=n[14],this}setFromMatrix3(e){const i=e.elements;return this.set(i[0],i[3],i[6],0,i[1],i[4],i[7],0,i[2],i[5],i[8],0,0,0,0,1),this}extractBasis(e,i,n){return e.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,i,n){return this.set(e.x,i.x,n.x,0,e.y,i.y,n.y,0,e.z,i.z,n.z,0,0,0,0,1),this}extractRotation(e){const i=this.elements,n=e.elements,r=1/Ym.setFromMatrixColumn(e,0).length(),s=1/Ym.setFromMatrixColumn(e,1).length(),o=1/Ym.setFromMatrixColumn(e,2).length();return i[0]=n[0]*r,i[1]=n[1]*r,i[2]=n[2]*r,i[3]=0,i[4]=n[4]*s,i[5]=n[5]*s,i[6]=n[6]*s,i[7]=0,i[8]=n[8]*o,i[9]=n[9]*o,i[10]=n[10]*o,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromEuler(e){const i=this.elements,n=e.x,r=e.y,s=e.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(r),c=Math.sin(r),h=Math.cos(s),u=Math.sin(s);if(e.order==="XYZ"){const d=o*h,f=o*u,p=a*h,m=a*u;i[0]=l*h,i[4]=-l*u,i[8]=c,i[1]=f+p*c,i[5]=d-m*c,i[9]=-a*l,i[2]=m-d*c,i[6]=p+f*c,i[10]=o*l}else if(e.order==="YXZ"){const d=l*h,f=l*u,p=c*h,m=c*u;i[0]=d+m*a,i[4]=p*a-f,i[8]=o*c,i[1]=o*u,i[5]=o*h,i[9]=-a,i[2]=f*a-p,i[6]=m+d*a,i[10]=o*l}else if(e.order==="ZXY"){const d=l*h,f=l*u,p=c*h,m=c*u;i[0]=d-m*a,i[4]=-o*u,i[8]=p+f*a,i[1]=f+p*a,i[5]=o*h,i[9]=m-d*a,i[2]=-o*c,i[6]=a,i[10]=o*l}else if(e.order==="ZYX"){const d=o*h,f=o*u,p=a*h,m=a*u;i[0]=l*h,i[4]=p*c-f,i[8]=d*c+m,i[1]=l*u,i[5]=m*c+d,i[9]=f*c-p,i[2]=-c,i[6]=a*l,i[10]=o*l}else if(e.order==="YZX"){const d=o*l,f=o*c,p=a*l,m=a*c;i[0]=l*h,i[4]=m-d*u,i[8]=p*u+f,i[1]=u,i[5]=o*h,i[9]=-a*h,i[2]=-c*h,i[6]=f*u+p,i[10]=d-m*u}else if(e.order==="XZY"){const d=o*l,f=o*c,p=a*l,m=a*c;i[0]=l*h,i[4]=-u,i[8]=c*h,i[1]=d*u+m,i[5]=o*h,i[9]=f*u-p,i[2]=p*u-f,i[6]=a*h,i[10]=m*u+d}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromQuaternion(e){return this.compose(cce,e,uce)}lookAt(e,i,n){const r=this.elements;return Io.subVectors(e,i),Io.lengthSq()===0&&(Io.z=1),Io.normalize(),Lh.crossVectors(n,Io),Lh.lengthSq()===0&&(Math.abs(n.z)===1?Io.x+=1e-4:Io.z+=1e-4,Io.normalize(),Lh.crossVectors(n,Io)),Lh.normalize(),nS.crossVectors(Io,Lh),r[0]=Lh.x,r[4]=nS.x,r[8]=Io.x,r[1]=Lh.y,r[5]=nS.y,r[9]=Io.y,r[2]=Lh.z,r[6]=nS.z,r[10]=Io.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const n=e.elements,r=i.elements,s=this.elements,o=n[0],a=n[4],l=n[8],c=n[12],h=n[1],u=n[5],d=n[9],f=n[13],p=n[2],m=n[6],v=n[10],g=n[14],y=n[3],x=n[7],b=n[11],S=n[15],A=r[0],E=r[4],M=r[8],T=r[12],P=r[1],R=r[5],U=r[9],F=r[13],N=r[2],W=r[6],Q=r[10],X=r[14],B=r[3],j=r[7],z=r[11],k=r[15];return s[0]=o*A+a*P+l*N+c*B,s[4]=o*E+a*R+l*W+c*j,s[8]=o*M+a*U+l*Q+c*z,s[12]=o*T+a*F+l*X+c*k,s[1]=h*A+u*P+d*N+f*B,s[5]=h*E+u*R+d*W+f*j,s[9]=h*M+u*U+d*Q+f*z,s[13]=h*T+u*F+d*X+f*k,s[2]=p*A+m*P+v*N+g*B,s[6]=p*E+m*R+v*W+g*j,s[10]=p*M+m*U+v*Q+g*z,s[14]=p*T+m*F+v*X+g*k,s[3]=y*A+x*P+b*N+S*B,s[7]=y*E+x*R+b*W+S*j,s[11]=y*M+x*U+b*Q+S*z,s[15]=y*T+x*F+b*X+S*k,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[4]*=e,i[8]*=e,i[12]*=e,i[1]*=e,i[5]*=e,i[9]*=e,i[13]*=e,i[2]*=e,i[6]*=e,i[10]*=e,i[14]*=e,i[3]*=e,i[7]*=e,i[11]*=e,i[15]*=e,this}determinant(){const e=this.elements,i=e[0],n=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],h=e[2],u=e[6],d=e[10],f=e[14],p=e[3],m=e[7],v=e[11],g=e[15];return p*(+s*l*u-r*c*u-s*a*d+n*c*d+r*a*f-n*l*f)+m*(+i*l*f-i*c*d+s*o*d-r*o*f+r*c*h-s*l*h)+v*(+i*c*u-i*a*f-s*o*u+n*o*f+s*a*h-n*c*h)+g*(-r*a*h-i*l*u+i*a*d+r*o*u-n*o*d+n*l*h)}transpose(){const e=this.elements;let i;return i=e[1],e[1]=e[4],e[4]=i,i=e[2],e[2]=e[8],e[8]=i,i=e[6],e[6]=e[9],e[9]=i,i=e[3],e[3]=e[12],e[12]=i,i=e[7],e[7]=e[13],e[13]=i,i=e[11],e[11]=e[14],e[14]=i,this}setPosition(e,i,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=i,r[14]=n),this}invert(){const e=this.elements,i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8],u=e[9],d=e[10],f=e[11],p=e[12],m=e[13],v=e[14],g=e[15],y=u*v*c-m*d*c+m*l*f-a*v*f-u*l*g+a*d*g,x=p*d*c-h*v*c-p*l*f+o*v*f+h*l*g-o*d*g,b=h*m*c-p*u*c+p*a*f-o*m*f-h*a*g+o*u*g,S=p*u*l-h*m*l-p*a*d+o*m*d+h*a*v-o*u*v,A=i*y+n*x+r*b+s*S;if(A===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const E=1/A;return e[0]=y*E,e[1]=(m*d*s-u*v*s-m*r*f+n*v*f+u*r*g-n*d*g)*E,e[2]=(a*v*s-m*l*s+m*r*c-n*v*c-a*r*g+n*l*g)*E,e[3]=(u*l*s-a*d*s-u*r*c+n*d*c+a*r*f-n*l*f)*E,e[4]=x*E,e[5]=(h*v*s-p*d*s+p*r*f-i*v*f-h*r*g+i*d*g)*E,e[6]=(p*l*s-o*v*s-p*r*c+i*v*c+o*r*g-i*l*g)*E,e[7]=(o*d*s-h*l*s+h*r*c-i*d*c-o*r*f+i*l*f)*E,e[8]=b*E,e[9]=(p*u*s-h*m*s-p*n*f+i*m*f+h*n*g-i*u*g)*E,e[10]=(o*m*s-p*a*s+p*n*c-i*m*c-o*n*g+i*a*g)*E,e[11]=(h*a*s-o*u*s-h*n*c+i*u*c+o*n*f-i*a*f)*E,e[12]=S*E,e[13]=(h*m*r-p*u*r+p*n*d-i*m*d-h*n*v+i*u*v)*E,e[14]=(p*a*r-o*m*r-p*n*l+i*m*l+o*n*v-i*a*v)*E,e[15]=(o*u*r-h*a*r+h*n*l-i*u*l-o*n*d+i*a*d)*E,this}scale(e){const i=this.elements,n=e.x,r=e.y,s=e.z;return i[0]*=n,i[4]*=r,i[8]*=s,i[1]*=n,i[5]*=r,i[9]*=s,i[2]*=n,i[6]*=r,i[10]*=s,i[3]*=n,i[7]*=r,i[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(i,n,r))}makeTranslation(e,i,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,i,0,0,1,n,0,0,0,1),this}makeRotationX(e){const i=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,i,-n,0,0,n,i,0,0,0,0,1),this}makeRotationY(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,0,n,0,0,1,0,0,-n,0,i,0,0,0,0,1),this}makeRotationZ(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,-n,0,0,n,i,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,i){const n=Math.cos(i),r=Math.sin(i),s=1-n,o=e.x,a=e.y,l=e.z,c=s*o,h=s*a;return this.set(c*o+n,c*a-r*l,c*l+r*a,0,c*a+r*l,h*a+n,h*l-r*o,0,c*l-r*a,h*l+r*o,s*l*l+n,0,0,0,0,1),this}makeScale(e,i,n){return this.set(e,0,0,0,0,i,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,i,n,r,s,o){return this.set(1,n,s,0,e,1,o,0,i,r,1,0,0,0,0,1),this}compose(e,i,n){const r=this.elements,s=i._x,o=i._y,a=i._z,l=i._w,c=s+s,h=o+o,u=a+a,d=s*c,f=s*h,p=s*u,m=o*h,v=o*u,g=a*u,y=l*c,x=l*h,b=l*u,S=n.x,A=n.y,E=n.z;return r[0]=(1-(m+g))*S,r[1]=(f+b)*S,r[2]=(p-x)*S,r[3]=0,r[4]=(f-b)*A,r[5]=(1-(d+g))*A,r[6]=(v+y)*A,r[7]=0,r[8]=(p+x)*E,r[9]=(v-y)*E,r[10]=(1-(d+m))*E,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,i,n){const r=this.elements;let s=Ym.set(r[0],r[1],r[2]).length();const o=Ym.set(r[4],r[5],r[6]).length(),a=Ym.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],ll.copy(this);const c=1/s,h=1/o,u=1/a;return ll.elements[0]*=c,ll.elements[1]*=c,ll.elements[2]*=c,ll.elements[4]*=h,ll.elements[5]*=h,ll.elements[6]*=h,ll.elements[8]*=u,ll.elements[9]*=u,ll.elements[10]*=u,i.setFromRotationMatrix(ll),n.x=s,n.y=o,n.z=a,this}makePerspective(e,i,n,r,s,o,a=Rc){const l=this.elements,c=2*s/(i-e),h=2*s/(n-r),u=(i+e)/(i-e),d=(n+r)/(n-r);let f,p;if(a===Rc)f=-(o+s)/(o-s),p=-2*o*s/(o-s);else if(a===w_)f=-o/(o-s),p=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=c,l[4]=0,l[8]=u,l[12]=0,l[1]=0,l[5]=h,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,i,n,r,s,o,a=Rc){const l=this.elements,c=1/(i-e),h=1/(n-r),u=1/(o-s),d=(i+e)*c,f=(n+r)*h;let p,m;if(a===Rc)p=(o+s)*u,m=-2*u;else if(a===w_)p=s*u,m=-1*u;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-d,l[1]=0,l[5]=2*h,l[9]=0,l[13]=-f,l[2]=0,l[6]=0,l[10]=m,l[14]=-p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const i=this.elements,n=e.elements;for(let r=0;r<16;r++)if(i[r]!==n[r])return!1;return!0}fromArray(e,i=0){for(let n=0;n<16;n++)this.elements[n]=e[n+i];return this}toArray(e=[],i=0){const n=this.elements;return e[i]=n[0],e[i+1]=n[1],e[i+2]=n[2],e[i+3]=n[3],e[i+4]=n[4],e[i+5]=n[5],e[i+6]=n[6],e[i+7]=n[7],e[i+8]=n[8],e[i+9]=n[9],e[i+10]=n[10],e[i+11]=n[11],e[i+12]=n[12],e[i+13]=n[13],e[i+14]=n[14],e[i+15]=n[15],e}}const Ym=new te,ll=new Wt,cce=new te(0,0,0),uce=new te(1,1,1),Lh=new te,nS=new te,Io=new te,BH=new Wt,OH=new Gr;class hw{constructor(e=0,i=0,n=0,r=hw.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=i,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,i,n,r=this._order){return this._x=e,this._y=i,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,i=this._order,n=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],c=r[5],h=r[9],u=r[2],d=r[6],f=r[10];switch(i){case"XYZ":this._y=Math.asin(Bn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-h,f),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(d,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Bn(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-u,s),this._z=0);break;case"ZXY":this._x=Math.asin(Bn(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-u,f),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Bn(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(d,f),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(Bn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,c),this._y=Math.atan2(-u,s)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-Bn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-h,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,i,n){return BH.makeRotationFromQuaternion(e),this.setFromRotationMatrix(BH,i,n)}setFromVector3(e,i=this._order){return this.set(e.x,e.y,e.z,i)}reorder(e){return OH.setFromEuler(this),this.setFromQuaternion(OH,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}hw.DEFAULT_ORDER="XYZ";class Lp{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let hce=0;const FH=new te,Qm=new Gr,fu=new Wt,rS=new te,ex=new te,dce=new te,fce=new Gr,NH=new te(1,0,0),UH=new te(0,1,0),kH=new te(0,0,1),pce={type:"added"},zH={type:"removed"};class Si extends $c{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:hce++}),this.uuid=Zo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Si.DEFAULT_UP.clone();const e=new te,i=new hw,n=new Gr,r=new te(1,1,1);function s(){n.setFromEuler(i,!1)}function o(){i.setFromQuaternion(n,void 0,!1)}i._onChange(s),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Wt},normalMatrix:{value:new ci}}),this.matrix=new Wt,this.matrixWorld=new Wt,this.matrixAutoUpdate=Si.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Si.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Lp,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,i){this.quaternion.setFromAxisAngle(e,i)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,i){return Qm.setFromAxisAngle(e,i),this.quaternion.multiply(Qm),this}rotateOnWorldAxis(e,i){return Qm.setFromAxisAngle(e,i),this.quaternion.premultiply(Qm),this}rotateX(e){return this.rotateOnAxis(NH,e)}rotateY(e){return this.rotateOnAxis(UH,e)}rotateZ(e){return this.rotateOnAxis(kH,e)}translateOnAxis(e,i){return FH.copy(e).applyQuaternion(this.quaternion),this.position.add(FH.multiplyScalar(i)),this}translateX(e){return this.translateOnAxis(NH,e)}translateY(e){return this.translateOnAxis(UH,e)}translateZ(e){return this.translateOnAxis(kH,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(fu.copy(this.matrixWorld).invert())}lookAt(e,i,n){e.isVector3?rS.copy(e):rS.set(e,i,n);const r=this.parent;this.updateWorldMatrix(!0,!1),ex.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?fu.lookAt(ex,rS,this.up):fu.lookAt(rS,ex,this.up),this.quaternion.setFromRotationMatrix(fu),r&&(fu.extractRotation(r.matrixWorld),Qm.setFromRotationMatrix(fu),this.quaternion.premultiply(Qm.invert()))}add(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(pce)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const i=this.children.indexOf(e);return i!==-1&&(e.parent=null,this.children.splice(i,1),e.dispatchEvent(zH)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const i=this.children[e];i.parent=null,i.dispatchEvent(zH)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),fu.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),fu.multiply(e.parent.matrixWorld)),e.applyMatrix4(fu),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,i){if(this[e]===i)return this;for(let n=0,r=this.children.length;n<r;n++){const o=this.children[n].getObjectByProperty(e,i);if(o!==void 0)return o}}getObjectsByProperty(e,i){let n=[];this[e]===i&&n.push(this);for(let r=0,s=this.children.length;r<s;r++){const o=this.children[r].getObjectsByProperty(e,i);o.length>0&&(n=n.concat(o))}return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ex,e,dce),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ex,fce,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return e.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(e){e(this);const i=this.children;for(let n=0,r=i.length;n<r;n++)i[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const i=this.children;for(let n=0,r=i.length;n<r;n++)i[n].traverseVisible(e)}traverseAncestors(e){const i=this.parent;i!==null&&(e(i),i.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const i=this.children;for(let n=0,r=i.length;n<r;n++){const s=i[n];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,i){const n=this.parent;if(e===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++){const a=r[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const i=e===void 0||typeof e=="string",n={};i&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let c=0,h=l.length;c<h;c++){const u=l[c];s(e.shapes,u)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(i){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),h=o(e.images),u=o(e.shapes),d=o(e.skeletons),f=o(e.animations),p=o(e.nodes);a.length>0&&(n.geometries=a),l.length>0&&(n.materials=l),c.length>0&&(n.textures=c),h.length>0&&(n.images=h),u.length>0&&(n.shapes=u),d.length>0&&(n.skeletons=d),f.length>0&&(n.animations=f),p.length>0&&(n.nodes=p)}return n.object=r,n;function o(a){const l=[];for(const c in a){const h=a[c];delete h.metadata,l.push(h)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,i=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations,this.userData=JSON.parse(JSON.stringify(e.userData)),i===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}}Si.DEFAULT_UP=new te(0,1,0);Si.DEFAULT_MATRIX_AUTO_UPDATE=!0;Si.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const cl=new te,pu=new te,lD=new te,mu=new te,Km=new te,Jm=new te,GH=new te,cD=new te,uD=new te,hD=new te;let sS=!1;class to{constructor(e=new te,i=new te,n=new te){this.a=e,this.b=i,this.c=n}static getNormal(e,i,n,r){r.subVectors(n,i),cl.subVectors(e,i),r.cross(cl);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,i,n,r,s){cl.subVectors(r,i),pu.subVectors(n,i),lD.subVectors(e,i);const o=cl.dot(cl),a=cl.dot(pu),l=cl.dot(lD),c=pu.dot(pu),h=pu.dot(lD),u=o*c-a*a;if(u===0)return s.set(-2,-1,-1);const d=1/u,f=(c*l-a*h)*d,p=(o*h-a*l)*d;return s.set(1-f-p,p,f)}static containsPoint(e,i,n,r){return this.getBarycoord(e,i,n,r,mu),mu.x>=0&&mu.y>=0&&mu.x+mu.y<=1}static getUV(e,i,n,r,s,o,a,l){return sS===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),sS=!0),this.getInterpolation(e,i,n,r,s,o,a,l)}static getInterpolation(e,i,n,r,s,o,a,l){return this.getBarycoord(e,i,n,r,mu),l.setScalar(0),l.addScaledVector(s,mu.x),l.addScaledVector(o,mu.y),l.addScaledVector(a,mu.z),l}static isFrontFacing(e,i,n,r){return cl.subVectors(n,i),pu.subVectors(e,i),cl.cross(pu).dot(r)<0}set(e,i,n){return this.a.copy(e),this.b.copy(i),this.c.copy(n),this}setFromPointsAndIndices(e,i,n,r){return this.a.copy(e[i]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,i,n,r){return this.a.fromBufferAttribute(e,i),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return cl.subVectors(this.c,this.b),pu.subVectors(this.a,this.b),cl.cross(pu).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return to.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,i){return to.getBarycoord(e,this.a,this.b,this.c,i)}getUV(e,i,n,r,s){return sS===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),sS=!0),to.getInterpolation(e,this.a,this.b,this.c,i,n,r,s)}getInterpolation(e,i,n,r,s){return to.getInterpolation(e,this.a,this.b,this.c,i,n,r,s)}containsPoint(e){return to.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return to.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,i){const n=this.a,r=this.b,s=this.c;let o,a;Km.subVectors(r,n),Jm.subVectors(s,n),cD.subVectors(e,n);const l=Km.dot(cD),c=Jm.dot(cD);if(l<=0&&c<=0)return i.copy(n);uD.subVectors(e,r);const h=Km.dot(uD),u=Jm.dot(uD);if(h>=0&&u<=h)return i.copy(r);const d=l*u-h*c;if(d<=0&&l>=0&&h<=0)return o=l/(l-h),i.copy(n).addScaledVector(Km,o);hD.subVectors(e,s);const f=Km.dot(hD),p=Jm.dot(hD);if(p>=0&&f<=p)return i.copy(s);const m=f*c-l*p;if(m<=0&&c>=0&&p<=0)return a=c/(c-p),i.copy(n).addScaledVector(Jm,a);const v=h*p-f*u;if(v<=0&&u-h>=0&&f-p>=0)return GH.subVectors(s,r),a=(u-h)/(u-h+(f-p)),i.copy(r).addScaledVector(GH,a);const g=1/(v+m+d);return o=m*g,a=d*g,i.copy(n).addScaledVector(Km,o).addScaledVector(Jm,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let mce=0;class dr extends $c{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:mce++}),this.uuid=Zo(),this.name="",this.type="Material",this.blending=Rp,this.side=jc,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=pN,this.blendDst=mN,this.blendEquation=sp,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=SE,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=UQ,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=DM,this.stencilZFail=DM,this.stencilZPass=DM,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const i in e){const n=e[i];if(n===void 0){console.warn(`THREE.Material: parameter '${i}' has value of undefined.`);continue}const r=this[i];if(r===void 0){console.warn(`THREE.Material: '${i}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[i]=n}}toJSON(e){const i=e===void 0||typeof e=="string";i&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Rp&&(n.blending=this.blending),this.side!==jc&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=this.alphaHash),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(n.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(i){const s=r(e.textures),o=r(e.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const i=e.clippingPlanes;let n=null;if(i!==null){const r=i.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=i[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}const KQ={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ul={h:0,s:0,l:0},oS={h:0,s:0,l:0};function dD(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+(e-t)*6*i:i<1/2?e:i<2/3?t+(e-t)*6*(2/3-i):t}class ht{constructor(e,i,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,i,n)}set(e,i,n){if(i===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,i,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,i=ni){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ea.toWorkingColorSpace(this,i),this}setRGB(e,i,n,r=Ea.workingColorSpace){return this.r=e,this.g=i,this.b=n,Ea.toWorkingColorSpace(this,r),this}setHSL(e,i,n,r=Ea.workingColorSpace){if(e=TN(e,1),i=Bn(i,0,1),n=Bn(n,0,1),i===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+i):n+i-n*i,o=2*n-s;this.r=dD(o,s,e+1/3),this.g=dD(o,s,e),this.b=dD(o,s,e-1/3)}return Ea.toWorkingColorSpace(this,r),this}setStyle(e,i=ni){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,i);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,i);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,i);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,i);if(o===6)return this.setHex(parseInt(s,16),i);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,i);return this}setColorName(e,i=ni){const n=KQ[e.toLowerCase()];return n!==void 0?this.setHex(n,i):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Uv(e.r),this.g=Uv(e.g),this.b=Uv(e.b),this}copyLinearToSRGB(e){return this.r=eD(e.r),this.g=eD(e.g),this.b=eD(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=ni){return Ea.fromWorkingColorSpace(ds.copy(this),e),Math.round(Bn(ds.r*255,0,255))*65536+Math.round(Bn(ds.g*255,0,255))*256+Math.round(Bn(ds.b*255,0,255))}getHexString(e=ni){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,i=Ea.workingColorSpace){Ea.fromWorkingColorSpace(ds.copy(this),i);const n=ds.r,r=ds.g,s=ds.b,o=Math.max(n,r,s),a=Math.min(n,r,s);let l,c;const h=(a+o)/2;if(a===o)l=0,c=0;else{const u=o-a;switch(c=h<=.5?u/(o+a):u/(2-o-a),o){case n:l=(r-s)/u+(r<s?6:0);break;case r:l=(s-n)/u+2;break;case s:l=(n-r)/u+4;break}l/=6}return e.h=l,e.s=c,e.l=h,e}getRGB(e,i=Ea.workingColorSpace){return Ea.fromWorkingColorSpace(ds.copy(this),i),e.r=ds.r,e.g=ds.g,e.b=ds.b,e}getStyle(e=ni){Ea.fromWorkingColorSpace(ds.copy(this),e);const i=ds.r,n=ds.g,r=ds.b;return e!==ni?`color(${e} ${i.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(i*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,i,n){return this.getHSL(ul),ul.h+=e,ul.s+=i,ul.l+=n,this.setHSL(ul.h,ul.s,ul.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,i){return this.r=e.r+i.r,this.g=e.g+i.g,this.b=e.b+i.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,i){return this.r+=(e.r-this.r)*i,this.g+=(e.g-this.g)*i,this.b+=(e.b-this.b)*i,this}lerpColors(e,i,n){return this.r=e.r+(i.r-e.r)*n,this.g=e.g+(i.g-e.g)*n,this.b=e.b+(i.b-e.b)*n,this}lerpHSL(e,i){this.getHSL(ul),e.getHSL(oS);const n=A1(ul.h,oS.h,i),r=A1(ul.s,oS.s,i),s=A1(ul.l,oS.l,i);return this.setHSL(n,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const i=this.r,n=this.g,r=this.b,s=e.elements;return this.r=s[0]*i+s[3]*n+s[6]*r,this.g=s[1]*i+s[4]*n+s[7]*r,this.b=s[2]*i+s[5]*n+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,i=0){return this.r=e[i],this.g=e[i+1],this.b=e[i+2],this}toArray(e=[],i=0){return e[i]=this.r,e[i+1]=this.g,e[i+2]=this.b,e}fromBufferAttribute(e,i){return this.r=e.getX(i),this.g=e.getY(i),this.b=e.getZ(i),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const ds=new ht;ht.NAMES=KQ;class jo extends dr{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ht(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=uw,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Hu=gce();function gce(){const t=new ArrayBuffer(4),e=new Float32Array(t),i=new Uint32Array(t),n=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(n[l]=0,n[l|256]=32768,r[l]=24,r[l|256]=24):c<-14?(n[l]=1024>>-c-14,n[l|256]=1024>>-c-14|32768,r[l]=-c-1,r[l|256]=-c-1):c<=15?(n[l]=c+15<<10,n[l|256]=c+15<<10|32768,r[l]=13,r[l|256]=13):c<128?(n[l]=31744,n[l|256]=64512,r[l]=24,r[l|256]=24):(n[l]=31744,n[l|256]=64512,r[l]=13,r[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,h=0;for(;!(c&8388608);)c<<=1,h-=8388608;c&=-8388609,h+=947912704,s[l]=c|h}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:i,baseTable:n,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function Zs(t){Math.abs(t)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),t=Bn(t,-65504,65504),Hu.floatView[0]=t;const e=Hu.uint32View[0],i=e>>23&511;return Hu.baseTable[i]+((e&8388607)>>Hu.shiftTable[i])}function Zx(t){const e=t>>10;return Hu.uint32View[0]=Hu.mantissaTable[Hu.offsetTable[e]+(t&1023)]+Hu.exponentTable[e],Hu.floatView[0]}const vce={toHalfFloat:Zs,fromHalfFloat:Zx},ir=new te,aS=new Qe;class Ri{constructor(e,i,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=i,this.count=e!==void 0?e.length/i:0,this.normalized=n,this.usage=__,this.updateRange={offset:0,count:-1},this.gpuType=Dc,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,i,n){e*=this.itemSize,n*=i.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=i.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let i=0,n=this.count;i<n;i++)aS.fromBufferAttribute(this,i),aS.applyMatrix3(e),this.setXY(i,aS.x,aS.y);else if(this.itemSize===3)for(let i=0,n=this.count;i<n;i++)ir.fromBufferAttribute(this,i),ir.applyMatrix3(e),this.setXYZ(i,ir.x,ir.y,ir.z);return this}applyMatrix4(e){for(let i=0,n=this.count;i<n;i++)ir.fromBufferAttribute(this,i),ir.applyMatrix4(e),this.setXYZ(i,ir.x,ir.y,ir.z);return this}applyNormalMatrix(e){for(let i=0,n=this.count;i<n;i++)ir.fromBufferAttribute(this,i),ir.applyNormalMatrix(e),this.setXYZ(i,ir.x,ir.y,ir.z);return this}transformDirection(e){for(let i=0,n=this.count;i<n;i++)ir.fromBufferAttribute(this,i),ir.transformDirection(e),this.setXYZ(i,ir.x,ir.y,ir.z);return this}set(e,i=0){return this.array.set(e,i),this}getX(e){let i=this.array[e*this.itemSize];return this.normalized&&(i=Vo(i,this.array)),i}setX(e,i){return this.normalized&&(i=ui(i,this.array)),this.array[e*this.itemSize]=i,this}getY(e){let i=this.array[e*this.itemSize+1];return this.normalized&&(i=Vo(i,this.array)),i}setY(e,i){return this.normalized&&(i=ui(i,this.array)),this.array[e*this.itemSize+1]=i,this}getZ(e){let i=this.array[e*this.itemSize+2];return this.normalized&&(i=Vo(i,this.array)),i}setZ(e,i){return this.normalized&&(i=ui(i,this.array)),this.array[e*this.itemSize+2]=i,this}getW(e){let i=this.array[e*this.itemSize+3];return this.normalized&&(i=Vo(i,this.array)),i}setW(e,i){return this.normalized&&(i=ui(i,this.array)),this.array[e*this.itemSize+3]=i,this}setXY(e,i,n){return e*=this.itemSize,this.normalized&&(i=ui(i,this.array),n=ui(n,this.array)),this.array[e+0]=i,this.array[e+1]=n,this}setXYZ(e,i,n,r){return e*=this.itemSize,this.normalized&&(i=ui(i,this.array),n=ui(n,this.array),r=ui(r,this.array)),this.array[e+0]=i,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,i,n,r,s){return e*=this.itemSize,this.normalized&&(i=ui(i,this.array),n=ui(n,this.array),r=ui(r,this.array),s=ui(s,this.array)),this.array[e+0]=i,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==__&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}}class yce extends Ri{constructor(e,i,n){super(new Int8Array(e),i,n)}}class xce extends Ri{constructor(e,i,n){super(new Uint8Array(e),i,n)}}class _ce extends Ri{constructor(e,i,n){super(new Uint8ClampedArray(e),i,n)}}class wce extends Ri{constructor(e,i,n){super(new Int16Array(e),i,n)}}class DN extends Ri{constructor(e,i,n){super(new Uint16Array(e),i,n)}}class bce extends Ri{constructor(e,i,n){super(new Int32Array(e),i,n)}}class RN extends Ri{constructor(e,i,n){super(new Uint32Array(e),i,n)}}class Sce extends Ri{constructor(e,i,n){super(new Uint16Array(e),i,n),this.isFloat16BufferAttribute=!0}getX(e){let i=Zx(this.array[e*this.itemSize]);return this.normalized&&(i=Vo(i,this.array)),i}setX(e,i){return this.normalized&&(i=ui(i,this.array)),this.array[e*this.itemSize]=Zs(i),this}getY(e){let i=Zx(this.array[e*this.itemSize+1]);return this.normalized&&(i=Vo(i,this.array)),i}setY(e,i){return this.normalized&&(i=ui(i,this.array)),this.array[e*this.itemSize+1]=Zs(i),this}getZ(e){let i=Zx(this.array[e*this.itemSize+2]);return this.normalized&&(i=Vo(i,this.array)),i}setZ(e,i){return this.normalized&&(i=ui(i,this.array)),this.array[e*this.itemSize+2]=Zs(i),this}getW(e){let i=Zx(this.array[e*this.itemSize+3]);return this.normalized&&(i=Vo(i,this.array)),i}setW(e,i){return this.normalized&&(i=ui(i,this.array)),this.array[e*this.itemSize+3]=Zs(i),this}setXY(e,i,n){return e*=this.itemSize,this.normalized&&(i=ui(i,this.array),n=ui(n,this.array)),this.array[e+0]=Zs(i),this.array[e+1]=Zs(n),this}setXYZ(e,i,n,r){return e*=this.itemSize,this.normalized&&(i=ui(i,this.array),n=ui(n,this.array),r=ui(r,this.array)),this.array[e+0]=Zs(i),this.array[e+1]=Zs(n),this.array[e+2]=Zs(r),this}setXYZW(e,i,n,r,s){return e*=this.itemSize,this.normalized&&(i=ui(i,this.array),n=ui(n,this.array),r=ui(r,this.array),s=ui(s,this.array)),this.array[e+0]=Zs(i),this.array[e+1]=Zs(n),this.array[e+2]=Zs(r),this.array[e+3]=Zs(s),this}}class At extends Ri{constructor(e,i,n){super(new Float32Array(e),i,n)}}class Ace extends Ri{constructor(e,i,n){super(new Float64Array(e),i,n)}}let Mce=0;const va=new Wt,fD=new Si,Zm=new te,Lo=new jl,tx=new jl,Rr=new te;class si extends $c{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Mce++}),this.uuid=Zo(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(QQ(e)?RN:DN)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,i){return this.attributes[e]=i,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,i,n=0){this.groups.push({start:e,count:i,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,i){this.drawRange.start=e,this.drawRange.count=i}applyMatrix4(e){const i=this.attributes.position;i!==void 0&&(i.applyMatrix4(e),i.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new ci().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return va.makeRotationFromQuaternion(e),this.applyMatrix4(va),this}rotateX(e){return va.makeRotationX(e),this.applyMatrix4(va),this}rotateY(e){return va.makeRotationY(e),this.applyMatrix4(va),this}rotateZ(e){return va.makeRotationZ(e),this.applyMatrix4(va),this}translate(e,i,n){return va.makeTranslation(e,i,n),this.applyMatrix4(va),this}scale(e,i,n){return va.makeScale(e,i,n),this.applyMatrix4(va),this}lookAt(e){return fD.lookAt(e),fD.updateMatrix(),this.applyMatrix4(fD.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Zm).negate(),this.translate(Zm.x,Zm.y,Zm.z),this}setFromPoints(e){const i=[];for(let n=0,r=e.length;n<r;n++){const s=e[n];i.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new At(i,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new jl);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new te(-1/0,-1/0,-1/0),new te(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),i)for(let n=0,r=i.length;n<r;n++){const s=i[n];Lo.setFromBufferAttribute(s),this.morphTargetsRelative?(Rr.addVectors(this.boundingBox.min,Lo.min),this.boundingBox.expandByPoint(Rr),Rr.addVectors(this.boundingBox.max,Lo.max),this.boundingBox.expandByPoint(Rr)):(this.boundingBox.expandByPoint(Lo.min),this.boundingBox.expandByPoint(Lo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new nl);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new te,1/0);return}if(e){const n=this.boundingSphere.center;if(Lo.setFromBufferAttribute(e),i)for(let s=0,o=i.length;s<o;s++){const a=i[s];tx.setFromBufferAttribute(a),this.morphTargetsRelative?(Rr.addVectors(Lo.min,tx.min),Lo.expandByPoint(Rr),Rr.addVectors(Lo.max,tx.max),Lo.expandByPoint(Rr)):(Lo.expandByPoint(tx.min),Lo.expandByPoint(tx.max))}Lo.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)Rr.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(Rr));if(i)for(let s=0,o=i.length;s<o;s++){const a=i[s],l=this.morphTargetsRelative;for(let c=0,h=a.count;c<h;c++)Rr.fromBufferAttribute(a,c),l&&(Zm.fromBufferAttribute(e,c),Rr.add(Zm)),r=Math.max(r,n.distanceToSquared(Rr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,i=this.attributes;if(e===null||i.position===void 0||i.normal===void 0||i.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=e.array,r=i.position.array,s=i.normal.array,o=i.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ri(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],h=[];for(let P=0;P<a;P++)c[P]=new te,h[P]=new te;const u=new te,d=new te,f=new te,p=new Qe,m=new Qe,v=new Qe,g=new te,y=new te;function x(P,R,U){u.fromArray(r,P*3),d.fromArray(r,R*3),f.fromArray(r,U*3),p.fromArray(o,P*2),m.fromArray(o,R*2),v.fromArray(o,U*2),d.sub(u),f.sub(u),m.sub(p),v.sub(p);const F=1/(m.x*v.y-v.x*m.y);isFinite(F)&&(g.copy(d).multiplyScalar(v.y).addScaledVector(f,-m.y).multiplyScalar(F),y.copy(f).multiplyScalar(m.x).addScaledVector(d,-v.x).multiplyScalar(F),c[P].add(g),c[R].add(g),c[U].add(g),h[P].add(y),h[R].add(y),h[U].add(y))}let b=this.groups;b.length===0&&(b=[{start:0,count:n.length}]);for(let P=0,R=b.length;P<R;++P){const U=b[P],F=U.start,N=U.count;for(let W=F,Q=F+N;W<Q;W+=3)x(n[W+0],n[W+1],n[W+2])}const S=new te,A=new te,E=new te,M=new te;function T(P){E.fromArray(s,P*3),M.copy(E);const R=c[P];S.copy(R),S.sub(E.multiplyScalar(E.dot(R))).normalize(),A.crossVectors(M,R);const F=A.dot(h[P])<0?-1:1;l[P*4]=S.x,l[P*4+1]=S.y,l[P*4+2]=S.z,l[P*4+3]=F}for(let P=0,R=b.length;P<R;++P){const U=b[P],F=U.start,N=U.count;for(let W=F,Q=F+N;W<Q;W+=3)T(n[W+0]),T(n[W+1]),T(n[W+2])}}computeVertexNormals(){const e=this.index,i=this.getAttribute("position");if(i!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Ri(new Float32Array(i.count*3),3),this.setAttribute("normal",n);else for(let d=0,f=n.count;d<f;d++)n.setXYZ(d,0,0,0);const r=new te,s=new te,o=new te,a=new te,l=new te,c=new te,h=new te,u=new te;if(e)for(let d=0,f=e.count;d<f;d+=3){const p=e.getX(d+0),m=e.getX(d+1),v=e.getX(d+2);r.fromBufferAttribute(i,p),s.fromBufferAttribute(i,m),o.fromBufferAttribute(i,v),h.subVectors(o,s),u.subVectors(r,s),h.cross(u),a.fromBufferAttribute(n,p),l.fromBufferAttribute(n,m),c.fromBufferAttribute(n,v),a.add(h),l.add(h),c.add(h),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(m,l.x,l.y,l.z),n.setXYZ(v,c.x,c.y,c.z)}else for(let d=0,f=i.count;d<f;d+=3)r.fromBufferAttribute(i,d+0),s.fromBufferAttribute(i,d+1),o.fromBufferAttribute(i,d+2),h.subVectors(o,s),u.subVectors(r,s),h.cross(u),n.setXYZ(d+0,h.x,h.y,h.z),n.setXYZ(d+1,h.x,h.y,h.z),n.setXYZ(d+2,h.x,h.y,h.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let i=0,n=e.count;i<n;i++)Rr.fromBufferAttribute(e,i),Rr.normalize(),e.setXYZ(i,Rr.x,Rr.y,Rr.z)}toNonIndexed(){function e(a,l){const c=a.array,h=a.itemSize,u=a.normalized,d=new c.constructor(l.length*h);let f=0,p=0;for(let m=0,v=l.length;m<v;m++){a.isInterleavedBufferAttribute?f=l[m]*a.data.stride+a.offset:f=l[m]*h;for(let g=0;g<h;g++)d[p++]=c[f++]}return new Ri(d,h,u)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const i=new si,n=this.index.array,r=this.attributes;for(const a in r){const l=r[a],c=e(l,n);i.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let h=0,u=c.length;h<u;h++){const d=c[h],f=e(d,n);l.push(f)}i.morphAttributes[a]=l}i.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];i.addGroup(c.start,c.count,c.materialIndex)}return i}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const i=this.index;i!==null&&(e.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});const n=this.attributes;for(const l in n){const c=n[l];e.data.attributes[l]=c.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],h=[];for(let u=0,d=c.length;u<d;u++){const f=c[u];h.push(f.toJSON(e.data))}h.length>0&&(r[l]=h,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(i));const r=e.attributes;for(const c in r){const h=r[c];this.setAttribute(c,h.clone(i))}const s=e.morphAttributes;for(const c in s){const h=[],u=s[c];for(let d=0,f=u.length;d<f;d++)h.push(u[d].clone(i));this.morphAttributes[c]=h}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,h=o.length;c<h;c++){const u=o[c];this.addGroup(u.start,u.count,u.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const HH=new Wt,Cf=new ty,lS=new nl,VH=new te,$m=new te,eg=new te,tg=new te,pD=new te,cS=new te,uS=new Qe,hS=new Qe,dS=new Qe,jH=new te,WH=new te,XH=new te,fS=new te,pS=new te;class Ur extends Si{constructor(e=new si,i=new jo){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const i=this.geometry.morphAttributes,n=Object.keys(i);if(n.length>0){const r=i[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,i){const n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,o=n.morphTargetsRelative;i.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){cS.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const h=a[l],u=s[l];h!==0&&(pD.fromBufferAttribute(u,e),o?cS.addScaledVector(pD,h):cS.addScaledVector(pD.sub(i),h))}i.add(cS)}return i}raycast(e,i){const n=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),lS.copy(n.boundingSphere),lS.applyMatrix4(s),Cf.copy(e.ray).recast(e.near),!(lS.containsPoint(Cf.origin)===!1&&(Cf.intersectSphere(lS,VH)===null||Cf.origin.distanceToSquared(VH)>(e.far-e.near)**2))&&(HH.copy(s).invert(),Cf.copy(e.ray).applyMatrix4(HH),!(n.boundingBox!==null&&Cf.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,i,Cf)))}_computeIntersections(e,i,n){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,h=s.attributes.uv1,u=s.attributes.normal,d=s.groups,f=s.drawRange;if(a!==null)if(Array.isArray(o))for(let p=0,m=d.length;p<m;p++){const v=d[p],g=o[v.materialIndex],y=Math.max(v.start,f.start),x=Math.min(a.count,Math.min(v.start+v.count,f.start+f.count));for(let b=y,S=x;b<S;b+=3){const A=a.getX(b),E=a.getX(b+1),M=a.getX(b+2);r=mS(this,g,e,n,c,h,u,A,E,M),r&&(r.faceIndex=Math.floor(b/3),r.face.materialIndex=v.materialIndex,i.push(r))}}else{const p=Math.max(0,f.start),m=Math.min(a.count,f.start+f.count);for(let v=p,g=m;v<g;v+=3){const y=a.getX(v),x=a.getX(v+1),b=a.getX(v+2);r=mS(this,o,e,n,c,h,u,y,x,b),r&&(r.faceIndex=Math.floor(v/3),i.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let p=0,m=d.length;p<m;p++){const v=d[p],g=o[v.materialIndex],y=Math.max(v.start,f.start),x=Math.min(l.count,Math.min(v.start+v.count,f.start+f.count));for(let b=y,S=x;b<S;b+=3){const A=b,E=b+1,M=b+2;r=mS(this,g,e,n,c,h,u,A,E,M),r&&(r.faceIndex=Math.floor(b/3),r.face.materialIndex=v.materialIndex,i.push(r))}}else{const p=Math.max(0,f.start),m=Math.min(l.count,f.start+f.count);for(let v=p,g=m;v<g;v+=3){const y=v,x=v+1,b=v+2;r=mS(this,o,e,n,c,h,u,y,x,b),r&&(r.faceIndex=Math.floor(v/3),i.push(r))}}}}function Ece(t,e,i,n,r,s,o,a){let l;if(e.side===Vs?l=n.intersectTriangle(o,s,r,!0,a):l=n.intersectTriangle(r,s,o,e.side===jc,a),l===null)return null;pS.copy(a),pS.applyMatrix4(t.matrixWorld);const c=i.ray.origin.distanceTo(pS);return c<i.near||c>i.far?null:{distance:c,point:pS.clone(),object:t}}function mS(t,e,i,n,r,s,o,a,l,c){t.getVertexPosition(a,$m),t.getVertexPosition(l,eg),t.getVertexPosition(c,tg);const h=Ece(t,e,i,n,$m,eg,tg,fS);if(h){r&&(uS.fromBufferAttribute(r,a),hS.fromBufferAttribute(r,l),dS.fromBufferAttribute(r,c),h.uv=to.getInterpolation(fS,$m,eg,tg,uS,hS,dS,new Qe)),s&&(uS.fromBufferAttribute(s,a),hS.fromBufferAttribute(s,l),dS.fromBufferAttribute(s,c),h.uv1=to.getInterpolation(fS,$m,eg,tg,uS,hS,dS,new Qe),h.uv2=h.uv1),o&&(jH.fromBufferAttribute(o,a),WH.fromBufferAttribute(o,l),XH.fromBufferAttribute(o,c),h.normal=to.getInterpolation(fS,$m,eg,tg,jH,WH,XH,new te),h.normal.dot(n.direction)>0&&h.normal.multiplyScalar(-1));const u={a,b:l,c,normal:new te,materialIndex:0};to.getNormal($m,eg,tg,u.normal),h.face=u}return h}class pm extends si{constructor(e=1,i=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:i,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],h=[],u=[];let d=0,f=0;p("z","y","x",-1,-1,n,i,e,o,s,0),p("z","y","x",1,-1,n,i,-e,o,s,1),p("x","z","y",1,1,e,n,i,r,o,2),p("x","z","y",1,-1,e,n,-i,r,o,3),p("x","y","z",1,-1,e,i,n,r,s,4),p("x","y","z",-1,-1,e,i,-n,r,s,5),this.setIndex(l),this.setAttribute("position",new At(c,3)),this.setAttribute("normal",new At(h,3)),this.setAttribute("uv",new At(u,2));function p(m,v,g,y,x,b,S,A,E,M,T){const P=b/E,R=S/M,U=b/2,F=S/2,N=A/2,W=E+1,Q=M+1;let X=0,B=0;const j=new te;for(let z=0;z<Q;z++){const k=z*R-F;for(let G=0;G<W;G++){const Z=G*P-U;j[m]=Z*y,j[v]=k*x,j[g]=N,c.push(j.x,j.y,j.z),j[m]=0,j[v]=0,j[g]=A>0?1:-1,h.push(j.x,j.y,j.z),u.push(G/E),u.push(1-z/M),X+=1}}for(let z=0;z<M;z++)for(let k=0;k<E;k++){const G=d+k+W*z,Z=d+k+W*(z+1),K=d+(k+1)+W*(z+1),re=d+(k+1)+W*z;l.push(G,Z,re),l.push(Z,K,re),B+=6}a.addGroup(f,B,T),f+=B,d+=X}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pm(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function g0(t){const e={};for(const i in t){e[i]={};for(const n in t[i]){const r=t[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[i][n]=null):e[i][n]=r.clone():Array.isArray(r)?e[i][n]=r.slice():e[i][n]=r}}return e}function Os(t){const e={};for(let i=0;i<t.length;i++){const n=g0(t[i]);for(const r in n)e[r]=n[r]}return e}function Tce(t){const e=[];for(let i=0;i<t.length;i++)e.push(t[i].clone());return e}function JQ(t){return t.getRenderTarget()===null?t.outputColorSpace:zl}const ZQ={clone:g0,merge:Os};var Cce=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Pce=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Xc extends dr{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Cce,this.fragmentShader=Pce,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=g0(e.uniforms),this.uniformsGroups=Tce(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const i=super.toJSON(e);i.glslVersion=this.glslVersion,i.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?i.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?i.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?i.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?i.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?i.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?i.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?i.uniforms[r]={type:"m4",value:o.toArray()}:i.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(i.defines=this.defines),i.vertexShader=this.vertexShader,i.fragmentShader=this.fragmentShader,i.lights=this.lights,i.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(i.extensions=n),i}}class dw extends Si{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Wt,this.projectionMatrix=new Wt,this.projectionMatrixInverse=new Wt,this.coordinateSystem=Rc}copy(e,i){return super.copy(e,i),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return e.set(-i[8],-i[9],-i[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,i){super.updateWorldMatrix(e,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class fn extends dw{constructor(e=50,i=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=i,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const i=.5*this.getFilmHeight()/e;this.fov=m0*2*Math.atan(i),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Ip*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return m0*2*Math.atan(Math.tan(Ip*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,i,n,r,s,o){this.aspect=e/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let i=e*Math.tan(Ip*.5*this.fov)/this.zoom,n=2*i,r=this.aspect*n,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,i-=o.offsetY*n/c,r*=o.width/l,n*=o.height/c}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,i,i-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}}const ig=-90,ng=1;class IN extends Si{constructor(e,i,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null;const r=new fn(ig,ng,e,i);r.layers=this.layers,this.add(r);const s=new fn(ig,ng,e,i);s.layers=this.layers,this.add(s);const o=new fn(ig,ng,e,i);o.layers=this.layers,this.add(o);const a=new fn(ig,ng,e,i);a.layers=this.layers,this.add(a);const l=new fn(ig,ng,e,i);l.layers=this.layers,this.add(l);const c=new fn(ig,ng,e,i);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,i=this.children.concat(),[n,r,s,o,a,l]=i;for(const c of i)this.remove(c);if(e===Rc)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===w_)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of i)this.add(c),c.updateMatrixWorld()}update(e,i){this.parent===null&&this.updateMatrixWorld();const n=this.renderTarget;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,s,o,a,l,c]=this.children,h=e.getRenderTarget(),u=e.toneMapping,d=e.xr.enabled;e.toneMapping=Ll,e.xr.enabled=!1;const f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(i,r),e.setRenderTarget(n,1),e.render(i,s),e.setRenderTarget(n,2),e.render(i,o),e.setRenderTarget(n,3),e.render(i,a),e.setRenderTarget(n,4),e.render(i,l),n.texture.generateMipmaps=f,e.setRenderTarget(n,5),e.render(i,c),e.setRenderTarget(h),e.toneMapping=u,e.xr.enabled=d,n.texture.needsPMREMUpdate=!0}}class fw extends pn{constructor(e,i,n,r,s,o,a,l,c,h){e=e!==void 0?e:[],i=i!==void 0?i:Xd,super(e,i,n,r,s,o,a,l,c,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class LN extends Gl{constructor(e=1,i={}){super(e,e,i),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];i.encoding!==void 0&&(M1("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===Rd?ni:Id),this.texture=new fw(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:xn}fromEquirectangularTexture(e,i){this.texture.type=i.type,this.texture.colorSpace=i.colorSpace,this.texture.generateMipmaps=i.generateMipmaps,this.texture.minFilter=i.minFilter,this.texture.magFilter=i.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new pm(5,5,5),s=new Xc({name:"CubemapFromEquirect",uniforms:g0(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Vs,blending:$u});s.uniforms.tEquirect.value=i;const o=new Ur(r,s),a=i.minFilter;return i.minFilter===Wc&&(i.minFilter=xn),new IN(1,10,this).update(e,o),i.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,i,n,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(i,n,r);e.setRenderTarget(s)}}const mD=new te,Dce=new te,Rce=new ci;class ed{constructor(e=new te(1,0,0),i=0){this.isPlane=!0,this.normal=e,this.constant=i}set(e,i){return this.normal.copy(e),this.constant=i,this}setComponents(e,i,n,r){return this.normal.set(e,i,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,i){return this.normal.copy(e),this.constant=-i.dot(this.normal),this}setFromCoplanarPoints(e,i,n){const r=mD.subVectors(n,i).cross(Dce.subVectors(e,i)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,i){return i.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,i){const n=e.delta(mD),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?i.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:i.copy(e.start).addScaledVector(n,s)}intersectsLine(e){const i=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return i<0&&n>0||n<0&&i>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,i){const n=i||Rce.getNormalMatrix(e),r=this.coplanarPoint(mD).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Pf=new nl,gS=new te;class fC{constructor(e=new ed,i=new ed,n=new ed,r=new ed,s=new ed,o=new ed){this.planes=[e,i,n,r,s,o]}set(e,i,n,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(i),a[2].copy(n),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const i=this.planes;for(let n=0;n<6;n++)i[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,i=Rc){const n=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],c=r[4],h=r[5],u=r[6],d=r[7],f=r[8],p=r[9],m=r[10],v=r[11],g=r[12],y=r[13],x=r[14],b=r[15];if(n[0].setComponents(l-s,d-c,v-f,b-g).normalize(),n[1].setComponents(l+s,d+c,v+f,b+g).normalize(),n[2].setComponents(l+o,d+h,v+p,b+y).normalize(),n[3].setComponents(l-o,d-h,v-p,b-y).normalize(),n[4].setComponents(l-a,d-u,v-m,b-x).normalize(),i===Rc)n[5].setComponents(l+a,d+u,v+m,b+x).normalize();else if(i===w_)n[5].setComponents(a,u,m,x).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+i);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Pf.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const i=e.geometry;i.boundingSphere===null&&i.computeBoundingSphere(),Pf.copy(i.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Pf)}intersectsSprite(e){return Pf.center.set(0,0,0),Pf.radius=.7071067811865476,Pf.applyMatrix4(e.matrixWorld),this.intersectsSphere(Pf)}intersectsSphere(e){const i=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(i[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const i=this.planes;for(let n=0;n<6;n++){const r=i[n];if(gS.x=r.normal.x>0?e.max.x:e.min.x,gS.y=r.normal.y>0?e.max.y:e.min.y,gS.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(gS)<0)return!1}return!0}containsPoint(e){const i=this.planes;for(let n=0;n<6;n++)if(i[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function $Q(){let t=null,e=!1,i=null,n=null;function r(s,o){i(s,o),n=t.requestAnimationFrame(r)}return{start:function(){e!==!0&&i!==null&&(n=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){i=s},setContext:function(s){t=s}}}function Ice(t,e){const i=e.isWebGL2,n=new WeakMap;function r(c,h){const u=c.array,d=c.usage,f=t.createBuffer();t.bindBuffer(h,f),t.bufferData(h,u,d),c.onUploadCallback();let p;if(u instanceof Float32Array)p=t.FLOAT;else if(u instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(i)p=t.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else p=t.UNSIGNED_SHORT;else if(u instanceof Int16Array)p=t.SHORT;else if(u instanceof Uint32Array)p=t.UNSIGNED_INT;else if(u instanceof Int32Array)p=t.INT;else if(u instanceof Int8Array)p=t.BYTE;else if(u instanceof Uint8Array)p=t.UNSIGNED_BYTE;else if(u instanceof Uint8ClampedArray)p=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:f,type:p,bytesPerElement:u.BYTES_PER_ELEMENT,version:c.version}}function s(c,h,u){const d=h.array,f=h.updateRange;t.bindBuffer(u,c),f.count===-1?t.bufferSubData(u,0,d):(i?t.bufferSubData(u,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):t.bufferSubData(u,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1),h.onUploadCallback()}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),n.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const h=n.get(c);h&&(t.deleteBuffer(h.buffer),n.delete(c))}function l(c,h){if(c.isGLBufferAttribute){const d=n.get(c);(!d||d.version<c.version)&&n.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);const u=n.get(c);u===void 0?n.set(c,r(c,h)):u.version<c.version&&(s(u.buffer,c,h),u.version=c.version)}return{get:o,remove:a,update:l}}class pw extends si{constructor(e=1,i=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:i,widthSegments:n,heightSegments:r};const s=e/2,o=i/2,a=Math.floor(n),l=Math.floor(r),c=a+1,h=l+1,u=e/a,d=i/l,f=[],p=[],m=[],v=[];for(let g=0;g<h;g++){const y=g*d-o;for(let x=0;x<c;x++){const b=x*u-s;p.push(b,-y,0),m.push(0,0,1),v.push(x/a),v.push(1-g/l)}}for(let g=0;g<l;g++)for(let y=0;y<a;y++){const x=y+c*g,b=y+c*(g+1),S=y+1+c*(g+1),A=y+1+c*g;f.push(x,b,A),f.push(b,S,A)}this.setIndex(f),this.setAttribute("position",new At(p,3)),this.setAttribute("normal",new At(m,3)),this.setAttribute("uv",new At(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pw(e.width,e.height,e.widthSegments,e.heightSegments)}}var Lce=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Bce=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Oce=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,Fce=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Nce=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,Uce=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,kce=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,zce=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Gce=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,Hce=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Vce=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,jce=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Wce=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Xce=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,qce=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Yce=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Qce=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Kce=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Jce=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Zce=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,$ce=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,eue=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,tue=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,iue=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,nue=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,rue=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,sue=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,oue=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,aue="gl_FragColor = linearToOutputTexel( gl_FragColor );",lue=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,cue=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,uue=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,hue=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,due=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,fue=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,pue=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,mue=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,gue=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,vue=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,yue=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,xue=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,_ue=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,wue=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,bue=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Sue=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Aue=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Mue=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Eue=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Tue=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Cue=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Pue=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	anisotropyV /= material.anisotropy;
	material.anisotropy = saturate( material.anisotropy );
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;
#endif`,Due=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Rue=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Iue=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Lue=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,Bue=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Oue=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Fue=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Nue=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,Uue=`#ifdef USE_MAP
	diffuseColor *= texture2D( map, vMapUv );
#endif`,kue=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,zue=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Gue=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Hue=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Vue=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,jue=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Wue=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Xue=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,que=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Yue=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 geometryNormal = normal;`,Que=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Kue=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Jue=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Zue=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,$ue=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,ehe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,the=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,ihe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,nhe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,rhe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,she=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,ohe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,ahe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,lhe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,che=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,uhe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,hhe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,dhe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,fhe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,phe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,mhe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,ghe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,vhe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,yhe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,xhe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,_he=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,whe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,bhe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,She=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Ahe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Mhe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Ehe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,The=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Che=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Phe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Dhe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Rhe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Ihe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Lhe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Bhe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Ohe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Fhe=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Nhe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Uhe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,khe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,zhe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Ghe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Hhe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Vhe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,jhe=`#include <common>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Whe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Xhe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,qhe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Yhe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Qhe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Khe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Jhe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Zhe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,$he=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ede=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,tde=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ide=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,nde=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rde=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,sde=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,ode=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ade=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,lde=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,cde=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,oi={alphahash_fragment:Lce,alphahash_pars_fragment:Bce,alphamap_fragment:Oce,alphamap_pars_fragment:Fce,alphatest_fragment:Nce,alphatest_pars_fragment:Uce,aomap_fragment:kce,aomap_pars_fragment:zce,begin_vertex:Gce,beginnormal_vertex:Hce,bsdfs:Vce,iridescence_fragment:jce,bumpmap_pars_fragment:Wce,clipping_planes_fragment:Xce,clipping_planes_pars_fragment:qce,clipping_planes_pars_vertex:Yce,clipping_planes_vertex:Qce,color_fragment:Kce,color_pars_fragment:Jce,color_pars_vertex:Zce,color_vertex:$ce,common:eue,cube_uv_reflection_fragment:tue,defaultnormal_vertex:iue,displacementmap_pars_vertex:nue,displacementmap_vertex:rue,emissivemap_fragment:sue,emissivemap_pars_fragment:oue,colorspace_fragment:aue,colorspace_pars_fragment:lue,envmap_fragment:cue,envmap_common_pars_fragment:uue,envmap_pars_fragment:hue,envmap_pars_vertex:due,envmap_physical_pars_fragment:Aue,envmap_vertex:fue,fog_vertex:pue,fog_pars_vertex:mue,fog_fragment:gue,fog_pars_fragment:vue,gradientmap_pars_fragment:yue,lightmap_fragment:xue,lightmap_pars_fragment:_ue,lights_lambert_fragment:wue,lights_lambert_pars_fragment:bue,lights_pars_begin:Sue,lights_toon_fragment:Mue,lights_toon_pars_fragment:Eue,lights_phong_fragment:Tue,lights_phong_pars_fragment:Cue,lights_physical_fragment:Pue,lights_physical_pars_fragment:Due,lights_fragment_begin:Rue,lights_fragment_maps:Iue,lights_fragment_end:Lue,logdepthbuf_fragment:Bue,logdepthbuf_pars_fragment:Oue,logdepthbuf_pars_vertex:Fue,logdepthbuf_vertex:Nue,map_fragment:Uue,map_pars_fragment:kue,map_particle_fragment:zue,map_particle_pars_fragment:Gue,metalnessmap_fragment:Hue,metalnessmap_pars_fragment:Vue,morphcolor_vertex:jue,morphnormal_vertex:Wue,morphtarget_pars_vertex:Xue,morphtarget_vertex:que,normal_fragment_begin:Yue,normal_fragment_maps:Que,normal_pars_fragment:Kue,normal_pars_vertex:Jue,normal_vertex:Zue,normalmap_pars_fragment:$ue,clearcoat_normal_fragment_begin:ehe,clearcoat_normal_fragment_maps:the,clearcoat_pars_fragment:ihe,iridescence_pars_fragment:nhe,opaque_fragment:rhe,packing:she,premultiplied_alpha_fragment:ohe,project_vertex:ahe,dithering_fragment:lhe,dithering_pars_fragment:che,roughnessmap_fragment:uhe,roughnessmap_pars_fragment:hhe,shadowmap_pars_fragment:dhe,shadowmap_pars_vertex:fhe,shadowmap_vertex:phe,shadowmask_pars_fragment:mhe,skinbase_vertex:ghe,skinning_pars_vertex:vhe,skinning_vertex:yhe,skinnormal_vertex:xhe,specularmap_fragment:_he,specularmap_pars_fragment:whe,tonemapping_fragment:bhe,tonemapping_pars_fragment:She,transmission_fragment:Ahe,transmission_pars_fragment:Mhe,uv_pars_fragment:Ehe,uv_pars_vertex:The,uv_vertex:Che,worldpos_vertex:Phe,background_vert:Dhe,background_frag:Rhe,backgroundCube_vert:Ihe,backgroundCube_frag:Lhe,cube_vert:Bhe,cube_frag:Ohe,depth_vert:Fhe,depth_frag:Nhe,distanceRGBA_vert:Uhe,distanceRGBA_frag:khe,equirect_vert:zhe,equirect_frag:Ghe,linedashed_vert:Hhe,linedashed_frag:Vhe,meshbasic_vert:jhe,meshbasic_frag:Whe,meshlambert_vert:Xhe,meshlambert_frag:qhe,meshmatcap_vert:Yhe,meshmatcap_frag:Qhe,meshnormal_vert:Khe,meshnormal_frag:Jhe,meshphong_vert:Zhe,meshphong_frag:$he,meshphysical_vert:ede,meshphysical_frag:tde,meshtoon_vert:ide,meshtoon_frag:nde,points_vert:rde,points_frag:sde,shadow_vert:ode,shadow_frag:ade,sprite_vert:lde,sprite_frag:cde},ct={common:{diffuse:{value:new ht(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new ci},alphaMap:{value:null},alphaMapTransform:{value:new ci},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new ci}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new ci}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new ci}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new ci},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new ci},normalScale:{value:new Qe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new ci},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new ci}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new ci}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new ci}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ht(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ht(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new ci},alphaTest:{value:0},uvTransform:{value:new ci}},sprite:{diffuse:{value:new ht(16777215)},opacity:{value:1},center:{value:new Qe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new ci},alphaMap:{value:null},alphaMapTransform:{value:new ci},alphaTest:{value:0}}},Al={basic:{uniforms:Os([ct.common,ct.specularmap,ct.envmap,ct.aomap,ct.lightmap,ct.fog]),vertexShader:oi.meshbasic_vert,fragmentShader:oi.meshbasic_frag},lambert:{uniforms:Os([ct.common,ct.specularmap,ct.envmap,ct.aomap,ct.lightmap,ct.emissivemap,ct.bumpmap,ct.normalmap,ct.displacementmap,ct.fog,ct.lights,{emissive:{value:new ht(0)}}]),vertexShader:oi.meshlambert_vert,fragmentShader:oi.meshlambert_frag},phong:{uniforms:Os([ct.common,ct.specularmap,ct.envmap,ct.aomap,ct.lightmap,ct.emissivemap,ct.bumpmap,ct.normalmap,ct.displacementmap,ct.fog,ct.lights,{emissive:{value:new ht(0)},specular:{value:new ht(1118481)},shininess:{value:30}}]),vertexShader:oi.meshphong_vert,fragmentShader:oi.meshphong_frag},standard:{uniforms:Os([ct.common,ct.envmap,ct.aomap,ct.lightmap,ct.emissivemap,ct.bumpmap,ct.normalmap,ct.displacementmap,ct.roughnessmap,ct.metalnessmap,ct.fog,ct.lights,{emissive:{value:new ht(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:oi.meshphysical_vert,fragmentShader:oi.meshphysical_frag},toon:{uniforms:Os([ct.common,ct.aomap,ct.lightmap,ct.emissivemap,ct.bumpmap,ct.normalmap,ct.displacementmap,ct.gradientmap,ct.fog,ct.lights,{emissive:{value:new ht(0)}}]),vertexShader:oi.meshtoon_vert,fragmentShader:oi.meshtoon_frag},matcap:{uniforms:Os([ct.common,ct.bumpmap,ct.normalmap,ct.displacementmap,ct.fog,{matcap:{value:null}}]),vertexShader:oi.meshmatcap_vert,fragmentShader:oi.meshmatcap_frag},points:{uniforms:Os([ct.points,ct.fog]),vertexShader:oi.points_vert,fragmentShader:oi.points_frag},dashed:{uniforms:Os([ct.common,ct.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:oi.linedashed_vert,fragmentShader:oi.linedashed_frag},depth:{uniforms:Os([ct.common,ct.displacementmap]),vertexShader:oi.depth_vert,fragmentShader:oi.depth_frag},normal:{uniforms:Os([ct.common,ct.bumpmap,ct.normalmap,ct.displacementmap,{opacity:{value:1}}]),vertexShader:oi.meshnormal_vert,fragmentShader:oi.meshnormal_frag},sprite:{uniforms:Os([ct.sprite,ct.fog]),vertexShader:oi.sprite_vert,fragmentShader:oi.sprite_frag},background:{uniforms:{uvTransform:{value:new ci},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:oi.background_vert,fragmentShader:oi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:oi.backgroundCube_vert,fragmentShader:oi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:oi.cube_vert,fragmentShader:oi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:oi.equirect_vert,fragmentShader:oi.equirect_frag},distanceRGBA:{uniforms:Os([ct.common,ct.displacementmap,{referencePosition:{value:new te},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:oi.distanceRGBA_vert,fragmentShader:oi.distanceRGBA_frag},shadow:{uniforms:Os([ct.lights,ct.fog,{color:{value:new ht(0)},opacity:{value:1}}]),vertexShader:oi.shadow_vert,fragmentShader:oi.shadow_frag}};Al.physical={uniforms:Os([Al.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new ci},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new ci},clearcoatNormalScale:{value:new Qe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new ci},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new ci},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new ci},sheen:{value:0},sheenColor:{value:new ht(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new ci},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new ci},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new ci},transmissionSamplerSize:{value:new Qe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new ci},attenuationDistance:{value:0},attenuationColor:{value:new ht(0)},specularColor:{value:new ht(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new ci},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new ci},anisotropyVector:{value:new Qe},anisotropyMap:{value:null},anisotropyMapTransform:{value:new ci}}]),vertexShader:oi.meshphysical_vert,fragmentShader:oi.meshphysical_frag};const vS={r:0,b:0,g:0};function ude(t,e,i,n,r,s,o){const a=new ht(0);let l=s===!0?0:1,c,h,u=null,d=0,f=null;function p(v,g){let y=!1,x=g.isScene===!0?g.background:null;switch(x&&x.isTexture&&(x=(g.backgroundBlurriness>0?i:e).get(x)),x===null?m(a,l):x&&x.isColor&&(m(x,1),y=!0),t.xr.getEnvironmentBlendMode()){case"opaque":y=!0;break;case"additive":n.buffers.color.setClear(0,0,0,1,o),y=!0;break;case"alpha-blend":n.buffers.color.setClear(0,0,0,0,o),y=!0;break}(t.autoClear||y)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),x&&(x.isCubeTexture||x.mapping===ey)?(h===void 0&&(h=new Ur(new pm(1,1,1),new Xc({name:"BackgroundCubeMaterial",uniforms:g0(Al.backgroundCube.uniforms),vertexShader:Al.backgroundCube.vertexShader,fragmentShader:Al.backgroundCube.fragmentShader,side:Vs,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(A,E,M){this.matrixWorld.copyPosition(M.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(h)),h.material.uniforms.envMap.value=x,h.material.uniforms.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,h.material.uniforms.backgroundBlurriness.value=g.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,h.material.toneMapped=x.colorSpace!==ni,(u!==x||d!==x.version||f!==t.toneMapping)&&(h.material.needsUpdate=!0,u=x,d=x.version,f=t.toneMapping),h.layers.enableAll(),v.unshift(h,h.geometry,h.material,0,0,null)):x&&x.isTexture&&(c===void 0&&(c=new Ur(new pw(2,2),new Xc({name:"BackgroundMaterial",uniforms:g0(Al.background.uniforms),vertexShader:Al.background.vertexShader,fragmentShader:Al.background.fragmentShader,side:jc,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=x,c.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,c.material.toneMapped=x.colorSpace!==ni,x.matrixAutoUpdate===!0&&x.updateMatrix(),c.material.uniforms.uvTransform.value.copy(x.matrix),(u!==x||d!==x.version||f!==t.toneMapping)&&(c.material.needsUpdate=!0,u=x,d=x.version,f=t.toneMapping),c.layers.enableAll(),v.unshift(c,c.geometry,c.material,0,0,null))}function m(v,g){v.getRGB(vS,JQ(t)),n.buffers.color.setClear(vS.r,vS.g,vS.b,g,o)}return{getClearColor:function(){return a},setClearColor:function(v,g=1){a.set(v),l=g,m(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(v){l=v,m(a,l)},render:p}}function hde(t,e,i,n){const r=t.getParameter(t.MAX_VERTEX_ATTRIBS),s=n.isWebGL2?null:e.get("OES_vertex_array_object"),o=n.isWebGL2||s!==null,a={},l=v(null);let c=l,h=!1;function u(N,W,Q,X,B){let j=!1;if(o){const z=m(X,Q,W);c!==z&&(c=z,f(c.object)),j=g(N,X,Q,B),j&&y(N,X,Q,B)}else{const z=W.wireframe===!0;(c.geometry!==X.id||c.program!==Q.id||c.wireframe!==z)&&(c.geometry=X.id,c.program=Q.id,c.wireframe=z,j=!0)}B!==null&&i.update(B,t.ELEMENT_ARRAY_BUFFER),(j||h)&&(h=!1,M(N,W,Q,X),B!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i.get(B).buffer))}function d(){return n.isWebGL2?t.createVertexArray():s.createVertexArrayOES()}function f(N){return n.isWebGL2?t.bindVertexArray(N):s.bindVertexArrayOES(N)}function p(N){return n.isWebGL2?t.deleteVertexArray(N):s.deleteVertexArrayOES(N)}function m(N,W,Q){const X=Q.wireframe===!0;let B=a[N.id];B===void 0&&(B={},a[N.id]=B);let j=B[W.id];j===void 0&&(j={},B[W.id]=j);let z=j[X];return z===void 0&&(z=v(d()),j[X]=z),z}function v(N){const W=[],Q=[],X=[];for(let B=0;B<r;B++)W[B]=0,Q[B]=0,X[B]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:W,enabledAttributes:Q,attributeDivisors:X,object:N,attributes:{},index:null}}function g(N,W,Q,X){const B=c.attributes,j=W.attributes;let z=0;const k=Q.getAttributes();for(const G in k)if(k[G].location>=0){const K=B[G];let re=j[G];if(re===void 0&&(G==="instanceMatrix"&&N.instanceMatrix&&(re=N.instanceMatrix),G==="instanceColor"&&N.instanceColor&&(re=N.instanceColor)),K===void 0||K.attribute!==re||re&&K.data!==re.data)return!0;z++}return c.attributesNum!==z||c.index!==X}function y(N,W,Q,X){const B={},j=W.attributes;let z=0;const k=Q.getAttributes();for(const G in k)if(k[G].location>=0){let K=j[G];K===void 0&&(G==="instanceMatrix"&&N.instanceMatrix&&(K=N.instanceMatrix),G==="instanceColor"&&N.instanceColor&&(K=N.instanceColor));const re={};re.attribute=K,K&&K.data&&(re.data=K.data),B[G]=re,z++}c.attributes=B,c.attributesNum=z,c.index=X}function x(){const N=c.newAttributes;for(let W=0,Q=N.length;W<Q;W++)N[W]=0}function b(N){S(N,0)}function S(N,W){const Q=c.newAttributes,X=c.enabledAttributes,B=c.attributeDivisors;Q[N]=1,X[N]===0&&(t.enableVertexAttribArray(N),X[N]=1),B[N]!==W&&((n.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](N,W),B[N]=W)}function A(){const N=c.newAttributes,W=c.enabledAttributes;for(let Q=0,X=W.length;Q<X;Q++)W[Q]!==N[Q]&&(t.disableVertexAttribArray(Q),W[Q]=0)}function E(N,W,Q,X,B,j,z){z===!0?t.vertexAttribIPointer(N,W,Q,B,j):t.vertexAttribPointer(N,W,Q,X,B,j)}function M(N,W,Q,X){if(n.isWebGL2===!1&&(N.isInstancedMesh||X.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;x();const B=X.attributes,j=Q.getAttributes(),z=W.defaultAttributeValues;for(const k in j){const G=j[k];if(G.location>=0){let Z=B[k];if(Z===void 0&&(k==="instanceMatrix"&&N.instanceMatrix&&(Z=N.instanceMatrix),k==="instanceColor"&&N.instanceColor&&(Z=N.instanceColor)),Z!==void 0){const K=Z.normalized,re=Z.itemSize,J=i.get(Z);if(J===void 0)continue;const le=J.buffer,ae=J.type,fe=J.bytesPerElement,ge=n.isWebGL2===!0&&(ae===t.INT||ae===t.UNSIGNED_INT||Z.gpuType===vN);if(Z.isInterleavedBufferAttribute){const ve=Z.data,Y=ve.stride,ce=Z.offset;if(ve.isInstancedInterleavedBuffer){for(let de=0;de<G.locationSize;de++)S(G.location+de,ve.meshPerAttribute);N.isInstancedMesh!==!0&&X._maxInstanceCount===void 0&&(X._maxInstanceCount=ve.meshPerAttribute*ve.count)}else for(let de=0;de<G.locationSize;de++)b(G.location+de);t.bindBuffer(t.ARRAY_BUFFER,le);for(let de=0;de<G.locationSize;de++)E(G.location+de,re/G.locationSize,ae,K,Y*fe,(ce+re/G.locationSize*de)*fe,ge)}else{if(Z.isInstancedBufferAttribute){for(let ve=0;ve<G.locationSize;ve++)S(G.location+ve,Z.meshPerAttribute);N.isInstancedMesh!==!0&&X._maxInstanceCount===void 0&&(X._maxInstanceCount=Z.meshPerAttribute*Z.count)}else for(let ve=0;ve<G.locationSize;ve++)b(G.location+ve);t.bindBuffer(t.ARRAY_BUFFER,le);for(let ve=0;ve<G.locationSize;ve++)E(G.location+ve,re/G.locationSize,ae,K,re*fe,re/G.locationSize*ve*fe,ge)}}else if(z!==void 0){const K=z[k];if(K!==void 0)switch(K.length){case 2:t.vertexAttrib2fv(G.location,K);break;case 3:t.vertexAttrib3fv(G.location,K);break;case 4:t.vertexAttrib4fv(G.location,K);break;default:t.vertexAttrib1fv(G.location,K)}}}}A()}function T(){U();for(const N in a){const W=a[N];for(const Q in W){const X=W[Q];for(const B in X)p(X[B].object),delete X[B];delete W[Q]}delete a[N]}}function P(N){if(a[N.id]===void 0)return;const W=a[N.id];for(const Q in W){const X=W[Q];for(const B in X)p(X[B].object),delete X[B];delete W[Q]}delete a[N.id]}function R(N){for(const W in a){const Q=a[W];if(Q[N.id]===void 0)continue;const X=Q[N.id];for(const B in X)p(X[B].object),delete X[B];delete Q[N.id]}}function U(){F(),h=!0,c!==l&&(c=l,f(c.object))}function F(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:u,reset:U,resetDefaultState:F,dispose:T,releaseStatesOfGeometry:P,releaseStatesOfProgram:R,initAttributes:x,enableAttribute:b,disableUnusedAttributes:A}}function dde(t,e,i,n){const r=n.isWebGL2;let s;function o(c){s=c}function a(c,h){t.drawArrays(s,c,h),i.update(h,s,1)}function l(c,h,u){if(u===0)return;let d,f;if(r)d=t,f="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[f](s,c,h,u),i.update(h,s,u)}this.setMode=o,this.render=a,this.renderInstances=l}function fde(t,e,i){let n;function r(){if(n!==void 0)return n;if(e.has("EXT_texture_filter_anisotropic")===!0){const E=e.get("EXT_texture_filter_anisotropic");n=t.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n}function s(E){if(E==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";E="mediump"}return E==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&t.constructor.name==="WebGL2RenderingContext";let a=i.precision!==void 0?i.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),h=i.logarithmicDepthBuffer===!0,u=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),d=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f=t.getParameter(t.MAX_TEXTURE_SIZE),p=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),m=t.getParameter(t.MAX_VERTEX_ATTRIBS),v=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),g=t.getParameter(t.MAX_VARYING_VECTORS),y=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),x=d>0,b=o||e.has("OES_texture_float"),S=x&&b,A=o?t.getParameter(t.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:h,maxTextures:u,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:m,maxVertexUniforms:v,maxVaryings:g,maxFragmentUniforms:y,vertexTextures:x,floatFragmentTextures:b,floatVertexTextures:S,maxSamples:A}}function pde(t){const e=this;let i=null,n=0,r=!1,s=!1;const o=new ed,a=new ci,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(u,d){const f=u.length!==0||d||n!==0||r;return r=d,n=u.length,f},this.beginShadows=function(){s=!0,h(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(u,d){i=h(u,d,0)},this.setState=function(u,d,f){const p=u.clippingPlanes,m=u.clipIntersection,v=u.clipShadows,g=t.get(u);if(!r||p===null||p.length===0||s&&!v)s?h(null):c();else{const y=s?0:n,x=y*4;let b=g.clippingState||null;l.value=b,b=h(p,d,x,f);for(let S=0;S!==x;++S)b[S]=i[S];g.clippingState=b,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=y}};function c(){l.value!==i&&(l.value=i,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function h(u,d,f,p){const m=u!==null?u.length:0;let v=null;if(m!==0){if(v=l.value,p!==!0||v===null){const g=f+m*4,y=d.matrixWorldInverse;a.getNormalMatrix(y),(v===null||v.length<g)&&(v=new Float32Array(g));for(let x=0,b=f;x!==m;++x,b+=4)o.copy(u[x]).applyMatrix4(y,a),o.normal.toArray(v,b),v[b+3]=o.constant}l.value=v,l.needsUpdate=!0}return e.numPlanes=m,e.numIntersection=0,v}}function mde(t){let e=new WeakMap;function i(o,a){return a===g_?o.mapping=Xd:a===v_&&(o.mapping=qd),o}function n(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){const a=o.mapping;if(a===g_||a===v_)if(e.has(o)){const l=e.get(o).texture;return i(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const c=new LN(l.height/2);return c.fromEquirectangularTexture(t,o),e.set(o,c),o.addEventListener("dispose",r),i(c.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}class Bl extends dw{constructor(e=-1,i=1,n=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=i,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,i,n,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,o=n+e,a=r+i,l=r-i;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=h*this.view.offsetY,l=a-h*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}}const dv=4,qH=[.125,.215,.35,.446,.526,.582],op=20,gD=new Bl,YH=new ht;let vD=null;const Jf=(1+Math.sqrt(5))/2,rg=1/Jf,QH=[new te(1,1,1),new te(-1,1,1),new te(1,1,-1),new te(-1,1,-1),new te(0,Jf,rg),new te(0,Jf,-rg),new te(rg,0,Jf),new te(-rg,0,Jf),new te(Jf,rg,0),new te(-Jf,rg,0)];class NL{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,i=0,n=.1,r=100){vD=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s),i>0&&this._blur(s,0,0,i),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,i=null){return this._fromTexture(e,i)}fromCubemap(e,i=null){return this._fromTexture(e,i)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=ZH(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=JH(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(vD),e.scissorTest=!1,yS(e,0,0,e.width,e.height)}_fromTexture(e,i){e.mapping===Xd||e.mapping===qd?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),vD=this._renderer.getRenderTarget();const n=i||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),i=4*this._cubeSize,n={magFilter:xn,minFilter:xn,generateMipmaps:!1,type:f0,format:no,colorSpace:zl,depthBuffer:!1},r=KH(e,i,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==i){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=KH(e,i,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=gde(s)),this._blurMaterial=vde(s,e,i)}return r}_compileMaterial(e){const i=new Ur(this._lodPlanes[0],e);this._renderer.compile(i,gD)}_sceneToCubeUV(e,i,n,r){const a=new fn(90,1,i,n),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],h=this._renderer,u=h.autoClear,d=h.toneMapping;h.getClearColor(YH),h.toneMapping=Ll,h.autoClear=!1;const f=new jo({name:"PMREM.Background",side:Vs,depthWrite:!1,depthTest:!1}),p=new Ur(new pm,f);let m=!1;const v=e.background;v?v.isColor&&(f.color.copy(v),e.background=null,m=!0):(f.color.copy(YH),m=!0);for(let g=0;g<6;g++){const y=g%3;y===0?(a.up.set(0,l[g],0),a.lookAt(c[g],0,0)):y===1?(a.up.set(0,0,l[g]),a.lookAt(0,c[g],0)):(a.up.set(0,l[g],0),a.lookAt(0,0,c[g]));const x=this._cubeSize;yS(r,y*x,g>2?x:0,x,x),h.setRenderTarget(r),m&&h.render(p,a),h.render(e,a)}p.geometry.dispose(),p.material.dispose(),h.toneMapping=d,h.autoClear=u,e.background=v}_textureToCubeUV(e,i){const n=this._renderer,r=e.mapping===Xd||e.mapping===qd;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=ZH()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=JH());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Ur(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;yS(i,0,0,3*l,2*l),n.setRenderTarget(i),n.render(o,gD)}_applyPMREM(e){const i=this._renderer,n=i.autoClear;i.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=QH[(r-1)%QH.length];this._blur(e,r-1,r,s,o)}i.autoClear=n}_blur(e,i,n,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,i,n,r,"latitudinal",s),this._halfBlur(o,e,n,n,r,"longitudinal",s)}_halfBlur(e,i,n,r,s,o,a){const l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const h=3,u=new Ur(this._lodPlanes[r],c),d=c.uniforms,f=this._sizeLods[n]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/(2*op-1),m=s/p,v=isFinite(s)?1+Math.floor(h*m):op;v>op&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${v} samples when the maximum is set to ${op}`);const g=[];let y=0;for(let E=0;E<op;++E){const M=E/m,T=Math.exp(-M*M/2);g.push(T),E===0?y+=T:E<v&&(y+=2*T)}for(let E=0;E<g.length;E++)g[E]=g[E]/y;d.envMap.value=e.texture,d.samples.value=v,d.weights.value=g,d.latitudinal.value=o==="latitudinal",a&&(d.poleAxis.value=a);const{_lodMax:x}=this;d.dTheta.value=p,d.mipInt.value=x-n;const b=this._sizeLods[r],S=3*b*(r>x-dv?r-x+dv:0),A=4*(this._cubeSize-b);yS(i,S,A,3*b,2*b),l.setRenderTarget(i),l.render(u,gD)}}function gde(t){const e=[],i=[],n=[];let r=t;const s=t-dv+1+qH.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);i.push(a);let l=1/a;o>t-dv?l=qH[o-t+dv-1]:o===0&&(l=0),n.push(l);const c=1/(a-2),h=-c,u=1+c,d=[h,h,u,h,u,u,h,h,u,u,h,u],f=6,p=6,m=3,v=2,g=1,y=new Float32Array(m*p*f),x=new Float32Array(v*p*f),b=new Float32Array(g*p*f);for(let A=0;A<f;A++){const E=A%3*2/3-1,M=A>2?0:-1,T=[E,M,0,E+2/3,M,0,E+2/3,M+1,0,E,M,0,E+2/3,M+1,0,E,M+1,0];y.set(T,m*p*A),x.set(d,v*p*A);const P=[A,A,A,A,A,A];b.set(P,g*p*A)}const S=new si;S.setAttribute("position",new Ri(y,m)),S.setAttribute("uv",new Ri(x,v)),S.setAttribute("faceIndex",new Ri(b,g)),e.push(S),r>dv&&r--}return{lodPlanes:e,sizeLods:i,sigmas:n}}function KH(t,e,i){const n=new Gl(t,e,i);return n.texture.mapping=ey,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function yS(t,e,i,n,r){t.viewport.set(e,i,n,r),t.scissor.set(e,i,n,r)}function vde(t,e,i){const n=new Float32Array(op),r=new te(0,1,0);return new Xc({name:"SphericalGaussianBlur",defines:{n:op,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:BN(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:$u,depthTest:!1,depthWrite:!1})}function JH(){return new Xc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:BN(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:$u,depthTest:!1,depthWrite:!1})}function ZH(){return new Xc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:BN(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:$u,depthTest:!1,depthWrite:!1})}function BN(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function yde(t){let e=new WeakMap,i=null;function n(a){if(a&&a.isTexture){const l=a.mapping,c=l===g_||l===v_,h=l===Xd||l===qd;if(c||h)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let u=e.get(a);return i===null&&(i=new NL(t)),u=c?i.fromEquirectangular(a,u):i.fromCubemap(a,u),e.set(a,u),u.texture}else{if(e.has(a))return e.get(a).texture;{const u=a.image;if(c&&u&&u.height>0||h&&u&&r(u)){i===null&&(i=new NL(t));const d=c?i.fromEquirectangular(a):i.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}else return null}}}return a}function r(a){let l=0;const c=6;for(let h=0;h<c;h++)a[h]!==void 0&&l++;return l===c}function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,i!==null&&(i.dispose(),i=null)}return{get:n,dispose:o}}function xde(t){const e={};function i(n){if(e[n]!==void 0)return e[n];let r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(n)}return e[n]=r,r}return{has:function(n){return i(n)!==null},init:function(n){n.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(n){const r=i(n);return r===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function _de(t,e,i,n){const r={},s=new WeakMap;function o(u){const d=u.target;d.index!==null&&e.remove(d.index);for(const p in d.attributes)e.remove(d.attributes[p]);for(const p in d.morphAttributes){const m=d.morphAttributes[p];for(let v=0,g=m.length;v<g;v++)e.remove(m[v])}d.removeEventListener("dispose",o),delete r[d.id];const f=s.get(d);f&&(e.remove(f),s.delete(d)),n.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,i.memory.geometries--}function a(u,d){return r[d.id]===!0||(d.addEventListener("dispose",o),r[d.id]=!0,i.memory.geometries++),d}function l(u){const d=u.attributes;for(const p in d)e.update(d[p],t.ARRAY_BUFFER);const f=u.morphAttributes;for(const p in f){const m=f[p];for(let v=0,g=m.length;v<g;v++)e.update(m[v],t.ARRAY_BUFFER)}}function c(u){const d=[],f=u.index,p=u.attributes.position;let m=0;if(f!==null){const y=f.array;m=f.version;for(let x=0,b=y.length;x<b;x+=3){const S=y[x+0],A=y[x+1],E=y[x+2];d.push(S,A,A,E,E,S)}}else{const y=p.array;m=p.version;for(let x=0,b=y.length/3-1;x<b;x+=3){const S=x+0,A=x+1,E=x+2;d.push(S,A,A,E,E,S)}}const v=new(QQ(d)?RN:DN)(d,1);v.version=m;const g=s.get(u);g&&e.remove(g),s.set(u,v)}function h(u){const d=s.get(u);if(d){const f=u.index;f!==null&&d.version<f.version&&c(u)}else c(u);return s.get(u)}return{get:a,update:l,getWireframeAttribute:h}}function wde(t,e,i,n){const r=n.isWebGL2;let s;function o(d){s=d}let a,l;function c(d){a=d.type,l=d.bytesPerElement}function h(d,f){t.drawElements(s,f,a,d*l),i.update(f,s,1)}function u(d,f,p){if(p===0)return;let m,v;if(r)m=t,v="drawElementsInstanced";else if(m=e.get("ANGLE_instanced_arrays"),v="drawElementsInstancedANGLE",m===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[v](s,f,a,d*l,p),i.update(f,s,p)}this.setMode=o,this.setIndex=c,this.render=h,this.renderInstances=u}function bde(t){const e={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,o,a){switch(i.calls++,o){case t.TRIANGLES:i.triangles+=a*(s/3);break;case t.LINES:i.lines+=a*(s/2);break;case t.LINE_STRIP:i.lines+=a*(s-1);break;case t.LINE_LOOP:i.lines+=a*s;break;case t.POINTS:i.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:e,render:i,programs:null,autoReset:!0,reset:r,update:n}}function Sde(t,e){return t[0]-e[0]}function Ade(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Mde(t,e,i){const n={},r=new Float32Array(8),s=new WeakMap,o=new zi,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(c,h,u){const d=c.morphTargetInfluences;if(e.isWebGL2===!0){const p=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,m=p!==void 0?p.length:0;let v=s.get(h);if(v===void 0||v.count!==m){let W=function(){F.dispose(),s.delete(h),h.removeEventListener("dispose",W)};var f=W;v!==void 0&&v.texture.dispose();const x=h.morphAttributes.position!==void 0,b=h.morphAttributes.normal!==void 0,S=h.morphAttributes.color!==void 0,A=h.morphAttributes.position||[],E=h.morphAttributes.normal||[],M=h.morphAttributes.color||[];let T=0;x===!0&&(T=1),b===!0&&(T=2),S===!0&&(T=3);let P=h.attributes.position.count*T,R=1;P>e.maxTextureSize&&(R=Math.ceil(P/e.maxTextureSize),P=e.maxTextureSize);const U=new Float32Array(P*R*4*m),F=new dC(U,P,R,m);F.type=Dc,F.needsUpdate=!0;const N=T*4;for(let Q=0;Q<m;Q++){const X=A[Q],B=E[Q],j=M[Q],z=P*R*4*Q;for(let k=0;k<X.count;k++){const G=k*N;x===!0&&(o.fromBufferAttribute(X,k),U[z+G+0]=o.x,U[z+G+1]=o.y,U[z+G+2]=o.z,U[z+G+3]=0),b===!0&&(o.fromBufferAttribute(B,k),U[z+G+4]=o.x,U[z+G+5]=o.y,U[z+G+6]=o.z,U[z+G+7]=0),S===!0&&(o.fromBufferAttribute(j,k),U[z+G+8]=o.x,U[z+G+9]=o.y,U[z+G+10]=o.z,U[z+G+11]=j.itemSize===4?o.w:1)}}v={count:m,texture:F,size:new Qe(P,R)},s.set(h,v),h.addEventListener("dispose",W)}let g=0;for(let x=0;x<d.length;x++)g+=d[x];const y=h.morphTargetsRelative?1:1-g;u.getUniforms().setValue(t,"morphTargetBaseInfluence",y),u.getUniforms().setValue(t,"morphTargetInfluences",d),u.getUniforms().setValue(t,"morphTargetsTexture",v.texture,i),u.getUniforms().setValue(t,"morphTargetsTextureSize",v.size)}else{const p=d===void 0?0:d.length;let m=n[h.id];if(m===void 0||m.length!==p){m=[];for(let b=0;b<p;b++)m[b]=[b,0];n[h.id]=m}for(let b=0;b<p;b++){const S=m[b];S[0]=b,S[1]=d[b]}m.sort(Ade);for(let b=0;b<8;b++)b<p&&m[b][1]?(a[b][0]=m[b][0],a[b][1]=m[b][1]):(a[b][0]=Number.MAX_SAFE_INTEGER,a[b][1]=0);a.sort(Sde);const v=h.morphAttributes.position,g=h.morphAttributes.normal;let y=0;for(let b=0;b<8;b++){const S=a[b],A=S[0],E=S[1];A!==Number.MAX_SAFE_INTEGER&&E?(v&&h.getAttribute("morphTarget"+b)!==v[A]&&h.setAttribute("morphTarget"+b,v[A]),g&&h.getAttribute("morphNormal"+b)!==g[A]&&h.setAttribute("morphNormal"+b,g[A]),r[b]=E,y+=E):(v&&h.hasAttribute("morphTarget"+b)===!0&&h.deleteAttribute("morphTarget"+b),g&&h.hasAttribute("morphNormal"+b)===!0&&h.deleteAttribute("morphNormal"+b),r[b]=0)}const x=h.morphTargetsRelative?1:1-y;u.getUniforms().setValue(t,"morphTargetBaseInfluence",x),u.getUniforms().setValue(t,"morphTargetInfluences",r)}}return{update:l}}function Ede(t,e,i,n){let r=new WeakMap;function s(l){const c=n.render.frame,h=l.geometry,u=e.get(l,h);if(r.get(u)!==c&&(e.update(u),r.set(u,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),r.get(l)!==c&&(i.update(l.instanceMatrix,t.ARRAY_BUFFER),l.instanceColor!==null&&i.update(l.instanceColor,t.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){const d=l.skeleton;r.get(d)!==c&&(d.update(),r.set(d,c))}return u}function o(){r=new WeakMap}function a(l){const c=l.target;c.removeEventListener("dispose",a),i.remove(c.instanceMatrix),c.instanceColor!==null&&i.remove(c.instanceColor)}return{update:s,dispose:o}}const eK=new pn,tK=new dC,iK=new PN,nK=new fw,$H=[],e5=[],t5=new Float32Array(16),i5=new Float32Array(9),n5=new Float32Array(4);function iy(t,e,i){const n=t[0];if(n<=0||n>0)return t;const r=e*i;let s=$H[r];if(s===void 0&&(s=new Float32Array(r),$H[r]=s),e!==0){n.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=i,t[o].toArray(s,a)}return s}function Sr(t,e){if(t.length!==e.length)return!1;for(let i=0,n=t.length;i<n;i++)if(t[i]!==e[i])return!1;return!0}function Ar(t,e){for(let i=0,n=e.length;i<n;i++)t[i]=e[i]}function pC(t,e){let i=e5[e];i===void 0&&(i=new Int32Array(e),e5[e]=i);for(let n=0;n!==e;++n)i[n]=t.allocateTextureUnit();return i}function Tde(t,e){const i=this.cache;i[0]!==e&&(t.uniform1f(this.addr,e),i[0]=e)}function Cde(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(Sr(i,e))return;t.uniform2fv(this.addr,e),Ar(i,e)}}function Pde(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else if(e.r!==void 0)(i[0]!==e.r||i[1]!==e.g||i[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b);else{if(Sr(i,e))return;t.uniform3fv(this.addr,e),Ar(i,e)}}function Dde(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(Sr(i,e))return;t.uniform4fv(this.addr,e),Ar(i,e)}}function Rde(t,e){const i=this.cache,n=e.elements;if(n===void 0){if(Sr(i,e))return;t.uniformMatrix2fv(this.addr,!1,e),Ar(i,e)}else{if(Sr(i,n))return;n5.set(n),t.uniformMatrix2fv(this.addr,!1,n5),Ar(i,n)}}function Ide(t,e){const i=this.cache,n=e.elements;if(n===void 0){if(Sr(i,e))return;t.uniformMatrix3fv(this.addr,!1,e),Ar(i,e)}else{if(Sr(i,n))return;i5.set(n),t.uniformMatrix3fv(this.addr,!1,i5),Ar(i,n)}}function Lde(t,e){const i=this.cache,n=e.elements;if(n===void 0){if(Sr(i,e))return;t.uniformMatrix4fv(this.addr,!1,e),Ar(i,e)}else{if(Sr(i,n))return;t5.set(n),t.uniformMatrix4fv(this.addr,!1,t5),Ar(i,n)}}function Bde(t,e){const i=this.cache;i[0]!==e&&(t.uniform1i(this.addr,e),i[0]=e)}function Ode(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(Sr(i,e))return;t.uniform2iv(this.addr,e),Ar(i,e)}}function Fde(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(Sr(i,e))return;t.uniform3iv(this.addr,e),Ar(i,e)}}function Nde(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(Sr(i,e))return;t.uniform4iv(this.addr,e),Ar(i,e)}}function Ude(t,e){const i=this.cache;i[0]!==e&&(t.uniform1ui(this.addr,e),i[0]=e)}function kde(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(Sr(i,e))return;t.uniform2uiv(this.addr,e),Ar(i,e)}}function zde(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(Sr(i,e))return;t.uniform3uiv(this.addr,e),Ar(i,e)}}function Gde(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(Sr(i,e))return;t.uniform4uiv(this.addr,e),Ar(i,e)}}function Hde(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture2D(e||eK,r)}function Vde(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture3D(e||iK,r)}function jde(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTextureCube(e||nK,r)}function Wde(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture2DArray(e||tK,r)}function Xde(t){switch(t){case 5126:return Tde;case 35664:return Cde;case 35665:return Pde;case 35666:return Dde;case 35674:return Rde;case 35675:return Ide;case 35676:return Lde;case 5124:case 35670:return Bde;case 35667:case 35671:return Ode;case 35668:case 35672:return Fde;case 35669:case 35673:return Nde;case 5125:return Ude;case 36294:return kde;case 36295:return zde;case 36296:return Gde;case 35678:case 36198:case 36298:case 36306:case 35682:return Hde;case 35679:case 36299:case 36307:return Vde;case 35680:case 36300:case 36308:case 36293:return jde;case 36289:case 36303:case 36311:case 36292:return Wde}}function qde(t,e){t.uniform1fv(this.addr,e)}function Yde(t,e){const i=iy(e,this.size,2);t.uniform2fv(this.addr,i)}function Qde(t,e){const i=iy(e,this.size,3);t.uniform3fv(this.addr,i)}function Kde(t,e){const i=iy(e,this.size,4);t.uniform4fv(this.addr,i)}function Jde(t,e){const i=iy(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,i)}function Zde(t,e){const i=iy(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,i)}function $de(t,e){const i=iy(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,i)}function efe(t,e){t.uniform1iv(this.addr,e)}function tfe(t,e){t.uniform2iv(this.addr,e)}function ife(t,e){t.uniform3iv(this.addr,e)}function nfe(t,e){t.uniform4iv(this.addr,e)}function rfe(t,e){t.uniform1uiv(this.addr,e)}function sfe(t,e){t.uniform2uiv(this.addr,e)}function ofe(t,e){t.uniform3uiv(this.addr,e)}function afe(t,e){t.uniform4uiv(this.addr,e)}function lfe(t,e,i){const n=this.cache,r=e.length,s=pC(i,r);Sr(n,s)||(t.uniform1iv(this.addr,s),Ar(n,s));for(let o=0;o!==r;++o)i.setTexture2D(e[o]||eK,s[o])}function cfe(t,e,i){const n=this.cache,r=e.length,s=pC(i,r);Sr(n,s)||(t.uniform1iv(this.addr,s),Ar(n,s));for(let o=0;o!==r;++o)i.setTexture3D(e[o]||iK,s[o])}function ufe(t,e,i){const n=this.cache,r=e.length,s=pC(i,r);Sr(n,s)||(t.uniform1iv(this.addr,s),Ar(n,s));for(let o=0;o!==r;++o)i.setTextureCube(e[o]||nK,s[o])}function hfe(t,e,i){const n=this.cache,r=e.length,s=pC(i,r);Sr(n,s)||(t.uniform1iv(this.addr,s),Ar(n,s));for(let o=0;o!==r;++o)i.setTexture2DArray(e[o]||tK,s[o])}function dfe(t){switch(t){case 5126:return qde;case 35664:return Yde;case 35665:return Qde;case 35666:return Kde;case 35674:return Jde;case 35675:return Zde;case 35676:return $de;case 5124:case 35670:return efe;case 35667:case 35671:return tfe;case 35668:case 35672:return ife;case 35669:case 35673:return nfe;case 5125:return rfe;case 36294:return sfe;case 36295:return ofe;case 36296:return afe;case 35678:case 36198:case 36298:case 36306:case 35682:return lfe;case 35679:case 36299:case 36307:return cfe;case 35680:case 36300:case 36308:case 36293:return ufe;case 36289:case 36303:case 36311:case 36292:return hfe}}class ffe{constructor(e,i,n){this.id=e,this.addr=n,this.cache=[],this.setValue=Xde(i.type)}}class pfe{constructor(e,i,n){this.id=e,this.addr=n,this.cache=[],this.size=i.size,this.setValue=dfe(i.type)}}class mfe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,i,n){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,i[a.id],n)}}}const yD=/(\w+)(\])?(\[|\.)?/g;function r5(t,e){t.seq.push(e),t.map[e.id]=e}function gfe(t,e,i){const n=t.name,r=n.length;for(yD.lastIndex=0;;){const s=yD.exec(n),o=yD.lastIndex;let a=s[1];const l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===r){r5(i,c===void 0?new ffe(a,t,e):new pfe(a,t,e));break}else{let u=i.map[a];u===void 0&&(u=new mfe(a),r5(i,u)),i=u}}}class RM{constructor(e,i){this.seq=[],this.map={};const n=e.getProgramParameter(i,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const s=e.getActiveUniform(i,r),o=e.getUniformLocation(i,s.name);gfe(s,o,this)}}setValue(e,i,n,r){const s=this.map[i];s!==void 0&&s.setValue(e,n,r)}setOptional(e,i,n){const r=i[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,i,n,r){for(let s=0,o=i.length;s!==o;++s){const a=i[s],l=n[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,i){const n=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in i&&n.push(o)}return n}}function s5(t,e,i){const n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),n}let vfe=0;function yfe(t,e){const i=t.split(`
`),n=[],r=Math.max(e-6,0),s=Math.min(e+6,i.length);for(let o=r;o<s;o++){const a=o+1;n.push(`${a===e?">":" "} ${a}: ${i[o]}`)}return n.join(`
`)}function xfe(t){switch(t){case zl:return["Linear","( value )"];case ni:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",t),["Linear","( value )"]}}function o5(t,e,i){const n=t.getShaderParameter(e,t.COMPILE_STATUS),r=t.getShaderInfoLog(e).trim();if(n&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return i.toUpperCase()+`

`+r+`

`+yfe(t.getShaderSource(e),o)}else return r}function _fe(t,e){const i=xfe(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function wfe(t,e){let i;switch(e){case yQ:i="Linear";break;case xQ:i="Reinhard";break;case _Q:i="OptimizedCineon";break;case gN:i="ACESFilmic";break;case wQ:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),i="Linear"}return"vec3 "+t+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function bfe(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.normalMapTangentSpace||t.clearcoatNormalMap||t.flatShading||t.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter($x).join(`
`)}function Sfe(t){const e=[];for(const i in t){const n=t[i];n!==!1&&e.push("#define "+i+" "+n)}return e.join(`
`)}function Afe(t,e){const i={},n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const s=t.getActiveAttrib(e,r),o=s.name;let a=1;s.type===t.FLOAT_MAT2&&(a=2),s.type===t.FLOAT_MAT3&&(a=3),s.type===t.FLOAT_MAT4&&(a=4),i[o]={type:s.type,location:t.getAttribLocation(e,o),locationSize:a}}return i}function $x(t){return t!==""}function a5(t,e){const i=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function l5(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Mfe=/^[ \t]*#include +<([\w\d./]+)>/gm;function UL(t){return t.replace(Mfe,Tfe)}const Efe=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Tfe(t,e){let i=oi[e];if(i===void 0){const n=Efe.get(e);if(n!==void 0)i=oi[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return UL(i)}const Cfe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function c5(t){return t.replace(Cfe,Pfe)}function Pfe(t,e,i,n){let r="";for(let s=parseInt(e);s<parseInt(i);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function u5(t){let e="precision "+t.precision+` float;
precision `+t.precision+" int;";return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Dfe(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===aC?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===S1?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===wl&&(e="SHADOWMAP_TYPE_VSM"),e}function Rfe(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case Xd:case qd:e="ENVMAP_TYPE_CUBE";break;case ey:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Ife(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case qd:e="ENVMAP_MODE_REFRACTION";break}return e}function Lfe(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case uw:e="ENVMAP_BLENDING_MULTIPLY";break;case gQ:e="ENVMAP_BLENDING_MIX";break;case vQ:e="ENVMAP_BLENDING_ADD";break}return e}function Bfe(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const i=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,i),7*16)),texelHeight:n,maxMip:i}}function Ofe(t,e,i,n){const r=t.getContext(),s=i.defines;let o=i.vertexShader,a=i.fragmentShader;const l=Dfe(i),c=Rfe(i),h=Ife(i),u=Lfe(i),d=Bfe(i),f=i.isWebGL2?"":bfe(i),p=Sfe(s),m=r.createProgram();let v,g,y=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(v=["#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,p].filter($x).join(`
`),v.length>0&&(v+=`
`),g=[f,"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,p].filter($x).join(`
`),g.length>0&&(g+=`
`)):(v=[u5(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,p,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+h:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.displacementMap?"#define USE_DISPLACEMENTMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.mapUv?"#define MAP_UV "+i.mapUv:"",i.alphaMapUv?"#define ALPHAMAP_UV "+i.alphaMapUv:"",i.lightMapUv?"#define LIGHTMAP_UV "+i.lightMapUv:"",i.aoMapUv?"#define AOMAP_UV "+i.aoMapUv:"",i.emissiveMapUv?"#define EMISSIVEMAP_UV "+i.emissiveMapUv:"",i.bumpMapUv?"#define BUMPMAP_UV "+i.bumpMapUv:"",i.normalMapUv?"#define NORMALMAP_UV "+i.normalMapUv:"",i.displacementMapUv?"#define DISPLACEMENTMAP_UV "+i.displacementMapUv:"",i.metalnessMapUv?"#define METALNESSMAP_UV "+i.metalnessMapUv:"",i.roughnessMapUv?"#define ROUGHNESSMAP_UV "+i.roughnessMapUv:"",i.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+i.anisotropyMapUv:"",i.clearcoatMapUv?"#define CLEARCOATMAP_UV "+i.clearcoatMapUv:"",i.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+i.clearcoatNormalMapUv:"",i.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+i.clearcoatRoughnessMapUv:"",i.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+i.iridescenceMapUv:"",i.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+i.iridescenceThicknessMapUv:"",i.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+i.sheenColorMapUv:"",i.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+i.sheenRoughnessMapUv:"",i.specularMapUv?"#define SPECULARMAP_UV "+i.specularMapUv:"",i.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+i.specularColorMapUv:"",i.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+i.specularIntensityMapUv:"",i.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+i.transmissionMapUv:"",i.thicknessMapUv?"#define THICKNESSMAP_UV "+i.thicknessMapUv:"",i.vertexTangents&&i.flatShading===!1?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.morphColors&&i.isWebGL2?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter($x).join(`
`),g=[f,u5(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,p,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+c:"",i.envMap?"#define "+h:"",i.envMap?"#define "+u:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.vertexTangents&&i.flatShading===!1?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==Ll?"#define TONE_MAPPING":"",i.toneMapping!==Ll?oi.tonemapping_pars_fragment:"",i.toneMapping!==Ll?wfe("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",oi.colorspace_pars_fragment,_fe("linearToOutputTexel",i.outputColorSpace),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter($x).join(`
`)),o=UL(o),o=a5(o,i),o=l5(o,i),a=UL(a),a=a5(a,i),a=l5(a,i),o=c5(o),a=c5(a),i.isWebGL2&&i.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,v=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+v,g=["#define varying in",i.glslVersion===OL?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===OL?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+g);const x=y+v+o,b=y+g+a,S=s5(r,r.VERTEX_SHADER,x),A=s5(r,r.FRAGMENT_SHADER,b);if(r.attachShader(m,S),r.attachShader(m,A),i.index0AttributeName!==void 0?r.bindAttribLocation(m,0,i.index0AttributeName):i.morphTargets===!0&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),t.debug.checkShaderErrors){const T=r.getProgramInfoLog(m).trim(),P=r.getShaderInfoLog(S).trim(),R=r.getShaderInfoLog(A).trim();let U=!0,F=!0;if(r.getProgramParameter(m,r.LINK_STATUS)===!1)if(U=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(r,m,S,A);else{const N=o5(r,S,"vertex"),W=o5(r,A,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(m,r.VALIDATE_STATUS)+`

Program Info Log: `+T+`
`+N+`
`+W)}else T!==""?console.warn("THREE.WebGLProgram: Program Info Log:",T):(P===""||R==="")&&(F=!1);F&&(this.diagnostics={runnable:U,programLog:T,vertexShader:{log:P,prefix:v},fragmentShader:{log:R,prefix:g}})}r.deleteShader(S),r.deleteShader(A);let E;this.getUniforms=function(){return E===void 0&&(E=new RM(r,m)),E};let M;return this.getAttributes=function(){return M===void 0&&(M=Afe(r,m)),M},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.type=i.shaderType,this.name=i.shaderName,this.id=vfe++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=S,this.fragmentShader=A,this}let Ffe=0;class Nfe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(i),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const i=this.materialCache.get(e);for(const n of i)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const i=this.materialCache;let n=i.get(e);return n===void 0&&(n=new Set,i.set(e,n)),n}_getShaderStage(e){const i=this.shaderCache;let n=i.get(e);return n===void 0&&(n=new Ufe(e),i.set(e,n)),n}}class Ufe{constructor(e){this.id=Ffe++,this.code=e,this.usedTimes=0}}function kfe(t,e,i,n,r,s,o){const a=new Lp,l=new Nfe,c=[],h=r.isWebGL2,u=r.logarithmicDepthBuffer,d=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(T){return T===0?"uv":`uv${T}`}function v(T,P,R,U,F){const N=U.fog,W=F.geometry,Q=T.isMeshStandardMaterial?U.environment:null,X=(T.isMeshStandardMaterial?i:e).get(T.envMap||Q),B=X&&X.mapping===ey?X.image.height:null,j=p[T.type];T.precision!==null&&(f=r.getMaxPrecision(T.precision),f!==T.precision&&console.warn("THREE.WebGLProgram.getParameters:",T.precision,"not supported, using",f,"instead."));const z=W.morphAttributes.position||W.morphAttributes.normal||W.morphAttributes.color,k=z!==void 0?z.length:0;let G=0;W.morphAttributes.position!==void 0&&(G=1),W.morphAttributes.normal!==void 0&&(G=2),W.morphAttributes.color!==void 0&&(G=3);let Z,K,re,J;if(j){const zn=Al[j];Z=zn.vertexShader,K=zn.fragmentShader}else Z=T.vertexShader,K=T.fragmentShader,l.update(T),re=l.getVertexShaderID(T),J=l.getFragmentShaderID(T);const le=t.getRenderTarget(),ae=F.isInstancedMesh===!0,fe=!!T.map,ge=!!T.matcap,ve=!!X,Y=!!T.aoMap,ce=!!T.lightMap,de=!!T.bumpMap,xe=!!T.normalMap,Ce=!!T.displacementMap,Ne=!!T.emissiveMap,Ie=!!T.metalnessMap,Ge=!!T.roughnessMap,tt=T.anisotropy>0,at=T.clearcoat>0,ee=T.iridescence>0,O=T.sheen>0,V=T.transmission>0,ue=tt&&!!T.anisotropyMap,Ee=at&&!!T.clearcoatMap,Te=at&&!!T.clearcoatNormalMap,We=at&&!!T.clearcoatRoughnessMap,Ve=ee&&!!T.iridescenceMap,me=ee&&!!T.iridescenceThicknessMap,be=O&&!!T.sheenColorMap,ne=O&&!!T.sheenRoughnessMap,Ae=!!T.specularMap,ke=!!T.specularColorMap,Ue=!!T.specularIntensityMap,Je=V&&!!T.transmissionMap,ut=V&&!!T.thicknessMap,Pt=!!T.gradientMap,q=!!T.alphaMap,pe=T.alphaTest>0,oe=!!T.alphaHash,Be=!!T.extensions,qe=!!W.attributes.uv1,mt=!!W.attributes.uv2,qt=!!W.attributes.uv3;return{isWebGL2:h,shaderID:j,shaderType:T.type,shaderName:T.name,vertexShader:Z,fragmentShader:K,defines:T.defines,customVertexShaderID:re,customFragmentShaderID:J,isRawShaderMaterial:T.isRawShaderMaterial===!0,glslVersion:T.glslVersion,precision:f,instancing:ae,instancingColor:ae&&F.instanceColor!==null,supportsVertexTextures:d,outputColorSpace:le===null?t.outputColorSpace:le.isXRRenderTarget===!0?le.texture.colorSpace:zl,map:fe,matcap:ge,envMap:ve,envMapMode:ve&&X.mapping,envMapCubeUVHeight:B,aoMap:Y,lightMap:ce,bumpMap:de,normalMap:xe,displacementMap:d&&Ce,emissiveMap:Ne,normalMapObjectSpace:xe&&T.normalMapType===NQ,normalMapTangentSpace:xe&&T.normalMapType===lf,metalnessMap:Ie,roughnessMap:Ge,anisotropy:tt,anisotropyMap:ue,clearcoat:at,clearcoatMap:Ee,clearcoatNormalMap:Te,clearcoatRoughnessMap:We,iridescence:ee,iridescenceMap:Ve,iridescenceThicknessMap:me,sheen:O,sheenColorMap:be,sheenRoughnessMap:ne,specularMap:Ae,specularColorMap:ke,specularIntensityMap:Ue,transmission:V,transmissionMap:Je,thicknessMap:ut,gradientMap:Pt,opaque:T.transparent===!1&&T.blending===Rp,alphaMap:q,alphaTest:pe,alphaHash:oe,combine:T.combine,mapUv:fe&&m(T.map.channel),aoMapUv:Y&&m(T.aoMap.channel),lightMapUv:ce&&m(T.lightMap.channel),bumpMapUv:de&&m(T.bumpMap.channel),normalMapUv:xe&&m(T.normalMap.channel),displacementMapUv:Ce&&m(T.displacementMap.channel),emissiveMapUv:Ne&&m(T.emissiveMap.channel),metalnessMapUv:Ie&&m(T.metalnessMap.channel),roughnessMapUv:Ge&&m(T.roughnessMap.channel),anisotropyMapUv:ue&&m(T.anisotropyMap.channel),clearcoatMapUv:Ee&&m(T.clearcoatMap.channel),clearcoatNormalMapUv:Te&&m(T.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:We&&m(T.clearcoatRoughnessMap.channel),iridescenceMapUv:Ve&&m(T.iridescenceMap.channel),iridescenceThicknessMapUv:me&&m(T.iridescenceThicknessMap.channel),sheenColorMapUv:be&&m(T.sheenColorMap.channel),sheenRoughnessMapUv:ne&&m(T.sheenRoughnessMap.channel),specularMapUv:Ae&&m(T.specularMap.channel),specularColorMapUv:ke&&m(T.specularColorMap.channel),specularIntensityMapUv:Ue&&m(T.specularIntensityMap.channel),transmissionMapUv:Je&&m(T.transmissionMap.channel),thicknessMapUv:ut&&m(T.thicknessMap.channel),alphaMapUv:q&&m(T.alphaMap.channel),vertexTangents:!!W.attributes.tangent&&(xe||tt),vertexColors:T.vertexColors,vertexAlphas:T.vertexColors===!0&&!!W.attributes.color&&W.attributes.color.itemSize===4,vertexUv1s:qe,vertexUv2s:mt,vertexUv3s:qt,pointsUvs:F.isPoints===!0&&!!W.attributes.uv&&(fe||q),fog:!!N,useFog:T.fog===!0,fogExp2:N&&N.isFogExp2,flatShading:T.flatShading===!0,sizeAttenuation:T.sizeAttenuation===!0,logarithmicDepthBuffer:u,skinning:F.isSkinnedMesh===!0,morphTargets:W.morphAttributes.position!==void 0,morphNormals:W.morphAttributes.normal!==void 0,morphColors:W.morphAttributes.color!==void 0,morphTargetsCount:k,morphTextureStride:G,numDirLights:P.directional.length,numPointLights:P.point.length,numSpotLights:P.spot.length,numSpotLightMaps:P.spotLightMap.length,numRectAreaLights:P.rectArea.length,numHemiLights:P.hemi.length,numDirLightShadows:P.directionalShadowMap.length,numPointLightShadows:P.pointShadowMap.length,numSpotLightShadows:P.spotShadowMap.length,numSpotLightShadowsWithMaps:P.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:T.dithering,shadowMapEnabled:t.shadowMap.enabled&&R.length>0,shadowMapType:t.shadowMap.type,toneMapping:T.toneMapped?t.toneMapping:Ll,useLegacyLights:t.useLegacyLights,premultipliedAlpha:T.premultipliedAlpha,doubleSided:T.side===ka,flipSided:T.side===Vs,useDepthPacking:T.depthPacking>=0,depthPacking:T.depthPacking||0,index0AttributeName:T.index0AttributeName,extensionDerivatives:Be&&T.extensions.derivatives===!0,extensionFragDepth:Be&&T.extensions.fragDepth===!0,extensionDrawBuffers:Be&&T.extensions.drawBuffers===!0,extensionShaderTextureLOD:Be&&T.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:h||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||n.has("EXT_shader_texture_lod"),customProgramCacheKey:T.customProgramCacheKey()}}function g(T){const P=[];if(T.shaderID?P.push(T.shaderID):(P.push(T.customVertexShaderID),P.push(T.customFragmentShaderID)),T.defines!==void 0)for(const R in T.defines)P.push(R),P.push(T.defines[R]);return T.isRawShaderMaterial===!1&&(y(P,T),x(P,T),P.push(t.outputColorSpace)),P.push(T.customProgramCacheKey),P.join()}function y(T,P){T.push(P.precision),T.push(P.outputColorSpace),T.push(P.envMapMode),T.push(P.envMapCubeUVHeight),T.push(P.mapUv),T.push(P.alphaMapUv),T.push(P.lightMapUv),T.push(P.aoMapUv),T.push(P.bumpMapUv),T.push(P.normalMapUv),T.push(P.displacementMapUv),T.push(P.emissiveMapUv),T.push(P.metalnessMapUv),T.push(P.roughnessMapUv),T.push(P.anisotropyMapUv),T.push(P.clearcoatMapUv),T.push(P.clearcoatNormalMapUv),T.push(P.clearcoatRoughnessMapUv),T.push(P.iridescenceMapUv),T.push(P.iridescenceThicknessMapUv),T.push(P.sheenColorMapUv),T.push(P.sheenRoughnessMapUv),T.push(P.specularMapUv),T.push(P.specularColorMapUv),T.push(P.specularIntensityMapUv),T.push(P.transmissionMapUv),T.push(P.thicknessMapUv),T.push(P.combine),T.push(P.fogExp2),T.push(P.sizeAttenuation),T.push(P.morphTargetsCount),T.push(P.morphAttributeCount),T.push(P.numDirLights),T.push(P.numPointLights),T.push(P.numSpotLights),T.push(P.numSpotLightMaps),T.push(P.numHemiLights),T.push(P.numRectAreaLights),T.push(P.numDirLightShadows),T.push(P.numPointLightShadows),T.push(P.numSpotLightShadows),T.push(P.numSpotLightShadowsWithMaps),T.push(P.shadowMapType),T.push(P.toneMapping),T.push(P.numClippingPlanes),T.push(P.numClipIntersection),T.push(P.depthPacking)}function x(T,P){a.disableAll(),P.isWebGL2&&a.enable(0),P.supportsVertexTextures&&a.enable(1),P.instancing&&a.enable(2),P.instancingColor&&a.enable(3),P.matcap&&a.enable(4),P.envMap&&a.enable(5),P.normalMapObjectSpace&&a.enable(6),P.normalMapTangentSpace&&a.enable(7),P.clearcoat&&a.enable(8),P.iridescence&&a.enable(9),P.alphaTest&&a.enable(10),P.vertexColors&&a.enable(11),P.vertexAlphas&&a.enable(12),P.vertexUv1s&&a.enable(13),P.vertexUv2s&&a.enable(14),P.vertexUv3s&&a.enable(15),P.vertexTangents&&a.enable(16),P.anisotropy&&a.enable(17),T.push(a.mask),a.disableAll(),P.fog&&a.enable(0),P.useFog&&a.enable(1),P.flatShading&&a.enable(2),P.logarithmicDepthBuffer&&a.enable(3),P.skinning&&a.enable(4),P.morphTargets&&a.enable(5),P.morphNormals&&a.enable(6),P.morphColors&&a.enable(7),P.premultipliedAlpha&&a.enable(8),P.shadowMapEnabled&&a.enable(9),P.useLegacyLights&&a.enable(10),P.doubleSided&&a.enable(11),P.flipSided&&a.enable(12),P.useDepthPacking&&a.enable(13),P.dithering&&a.enable(14),P.transmission&&a.enable(15),P.sheen&&a.enable(16),P.opaque&&a.enable(17),P.pointsUvs&&a.enable(18),T.push(a.mask)}function b(T){const P=p[T.type];let R;if(P){const U=Al[P];R=ZQ.clone(U.uniforms)}else R=T.uniforms;return R}function S(T,P){let R;for(let U=0,F=c.length;U<F;U++){const N=c[U];if(N.cacheKey===P){R=N,++R.usedTimes;break}}return R===void 0&&(R=new Ofe(t,P,T,s),c.push(R)),R}function A(T){if(--T.usedTimes===0){const P=c.indexOf(T);c[P]=c[c.length-1],c.pop(),T.destroy()}}function E(T){l.remove(T)}function M(){l.dispose()}return{getParameters:v,getProgramCacheKey:g,getUniforms:b,acquireProgram:S,releaseProgram:A,releaseShaderCache:E,programs:c,dispose:M}}function zfe(){let t=new WeakMap;function e(s){let o=t.get(s);return o===void 0&&(o={},t.set(s,o)),o}function i(s){t.delete(s)}function n(s,o,a){t.get(s)[o]=a}function r(){t=new WeakMap}return{get:e,remove:i,update:n,dispose:r}}function Gfe(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function h5(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function d5(){const t=[];let e=0;const i=[],n=[],r=[];function s(){e=0,i.length=0,n.length=0,r.length=0}function o(u,d,f,p,m,v){let g=t[e];return g===void 0?(g={id:u.id,object:u,geometry:d,material:f,groupOrder:p,renderOrder:u.renderOrder,z:m,group:v},t[e]=g):(g.id=u.id,g.object=u,g.geometry=d,g.material=f,g.groupOrder=p,g.renderOrder=u.renderOrder,g.z=m,g.group=v),e++,g}function a(u,d,f,p,m,v){const g=o(u,d,f,p,m,v);f.transmission>0?n.push(g):f.transparent===!0?r.push(g):i.push(g)}function l(u,d,f,p,m,v){const g=o(u,d,f,p,m,v);f.transmission>0?n.unshift(g):f.transparent===!0?r.unshift(g):i.unshift(g)}function c(u,d){i.length>1&&i.sort(u||Gfe),n.length>1&&n.sort(d||h5),r.length>1&&r.sort(d||h5)}function h(){for(let u=e,d=t.length;u<d;u++){const f=t[u];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:i,transmissive:n,transparent:r,init:s,push:a,unshift:l,finish:h,sort:c}}function Hfe(){let t=new WeakMap;function e(n,r){const s=t.get(n);let o;return s===void 0?(o=new d5,t.set(n,[o])):r>=s.length?(o=new d5,s.push(o)):o=s[r],o}function i(){t=new WeakMap}return{get:e,dispose:i}}function Vfe(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let i;switch(e.type){case"DirectionalLight":i={direction:new te,color:new ht};break;case"SpotLight":i={position:new te,direction:new te,color:new ht,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new te,color:new ht,distance:0,decay:0};break;case"HemisphereLight":i={direction:new te,skyColor:new ht,groundColor:new ht};break;case"RectAreaLight":i={color:new ht,position:new te,halfWidth:new te,halfHeight:new te};break}return t[e.id]=i,i}}}function jfe(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let i;switch(e.type){case"DirectionalLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Qe};break;case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Qe};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Qe,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=i,i}}}let Wfe=0;function Xfe(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function qfe(t,e){const i=new Vfe,n=jfe(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let h=0;h<9;h++)r.probe.push(new te);const s=new te,o=new Wt,a=new Wt;function l(h,u){let d=0,f=0,p=0;for(let R=0;R<9;R++)r.probe[R].set(0,0,0);let m=0,v=0,g=0,y=0,x=0,b=0,S=0,A=0,E=0,M=0;h.sort(Xfe);const T=u===!0?Math.PI:1;for(let R=0,U=h.length;R<U;R++){const F=h[R],N=F.color,W=F.intensity,Q=F.distance,X=F.shadow&&F.shadow.map?F.shadow.map.texture:null;if(F.isAmbientLight)d+=N.r*W*T,f+=N.g*W*T,p+=N.b*W*T;else if(F.isLightProbe)for(let B=0;B<9;B++)r.probe[B].addScaledVector(F.sh.coefficients[B],W);else if(F.isDirectionalLight){const B=i.get(F);if(B.color.copy(F.color).multiplyScalar(F.intensity*T),F.castShadow){const j=F.shadow,z=n.get(F);z.shadowBias=j.bias,z.shadowNormalBias=j.normalBias,z.shadowRadius=j.radius,z.shadowMapSize=j.mapSize,r.directionalShadow[m]=z,r.directionalShadowMap[m]=X,r.directionalShadowMatrix[m]=F.shadow.matrix,b++}r.directional[m]=B,m++}else if(F.isSpotLight){const B=i.get(F);B.position.setFromMatrixPosition(F.matrixWorld),B.color.copy(N).multiplyScalar(W*T),B.distance=Q,B.coneCos=Math.cos(F.angle),B.penumbraCos=Math.cos(F.angle*(1-F.penumbra)),B.decay=F.decay,r.spot[g]=B;const j=F.shadow;if(F.map&&(r.spotLightMap[E]=F.map,E++,j.updateMatrices(F),F.castShadow&&M++),r.spotLightMatrix[g]=j.matrix,F.castShadow){const z=n.get(F);z.shadowBias=j.bias,z.shadowNormalBias=j.normalBias,z.shadowRadius=j.radius,z.shadowMapSize=j.mapSize,r.spotShadow[g]=z,r.spotShadowMap[g]=X,A++}g++}else if(F.isRectAreaLight){const B=i.get(F);B.color.copy(N).multiplyScalar(W),B.halfWidth.set(F.width*.5,0,0),B.halfHeight.set(0,F.height*.5,0),r.rectArea[y]=B,y++}else if(F.isPointLight){const B=i.get(F);if(B.color.copy(F.color).multiplyScalar(F.intensity*T),B.distance=F.distance,B.decay=F.decay,F.castShadow){const j=F.shadow,z=n.get(F);z.shadowBias=j.bias,z.shadowNormalBias=j.normalBias,z.shadowRadius=j.radius,z.shadowMapSize=j.mapSize,z.shadowCameraNear=j.camera.near,z.shadowCameraFar=j.camera.far,r.pointShadow[v]=z,r.pointShadowMap[v]=X,r.pointShadowMatrix[v]=F.shadow.matrix,S++}r.point[v]=B,v++}else if(F.isHemisphereLight){const B=i.get(F);B.skyColor.copy(F.color).multiplyScalar(W*T),B.groundColor.copy(F.groundColor).multiplyScalar(W*T),r.hemi[x]=B,x++}}y>0&&(e.isWebGL2||t.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=ct.LTC_FLOAT_1,r.rectAreaLTC2=ct.LTC_FLOAT_2):t.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=ct.LTC_HALF_1,r.rectAreaLTC2=ct.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=f,r.ambient[2]=p;const P=r.hash;(P.directionalLength!==m||P.pointLength!==v||P.spotLength!==g||P.rectAreaLength!==y||P.hemiLength!==x||P.numDirectionalShadows!==b||P.numPointShadows!==S||P.numSpotShadows!==A||P.numSpotMaps!==E)&&(r.directional.length=m,r.spot.length=g,r.rectArea.length=y,r.point.length=v,r.hemi.length=x,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=S,r.pointShadowMap.length=S,r.spotShadow.length=A,r.spotShadowMap.length=A,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=S,r.spotLightMatrix.length=A+E-M,r.spotLightMap.length=E,r.numSpotLightShadowsWithMaps=M,P.directionalLength=m,P.pointLength=v,P.spotLength=g,P.rectAreaLength=y,P.hemiLength=x,P.numDirectionalShadows=b,P.numPointShadows=S,P.numSpotShadows=A,P.numSpotMaps=E,r.version=Wfe++)}function c(h,u){let d=0,f=0,p=0,m=0,v=0;const g=u.matrixWorldInverse;for(let y=0,x=h.length;y<x;y++){const b=h[y];if(b.isDirectionalLight){const S=r.directional[d];S.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),S.direction.sub(s),S.direction.transformDirection(g),d++}else if(b.isSpotLight){const S=r.spot[p];S.position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(g),S.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),S.direction.sub(s),S.direction.transformDirection(g),p++}else if(b.isRectAreaLight){const S=r.rectArea[m];S.position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(g),a.identity(),o.copy(b.matrixWorld),o.premultiply(g),a.extractRotation(o),S.halfWidth.set(b.width*.5,0,0),S.halfHeight.set(0,b.height*.5,0),S.halfWidth.applyMatrix4(a),S.halfHeight.applyMatrix4(a),m++}else if(b.isPointLight){const S=r.point[f];S.position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(g),f++}else if(b.isHemisphereLight){const S=r.hemi[v];S.direction.setFromMatrixPosition(b.matrixWorld),S.direction.transformDirection(g),v++}}}return{setup:l,setupView:c,state:r}}function f5(t,e){const i=new qfe(t,e),n=[],r=[];function s(){n.length=0,r.length=0}function o(u){n.push(u)}function a(u){r.push(u)}function l(u){i.setup(n,u)}function c(u){i.setupView(n,u)}return{init:s,state:{lightsArray:n,shadowsArray:r,lights:i},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function Yfe(t,e){let i=new WeakMap;function n(s,o=0){const a=i.get(s);let l;return a===void 0?(l=new f5(t,e),i.set(s,[l])):o>=a.length?(l=new f5(t,e),a.push(l)):l=a[o],l}function r(){i=new WeakMap}return{get:n,dispose:r}}class ON extends dr{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=OQ,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class FN extends dr{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const Qfe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Kfe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Jfe(t,e,i){let n=new fC;const r=new Qe,s=new Qe,o=new zi,a=new ON({depthPacking:FQ}),l=new FN,c={},h=i.maxTextureSize,u={[jc]:Vs,[Vs]:jc,[ka]:ka},d=new Xc({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Qe},radius:{value:4}},vertexShader:Qfe,fragmentShader:Kfe}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new si;p.setAttribute("position",new Ri(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new Ur(p,d),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=aC;let g=this.type;this.render=function(S,A,E){if(v.enabled===!1||v.autoUpdate===!1&&v.needsUpdate===!1||S.length===0)return;const M=t.getRenderTarget(),T=t.getActiveCubeFace(),P=t.getActiveMipmapLevel(),R=t.state;R.setBlending($u),R.buffers.color.setClear(1,1,1,1),R.buffers.depth.setTest(!0),R.setScissorTest(!1);const U=g!==wl&&this.type===wl,F=g===wl&&this.type!==wl;for(let N=0,W=S.length;N<W;N++){const Q=S[N],X=Q.shadow;if(X===void 0){console.warn("THREE.WebGLShadowMap:",Q,"has no shadow.");continue}if(X.autoUpdate===!1&&X.needsUpdate===!1)continue;r.copy(X.mapSize);const B=X.getFrameExtents();if(r.multiply(B),s.copy(X.mapSize),(r.x>h||r.y>h)&&(r.x>h&&(s.x=Math.floor(h/B.x),r.x=s.x*B.x,X.mapSize.x=s.x),r.y>h&&(s.y=Math.floor(h/B.y),r.y=s.y*B.y,X.mapSize.y=s.y)),X.map===null||U===!0||F===!0){const z=this.type!==wl?{minFilter:Ln,magFilter:Ln}:{};X.map!==null&&X.map.dispose(),X.map=new Gl(r.x,r.y,z),X.map.texture.name=Q.name+".shadowMap",X.camera.updateProjectionMatrix()}t.setRenderTarget(X.map),t.clear();const j=X.getViewportCount();for(let z=0;z<j;z++){const k=X.getViewport(z);o.set(s.x*k.x,s.y*k.y,s.x*k.z,s.y*k.w),R.viewport(o),X.updateMatrices(Q,z),n=X.getFrustum(),b(A,E,X.camera,Q,this.type)}X.isPointLightShadow!==!0&&this.type===wl&&y(X,E),X.needsUpdate=!1}g=this.type,v.needsUpdate=!1,t.setRenderTarget(M,T,P)};function y(S,A){const E=e.update(m);d.defines.VSM_SAMPLES!==S.blurSamples&&(d.defines.VSM_SAMPLES=S.blurSamples,f.defines.VSM_SAMPLES=S.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),S.mapPass===null&&(S.mapPass=new Gl(r.x,r.y)),d.uniforms.shadow_pass.value=S.map.texture,d.uniforms.resolution.value=S.mapSize,d.uniforms.radius.value=S.radius,t.setRenderTarget(S.mapPass),t.clear(),t.renderBufferDirect(A,null,E,d,m,null),f.uniforms.shadow_pass.value=S.mapPass.texture,f.uniforms.resolution.value=S.mapSize,f.uniforms.radius.value=S.radius,t.setRenderTarget(S.map),t.clear(),t.renderBufferDirect(A,null,E,f,m,null)}function x(S,A,E,M){let T=null;const P=E.isPointLight===!0?S.customDistanceMaterial:S.customDepthMaterial;if(P!==void 0)T=P;else if(T=E.isPointLight===!0?l:a,t.localClippingEnabled&&A.clipShadows===!0&&Array.isArray(A.clippingPlanes)&&A.clippingPlanes.length!==0||A.displacementMap&&A.displacementScale!==0||A.alphaMap&&A.alphaTest>0||A.map&&A.alphaTest>0){const R=T.uuid,U=A.uuid;let F=c[R];F===void 0&&(F={},c[R]=F);let N=F[U];N===void 0&&(N=T.clone(),F[U]=N),T=N}if(T.visible=A.visible,T.wireframe=A.wireframe,M===wl?T.side=A.shadowSide!==null?A.shadowSide:A.side:T.side=A.shadowSide!==null?A.shadowSide:u[A.side],T.alphaMap=A.alphaMap,T.alphaTest=A.alphaTest,T.map=A.map,T.clipShadows=A.clipShadows,T.clippingPlanes=A.clippingPlanes,T.clipIntersection=A.clipIntersection,T.displacementMap=A.displacementMap,T.displacementScale=A.displacementScale,T.displacementBias=A.displacementBias,T.wireframeLinewidth=A.wireframeLinewidth,T.linewidth=A.linewidth,E.isPointLight===!0&&T.isMeshDistanceMaterial===!0){const R=t.properties.get(T);R.light=E}return T}function b(S,A,E,M,T){if(S.visible===!1)return;if(S.layers.test(A.layers)&&(S.isMesh||S.isLine||S.isPoints)&&(S.castShadow||S.receiveShadow&&T===wl)&&(!S.frustumCulled||n.intersectsObject(S))){S.modelViewMatrix.multiplyMatrices(E.matrixWorldInverse,S.matrixWorld);const U=e.update(S),F=S.material;if(Array.isArray(F)){const N=U.groups;for(let W=0,Q=N.length;W<Q;W++){const X=N[W],B=F[X.materialIndex];if(B&&B.visible){const j=x(S,B,M,T);t.renderBufferDirect(E,null,U,j,S,X)}}}else if(F.visible){const N=x(S,F,M,T);t.renderBufferDirect(E,null,U,N,S,null)}}const R=S.children;for(let U=0,F=R.length;U<F;U++)b(R[U],A,E,M,T)}}function Zfe(t,e,i){const n=i.isWebGL2;function r(){let q=!1;const pe=new zi;let oe=null;const Be=new zi(0,0,0,0);return{setMask:function(qe){oe!==qe&&!q&&(t.colorMask(qe,qe,qe,qe),oe=qe)},setLocked:function(qe){q=qe},setClear:function(qe,mt,qt,mi,zn){zn===!0&&(qe*=mi,mt*=mi,qt*=mi),pe.set(qe,mt,qt,mi),Be.equals(pe)===!1&&(t.clearColor(qe,mt,qt,mi),Be.copy(pe))},reset:function(){q=!1,oe=null,Be.set(-1,0,0,0)}}}function s(){let q=!1,pe=null,oe=null,Be=null;return{setTest:function(qe){qe?le(t.DEPTH_TEST):ae(t.DEPTH_TEST)},setMask:function(qe){pe!==qe&&!q&&(t.depthMask(qe),pe=qe)},setFunc:function(qe){if(oe!==qe){switch(qe){case cQ:t.depthFunc(t.NEVER);break;case uQ:t.depthFunc(t.ALWAYS);break;case hQ:t.depthFunc(t.LESS);break;case SE:t.depthFunc(t.LEQUAL);break;case dQ:t.depthFunc(t.EQUAL);break;case fQ:t.depthFunc(t.GEQUAL);break;case pQ:t.depthFunc(t.GREATER);break;case mQ:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}oe=qe}},setLocked:function(qe){q=qe},setClear:function(qe){Be!==qe&&(t.clearDepth(qe),Be=qe)},reset:function(){q=!1,pe=null,oe=null,Be=null}}}function o(){let q=!1,pe=null,oe=null,Be=null,qe=null,mt=null,qt=null,mi=null,zn=null;return{setTest:function(kt){q||(kt?le(t.STENCIL_TEST):ae(t.STENCIL_TEST))},setMask:function(kt){pe!==kt&&!q&&(t.stencilMask(kt),pe=kt)},setFunc:function(kt,mn,Li){(oe!==kt||Be!==mn||qe!==Li)&&(t.stencilFunc(kt,mn,Li),oe=kt,Be=mn,qe=Li)},setOp:function(kt,mn,Li){(mt!==kt||qt!==mn||mi!==Li)&&(t.stencilOp(kt,mn,Li),mt=kt,qt=mn,mi=Li)},setLocked:function(kt){q=kt},setClear:function(kt){zn!==kt&&(t.clearStencil(kt),zn=kt)},reset:function(){q=!1,pe=null,oe=null,Be=null,qe=null,mt=null,qt=null,mi=null,zn=null}}}const a=new r,l=new s,c=new o,h=new WeakMap,u=new WeakMap;let d={},f={},p=new WeakMap,m=[],v=null,g=!1,y=null,x=null,b=null,S=null,A=null,E=null,M=null,T=!1,P=null,R=null,U=null,F=null,N=null;const W=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Q=!1,X=0;const B=t.getParameter(t.VERSION);B.indexOf("WebGL")!==-1?(X=parseFloat(/^WebGL (\d)/.exec(B)[1]),Q=X>=1):B.indexOf("OpenGL ES")!==-1&&(X=parseFloat(/^OpenGL ES (\d)/.exec(B)[1]),Q=X>=2);let j=null,z={};const k=t.getParameter(t.SCISSOR_BOX),G=t.getParameter(t.VIEWPORT),Z=new zi().fromArray(k),K=new zi().fromArray(G);function re(q,pe,oe,Be){const qe=new Uint8Array(4),mt=t.createTexture();t.bindTexture(q,mt),t.texParameteri(q,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(q,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let qt=0;qt<oe;qt++)n&&(q===t.TEXTURE_3D||q===t.TEXTURE_2D_ARRAY)?t.texImage3D(pe,0,t.RGBA,1,1,Be,0,t.RGBA,t.UNSIGNED_BYTE,qe):t.texImage2D(pe+qt,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,qe);return mt}const J={};J[t.TEXTURE_2D]=re(t.TEXTURE_2D,t.TEXTURE_2D,1),J[t.TEXTURE_CUBE_MAP]=re(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),n&&(J[t.TEXTURE_2D_ARRAY]=re(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),J[t.TEXTURE_3D]=re(t.TEXTURE_3D,t.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),le(t.DEPTH_TEST),l.setFunc(SE),Ce(!1),Ne(oL),le(t.CULL_FACE),de($u);function le(q){d[q]!==!0&&(t.enable(q),d[q]=!0)}function ae(q){d[q]!==!1&&(t.disable(q),d[q]=!1)}function fe(q,pe){return f[q]!==pe?(t.bindFramebuffer(q,pe),f[q]=pe,n&&(q===t.DRAW_FRAMEBUFFER&&(f[t.FRAMEBUFFER]=pe),q===t.FRAMEBUFFER&&(f[t.DRAW_FRAMEBUFFER]=pe)),!0):!1}function ge(q,pe){let oe=m,Be=!1;if(q)if(oe=p.get(pe),oe===void 0&&(oe=[],p.set(pe,oe)),q.isWebGLMultipleRenderTargets){const qe=q.texture;if(oe.length!==qe.length||oe[0]!==t.COLOR_ATTACHMENT0){for(let mt=0,qt=qe.length;mt<qt;mt++)oe[mt]=t.COLOR_ATTACHMENT0+mt;oe.length=qe.length,Be=!0}}else oe[0]!==t.COLOR_ATTACHMENT0&&(oe[0]=t.COLOR_ATTACHMENT0,Be=!0);else oe[0]!==t.BACK&&(oe[0]=t.BACK,Be=!0);Be&&(i.isWebGL2?t.drawBuffers(oe):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(oe))}function ve(q){return v!==q?(t.useProgram(q),v=q,!0):!1}const Y={[sp]:t.FUNC_ADD,[ZY]:t.FUNC_SUBTRACT,[$Y]:t.FUNC_REVERSE_SUBTRACT};if(n)Y[uL]=t.MIN,Y[hL]=t.MAX;else{const q=e.get("EXT_blend_minmax");q!==null&&(Y[uL]=q.MIN_EXT,Y[hL]=q.MAX_EXT)}const ce={[eQ]:t.ZERO,[tQ]:t.ONE,[iQ]:t.SRC_COLOR,[pN]:t.SRC_ALPHA,[lQ]:t.SRC_ALPHA_SATURATE,[oQ]:t.DST_COLOR,[rQ]:t.DST_ALPHA,[nQ]:t.ONE_MINUS_SRC_COLOR,[mN]:t.ONE_MINUS_SRC_ALPHA,[aQ]:t.ONE_MINUS_DST_COLOR,[sQ]:t.ONE_MINUS_DST_ALPHA};function de(q,pe,oe,Be,qe,mt,qt,mi){if(q===$u){g===!0&&(ae(t.BLEND),g=!1);return}if(g===!1&&(le(t.BLEND),g=!0),q!==JY){if(q!==y||mi!==T){if((x!==sp||A!==sp)&&(t.blendEquation(t.FUNC_ADD),x=sp,A=sp),mi)switch(q){case Rp:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case aL:t.blendFunc(t.ONE,t.ONE);break;case lL:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case cL:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",q);break}else switch(q){case Rp:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case aL:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case lL:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case cL:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",q);break}b=null,S=null,E=null,M=null,y=q,T=mi}return}qe=qe||pe,mt=mt||oe,qt=qt||Be,(pe!==x||qe!==A)&&(t.blendEquationSeparate(Y[pe],Y[qe]),x=pe,A=qe),(oe!==b||Be!==S||mt!==E||qt!==M)&&(t.blendFuncSeparate(ce[oe],ce[Be],ce[mt],ce[qt]),b=oe,S=Be,E=mt,M=qt),y=q,T=!1}function xe(q,pe){q.side===ka?ae(t.CULL_FACE):le(t.CULL_FACE);let oe=q.side===Vs;pe&&(oe=!oe),Ce(oe),q.blending===Rp&&q.transparent===!1?de($u):de(q.blending,q.blendEquation,q.blendSrc,q.blendDst,q.blendEquationAlpha,q.blendSrcAlpha,q.blendDstAlpha,q.premultipliedAlpha),l.setFunc(q.depthFunc),l.setTest(q.depthTest),l.setMask(q.depthWrite),a.setMask(q.colorWrite);const Be=q.stencilWrite;c.setTest(Be),Be&&(c.setMask(q.stencilWriteMask),c.setFunc(q.stencilFunc,q.stencilRef,q.stencilFuncMask),c.setOp(q.stencilFail,q.stencilZFail,q.stencilZPass)),Ge(q.polygonOffset,q.polygonOffsetFactor,q.polygonOffsetUnits),q.alphaToCoverage===!0?le(t.SAMPLE_ALPHA_TO_COVERAGE):ae(t.SAMPLE_ALPHA_TO_COVERAGE)}function Ce(q){P!==q&&(q?t.frontFace(t.CW):t.frontFace(t.CCW),P=q)}function Ne(q){q!==YY?(le(t.CULL_FACE),q!==R&&(q===oL?t.cullFace(t.BACK):q===QY?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):ae(t.CULL_FACE),R=q}function Ie(q){q!==U&&(Q&&t.lineWidth(q),U=q)}function Ge(q,pe,oe){q?(le(t.POLYGON_OFFSET_FILL),(F!==pe||N!==oe)&&(t.polygonOffset(pe,oe),F=pe,N=oe)):ae(t.POLYGON_OFFSET_FILL)}function tt(q){q?le(t.SCISSOR_TEST):ae(t.SCISSOR_TEST)}function at(q){q===void 0&&(q=t.TEXTURE0+W-1),j!==q&&(t.activeTexture(q),j=q)}function ee(q,pe,oe){oe===void 0&&(j===null?oe=t.TEXTURE0+W-1:oe=j);let Be=z[oe];Be===void 0&&(Be={type:void 0,texture:void 0},z[oe]=Be),(Be.type!==q||Be.texture!==pe)&&(j!==oe&&(t.activeTexture(oe),j=oe),t.bindTexture(q,pe||J[q]),Be.type=q,Be.texture=pe)}function O(){const q=z[j];q!==void 0&&q.type!==void 0&&(t.bindTexture(q.type,null),q.type=void 0,q.texture=void 0)}function V(){try{t.compressedTexImage2D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function ue(){try{t.compressedTexImage3D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Ee(){try{t.texSubImage2D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Te(){try{t.texSubImage3D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function We(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Ve(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function me(){try{t.texStorage2D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function be(){try{t.texStorage3D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function ne(){try{t.texImage2D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Ae(){try{t.texImage3D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function ke(q){Z.equals(q)===!1&&(t.scissor(q.x,q.y,q.z,q.w),Z.copy(q))}function Ue(q){K.equals(q)===!1&&(t.viewport(q.x,q.y,q.z,q.w),K.copy(q))}function Je(q,pe){let oe=u.get(pe);oe===void 0&&(oe=new WeakMap,u.set(pe,oe));let Be=oe.get(q);Be===void 0&&(Be=t.getUniformBlockIndex(pe,q.name),oe.set(q,Be))}function ut(q,pe){const Be=u.get(pe).get(q);h.get(pe)!==Be&&(t.uniformBlockBinding(pe,Be,q.__bindingPointIndex),h.set(pe,Be))}function Pt(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),n===!0&&(t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),d={},j=null,z={},f={},p=new WeakMap,m=[],v=null,g=!1,y=null,x=null,b=null,S=null,A=null,E=null,M=null,T=!1,P=null,R=null,U=null,F=null,N=null,Z.set(0,0,t.canvas.width,t.canvas.height),K.set(0,0,t.canvas.width,t.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:le,disable:ae,bindFramebuffer:fe,drawBuffers:ge,useProgram:ve,setBlending:de,setMaterial:xe,setFlipSided:Ce,setCullFace:Ne,setLineWidth:Ie,setPolygonOffset:Ge,setScissorTest:tt,activeTexture:at,bindTexture:ee,unbindTexture:O,compressedTexImage2D:V,compressedTexImage3D:ue,texImage2D:ne,texImage3D:Ae,updateUBOMapping:Je,uniformBlockBinding:ut,texStorage2D:me,texStorage3D:be,texSubImage2D:Ee,texSubImage3D:Te,compressedTexSubImage2D:We,compressedTexSubImage3D:Ve,scissor:ke,viewport:Ue,reset:Pt}}function $fe(t,e,i,n,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,h=r.maxTextureSize,u=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let m;const v=new WeakMap;let g=!1;try{g=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(O,V){return g?new OffscreenCanvas(O,V):b_("canvas")}function x(O,V,ue,Ee){let Te=1;if((O.width>Ee||O.height>Ee)&&(Te=Ee/Math.max(O.width,O.height)),Te<1||V===!0)if(typeof HTMLImageElement<"u"&&O instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&O instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&O instanceof ImageBitmap){const We=V?EE:Math.floor,Ve=We(Te*O.width),me=We(Te*O.height);m===void 0&&(m=y(Ve,me));const be=ue?y(Ve,me):m;return be.width=Ve,be.height=me,be.getContext("2d").drawImage(O,0,0,Ve,me),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+O.width+"x"+O.height+") to ("+Ve+"x"+me+")."),be}else return"data"in O&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+O.width+"x"+O.height+")."),O;return O}function b(O){return FL(O.width)&&FL(O.height)}function S(O){return a?!1:O.wrapS!==Jr||O.wrapT!==Jr||O.minFilter!==Ln&&O.minFilter!==xn}function A(O,V){return O.generateMipmaps&&V&&O.minFilter!==Ln&&O.minFilter!==xn}function E(O){t.generateMipmap(O)}function M(O,V,ue,Ee,Te=!1){if(a===!1)return V;if(O!==null){if(t[O]!==void 0)return t[O];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+O+"'")}let We=V;return V===t.RED&&(ue===t.FLOAT&&(We=t.R32F),ue===t.HALF_FLOAT&&(We=t.R16F),ue===t.UNSIGNED_BYTE&&(We=t.R8)),V===t.RG&&(ue===t.FLOAT&&(We=t.RG32F),ue===t.HALF_FLOAT&&(We=t.RG16F),ue===t.UNSIGNED_BYTE&&(We=t.RG8)),V===t.RGBA&&(ue===t.FLOAT&&(We=t.RGBA32F),ue===t.HALF_FLOAT&&(We=t.RGBA16F),ue===t.UNSIGNED_BYTE&&(We=Ee===ni&&Te===!1?t.SRGB8_ALPHA8:t.RGBA8),ue===t.UNSIGNED_SHORT_4_4_4_4&&(We=t.RGBA4),ue===t.UNSIGNED_SHORT_5_5_5_1&&(We=t.RGB5_A1)),(We===t.R16F||We===t.R32F||We===t.RG16F||We===t.RG32F||We===t.RGBA16F||We===t.RGBA32F)&&e.get("EXT_color_buffer_float"),We}function T(O,V,ue){return A(O,ue)===!0||O.isFramebufferTexture&&O.minFilter!==Ln&&O.minFilter!==xn?Math.log2(Math.max(V.width,V.height))+1:O.mipmaps!==void 0&&O.mipmaps.length>0?O.mipmaps.length:O.isCompressedTexture&&Array.isArray(O.image)?V.mipmaps.length:1}function P(O){return O===Ln||O===y_||O===Nv?t.NEAREST:t.LINEAR}function R(O){const V=O.target;V.removeEventListener("dispose",R),F(V),V.isVideoTexture&&p.delete(V)}function U(O){const V=O.target;V.removeEventListener("dispose",U),W(V)}function F(O){const V=n.get(O);if(V.__webglInit===void 0)return;const ue=O.source,Ee=v.get(ue);if(Ee){const Te=Ee[V.__cacheKey];Te.usedTimes--,Te.usedTimes===0&&N(O),Object.keys(Ee).length===0&&v.delete(ue)}n.remove(O)}function N(O){const V=n.get(O);t.deleteTexture(V.__webglTexture);const ue=O.source,Ee=v.get(ue);delete Ee[V.__cacheKey],o.memory.textures--}function W(O){const V=O.texture,ue=n.get(O),Ee=n.get(V);if(Ee.__webglTexture!==void 0&&(t.deleteTexture(Ee.__webglTexture),o.memory.textures--),O.depthTexture&&O.depthTexture.dispose(),O.isWebGLCubeRenderTarget)for(let Te=0;Te<6;Te++)t.deleteFramebuffer(ue.__webglFramebuffer[Te]),ue.__webglDepthbuffer&&t.deleteRenderbuffer(ue.__webglDepthbuffer[Te]);else{if(t.deleteFramebuffer(ue.__webglFramebuffer),ue.__webglDepthbuffer&&t.deleteRenderbuffer(ue.__webglDepthbuffer),ue.__webglMultisampledFramebuffer&&t.deleteFramebuffer(ue.__webglMultisampledFramebuffer),ue.__webglColorRenderbuffer)for(let Te=0;Te<ue.__webglColorRenderbuffer.length;Te++)ue.__webglColorRenderbuffer[Te]&&t.deleteRenderbuffer(ue.__webglColorRenderbuffer[Te]);ue.__webglDepthRenderbuffer&&t.deleteRenderbuffer(ue.__webglDepthRenderbuffer)}if(O.isWebGLMultipleRenderTargets)for(let Te=0,We=V.length;Te<We;Te++){const Ve=n.get(V[Te]);Ve.__webglTexture&&(t.deleteTexture(Ve.__webglTexture),o.memory.textures--),n.remove(V[Te])}n.remove(V),n.remove(O)}let Q=0;function X(){Q=0}function B(){const O=Q;return O>=l&&console.warn("THREE.WebGLTextures: Trying to use "+O+" texture units while this GPU supports only "+l),Q+=1,O}function j(O){const V=[];return V.push(O.wrapS),V.push(O.wrapT),V.push(O.wrapR||0),V.push(O.magFilter),V.push(O.minFilter),V.push(O.anisotropy),V.push(O.internalFormat),V.push(O.format),V.push(O.type),V.push(O.generateMipmaps),V.push(O.premultiplyAlpha),V.push(O.flipY),V.push(O.unpackAlignment),V.push(O.colorSpace),V.join()}function z(O,V){const ue=n.get(O);if(O.isVideoTexture&&at(O),O.isRenderTargetTexture===!1&&O.version>0&&ue.__version!==O.version){const Ee=O.image;if(Ee===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Ee.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{fe(ue,O,V);return}}i.bindTexture(t.TEXTURE_2D,ue.__webglTexture,t.TEXTURE0+V)}function k(O,V){const ue=n.get(O);if(O.version>0&&ue.__version!==O.version){fe(ue,O,V);return}i.bindTexture(t.TEXTURE_2D_ARRAY,ue.__webglTexture,t.TEXTURE0+V)}function G(O,V){const ue=n.get(O);if(O.version>0&&ue.__version!==O.version){fe(ue,O,V);return}i.bindTexture(t.TEXTURE_3D,ue.__webglTexture,t.TEXTURE0+V)}function Z(O,V){const ue=n.get(O);if(O.version>0&&ue.__version!==O.version){ge(ue,O,V);return}i.bindTexture(t.TEXTURE_CUBE_MAP,ue.__webglTexture,t.TEXTURE0+V)}const K={[Yd]:t.REPEAT,[Jr]:t.CLAMP_TO_EDGE,[d0]:t.MIRRORED_REPEAT},re={[Ln]:t.NEAREST,[y_]:t.NEAREST_MIPMAP_NEAREST,[Nv]:t.NEAREST_MIPMAP_LINEAR,[xn]:t.LINEAR,[cC]:t.LINEAR_MIPMAP_NEAREST,[Wc]:t.LINEAR_MIPMAP_LINEAR},J={[kQ]:t.NEVER,[XQ]:t.ALWAYS,[zQ]:t.LESS,[HQ]:t.LEQUAL,[GQ]:t.EQUAL,[WQ]:t.GEQUAL,[VQ]:t.GREATER,[jQ]:t.NOTEQUAL};function le(O,V,ue){if(ue?(t.texParameteri(O,t.TEXTURE_WRAP_S,K[V.wrapS]),t.texParameteri(O,t.TEXTURE_WRAP_T,K[V.wrapT]),(O===t.TEXTURE_3D||O===t.TEXTURE_2D_ARRAY)&&t.texParameteri(O,t.TEXTURE_WRAP_R,K[V.wrapR]),t.texParameteri(O,t.TEXTURE_MAG_FILTER,re[V.magFilter]),t.texParameteri(O,t.TEXTURE_MIN_FILTER,re[V.minFilter])):(t.texParameteri(O,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(O,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),(O===t.TEXTURE_3D||O===t.TEXTURE_2D_ARRAY)&&t.texParameteri(O,t.TEXTURE_WRAP_R,t.CLAMP_TO_EDGE),(V.wrapS!==Jr||V.wrapT!==Jr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(O,t.TEXTURE_MAG_FILTER,P(V.magFilter)),t.texParameteri(O,t.TEXTURE_MIN_FILTER,P(V.minFilter)),V.minFilter!==Ln&&V.minFilter!==xn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),V.compareFunction&&(t.texParameteri(O,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(O,t.TEXTURE_COMPARE_FUNC,J[V.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const Ee=e.get("EXT_texture_filter_anisotropic");if(V.magFilter===Ln||V.minFilter!==Nv&&V.minFilter!==Wc||V.type===Dc&&e.has("OES_texture_float_linear")===!1||a===!1&&V.type===f0&&e.has("OES_texture_half_float_linear")===!1)return;(V.anisotropy>1||n.get(V).__currentAnisotropy)&&(t.texParameterf(O,Ee.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(V.anisotropy,r.getMaxAnisotropy())),n.get(V).__currentAnisotropy=V.anisotropy)}}function ae(O,V){let ue=!1;O.__webglInit===void 0&&(O.__webglInit=!0,V.addEventListener("dispose",R));const Ee=V.source;let Te=v.get(Ee);Te===void 0&&(Te={},v.set(Ee,Te));const We=j(V);if(We!==O.__cacheKey){Te[We]===void 0&&(Te[We]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,ue=!0),Te[We].usedTimes++;const Ve=Te[O.__cacheKey];Ve!==void 0&&(Te[O.__cacheKey].usedTimes--,Ve.usedTimes===0&&N(V)),O.__cacheKey=We,O.__webglTexture=Te[We].texture}return ue}function fe(O,V,ue){let Ee=t.TEXTURE_2D;(V.isDataArrayTexture||V.isCompressedArrayTexture)&&(Ee=t.TEXTURE_2D_ARRAY),V.isData3DTexture&&(Ee=t.TEXTURE_3D);const Te=ae(O,V),We=V.source;i.bindTexture(Ee,O.__webglTexture,t.TEXTURE0+ue);const Ve=n.get(We);if(We.version!==Ve.__version||Te===!0){i.activeTexture(t.TEXTURE0+ue),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,V.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,V.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE);const me=S(V)&&b(V.image)===!1;let be=x(V.image,me,!1,h);be=ee(V,be);const ne=b(be)||a,Ae=s.convert(V.format,V.colorSpace);let ke=s.convert(V.type),Ue=M(V.internalFormat,Ae,ke,V.colorSpace);le(Ee,V,ne);let Je;const ut=V.mipmaps,Pt=a&&V.isVideoTexture!==!0,q=Ve.__version===void 0||Te===!0,pe=T(V,be,ne);if(V.isDepthTexture)Ue=t.DEPTH_COMPONENT,a?V.type===Dc?Ue=t.DEPTH_COMPONENT32F:V.type===Xu?Ue=t.DEPTH_COMPONENT24:V.type===Pd?Ue=t.DEPTH24_STENCIL8:Ue=t.DEPTH_COMPONENT16:V.type===Dc&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),V.format===Dd&&Ue===t.DEPTH_COMPONENT&&V.type!==uC&&V.type!==Xu&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),V.type=Xu,ke=s.convert(V.type)),V.format===em&&Ue===t.DEPTH_COMPONENT&&(Ue=t.DEPTH_STENCIL,V.type!==Pd&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),V.type=Pd,ke=s.convert(V.type))),q&&(Pt?i.texStorage2D(t.TEXTURE_2D,1,Ue,be.width,be.height):i.texImage2D(t.TEXTURE_2D,0,Ue,be.width,be.height,0,Ae,ke,null));else if(V.isDataTexture)if(ut.length>0&&ne){Pt&&q&&i.texStorage2D(t.TEXTURE_2D,pe,Ue,ut[0].width,ut[0].height);for(let oe=0,Be=ut.length;oe<Be;oe++)Je=ut[oe],Pt?i.texSubImage2D(t.TEXTURE_2D,oe,0,0,Je.width,Je.height,Ae,ke,Je.data):i.texImage2D(t.TEXTURE_2D,oe,Ue,Je.width,Je.height,0,Ae,ke,Je.data);V.generateMipmaps=!1}else Pt?(q&&i.texStorage2D(t.TEXTURE_2D,pe,Ue,be.width,be.height),i.texSubImage2D(t.TEXTURE_2D,0,0,0,be.width,be.height,Ae,ke,be.data)):i.texImage2D(t.TEXTURE_2D,0,Ue,be.width,be.height,0,Ae,ke,be.data);else if(V.isCompressedTexture)if(V.isCompressedArrayTexture){Pt&&q&&i.texStorage3D(t.TEXTURE_2D_ARRAY,pe,Ue,ut[0].width,ut[0].height,be.depth);for(let oe=0,Be=ut.length;oe<Be;oe++)Je=ut[oe],V.format!==no?Ae!==null?Pt?i.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,oe,0,0,0,Je.width,Je.height,be.depth,Ae,Je.data,0,0):i.compressedTexImage3D(t.TEXTURE_2D_ARRAY,oe,Ue,Je.width,Je.height,be.depth,0,Je.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Pt?i.texSubImage3D(t.TEXTURE_2D_ARRAY,oe,0,0,0,Je.width,Je.height,be.depth,Ae,ke,Je.data):i.texImage3D(t.TEXTURE_2D_ARRAY,oe,Ue,Je.width,Je.height,be.depth,0,Ae,ke,Je.data)}else{Pt&&q&&i.texStorage2D(t.TEXTURE_2D,pe,Ue,ut[0].width,ut[0].height);for(let oe=0,Be=ut.length;oe<Be;oe++)Je=ut[oe],V.format!==no?Ae!==null?Pt?i.compressedTexSubImage2D(t.TEXTURE_2D,oe,0,0,Je.width,Je.height,Ae,Je.data):i.compressedTexImage2D(t.TEXTURE_2D,oe,Ue,Je.width,Je.height,0,Je.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Pt?i.texSubImage2D(t.TEXTURE_2D,oe,0,0,Je.width,Je.height,Ae,ke,Je.data):i.texImage2D(t.TEXTURE_2D,oe,Ue,Je.width,Je.height,0,Ae,ke,Je.data)}else if(V.isDataArrayTexture)Pt?(q&&i.texStorage3D(t.TEXTURE_2D_ARRAY,pe,Ue,be.width,be.height,be.depth),i.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,be.width,be.height,be.depth,Ae,ke,be.data)):i.texImage3D(t.TEXTURE_2D_ARRAY,0,Ue,be.width,be.height,be.depth,0,Ae,ke,be.data);else if(V.isData3DTexture)Pt?(q&&i.texStorage3D(t.TEXTURE_3D,pe,Ue,be.width,be.height,be.depth),i.texSubImage3D(t.TEXTURE_3D,0,0,0,0,be.width,be.height,be.depth,Ae,ke,be.data)):i.texImage3D(t.TEXTURE_3D,0,Ue,be.width,be.height,be.depth,0,Ae,ke,be.data);else if(V.isFramebufferTexture){if(q)if(Pt)i.texStorage2D(t.TEXTURE_2D,pe,Ue,be.width,be.height);else{let oe=be.width,Be=be.height;for(let qe=0;qe<pe;qe++)i.texImage2D(t.TEXTURE_2D,qe,Ue,oe,Be,0,Ae,ke,null),oe>>=1,Be>>=1}}else if(ut.length>0&&ne){Pt&&q&&i.texStorage2D(t.TEXTURE_2D,pe,Ue,ut[0].width,ut[0].height);for(let oe=0,Be=ut.length;oe<Be;oe++)Je=ut[oe],Pt?i.texSubImage2D(t.TEXTURE_2D,oe,0,0,Ae,ke,Je):i.texImage2D(t.TEXTURE_2D,oe,Ue,Ae,ke,Je);V.generateMipmaps=!1}else Pt?(q&&i.texStorage2D(t.TEXTURE_2D,pe,Ue,be.width,be.height),i.texSubImage2D(t.TEXTURE_2D,0,0,0,Ae,ke,be)):i.texImage2D(t.TEXTURE_2D,0,Ue,Ae,ke,be);A(V,ne)&&E(Ee),Ve.__version=We.version,V.onUpdate&&V.onUpdate(V)}O.__version=V.version}function ge(O,V,ue){if(V.image.length!==6)return;const Ee=ae(O,V),Te=V.source;i.bindTexture(t.TEXTURE_CUBE_MAP,O.__webglTexture,t.TEXTURE0+ue);const We=n.get(Te);if(Te.version!==We.__version||Ee===!0){i.activeTexture(t.TEXTURE0+ue),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,V.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,V.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE);const Ve=V.isCompressedTexture||V.image[0].isCompressedTexture,me=V.image[0]&&V.image[0].isDataTexture,be=[];for(let oe=0;oe<6;oe++)!Ve&&!me?be[oe]=x(V.image[oe],!1,!0,c):be[oe]=me?V.image[oe].image:V.image[oe],be[oe]=ee(V,be[oe]);const ne=be[0],Ae=b(ne)||a,ke=s.convert(V.format,V.colorSpace),Ue=s.convert(V.type),Je=M(V.internalFormat,ke,Ue,V.colorSpace),ut=a&&V.isVideoTexture!==!0,Pt=We.__version===void 0||Ee===!0;let q=T(V,ne,Ae);le(t.TEXTURE_CUBE_MAP,V,Ae);let pe;if(Ve){ut&&Pt&&i.texStorage2D(t.TEXTURE_CUBE_MAP,q,Je,ne.width,ne.height);for(let oe=0;oe<6;oe++){pe=be[oe].mipmaps;for(let Be=0;Be<pe.length;Be++){const qe=pe[Be];V.format!==no?ke!==null?ut?i.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,Be,0,0,qe.width,qe.height,ke,qe.data):i.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,Be,Je,qe.width,qe.height,0,qe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ut?i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,Be,0,0,qe.width,qe.height,ke,Ue,qe.data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,Be,Je,qe.width,qe.height,0,ke,Ue,qe.data)}}}else{pe=V.mipmaps,ut&&Pt&&(pe.length>0&&q++,i.texStorage2D(t.TEXTURE_CUBE_MAP,q,Je,be[0].width,be[0].height));for(let oe=0;oe<6;oe++)if(me){ut?i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,0,0,0,be[oe].width,be[oe].height,ke,Ue,be[oe].data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,0,Je,be[oe].width,be[oe].height,0,ke,Ue,be[oe].data);for(let Be=0;Be<pe.length;Be++){const mt=pe[Be].image[oe].image;ut?i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,Be+1,0,0,mt.width,mt.height,ke,Ue,mt.data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,Be+1,Je,mt.width,mt.height,0,ke,Ue,mt.data)}}else{ut?i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,0,0,0,ke,Ue,be[oe]):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,0,Je,ke,Ue,be[oe]);for(let Be=0;Be<pe.length;Be++){const qe=pe[Be];ut?i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,Be+1,0,0,ke,Ue,qe.image[oe]):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,Be+1,Je,ke,Ue,qe.image[oe])}}}A(V,Ae)&&E(t.TEXTURE_CUBE_MAP),We.__version=Te.version,V.onUpdate&&V.onUpdate(V)}O.__version=V.version}function ve(O,V,ue,Ee,Te){const We=s.convert(ue.format,ue.colorSpace),Ve=s.convert(ue.type),me=M(ue.internalFormat,We,Ve,ue.colorSpace);n.get(V).__hasExternalTextures||(Te===t.TEXTURE_3D||Te===t.TEXTURE_2D_ARRAY?i.texImage3D(Te,0,me,V.width,V.height,V.depth,0,We,Ve,null):i.texImage2D(Te,0,me,V.width,V.height,0,We,Ve,null)),i.bindFramebuffer(t.FRAMEBUFFER,O),tt(V)?d.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,Ee,Te,n.get(ue).__webglTexture,0,Ge(V)):(Te===t.TEXTURE_2D||Te>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&Te<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,Ee,Te,n.get(ue).__webglTexture,0),i.bindFramebuffer(t.FRAMEBUFFER,null)}function Y(O,V,ue){if(t.bindRenderbuffer(t.RENDERBUFFER,O),V.depthBuffer&&!V.stencilBuffer){let Ee=t.DEPTH_COMPONENT16;if(ue||tt(V)){const Te=V.depthTexture;Te&&Te.isDepthTexture&&(Te.type===Dc?Ee=t.DEPTH_COMPONENT32F:Te.type===Xu&&(Ee=t.DEPTH_COMPONENT24));const We=Ge(V);tt(V)?d.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,We,Ee,V.width,V.height):t.renderbufferStorageMultisample(t.RENDERBUFFER,We,Ee,V.width,V.height)}else t.renderbufferStorage(t.RENDERBUFFER,Ee,V.width,V.height);t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,O)}else if(V.depthBuffer&&V.stencilBuffer){const Ee=Ge(V);ue&&tt(V)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,Ee,t.DEPTH24_STENCIL8,V.width,V.height):tt(V)?d.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Ee,t.DEPTH24_STENCIL8,V.width,V.height):t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,V.width,V.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,O)}else{const Ee=V.isWebGLMultipleRenderTargets===!0?V.texture:[V.texture];for(let Te=0;Te<Ee.length;Te++){const We=Ee[Te],Ve=s.convert(We.format,We.colorSpace),me=s.convert(We.type),be=M(We.internalFormat,Ve,me,We.colorSpace),ne=Ge(V);ue&&tt(V)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,ne,be,V.width,V.height):tt(V)?d.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,ne,be,V.width,V.height):t.renderbufferStorage(t.RENDERBUFFER,be,V.width,V.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function ce(O,V){if(V&&V.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(t.FRAMEBUFFER,O),!(V.depthTexture&&V.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(V.depthTexture).__webglTexture||V.depthTexture.image.width!==V.width||V.depthTexture.image.height!==V.height)&&(V.depthTexture.image.width=V.width,V.depthTexture.image.height=V.height,V.depthTexture.needsUpdate=!0),z(V.depthTexture,0);const Ee=n.get(V.depthTexture).__webglTexture,Te=Ge(V);if(V.depthTexture.format===Dd)tt(V)?d.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Ee,0,Te):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Ee,0);else if(V.depthTexture.format===em)tt(V)?d.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Ee,0,Te):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Ee,0);else throw new Error("Unknown depthTexture format")}function de(O){const V=n.get(O),ue=O.isWebGLCubeRenderTarget===!0;if(O.depthTexture&&!V.__autoAllocateDepthBuffer){if(ue)throw new Error("target.depthTexture not supported in Cube render targets");ce(V.__webglFramebuffer,O)}else if(ue){V.__webglDepthbuffer=[];for(let Ee=0;Ee<6;Ee++)i.bindFramebuffer(t.FRAMEBUFFER,V.__webglFramebuffer[Ee]),V.__webglDepthbuffer[Ee]=t.createRenderbuffer(),Y(V.__webglDepthbuffer[Ee],O,!1)}else i.bindFramebuffer(t.FRAMEBUFFER,V.__webglFramebuffer),V.__webglDepthbuffer=t.createRenderbuffer(),Y(V.__webglDepthbuffer,O,!1);i.bindFramebuffer(t.FRAMEBUFFER,null)}function xe(O,V,ue){const Ee=n.get(O);V!==void 0&&ve(Ee.__webglFramebuffer,O,O.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),ue!==void 0&&de(O)}function Ce(O){const V=O.texture,ue=n.get(O),Ee=n.get(V);O.addEventListener("dispose",U),O.isWebGLMultipleRenderTargets!==!0&&(Ee.__webglTexture===void 0&&(Ee.__webglTexture=t.createTexture()),Ee.__version=V.version,o.memory.textures++);const Te=O.isWebGLCubeRenderTarget===!0,We=O.isWebGLMultipleRenderTargets===!0,Ve=b(O)||a;if(Te){ue.__webglFramebuffer=[];for(let me=0;me<6;me++)ue.__webglFramebuffer[me]=t.createFramebuffer()}else{if(ue.__webglFramebuffer=t.createFramebuffer(),We)if(r.drawBuffers){const me=O.texture;for(let be=0,ne=me.length;be<ne;be++){const Ae=n.get(me[be]);Ae.__webglTexture===void 0&&(Ae.__webglTexture=t.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&O.samples>0&&tt(O)===!1){const me=We?V:[V];ue.__webglMultisampledFramebuffer=t.createFramebuffer(),ue.__webglColorRenderbuffer=[],i.bindFramebuffer(t.FRAMEBUFFER,ue.__webglMultisampledFramebuffer);for(let be=0;be<me.length;be++){const ne=me[be];ue.__webglColorRenderbuffer[be]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,ue.__webglColorRenderbuffer[be]);const Ae=s.convert(ne.format,ne.colorSpace),ke=s.convert(ne.type),Ue=M(ne.internalFormat,Ae,ke,ne.colorSpace,O.isXRRenderTarget===!0),Je=Ge(O);t.renderbufferStorageMultisample(t.RENDERBUFFER,Je,Ue,O.width,O.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+be,t.RENDERBUFFER,ue.__webglColorRenderbuffer[be])}t.bindRenderbuffer(t.RENDERBUFFER,null),O.depthBuffer&&(ue.__webglDepthRenderbuffer=t.createRenderbuffer(),Y(ue.__webglDepthRenderbuffer,O,!0)),i.bindFramebuffer(t.FRAMEBUFFER,null)}}if(Te){i.bindTexture(t.TEXTURE_CUBE_MAP,Ee.__webglTexture),le(t.TEXTURE_CUBE_MAP,V,Ve);for(let me=0;me<6;me++)ve(ue.__webglFramebuffer[me],O,V,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+me);A(V,Ve)&&E(t.TEXTURE_CUBE_MAP),i.unbindTexture()}else if(We){const me=O.texture;for(let be=0,ne=me.length;be<ne;be++){const Ae=me[be],ke=n.get(Ae);i.bindTexture(t.TEXTURE_2D,ke.__webglTexture),le(t.TEXTURE_2D,Ae,Ve),ve(ue.__webglFramebuffer,O,Ae,t.COLOR_ATTACHMENT0+be,t.TEXTURE_2D),A(Ae,Ve)&&E(t.TEXTURE_2D)}i.unbindTexture()}else{let me=t.TEXTURE_2D;(O.isWebGL3DRenderTarget||O.isWebGLArrayRenderTarget)&&(a?me=O.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),i.bindTexture(me,Ee.__webglTexture),le(me,V,Ve),ve(ue.__webglFramebuffer,O,V,t.COLOR_ATTACHMENT0,me),A(V,Ve)&&E(me),i.unbindTexture()}O.depthBuffer&&de(O)}function Ne(O){const V=b(O)||a,ue=O.isWebGLMultipleRenderTargets===!0?O.texture:[O.texture];for(let Ee=0,Te=ue.length;Ee<Te;Ee++){const We=ue[Ee];if(A(We,V)){const Ve=O.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,me=n.get(We).__webglTexture;i.bindTexture(Ve,me),E(Ve),i.unbindTexture()}}}function Ie(O){if(a&&O.samples>0&&tt(O)===!1){const V=O.isWebGLMultipleRenderTargets?O.texture:[O.texture],ue=O.width,Ee=O.height;let Te=t.COLOR_BUFFER_BIT;const We=[],Ve=O.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,me=n.get(O),be=O.isWebGLMultipleRenderTargets===!0;if(be)for(let ne=0;ne<V.length;ne++)i.bindFramebuffer(t.FRAMEBUFFER,me.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+ne,t.RENDERBUFFER,null),i.bindFramebuffer(t.FRAMEBUFFER,me.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+ne,t.TEXTURE_2D,null,0);i.bindFramebuffer(t.READ_FRAMEBUFFER,me.__webglMultisampledFramebuffer),i.bindFramebuffer(t.DRAW_FRAMEBUFFER,me.__webglFramebuffer);for(let ne=0;ne<V.length;ne++){We.push(t.COLOR_ATTACHMENT0+ne),O.depthBuffer&&We.push(Ve);const Ae=me.__ignoreDepthValues!==void 0?me.__ignoreDepthValues:!1;if(Ae===!1&&(O.depthBuffer&&(Te|=t.DEPTH_BUFFER_BIT),O.stencilBuffer&&(Te|=t.STENCIL_BUFFER_BIT)),be&&t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,me.__webglColorRenderbuffer[ne]),Ae===!0&&(t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[Ve]),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[Ve])),be){const ke=n.get(V[ne]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,ke,0)}t.blitFramebuffer(0,0,ue,Ee,0,0,ue,Ee,Te,t.NEAREST),f&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,We)}if(i.bindFramebuffer(t.READ_FRAMEBUFFER,null),i.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),be)for(let ne=0;ne<V.length;ne++){i.bindFramebuffer(t.FRAMEBUFFER,me.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+ne,t.RENDERBUFFER,me.__webglColorRenderbuffer[ne]);const Ae=n.get(V[ne]).__webglTexture;i.bindFramebuffer(t.FRAMEBUFFER,me.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+ne,t.TEXTURE_2D,Ae,0)}i.bindFramebuffer(t.DRAW_FRAMEBUFFER,me.__webglMultisampledFramebuffer)}}function Ge(O){return Math.min(u,O.samples)}function tt(O){const V=n.get(O);return a&&O.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&V.__useRenderToTexture!==!1}function at(O){const V=o.render.frame;p.get(O)!==V&&(p.set(O,V),O.update())}function ee(O,V){const ue=O.colorSpace,Ee=O.format,Te=O.type;return O.isCompressedTexture===!0||O.format===ME||ue!==zl&&ue!==Id&&(ue===ni?a===!1?e.has("EXT_sRGB")===!0&&Ee===no?(O.format=ME,O.minFilter=xn,O.generateMipmaps=!1):V=CN.sRGBToLinear(V):(Ee!==no||Te!==Nc)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ue)),V}this.allocateTextureUnit=B,this.resetTextureUnits=X,this.setTexture2D=z,this.setTexture2DArray=k,this.setTexture3D=G,this.setTextureCube=Z,this.rebindTextures=xe,this.setupRenderTarget=Ce,this.updateRenderTargetMipmap=Ne,this.updateMultisampleRenderTarget=Ie,this.setupDepthRenderbuffer=de,this.setupFrameBufferTexture=ve,this.useMultisampledRTT=tt}function rK(t,e,i){const n=i.isWebGL2;function r(s,o=Id){let a;if(s===Nc)return t.UNSIGNED_BYTE;if(s===yN)return t.UNSIGNED_SHORT_4_4_4_4;if(s===xN)return t.UNSIGNED_SHORT_5_5_5_1;if(s===bQ)return t.BYTE;if(s===SQ)return t.SHORT;if(s===uC)return t.UNSIGNED_SHORT;if(s===vN)return t.INT;if(s===Xu)return t.UNSIGNED_INT;if(s===Dc)return t.FLOAT;if(s===f0)return n?t.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===AQ)return t.ALPHA;if(s===no)return t.RGBA;if(s===MQ)return t.LUMINANCE;if(s===EQ)return t.LUMINANCE_ALPHA;if(s===Dd)return t.DEPTH_COMPONENT;if(s===em)return t.DEPTH_STENCIL;if(s===ME)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===TQ)return t.RED;if(s===_N)return t.RED_INTEGER;if(s===CQ)return t.RG;if(s===wN)return t.RG_INTEGER;if(s===bN)return t.RGBA_INTEGER;if(s===AM||s===MM||s===EM||s===TM)if(o===ni)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===AM)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===MM)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===EM)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===TM)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===AM)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===MM)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===EM)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===TM)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===dL||s===fL||s===pL||s===mL)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===dL)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===fL)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===pL)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===mL)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===PQ)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===gL||s===vL)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===gL)return o===ni?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===vL)return o===ni?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===yL||s===xL||s===_L||s===wL||s===bL||s===SL||s===AL||s===ML||s===EL||s===TL||s===CL||s===PL||s===DL||s===RL)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===yL)return o===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===xL)return o===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===_L)return o===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===wL)return o===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===bL)return o===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===SL)return o===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===AL)return o===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===ML)return o===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===EL)return o===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===TL)return o===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===CL)return o===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===PL)return o===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===DL)return o===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===RL)return o===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===CM)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===CM)return o===ni?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===DQ||s===IL||s===LL||s===BL)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===CM)return a.COMPRESSED_RED_RGTC1_EXT;if(s===IL)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===LL)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===BL)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Pd?n?t.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):t[s]!==void 0?t[s]:null}return{convert:r}}class sK extends fn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class qu extends Si{constructor(){super(),this.isGroup=!0,this.type="Group"}}const epe={type:"move"};class xD{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new qu,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new qu,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new te,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new te),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new qu,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new te,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new te),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const i=this._hand;if(i)for(const n of e.hand.values())this._getHandJoint(i,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,i,n){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&i.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(const m of e.hand.values()){const v=i.getJointPose(m,n),g=this._getHandJoint(c,m);v!==null&&(g.matrix.fromArray(v.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.matrixWorldNeedsUpdate=!0,g.jointRadius=v.radius),g.visible=v!==null}const h=c.joints["index-finger-tip"],u=c.joints["thumb-tip"],d=h.position.distanceTo(u.position),f=.02,p=.005;c.inputState.pinching&&d>f+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&d<=f-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=i.getPose(e.gripSpace,n),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=i.getPose(e.targetRaySpace,n),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(epe)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,i){if(e.joints[i.jointName]===void 0){const n=new qu;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[i.jointName]=n,e.add(n)}return e.joints[i.jointName]}}class oK extends pn{constructor(e,i,n,r,s,o,a,l,c,h){if(h=h!==void 0?h:Dd,h!==Dd&&h!==em)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&h===Dd&&(n=Xu),n===void 0&&h===em&&(n=Pd),super(null,r,s,o,a,l,h,n,c),this.isDepthTexture=!0,this.image={width:e,height:i},this.magFilter=a!==void 0?a:Ln,this.minFilter=l!==void 0?l:Ln,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const i=super.toJSON(e);return this.compareFunction!==null&&(i.compareFunction=this.compareFunction),i}}class tpe extends $c{constructor(e,i){super();const n=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,h=null,u=null,d=null,f=null,p=null;const m=i.getContextAttributes();let v=null,g=null;const y=[],x=[],b=new fn;b.layers.enable(1),b.viewport=new zi;const S=new fn;S.layers.enable(2),S.viewport=new zi;const A=[b,S],E=new sK;E.layers.enable(1),E.layers.enable(2);let M=null,T=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(k){let G=y[k];return G===void 0&&(G=new xD,y[k]=G),G.getTargetRaySpace()},this.getControllerGrip=function(k){let G=y[k];return G===void 0&&(G=new xD,y[k]=G),G.getGripSpace()},this.getHand=function(k){let G=y[k];return G===void 0&&(G=new xD,y[k]=G),G.getHandSpace()};function P(k){const G=x.indexOf(k.inputSource);if(G===-1)return;const Z=y[G];Z!==void 0&&(Z.update(k.inputSource,k.frame,c||o),Z.dispatchEvent({type:k.type,data:k.inputSource}))}function R(){r.removeEventListener("select",P),r.removeEventListener("selectstart",P),r.removeEventListener("selectend",P),r.removeEventListener("squeeze",P),r.removeEventListener("squeezestart",P),r.removeEventListener("squeezeend",P),r.removeEventListener("end",R),r.removeEventListener("inputsourceschange",U);for(let k=0;k<y.length;k++){const G=x[k];G!==null&&(x[k]=null,y[k].disconnect(G))}M=null,T=null,e.setRenderTarget(v),f=null,d=null,u=null,r=null,g=null,z.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(k){s=k,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(k){a=k,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(k){c=k},this.getBaseLayer=function(){return d!==null?d:f},this.getBinding=function(){return u},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=async function(k){if(r=k,r!==null){if(v=e.getRenderTarget(),r.addEventListener("select",P),r.addEventListener("selectstart",P),r.addEventListener("selectend",P),r.addEventListener("squeeze",P),r.addEventListener("squeezestart",P),r.addEventListener("squeezeend",P),r.addEventListener("end",R),r.addEventListener("inputsourceschange",U),m.xrCompatible!==!0&&await i.makeXRCompatible(),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const G={antialias:r.renderState.layers===void 0?m.antialias:!0,alpha:!0,depth:m.depth,stencil:m.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(r,i,G),r.updateRenderState({baseLayer:f}),g=new Gl(f.framebufferWidth,f.framebufferHeight,{format:no,type:Nc,colorSpace:e.outputColorSpace,stencilBuffer:m.stencil})}else{let G=null,Z=null,K=null;m.depth&&(K=m.stencil?i.DEPTH24_STENCIL8:i.DEPTH_COMPONENT24,G=m.stencil?em:Dd,Z=m.stencil?Pd:Xu);const re={colorFormat:i.RGBA8,depthFormat:K,scaleFactor:s};u=new XRWebGLBinding(r,i),d=u.createProjectionLayer(re),r.updateRenderState({layers:[d]}),g=new Gl(d.textureWidth,d.textureHeight,{format:no,type:Nc,depthTexture:new oK(d.textureWidth,d.textureHeight,Z,void 0,void 0,void 0,void 0,void 0,void 0,G),stencilBuffer:m.stencil,colorSpace:e.outputColorSpace,samples:m.antialias?4:0});const J=e.properties.get(g);J.__ignoreDepthValues=d.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=await r.requestReferenceSpace(a),z.setContext(r),z.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode};function U(k){for(let G=0;G<k.removed.length;G++){const Z=k.removed[G],K=x.indexOf(Z);K>=0&&(x[K]=null,y[K].disconnect(Z))}for(let G=0;G<k.added.length;G++){const Z=k.added[G];let K=x.indexOf(Z);if(K===-1){for(let J=0;J<y.length;J++)if(J>=x.length){x.push(Z),K=J;break}else if(x[J]===null){x[J]=Z,K=J;break}if(K===-1)break}const re=y[K];re&&re.connect(Z)}}const F=new te,N=new te;function W(k,G,Z){F.setFromMatrixPosition(G.matrixWorld),N.setFromMatrixPosition(Z.matrixWorld);const K=F.distanceTo(N),re=G.projectionMatrix.elements,J=Z.projectionMatrix.elements,le=re[14]/(re[10]-1),ae=re[14]/(re[10]+1),fe=(re[9]+1)/re[5],ge=(re[9]-1)/re[5],ve=(re[8]-1)/re[0],Y=(J[8]+1)/J[0],ce=le*ve,de=le*Y,xe=K/(-ve+Y),Ce=xe*-ve;G.matrixWorld.decompose(k.position,k.quaternion,k.scale),k.translateX(Ce),k.translateZ(xe),k.matrixWorld.compose(k.position,k.quaternion,k.scale),k.matrixWorldInverse.copy(k.matrixWorld).invert();const Ne=le+xe,Ie=ae+xe,Ge=ce-Ce,tt=de+(K-Ce),at=fe*ae/Ie*Ne,ee=ge*ae/Ie*Ne;k.projectionMatrix.makePerspective(Ge,tt,at,ee,Ne,Ie),k.projectionMatrixInverse.copy(k.projectionMatrix).invert()}function Q(k,G){G===null?k.matrixWorld.copy(k.matrix):k.matrixWorld.multiplyMatrices(G.matrixWorld,k.matrix),k.matrixWorldInverse.copy(k.matrixWorld).invert()}this.updateCamera=function(k){if(r===null)return;E.near=S.near=b.near=k.near,E.far=S.far=b.far=k.far,(M!==E.near||T!==E.far)&&(r.updateRenderState({depthNear:E.near,depthFar:E.far}),M=E.near,T=E.far);const G=k.parent,Z=E.cameras;Q(E,G);for(let K=0;K<Z.length;K++)Q(Z[K],G);Z.length===2?W(E,b,S):E.projectionMatrix.copy(b.projectionMatrix),X(k,E,G)};function X(k,G,Z){Z===null?k.matrix.copy(G.matrixWorld):(k.matrix.copy(Z.matrixWorld),k.matrix.invert(),k.matrix.multiply(G.matrixWorld)),k.matrix.decompose(k.position,k.quaternion,k.scale),k.updateMatrixWorld(!0);const K=k.children;for(let re=0,J=K.length;re<J;re++)K[re].updateMatrixWorld(!0);k.projectionMatrix.copy(G.projectionMatrix),k.projectionMatrixInverse.copy(G.projectionMatrixInverse),k.isPerspectiveCamera&&(k.fov=m0*2*Math.atan(1/k.projectionMatrix.elements[5]),k.zoom=1)}this.getCamera=function(){return E},this.getFoveation=function(){if(!(d===null&&f===null))return l},this.setFoveation=function(k){l=k,d!==null&&(d.fixedFoveation=k),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=k)};let B=null;function j(k,G){if(h=G.getViewerPose(c||o),p=G,h!==null){const Z=h.views;f!==null&&(e.setRenderTargetFramebuffer(g,f.framebuffer),e.setRenderTarget(g));let K=!1;Z.length!==E.cameras.length&&(E.cameras.length=0,K=!0);for(let re=0;re<Z.length;re++){const J=Z[re];let le=null;if(f!==null)le=f.getViewport(J);else{const fe=u.getViewSubImage(d,J);le=fe.viewport,re===0&&(e.setRenderTargetTextures(g,fe.colorTexture,d.ignoreDepthValues?void 0:fe.depthStencilTexture),e.setRenderTarget(g))}let ae=A[re];ae===void 0&&(ae=new fn,ae.layers.enable(re),ae.viewport=new zi,A[re]=ae),ae.matrix.fromArray(J.transform.matrix),ae.matrix.decompose(ae.position,ae.quaternion,ae.scale),ae.projectionMatrix.fromArray(J.projectionMatrix),ae.projectionMatrixInverse.copy(ae.projectionMatrix).invert(),ae.viewport.set(le.x,le.y,le.width,le.height),re===0&&(E.matrix.copy(ae.matrix),E.matrix.decompose(E.position,E.quaternion,E.scale)),K===!0&&E.cameras.push(ae)}}for(let Z=0;Z<y.length;Z++){const K=x[Z],re=y[Z];K!==null&&re!==void 0&&re.update(K,G,c||o)}B&&B(k,G),G.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:G}),p=null}const z=new $Q;z.setAnimationLoop(j),this.setAnimationLoop=function(k){B=k},this.dispose=function(){}}}function ipe(t,e){function i(v,g){v.matrixAutoUpdate===!0&&v.updateMatrix(),g.value.copy(v.matrix)}function n(v,g){g.color.getRGB(v.fogColor.value,JQ(t)),g.isFog?(v.fogNear.value=g.near,v.fogFar.value=g.far):g.isFogExp2&&(v.fogDensity.value=g.density)}function r(v,g,y,x,b){g.isMeshBasicMaterial||g.isMeshLambertMaterial?s(v,g):g.isMeshToonMaterial?(s(v,g),u(v,g)):g.isMeshPhongMaterial?(s(v,g),h(v,g)):g.isMeshStandardMaterial?(s(v,g),d(v,g),g.isMeshPhysicalMaterial&&f(v,g,b)):g.isMeshMatcapMaterial?(s(v,g),p(v,g)):g.isMeshDepthMaterial?s(v,g):g.isMeshDistanceMaterial?(s(v,g),m(v,g)):g.isMeshNormalMaterial?s(v,g):g.isLineBasicMaterial?(o(v,g),g.isLineDashedMaterial&&a(v,g)):g.isPointsMaterial?l(v,g,y,x):g.isSpriteMaterial?c(v,g):g.isShadowMaterial?(v.color.value.copy(g.color),v.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function s(v,g){v.opacity.value=g.opacity,g.color&&v.diffuse.value.copy(g.color),g.emissive&&v.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(v.map.value=g.map,i(g.map,v.mapTransform)),g.alphaMap&&(v.alphaMap.value=g.alphaMap,i(g.alphaMap,v.alphaMapTransform)),g.bumpMap&&(v.bumpMap.value=g.bumpMap,i(g.bumpMap,v.bumpMapTransform),v.bumpScale.value=g.bumpScale,g.side===Vs&&(v.bumpScale.value*=-1)),g.normalMap&&(v.normalMap.value=g.normalMap,i(g.normalMap,v.normalMapTransform),v.normalScale.value.copy(g.normalScale),g.side===Vs&&v.normalScale.value.negate()),g.displacementMap&&(v.displacementMap.value=g.displacementMap,i(g.displacementMap,v.displacementMapTransform),v.displacementScale.value=g.displacementScale,v.displacementBias.value=g.displacementBias),g.emissiveMap&&(v.emissiveMap.value=g.emissiveMap,i(g.emissiveMap,v.emissiveMapTransform)),g.specularMap&&(v.specularMap.value=g.specularMap,i(g.specularMap,v.specularMapTransform)),g.alphaTest>0&&(v.alphaTest.value=g.alphaTest);const y=e.get(g).envMap;if(y&&(v.envMap.value=y,v.flipEnvMap.value=y.isCubeTexture&&y.isRenderTargetTexture===!1?-1:1,v.reflectivity.value=g.reflectivity,v.ior.value=g.ior,v.refractionRatio.value=g.refractionRatio),g.lightMap){v.lightMap.value=g.lightMap;const x=t.useLegacyLights===!0?Math.PI:1;v.lightMapIntensity.value=g.lightMapIntensity*x,i(g.lightMap,v.lightMapTransform)}g.aoMap&&(v.aoMap.value=g.aoMap,v.aoMapIntensity.value=g.aoMapIntensity,i(g.aoMap,v.aoMapTransform))}function o(v,g){v.diffuse.value.copy(g.color),v.opacity.value=g.opacity,g.map&&(v.map.value=g.map,i(g.map,v.mapTransform))}function a(v,g){v.dashSize.value=g.dashSize,v.totalSize.value=g.dashSize+g.gapSize,v.scale.value=g.scale}function l(v,g,y,x){v.diffuse.value.copy(g.color),v.opacity.value=g.opacity,v.size.value=g.size*y,v.scale.value=x*.5,g.map&&(v.map.value=g.map,i(g.map,v.uvTransform)),g.alphaMap&&(v.alphaMap.value=g.alphaMap,i(g.alphaMap,v.alphaMapTransform)),g.alphaTest>0&&(v.alphaTest.value=g.alphaTest)}function c(v,g){v.diffuse.value.copy(g.color),v.opacity.value=g.opacity,v.rotation.value=g.rotation,g.map&&(v.map.value=g.map,i(g.map,v.mapTransform)),g.alphaMap&&(v.alphaMap.value=g.alphaMap,i(g.alphaMap,v.alphaMapTransform)),g.alphaTest>0&&(v.alphaTest.value=g.alphaTest)}function h(v,g){v.specular.value.copy(g.specular),v.shininess.value=Math.max(g.shininess,1e-4)}function u(v,g){g.gradientMap&&(v.gradientMap.value=g.gradientMap)}function d(v,g){v.metalness.value=g.metalness,g.metalnessMap&&(v.metalnessMap.value=g.metalnessMap,i(g.metalnessMap,v.metalnessMapTransform)),v.roughness.value=g.roughness,g.roughnessMap&&(v.roughnessMap.value=g.roughnessMap,i(g.roughnessMap,v.roughnessMapTransform)),e.get(g).envMap&&(v.envMapIntensity.value=g.envMapIntensity)}function f(v,g,y){v.ior.value=g.ior,g.sheen>0&&(v.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),v.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(v.sheenColorMap.value=g.sheenColorMap,i(g.sheenColorMap,v.sheenColorMapTransform)),g.sheenRoughnessMap&&(v.sheenRoughnessMap.value=g.sheenRoughnessMap,i(g.sheenRoughnessMap,v.sheenRoughnessMapTransform))),g.clearcoat>0&&(v.clearcoat.value=g.clearcoat,v.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(v.clearcoatMap.value=g.clearcoatMap,i(g.clearcoatMap,v.clearcoatMapTransform)),g.clearcoatRoughnessMap&&(v.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap,i(g.clearcoatRoughnessMap,v.clearcoatRoughnessMapTransform)),g.clearcoatNormalMap&&(v.clearcoatNormalMap.value=g.clearcoatNormalMap,i(g.clearcoatNormalMap,v.clearcoatNormalMapTransform),v.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),g.side===Vs&&v.clearcoatNormalScale.value.negate())),g.iridescence>0&&(v.iridescence.value=g.iridescence,v.iridescenceIOR.value=g.iridescenceIOR,v.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],v.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(v.iridescenceMap.value=g.iridescenceMap,i(g.iridescenceMap,v.iridescenceMapTransform)),g.iridescenceThicknessMap&&(v.iridescenceThicknessMap.value=g.iridescenceThicknessMap,i(g.iridescenceThicknessMap,v.iridescenceThicknessMapTransform))),g.transmission>0&&(v.transmission.value=g.transmission,v.transmissionSamplerMap.value=y.texture,v.transmissionSamplerSize.value.set(y.width,y.height),g.transmissionMap&&(v.transmissionMap.value=g.transmissionMap,i(g.transmissionMap,v.transmissionMapTransform)),v.thickness.value=g.thickness,g.thicknessMap&&(v.thicknessMap.value=g.thicknessMap,i(g.thicknessMap,v.thicknessMapTransform)),v.attenuationDistance.value=g.attenuationDistance,v.attenuationColor.value.copy(g.attenuationColor)),g.anisotropy>0&&(v.anisotropyVector.value.set(g.anisotropy*Math.cos(g.anisotropyRotation),g.anisotropy*Math.sin(g.anisotropyRotation)),g.anisotropyMap&&(v.anisotropyMap.value=g.anisotropyMap,i(g.anisotropyMap,v.anisotropyMapTransform))),v.specularIntensity.value=g.specularIntensity,v.specularColor.value.copy(g.specularColor),g.specularColorMap&&(v.specularColorMap.value=g.specularColorMap,i(g.specularColorMap,v.specularColorMapTransform)),g.specularIntensityMap&&(v.specularIntensityMap.value=g.specularIntensityMap,i(g.specularIntensityMap,v.specularIntensityMapTransform))}function p(v,g){g.matcap&&(v.matcap.value=g.matcap)}function m(v,g){const y=e.get(g).light;v.referencePosition.value.setFromMatrixPosition(y.matrixWorld),v.nearDistance.value=y.shadow.camera.near,v.farDistance.value=y.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function npe(t,e,i,n){let r={},s={},o=[];const a=i.isWebGL2?t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(y,x){const b=x.program;n.uniformBlockBinding(y,b)}function c(y,x){let b=r[y.id];b===void 0&&(p(y),b=h(y),r[y.id]=b,y.addEventListener("dispose",v));const S=x.program;n.updateUBOMapping(y,S);const A=e.render.frame;s[y.id]!==A&&(d(y),s[y.id]=A)}function h(y){const x=u();y.__bindingPointIndex=x;const b=t.createBuffer(),S=y.__size,A=y.usage;return t.bindBuffer(t.UNIFORM_BUFFER,b),t.bufferData(t.UNIFORM_BUFFER,S,A),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,x,b),b}function u(){for(let y=0;y<a;y++)if(o.indexOf(y)===-1)return o.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(y){const x=r[y.id],b=y.uniforms,S=y.__cache;t.bindBuffer(t.UNIFORM_BUFFER,x);for(let A=0,E=b.length;A<E;A++){const M=b[A];if(f(M,A,S)===!0){const T=M.__offset,P=Array.isArray(M.value)?M.value:[M.value];let R=0;for(let U=0;U<P.length;U++){const F=P[U],N=m(F);typeof F=="number"?(M.__data[0]=F,t.bufferSubData(t.UNIFORM_BUFFER,T+R,M.__data)):F.isMatrix3?(M.__data[0]=F.elements[0],M.__data[1]=F.elements[1],M.__data[2]=F.elements[2],M.__data[3]=F.elements[0],M.__data[4]=F.elements[3],M.__data[5]=F.elements[4],M.__data[6]=F.elements[5],M.__data[7]=F.elements[0],M.__data[8]=F.elements[6],M.__data[9]=F.elements[7],M.__data[10]=F.elements[8],M.__data[11]=F.elements[0]):(F.toArray(M.__data,R),R+=N.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,T,M.__data)}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function f(y,x,b){const S=y.value;if(b[x]===void 0){if(typeof S=="number")b[x]=S;else{const A=Array.isArray(S)?S:[S],E=[];for(let M=0;M<A.length;M++)E.push(A[M].clone());b[x]=E}return!0}else if(typeof S=="number"){if(b[x]!==S)return b[x]=S,!0}else{const A=Array.isArray(b[x])?b[x]:[b[x]],E=Array.isArray(S)?S:[S];for(let M=0;M<A.length;M++){const T=A[M];if(T.equals(E[M])===!1)return T.copy(E[M]),!0}}return!1}function p(y){const x=y.uniforms;let b=0;const S=16;let A=0;for(let E=0,M=x.length;E<M;E++){const T=x[E],P={boundary:0,storage:0},R=Array.isArray(T.value)?T.value:[T.value];for(let U=0,F=R.length;U<F;U++){const N=R[U],W=m(N);P.boundary+=W.boundary,P.storage+=W.storage}if(T.__data=new Float32Array(P.storage/Float32Array.BYTES_PER_ELEMENT),T.__offset=b,E>0){A=b%S;const U=S-A;A!==0&&U-P.boundary<0&&(b+=S-A,T.__offset=b)}b+=P.storage}return A=b%S,A>0&&(b+=S-A),y.__size=b,y.__cache={},this}function m(y){const x={boundary:0,storage:0};return typeof y=="number"?(x.boundary=4,x.storage=4):y.isVector2?(x.boundary=8,x.storage=8):y.isVector3||y.isColor?(x.boundary=16,x.storage=12):y.isVector4?(x.boundary=16,x.storage=16):y.isMatrix3?(x.boundary=48,x.storage=48):y.isMatrix4?(x.boundary=64,x.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),x}function v(y){const x=y.target;x.removeEventListener("dispose",v);const b=o.indexOf(x.__bindingPointIndex);o.splice(b,1),t.deleteBuffer(r[x.id]),delete r[x.id],delete s[x.id]}function g(){for(const y in r)t.deleteBuffer(r[y]);o=[],r={},s={}}return{bind:l,update:c,dispose:g}}function rpe(){const t=b_("canvas");return t.style.display="block",t}class NN{constructor(e={}){const{canvas:i=rpe(),context:n=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:h="default",failIfMajorPerformanceCaveat:u=!1}=e;this.isWebGLRenderer=!0;let d;n!==null?d=n.getContextAttributes().alpha:d=o;const f=new Uint32Array(4),p=new Int32Array(4);let m=null,v=null;const g=[],y=[];this.domElement=i,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=ni,this.useLegacyLights=!0,this.toneMapping=Ll,this.toneMappingExposure=1;const x=this;let b=!1,S=0,A=0,E=null,M=-1,T=null;const P=new zi,R=new zi;let U=null;const F=new ht(0);let N=0,W=i.width,Q=i.height,X=1,B=null,j=null;const z=new zi(0,0,W,Q),k=new zi(0,0,W,Q);let G=!1;const Z=new fC;let K=!1,re=!1,J=null;const le=new Wt,ae=new Qe,fe=new te,ge={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ve(){return E===null?X:1}let Y=n;function ce($,we){for(let Re=0;Re<$.length;Re++){const _e=$[Re],Oe=i.getContext(_e,we);if(Oe!==null)return Oe}return null}try{const $={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:h,failIfMajorPerformanceCaveat:u};if("setAttribute"in i&&i.setAttribute("data-engine",`three.js r${cw}`),i.addEventListener("webglcontextlost",pe,!1),i.addEventListener("webglcontextrestored",oe,!1),i.addEventListener("webglcontextcreationerror",Be,!1),Y===null){const we=["webgl2","webgl","experimental-webgl"];if(x.isWebGL1Renderer===!0&&we.shift(),Y=ce(we,$),Y===null)throw ce(we)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&Y instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),Y.getShaderPrecisionFormat===void 0&&(Y.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch($){throw console.error("THREE.WebGLRenderer: "+$.message),$}let de,xe,Ce,Ne,Ie,Ge,tt,at,ee,O,V,ue,Ee,Te,We,Ve,me,be,ne,Ae,ke,Ue,Je,ut;function Pt(){de=new xde(Y),xe=new fde(Y,de,e),de.init(xe),Ue=new rK(Y,de,xe),Ce=new Zfe(Y,de,xe),Ne=new bde(Y),Ie=new zfe,Ge=new $fe(Y,de,Ce,Ie,xe,Ue,Ne),tt=new mde(x),at=new yde(x),ee=new Ice(Y,xe),Je=new hde(Y,de,ee,xe),O=new _de(Y,ee,Ne,Je),V=new Ede(Y,O,ee,Ne),ne=new Mde(Y,xe,Ge),Ve=new pde(Ie),ue=new kfe(x,tt,at,de,xe,Je,Ve),Ee=new ipe(x,Ie),Te=new Hfe,We=new Yfe(de,xe),be=new ude(x,tt,at,Ce,V,d,l),me=new Jfe(x,V,xe),ut=new npe(Y,Ne,xe,Ce),Ae=new dde(Y,de,Ne,xe),ke=new wde(Y,de,Ne,xe),Ne.programs=ue.programs,x.capabilities=xe,x.extensions=de,x.properties=Ie,x.renderLists=Te,x.shadowMap=me,x.state=Ce,x.info=Ne}Pt();const q=new tpe(x,Y);this.xr=q,this.getContext=function(){return Y},this.getContextAttributes=function(){return Y.getContextAttributes()},this.forceContextLoss=function(){const $=de.get("WEBGL_lose_context");$&&$.loseContext()},this.forceContextRestore=function(){const $=de.get("WEBGL_lose_context");$&&$.restoreContext()},this.getPixelRatio=function(){return X},this.setPixelRatio=function($){$!==void 0&&(X=$,this.setSize(W,Q,!1))},this.getSize=function($){return $.set(W,Q)},this.setSize=function($,we,Re=!0){if(q.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}W=$,Q=we,i.width=Math.floor($*X),i.height=Math.floor(we*X),Re===!0&&(i.style.width=$+"px",i.style.height=we+"px"),this.setViewport(0,0,$,we)},this.getDrawingBufferSize=function($){return $.set(W*X,Q*X).floor()},this.setDrawingBufferSize=function($,we,Re){W=$,Q=we,X=Re,i.width=Math.floor($*Re),i.height=Math.floor(we*Re),this.setViewport(0,0,$,we)},this.getCurrentViewport=function($){return $.copy(P)},this.getViewport=function($){return $.copy(z)},this.setViewport=function($,we,Re,_e){$.isVector4?z.set($.x,$.y,$.z,$.w):z.set($,we,Re,_e),Ce.viewport(P.copy(z).multiplyScalar(X).floor())},this.getScissor=function($){return $.copy(k)},this.setScissor=function($,we,Re,_e){$.isVector4?k.set($.x,$.y,$.z,$.w):k.set($,we,Re,_e),Ce.scissor(R.copy(k).multiplyScalar(X).floor())},this.getScissorTest=function(){return G},this.setScissorTest=function($){Ce.setScissorTest(G=$)},this.setOpaqueSort=function($){B=$},this.setTransparentSort=function($){j=$},this.getClearColor=function($){return $.copy(be.getClearColor())},this.setClearColor=function(){be.setClearColor.apply(be,arguments)},this.getClearAlpha=function(){return be.getClearAlpha()},this.setClearAlpha=function(){be.setClearAlpha.apply(be,arguments)},this.clear=function($=!0,we=!0,Re=!0){let _e=0;if($){let Oe=!1;if(E!==null){const et=E.texture.format;Oe=et===bN||et===wN||et===_N}if(Oe){const et=E.texture.type,vt=et===Nc||et===Xu||et===uC||et===Pd||et===yN||et===xN,St=be.getClearColor(),Tt=be.getClearAlpha(),Ht=St.r,xt=St.g,lt=St.b;vt?(f[0]=Ht,f[1]=xt,f[2]=lt,f[3]=Tt,Y.clearBufferuiv(Y.COLOR,0,f)):(p[0]=Ht,p[1]=xt,p[2]=lt,p[3]=Tt,Y.clearBufferiv(Y.COLOR,0,p))}else _e|=Y.COLOR_BUFFER_BIT}we&&(_e|=Y.DEPTH_BUFFER_BIT),Re&&(_e|=Y.STENCIL_BUFFER_BIT),Y.clear(_e)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",pe,!1),i.removeEventListener("webglcontextrestored",oe,!1),i.removeEventListener("webglcontextcreationerror",Be,!1),Te.dispose(),We.dispose(),Ie.dispose(),tt.dispose(),at.dispose(),V.dispose(),Je.dispose(),ut.dispose(),ue.dispose(),q.dispose(),q.removeEventListener("sessionstart",kt),q.removeEventListener("sessionend",mn),J&&(J.dispose(),J=null),Li.stop()};function pe($){$.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),b=!0}function oe(){console.log("THREE.WebGLRenderer: Context Restored."),b=!1;const $=Ne.autoReset,we=me.enabled,Re=me.autoUpdate,_e=me.needsUpdate,Oe=me.type;Pt(),Ne.autoReset=$,me.enabled=we,me.autoUpdate=Re,me.needsUpdate=_e,me.type=Oe}function Be($){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",$.statusMessage)}function qe($){const we=$.target;we.removeEventListener("dispose",qe),mt(we)}function mt($){qt($),Ie.remove($)}function qt($){const we=Ie.get($).programs;we!==void 0&&(we.forEach(function(Re){ue.releaseProgram(Re)}),$.isShaderMaterial&&ue.releaseShaderCache($))}this.renderBufferDirect=function($,we,Re,_e,Oe,et){we===null&&(we=ge);const vt=Oe.isMesh&&Oe.matrixWorld.determinant()<0,St=De($,we,Re,_e,Oe);Ce.setMaterial(_e,vt);let Tt=Re.index,Ht=1;_e.wireframe===!0&&(Tt=O.getWireframeAttribute(Re),Ht=2);const xt=Re.drawRange,lt=Re.attributes.position;let Bi=xt.start*Ht,Ni=(xt.start+xt.count)*Ht;et!==null&&(Bi=Math.max(Bi,et.start*Ht),Ni=Math.min(Ni,(et.start+et.count)*Ht)),Tt!==null?(Bi=Math.max(Bi,0),Ni=Math.min(Ni,Tt.count)):lt!=null&&(Bi=Math.max(Bi,0),Ni=Math.min(Ni,lt.count));const Gn=Ni-Bi;if(Gn<0||Gn===1/0)return;Je.setup(Oe,_e,St,Re,Tt);let ns,Ai=Ae;if(Tt!==null&&(ns=ee.get(Tt),Ai=ke,Ai.setIndex(ns)),Oe.isMesh)_e.wireframe===!0?(Ce.setLineWidth(_e.wireframeLinewidth*ve()),Ai.setMode(Y.LINES)):Ai.setMode(Y.TRIANGLES);else if(Oe.isLine){let Vt=_e.linewidth;Vt===void 0&&(Vt=1),Ce.setLineWidth(Vt*ve()),Oe.isLineSegments?Ai.setMode(Y.LINES):Oe.isLineLoop?Ai.setMode(Y.LINE_LOOP):Ai.setMode(Y.LINE_STRIP)}else Oe.isPoints?Ai.setMode(Y.POINTS):Oe.isSprite&&Ai.setMode(Y.TRIANGLES);if(Oe.isInstancedMesh)Ai.renderInstances(Bi,Gn,Oe.count);else if(Re.isInstancedBufferGeometry){const Vt=Re._maxInstanceCount!==void 0?Re._maxInstanceCount:1/0,jt=Math.min(Re.instanceCount,Vt);Ai.renderInstances(Bi,Gn,jt)}else Ai.render(Bi,Gn)},this.compile=function($,we){function Re(_e,Oe,et){_e.transparent===!0&&_e.side===ka&&_e.forceSinglePass===!1?(_e.side=Vs,_e.needsUpdate=!0,Le(_e,Oe,et),_e.side=jc,_e.needsUpdate=!0,Le(_e,Oe,et),_e.side=ka):Le(_e,Oe,et)}v=We.get($),v.init(),y.push(v),$.traverseVisible(function(_e){_e.isLight&&_e.layers.test(we.layers)&&(v.pushLight(_e),_e.castShadow&&v.pushShadow(_e))}),v.setupLights(x.useLegacyLights),$.traverse(function(_e){const Oe=_e.material;if(Oe)if(Array.isArray(Oe))for(let et=0;et<Oe.length;et++){const vt=Oe[et];Re(vt,$,_e)}else Re(Oe,$,_e)}),y.pop(),v=null};let mi=null;function zn($){mi&&mi($)}function kt(){Li.stop()}function mn(){Li.start()}const Li=new $Q;Li.setAnimationLoop(zn),typeof self<"u"&&Li.setContext(self),this.setAnimationLoop=function($){mi=$,q.setAnimationLoop($),$===null?Li.stop():Li.start()},q.addEventListener("sessionstart",kt),q.addEventListener("sessionend",mn),this.render=function($,we){if(we!==void 0&&we.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(b===!0)return;$.matrixWorldAutoUpdate===!0&&$.updateMatrixWorld(),we.parent===null&&we.matrixWorldAutoUpdate===!0&&we.updateMatrixWorld(),q.enabled===!0&&q.isPresenting===!0&&(q.cameraAutoUpdate===!0&&q.updateCamera(we),we=q.getCamera()),$.isScene===!0&&$.onBeforeRender(x,$,we,E),v=We.get($,y.length),v.init(),y.push(v),le.multiplyMatrices(we.projectionMatrix,we.matrixWorldInverse),Z.setFromProjectionMatrix(le),re=this.localClippingEnabled,K=Ve.init(this.clippingPlanes,re),m=Te.get($,g.length),m.init(),g.push(m),gf($,we,0,x.sortObjects),m.finish(),x.sortObjects===!0&&m.sort(B,j),this.info.render.frame++,K===!0&&Ve.beginShadows();const Re=v.state.shadowsArray;if(me.render(Re,$,we),K===!0&&Ve.endShadows(),this.info.autoReset===!0&&this.info.reset(),be.render(m,$),v.setupLights(x.useLegacyLights),we.isArrayCamera){const _e=we.cameras;for(let Oe=0,et=_e.length;Oe<et;Oe++){const vt=_e[Oe];Em(m,$,vt,vt.viewport)}}else Em(m,$,we);E!==null&&(Ge.updateMultisampleRenderTarget(E),Ge.updateRenderTargetMipmap(E)),$.isScene===!0&&$.onAfterRender(x,$,we),Je.resetDefaultState(),M=-1,T=null,y.pop(),y.length>0?v=y[y.length-1]:v=null,g.pop(),g.length>0?m=g[g.length-1]:m=null};function gf($,we,Re,_e){if($.visible===!1)return;if($.layers.test(we.layers)){if($.isGroup)Re=$.renderOrder;else if($.isLOD)$.autoUpdate===!0&&$.update(we);else if($.isLight)v.pushLight($),$.castShadow&&v.pushShadow($);else if($.isSprite){if(!$.frustumCulled||Z.intersectsSprite($)){_e&&fe.setFromMatrixPosition($.matrixWorld).applyMatrix4(le);const vt=V.update($),St=$.material;St.visible&&m.push($,vt,St,Re,fe.z,null)}}else if(($.isMesh||$.isLine||$.isPoints)&&(!$.frustumCulled||Z.intersectsObject($))){const vt=V.update($),St=$.material;if(_e&&($.boundingSphere!==void 0?($.boundingSphere===null&&$.computeBoundingSphere(),fe.copy($.boundingSphere.center)):(vt.boundingSphere===null&&vt.computeBoundingSphere(),fe.copy(vt.boundingSphere.center)),fe.applyMatrix4($.matrixWorld).applyMatrix4(le)),Array.isArray(St)){const Tt=vt.groups;for(let Ht=0,xt=Tt.length;Ht<xt;Ht++){const lt=Tt[Ht],Bi=St[lt.materialIndex];Bi&&Bi.visible&&m.push($,vt,Bi,Re,fe.z,lt)}}else St.visible&&m.push($,vt,St,Re,fe.z,null)}}const et=$.children;for(let vt=0,St=et.length;vt<St;vt++)gf(et[vt],we,Re,_e)}function Em($,we,Re,_e){const Oe=$.opaque,et=$.transmissive,vt=$.transparent;v.setupLightsView(Re),K===!0&&Ve.setGlobalState(x.clippingPlanes,Re),et.length>0&&Tm(Oe,et,we,Re),_e&&Ce.viewport(P.copy(_e)),Oe.length>0&&Kl(Oe,we,Re),et.length>0&&Kl(et,we,Re),vt.length>0&&Kl(vt,we,Re),Ce.buffers.depth.setTest(!0),Ce.buffers.depth.setMask(!0),Ce.buffers.color.setMask(!0),Ce.setPolygonOffset(!1)}function Tm($,we,Re,_e){const Oe=xe.isWebGL2;J===null&&(J=new Gl(1,1,{generateMipmaps:!0,type:de.has("EXT_color_buffer_half_float")?f0:Nc,minFilter:Wc,samples:Oe?4:0})),x.getDrawingBufferSize(ae),Oe?J.setSize(ae.x,ae.y):J.setSize(EE(ae.x),EE(ae.y));const et=x.getRenderTarget();x.setRenderTarget(J),x.getClearColor(F),N=x.getClearAlpha(),N<1&&x.setClearColor(16777215,.5),x.clear();const vt=x.toneMapping;x.toneMapping=Ll,Kl($,Re,_e),Ge.updateMultisampleRenderTarget(J),Ge.updateRenderTargetMipmap(J);let St=!1;for(let Tt=0,Ht=we.length;Tt<Ht;Tt++){const xt=we[Tt],lt=xt.object,Bi=xt.geometry,Ni=xt.material,Gn=xt.group;if(Ni.side===ka&&lt.layers.test(_e.layers)){const ns=Ni.side;Ni.side=Vs,Ni.needsUpdate=!0,ie(lt,Re,_e,Bi,Ni,Gn),Ni.side=ns,Ni.needsUpdate=!0,St=!0}}St===!0&&(Ge.updateMultisampleRenderTarget(J),Ge.updateRenderTargetMipmap(J)),x.setRenderTarget(et),x.setClearColor(F,N),x.toneMapping=vt}function Kl($,we,Re){const _e=we.isScene===!0?we.overrideMaterial:null;for(let Oe=0,et=$.length;Oe<et;Oe++){const vt=$[Oe],St=vt.object,Tt=vt.geometry,Ht=_e===null?vt.material:_e,xt=vt.group;St.layers.test(Re.layers)&&ie(St,we,Re,Tt,Ht,xt)}}function ie($,we,Re,_e,Oe,et){$.onBeforeRender(x,we,Re,_e,Oe,et),$.modelViewMatrix.multiplyMatrices(Re.matrixWorldInverse,$.matrixWorld),$.normalMatrix.getNormalMatrix($.modelViewMatrix),Oe.onBeforeRender(x,we,Re,_e,$,et),Oe.transparent===!0&&Oe.side===ka&&Oe.forceSinglePass===!1?(Oe.side=Vs,Oe.needsUpdate=!0,x.renderBufferDirect(Re,we,_e,Oe,$,et),Oe.side=jc,Oe.needsUpdate=!0,x.renderBufferDirect(Re,we,_e,Oe,$,et),Oe.side=ka):x.renderBufferDirect(Re,we,_e,Oe,$,et),$.onAfterRender(x,we,Re,_e,Oe,et)}function Le($,we,Re){we.isScene!==!0&&(we=ge);const _e=Ie.get($),Oe=v.state.lights,et=v.state.shadowsArray,vt=Oe.state.version,St=ue.getParameters($,Oe.state,et,we,Re),Tt=ue.getProgramCacheKey(St);let Ht=_e.programs;_e.environment=$.isMeshStandardMaterial?we.environment:null,_e.fog=we.fog,_e.envMap=($.isMeshStandardMaterial?at:tt).get($.envMap||_e.environment),Ht===void 0&&($.addEventListener("dispose",qe),Ht=new Map,_e.programs=Ht);let xt=Ht.get(Tt);if(xt!==void 0){if(_e.currentProgram===xt&&_e.lightsStateVersion===vt)return Xe($,St),xt}else St.uniforms=ue.getUniforms($),$.onBuild(Re,St,x),$.onBeforeCompile(St,x),xt=ue.acquireProgram(St,Tt),Ht.set(Tt,xt),_e.uniforms=St.uniforms;const lt=_e.uniforms;(!$.isShaderMaterial&&!$.isRawShaderMaterial||$.clipping===!0)&&(lt.clippingPlanes=Ve.uniform),Xe($,St),_e.needsLights=bt($),_e.lightsStateVersion=vt,_e.needsLights&&(lt.ambientLightColor.value=Oe.state.ambient,lt.lightProbe.value=Oe.state.probe,lt.directionalLights.value=Oe.state.directional,lt.directionalLightShadows.value=Oe.state.directionalShadow,lt.spotLights.value=Oe.state.spot,lt.spotLightShadows.value=Oe.state.spotShadow,lt.rectAreaLights.value=Oe.state.rectArea,lt.ltc_1.value=Oe.state.rectAreaLTC1,lt.ltc_2.value=Oe.state.rectAreaLTC2,lt.pointLights.value=Oe.state.point,lt.pointLightShadows.value=Oe.state.pointShadow,lt.hemisphereLights.value=Oe.state.hemi,lt.directionalShadowMap.value=Oe.state.directionalShadowMap,lt.directionalShadowMatrix.value=Oe.state.directionalShadowMatrix,lt.spotShadowMap.value=Oe.state.spotShadowMap,lt.spotLightMatrix.value=Oe.state.spotLightMatrix,lt.spotLightMap.value=Oe.state.spotLightMap,lt.pointShadowMap.value=Oe.state.pointShadowMap,lt.pointShadowMatrix.value=Oe.state.pointShadowMatrix);const Bi=xt.getUniforms(),Ni=RM.seqWithValue(Bi.seq,lt);return _e.currentProgram=xt,_e.uniformsList=Ni,xt}function Xe($,we){const Re=Ie.get($);Re.outputColorSpace=we.outputColorSpace,Re.instancing=we.instancing,Re.skinning=we.skinning,Re.morphTargets=we.morphTargets,Re.morphNormals=we.morphNormals,Re.morphColors=we.morphColors,Re.morphTargetsCount=we.morphTargetsCount,Re.numClippingPlanes=we.numClippingPlanes,Re.numIntersection=we.numClipIntersection,Re.vertexAlphas=we.vertexAlphas,Re.vertexTangents=we.vertexTangents,Re.toneMapping=we.toneMapping}function De($,we,Re,_e,Oe){we.isScene!==!0&&(we=ge),Ge.resetTextureUnits();const et=we.fog,vt=_e.isMeshStandardMaterial?we.environment:null,St=E===null?x.outputColorSpace:E.isXRRenderTarget===!0?E.texture.colorSpace:zl,Tt=(_e.isMeshStandardMaterial?at:tt).get(_e.envMap||vt),Ht=_e.vertexColors===!0&&!!Re.attributes.color&&Re.attributes.color.itemSize===4,xt=!!Re.attributes.tangent&&(!!_e.normalMap||_e.anisotropy>0),lt=!!Re.morphAttributes.position,Bi=!!Re.morphAttributes.normal,Ni=!!Re.morphAttributes.color,Gn=_e.toneMapped?x.toneMapping:Ll,ns=Re.morphAttributes.position||Re.morphAttributes.normal||Re.morphAttributes.color,Ai=ns!==void 0?ns.length:0,Vt=Ie.get(_e),jt=v.state.lights;if(K===!0&&(re===!0||$!==T)){const rs=$===T&&_e.id===M;Ve.setState(_e,$,rs)}let Lt=!1;_e.version===Vt.__version?(Vt.needsLights&&Vt.lightsStateVersion!==jt.state.version||Vt.outputColorSpace!==St||Oe.isInstancedMesh&&Vt.instancing===!1||!Oe.isInstancedMesh&&Vt.instancing===!0||Oe.isSkinnedMesh&&Vt.skinning===!1||!Oe.isSkinnedMesh&&Vt.skinning===!0||Vt.envMap!==Tt||_e.fog===!0&&Vt.fog!==et||Vt.numClippingPlanes!==void 0&&(Vt.numClippingPlanes!==Ve.numPlanes||Vt.numIntersection!==Ve.numIntersection)||Vt.vertexAlphas!==Ht||Vt.vertexTangents!==xt||Vt.morphTargets!==lt||Vt.morphNormals!==Bi||Vt.morphColors!==Ni||Vt.toneMapping!==Gn||xe.isWebGL2===!0&&Vt.morphTargetsCount!==Ai)&&(Lt=!0):(Lt=!0,Vt.__version=_e.version);let $n=Vt.currentProgram;Lt===!0&&($n=Le(_e,we,Oe));let Mi=!1,un=!1,To=!1;const rn=$n.getUniforms(),Tn=Vt.uniforms;if(Ce.useProgram($n.program)&&(Mi=!0,un=!0,To=!0),_e.id!==M&&(M=_e.id,un=!0),Mi||T!==$){if(rn.setValue(Y,"projectionMatrix",$.projectionMatrix),xe.logarithmicDepthBuffer&&rn.setValue(Y,"logDepthBufFC",2/(Math.log($.far+1)/Math.LN2)),T!==$&&(T=$,un=!0,To=!0),_e.isShaderMaterial||_e.isMeshPhongMaterial||_e.isMeshToonMaterial||_e.isMeshStandardMaterial||_e.envMap){const rs=rn.map.cameraPosition;rs!==void 0&&rs.setValue(Y,fe.setFromMatrixPosition($.matrixWorld))}(_e.isMeshPhongMaterial||_e.isMeshToonMaterial||_e.isMeshLambertMaterial||_e.isMeshBasicMaterial||_e.isMeshStandardMaterial||_e.isShaderMaterial)&&rn.setValue(Y,"isOrthographic",$.isOrthographicCamera===!0),(_e.isMeshPhongMaterial||_e.isMeshToonMaterial||_e.isMeshLambertMaterial||_e.isMeshBasicMaterial||_e.isMeshStandardMaterial||_e.isShaderMaterial||_e.isShadowMaterial||Oe.isSkinnedMesh)&&rn.setValue(Y,"viewMatrix",$.matrixWorldInverse)}if(Oe.isSkinnedMesh){rn.setOptional(Y,Oe,"bindMatrix"),rn.setOptional(Y,Oe,"bindMatrixInverse");const rs=Oe.skeleton;rs&&(xe.floatVertexTextures?(rs.boneTexture===null&&rs.computeBoneTexture(),rn.setValue(Y,"boneTexture",rs.boneTexture,Ge),rn.setValue(Y,"boneTextureSize",rs.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const _h=Re.morphAttributes;if((_h.position!==void 0||_h.normal!==void 0||_h.color!==void 0&&xe.isWebGL2===!0)&&ne.update(Oe,Re,$n),(un||Vt.receiveShadow!==Oe.receiveShadow)&&(Vt.receiveShadow=Oe.receiveShadow,rn.setValue(Y,"receiveShadow",Oe.receiveShadow)),_e.isMeshGouraudMaterial&&_e.envMap!==null&&(Tn.envMap.value=Tt,Tn.flipEnvMap.value=Tt.isCubeTexture&&Tt.isRenderTargetTexture===!1?-1:1),un&&(rn.setValue(Y,"toneMappingExposure",x.toneMappingExposure),Vt.needsLights&&Ye(Tn,To),et&&_e.fog===!0&&Ee.refreshFogUniforms(Tn,et),Ee.refreshMaterialUniforms(Tn,_e,X,Q,J),RM.upload(Y,Vt.uniformsList,Tn,Ge)),_e.isShaderMaterial&&_e.uniformsNeedUpdate===!0&&(RM.upload(Y,Vt.uniformsList,Tn,Ge),_e.uniformsNeedUpdate=!1),_e.isSpriteMaterial&&rn.setValue(Y,"center",Oe.center),rn.setValue(Y,"modelViewMatrix",Oe.modelViewMatrix),rn.setValue(Y,"normalMatrix",Oe.normalMatrix),rn.setValue(Y,"modelMatrix",Oe.matrixWorld),_e.isShaderMaterial||_e.isRawShaderMaterial){const rs=_e.uniformsGroups;for(let Cm=0,Pm=rs.length;Cm<Pm;Cm++)if(xe.isWebGL2){const Ay=rs[Cm];ut.update(Ay,$n),ut.bind(Ay,$n)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return $n}function Ye($,we){$.ambientLightColor.needsUpdate=we,$.lightProbe.needsUpdate=we,$.directionalLights.needsUpdate=we,$.directionalLightShadows.needsUpdate=we,$.pointLights.needsUpdate=we,$.pointLightShadows.needsUpdate=we,$.spotLights.needsUpdate=we,$.spotLightShadows.needsUpdate=we,$.rectAreaLights.needsUpdate=we,$.hemisphereLights.needsUpdate=we}function bt($){return $.isMeshLambertMaterial||$.isMeshToonMaterial||$.isMeshPhongMaterial||$.isMeshStandardMaterial||$.isShadowMaterial||$.isShaderMaterial&&$.lights===!0}this.getActiveCubeFace=function(){return S},this.getActiveMipmapLevel=function(){return A},this.getRenderTarget=function(){return E},this.setRenderTargetTextures=function($,we,Re){Ie.get($.texture).__webglTexture=we,Ie.get($.depthTexture).__webglTexture=Re;const _e=Ie.get($);_e.__hasExternalTextures=!0,_e.__hasExternalTextures&&(_e.__autoAllocateDepthBuffer=Re===void 0,_e.__autoAllocateDepthBuffer||de.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),_e.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function($,we){const Re=Ie.get($);Re.__webglFramebuffer=we,Re.__useDefaultFramebuffer=we===void 0},this.setRenderTarget=function($,we=0,Re=0){E=$,S=we,A=Re;let _e=!0,Oe=null,et=!1,vt=!1;if($){const Tt=Ie.get($);Tt.__useDefaultFramebuffer!==void 0?(Ce.bindFramebuffer(Y.FRAMEBUFFER,null),_e=!1):Tt.__webglFramebuffer===void 0?Ge.setupRenderTarget($):Tt.__hasExternalTextures&&Ge.rebindTextures($,Ie.get($.texture).__webglTexture,Ie.get($.depthTexture).__webglTexture);const Ht=$.texture;(Ht.isData3DTexture||Ht.isDataArrayTexture||Ht.isCompressedArrayTexture)&&(vt=!0);const xt=Ie.get($).__webglFramebuffer;$.isWebGLCubeRenderTarget?(Oe=xt[we],et=!0):xe.isWebGL2&&$.samples>0&&Ge.useMultisampledRTT($)===!1?Oe=Ie.get($).__webglMultisampledFramebuffer:Oe=xt,P.copy($.viewport),R.copy($.scissor),U=$.scissorTest}else P.copy(z).multiplyScalar(X).floor(),R.copy(k).multiplyScalar(X).floor(),U=G;if(Ce.bindFramebuffer(Y.FRAMEBUFFER,Oe)&&xe.drawBuffers&&_e&&Ce.drawBuffers($,Oe),Ce.viewport(P),Ce.scissor(R),Ce.setScissorTest(U),et){const Tt=Ie.get($.texture);Y.framebufferTexture2D(Y.FRAMEBUFFER,Y.COLOR_ATTACHMENT0,Y.TEXTURE_CUBE_MAP_POSITIVE_X+we,Tt.__webglTexture,Re)}else if(vt){const Tt=Ie.get($.texture),Ht=we||0;Y.framebufferTextureLayer(Y.FRAMEBUFFER,Y.COLOR_ATTACHMENT0,Tt.__webglTexture,Re||0,Ht)}M=-1},this.readRenderTargetPixels=function($,we,Re,_e,Oe,et,vt){if(!($&&$.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let St=Ie.get($).__webglFramebuffer;if($.isWebGLCubeRenderTarget&&vt!==void 0&&(St=St[vt]),St){Ce.bindFramebuffer(Y.FRAMEBUFFER,St);try{const Tt=$.texture,Ht=Tt.format,xt=Tt.type;if(Ht!==no&&Ue.convert(Ht)!==Y.getParameter(Y.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const lt=xt===f0&&(de.has("EXT_color_buffer_half_float")||xe.isWebGL2&&de.has("EXT_color_buffer_float"));if(xt!==Nc&&Ue.convert(xt)!==Y.getParameter(Y.IMPLEMENTATION_COLOR_READ_TYPE)&&!(xt===Dc&&(xe.isWebGL2||de.has("OES_texture_float")||de.has("WEBGL_color_buffer_float")))&&!lt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}we>=0&&we<=$.width-_e&&Re>=0&&Re<=$.height-Oe&&Y.readPixels(we,Re,_e,Oe,Ue.convert(Ht),Ue.convert(xt),et)}finally{const Tt=E!==null?Ie.get(E).__webglFramebuffer:null;Ce.bindFramebuffer(Y.FRAMEBUFFER,Tt)}}},this.copyFramebufferToTexture=function($,we,Re=0){const _e=Math.pow(2,-Re),Oe=Math.floor(we.image.width*_e),et=Math.floor(we.image.height*_e);Ge.setTexture2D(we,0),Y.copyTexSubImage2D(Y.TEXTURE_2D,Re,0,0,$.x,$.y,Oe,et),Ce.unbindTexture()},this.copyTextureToTexture=function($,we,Re,_e=0){const Oe=we.image.width,et=we.image.height,vt=Ue.convert(Re.format),St=Ue.convert(Re.type);Ge.setTexture2D(Re,0),Y.pixelStorei(Y.UNPACK_FLIP_Y_WEBGL,Re.flipY),Y.pixelStorei(Y.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Re.premultiplyAlpha),Y.pixelStorei(Y.UNPACK_ALIGNMENT,Re.unpackAlignment),we.isDataTexture?Y.texSubImage2D(Y.TEXTURE_2D,_e,$.x,$.y,Oe,et,vt,St,we.image.data):we.isCompressedTexture?Y.compressedTexSubImage2D(Y.TEXTURE_2D,_e,$.x,$.y,we.mipmaps[0].width,we.mipmaps[0].height,vt,we.mipmaps[0].data):Y.texSubImage2D(Y.TEXTURE_2D,_e,$.x,$.y,vt,St,we.image),_e===0&&Re.generateMipmaps&&Y.generateMipmap(Y.TEXTURE_2D),Ce.unbindTexture()},this.copyTextureToTexture3D=function($,we,Re,_e,Oe=0){if(x.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const et=$.max.x-$.min.x+1,vt=$.max.y-$.min.y+1,St=$.max.z-$.min.z+1,Tt=Ue.convert(_e.format),Ht=Ue.convert(_e.type);let xt;if(_e.isData3DTexture)Ge.setTexture3D(_e,0),xt=Y.TEXTURE_3D;else if(_e.isDataArrayTexture)Ge.setTexture2DArray(_e,0),xt=Y.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Y.pixelStorei(Y.UNPACK_FLIP_Y_WEBGL,_e.flipY),Y.pixelStorei(Y.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_e.premultiplyAlpha),Y.pixelStorei(Y.UNPACK_ALIGNMENT,_e.unpackAlignment);const lt=Y.getParameter(Y.UNPACK_ROW_LENGTH),Bi=Y.getParameter(Y.UNPACK_IMAGE_HEIGHT),Ni=Y.getParameter(Y.UNPACK_SKIP_PIXELS),Gn=Y.getParameter(Y.UNPACK_SKIP_ROWS),ns=Y.getParameter(Y.UNPACK_SKIP_IMAGES),Ai=Re.isCompressedTexture?Re.mipmaps[0]:Re.image;Y.pixelStorei(Y.UNPACK_ROW_LENGTH,Ai.width),Y.pixelStorei(Y.UNPACK_IMAGE_HEIGHT,Ai.height),Y.pixelStorei(Y.UNPACK_SKIP_PIXELS,$.min.x),Y.pixelStorei(Y.UNPACK_SKIP_ROWS,$.min.y),Y.pixelStorei(Y.UNPACK_SKIP_IMAGES,$.min.z),Re.isDataTexture||Re.isData3DTexture?Y.texSubImage3D(xt,Oe,we.x,we.y,we.z,et,vt,St,Tt,Ht,Ai.data):Re.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Y.compressedTexSubImage3D(xt,Oe,we.x,we.y,we.z,et,vt,St,Tt,Ai.data)):Y.texSubImage3D(xt,Oe,we.x,we.y,we.z,et,vt,St,Tt,Ht,Ai),Y.pixelStorei(Y.UNPACK_ROW_LENGTH,lt),Y.pixelStorei(Y.UNPACK_IMAGE_HEIGHT,Bi),Y.pixelStorei(Y.UNPACK_SKIP_PIXELS,Ni),Y.pixelStorei(Y.UNPACK_SKIP_ROWS,Gn),Y.pixelStorei(Y.UNPACK_SKIP_IMAGES,ns),Oe===0&&_e.generateMipmaps&&Y.generateMipmap(xt),Ce.unbindTexture()},this.initTexture=function($){$.isCubeTexture?Ge.setTextureCube($,0):$.isData3DTexture?Ge.setTexture3D($,0):$.isDataArrayTexture||$.isCompressedArrayTexture?Ge.setTexture2DArray($,0):Ge.setTexture2D($,0),Ce.unbindTexture()},this.resetState=function(){S=0,A=0,E=null,Ce.reset(),Je.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Rc}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===ni?Rd:MN}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Rd?ni:zl}}class aK extends NN{}aK.prototype.isWebGL1Renderer=!0;class mC{constructor(e,i=25e-5){this.isFogExp2=!0,this.name="",this.color=new ht(e),this.density=i}clone(){return new mC(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class gC{constructor(e,i=1,n=1e3){this.isFog=!0,this.name="",this.color=new ht(e),this.near=i,this.far=n}clone(){return new gC(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class TE extends Si{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,i){return super.copy(e,i),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const i=super.toJSON(e);return this.fog!==null&&(i.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(i.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(i.object.backgroundIntensity=this.backgroundIntensity),i}}class mw{constructor(e,i){this.isInterleavedBuffer=!0,this.array=e,this.stride=i,this.count=e!==void 0?e.length/i:0,this.usage=__,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Zo()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,i,n){e*=this.stride,n*=i.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=i.array[n+r];return this}set(e,i=0){return this.array.set(e,i),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Zo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const i=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(i,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Zo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Ps=new te;class Qd{constructor(e,i,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=i,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let i=0,n=this.data.count;i<n;i++)Ps.fromBufferAttribute(this,i),Ps.applyMatrix4(e),this.setXYZ(i,Ps.x,Ps.y,Ps.z);return this}applyNormalMatrix(e){for(let i=0,n=this.count;i<n;i++)Ps.fromBufferAttribute(this,i),Ps.applyNormalMatrix(e),this.setXYZ(i,Ps.x,Ps.y,Ps.z);return this}transformDirection(e){for(let i=0,n=this.count;i<n;i++)Ps.fromBufferAttribute(this,i),Ps.transformDirection(e),this.setXYZ(i,Ps.x,Ps.y,Ps.z);return this}setX(e,i){return this.normalized&&(i=ui(i,this.array)),this.data.array[e*this.data.stride+this.offset]=i,this}setY(e,i){return this.normalized&&(i=ui(i,this.array)),this.data.array[e*this.data.stride+this.offset+1]=i,this}setZ(e,i){return this.normalized&&(i=ui(i,this.array)),this.data.array[e*this.data.stride+this.offset+2]=i,this}setW(e,i){return this.normalized&&(i=ui(i,this.array)),this.data.array[e*this.data.stride+this.offset+3]=i,this}getX(e){let i=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(i=Vo(i,this.array)),i}getY(e){let i=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(i=Vo(i,this.array)),i}getZ(e){let i=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(i=Vo(i,this.array)),i}getW(e){let i=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(i=Vo(i,this.array)),i}setXY(e,i,n){return e=e*this.data.stride+this.offset,this.normalized&&(i=ui(i,this.array),n=ui(n,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=n,this}setXYZ(e,i,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(i=ui(i,this.array),n=ui(n,this.array),r=ui(r,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,i,n,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(i=ui(i,this.array),n=ui(n,this.array),r=ui(r,this.array),s=ui(s,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const i=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)i.push(this.data.array[r+s])}return new Ri(new this.array.constructor(i),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Qd(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const i=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)i.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:i,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class UN extends dr{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new ht(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let sg;const ix=new te,og=new te,ag=new te,lg=new Qe,nx=new Qe,lK=new Wt,xS=new te,rx=new te,_S=new te,p5=new Qe,_D=new Qe,m5=new Qe;class cK extends Si{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",sg===void 0){sg=new si;const i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new mw(i,5);sg.setIndex([0,1,2,0,2,3]),sg.setAttribute("position",new Qd(n,3,0,!1)),sg.setAttribute("uv",new Qd(n,2,3,!1))}this.geometry=sg,this.material=e!==void 0?e:new UN,this.center=new Qe(.5,.5)}raycast(e,i){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),og.setFromMatrixScale(this.matrixWorld),lK.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ag.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&og.multiplyScalar(-ag.z);const n=this.material.rotation;let r,s;n!==0&&(s=Math.cos(n),r=Math.sin(n));const o=this.center;wS(xS.set(-.5,-.5,0),ag,o,og,r,s),wS(rx.set(.5,-.5,0),ag,o,og,r,s),wS(_S.set(.5,.5,0),ag,o,og,r,s),p5.set(0,0),_D.set(1,0),m5.set(1,1);let a=e.ray.intersectTriangle(xS,rx,_S,!1,ix);if(a===null&&(wS(rx.set(-.5,.5,0),ag,o,og,r,s),_D.set(0,1),a=e.ray.intersectTriangle(xS,_S,rx,!1,ix),a===null))return;const l=e.ray.origin.distanceTo(ix);l<e.near||l>e.far||i.push({distance:l,point:ix.clone(),uv:to.getInterpolation(ix,xS,rx,_S,p5,_D,m5,new Qe),face:null,object:this})}copy(e,i){return super.copy(e,i),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function wS(t,e,i,n,r,s){lg.subVectors(t,i).addScalar(.5).multiply(n),r!==void 0?(nx.x=s*lg.x-r*lg.y,nx.y=r*lg.x+s*lg.y):nx.copy(lg),t.copy(e),t.x+=nx.x,t.y+=nx.y,t.applyMatrix4(lK)}const bS=new te,g5=new te;class uK extends Si{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const i=e.levels;for(let n=0,r=i.length;n<r;n++){const s=i[n];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,i=0,n=0){i=Math.abs(i);const r=this.levels;let s;for(s=0;s<r.length&&!(i<r[s].distance);s++);return r.splice(s,0,{distance:i,hysteresis:n,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const i=this.levels;if(i.length>0){let n,r;for(n=1,r=i.length;n<r;n++){let s=i[n].distance;if(i[n].object.visible&&(s-=s*i[n].hysteresis),e<s)break}return i[n-1].object}return null}raycast(e,i){if(this.levels.length>0){bS.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(bS);this.getObjectForDistance(r).raycast(e,i)}}update(e){const i=this.levels;if(i.length>1){bS.setFromMatrixPosition(e.matrixWorld),g5.setFromMatrixPosition(this.matrixWorld);const n=bS.distanceTo(g5)/e.zoom;i[0].object.visible=!0;let r,s;for(r=1,s=i.length;r<s;r++){let o=i[r].distance;if(i[r].object.visible&&(o-=o*i[r].hysteresis),n>=o)i[r-1].object.visible=!1,i[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)i[r].object.visible=!1}}toJSON(e){const i=super.toJSON(e);this.autoUpdate===!1&&(i.object.autoUpdate=!1),i.object.levels=[];const n=this.levels;for(let r=0,s=n.length;r<s;r++){const o=n[r];i.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return i}}const v5=new te,y5=new zi,x5=new zi,spe=new te,_5=new Wt,cg=new te,wD=new nl,w5=new Wt,bD=new ty;class kN extends Ur{constructor(e,i){super(e,i),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Wt,this.bindMatrixInverse=new Wt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new jl),this.boundingBox.makeEmpty();const i=e.getAttribute("position");for(let n=0;n<i.count;n++)cg.fromBufferAttribute(i,n),this.applyBoneTransform(n,cg),this.boundingBox.expandByPoint(cg)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new nl),this.boundingSphere.makeEmpty();const i=e.getAttribute("position");for(let n=0;n<i.count;n++)cg.fromBufferAttribute(i,n),this.applyBoneTransform(n,cg),this.boundingSphere.expandByPoint(cg)}copy(e,i){return super.copy(e,i),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,i){const n=this.material,r=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),wD.copy(this.boundingSphere),wD.applyMatrix4(r),e.ray.intersectsSphere(wD)!==!1&&(w5.copy(r).invert(),bD.copy(e.ray).applyMatrix4(w5),!(this.boundingBox!==null&&bD.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,i,bD)))}getVertexPosition(e,i){return super.getVertexPosition(e,i),this.applyBoneTransform(e,i),i}bind(e,i){this.skeleton=e,i===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),i=this.matrixWorld),this.bindMatrix.copy(i),this.bindMatrixInverse.copy(i).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new zi,i=this.geometry.attributes.skinWeight;for(let n=0,r=i.count;n<r;n++){e.fromBufferAttribute(i,n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),i.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,i){const n=this.skeleton,r=this.geometry;y5.fromBufferAttribute(r.attributes.skinIndex,e),x5.fromBufferAttribute(r.attributes.skinWeight,e),v5.copy(i).applyMatrix4(this.bindMatrix),i.set(0,0,0);for(let s=0;s<4;s++){const o=x5.getComponent(s);if(o!==0){const a=y5.getComponent(s);_5.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),i.addScaledVector(spe.copy(v5).applyMatrix4(_5),o)}}return i.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,i){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,i)}}class vC extends Si{constructor(){super(),this.isBone=!0,this.type="Bone"}}class kv extends pn{constructor(e=null,i=1,n=1,r,s,o,a,l,c=Ln,h=Ln,u,d){super(null,o,a,l,c,h,r,s,u,d),this.isDataTexture=!0,this.image={data:e,width:i,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const b5=new Wt,ope=new Wt;class gw{constructor(e=[],i=[]){this.uuid=Zo(),this.bones=e.slice(0),this.boneInverses=i,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const e=this.bones,i=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),i.length===0)this.calculateInverses();else if(e.length!==i.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Wt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,i=this.bones.length;e<i;e++){const n=new Wt;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,i=this.bones.length;e<i;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,i=this.bones.length;e<i;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,i=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:ope;b5.multiplyMatrices(a,i[s]),b5.toArray(n,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new gw(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=qQ(e),e=Math.max(e,4);const i=new Float32Array(e*e*4);i.set(this.boneMatrices);const n=new kv(i,e,e,no,Dc);return n.needsUpdate=!0,this.boneMatrices=i,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let i=0,n=this.bones.length;i<n;i++){const r=this.bones[i];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,i){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const s=e.bones[n];let o=i[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new vC),this.bones.push(o),this.boneInverses.push(new Wt().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const i=this.bones,n=this.boneInverses;for(let r=0,s=i.length;r<s;r++){const o=i[r];e.bones.push(o.uuid);const a=n[r];e.boneInverses.push(a.toArray())}return e}}class v0 extends Ri{constructor(e,i,n,r=1){super(e,i,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const ug=new Wt,S5=new Wt,SS=[],A5=new jl,ape=new Wt,sx=new Ur,ox=new nl;class zN extends Ur{constructor(e,i,n){super(e,i),this.isInstancedMesh=!0,this.instanceMatrix=new v0(new Float32Array(n*16),16),this.instanceColor=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,ape)}computeBoundingBox(){const e=this.geometry,i=this.count;this.boundingBox===null&&(this.boundingBox=new jl),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<i;n++)this.getMatrixAt(n,ug),A5.copy(e.boundingBox).applyMatrix4(ug),this.boundingBox.union(A5)}computeBoundingSphere(){const e=this.geometry,i=this.count;this.boundingSphere===null&&(this.boundingSphere=new nl),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<i;n++)this.getMatrixAt(n,ug),ox.copy(e.boundingSphere).applyMatrix4(ug),this.boundingSphere.union(ox)}copy(e,i){return super.copy(e,i),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,i){i.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,i){i.fromArray(this.instanceMatrix.array,e*16)}raycast(e,i){const n=this.matrixWorld,r=this.count;if(sx.geometry=this.geometry,sx.material=this.material,sx.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),ox.copy(this.boundingSphere),ox.applyMatrix4(n),e.ray.intersectsSphere(ox)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,ug),S5.multiplyMatrices(n,ug),sx.matrixWorld=S5,sx.raycast(e,SS);for(let o=0,a=SS.length;o<a;o++){const l=SS[o];l.instanceId=s,l.object=this,i.push(l)}SS.length=0}}setColorAt(e,i){this.instanceColor===null&&(this.instanceColor=new v0(new Float32Array(this.instanceMatrix.count*3),3)),i.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,i){i.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Ms extends dr{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new ht(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const M5=new te,E5=new te,T5=new Wt,SD=new ty,AS=new nl;class ch extends Si{constructor(e=new si,i=new Ms){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const i=e.attributes.position,n=[0];for(let r=1,s=i.count;r<s;r++)M5.fromBufferAttribute(i,r-1),E5.fromBufferAttribute(i,r),n[r]=n[r-1],n[r]+=M5.distanceTo(E5);e.setAttribute("lineDistance",new At(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,i){const n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),AS.copy(n.boundingSphere),AS.applyMatrix4(r),AS.radius+=s,e.ray.intersectsSphere(AS)===!1)return;T5.copy(r).invert(),SD.copy(e.ray).applyMatrix4(T5);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new te,h=new te,u=new te,d=new te,f=this.isLineSegments?2:1,p=n.index,v=n.attributes.position;if(p!==null){const g=Math.max(0,o.start),y=Math.min(p.count,o.start+o.count);for(let x=g,b=y-1;x<b;x+=f){const S=p.getX(x),A=p.getX(x+1);if(c.fromBufferAttribute(v,S),h.fromBufferAttribute(v,A),SD.distanceSqToSegment(c,h,d,u)>l)continue;d.applyMatrix4(this.matrixWorld);const M=e.ray.origin.distanceTo(d);M<e.near||M>e.far||i.push({distance:M,point:u.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}else{const g=Math.max(0,o.start),y=Math.min(v.count,o.start+o.count);for(let x=g,b=y-1;x<b;x+=f){if(c.fromBufferAttribute(v,x),h.fromBufferAttribute(v,x+1),SD.distanceSqToSegment(c,h,d,u)>l)continue;d.applyMatrix4(this.matrixWorld);const A=e.ray.origin.distanceTo(d);A<e.near||A>e.far||i.push({distance:A,point:u.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const i=this.geometry.morphAttributes,n=Object.keys(i);if(n.length>0){const r=i[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const C5=new te,P5=new te;class Wl extends ch{constructor(e,i){super(e,i),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const i=e.attributes.position,n=[];for(let r=0,s=i.count;r<s;r+=2)C5.fromBufferAttribute(i,r),P5.fromBufferAttribute(i,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+C5.distanceTo(P5);e.setAttribute("lineDistance",new At(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class GN extends ch{constructor(e,i){super(e,i),this.isLineLoop=!0,this.type="LineLoop"}}class yC extends dr{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new ht(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const D5=new Wt,kL=new ty,MS=new nl,ES=new te;class HN extends Si{constructor(e=new si,i=new yC){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),this.material=e.material,this.geometry=e.geometry,this}raycast(e,i){const n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),MS.copy(n.boundingSphere),MS.applyMatrix4(r),MS.radius+=s,e.ray.intersectsSphere(MS)===!1)return;D5.copy(r).invert(),kL.copy(e.ray).applyMatrix4(D5);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=n.index,u=n.attributes.position;if(c!==null){const d=Math.max(0,o.start),f=Math.min(c.count,o.start+o.count);for(let p=d,m=f;p<m;p++){const v=c.getX(p);ES.fromBufferAttribute(u,v),R5(ES,v,l,r,e,i,this)}}else{const d=Math.max(0,o.start),f=Math.min(u.count,o.start+o.count);for(let p=d,m=f;p<m;p++)ES.fromBufferAttribute(u,p),R5(ES,p,l,r,e,i,this)}}updateMorphTargets(){const i=this.geometry.morphAttributes,n=Object.keys(i);if(n.length>0){const r=i[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function R5(t,e,i,n,r,s,o){const a=kL.distanceSqToPoint(t);if(a<i){const l=new te;kL.closestPointToPoint(t,l),l.applyMatrix4(n);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class lpe extends pn{constructor(e,i,n,r,s,o,a,l,c){super(e,i,n,r,s,o,a,l,c),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:xn,this.magFilter=s!==void 0?s:xn,this.generateMipmaps=!1;const h=this;function u(){h.needsUpdate=!0,e.requestVideoFrameCallback(u)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(u)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class cpe extends pn{constructor(e,i){super({width:e,height:i}),this.isFramebufferTexture=!0,this.magFilter=Ln,this.minFilter=Ln,this.generateMipmaps=!1,this.needsUpdate=!0}}class VN extends pn{constructor(e,i,n,r,s,o,a,l,c,h,u,d){super(null,o,a,l,c,h,r,s,u,d),this.isCompressedTexture=!0,this.image={width:i,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class upe extends VN{constructor(e,i,n,r,s,o){super(e,i,n,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=Jr}}class hpe extends pn{constructor(e,i,n,r,s,o,a,l,c){super(e,i,n,r,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Xl{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,i){const n=this.getUtoTmapping(e);return this.getPoint(n,i)}getPoints(e=5){const i=[];for(let n=0;n<=e;n++)i.push(this.getPoint(n/e));return i}getSpacedPoints(e=5){const i=[];for(let n=0;n<=e;n++)i.push(this.getPointAt(n/e));return i}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const i=[];let n,r=this.getPoint(0),s=0;i.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),s+=n.distanceTo(r),i.push(s),r=n;return this.cacheArcLengths=i,i}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,i){const n=this.getLengths();let r=0;const s=n.length;let o;i?o=i:o=e*n[s-1];let a=0,l=s-1,c;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=n[r]-o,c<0)a=r+1;else if(c>0)l=r-1;else{l=r;break}if(r=l,n[r]===o)return r/(s-1);const h=n[r],d=n[r+1]-h,f=(o-h)/d;return(r+f)/(s-1)}getTangent(e,i){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=i||(o.isVector2?new Qe:new te);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,i){const n=this.getUtoTmapping(e);return this.getTangent(n,i)}computeFrenetFrames(e,i){const n=new te,r=[],s=[],o=[],a=new te,l=new Wt;for(let f=0;f<=e;f++){const p=f/e;r[f]=this.getTangentAt(p,new te)}s[0]=new te,o[0]=new te;let c=Number.MAX_VALUE;const h=Math.abs(r[0].x),u=Math.abs(r[0].y),d=Math.abs(r[0].z);h<=c&&(c=h,n.set(1,0,0)),u<=c&&(c=u,n.set(0,1,0)),d<=c&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();const p=Math.acos(Bn(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(l.makeRotationAxis(a,p))}o[f].crossVectors(r[f],s[f])}if(i===!0){let f=Math.acos(Bn(s[0].dot(s[e]),-1,1));f/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(f=-f);for(let p=1;p<=e;p++)s[p].applyMatrix4(l.makeRotationAxis(r[p],f*p)),o[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class xC extends Xl{constructor(e=0,i=0,n=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=i,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,i){const n=i||new Qe,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const h=Math.cos(this.aRotation),u=Math.sin(this.aRotation),d=l-this.aX,f=c-this.aY;l=d*h-f*u+this.aX,c=d*u+f*h+this.aY}return n.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class hK extends xC{constructor(e,i,n,r,s,o){super(e,i,n,n,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function jN(){let t=0,e=0,i=0,n=0;function r(s,o,a,l){t=s,e=a,i=-3*s+3*o-2*a-l,n=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,h,u){let d=(o-s)/c-(a-s)/(c+h)+(a-o)/h,f=(a-o)/h-(l-o)/(h+u)+(l-a)/u;d*=h,f*=h,r(o,a,d,f)},calc:function(s){const o=s*s,a=o*s;return t+e*s+i*o+n*a}}}const TS=new te,AD=new jN,MD=new jN,ED=new jN;class dK extends Xl{constructor(e=[],i=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=i,this.curveType=n,this.tension=r}getPoint(e,i=new te){const n=i,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let c,h;this.closed||a>0?c=r[(a-1)%s]:(TS.subVectors(r[0],r[1]).add(r[0]),c=TS);const u=r[a%s],d=r[(a+1)%s];if(this.closed||a+2<s?h=r[(a+2)%s]:(TS.subVectors(r[s-1],r[s-2]).add(r[s-1]),h=TS),this.curveType==="centripetal"||this.curveType==="chordal"){const f=this.curveType==="chordal"?.5:.25;let p=Math.pow(c.distanceToSquared(u),f),m=Math.pow(u.distanceToSquared(d),f),v=Math.pow(d.distanceToSquared(h),f);m<1e-4&&(m=1),p<1e-4&&(p=m),v<1e-4&&(v=m),AD.initNonuniformCatmullRom(c.x,u.x,d.x,h.x,p,m,v),MD.initNonuniformCatmullRom(c.y,u.y,d.y,h.y,p,m,v),ED.initNonuniformCatmullRom(c.z,u.z,d.z,h.z,p,m,v)}else this.curveType==="catmullrom"&&(AD.initCatmullRom(c.x,u.x,d.x,h.x,this.tension),MD.initCatmullRom(c.y,u.y,d.y,h.y,this.tension),ED.initCatmullRom(c.z,u.z,d.z,h.z,this.tension));return n.set(AD.calc(l),MD.calc(l),ED.calc(l)),n}copy(e){super.copy(e),this.points=[];for(let i=0,n=e.points.length;i<n;i++){const r=e.points[i];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let i=0,n=this.points.length;i<n;i++){const r=this.points[i];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let i=0,n=e.points.length;i<n;i++){const r=e.points[i];this.points.push(new te().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function I5(t,e,i,n,r){const s=(n-e)*.5,o=(r-i)*.5,a=t*t,l=t*a;return(2*i-2*n+s+o)*l+(-3*i+3*n-2*s-o)*a+s*t+i}function dpe(t,e){const i=1-t;return i*i*e}function fpe(t,e){return 2*(1-t)*t*e}function ppe(t,e){return t*t*e}function E1(t,e,i,n){return dpe(t,e)+fpe(t,i)+ppe(t,n)}function mpe(t,e){const i=1-t;return i*i*i*e}function gpe(t,e){const i=1-t;return 3*i*i*t*e}function vpe(t,e){return 3*(1-t)*t*t*e}function ype(t,e){return t*t*t*e}function T1(t,e,i,n,r){return mpe(t,e)+gpe(t,i)+vpe(t,n)+ype(t,r)}class WN extends Xl{constructor(e=new Qe,i=new Qe,n=new Qe,r=new Qe){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=i,this.v2=n,this.v3=r}getPoint(e,i=new Qe){const n=i,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(T1(e,r.x,s.x,o.x,a.x),T1(e,r.y,s.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class fK extends Xl{constructor(e=new te,i=new te,n=new te,r=new te){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=i,this.v2=n,this.v3=r}getPoint(e,i=new te){const n=i,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(T1(e,r.x,s.x,o.x,a.x),T1(e,r.y,s.y,o.y,a.y),T1(e,r.z,s.z,o.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class _C extends Xl{constructor(e=new Qe,i=new Qe){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=i}getPoint(e,i=new Qe){const n=i;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,i){return this.getPoint(e,i)}getTangent(e,i=new Qe){return i.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,i){return this.getTangent(e,i)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class pK extends Xl{constructor(e=new te,i=new te){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=i}getPoint(e,i=new te){const n=i;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,i){return this.getPoint(e,i)}getTangent(e,i=new te){return i.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,i){return this.getTangent(e,i)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class XN extends Xl{constructor(e=new Qe,i=new Qe,n=new Qe){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=i,this.v2=n}getPoint(e,i=new Qe){const n=i,r=this.v0,s=this.v1,o=this.v2;return n.set(E1(e,r.x,s.x,o.x),E1(e,r.y,s.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class qN extends Xl{constructor(e=new te,i=new te,n=new te){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=i,this.v2=n}getPoint(e,i=new te){const n=i,r=this.v0,s=this.v1,o=this.v2;return n.set(E1(e,r.x,s.x,o.x),E1(e,r.y,s.y,o.y),E1(e,r.z,s.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class YN extends Xl{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,i=new Qe){const n=i,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],c=r[o],h=r[o>r.length-2?r.length-1:o+1],u=r[o>r.length-3?r.length-1:o+2];return n.set(I5(a,l.x,c.x,h.x,u.x),I5(a,l.y,c.y,h.y,u.y)),n}copy(e){super.copy(e),this.points=[];for(let i=0,n=e.points.length;i<n;i++){const r=e.points[i];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let i=0,n=this.points.length;i<n;i++){const r=this.points[i];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let i=0,n=e.points.length;i<n;i++){const r=e.points[i];this.points.push(new Qe().fromArray(r))}return this}}var QN=Object.freeze({__proto__:null,ArcCurve:hK,CatmullRomCurve3:dK,CubicBezierCurve:WN,CubicBezierCurve3:fK,EllipseCurve:xC,LineCurve:_C,LineCurve3:pK,QuadraticBezierCurve:XN,QuadraticBezierCurve3:qN,SplineCurve:YN});class mK extends Xl{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);e.equals(i)||this.curves.push(new _C(i,e))}getPoint(e,i){const n=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=n){const o=r[s]-n,a=this.curves[s],l=a.getLength(),c=l===0?0:1-o/l;return a.getPointAt(c,i)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let i=0;for(let n=0,r=this.curves.length;n<r;n++)i+=this.curves[n].getLength(),e.push(i);return this.cacheLengths=e,e}getSpacedPoints(e=40){const i=[];for(let n=0;n<=e;n++)i.push(this.getPoint(n/e));return this.autoClose&&i.push(i[0]),i}getPoints(e=12){const i=[];let n;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let c=0;c<l.length;c++){const h=l[c];n&&n.equals(h)||(i.push(h),n=h)}}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i}copy(e){super.copy(e),this.curves=[];for(let i=0,n=e.curves.length;i<n;i++){const r=e.curves[i];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let i=0,n=this.curves.length;i<n;i++){const r=this.curves[i];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let i=0,n=e.curves.length;i<n;i++){const r=e.curves[i];this.curves.push(new QN[r.type]().fromJSON(r))}return this}}class S_ extends mK{constructor(e){super(),this.type="Path",this.currentPoint=new Qe,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let i=1,n=e.length;i<n;i++)this.lineTo(e[i].x,e[i].y);return this}moveTo(e,i){return this.currentPoint.set(e,i),this}lineTo(e,i){const n=new _C(this.currentPoint.clone(),new Qe(e,i));return this.curves.push(n),this.currentPoint.set(e,i),this}quadraticCurveTo(e,i,n,r){const s=new XN(this.currentPoint.clone(),new Qe(e,i),new Qe(n,r));return this.curves.push(s),this.currentPoint.set(n,r),this}bezierCurveTo(e,i,n,r,s,o){const a=new WN(this.currentPoint.clone(),new Qe(e,i),new Qe(n,r),new Qe(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const i=[this.currentPoint.clone()].concat(e),n=new YN(i);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,i,n,r,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,i+l,n,r,s,o),this}absarc(e,i,n,r,s,o){return this.absellipse(e,i,n,n,r,s,o),this}ellipse(e,i,n,r,s,o,a,l){const c=this.currentPoint.x,h=this.currentPoint.y;return this.absellipse(e+c,i+h,n,r,s,o,a,l),this}absellipse(e,i,n,r,s,o,a,l){const c=new xC(e,i,n,r,s,o,a,l);if(this.curves.length>0){const u=c.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(c);const h=c.getPoint(1);return this.currentPoint.copy(h),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class vw extends si{constructor(e=[new Qe(0,-.5),new Qe(.5,0),new Qe(0,.5)],i=12,n=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:i,phiStart:n,phiLength:r},i=Math.floor(i),r=Bn(r,0,Math.PI*2);const s=[],o=[],a=[],l=[],c=[],h=1/i,u=new te,d=new Qe,f=new te,p=new te,m=new te;let v=0,g=0;for(let y=0;y<=e.length-1;y++)switch(y){case 0:v=e[y+1].x-e[y].x,g=e[y+1].y-e[y].y,f.x=g*1,f.y=-v,f.z=g*0,m.copy(f),f.normalize(),l.push(f.x,f.y,f.z);break;case e.length-1:l.push(m.x,m.y,m.z);break;default:v=e[y+1].x-e[y].x,g=e[y+1].y-e[y].y,f.x=g*1,f.y=-v,f.z=g*0,p.copy(f),f.x+=m.x,f.y+=m.y,f.z+=m.z,f.normalize(),l.push(f.x,f.y,f.z),m.copy(p)}for(let y=0;y<=i;y++){const x=n+y*h*r,b=Math.sin(x),S=Math.cos(x);for(let A=0;A<=e.length-1;A++){u.x=e[A].x*b,u.y=e[A].y,u.z=e[A].x*S,o.push(u.x,u.y,u.z),d.x=y/i,d.y=A/(e.length-1),a.push(d.x,d.y);const E=l[3*A+0]*b,M=l[3*A+1],T=l[3*A+0]*S;c.push(E,M,T)}}for(let y=0;y<i;y++)for(let x=0;x<e.length-1;x++){const b=x+y*e.length,S=b,A=b+e.length,E=b+e.length+1,M=b+1;s.push(S,A,M),s.push(E,M,A)}this.setIndex(s),this.setAttribute("position",new At(o,3)),this.setAttribute("uv",new At(a,2)),this.setAttribute("normal",new At(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new vw(e.points,e.segments,e.phiStart,e.phiLength)}}class wC extends vw{constructor(e=1,i=1,n=4,r=8){const s=new S_;s.absarc(0,-i/2,e,Math.PI*1.5,0),s.absarc(0,i/2,e,0,Math.PI*.5),super(s.getPoints(n),r),this.type="CapsuleGeometry",this.parameters={radius:e,height:i,capSegments:n,radialSegments:r}}static fromJSON(e){return new wC(e.radius,e.length,e.capSegments,e.radialSegments)}}class bC extends si{constructor(e=1,i=32,n=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:i,thetaStart:n,thetaLength:r},i=Math.max(3,i);const s=[],o=[],a=[],l=[],c=new te,h=new Qe;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let u=0,d=3;u<=i;u++,d+=3){const f=n+u/i*r;c.x=e*Math.cos(f),c.y=e*Math.sin(f),o.push(c.x,c.y,c.z),a.push(0,0,1),h.x=(o[d]/e+1)/2,h.y=(o[d+1]/e+1)/2,l.push(h.x,h.y)}for(let u=1;u<=i;u++)s.push(u,u+1,0);this.setIndex(s),this.setAttribute("position",new At(o,3)),this.setAttribute("normal",new At(a,3)),this.setAttribute("uv",new At(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new bC(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class ny extends si{constructor(e=1,i=1,n=1,r=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:i,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const h=[],u=[],d=[],f=[];let p=0;const m=[],v=n/2;let g=0;y(),o===!1&&(e>0&&x(!0),i>0&&x(!1)),this.setIndex(h),this.setAttribute("position",new At(u,3)),this.setAttribute("normal",new At(d,3)),this.setAttribute("uv",new At(f,2));function y(){const b=new te,S=new te;let A=0;const E=(i-e)/n;for(let M=0;M<=s;M++){const T=[],P=M/s,R=P*(i-e)+e;for(let U=0;U<=r;U++){const F=U/r,N=F*l+a,W=Math.sin(N),Q=Math.cos(N);S.x=R*W,S.y=-P*n+v,S.z=R*Q,u.push(S.x,S.y,S.z),b.set(W,E,Q).normalize(),d.push(b.x,b.y,b.z),f.push(F,1-P),T.push(p++)}m.push(T)}for(let M=0;M<r;M++)for(let T=0;T<s;T++){const P=m[T][M],R=m[T+1][M],U=m[T+1][M+1],F=m[T][M+1];h.push(P,R,F),h.push(R,U,F),A+=6}c.addGroup(g,A,0),g+=A}function x(b){const S=p,A=new Qe,E=new te;let M=0;const T=b===!0?e:i,P=b===!0?1:-1;for(let U=1;U<=r;U++)u.push(0,v*P,0),d.push(0,P,0),f.push(.5,.5),p++;const R=p;for(let U=0;U<=r;U++){const N=U/r*l+a,W=Math.cos(N),Q=Math.sin(N);E.x=T*Q,E.y=v*P,E.z=T*W,u.push(E.x,E.y,E.z),d.push(0,P,0),A.x=W*.5+.5,A.y=Q*.5*P+.5,f.push(A.x,A.y),p++}for(let U=0;U<r;U++){const F=S+U,N=R+U;b===!0?h.push(N,N+1,F):h.push(N+1,N,F),M+=3}c.addGroup(g,M,b===!0?1:2),g+=M}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ny(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class SC extends ny{constructor(e=1,i=1,n=32,r=1,s=!1,o=0,a=Math.PI*2){super(0,e,i,n,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:i,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new SC(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class cf extends si{constructor(e=[],i=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:i,radius:n,detail:r};const s=[],o=[];a(r),c(n),h(),this.setAttribute("position",new At(s,3)),this.setAttribute("normal",new At(s.slice(),3)),this.setAttribute("uv",new At(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(y){const x=new te,b=new te,S=new te;for(let A=0;A<i.length;A+=3)f(i[A+0],x),f(i[A+1],b),f(i[A+2],S),l(x,b,S,y)}function l(y,x,b,S){const A=S+1,E=[];for(let M=0;M<=A;M++){E[M]=[];const T=y.clone().lerp(b,M/A),P=x.clone().lerp(b,M/A),R=A-M;for(let U=0;U<=R;U++)U===0&&M===A?E[M][U]=T:E[M][U]=T.clone().lerp(P,U/R)}for(let M=0;M<A;M++)for(let T=0;T<2*(A-M)-1;T++){const P=Math.floor(T/2);T%2===0?(d(E[M][P+1]),d(E[M+1][P]),d(E[M][P])):(d(E[M][P+1]),d(E[M+1][P+1]),d(E[M+1][P]))}}function c(y){const x=new te;for(let b=0;b<s.length;b+=3)x.x=s[b+0],x.y=s[b+1],x.z=s[b+2],x.normalize().multiplyScalar(y),s[b+0]=x.x,s[b+1]=x.y,s[b+2]=x.z}function h(){const y=new te;for(let x=0;x<s.length;x+=3){y.x=s[x+0],y.y=s[x+1],y.z=s[x+2];const b=v(y)/2/Math.PI+.5,S=g(y)/Math.PI+.5;o.push(b,1-S)}p(),u()}function u(){for(let y=0;y<o.length;y+=6){const x=o[y+0],b=o[y+2],S=o[y+4],A=Math.max(x,b,S),E=Math.min(x,b,S);A>.9&&E<.1&&(x<.2&&(o[y+0]+=1),b<.2&&(o[y+2]+=1),S<.2&&(o[y+4]+=1))}}function d(y){s.push(y.x,y.y,y.z)}function f(y,x){const b=y*3;x.x=e[b+0],x.y=e[b+1],x.z=e[b+2]}function p(){const y=new te,x=new te,b=new te,S=new te,A=new Qe,E=new Qe,M=new Qe;for(let T=0,P=0;T<s.length;T+=9,P+=6){y.set(s[T+0],s[T+1],s[T+2]),x.set(s[T+3],s[T+4],s[T+5]),b.set(s[T+6],s[T+7],s[T+8]),A.set(o[P+0],o[P+1]),E.set(o[P+2],o[P+3]),M.set(o[P+4],o[P+5]),S.copy(y).add(x).add(b).divideScalar(3);const R=v(S);m(A,P+0,y,R),m(E,P+2,x,R),m(M,P+4,b,R)}}function m(y,x,b,S){S<0&&y.x===1&&(o[x]=y.x-1),b.x===0&&b.z===0&&(o[x]=S/2/Math.PI+.5)}function v(y){return Math.atan2(y.z,-y.x)}function g(y){return Math.atan2(-y.y,Math.sqrt(y.x*y.x+y.z*y.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cf(e.vertices,e.indices,e.radius,e.details)}}class AC extends cf{constructor(e=1,i=0){const n=(1+Math.sqrt(5))/2,r=1/n,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,i),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new AC(e.radius,e.detail)}}const CS=new te,PS=new te,TD=new te,DS=new to;class gK extends si{constructor(e=null,i=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:i},e!==null){const r=Math.pow(10,4),s=Math.cos(Ip*i),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],h=["a","b","c"],u=new Array(3),d={},f=[];for(let p=0;p<l;p+=3){o?(c[0]=o.getX(p),c[1]=o.getX(p+1),c[2]=o.getX(p+2)):(c[0]=p,c[1]=p+1,c[2]=p+2);const{a:m,b:v,c:g}=DS;if(m.fromBufferAttribute(a,c[0]),v.fromBufferAttribute(a,c[1]),g.fromBufferAttribute(a,c[2]),DS.getNormal(TD),u[0]=`${Math.round(m.x*r)},${Math.round(m.y*r)},${Math.round(m.z*r)}`,u[1]=`${Math.round(v.x*r)},${Math.round(v.y*r)},${Math.round(v.z*r)}`,u[2]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,!(u[0]===u[1]||u[1]===u[2]||u[2]===u[0]))for(let y=0;y<3;y++){const x=(y+1)%3,b=u[y],S=u[x],A=DS[h[y]],E=DS[h[x]],M=`${b}_${S}`,T=`${S}_${b}`;T in d&&d[T]?(TD.dot(d[T].normal)<=s&&(f.push(A.x,A.y,A.z),f.push(E.x,E.y,E.z)),d[T]=null):M in d||(d[M]={index0:c[y],index1:c[x],normal:TD.clone()})}}for(const p in d)if(d[p]){const{index0:m,index1:v}=d[p];CS.fromBufferAttribute(a,m),PS.fromBufferAttribute(a,v),f.push(CS.x,CS.y,CS.z),f.push(PS.x,PS.y,PS.z)}this.setAttribute("position",new At(f,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Bp extends S_{constructor(e){super(e),this.uuid=Zo(),this.type="Shape",this.holes=[]}getPointsHoles(e){const i=[];for(let n=0,r=this.holes.length;n<r;n++)i[n]=this.holes[n].getPoints(e);return i}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let i=0,n=e.holes.length;i<n;i++){const r=e.holes[i];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let i=0,n=this.holes.length;i<n;i++){const r=this.holes[i];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let i=0,n=e.holes.length;i<n;i++){const r=e.holes[i];this.holes.push(new S_().fromJSON(r))}return this}}const xpe={triangulate:function(t,e,i=2){const n=e&&e.length,r=n?e[0]*i:t.length;let s=vK(t,0,r,i,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,h,u,d,f;if(n&&(s=Ape(t,e,s,i)),t.length>80*i){a=c=t[0],l=h=t[1];for(let p=i;p<r;p+=i)u=t[p],d=t[p+1],u<a&&(a=u),d<l&&(l=d),u>c&&(c=u),d>h&&(h=d);f=Math.max(c-a,h-l),f=f!==0?32767/f:0}return A_(s,o,i,a,l,f,0),o}};function vK(t,e,i,n,r){let s,o;if(r===Ope(t,e,i,n)>0)for(s=e;s<i;s+=n)o=L5(s,t[s],t[s+1],o);else for(s=i-n;s>=e;s-=n)o=L5(s,t[s],t[s+1],o);return o&&MC(o,o.next)&&(E_(o),o=o.next),o}function im(t,e){if(!t)return t;e||(e=t);let i=t,n;do if(n=!1,!i.steiner&&(MC(i,i.next)||_n(i.prev,i,i.next)===0)){if(E_(i),i=e=i.prev,i===i.next)break;n=!0}else i=i.next;while(n||i!==e);return e}function A_(t,e,i,n,r,s,o){if(!t)return;!o&&s&&Ppe(t,n,r,s);let a=t,l,c;for(;t.prev!==t.next;){if(l=t.prev,c=t.next,s?wpe(t,n,r,s):_pe(t)){e.push(l.i/i|0),e.push(t.i/i|0),e.push(c.i/i|0),E_(t),t=c.next,a=c.next;continue}if(t=c,t===a){o?o===1?(t=bpe(im(t),e,i),A_(t,e,i,n,r,s,2)):o===2&&Spe(t,e,i,n,r,s):A_(im(t),e,i,n,r,s,1);break}}}function _pe(t){const e=t.prev,i=t,n=t.next;if(_n(e,i,n)>=0)return!1;const r=e.x,s=i.x,o=n.x,a=e.y,l=i.y,c=n.y,h=r<s?r<o?r:o:s<o?s:o,u=a<l?a<c?a:c:l<c?l:c,d=r>s?r>o?r:o:s>o?s:o,f=a>l?a>c?a:c:l>c?l:c;let p=n.next;for(;p!==e;){if(p.x>=h&&p.x<=d&&p.y>=u&&p.y<=f&&fv(r,a,s,l,o,c,p.x,p.y)&&_n(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function wpe(t,e,i,n){const r=t.prev,s=t,o=t.next;if(_n(r,s,o)>=0)return!1;const a=r.x,l=s.x,c=o.x,h=r.y,u=s.y,d=o.y,f=a<l?a<c?a:c:l<c?l:c,p=h<u?h<d?h:d:u<d?u:d,m=a>l?a>c?a:c:l>c?l:c,v=h>u?h>d?h:d:u>d?u:d,g=zL(f,p,e,i,n),y=zL(m,v,e,i,n);let x=t.prevZ,b=t.nextZ;for(;x&&x.z>=g&&b&&b.z<=y;){if(x.x>=f&&x.x<=m&&x.y>=p&&x.y<=v&&x!==r&&x!==o&&fv(a,h,l,u,c,d,x.x,x.y)&&_n(x.prev,x,x.next)>=0||(x=x.prevZ,b.x>=f&&b.x<=m&&b.y>=p&&b.y<=v&&b!==r&&b!==o&&fv(a,h,l,u,c,d,b.x,b.y)&&_n(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;x&&x.z>=g;){if(x.x>=f&&x.x<=m&&x.y>=p&&x.y<=v&&x!==r&&x!==o&&fv(a,h,l,u,c,d,x.x,x.y)&&_n(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=y;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=v&&b!==r&&b!==o&&fv(a,h,l,u,c,d,b.x,b.y)&&_n(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function bpe(t,e,i){let n=t;do{const r=n.prev,s=n.next.next;!MC(r,s)&&yK(r,n,n.next,s)&&M_(r,s)&&M_(s,r)&&(e.push(r.i/i|0),e.push(n.i/i|0),e.push(s.i/i|0),E_(n),E_(n.next),n=t=s),n=n.next}while(n!==t);return im(n)}function Spe(t,e,i,n,r,s){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Ipe(o,a)){let l=xK(o,a);o=im(o,o.next),l=im(l,l.next),A_(o,e,i,n,r,s,0),A_(l,e,i,n,r,s,0);return}a=a.next}o=o.next}while(o!==t)}function Ape(t,e,i,n){const r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*n,l=s<o-1?e[s+1]*n:t.length,c=vK(t,a,l,n,!1),c===c.next&&(c.steiner=!0),r.push(Rpe(c));for(r.sort(Mpe),s=0;s<r.length;s++)i=Epe(r[s],i);return i}function Mpe(t,e){return t.x-e.x}function Epe(t,e){const i=Tpe(t,e);if(!i)return e;const n=xK(i,t);return im(n,n.next),im(i,i.next)}function Tpe(t,e){let i=e,n=-1/0,r;const s=t.x,o=t.y;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){const d=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(d<=s&&d>n&&(n=d,r=i.x<i.next.x?i:i.next,d===s))return r}i=i.next}while(i!==e);if(!r)return null;const a=r,l=r.x,c=r.y;let h=1/0,u;i=r;do s>=i.x&&i.x>=l&&s!==i.x&&fv(o<c?s:n,o,l,c,o<c?n:s,o,i.x,i.y)&&(u=Math.abs(o-i.y)/(s-i.x),M_(i,t)&&(u<h||u===h&&(i.x>r.x||i.x===r.x&&Cpe(r,i)))&&(r=i,h=u)),i=i.next;while(i!==a);return r}function Cpe(t,e){return _n(t.prev,t,e.prev)<0&&_n(e.next,t,t.next)<0}function Ppe(t,e,i,n){let r=t;do r.z===0&&(r.z=zL(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,Dpe(r)}function Dpe(t){let e,i,n,r,s,o,a,l,c=1;do{for(i=t,t=null,s=null,o=0;i;){for(o++,n=i,a=0,e=0;e<c&&(a++,n=n.nextZ,!!n);e++);for(l=c;a>0||l>0&&n;)a!==0&&(l===0||!n||i.z<=n.z)?(r=i,i=i.nextZ,a--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;i=n}s.nextZ=null,c*=2}while(o>1);return t}function zL(t,e,i,n,r){return t=(t-i)*r|0,e=(e-n)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function Rpe(t){let e=t,i=t;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==t);return i}function fv(t,e,i,n,r,s,o,a){return(r-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(n-a)>=(i-o)*(e-a)&&(i-o)*(s-a)>=(r-o)*(n-a)}function Ipe(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Lpe(t,e)&&(M_(t,e)&&M_(e,t)&&Bpe(t,e)&&(_n(t.prev,t,e.prev)||_n(t,e.prev,e))||MC(t,e)&&_n(t.prev,t,t.next)>0&&_n(e.prev,e,e.next)>0)}function _n(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function MC(t,e){return t.x===e.x&&t.y===e.y}function yK(t,e,i,n){const r=IS(_n(t,e,i)),s=IS(_n(t,e,n)),o=IS(_n(i,n,t)),a=IS(_n(i,n,e));return!!(r!==s&&o!==a||r===0&&RS(t,i,e)||s===0&&RS(t,n,e)||o===0&&RS(i,t,n)||a===0&&RS(i,e,n))}function RS(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function IS(t){return t>0?1:t<0?-1:0}function Lpe(t,e){let i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&yK(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function M_(t,e){return _n(t.prev,t,t.next)<0?_n(t,e,t.next)>=0&&_n(t,t.prev,e)>=0:_n(t,e,t.prev)<0||_n(t,t.next,e)<0}function Bpe(t,e){let i=t,n=!1;const r=(t.x+e.x)/2,s=(t.y+e.y)/2;do i.y>s!=i.next.y>s&&i.next.y!==i.y&&r<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next;while(i!==t);return n}function xK(t,e){const i=new GL(t.i,t.x,t.y),n=new GL(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,s.next=n,n.prev=s,n}function L5(t,e,i,n){const r=new GL(t,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function E_(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function GL(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ope(t,e,i,n){let r=0;for(let s=e,o=i-n;s<i;s+=n)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}class Uc{static area(e){const i=e.length;let n=0;for(let r=i-1,s=0;s<i;r=s++)n+=e[r].x*e[s].y-e[s].x*e[r].y;return n*.5}static isClockWise(e){return Uc.area(e)<0}static triangulateShape(e,i){const n=[],r=[],s=[];B5(e),O5(n,e);let o=e.length;i.forEach(B5);for(let l=0;l<i.length;l++)r.push(o),o+=i[l].length,O5(n,i[l]);const a=xpe.triangulate(n,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function B5(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function O5(t,e){for(let i=0;i<e.length;i++)t.push(e[i].x),t.push(e[i].y)}class EC extends si{constructor(e=new Bp([new Qe(.5,.5),new Qe(-.5,.5),new Qe(-.5,-.5),new Qe(.5,-.5)]),i={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:i},e=Array.isArray(e)?e:[e];const n=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++){const c=e[a];o(c)}this.setAttribute("position",new At(r,3)),this.setAttribute("uv",new At(s,2)),this.computeVertexNormals();function o(a){const l=[],c=i.curveSegments!==void 0?i.curveSegments:12,h=i.steps!==void 0?i.steps:1,u=i.depth!==void 0?i.depth:1;let d=i.bevelEnabled!==void 0?i.bevelEnabled:!0,f=i.bevelThickness!==void 0?i.bevelThickness:.2,p=i.bevelSize!==void 0?i.bevelSize:f-.1,m=i.bevelOffset!==void 0?i.bevelOffset:0,v=i.bevelSegments!==void 0?i.bevelSegments:3;const g=i.extrudePath,y=i.UVGenerator!==void 0?i.UVGenerator:Fpe;let x,b=!1,S,A,E,M;g&&(x=g.getSpacedPoints(h),b=!0,d=!1,S=g.computeFrenetFrames(h,!1),A=new te,E=new te,M=new te),d||(v=0,f=0,p=0,m=0);const T=a.extractPoints(c);let P=T.shape;const R=T.holes;if(!Uc.isClockWise(P)){P=P.reverse();for(let Y=0,ce=R.length;Y<ce;Y++){const de=R[Y];Uc.isClockWise(de)&&(R[Y]=de.reverse())}}const F=Uc.triangulateShape(P,R),N=P;for(let Y=0,ce=R.length;Y<ce;Y++){const de=R[Y];P=P.concat(de)}function W(Y,ce,de){return ce||console.error("THREE.ExtrudeGeometry: vec does not exist"),Y.clone().addScaledVector(ce,de)}const Q=P.length,X=F.length;function B(Y,ce,de){let xe,Ce,Ne;const Ie=Y.x-ce.x,Ge=Y.y-ce.y,tt=de.x-Y.x,at=de.y-Y.y,ee=Ie*Ie+Ge*Ge,O=Ie*at-Ge*tt;if(Math.abs(O)>Number.EPSILON){const V=Math.sqrt(ee),ue=Math.sqrt(tt*tt+at*at),Ee=ce.x-Ge/V,Te=ce.y+Ie/V,We=de.x-at/ue,Ve=de.y+tt/ue,me=((We-Ee)*at-(Ve-Te)*tt)/(Ie*at-Ge*tt);xe=Ee+Ie*me-Y.x,Ce=Te+Ge*me-Y.y;const be=xe*xe+Ce*Ce;if(be<=2)return new Qe(xe,Ce);Ne=Math.sqrt(be/2)}else{let V=!1;Ie>Number.EPSILON?tt>Number.EPSILON&&(V=!0):Ie<-Number.EPSILON?tt<-Number.EPSILON&&(V=!0):Math.sign(Ge)===Math.sign(at)&&(V=!0),V?(xe=-Ge,Ce=Ie,Ne=Math.sqrt(ee)):(xe=Ie,Ce=Ge,Ne=Math.sqrt(ee/2))}return new Qe(xe/Ne,Ce/Ne)}const j=[];for(let Y=0,ce=N.length,de=ce-1,xe=Y+1;Y<ce;Y++,de++,xe++)de===ce&&(de=0),xe===ce&&(xe=0),j[Y]=B(N[Y],N[de],N[xe]);const z=[];let k,G=j.concat();for(let Y=0,ce=R.length;Y<ce;Y++){const de=R[Y];k=[];for(let xe=0,Ce=de.length,Ne=Ce-1,Ie=xe+1;xe<Ce;xe++,Ne++,Ie++)Ne===Ce&&(Ne=0),Ie===Ce&&(Ie=0),k[xe]=B(de[xe],de[Ne],de[Ie]);z.push(k),G=G.concat(k)}for(let Y=0;Y<v;Y++){const ce=Y/v,de=f*Math.cos(ce*Math.PI/2),xe=p*Math.sin(ce*Math.PI/2)+m;for(let Ce=0,Ne=N.length;Ce<Ne;Ce++){const Ie=W(N[Ce],j[Ce],xe);le(Ie.x,Ie.y,-de)}for(let Ce=0,Ne=R.length;Ce<Ne;Ce++){const Ie=R[Ce];k=z[Ce];for(let Ge=0,tt=Ie.length;Ge<tt;Ge++){const at=W(Ie[Ge],k[Ge],xe);le(at.x,at.y,-de)}}}const Z=p+m;for(let Y=0;Y<Q;Y++){const ce=d?W(P[Y],G[Y],Z):P[Y];b?(E.copy(S.normals[0]).multiplyScalar(ce.x),A.copy(S.binormals[0]).multiplyScalar(ce.y),M.copy(x[0]).add(E).add(A),le(M.x,M.y,M.z)):le(ce.x,ce.y,0)}for(let Y=1;Y<=h;Y++)for(let ce=0;ce<Q;ce++){const de=d?W(P[ce],G[ce],Z):P[ce];b?(E.copy(S.normals[Y]).multiplyScalar(de.x),A.copy(S.binormals[Y]).multiplyScalar(de.y),M.copy(x[Y]).add(E).add(A),le(M.x,M.y,M.z)):le(de.x,de.y,u/h*Y)}for(let Y=v-1;Y>=0;Y--){const ce=Y/v,de=f*Math.cos(ce*Math.PI/2),xe=p*Math.sin(ce*Math.PI/2)+m;for(let Ce=0,Ne=N.length;Ce<Ne;Ce++){const Ie=W(N[Ce],j[Ce],xe);le(Ie.x,Ie.y,u+de)}for(let Ce=0,Ne=R.length;Ce<Ne;Ce++){const Ie=R[Ce];k=z[Ce];for(let Ge=0,tt=Ie.length;Ge<tt;Ge++){const at=W(Ie[Ge],k[Ge],xe);b?le(at.x,at.y+x[h-1].y,x[h-1].x+de):le(at.x,at.y,u+de)}}}K(),re();function K(){const Y=r.length/3;if(d){let ce=0,de=Q*ce;for(let xe=0;xe<X;xe++){const Ce=F[xe];ae(Ce[2]+de,Ce[1]+de,Ce[0]+de)}ce=h+v*2,de=Q*ce;for(let xe=0;xe<X;xe++){const Ce=F[xe];ae(Ce[0]+de,Ce[1]+de,Ce[2]+de)}}else{for(let ce=0;ce<X;ce++){const de=F[ce];ae(de[2],de[1],de[0])}for(let ce=0;ce<X;ce++){const de=F[ce];ae(de[0]+Q*h,de[1]+Q*h,de[2]+Q*h)}}n.addGroup(Y,r.length/3-Y,0)}function re(){const Y=r.length/3;let ce=0;J(N,ce),ce+=N.length;for(let de=0,xe=R.length;de<xe;de++){const Ce=R[de];J(Ce,ce),ce+=Ce.length}n.addGroup(Y,r.length/3-Y,1)}function J(Y,ce){let de=Y.length;for(;--de>=0;){const xe=de;let Ce=de-1;Ce<0&&(Ce=Y.length-1);for(let Ne=0,Ie=h+v*2;Ne<Ie;Ne++){const Ge=Q*Ne,tt=Q*(Ne+1),at=ce+xe+Ge,ee=ce+Ce+Ge,O=ce+Ce+tt,V=ce+xe+tt;fe(at,ee,O,V)}}}function le(Y,ce,de){l.push(Y),l.push(ce),l.push(de)}function ae(Y,ce,de){ge(Y),ge(ce),ge(de);const xe=r.length/3,Ce=y.generateTopUV(n,r,xe-3,xe-2,xe-1);ve(Ce[0]),ve(Ce[1]),ve(Ce[2])}function fe(Y,ce,de,xe){ge(Y),ge(ce),ge(xe),ge(ce),ge(de),ge(xe);const Ce=r.length/3,Ne=y.generateSideWallUV(n,r,Ce-6,Ce-3,Ce-2,Ce-1);ve(Ne[0]),ve(Ne[1]),ve(Ne[3]),ve(Ne[1]),ve(Ne[2]),ve(Ne[3])}function ge(Y){r.push(l[Y*3+0]),r.push(l[Y*3+1]),r.push(l[Y*3+2])}function ve(Y){s.push(Y.x),s.push(Y.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),i=this.parameters.shapes,n=this.parameters.options;return Npe(i,n,e)}static fromJSON(e,i){const n=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=i[e.shapes[s]];n.push(a)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new QN[r.type]().fromJSON(r)),new EC(n,e.options)}}const Fpe={generateTopUV:function(t,e,i,n,r){const s=e[i*3],o=e[i*3+1],a=e[n*3],l=e[n*3+1],c=e[r*3],h=e[r*3+1];return[new Qe(s,o),new Qe(a,l),new Qe(c,h)]},generateSideWallUV:function(t,e,i,n,r,s){const o=e[i*3],a=e[i*3+1],l=e[i*3+2],c=e[n*3],h=e[n*3+1],u=e[n*3+2],d=e[r*3],f=e[r*3+1],p=e[r*3+2],m=e[s*3],v=e[s*3+1],g=e[s*3+2];return Math.abs(a-h)<Math.abs(o-c)?[new Qe(o,1-l),new Qe(c,1-u),new Qe(d,1-p),new Qe(m,1-g)]:[new Qe(a,1-l),new Qe(h,1-u),new Qe(f,1-p),new Qe(v,1-g)]}};function Npe(t,e,i){if(i.shapes=[],Array.isArray(t))for(let n=0,r=t.length;n<r;n++){const s=t[n];i.shapes.push(s.uuid)}else i.shapes.push(t.uuid);return i.options=Object.assign({},e),e.extrudePath!==void 0&&(i.options.extrudePath=e.extrudePath.toJSON()),i}class TC extends cf{constructor(e=1,i=0){const n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,i),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new TC(e.radius,e.detail)}}class yw extends cf{constructor(e=1,i=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,r,e,i),this.type="OctahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new yw(e.radius,e.detail)}}class CC extends si{constructor(e=.5,i=1,n=32,r=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:i,thetaSegments:n,phiSegments:r,thetaStart:s,thetaLength:o},n=Math.max(3,n),r=Math.max(1,r);const a=[],l=[],c=[],h=[];let u=e;const d=(i-e)/r,f=new te,p=new Qe;for(let m=0;m<=r;m++){for(let v=0;v<=n;v++){const g=s+v/n*o;f.x=u*Math.cos(g),f.y=u*Math.sin(g),l.push(f.x,f.y,f.z),c.push(0,0,1),p.x=(f.x/i+1)/2,p.y=(f.y/i+1)/2,h.push(p.x,p.y)}u+=d}for(let m=0;m<r;m++){const v=m*(n+1);for(let g=0;g<n;g++){const y=g+v,x=y,b=y+n+1,S=y+n+2,A=y+1;a.push(x,b,A),a.push(b,S,A)}}this.setIndex(a),this.setAttribute("position",new At(l,3)),this.setAttribute("normal",new At(c,3)),this.setAttribute("uv",new At(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new CC(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class PC extends si{constructor(e=new Bp([new Qe(0,.5),new Qe(-.5,-.5),new Qe(.5,-.5)]),i=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:i};const n=[],r=[],s=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let h=0;h<e.length;h++)c(e[h]),this.addGroup(a,l,h),a+=l,l=0;this.setIndex(n),this.setAttribute("position",new At(r,3)),this.setAttribute("normal",new At(s,3)),this.setAttribute("uv",new At(o,2));function c(h){const u=r.length/3,d=h.extractPoints(i);let f=d.shape;const p=d.holes;Uc.isClockWise(f)===!1&&(f=f.reverse());for(let v=0,g=p.length;v<g;v++){const y=p[v];Uc.isClockWise(y)===!0&&(p[v]=y.reverse())}const m=Uc.triangulateShape(f,p);for(let v=0,g=p.length;v<g;v++){const y=p[v];f=f.concat(y)}for(let v=0,g=f.length;v<g;v++){const y=f[v];r.push(y.x,y.y,0),s.push(0,0,1),o.push(y.x,y.y)}for(let v=0,g=m.length;v<g;v++){const y=m[v],x=y[0]+u,b=y[1]+u,S=y[2]+u;n.push(x,b,S),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),i=this.parameters.shapes;return Upe(i,e)}static fromJSON(e,i){const n=[];for(let r=0,s=e.shapes.length;r<s;r++){const o=i[e.shapes[r]];n.push(o)}return new PC(n,e.curveSegments)}}function Upe(t,e){if(e.shapes=[],Array.isArray(t))for(let i=0,n=t.length;i<n;i++){const r=t[i];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}class xw extends si{constructor(e=1,i=32,n=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:i,heightSegments:n,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},i=Math.max(3,Math.floor(i)),n=Math.max(2,Math.floor(n));const l=Math.min(o+a,Math.PI);let c=0;const h=[],u=new te,d=new te,f=[],p=[],m=[],v=[];for(let g=0;g<=n;g++){const y=[],x=g/n;let b=0;g===0&&o===0?b=.5/i:g===n&&l===Math.PI&&(b=-.5/i);for(let S=0;S<=i;S++){const A=S/i;u.x=-e*Math.cos(r+A*s)*Math.sin(o+x*a),u.y=e*Math.cos(o+x*a),u.z=e*Math.sin(r+A*s)*Math.sin(o+x*a),p.push(u.x,u.y,u.z),d.copy(u).normalize(),m.push(d.x,d.y,d.z),v.push(A+b,1-x),y.push(c++)}h.push(y)}for(let g=0;g<n;g++)for(let y=0;y<i;y++){const x=h[g][y+1],b=h[g][y],S=h[g+1][y],A=h[g+1][y+1];(g!==0||o>0)&&f.push(x,b,A),(g!==n-1||l<Math.PI)&&f.push(b,S,A)}this.setIndex(f),this.setAttribute("position",new At(p,3)),this.setAttribute("normal",new At(m,3)),this.setAttribute("uv",new At(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new xw(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class DC extends cf{constructor(e=1,i=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,r,e,i),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new DC(e.radius,e.detail)}}class RC extends si{constructor(e=1,i=.4,n=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:i,radialSegments:n,tubularSegments:r,arc:s},n=Math.floor(n),r=Math.floor(r);const o=[],a=[],l=[],c=[],h=new te,u=new te,d=new te;for(let f=0;f<=n;f++)for(let p=0;p<=r;p++){const m=p/r*s,v=f/n*Math.PI*2;u.x=(e+i*Math.cos(v))*Math.cos(m),u.y=(e+i*Math.cos(v))*Math.sin(m),u.z=i*Math.sin(v),a.push(u.x,u.y,u.z),h.x=e*Math.cos(m),h.y=e*Math.sin(m),d.subVectors(u,h).normalize(),l.push(d.x,d.y,d.z),c.push(p/r),c.push(f/n)}for(let f=1;f<=n;f++)for(let p=1;p<=r;p++){const m=(r+1)*f+p-1,v=(r+1)*(f-1)+p-1,g=(r+1)*(f-1)+p,y=(r+1)*f+p;o.push(m,v,y),o.push(v,g,y)}this.setIndex(o),this.setAttribute("position",new At(a,3)),this.setAttribute("normal",new At(l,3)),this.setAttribute("uv",new At(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new RC(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class IC extends si{constructor(e=1,i=.4,n=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:i,tubularSegments:n,radialSegments:r,p:s,q:o},n=Math.floor(n),r=Math.floor(r);const a=[],l=[],c=[],h=[],u=new te,d=new te,f=new te,p=new te,m=new te,v=new te,g=new te;for(let x=0;x<=n;++x){const b=x/n*s*Math.PI*2;y(b,s,o,e,f),y(b+.01,s,o,e,p),v.subVectors(p,f),g.addVectors(p,f),m.crossVectors(v,g),g.crossVectors(m,v),m.normalize(),g.normalize();for(let S=0;S<=r;++S){const A=S/r*Math.PI*2,E=-i*Math.cos(A),M=i*Math.sin(A);u.x=f.x+(E*g.x+M*m.x),u.y=f.y+(E*g.y+M*m.y),u.z=f.z+(E*g.z+M*m.z),l.push(u.x,u.y,u.z),d.subVectors(u,f).normalize(),c.push(d.x,d.y,d.z),h.push(x/n),h.push(S/r)}}for(let x=1;x<=n;x++)for(let b=1;b<=r;b++){const S=(r+1)*(x-1)+(b-1),A=(r+1)*x+(b-1),E=(r+1)*x+b,M=(r+1)*(x-1)+b;a.push(S,A,M),a.push(A,E,M)}this.setIndex(a),this.setAttribute("position",new At(l,3)),this.setAttribute("normal",new At(c,3)),this.setAttribute("uv",new At(h,2));function y(x,b,S,A,E){const M=Math.cos(x),T=Math.sin(x),P=S/b*x,R=Math.cos(P);E.x=A*(2+R)*.5*M,E.y=A*(2+R)*T*.5,E.z=A*Math.sin(P)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new IC(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class LC extends si{constructor(e=new qN(new te(-1,-1,0),new te(-1,1,0),new te(1,1,0)),i=64,n=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:i,radius:n,radialSegments:r,closed:s};const o=e.computeFrenetFrames(i,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new te,l=new te,c=new Qe;let h=new te;const u=[],d=[],f=[],p=[];m(),this.setIndex(p),this.setAttribute("position",new At(u,3)),this.setAttribute("normal",new At(d,3)),this.setAttribute("uv",new At(f,2));function m(){for(let x=0;x<i;x++)v(x);v(s===!1?i:0),y(),g()}function v(x){h=e.getPointAt(x/i,h);const b=o.normals[x],S=o.binormals[x];for(let A=0;A<=r;A++){const E=A/r*Math.PI*2,M=Math.sin(E),T=-Math.cos(E);l.x=T*b.x+M*S.x,l.y=T*b.y+M*S.y,l.z=T*b.z+M*S.z,l.normalize(),d.push(l.x,l.y,l.z),a.x=h.x+n*l.x,a.y=h.y+n*l.y,a.z=h.z+n*l.z,u.push(a.x,a.y,a.z)}}function g(){for(let x=1;x<=i;x++)for(let b=1;b<=r;b++){const S=(r+1)*(x-1)+(b-1),A=(r+1)*x+(b-1),E=(r+1)*x+b,M=(r+1)*(x-1)+b;p.push(S,A,M),p.push(A,E,M)}}function y(){for(let x=0;x<=i;x++)for(let b=0;b<=r;b++)c.x=x/i,c.y=b/r,f.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new LC(new QN[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class _K extends si{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const i=[],n=new Set,r=new te,s=new te;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,h=l.length;c<h;++c){const u=l[c],d=u.start,f=u.count;for(let p=d,m=d+f;p<m;p+=3)for(let v=0;v<3;v++){const g=a.getX(p+v),y=a.getX(p+(v+1)%3);r.fromBufferAttribute(o,g),s.fromBufferAttribute(o,y),F5(r,s,n)===!0&&(i.push(r.x,r.y,r.z),i.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const h=3*a+c,u=3*a+(c+1)%3;r.fromBufferAttribute(o,h),s.fromBufferAttribute(o,u),F5(r,s,n)===!0&&(i.push(r.x,r.y,r.z),i.push(s.x,s.y,s.z))}}this.setAttribute("position",new At(i,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function F5(t,e,i){const n=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return i.has(n)===!0||i.has(r)===!0?!1:(i.add(n),i.add(r),!0)}var N5=Object.freeze({__proto__:null,BoxGeometry:pm,CapsuleGeometry:wC,CircleGeometry:bC,ConeGeometry:SC,CylinderGeometry:ny,DodecahedronGeometry:AC,EdgesGeometry:gK,ExtrudeGeometry:EC,IcosahedronGeometry:TC,LatheGeometry:vw,OctahedronGeometry:yw,PlaneGeometry:pw,PolyhedronGeometry:cf,RingGeometry:CC,ShapeGeometry:PC,SphereGeometry:xw,TetrahedronGeometry:DC,TorusGeometry:RC,TorusKnotGeometry:IC,TubeGeometry:LC,WireframeGeometry:_K});class wK extends dr{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new ht(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class bK extends Xc{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class _w extends dr{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ht(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ht(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=lf,this.normalScale=new Qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class eu extends _w{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Qe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Bn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(i){this.ior=(1+.4*i)/(1-.4*i)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new ht(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new ht(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new ht(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class SK extends dr{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new ht(16777215),this.specular=new ht(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ht(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=lf,this.normalScale=new Qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=uw,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class AK extends dr{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ht(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ht(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=lf,this.normalScale=new Qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class MK extends dr{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=lf,this.normalScale=new Qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class EK extends dr{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new ht(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ht(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=lf,this.normalScale=new Qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=uw,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class TK extends dr{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ht(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=lf,this.normalScale=new Qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class CK extends Ms{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Ra(t,e,i){return KN(t)?new t.constructor(t.subarray(e,i!==void 0?i:t.length)):t.slice(e,i)}function xp(t,e,i){return!t||!i&&t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}function KN(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function PK(t){function e(r,s){return t[r]-t[s]}const i=t.length,n=new Array(i);for(let r=0;r!==i;++r)n[r]=r;return n.sort(e),n}function HL(t,e,i){const n=t.length,r=new t.constructor(n);for(let s=0,o=0;o!==n;++s){const a=i[s]*e;for(let l=0;l!==e;++l)r[o++]=t[a+l]}return r}function JN(t,e,i,n){let r=1,s=t[0];for(;s!==void 0&&s[n]===void 0;)s=t[r++];if(s===void 0)return;let o=s[n];if(o!==void 0)if(Array.isArray(o))do o=s[n],o!==void 0&&(e.push(s.time),i.push.apply(i,o)),s=t[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[n],o!==void 0&&(e.push(s.time),o.toArray(i,i.length)),s=t[r++];while(s!==void 0);else do o=s[n],o!==void 0&&(e.push(s.time),i.push(o)),s=t[r++];while(s!==void 0)}function kpe(t,e,i,n,r=30){const s=t.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],h=c.getValueSize(),u=[],d=[];for(let f=0;f<c.times.length;++f){const p=c.times[f]*r;if(!(p<i||p>=n)){u.push(c.times[f]);for(let m=0;m<h;++m)d.push(c.values[f*h+m])}}u.length!==0&&(c.times=xp(u,c.times.constructor),c.values=xp(d,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function zpe(t,e=0,i=t,n=30){n<=0&&(n=30);const r=i.tracks.length,s=e/n;for(let o=0;o<r;++o){const a=i.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const c=t.tracks.find(function(g){return g.name===a.name&&g.ValueTypeName===l});if(c===void 0)continue;let h=0;const u=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=u/3);let d=0;const f=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=f/3);const p=a.times.length-1;let m;if(s<=a.times[0]){const g=h,y=u-h;m=Ra(a.values,g,y)}else if(s>=a.times[p]){const g=p*u+h,y=g+u-h;m=Ra(a.values,g,y)}else{const g=a.createInterpolant(),y=h,x=u-h;g.evaluate(s),m=Ra(g.resultBuffer,y,x)}l==="quaternion"&&new Gr().fromArray(m).normalize().conjugate().toArray(m);const v=c.times.length;for(let g=0;g<v;++g){const y=g*f+d;if(l==="quaternion")Gr.multiplyQuaternionsFlat(c.values,y,m,0,c.values,y);else{const x=f-d*2;for(let b=0;b<x;++b)c.values[y+b]-=m[b]}}}return t.blendMode=SN,t}const Gpe={arraySlice:Ra,convertArray:xp,isTypedArray:KN,getKeyframeOrder:PK,sortedArray:HL,flattenJSON:JN,subclip:kpe,makeClipAdditive:zpe};class ry{constructor(e,i,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new i.constructor(n),this.sampleValues=i,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const i=this.parameterPositions;let n=this._cachedIndex,r=i[n],s=i[n-1];e:{t:{let o;i:{n:if(!(e<r)){for(let a=n+2;;){if(r===void 0){if(e<s)break n;return n=i.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(s=r,r=i[++n],e<r)break t}o=i.length;break i}if(!(e>=s)){const a=i[1];e<a&&(n=2,s=a);for(let l=n-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(r=s,s=i[--n-1],e>=s)break t}o=n,n=0;break i}break e}for(;n<o;){const a=n+o>>>1;e<i[a]?o=a:n=a+1}if(r=i[n],s=i[n-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=i.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const i=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)i[o]=n[s+o];return i}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class DK extends ry{constructor(e,i,n,r){super(e,i,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:gp,endingEnd:gp}}intervalChanged_(e,i,n){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case vp:s=e,a=2*i-n;break;case x_:s=r.length-2,a=i+r[s]-r[s+1];break;default:s=e,a=n}if(l===void 0)switch(this.getSettings_().endingEnd){case vp:o=e,l=2*n-i;break;case x_:o=1,l=n+r[1]-r[0];break;default:o=e-1,l=i}const c=(n-i)*.5,h=this.valueSize;this._weightPrev=c/(i-a),this._weightNext=c/(l-n),this._offsetPrev=s*h,this._offsetNext=o*h}interpolate_(e,i,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,h=this._offsetPrev,u=this._offsetNext,d=this._weightPrev,f=this._weightNext,p=(n-i)/(r-i),m=p*p,v=m*p,g=-d*v+2*d*m-d*p,y=(1+d)*v+(-1.5-2*d)*m+(-.5+d)*p+1,x=(-1-f)*v+(1.5+f)*m+.5*p,b=f*v-f*m;for(let S=0;S!==a;++S)s[S]=g*o[h+S]+y*o[c+S]+x*o[l+S]+b*o[u+S];return s}}class ZN extends ry{constructor(e,i,n,r){super(e,i,n,r)}interpolate_(e,i,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,h=(n-i)/(r-i),u=1-h;for(let d=0;d!==a;++d)s[d]=o[c+d]*u+o[l+d]*h;return s}}class RK extends ry{constructor(e,i,n,r){super(e,i,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class ql{constructor(e,i,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(i===void 0||i.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=xp(i,this.TimeBufferType),this.values=xp(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const i=e.constructor;let n;if(i.toJSON!==this.toJSON)n=i.toJSON(e);else{n={name:e.name,times:xp(e.times,Array),values:xp(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new RK(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new ZN(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new DK(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let i;switch(e){case p0:i=this.InterpolantFactoryMethodDiscrete;break;case tm:i=this.InterpolantFactoryMethodLinear;break;case PM:i=this.InterpolantFactoryMethodSmooth;break}if(i===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=i,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return p0;case this.InterpolantFactoryMethodLinear:return tm;case this.InterpolantFactoryMethodSmooth:return PM}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const i=this.times;for(let n=0,r=i.length;n!==r;++n)i[n]+=e}return this}scale(e){if(e!==1){const i=this.times;for(let n=0,r=i.length;n!==r;++n)i[n]*=e}return this}trim(e,i){const n=this.times,r=n.length;let s=0,o=r-1;for(;s!==r&&n[s]<e;)++s;for(;o!==-1&&n[o]>i;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=Ra(n,s,o),this.values=Ra(this.values,s*a,o*a)}return this}validate(){let e=!0;const i=this.getValueSize();i-Math.floor(i)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,s=n.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=n[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(r!==void 0&&KN(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=Ra(this.times),i=Ra(this.values),n=this.getValueSize(),r=this.getInterpolation()===PM,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a],h=e[a+1];if(c!==h&&(a!==1||c!==e[0]))if(r)l=!0;else{const u=a*n,d=u-n,f=u+n;for(let p=0;p!==n;++p){const m=i[u+p];if(m!==i[d+p]||m!==i[f+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const u=a*n,d=o*n;for(let f=0;f!==n;++f)i[d+f]=i[u+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*n,l=o*n,c=0;c!==n;++c)i[l+c]=i[a+c];++o}return o!==e.length?(this.times=Ra(e,0,o),this.values=Ra(i,0,o*n)):(this.times=e,this.values=i),this}clone(){const e=Ra(this.times,0),i=Ra(this.values,0),n=this.constructor,r=new n(this.name,e,i);return r.createInterpolant=this.createInterpolant,r}}ql.prototype.TimeBufferType=Float32Array;ql.prototype.ValueBufferType=Float32Array;ql.prototype.DefaultInterpolation=tm;class mm extends ql{}mm.prototype.ValueTypeName="bool";mm.prototype.ValueBufferType=Array;mm.prototype.DefaultInterpolation=p0;mm.prototype.InterpolantFactoryMethodLinear=void 0;mm.prototype.InterpolantFactoryMethodSmooth=void 0;class $N extends ql{}$N.prototype.ValueTypeName="color";class y0 extends ql{}y0.prototype.ValueTypeName="number";class IK extends ry{constructor(e,i,n,r){super(e,i,n,r)}interpolate_(e,i,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(n-i)/(r-i);let c=e*a;for(let h=c+a;c!==h;c+=4)Gr.slerpFlat(s,0,o,c-a,o,c,l);return s}}class Kd extends ql{InterpolantFactoryMethodLinear(e){return new IK(this.times,this.values,this.getValueSize(),e)}}Kd.prototype.ValueTypeName="quaternion";Kd.prototype.DefaultInterpolation=tm;Kd.prototype.InterpolantFactoryMethodSmooth=void 0;class gm extends ql{}gm.prototype.ValueTypeName="string";gm.prototype.ValueBufferType=Array;gm.prototype.DefaultInterpolation=p0;gm.prototype.InterpolantFactoryMethodLinear=void 0;gm.prototype.InterpolantFactoryMethodSmooth=void 0;class x0 extends ql{}x0.prototype.ValueTypeName="vector";class _0{constructor(e,i=-1,n,r=hC){this.name=e,this.tracks=n,this.duration=i,this.blendMode=r,this.uuid=Zo(),this.duration<0&&this.resetDuration()}static parse(e){const i=[],n=e.tracks,r=1/(e.fps||1);for(let o=0,a=n.length;o!==a;++o)i.push(Vpe(n[o]).scale(r));const s=new this(e.name,e.duration,i,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const i=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:i,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=n.length;s!==o;++s)i.push(ql.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(e,i,n,r){const s=i.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const h=PK(l);l=HL(l,1,h),c=HL(c,1,h),!r&&l[0]===0&&(l.push(s),c.push(c[0])),o.push(new y0(".morphTargetInfluences["+i[a].name+"]",l,c).scale(1/n))}return new this(e,-1,o)}static findByName(e,i){let n=e;if(!Array.isArray(e)){const r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===i)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,i,n){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],h=c.name.match(s);if(h&&h.length>1){const u=h[1];let d=r[u];d||(r[u]=d=[]),d.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],i,n));return o}static parseAnimation(e,i){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(u,d,f,p,m){if(f.length!==0){const v=[],g=[];JN(f,v,g,p),v.length!==0&&m.push(new u(d,v,g))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let u=0;u<c.length;u++){const d=c[u].keys;if(!(!d||d.length===0))if(d[0].morphTargets){const f={};let p;for(p=0;p<d.length;p++)if(d[p].morphTargets)for(let m=0;m<d[p].morphTargets.length;m++)f[d[p].morphTargets[m]]=-1;for(const m in f){const v=[],g=[];for(let y=0;y!==d[p].morphTargets.length;++y){const x=d[p];v.push(x.time),g.push(x.morphTarget===m?1:0)}r.push(new y0(".morphTargetInfluence["+m+"]",v,g))}l=f.length*o}else{const f=".bones["+i[u].name+"]";n(x0,f+".position",d,"pos",r),n(Kd,f+".quaternion",d,"rot",r),n(x0,f+".scale",d,"scl",r)}}return r.length===0?null:new this(s,l,r,a)}resetDuration(){const e=this.tracks;let i=0;for(let n=0,r=e.length;n!==r;++n){const s=this.tracks[n];i=Math.max(i,s.times[s.times.length-1])}return this.duration=i,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let i=0;i<this.tracks.length;i++)e=e&&this.tracks[i].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let i=0;i<this.tracks.length;i++)e.push(this.tracks[i].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Hpe(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return y0;case"vector":case"vector2":case"vector3":case"vector4":return x0;case"color":return $N;case"quaternion":return Kd;case"bool":case"boolean":return mm;case"string":return gm}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function Vpe(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=Hpe(t.type);if(t.times===void 0){const i=[],n=[];JN(t.keys,i,n,"value"),t.times=i,t.values=n}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const nm={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class eU{constructor(e,i,n){const r=this;let s=!1,o=0,a=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=i,this.onError=n,this.itemStart=function(h){a++,s===!1&&r.onStart!==void 0&&r.onStart(h,o,a),s=!0},this.itemEnd=function(h){o++,r.onProgress!==void 0&&r.onProgress(h,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(h){r.onError!==void 0&&r.onError(h)},this.resolveURL=function(h){return l?l(h):h},this.setURLModifier=function(h){return l=h,this},this.addHandler=function(h,u){return c.push(h,u),this},this.removeHandler=function(h){const u=c.indexOf(h);return u!==-1&&c.splice(u,2),this},this.getHandler=function(h){for(let u=0,d=c.length;u<d;u+=2){const f=c[u],p=c[u+1];if(f.global&&(f.lastIndex=0),f.test(h))return p}return null}}}const pv=new eU;class Es{constructor(e){this.manager=e!==void 0?e:pv,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,i){const n=this;return new Promise(function(r,s){n.load(e,r,i,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Es.DEFAULT_MATERIAL_NAME="__DEFAULT";const gu={};class jpe extends Error{constructor(e,i){super(e),this.response=i}}class ia extends Es{constructor(e){super(e)}load(e,i,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=nm.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{i&&i(s),this.manager.itemEnd(e)},0),s;if(gu[e]!==void 0){gu[e].push({onLoad:i,onProgress:n,onError:r});return}gu[e]=[],gu[e].push({onLoad:i,onProgress:n,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const h=gu[e],u=c.body.getReader(),d=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),f=d?parseInt(d):0,p=f!==0;let m=0;const v=new ReadableStream({start(g){y();function y(){u.read().then(({done:x,value:b})=>{if(x)g.close();else{m+=b.byteLength;const S=new ProgressEvent("progress",{lengthComputable:p,loaded:m,total:f});for(let A=0,E=h.length;A<E;A++){const M=h[A];M.onProgress&&M.onProgress(S)}g.enqueue(b),y()}})}}});return new Response(v)}else throw new jpe(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(h=>new DOMParser().parseFromString(h,a));case"json":return c.json();default:if(a===void 0)return c.text();{const u=/charset="?([^;"\s]*)"?/i.exec(a),d=u&&u[1]?u[1].toLowerCase():void 0,f=new TextDecoder(d);return c.arrayBuffer().then(p=>f.decode(p))}}}).then(c=>{nm.add(e,c);const h=gu[e];delete gu[e];for(let u=0,d=h.length;u<d;u++){const f=h[u];f.onLoad&&f.onLoad(c)}}).catch(c=>{const h=gu[e];if(h===void 0)throw this.manager.itemError(e),c;delete gu[e];for(let u=0,d=h.length;u<d;u++){const f=h[u];f.onError&&f.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Wpe extends Es{constructor(e){super(e)}load(e,i,n,r){const s=this,o=new ia(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{i(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}parse(e){const i=[];for(let n=0;n<e.length;n++){const r=_0.parse(e[n]);i.push(r)}return i}}class Xpe extends Es{constructor(e){super(e)}load(e,i,n,r){const s=this,o=[],a=new VN,l=new ia(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function h(u){l.load(e[u],function(d){const f=s.parse(d,!0);o[u]={width:f.width,height:f.height,format:f.format,mipmaps:f.mipmaps},c+=1,c===6&&(f.mipmapCount===1&&(a.minFilter=xn),a.image=o,a.format=f.format,a.needsUpdate=!0,i&&i(a))},n,r)}if(Array.isArray(e))for(let u=0,d=e.length;u<d;++u)h(u);else l.load(e,function(u){const d=s.parse(u,!0);if(d.isCubemap){const f=d.mipmaps.length/d.mipmapCount;for(let p=0;p<f;p++){o[p]={mipmaps:[]};for(let m=0;m<d.mipmapCount;m++)o[p].mipmaps.push(d.mipmaps[p*d.mipmapCount+m]),o[p].format=d.format,o[p].width=d.width,o[p].height=d.height}a.image=o}else a.image.width=d.width,a.image.height=d.height,a.mipmaps=d.mipmaps;d.mipmapCount===1&&(a.minFilter=xn),a.format=d.format,a.needsUpdate=!0,i&&i(a)},n,r);return a}}class T_ extends Es{constructor(e){super(e)}load(e,i,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=nm.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){i&&i(o),s.manager.itemEnd(e)},0),o;const a=b_("img");function l(){h(),nm.add(e,this),i&&i(this),s.manager.itemEnd(e)}function c(u){h(),r&&r(u),s.manager.itemError(e),s.manager.itemEnd(e)}function h(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class qpe extends Es{constructor(e){super(e)}load(e,i,n,r){const s=new fw;s.colorSpace=ni;const o=new T_(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(h){s.images[c]=h,a++,a===6&&(s.needsUpdate=!0,i&&i(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}}class Ype extends Es{constructor(e){super(e)}load(e,i,n,r){const s=this,o=new kv,a=new ia(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){const c=s.parse(l);c&&(c.image!==void 0?o.image=c.image:c.data!==void 0&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=c.wrapS!==void 0?c.wrapS:Jr,o.wrapT=c.wrapT!==void 0?c.wrapT:Jr,o.magFilter=c.magFilter!==void 0?c.magFilter:xn,o.minFilter=c.minFilter!==void 0?c.minFilter:xn,o.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0?o.colorSpace=c.colorSpace:c.encoding!==void 0&&(o.encoding=c.encoding),c.flipY!==void 0&&(o.flipY=c.flipY),c.format!==void 0&&(o.format=c.format),c.type!==void 0&&(o.type=c.type),c.mipmaps!==void 0&&(o.mipmaps=c.mipmaps,o.minFilter=Wc),c.mipmapCount===1&&(o.minFilter=xn),c.generateMipmaps!==void 0&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,i&&i(o,c))},n,r),o}}class LK extends Es{constructor(e){super(e)}load(e,i,n,r){const s=new pn,o=new T_(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,i!==void 0&&i(s)},n,r),s}}class uf extends Si{constructor(e,i=1){super(),this.isLight=!0,this.type="Light",this.color=new ht(e),this.intensity=i}dispose(){}copy(e,i){return super.copy(e,i),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const i=super.toJSON(e);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),i}}class BK extends uf{constructor(e,i,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Si.DEFAULT_UP),this.updateMatrix(),this.groundColor=new ht(i)}copy(e,i){return super.copy(e,i),this.groundColor.copy(e.groundColor),this}}const CD=new Wt,U5=new te,k5=new te;class tU{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Qe(512,512),this.map=null,this.mapPass=null,this.matrix=new Wt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new fC,this._frameExtents=new Qe(1,1),this._viewportCount=1,this._viewports=[new zi(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const i=this.camera,n=this.matrix;U5.setFromMatrixPosition(e.matrixWorld),i.position.copy(U5),k5.setFromMatrixPosition(e.target.matrixWorld),i.lookAt(k5),i.updateMatrixWorld(),CD.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(CD),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(CD)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Qpe extends tU{constructor(){super(new fn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const i=this.camera,n=m0*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||i.far;(n!==i.fov||r!==i.aspect||s!==i.far)&&(i.fov=n,i.aspect=r,i.far=s,i.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class iU extends uf{constructor(e,i,n=0,r=Math.PI/3,s=0,o=2){super(e,i),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Si.DEFAULT_UP),this.updateMatrix(),this.target=new Si,this.distance=n,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new Qpe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,i){return super.copy(e,i),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const z5=new Wt,ax=new te,PD=new te;class Kpe extends tU{constructor(){super(new fn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Qe(4,2),this._viewportCount=6,this._viewports=[new zi(2,1,1,1),new zi(0,1,1,1),new zi(3,1,1,1),new zi(1,1,1,1),new zi(3,0,1,1),new zi(1,0,1,1)],this._cubeDirections=[new te(1,0,0),new te(-1,0,0),new te(0,0,1),new te(0,0,-1),new te(0,1,0),new te(0,-1,0)],this._cubeUps=[new te(0,1,0),new te(0,1,0),new te(0,1,0),new te(0,1,0),new te(0,0,1),new te(0,0,-1)]}updateMatrices(e,i=0){const n=this.camera,r=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),ax.setFromMatrixPosition(e.matrixWorld),n.position.copy(ax),PD.copy(n.position),PD.add(this._cubeDirections[i]),n.up.copy(this._cubeUps[i]),n.lookAt(PD),n.updateMatrixWorld(),r.makeTranslation(-ax.x,-ax.y,-ax.z),z5.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(z5)}}class nU extends uf{constructor(e,i,n=0,r=2){super(e,i),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new Kpe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,i){return super.copy(e,i),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Jpe extends tU{constructor(){super(new Bl(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class rU extends uf{constructor(e,i){super(e,i),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Si.DEFAULT_UP),this.updateMatrix(),this.target=new Si,this.shadow=new Jpe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class OK extends uf{constructor(e,i){super(e,i),this.isAmbientLight=!0,this.type="AmbientLight"}}class FK extends uf{constructor(e,i,n=10,r=10){super(e,i),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const i=super.toJSON(e);return i.object.width=this.width,i.object.height=this.height,i}}class NK{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new te)}set(e){for(let i=0;i<9;i++)this.coefficients[i].copy(e[i]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,i){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return i.copy(o[0]).multiplyScalar(.282095),i.addScaledVector(o[1],.488603*r),i.addScaledVector(o[2],.488603*s),i.addScaledVector(o[3],.488603*n),i.addScaledVector(o[4],1.092548*(n*r)),i.addScaledVector(o[5],1.092548*(r*s)),i.addScaledVector(o[6],.315392*(3*s*s-1)),i.addScaledVector(o[7],1.092548*(n*s)),i.addScaledVector(o[8],.546274*(n*n-r*r)),i}getIrradianceAt(e,i){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return i.copy(o[0]).multiplyScalar(.886227),i.addScaledVector(o[1],2*.511664*r),i.addScaledVector(o[2],2*.511664*s),i.addScaledVector(o[3],2*.511664*n),i.addScaledVector(o[4],2*.429043*n*r),i.addScaledVector(o[5],2*.429043*r*s),i.addScaledVector(o[6],.743125*s*s-.247708),i.addScaledVector(o[7],2*.429043*n*s),i.addScaledVector(o[8],.429043*(n*n-r*r)),i}add(e){for(let i=0;i<9;i++)this.coefficients[i].add(e.coefficients[i]);return this}addScaledSH(e,i){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],i);return this}scale(e){for(let i=0;i<9;i++)this.coefficients[i].multiplyScalar(e);return this}lerp(e,i){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],i);return this}equals(e){for(let i=0;i<9;i++)if(!this.coefficients[i].equals(e.coefficients[i]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,i=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,i+r*3);return this}toArray(e=[],i=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,i+r*3);return e}static getBasisAt(e,i){const n=e.x,r=e.y,s=e.z;i[0]=.282095,i[1]=.488603*r,i[2]=.488603*s,i[3]=.488603*n,i[4]=1.092548*n*r,i[5]=1.092548*r*s,i[6]=.315392*(3*s*s-1),i[7]=1.092548*n*s,i[8]=.546274*(n*n-r*r)}}class BC extends uf{constructor(e=new NK,i=1){super(void 0,i),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const i=super.toJSON(e);return i.object.sh=this.sh.toArray(),i}}class OC extends Es{constructor(e){super(e),this.textures={}}load(e,i,n,r){const s=this,o=new ia(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{i(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}parse(e){const i=this.textures;function n(s){return i[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),i[s]}const r=OC.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new ht().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==1&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=n(o.value);break;case"c":r.uniforms[s].value=new ht().setHex(o.value);break;case"v2":r.uniforms[s].value=new Qe().fromArray(o.value);break;case"v3":r.uniforms[s].value=new te().fromArray(o.value);break;case"v4":r.uniforms[s].value=new zi().fromArray(o.value);break;case"m3":r.uniforms[s].value=new ci().fromArray(o.value);break;case"m4":r.uniforms[s].value=new Wt().fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=n(e.map)),e.matcap!==void 0&&(r.matcap=n(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new Qe().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=n(e.envMap)),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new Qe().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const i={ShadowMaterial:wK,SpriteMaterial:UN,RawShaderMaterial:bK,ShaderMaterial:Xc,PointsMaterial:yC,MeshPhysicalMaterial:eu,MeshStandardMaterial:_w,MeshPhongMaterial:SK,MeshToonMaterial:AK,MeshNormalMaterial:MK,MeshLambertMaterial:EK,MeshDepthMaterial:ON,MeshDistanceMaterial:FN,MeshBasicMaterial:jo,MeshMatcapMaterial:TK,LineDashedMaterial:CK,LineBasicMaterial:Ms,Material:dr};return new i[e]}}class kc{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let i="";for(let n=0,r=e.length;n<r;n++)i+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(i))}catch{return i}}static extractUrlBase(e){const i=e.lastIndexOf("/");return i===-1?"./":e.slice(0,i+1)}static resolveURL(e,i){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(i)&&/^\//.test(e)&&(i=i.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:i+e)}}class UK extends si{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class kK extends Es{constructor(e){super(e)}load(e,i,n,r){const s=this,o=new ia(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{i(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}parse(e){const i={},n={};function r(f,p){if(i[p]!==void 0)return i[p];const v=f.interleavedBuffers[p],g=s(f,v.buffer),y=hv(v.type,g),x=new mw(y,v.stride);return x.uuid=v.uuid,i[p]=x,x}function s(f,p){if(n[p]!==void 0)return n[p];const v=f.arrayBuffers[p],g=new Uint32Array(v).buffer;return n[p]=g,g}const o=e.isInstancedBufferGeometry?new UK:new si,a=e.data.index;if(a!==void 0){const f=hv(a.type,a.array);o.setIndex(new Ri(f,1))}const l=e.data.attributes;for(const f in l){const p=l[f];let m;if(p.isInterleavedBufferAttribute){const v=r(e.data,p.data);m=new Qd(v,p.itemSize,p.offset,p.normalized)}else{const v=hv(p.type,p.array),g=p.isInstancedBufferAttribute?v0:Ri;m=new g(v,p.itemSize,p.normalized)}p.name!==void 0&&(m.name=p.name),p.usage!==void 0&&m.setUsage(p.usage),p.updateRange!==void 0&&(m.updateRange.offset=p.updateRange.offset,m.updateRange.count=p.updateRange.count),o.setAttribute(f,m)}const c=e.data.morphAttributes;if(c)for(const f in c){const p=c[f],m=[];for(let v=0,g=p.length;v<g;v++){const y=p[v];let x;if(y.isInterleavedBufferAttribute){const b=r(e.data,y.data);x=new Qd(b,y.itemSize,y.offset,y.normalized)}else{const b=hv(y.type,y.array);x=new Ri(b,y.itemSize,y.normalized)}y.name!==void 0&&(x.name=y.name),m.push(x)}o.morphAttributes[f]=m}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const u=e.data.groups||e.data.drawcalls||e.data.offsets;if(u!==void 0)for(let f=0,p=u.length;f!==p;++f){const m=u[f];o.addGroup(m.start,m.count,m.materialIndex)}const d=e.data.boundingSphere;if(d!==void 0){const f=new te;d.center!==void 0&&f.fromArray(d.center),o.boundingSphere=new nl(f,d.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class Zpe extends Es{constructor(e){super(e)}load(e,i,n,r){const s=this,o=this.path===""?kc.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new ia(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(u){r!==void 0&&r(u),console.error("THREE:ObjectLoader: Can't parse "+e+".",u.message);return}const h=c.metadata;if(h===void 0||h.type===void 0||h.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(c,i)},n,r)}async loadAsync(e,i){const n=this,r=this.path===""?kc.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new ia(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,i),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(a)}parse(e,i){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){i!==void 0&&i(c)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,s,l,a,n),h=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,h),i!==void 0){let u=!1;for(const d in o)if(o[d].data instanceof HTMLImageElement){u=!0;break}u===!1&&i(c)}return c}async parseAsync(e){const i=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,r,a,o,i),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),l}parseShapes(e){const i={};if(e!==void 0)for(let n=0,r=e.length;n<r;n++){const s=new Bp().fromJSON(e[n]);i[s.uuid]=s}return i}parseSkeletons(e,i){const n={},r={};if(i.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new gw().fromJSON(e[s],r);n[a.uuid]=a}return n}parseGeometries(e,i){const n={};if(e!==void 0){const r=new kK;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(l);break;default:l.type in N5?a=N5[l.type].fromJSON(l,i):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),l.userData!==void 0&&(a.userData=l.userData),n[l.uuid]=a}}return n}parseMaterials(e,i){const n={},r={};if(e!==void 0){const s=new OC;s.setTextures(i);for(let o=0,a=e.length;o<a;o++){const l=e[o];n[l.uuid]===void 0&&(n[l.uuid]=s.parse(l)),r[l.uuid]=n[l.uuid]}}return r}parseAnimations(e){const i={};if(e!==void 0)for(let n=0;n<e.length;n++){const r=e[n],s=_0.parse(r);i[s.uuid]=s}return i}parseImages(e,i){const n=this,r={};let s;function o(l){return n.manager.itemStart(l),s.load(l,function(){n.manager.itemEnd(l)},void 0,function(){n.manager.itemError(l),n.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const c=l,h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:n.resourcePath+c;return o(h)}else return l.data?{data:hv(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new eU(i);s=new T_(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,h=e.length;c<h;c++){const u=e[c],d=u.url;if(Array.isArray(d)){const f=[];for(let p=0,m=d.length;p<m;p++){const v=d[p],g=a(v);g!==null&&(g instanceof HTMLImageElement?f.push(g):f.push(new kv(g.data,g.width,g.height)))}r[u.uuid]=new yp(f)}else{const f=a(u.url);r[u.uuid]=new yp(f)}}}return r}async parseImagesAsync(e){const i=this,n={};let r;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:i.resourcePath+a;return await r.loadAsync(l)}else return o.data?{data:hv(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){r=new T_(this.manager),r.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.url;if(Array.isArray(c)){const h=[];for(let u=0,d=c.length;u<d;u++){const f=c[u],p=await s(f);p!==null&&(p instanceof HTMLImageElement?h.push(p):h.push(new kv(p.data,p.width,p.height)))}n[l.uuid]=new yp(h)}else{const h=await s(l.url);n[l.uuid]=new yp(h)}}}return n}parseTextures(e,i){function n(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),i[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=i[a.image],c=l.data;let h;Array.isArray(c)?(h=new fw,c.length===6&&(h.needsUpdate=!0)):(c&&c.data?h=new kv:h=new pn,c&&(h.needsUpdate=!0)),h.source=l,h.uuid=a.uuid,a.name!==void 0&&(h.name=a.name),a.mapping!==void 0&&(h.mapping=n(a.mapping,$pe)),a.channel!==void 0&&(h.channel=a.channel),a.offset!==void 0&&h.offset.fromArray(a.offset),a.repeat!==void 0&&h.repeat.fromArray(a.repeat),a.center!==void 0&&h.center.fromArray(a.center),a.rotation!==void 0&&(h.rotation=a.rotation),a.wrap!==void 0&&(h.wrapS=n(a.wrap[0],G5),h.wrapT=n(a.wrap[1],G5)),a.format!==void 0&&(h.format=a.format),a.internalFormat!==void 0&&(h.internalFormat=a.internalFormat),a.type!==void 0&&(h.type=a.type),a.colorSpace!==void 0&&(h.colorSpace=a.colorSpace),a.encoding!==void 0&&(h.encoding=a.encoding),a.minFilter!==void 0&&(h.minFilter=n(a.minFilter,H5)),a.magFilter!==void 0&&(h.magFilter=n(a.magFilter,H5)),a.anisotropy!==void 0&&(h.anisotropy=a.anisotropy),a.flipY!==void 0&&(h.flipY=a.flipY),a.generateMipmaps!==void 0&&(h.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(h.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(h.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(h.compareFunction=a.compareFunction),a.userData!==void 0&&(h.userData=a.userData),r[a.uuid]=h}return r}parseObject(e,i,n,r,s){let o;function a(d){return i[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",d),i[d]}function l(d){if(d!==void 0){if(Array.isArray(d)){const f=[];for(let p=0,m=d.length;p<m;p++){const v=d[p];n[v]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",v),f.push(n[v])}return f}return n[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",d),n[d]}}function c(d){return r[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",d),r[d]}let h,u;switch(e.type){case"Scene":o=new TE,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new ht(e.background):o.background=c(e.background)),e.environment!==void 0&&(o.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new gC(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new mC(e.fog.color,e.fog.density))),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":o=new fn(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Bl(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new OK(e.color,e.intensity);break;case"DirectionalLight":o=new rU(e.color,e.intensity);break;case"PointLight":o=new nU(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new FK(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new iU(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new BK(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new BC().fromJSON(e);break;case"SkinnedMesh":h=a(e.geometry),u=l(e.material),o=new kN(h,u),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":h=a(e.geometry),u=l(e.material),o=new Ur(h,u);break;case"InstancedMesh":h=a(e.geometry),u=l(e.material);const d=e.count,f=e.instanceMatrix,p=e.instanceColor;o=new zN(h,u,d),o.instanceMatrix=new v0(new Float32Array(f.array),16),p!==void 0&&(o.instanceColor=new v0(new Float32Array(p.array),p.itemSize));break;case"LOD":o=new uK;break;case"Line":o=new ch(a(e.geometry),l(e.material));break;case"LineLoop":o=new GN(a(e.geometry),l(e.material));break;case"LineSegments":o=new Wl(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new HN(a(e.geometry),l(e.material));break;case"Sprite":o=new cK(l(e.material));break;case"Group":o=new qu;break;case"Bone":o=new vC;break;default:o=new Si}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const d=e.children;for(let f=0;f<d.length;f++)o.add(this.parseObject(d[f],i,n,r,s))}if(e.animations!==void 0){const d=e.animations;for(let f=0;f<d.length;f++){const p=d[f];o.animations.push(s[p])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const d=e.levels;for(let f=0;f<d.length;f++){const p=d[f],m=o.getObjectByProperty("uuid",p.object);m!==void 0&&o.addLevel(m,p.distance,p.hysteresis)}}return o}bindSkeletons(e,i){Object.keys(i).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const r=i[n.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(r,n.bindMatrix)}})}}const $pe={UVMapping:lC,CubeReflectionMapping:Xd,CubeRefractionMapping:qd,EquirectangularReflectionMapping:g_,EquirectangularRefractionMapping:v_,CubeUVReflectionMapping:ey},G5={RepeatWrapping:Yd,ClampToEdgeWrapping:Jr,MirroredRepeatWrapping:d0},H5={NearestFilter:Ln,NearestMipmapNearestFilter:y_,NearestMipmapLinearFilter:Nv,LinearFilter:xn,LinearMipmapNearestFilter:cC,LinearMipmapLinearFilter:Wc};class zK extends Es{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,i,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=nm.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){i&&i(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){nm.add(e,l),i&&i(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}let LS,sU=class{static getContext(){return LS===void 0&&(LS=new(window.AudioContext||window.webkitAudioContext)),LS}static setContext(e){LS=e}};class eme extends Es{constructor(e){super(e)}load(e,i,n,r){const s=this,o=new ia(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{const c=l.slice(0);sU.getContext().decodeAudioData(c,function(u){i(u)},a)}catch(c){a(c)}},n,r);function a(l){r?r(l):console.error(l),s.manager.itemError(e)}}}class tme extends BC{constructor(e,i,n=1){super(void 0,n),this.isHemisphereLightProbe=!0;const r=new ht().set(e),s=new ht().set(i),o=new te(r.r,r.g,r.b),a=new te(s.r,s.g,s.b),l=Math.sqrt(Math.PI),c=l*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(l),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(c)}}class ime extends BC{constructor(e,i=1){super(void 0,i),this.isAmbientLightProbe=!0;const n=new ht().set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const V5=new Wt,j5=new Wt,Df=new Wt;class nme{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new fn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new fn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const i=this._cache;if(i.focus!==e.focus||i.fov!==e.fov||i.aspect!==e.aspect*this.aspect||i.near!==e.near||i.far!==e.far||i.zoom!==e.zoom||i.eyeSep!==this.eyeSep){i.focus=e.focus,i.fov=e.fov,i.aspect=e.aspect*this.aspect,i.near=e.near,i.far=e.far,i.zoom=e.zoom,i.eyeSep=this.eyeSep,Df.copy(e.projectionMatrix);const r=i.eyeSep/2,s=r*i.near/i.focus,o=i.near*Math.tan(Ip*i.fov*.5)/i.zoom;let a,l;j5.elements[12]=-r,V5.elements[12]=r,a=-o*i.aspect+s,l=o*i.aspect+s,Df.elements[0]=2*i.near/(l-a),Df.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(Df),a=-o*i.aspect-s,l=o*i.aspect-s,Df.elements[0]=2*i.near/(l-a),Df.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(Df)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(j5),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(V5)}}class oU{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=W5(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const i=W5();e=(i-this.oldTime)/1e3,this.oldTime=i,this.elapsedTime+=e}return e}}function W5(){return(typeof performance>"u"?Date:performance).now()}const Rf=new te,X5=new Gr,rme=new te,If=new te;class sme extends Si{constructor(){super(),this.type="AudioListener",this.context=sU.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new oU}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const i=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Rf,X5,rme),If.set(0,0,-1).applyQuaternion(X5),i.positionX){const r=this.context.currentTime+this.timeDelta;i.positionX.linearRampToValueAtTime(Rf.x,r),i.positionY.linearRampToValueAtTime(Rf.y,r),i.positionZ.linearRampToValueAtTime(Rf.z,r),i.forwardX.linearRampToValueAtTime(If.x,r),i.forwardY.linearRampToValueAtTime(If.y,r),i.forwardZ.linearRampToValueAtTime(If.z,r),i.upX.linearRampToValueAtTime(n.x,r),i.upY.linearRampToValueAtTime(n.y,r),i.upZ.linearRampToValueAtTime(n.z,r)}else i.setPosition(Rf.x,Rf.y,Rf.z),i.setOrientation(If.x,If.y,If.z,n.x,n.y,n.z)}}let GK=class extends Si{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const i=this.context.createBufferSource();return i.buffer=this.buffer,i.loop=this.loop,i.loopStart=this.loopStart,i.loopEnd=this.loopEnd,i.onended=this.onEnded.bind(this),i.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=i,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,i=this.filters.length;e<i;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,i=this.filters.length;e<i;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}};const Lf=new te,q5=new Gr,ome=new te,Bf=new te;class ame extends GK{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,i,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=i,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Lf,q5,ome),Bf.set(0,0,1).applyQuaternion(q5);const i=this.panner;if(i.positionX){const n=this.context.currentTime+this.listener.timeDelta;i.positionX.linearRampToValueAtTime(Lf.x,n),i.positionY.linearRampToValueAtTime(Lf.y,n),i.positionZ.linearRampToValueAtTime(Lf.z,n),i.orientationX.linearRampToValueAtTime(Bf.x,n),i.orientationY.linearRampToValueAtTime(Bf.y,n),i.orientationZ.linearRampToValueAtTime(Bf.z,n)}else i.setPosition(Lf.x,Lf.y,Lf.z),i.setOrientation(Bf.x,Bf.y,Bf.z)}}class lme{constructor(e,i=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=i,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const i=this.getFrequencyData();for(let n=0;n<i.length;n++)e+=i[n];return e/i.length}}class HK{constructor(e,i,n){this.binding=e,this.valueSize=n;let r,s,o;switch(i){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,i){const n=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==r;++a)n[s+a]=n[a];o=i}else{o+=i;const a=i/o;this._mixBufferRegion(n,s,0,a,r)}this.cumulativeWeight=o}accumulateAdditive(e){const i=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(i,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const i=this.valueSize,n=this.buffer,r=e*i+i,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=i*this._origIndex;this._mixBufferRegion(n,r,l,1-s,i)}o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*i,1,i);for(let l=i,c=i+i;l!==c;++l)if(n[l]!==n[l+i]){a.setValue(n,r);break}}saveOriginalState(){const e=this.binding,i=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(i,r);for(let s=n,o=r;s!==o;++s)i[s]=i[r+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,i=e+this.valueSize;for(let n=e;n<i;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,i=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[i+n]=this.buffer[e+n]}_select(e,i,n,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[i+o]=e[n+o]}_slerp(e,i,n,r){Gr.slerpFlat(e,i,e,i,e,n,r)}_slerpAdditive(e,i,n,r,s){const o=this._workIndex*s;Gr.multiplyQuaternionsFlat(e,o,e,i,e,n),Gr.slerpFlat(e,i,e,i,e,o,r)}_lerp(e,i,n,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=i+a;e[l]=e[l]*o+e[n+a]*r}}_lerpAdditive(e,i,n,r,s){for(let o=0;o!==s;++o){const a=i+o;e[a]=e[a]+e[n+o]*r}}}const aU="\\[\\]\\.:\\/",cme=new RegExp("["+aU+"]","g"),lU="[^"+aU+"]",ume="[^"+aU.replace("\\.","")+"]",hme=/((?:WC+[\/:])*)/.source.replace("WC",lU),dme=/(WCOD+)?/.source.replace("WCOD",ume),fme=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",lU),pme=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",lU),mme=new RegExp("^"+hme+dme+fme+pme+"$"),gme=["material","materials","bones","map"];class vme{constructor(e,i,n){const r=n||bi.parseTrackName(i);this._targetGroup=e,this._bindings=e.subscribe_(i,r)}getValue(e,i){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,i)}setValue(e,i){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,i)}bind(){const e=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=e.length;i!==n;++i)e[i].bind()}unbind(){const e=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=e.length;i!==n;++i)e[i].unbind()}}class bi{constructor(e,i,n){this.path=i,this.parsedPath=n||bi.parseTrackName(i),this.node=bi.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,i,n){return e&&e.isAnimationObjectGroup?new bi.Composite(e,i,n):new bi(e,i,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(cme,"")}static parseTrackName(e){const i=mme.exec(e);if(i===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=n.nodeName.substring(r+1);gme.indexOf(s)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=s)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,i){if(i===void 0||i===""||i==="."||i===-1||i===e.name||i===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(i);if(n!==void 0)return n}if(e.children){const n=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===i||a.uuid===i)return a;const l=n(a.children);if(l)return l}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,i){e[i]=this.targetObject[this.propertyName]}_getValue_array(e,i){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)e[i++]=n[r]}_getValue_arrayElement(e,i){e[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,i){this.resolvedProperty.toArray(e,i)}_setValue_direct(e,i){this.targetObject[this.propertyName]=e[i]}_setValue_direct_setNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,i){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[i++]}_setValue_array_setNeedsUpdate(e,i){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,i){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,i){this.resolvedProperty[this.propertyIndex]=e[i]}_setValue_arrayElement_setNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,i){this.resolvedProperty.fromArray(e,i)}_setValue_fromArray_setNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,i){this.bind(),this.getValue(e,i)}_setValue_unbound(e,i){this.bind(),this.setValue(e,i)}bind(){let e=this.node;const i=this.parsedPath,n=i.objectName,r=i.propertyName;let s=i.propertyIndex;if(e||(e=bi.findNode(this.rootNode,i.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(n){let c=i.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let h=0;h<e.length;h++)if(e[h].name===c){c=h;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const o=e[r];if(o===void 0){const c=i.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}bi.Composite=vme;bi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};bi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};bi.prototype.GetterByBindingType=[bi.prototype._getValue_direct,bi.prototype._getValue_array,bi.prototype._getValue_arrayElement,bi.prototype._getValue_toArray];bi.prototype.SetterByBindingTypeAndVersioning=[[bi.prototype._setValue_direct,bi.prototype._setValue_direct_setNeedsUpdate,bi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[bi.prototype._setValue_array,bi.prototype._setValue_array_setNeedsUpdate,bi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[bi.prototype._setValue_arrayElement,bi.prototype._setValue_arrayElement_setNeedsUpdate,bi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[bi.prototype._setValue_fromArray,bi.prototype._setValue_fromArray_setNeedsUpdate,bi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class yme{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Zo(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}add(){const e=this._objects,i=this._indicesByUUID,n=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,c=this.nCachedObjects_;for(let h=0,u=arguments.length;h!==u;++h){const d=arguments[h],f=d.uuid;let p=i[f];if(p===void 0){p=l++,i[f]=p,e.push(d);for(let m=0,v=o;m!==v;++m)s[m].push(new bi(d,n[m],r[m]))}else if(p<c){a=e[p];const m=--c,v=e[m];i[v.uuid]=p,e[p]=v,i[f]=m,e[m]=d;for(let g=0,y=o;g!==y;++g){const x=s[g],b=x[m];let S=x[p];x[p]=b,S===void 0&&(S=new bi(d,n[g],r[g])),x[m]=S}}else e[p]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,i=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],c=l.uuid,h=i[c];if(h!==void 0&&h>=s){const u=s++,d=e[u];i[d.uuid]=h,e[h]=d,i[c]=u,e[u]=l;for(let f=0,p=r;f!==p;++f){const m=n[f],v=m[u],g=m[h];m[h]=v,m[u]=g}}}this.nCachedObjects_=s}uncache(){const e=this._objects,i=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const c=arguments[a],h=c.uuid,u=i[h];if(u!==void 0)if(delete i[h],u<s){const d=--s,f=e[d],p=--o,m=e[p];i[f.uuid]=u,e[u]=f,i[m.uuid]=d,e[d]=m,e.pop();for(let v=0,g=r;v!==g;++v){const y=n[v],x=y[d],b=y[p];y[u]=x,y[d]=b,y.pop()}}else{const d=--o,f=e[d];d>0&&(i[f.uuid]=u),e[u]=f,e.pop();for(let p=0,m=r;p!==m;++p){const v=n[p];v[u]=v[d],v.pop()}}}this.nCachedObjects_=s}subscribe_(e,i){const n=this._bindingsIndicesByPath;let r=n[e];const s=this._bindings;if(r!==void 0)return s[r];const o=this._paths,a=this._parsedPaths,l=this._objects,c=l.length,h=this.nCachedObjects_,u=new Array(c);r=s.length,n[e]=r,o.push(e),a.push(i),s.push(u);for(let d=h,f=l.length;d!==f;++d){const p=l[d];u[d]=new bi(p,e,i)}return u}unsubscribe_(e){const i=this._bindingsIndicesByPath,n=i[e];if(n!==void 0){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],c=e[a];i[c]=n,o[n]=l,o.pop(),s[n]=s[a],s.pop(),r[n]=r[a],r.pop()}}}class VK{constructor(e,i,n=null,r=i.blendMode){this._mixer=e,this._clip=i,this._localRoot=n,this.blendMode=r;const s=i.tracks,o=s.length,a=new Array(o),l={endingStart:gp,endingEnd:gp};for(let c=0;c!==o;++c){const h=s[c].createInterpolant(null);a[c]=h,h.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=IQ,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,i){return this.loop=e,this.repetitions=i,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,i,n){if(e.fadeOut(i),this.fadeIn(i),n){const r=this._clip.duration,s=e._clip.duration,o=s/r,a=r/s;e.warp(1,o,i),this.warp(a,1,i)}return this}crossFadeTo(e,i,n){return e.crossFadeFrom(this,i,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,i,n){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+n,c[0]=e/o,c[1]=i/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,i,n,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*n;l<0||n===0?i=0:(this._startTime=null,i=n*l)}i*=this._updateTimeScale(e);const o=this._updateTime(i),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case SN:for(let h=0,u=l.length;h!==u;++h)l[h].evaluate(o),c[h].accumulateAdditive(a);break;case hC:default:for(let h=0,u=l.length;h!==u;++h)l[h].evaluate(o),c[h].accumulate(r,a)}}}_updateWeight(e){let i=0;if(this.enabled){i=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(e)[0];i*=r,e>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=i,i}_updateTimeScale(e){let i=0;if(!this.paused){i=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const r=n.evaluate(e)[0];i*=r,e>n.parameterPositions[1]&&(this.stopWarping(),i===0?this.paused=!0:this.timeScale=i)}}return this._effectiveTimeScale=i,i}_updateTime(e){const i=this._clip.duration,n=this.loop;let r=this.time+e,s=this._loopCount;const o=n===LQ;if(e===0)return s===-1?r:o&&(s&1)===1?i-r:r;if(n===RQ){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=i)r=i;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=i||r<0){const a=Math.floor(r/i);r-=i*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?i:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return i-r}return r}_setEndings(e,i,n){const r=this._interpolantSettings;n?(r.endingStart=vp,r.endingEnd=vp):(e?r.endingStart=this.zeroSlopeAtStart?vp:gp:r.endingStart=x_,i?r.endingEnd=this.zeroSlopeAtEnd?vp:gp:r.endingEnd=x_)}_scheduleFading(e,i,n){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=i,a[1]=s+e,l[1]=n,this}}const xme=new Float32Array(1);class _me extends $c{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,i){const n=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=n.uuid,c=this._bindingsByRootAndName;let h=c[l];h===void 0&&(h={},c[l]=h);for(let u=0;u!==s;++u){const d=r[u],f=d.name;let p=h[f];if(p!==void 0)++p.referenceCount,o[u]=p;else{if(p=o[u],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,l,f));continue}const m=i&&i._propertyBindings[u].binding.parsedPath;p=new HK(bi.create(n,f,m),d.ValueTypeName,d.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,f),o[u]=p}a[u].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,n)}const i=e._propertyBindings;for(let n=0,r=i.length;n!==r;++n){const s=i[n];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const i=e._propertyBindings;for(let n=0,r=i.length;n!==r;++n){const s=i[n];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const i=e._cacheIndex;return i!==null&&i<this._nActiveActions}_addInactiveAction(e,i,n){const r=this._actions,s=this._actionsByClip;let o=s[i];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[i]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const i=this._actions,n=i[i.length-1],r=e._cacheIndex;n._cacheIndex=r,i[r]=n,i.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],h=e._byClipCacheIndex;c._byClipCacheIndex=h,l[h]=c,l.pop(),e._byClipCacheIndex=null;const u=a.actionByRoot,d=(e._localRoot||this._root).uuid;delete u[d],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const i=e._propertyBindings;for(let n=0,r=i.length;n!==r;++n){const s=i[n];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const i=this._actions,n=e._cacheIndex,r=this._nActiveActions++,s=i[r];e._cacheIndex=r,i[r]=e,s._cacheIndex=n,i[n]=s}_takeBackAction(e){const i=this._actions,n=e._cacheIndex,r=--this._nActiveActions,s=i[r];e._cacheIndex=r,i[r]=e,s._cacheIndex=n,i[n]=s}_addInactiveBinding(e,i,n){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[i];o===void 0&&(o={},r[i]=o),o[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const i=this._bindings,n=e.binding,r=n.rootNode.uuid,s=n.path,o=this._bindingsByRootAndName,a=o[r],l=i[i.length-1],c=e._cacheIndex;l._cacheIndex=c,i[c]=l,i.pop(),delete a[s],Object.keys(a).length===0&&delete o[r]}_lendBinding(e){const i=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,s=i[r];e._cacheIndex=r,i[r]=e,s._cacheIndex=n,i[n]=s}_takeBackBinding(e){const i=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,s=i[r];e._cacheIndex=r,i[r]=e,s._cacheIndex=n,i[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,i=this._nActiveControlInterpolants++;let n=e[i];return n===void 0&&(n=new ZN(new Float32Array(2),new Float32Array(2),1,xme),n.__cacheIndex=i,e[i]=n),n}_takeBackControlInterpolant(e){const i=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=i[r];e.__cacheIndex=r,i[r]=e,s.__cacheIndex=n,i[n]=s}clipAction(e,i,n){const r=i||this._root,s=r.uuid;let o=typeof e=="string"?_0.findByName(r,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let c=null;if(n===void 0&&(o!==null?n=o.blendMode:n=hC),l!==void 0){const u=l.actionByRoot[s];if(u!==void 0&&u.blendMode===n)return u;c=l.knownActions[0],o===null&&(o=c._clip)}if(o===null)return null;const h=new VK(this,o,i,n);return this._bindAction(h,c),this._addInactiveAction(h,a,s),h}existingAction(e,i){const n=i||this._root,r=n.uuid,s=typeof e=="string"?_0.findByName(n,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions,i=this._nActiveActions;for(let n=i-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const i=this._actions,n=this._nActiveActions,r=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==n;++c)i[c]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let i=0;i<this._actions.length;i++)this._actions[i].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const i=this._actions,n=e.uuid,r=this._actionsByClip,s=r[n];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const h=c._cacheIndex,u=i[i.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,u._cacheIndex=h,i[h]=u,i.pop(),this._removeInactiveBindingsForAction(c)}delete r[n]}}uncacheRoot(e){const i=e.uuid,n=this._actionsByClip;for(const o in n){const a=n[o].actionByRoot,l=a[i];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const r=this._bindingsByRootAndName,s=r[i];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,i){const n=this.existingAction(e,i);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class cU{constructor(e){this.value=e}clone(){return new cU(this.value.clone===void 0?this.value:this.value.clone())}}let wme=0;class bme extends $c{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:wme++}),this.name="",this.usage=__,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const i=this.uniforms.indexOf(e);return i!==-1&&this.uniforms.splice(i,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const i=e.uniforms;this.uniforms.length=0;for(let n=0,r=i.length;n<r;n++)this.uniforms.push(i[n].clone());return this}clone(){return new this.constructor().copy(this)}}class Sme extends mw{constructor(e,i,n=1){super(e,i),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const i=super.clone(e);return i.meshPerAttribute=this.meshPerAttribute,i}toJSON(e){const i=super.toJSON(e);return i.isInstancedInterleavedBuffer=!0,i.meshPerAttribute=this.meshPerAttribute,i}}class Ame{constructor(e,i,n,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=i,this.itemSize=n,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,i){return this.type=e,this.elementSize=i,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class jK{constructor(e,i,n=0,r=1/0){this.ray=new ty(e,i),this.near=n,this.far=r,this.camera=null,this.layers=new Lp,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,i){this.ray.set(e,i)}setFromCamera(e,i){i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type: "+i.type)}intersectObject(e,i=!0,n=[]){return VL(e,this,n,i),n.sort(Y5),n}intersectObjects(e,i=!0,n=[]){for(let r=0,s=e.length;r<s;r++)VL(e[r],this,n,i);return n.sort(Y5),n}}function Y5(t,e){return t.distance-e.distance}function VL(t,e,i,n){if(t.layers.test(e.layers)&&t.raycast(e,i),n===!0){const r=t.children;for(let s=0,o=r.length;s<o;s++)VL(r[s],e,i,!0)}}class jL{constructor(e=1,i=0,n=0){return this.radius=e,this.phi=i,this.theta=n,this}set(e,i,n){return this.radius=e,this.phi=i,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,i,n){return this.radius=Math.sqrt(e*e+i*i+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Bn(i/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Mme{constructor(e=1,i=0,n=0){return this.radius=e,this.theta=i,this.y=n,this}set(e,i,n){return this.radius=e,this.theta=i,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,i,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=i,this}clone(){return new this.constructor().copy(this)}}const Q5=new Qe;class Eme{constructor(e=new Qe(1/0,1/0),i=new Qe(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=i}set(e,i){return this.min.copy(e),this.max.copy(i),this}setFromPoints(e){this.makeEmpty();for(let i=0,n=e.length;i<n;i++)this.expandByPoint(e[i]);return this}setFromCenterAndSize(e,i){const n=Q5.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,i){return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,i){return i.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Q5).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const K5=new te,BS=new te;class Tme{constructor(e=new te,i=new te){this.start=e,this.end=i}set(e,i){return this.start.copy(e),this.end.copy(i),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,i){return this.delta(i).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,i){K5.subVectors(e,this.start),BS.subVectors(this.end,this.start);const n=BS.dot(BS);let s=BS.dot(K5)/n;return i&&(s=Bn(s,0,1)),s}closestPointToPoint(e,i,n){const r=this.closestPointToPointParameter(e,i);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const J5=new te;class Cme extends Si{constructor(e,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="SpotLightHelper";const n=new si,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const c=o/l*Math.PI*2,h=a/l*Math.PI*2;r.push(Math.cos(c),Math.sin(c),1,Math.cos(h),Math.sin(h),1)}n.setAttribute("position",new At(r,3));const s=new Ms({fog:!1,toneMapped:!1});this.cone=new Wl(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,i=e*Math.tan(this.light.angle);this.cone.scale.set(i,i,e),J5.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(J5),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Bh=new te,OS=new Wt,DD=new Wt;class Pme extends Wl{constructor(e){const i=WK(e),n=new si,r=[],s=[],o=new ht(0,0,1),a=new ht(0,1,0);for(let c=0;c<i.length;c++){const h=i[c];h.parent&&h.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}n.setAttribute("position",new At(r,3)),n.setAttribute("color",new At(s,3));const l=new Ms({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=i,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const i=this.bones,n=this.geometry,r=n.getAttribute("position");DD.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<i.length;s++){const a=i[s];a.parent&&a.parent.isBone&&(OS.multiplyMatrices(DD,a.matrixWorld),Bh.setFromMatrixPosition(OS),r.setXYZ(o,Bh.x,Bh.y,Bh.z),OS.multiplyMatrices(DD,a.parent.matrixWorld),Bh.setFromMatrixPosition(OS),r.setXYZ(o+1,Bh.x,Bh.y,Bh.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function WK(t){const e=[];t.isBone===!0&&e.push(t);for(let i=0;i<t.children.length;i++)e.push.apply(e,WK(t.children[i]));return e}class Dme extends Ur{constructor(e,i,n){const r=new xw(i,4,2),s=new jo({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Rme=new te,Z5=new ht,$5=new ht;class Ime extends Si{constructor(e,i,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new yw(i);r.rotateY(Math.PI*.5),this.material=new jo({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(s.count*3);r.setAttribute("color",new Ri(o,3)),this.add(new Ur(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const i=e.geometry.getAttribute("color");Z5.copy(this.light.color),$5.copy(this.light.groundColor);for(let n=0,r=i.count;n<r;n++){const s=n<r/2?Z5:$5;i.setXYZ(n,s.r,s.g,s.b)}i.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(Rme.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Lme extends Wl{constructor(e=10,i=10,n=4473924,r=8947848){n=new ht(n),r=new ht(r);const s=i/2,o=e/i,a=e/2,l=[],c=[];for(let d=0,f=0,p=-a;d<=i;d++,p+=o){l.push(-a,0,p,a,0,p),l.push(p,0,-a,p,0,a);const m=d===s?n:r;m.toArray(c,f),f+=3,m.toArray(c,f),f+=3,m.toArray(c,f),f+=3,m.toArray(c,f),f+=3}const h=new si;h.setAttribute("position",new At(l,3)),h.setAttribute("color",new At(c,3));const u=new Ms({vertexColors:!0,toneMapped:!1});super(h,u),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class Bme extends Wl{constructor(e=10,i=16,n=8,r=64,s=4473924,o=8947848){s=new ht(s),o=new ht(o);const a=[],l=[];if(i>1)for(let u=0;u<i;u++){const d=u/i*(Math.PI*2),f=Math.sin(d)*e,p=Math.cos(d)*e;a.push(0,0,0),a.push(f,0,p);const m=u&1?s:o;l.push(m.r,m.g,m.b),l.push(m.r,m.g,m.b)}for(let u=0;u<n;u++){const d=u&1?s:o,f=e-e/n*u;for(let p=0;p<r;p++){let m=p/r*(Math.PI*2),v=Math.sin(m)*f,g=Math.cos(m)*f;a.push(v,0,g),l.push(d.r,d.g,d.b),m=(p+1)/r*(Math.PI*2),v=Math.sin(m)*f,g=Math.cos(m)*f,a.push(v,0,g),l.push(d.r,d.g,d.b)}}const c=new si;c.setAttribute("position",new At(a,3)),c.setAttribute("color",new At(l,3));const h=new Ms({vertexColors:!0,toneMapped:!1});super(c,h),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const eV=new te,FS=new te,tV=new te;class Ome extends Si{constructor(e,i,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",i===void 0&&(i=1);let r=new si;r.setAttribute("position",new At([-i,i,0,i,i,0,i,-i,0,-i,-i,0,-i,i,0],3));const s=new Ms({fog:!1,toneMapped:!1});this.lightPlane=new ch(r,s),this.add(this.lightPlane),r=new si,r.setAttribute("position",new At([0,0,0,0,0,1],3)),this.targetLine=new ch(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),eV.setFromMatrixPosition(this.light.matrixWorld),FS.setFromMatrixPosition(this.light.target.matrixWorld),tV.subVectors(FS,eV),this.lightPlane.lookAt(FS),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(FS),this.targetLine.scale.z=tV.length()}}const NS=new te,Pn=new dw;class Fme extends Wl{constructor(e){const i=new si,n=new Ms({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(p,m){l(p),l(m)}function l(p){r.push(0,0,0),s.push(0,0,0),o[p]===void 0&&(o[p]=[]),o[p].push(r.length/3-1)}i.setAttribute("position",new At(r,3)),i.setAttribute("color",new At(s,3)),super(i,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const c=new ht(16755200),h=new ht(16711680),u=new ht(43775),d=new ht(16777215),f=new ht(3355443);this.setColors(c,h,u,d,f)}setColors(e,i,n,r,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,i.r,i.g,i.b),a.setXYZ(25,i.r,i.g,i.b),a.setXYZ(26,i.r,i.g,i.b),a.setXYZ(27,i.r,i.g,i.b),a.setXYZ(28,i.r,i.g,i.b),a.setXYZ(29,i.r,i.g,i.b),a.setXYZ(30,i.r,i.g,i.b),a.setXYZ(31,i.r,i.g,i.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,i=this.pointMap,n=1,r=1;Pn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Vn("c",i,e,Pn,0,0,-1),Vn("t",i,e,Pn,0,0,1),Vn("n1",i,e,Pn,-n,-r,-1),Vn("n2",i,e,Pn,n,-r,-1),Vn("n3",i,e,Pn,-n,r,-1),Vn("n4",i,e,Pn,n,r,-1),Vn("f1",i,e,Pn,-n,-r,1),Vn("f2",i,e,Pn,n,-r,1),Vn("f3",i,e,Pn,-n,r,1),Vn("f4",i,e,Pn,n,r,1),Vn("u1",i,e,Pn,n*.7,r*1.1,-1),Vn("u2",i,e,Pn,-n*.7,r*1.1,-1),Vn("u3",i,e,Pn,0,r*2,-1),Vn("cf1",i,e,Pn,-n,0,1),Vn("cf2",i,e,Pn,n,0,1),Vn("cf3",i,e,Pn,0,-r,1),Vn("cf4",i,e,Pn,0,r,1),Vn("cn1",i,e,Pn,-n,0,-1),Vn("cn2",i,e,Pn,n,0,-1),Vn("cn3",i,e,Pn,0,-r,-1),Vn("cn4",i,e,Pn,0,r,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Vn(t,e,i,n,r,s,o){NS.set(r,s,o).unproject(n);const a=e[t];if(a!==void 0){const l=i.getAttribute("position");for(let c=0,h=a.length;c<h;c++)l.setXYZ(a[c],NS.x,NS.y,NS.z)}}const US=new jl;class Nme extends Wl{constructor(e,i=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),s=new si;s.setIndex(new Ri(n,1)),s.setAttribute("position",new Ri(r,3)),super(s,new Ms({color:i,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&US.setFromObject(this.object),US.isEmpty())return;const i=US.min,n=US.max,r=this.geometry.attributes.position,s=r.array;s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=i.x,s[4]=n.y,s[5]=n.z,s[6]=i.x,s[7]=i.y,s[8]=n.z,s[9]=n.x,s[10]=i.y,s[11]=n.z,s[12]=n.x,s[13]=n.y,s[14]=i.z,s[15]=i.x,s[16]=n.y,s[17]=i.z,s[18]=i.x,s[19]=i.y,s[20]=i.z,s[21]=n.x,s[22]=i.y,s[23]=i.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,i){return super.copy(e,i),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Ume extends Wl{constructor(e,i=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new si;s.setIndex(new Ri(n,1)),s.setAttribute("position",new At(r,3)),super(s,new Ms({color:i,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const i=this.box;i.isEmpty()||(i.getCenter(this.position),i.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class kme extends ch{constructor(e,i=1,n=16776960){const r=n,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new si;o.setAttribute("position",new At(s,3)),o.computeBoundingSphere(),super(o,new Ms({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=i;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new si;l.setAttribute("position",new At(a,3)),l.computeBoundingSphere(),this.add(new Ur(l,new jo({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const iV=new te;let kS,RD;class zme extends Si{constructor(e=new te(0,0,1),i=new te(0,0,0),n=1,r=16776960,s=n*.2,o=s*.2){super(),this.type="ArrowHelper",kS===void 0&&(kS=new si,kS.setAttribute("position",new At([0,0,0,0,1,0],3)),RD=new ny(0,.5,1,5,1),RD.translate(0,-.5,0)),this.position.copy(i),this.line=new ch(kS,new Ms({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ur(RD,new jo({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{iV.set(e.z,0,-e.x).normalize();const i=Math.acos(e.y);this.quaternion.setFromAxisAngle(iV,i)}}setLength(e,i=e*.2,n=i*.2){this.line.scale.set(1,Math.max(1e-4,e-i),1),this.line.updateMatrix(),this.cone.scale.set(n,i,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class Gme extends Wl{constructor(e=1){const i=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new si;r.setAttribute("position",new At(i,3)),r.setAttribute("color",new At(n,3));const s=new Ms({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,i,n){const r=new ht,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(i),r.toArray(s,6),r.toArray(s,9),r.set(n),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Hme{constructor(){this.type="ShapePath",this.color=new ht,this.subPaths=[],this.currentPath=null}moveTo(e,i){return this.currentPath=new S_,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,i),this}lineTo(e,i){return this.currentPath.lineTo(e,i),this}quadraticCurveTo(e,i,n,r){return this.currentPath.quadraticCurveTo(e,i,n,r),this}bezierCurveTo(e,i,n,r,s,o){return this.currentPath.bezierCurveTo(e,i,n,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function i(g){const y=[];for(let x=0,b=g.length;x<b;x++){const S=g[x],A=new Bp;A.curves=S.curves,y.push(A)}return y}function n(g,y){const x=y.length;let b=!1;for(let S=x-1,A=0;A<x;S=A++){let E=y[S],M=y[A],T=M.x-E.x,P=M.y-E.y;if(Math.abs(P)>Number.EPSILON){if(P<0&&(E=y[A],T=-T,M=y[S],P=-P),g.y<E.y||g.y>M.y)continue;if(g.y===E.y){if(g.x===E.x)return!0}else{const R=P*(g.x-E.x)-T*(g.y-E.y);if(R===0)return!0;if(R<0)continue;b=!b}}else{if(g.y!==E.y)continue;if(M.x<=g.x&&g.x<=E.x||E.x<=g.x&&g.x<=M.x)return!0}}return b}const r=Uc.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const c=[];if(s.length===1)return a=s[0],l=new Bp,l.curves=a.curves,c.push(l),c;let h=!r(s[0].getPoints());h=e?!h:h;const u=[],d=[];let f=[],p=0,m;d[p]=void 0,f[p]=[];for(let g=0,y=s.length;g<y;g++)a=s[g],m=a.getPoints(),o=r(m),o=e?!o:o,o?(!h&&d[p]&&p++,d[p]={s:new Bp,p:m},d[p].s.curves=a.curves,h&&p++,f[p]=[]):f[p].push({h:a,p:m[0]});if(!d[0])return i(s);if(d.length>1){let g=!1,y=0;for(let x=0,b=d.length;x<b;x++)u[x]=[];for(let x=0,b=d.length;x<b;x++){const S=f[x];for(let A=0;A<S.length;A++){const E=S[A];let M=!0;for(let T=0;T<d.length;T++)n(E.p,d[T].p)&&(x!==T&&y++,M?(M=!1,u[T].push(E)):g=!0);M&&u[x].push(E)}}y>0&&g===!1&&(f=u)}let v;for(let g=0,y=d.length;g<y;g++){l=d[g].s,c.push(l),v=f[g];for(let x=0,b=v.length;x<b;x++)l.holes.push(v[x].h)}return c}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:cw}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=cw);const Vme=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:gN,AddEquation:sp,AddOperation:vQ,AdditiveAnimationBlendMode:SN,AdditiveBlending:aL,AlphaFormat:AQ,AlwaysCompare:XQ,AlwaysDepth:uQ,AlwaysStencilFunc:UQ,AmbientLight:OK,AmbientLightProbe:ime,AnimationAction:VK,AnimationClip:_0,AnimationLoader:Wpe,AnimationMixer:_me,AnimationObjectGroup:yme,AnimationUtils:Gpe,ArcCurve:hK,ArrayCamera:sK,ArrowHelper:zme,Audio:GK,AudioAnalyser:lme,AudioContext:sU,AudioListener:sme,AudioLoader:eme,AxesHelper:Gme,BackSide:Vs,BasicDepthPacking:OQ,BasicShadowMap:KY,Bone:vC,BooleanKeyframeTrack:mm,Box2:Eme,Box3:jl,Box3Helper:Ume,BoxGeometry:pm,BoxHelper:Nme,BufferAttribute:Ri,BufferGeometry:si,BufferGeometryLoader:kK,ByteType:bQ,Cache:nm,Camera:dw,CameraHelper:Fme,CanvasTexture:hpe,CapsuleGeometry:wC,CatmullRomCurve3:dK,CineonToneMapping:_Q,CircleGeometry:bC,ClampToEdgeWrapping:Jr,Clock:oU,Color:ht,ColorKeyframeTrack:$N,ColorManagement:Ea,CompressedArrayTexture:upe,CompressedTexture:VN,CompressedTextureLoader:Xpe,ConeGeometry:SC,CubeCamera:IN,CubeReflectionMapping:Xd,CubeRefractionMapping:qd,CubeTexture:fw,CubeTextureLoader:qpe,CubeUVReflectionMapping:ey,CubicBezierCurve:WN,CubicBezierCurve3:fK,CubicInterpolant:DK,CullFaceBack:oL,CullFaceFront:QY,CullFaceFrontBack:lle,CullFaceNone:YY,Curve:Xl,CurvePath:mK,CustomBlending:JY,CustomToneMapping:wQ,CylinderGeometry:ny,Cylindrical:Mme,Data3DTexture:PN,DataArrayTexture:dC,DataTexture:kv,DataTextureLoader:Ype,DataUtils:vce,DecrementStencilOp:vle,DecrementWrapStencilOp:xle,DefaultLoadingManager:pv,DepthFormat:Dd,DepthStencilFormat:em,DepthTexture:oK,DirectionalLight:rU,DirectionalLightHelper:Ome,DiscreteInterpolant:RK,DisplayP3ColorSpace:EN,DodecahedronGeometry:AC,DoubleSide:ka,DstAlphaFactor:rQ,DstColorFactor:oQ,DynamicCopyUsage:Ble,DynamicDrawUsage:Cle,DynamicReadUsage:Rle,EdgesGeometry:gK,EllipseCurve:xC,EqualCompare:GQ,EqualDepth:dQ,EqualStencilFunc:Sle,EquirectangularReflectionMapping:g_,EquirectangularRefractionMapping:v_,Euler:hw,EventDispatcher:$c,ExtrudeGeometry:EC,FileLoader:ia,Float16BufferAttribute:Sce,Float32BufferAttribute:At,Float64BufferAttribute:Ace,FloatType:Dc,Fog:gC,FogExp2:mC,FramebufferTexture:cpe,FrontSide:jc,Frustum:fC,GLBufferAttribute:Ame,GLSL1:Fle,GLSL3:OL,GreaterCompare:VQ,GreaterDepth:pQ,GreaterEqualCompare:WQ,GreaterEqualDepth:fQ,GreaterEqualStencilFunc:Tle,GreaterStencilFunc:Mle,GridHelper:Lme,Group:qu,HalfFloatType:f0,HemisphereLight:BK,HemisphereLightHelper:Ime,HemisphereLightProbe:tme,IcosahedronGeometry:TC,ImageBitmapLoader:zK,ImageLoader:T_,ImageUtils:CN,IncrementStencilOp:gle,IncrementWrapStencilOp:yle,InstancedBufferAttribute:v0,InstancedBufferGeometry:UK,InstancedInterleavedBuffer:Sme,InstancedMesh:zN,Int16BufferAttribute:wce,Int32BufferAttribute:bce,Int8BufferAttribute:yce,IntType:vN,InterleavedBuffer:mw,InterleavedBufferAttribute:Qd,Interpolant:ry,InterpolateDiscrete:p0,InterpolateLinear:tm,InterpolateSmooth:PM,InvertStencilOp:_le,KeepStencilOp:DM,KeyframeTrack:ql,LOD:uK,LatheGeometry:vw,Layers:Lp,LessCompare:zQ,LessDepth:hQ,LessEqualCompare:HQ,LessEqualDepth:SE,LessEqualStencilFunc:Ale,LessStencilFunc:ble,Light:uf,LightProbe:BC,Line:ch,Line3:Tme,LineBasicMaterial:Ms,LineCurve:_C,LineCurve3:pK,LineDashedMaterial:CK,LineLoop:GN,LineSegments:Wl,LinearEncoding:MN,LinearFilter:xn,LinearInterpolant:ZN,LinearMipMapLinearFilter:fle,LinearMipMapNearestFilter:dle,LinearMipmapLinearFilter:Wc,LinearMipmapNearestFilter:cC,LinearSRGBColorSpace:zl,LinearToneMapping:yQ,Loader:Es,LoaderUtils:kc,LoadingManager:eU,LoopOnce:RQ,LoopPingPong:LQ,LoopRepeat:IQ,LuminanceAlphaFormat:EQ,LuminanceFormat:MQ,MOUSE:Qf,Material:dr,MaterialLoader:OC,MathUtils:YQ,Matrix3:ci,Matrix4:Wt,MaxEquation:hL,Mesh:Ur,MeshBasicMaterial:jo,MeshDepthMaterial:ON,MeshDistanceMaterial:FN,MeshLambertMaterial:EK,MeshMatcapMaterial:TK,MeshNormalMaterial:MK,MeshPhongMaterial:SK,MeshPhysicalMaterial:eu,MeshStandardMaterial:_w,MeshToonMaterial:AK,MinEquation:uL,MirroredRepeatWrapping:d0,MixOperation:gQ,MultiplyBlending:cL,MultiplyOperation:uw,NearestFilter:Ln,NearestMipMapLinearFilter:hle,NearestMipMapNearestFilter:ule,NearestMipmapLinearFilter:Nv,NearestMipmapNearestFilter:y_,NeverCompare:kQ,NeverDepth:cQ,NeverStencilFunc:wle,NoBlending:$u,NoColorSpace:Id,NoToneMapping:Ll,NormalAnimationBlendMode:hC,NormalBlending:Rp,NotEqualCompare:jQ,NotEqualDepth:mQ,NotEqualStencilFunc:Ele,NumberKeyframeTrack:y0,Object3D:Si,ObjectLoader:Zpe,ObjectSpaceNormalMap:NQ,OctahedronGeometry:yw,OneFactor:tQ,OneMinusDstAlphaFactor:sQ,OneMinusDstColorFactor:aQ,OneMinusSrcAlphaFactor:mN,OneMinusSrcColorFactor:nQ,OrthographicCamera:Bl,PCFShadowMap:aC,PCFSoftShadowMap:S1,PMREMGenerator:NL,Path:S_,PerspectiveCamera:fn,Plane:ed,PlaneGeometry:pw,PlaneHelper:kme,PointLight:nU,PointLightHelper:Dme,Points:HN,PointsMaterial:yC,PolarGridHelper:Bme,PolyhedronGeometry:cf,PositionalAudio:ame,PropertyBinding:bi,PropertyMixer:HK,QuadraticBezierCurve:XN,QuadraticBezierCurve3:qN,Quaternion:Gr,QuaternionKeyframeTrack:Kd,QuaternionLinearInterpolant:IK,RED_GREEN_RGTC2_Format:LL,RED_RGTC1_Format:DQ,REVISION:cw,RGBADepthPacking:FQ,RGBAFormat:no,RGBAIntegerFormat:bN,RGBA_ASTC_10x10_Format:PL,RGBA_ASTC_10x5_Format:EL,RGBA_ASTC_10x6_Format:TL,RGBA_ASTC_10x8_Format:CL,RGBA_ASTC_12x10_Format:DL,RGBA_ASTC_12x12_Format:RL,RGBA_ASTC_4x4_Format:yL,RGBA_ASTC_5x4_Format:xL,RGBA_ASTC_5x5_Format:_L,RGBA_ASTC_6x5_Format:wL,RGBA_ASTC_6x6_Format:bL,RGBA_ASTC_8x5_Format:SL,RGBA_ASTC_8x6_Format:AL,RGBA_ASTC_8x8_Format:ML,RGBA_BPTC_Format:CM,RGBA_ETC2_EAC_Format:vL,RGBA_PVRTC_2BPPV1_Format:mL,RGBA_PVRTC_4BPPV1_Format:pL,RGBA_S3TC_DXT1_Format:MM,RGBA_S3TC_DXT3_Format:EM,RGBA_S3TC_DXT5_Format:TM,RGB_ETC1_Format:PQ,RGB_ETC2_Format:gL,RGB_PVRTC_2BPPV1_Format:fL,RGB_PVRTC_4BPPV1_Format:dL,RGB_S3TC_DXT1_Format:AM,RGFormat:CQ,RGIntegerFormat:wN,RawShaderMaterial:bK,Ray:ty,Raycaster:jK,RectAreaLight:FK,RedFormat:TQ,RedIntegerFormat:_N,ReinhardToneMapping:xQ,RepeatWrapping:Yd,ReplaceStencilOp:mle,ReverseSubtractEquation:$Y,RingGeometry:CC,SIGNED_RED_GREEN_RGTC2_Format:BL,SIGNED_RED_RGTC1_Format:IL,SRGBColorSpace:ni,Scene:TE,ShaderChunk:oi,ShaderLib:Al,ShaderMaterial:Xc,ShadowMaterial:wK,Shape:Bp,ShapeGeometry:PC,ShapePath:Hme,ShapeUtils:Uc,ShortType:SQ,Skeleton:gw,SkeletonHelper:Pme,SkinnedMesh:kN,Source:yp,Sphere:nl,SphereGeometry:xw,Spherical:jL,SphericalHarmonics3:NK,SplineCurve:YN,SpotLight:iU,SpotLightHelper:Cme,Sprite:cK,SpriteMaterial:UN,SrcAlphaFactor:pN,SrcAlphaSaturateFactor:lQ,SrcColorFactor:iQ,StaticCopyUsage:Lle,StaticDrawUsage:__,StaticReadUsage:Dle,StereoCamera:nme,StreamCopyUsage:Ole,StreamDrawUsage:Ple,StreamReadUsage:Ile,StringKeyframeTrack:gm,SubtractEquation:ZY,SubtractiveBlending:lL,TOUCH:Kf,TangentSpaceNormalMap:lf,TetrahedronGeometry:DC,Texture:pn,TextureLoader:LK,TorusGeometry:RC,TorusKnotGeometry:IC,Triangle:to,TriangleFanDrawMode:AE,TriangleStripDrawMode:AN,TrianglesDrawMode:BQ,TubeGeometry:LC,TwoPassDoubleSide:cle,UVMapping:lC,Uint16BufferAttribute:DN,Uint32BufferAttribute:RN,Uint8BufferAttribute:xce,Uint8ClampedBufferAttribute:_ce,Uniform:cU,UniformsGroup:bme,UniformsLib:ct,UniformsUtils:ZQ,UnsignedByteType:Nc,UnsignedInt248Type:Pd,UnsignedIntType:Xu,UnsignedShort4444Type:yN,UnsignedShort5551Type:xN,UnsignedShortType:uC,VSMShadowMap:wl,Vector2:Qe,Vector3:te,Vector4:zi,VectorKeyframeTrack:x0,VideoTexture:lpe,WebGL1Renderer:aK,WebGL3DRenderTarget:oce,WebGLArrayRenderTarget:sce,WebGLCoordinateSystem:Rc,WebGLCubeRenderTarget:LN,WebGLMultipleRenderTargets:ace,WebGLRenderTarget:Gl,WebGLRenderer:NN,WebGLUtils:rK,WebGPUCoordinateSystem:w_,WireframeGeometry:_K,WrapAroundEnding:x_,ZeroCurvatureEnding:gp,ZeroFactor:eQ,ZeroSlopeEnding:vp,ZeroStencilOp:ple,_SRGBAFormat:ME,sRGBEncoding:Rd},Symbol.toStringTag,{value:"Module"}));var XK={exports:{}},vm={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */vm.ConcurrentRoot=1;vm.ContinuousEventPriority=4;vm.DefaultEventPriority=16;vm.DiscreteEventPriority=1;vm.IdleEventPriority=536870912;vm.LegacyRoot=0;XK.exports=vm;var mv=XK.exports;function jme(t){let e;const i=new Set,n=(c,h)=>{const u=typeof c=="function"?c(e):c;if(u!==e){const d=e;e=h?u:Object.assign({},e,u),i.forEach(f=>f(e,d))}},r=()=>e,s=(c,h=r,u=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let d=h(e);function f(){const p=h(e);if(!u(d,p)){const m=d;c(d=p,m)}}return i.add(f),()=>i.delete(f)},l={setState:n,getState:r,subscribe:(c,h,u)=>h||u?s(c,h,u):(i.add(c),()=>i.delete(c)),destroy:()=>i.clear()};return e=t(n,r,l),l}const Wme=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),nV=Wme?ye.useEffect:ye.useLayoutEffect;function qK(t){const e=typeof t=="function"?jme(t):t,i=(n=e.getState,r=Object.is)=>{const[,s]=ye.useReducer(v=>v+1,0),o=e.getState(),a=ye.useRef(o),l=ye.useRef(n),c=ye.useRef(r),h=ye.useRef(!1),u=ye.useRef();u.current===void 0&&(u.current=n(o));let d,f=!1;(a.current!==o||l.current!==n||c.current!==r||h.current)&&(d=n(o),f=!r(u.current,d)),nV(()=>{f&&(u.current=d),a.current=o,l.current=n,c.current=r,h.current=!1});const p=ye.useRef(o);nV(()=>{const v=()=>{try{const y=e.getState(),x=l.current(y);c.current(u.current,x)||(a.current=y,u.current=x,s())}catch{h.current=!0,s()}},g=e.subscribe(v);return e.getState()!==p.current&&v(),g},[]);const m=f?d:u.current;return ye.useDebugValue(m),m};return Object.assign(i,e),i[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const n=[i,e];return{next(){const r=n.length<=0;return{value:n.shift(),done:r}}}},i}var YK={exports:{}},ID={exports:{}},LD={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rV;function Xme(){return rV||(rV=1,function(t){function e(B,j){var z=B.length;B.push(j);e:for(;0<z;){var k=z-1>>>1,G=B[k];if(0<r(G,j))B[k]=j,B[z]=G,z=k;else break e}}function i(B){return B.length===0?null:B[0]}function n(B){if(B.length===0)return null;var j=B[0],z=B.pop();if(z!==j){B[0]=z;e:for(var k=0,G=B.length,Z=G>>>1;k<Z;){var K=2*(k+1)-1,re=B[K],J=K+1,le=B[J];if(0>r(re,z))J<G&&0>r(le,re)?(B[k]=le,B[J]=z,k=J):(B[k]=re,B[K]=z,k=K);else if(J<G&&0>r(le,z))B[k]=le,B[J]=z,k=J;else break e}}return j}function r(B,j){var z=B.sortIndex-j.sortIndex;return z!==0?z:B.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,u=null,d=3,f=!1,p=!1,m=!1,v=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(B){for(var j=i(c);j!==null;){if(j.callback===null)n(c);else if(j.startTime<=B)n(c),j.sortIndex=j.expirationTime,e(l,j);else break;j=i(c)}}function b(B){if(m=!1,x(B),!p)if(i(l)!==null)p=!0,Q(S);else{var j=i(c);j!==null&&X(b,j.startTime-B)}}function S(B,j){p=!1,m&&(m=!1,g(M),M=-1),f=!0;var z=d;try{for(x(j),u=i(l);u!==null&&(!(u.expirationTime>j)||B&&!R());){var k=u.callback;if(typeof k=="function"){u.callback=null,d=u.priorityLevel;var G=k(u.expirationTime<=j);j=t.unstable_now(),typeof G=="function"?u.callback=G:u===i(l)&&n(l),x(j)}else n(l);u=i(l)}if(u!==null)var Z=!0;else{var K=i(c);K!==null&&X(b,K.startTime-j),Z=!1}return Z}finally{u=null,d=z,f=!1}}var A=!1,E=null,M=-1,T=5,P=-1;function R(){return!(t.unstable_now()-P<T)}function U(){if(E!==null){var B=t.unstable_now();P=B;var j=!0;try{j=E(!0,B)}finally{j?F():(A=!1,E=null)}}else A=!1}var F;if(typeof y=="function")F=function(){y(U)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,W=N.port2;N.port1.onmessage=U,F=function(){W.postMessage(null)}}else F=function(){v(U,0)};function Q(B){E=B,A||(A=!0,F())}function X(B,j){M=v(function(){B(t.unstable_now())},j)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,Q(S))},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return i(l)},t.unstable_next=function(B){switch(d){case 1:case 2:case 3:var j=3;break;default:j=d}var z=d;d=j;try{return B()}finally{d=z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(B,j){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var z=d;d=B;try{return j()}finally{d=z}},t.unstable_scheduleCallback=function(B,j,z){var k=t.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?k+z:k):z=k,B){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=z+G,B={id:h++,callback:j,priorityLevel:B,startTime:z,expirationTime:G,sortIndex:-1},z>k?(B.sortIndex=z,e(c,B),i(l)===null&&B===i(c)&&(m?(g(M),M=-1):m=!0,X(b,z-k))):(B.sortIndex=G,e(l,B),p||f||(p=!0,Q(S))),B},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(B){var j=d;return function(){var z=d;d=j;try{return B.apply(this,arguments)}finally{d=z}}}}(LD)),LD}var sV;function qme(){return sV||(sV=1,ID.exports=Xme()),ID.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yme=function(e){var i={},n=ye,r=qme(),s=Object.assign;function o(_){for(var w="https://reactjs.org/docs/error-decoder.html?invariant="+_,C=1;C<arguments.length;C++)w+="&args[]="+encodeURIComponent(arguments[C]);return"Minified React error #"+_+"; visit "+w+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),f=Symbol.for("react.provider"),p=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),g=Symbol.for("react.suspense_list"),y=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),b=Symbol.for("react.offscreen"),S=Symbol.iterator;function A(_){return _===null||typeof _!="object"?null:(_=S&&_[S]||_["@@iterator"],typeof _=="function"?_:null)}function E(_){if(_==null)return null;if(typeof _=="function")return _.displayName||_.name||null;if(typeof _=="string")return _;switch(_){case h:return"Fragment";case c:return"Portal";case d:return"Profiler";case u:return"StrictMode";case v:return"Suspense";case g:return"SuspenseList"}if(typeof _=="object")switch(_.$$typeof){case p:return(_.displayName||"Context")+".Consumer";case f:return(_._context.displayName||"Context")+".Provider";case m:var w=_.render;return _=_.displayName,_||(_=w.displayName||w.name||"",_=_!==""?"ForwardRef("+_+")":"ForwardRef"),_;case y:return w=_.displayName||null,w!==null?w:E(_.type)||"Memo";case x:w=_._payload,_=_._init;try{return E(_(w))}catch{}}return null}function M(_){var w=_.type;switch(_.tag){case 24:return"Cache";case 9:return(w.displayName||"Context")+".Consumer";case 10:return(w._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return _=w.render,_=_.displayName||_.name||"",w.displayName||(_!==""?"ForwardRef("+_+")":"ForwardRef");case 7:return"Fragment";case 5:return w;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return E(w);case 8:return w===u?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof w=="function")return w.displayName||w.name||null;if(typeof w=="string")return w}return null}function T(_){var w=_,C=_;if(_.alternate)for(;w.return;)w=w.return;else{_=w;do w=_,w.flags&4098&&(C=w.return),_=w.return;while(_)}return w.tag===3?C:null}function P(_){if(T(_)!==_)throw Error(o(188))}function R(_){var w=_.alternate;if(!w){if(w=T(_),w===null)throw Error(o(188));return w!==_?null:_}for(var C=_,D=w;;){var I=C.return;if(I===null)break;var H=I.alternate;if(H===null){if(D=I.return,D!==null){C=D;continue}break}if(I.child===H.child){for(H=I.child;H;){if(H===C)return P(I),_;if(H===D)return P(I),w;H=H.sibling}throw Error(o(188))}if(C.return!==D.return)C=I,D=H;else{for(var se=!1,Se=I.child;Se;){if(Se===C){se=!0,C=I,D=H;break}if(Se===D){se=!0,D=I,C=H;break}Se=Se.sibling}if(!se){for(Se=H.child;Se;){if(Se===C){se=!0,C=H,D=I;break}if(Se===D){se=!0,D=H,C=I;break}Se=Se.sibling}if(!se)throw Error(o(189))}}if(C.alternate!==D)throw Error(o(190))}if(C.tag!==3)throw Error(o(188));return C.stateNode.current===C?_:w}function U(_){return _=R(_),_!==null?F(_):null}function F(_){if(_.tag===5||_.tag===6)return _;for(_=_.child;_!==null;){var w=F(_);if(w!==null)return w;_=_.sibling}return null}function N(_){if(_.tag===5||_.tag===6)return _;for(_=_.child;_!==null;){if(_.tag!==4){var w=N(_);if(w!==null)return w}_=_.sibling}return null}var W=Array.isArray,Q=e.getPublicInstance,X=e.getRootHostContext,B=e.getChildHostContext,j=e.prepareForCommit,z=e.resetAfterCommit,k=e.createInstance,G=e.appendInitialChild,Z=e.finalizeInitialChildren,K=e.prepareUpdate,re=e.shouldSetTextContent,J=e.createTextInstance,le=e.scheduleTimeout,ae=e.cancelTimeout,fe=e.noTimeout,ge=e.isPrimaryRenderer,ve=e.supportsMutation,Y=e.supportsPersistence,ce=e.supportsHydration,de=e.getInstanceFromNode,xe=e.preparePortalMount,Ce=e.getCurrentEventPriority,Ne=e.detachDeletedInstance,Ie=e.supportsMicrotasks,Ge=e.scheduleMicrotask,tt=e.supportsTestSelectors,at=e.findFiberRoot,ee=e.getBoundingRect,O=e.getTextContent,V=e.isHiddenSubtree,ue=e.matchAccessibilityRole,Ee=e.setFocusIfFocusable,Te=e.setupIntersectionObserver,We=e.appendChild,Ve=e.appendChildToContainer,me=e.commitTextUpdate,be=e.commitMount,ne=e.commitUpdate,Ae=e.insertBefore,ke=e.insertInContainerBefore,Ue=e.removeChild,Je=e.removeChildFromContainer,ut=e.resetTextContent,Pt=e.hideInstance,q=e.hideTextInstance,pe=e.unhideInstance,oe=e.unhideTextInstance,Be=e.clearContainer,qe=e.cloneInstance,mt=e.createContainerChildSet,qt=e.appendChildToContainerChildSet,mi=e.finalizeContainerChildren,zn=e.replaceContainerChildren,kt=e.cloneHiddenInstance,mn=e.cloneHiddenTextInstance,Li=e.canHydrateInstance,gf=e.canHydrateTextInstance,Em=e.canHydrateSuspenseInstance,Tm=e.isSuspenseInstancePending,Kl=e.isSuspenseInstanceFallback,ie=e.registerSuspenseInstanceRetry,Le=e.getNextHydratableSibling,Xe=e.getFirstHydratableChild,De=e.getFirstHydratableChildWithinContainer,Ye=e.getFirstHydratableChildWithinSuspenseInstance,bt=e.hydrateInstance,$=e.hydrateTextInstance,we=e.hydrateSuspenseInstance,Re=e.getNextHydratableInstanceAfterSuspenseInstance,_e=e.commitHydratedContainer,Oe=e.commitHydratedSuspenseInstance,et=e.clearSuspenseBoundary,vt=e.clearSuspenseBoundaryFromContainer,St=e.shouldDeleteUnhydratedTailInstances,Tt=e.didNotMatchHydratedContainerTextInstance,Ht=e.didNotMatchHydratedTextInstance,xt;function lt(_){if(xt===void 0)try{throw Error()}catch(C){var w=C.stack.trim().match(/\n( *(at )?)/);xt=w&&w[1]||""}return`
`+xt+_}var Bi=!1;function Ni(_,w){if(!_||Bi)return"";Bi=!0;var C=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(w)if(w=function(){throw Error()},Object.defineProperty(w.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(w,[])}catch(nt){var D=nt}Reflect.construct(_,[],w)}else{try{w.call()}catch(nt){D=nt}_.call(w.prototype)}else{try{throw Error()}catch(nt){D=nt}_()}}catch(nt){if(nt&&D&&typeof nt.stack=="string"){for(var I=nt.stack.split(`
`),H=D.stack.split(`
`),se=I.length-1,Se=H.length-1;1<=se&&0<=Se&&I[se]!==H[Se];)Se--;for(;1<=se&&0<=Se;se--,Se--)if(I[se]!==H[Se]){if(se!==1||Se!==1)do if(se--,Se--,0>Se||I[se]!==H[Se]){var je=`
`+I[se].replace(" at new "," at ");return _.displayName&&je.includes("<anonymous>")&&(je=je.replace("<anonymous>",_.displayName)),je}while(1<=se&&0<=Se);break}}}finally{Bi=!1,Error.prepareStackTrace=C}return(_=_?_.displayName||_.name:"")?lt(_):""}var Gn=Object.prototype.hasOwnProperty,ns=[],Ai=-1;function Vt(_){return{current:_}}function jt(_){0>Ai||(_.current=ns[Ai],ns[Ai]=null,Ai--)}function Lt(_,w){Ai++,ns[Ai]=_.current,_.current=w}var $n={},Mi=Vt($n),un=Vt(!1),To=$n;function rn(_,w){var C=_.type.contextTypes;if(!C)return $n;var D=_.stateNode;if(D&&D.__reactInternalMemoizedUnmaskedChildContext===w)return D.__reactInternalMemoizedMaskedChildContext;var I={},H;for(H in C)I[H]=w[H];return D&&(_=_.stateNode,_.__reactInternalMemoizedUnmaskedChildContext=w,_.__reactInternalMemoizedMaskedChildContext=I),I}function Tn(_){return _=_.childContextTypes,_!=null}function _h(){jt(un),jt(Mi)}function rs(_,w,C){if(Mi.current!==$n)throw Error(o(168));Lt(Mi,w),Lt(un,C)}function Cm(_,w,C){var D=_.stateNode;if(w=w.childContextTypes,typeof D.getChildContext!="function")return C;D=D.getChildContext();for(var I in D)if(!(I in w))throw Error(o(108,M(_)||"Unknown",I));return s({},C,D)}function Pm(_){return _=(_=_.stateNode)&&_.__reactInternalMemoizedMergedChildContext||$n,To=Mi.current,Lt(Mi,_),Lt(un,un.current),!0}function Ay(_,w,C){var D=_.stateNode;if(!D)throw Error(o(169));C?(_=Cm(_,w,To),D.__reactInternalMemoizedMergedChildContext=_,jt(un),jt(Mi),Lt(Mi,_)):jt(un),Lt(un,C)}var rl=Math.clz32?Math.clz32:Ore,Lre=Math.log,Bre=Math.LN2;function Ore(_){return _>>>=0,_===0?32:31-(Lre(_)/Bre|0)|0}var jw=64,Ww=4194304;function My(_){switch(_&-_){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return _&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return _}}function Xw(_,w){var C=_.pendingLanes;if(C===0)return 0;var D=0,I=_.suspendedLanes,H=_.pingedLanes,se=C&268435455;if(se!==0){var Se=se&~I;Se!==0?D=My(Se):(H&=se,H!==0&&(D=My(H)))}else se=C&~I,se!==0?D=My(se):H!==0&&(D=My(H));if(D===0)return 0;if(w!==0&&w!==D&&!(w&I)&&(I=D&-D,H=w&-w,I>=H||I===16&&(H&4194240)!==0))return w;if(D&4&&(D|=C&16),w=_.entangledLanes,w!==0)for(_=_.entanglements,w&=D;0<w;)C=31-rl(w),I=1<<C,D|=_[C],w&=~I;return D}function Fre(_,w){switch(_){case 1:case 2:case 4:return w+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return w+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nre(_,w){for(var C=_.suspendedLanes,D=_.pingedLanes,I=_.expirationTimes,H=_.pendingLanes;0<H;){var se=31-rl(H),Se=1<<se,je=I[se];je===-1?(!(Se&C)||Se&D)&&(I[se]=Fre(Se,w)):je<=w&&(_.expiredLanes|=Se),H&=~Se}}function S2(_){return _=_.pendingLanes&-1073741825,_!==0?_:_&1073741824?1073741824:0}function A2(_){for(var w=[],C=0;31>C;C++)w.push(_);return w}function Ey(_,w,C){_.pendingLanes|=w,w!==536870912&&(_.suspendedLanes=0,_.pingedLanes=0),_=_.eventTimes,w=31-rl(w),_[w]=C}function Ure(_,w){var C=_.pendingLanes&~w;_.pendingLanes=w,_.suspendedLanes=0,_.pingedLanes=0,_.expiredLanes&=w,_.mutableReadLanes&=w,_.entangledLanes&=w,w=_.entanglements;var D=_.eventTimes;for(_=_.expirationTimes;0<C;){var I=31-rl(C),H=1<<I;w[I]=0,D[I]=-1,_[I]=-1,C&=~H}}function M2(_,w){var C=_.entangledLanes|=w;for(_=_.entanglements;C;){var D=31-rl(C),I=1<<D;I&w|_[D]&w&&(_[D]|=w),C&=~I}}var Ti=0;function Fz(_){return _&=-_,1<_?4<_?_&268435455?16:536870912:4:1}var E2=r.unstable_scheduleCallback,Nz=r.unstable_cancelCallback,kre=r.unstable_shouldYield,zre=r.unstable_requestPaint,Cr=r.unstable_now,T2=r.unstable_ImmediatePriority,Gre=r.unstable_UserBlockingPriority,C2=r.unstable_NormalPriority,Hre=r.unstable_IdlePriority,qw=null,Jl=null;function Vre(_){if(Jl&&typeof Jl.onCommitFiberRoot=="function")try{Jl.onCommitFiberRoot(qw,_,void 0,(_.current.flags&128)===128)}catch{}}function jre(_,w){return _===w&&(_!==0||1/_===1/w)||_!==_&&w!==w}var Zl=typeof Object.is=="function"?Object.is:jre,ru=null,Yw=!1,P2=!1;function Uz(_){ru===null?ru=[_]:ru.push(_)}function Wre(_){Yw=!0,Uz(_)}function $l(){if(!P2&&ru!==null){P2=!0;var _=0,w=Ti;try{var C=ru;for(Ti=1;_<C.length;_++){var D=C[_];do D=D(!0);while(D!==null)}ru=null,Yw=!1}catch(I){throw ru!==null&&(ru=ru.slice(_+1)),E2(T2,$l),I}finally{Ti=w,P2=!1}}return null}var Xre=a.ReactCurrentBatchConfig;function Qw(_,w){if(Zl(_,w))return!0;if(typeof _!="object"||_===null||typeof w!="object"||w===null)return!1;var C=Object.keys(_),D=Object.keys(w);if(C.length!==D.length)return!1;for(D=0;D<C.length;D++){var I=C[D];if(!Gn.call(w,I)||!Zl(_[I],w[I]))return!1}return!0}function qre(_){switch(_.tag){case 5:return lt(_.type);case 16:return lt("Lazy");case 13:return lt("Suspense");case 19:return lt("SuspenseList");case 0:case 2:case 15:return _=Ni(_.type,!1),_;case 11:return _=Ni(_.type.render,!1),_;case 1:return _=Ni(_.type,!0),_;default:return""}}function sl(_,w){if(_&&_.defaultProps){w=s({},w),_=_.defaultProps;for(var C in _)w[C]===void 0&&(w[C]=_[C]);return w}return w}var Kw=Vt(null),Jw=null,Dm=null,D2=null;function R2(){D2=Dm=Jw=null}function kz(_,w,C){ge?(Lt(Kw,w._currentValue),w._currentValue=C):(Lt(Kw,w._currentValue2),w._currentValue2=C)}function I2(_){var w=Kw.current;jt(Kw),ge?_._currentValue=w:_._currentValue2=w}function L2(_,w,C){for(;_!==null;){var D=_.alternate;if((_.childLanes&w)!==w?(_.childLanes|=w,D!==null&&(D.childLanes|=w)):D!==null&&(D.childLanes&w)!==w&&(D.childLanes|=w),_===C)break;_=_.return}}function Rm(_,w){Jw=_,D2=Dm=null,_=_.dependencies,_!==null&&_.firstContext!==null&&(_.lanes&w&&(Do=!0),_.firstContext=null)}function ca(_){var w=ge?_._currentValue:_._currentValue2;if(D2!==_)if(_={context:_,memoizedValue:w,next:null},Dm===null){if(Jw===null)throw Error(o(308));Dm=_,Jw.dependencies={lanes:0,firstContext:_}}else Dm=Dm.next=_;return w}var ec=null,wh=!1;function B2(_){_.updateQueue={baseState:_.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zz(_,w){_=_.updateQueue,w.updateQueue===_&&(w.updateQueue={baseState:_.baseState,firstBaseUpdate:_.firstBaseUpdate,lastBaseUpdate:_.lastBaseUpdate,shared:_.shared,effects:_.effects})}function su(_,w){return{eventTime:_,lane:w,tag:0,payload:null,callback:null,next:null}}function bh(_,w){var C=_.updateQueue;C!==null&&(C=C.shared,er!==null&&_.mode&1&&!(di&2)?(_=C.interleaved,_===null?(w.next=w,ec===null?ec=[C]:ec.push(C)):(w.next=_.next,_.next=w),C.interleaved=w):(_=C.pending,_===null?w.next=w:(w.next=_.next,_.next=w),C.pending=w))}function Zw(_,w,C){if(w=w.updateQueue,w!==null&&(w=w.shared,(C&4194240)!==0)){var D=w.lanes;D&=_.pendingLanes,C|=D,w.lanes=C,M2(_,C)}}function Gz(_,w){var C=_.updateQueue,D=_.alternate;if(D!==null&&(D=D.updateQueue,C===D)){var I=null,H=null;if(C=C.firstBaseUpdate,C!==null){do{var se={eventTime:C.eventTime,lane:C.lane,tag:C.tag,payload:C.payload,callback:C.callback,next:null};H===null?I=H=se:H=H.next=se,C=C.next}while(C!==null);H===null?I=H=w:H=H.next=w}else I=H=w;C={baseState:D.baseState,firstBaseUpdate:I,lastBaseUpdate:H,shared:D.shared,effects:D.effects},_.updateQueue=C;return}_=C.lastBaseUpdate,_===null?C.firstBaseUpdate=w:_.next=w,C.lastBaseUpdate=w}function $w(_,w,C,D){var I=_.updateQueue;wh=!1;var H=I.firstBaseUpdate,se=I.lastBaseUpdate,Se=I.shared.pending;if(Se!==null){I.shared.pending=null;var je=Se,nt=je.next;je.next=null,se===null?H=nt:se.next=nt,se=je;var wt=_.alternate;wt!==null&&(wt=wt.updateQueue,Se=wt.lastBaseUpdate,Se!==se&&(Se===null?wt.firstBaseUpdate=nt:Se.next=nt,wt.lastBaseUpdate=je))}if(H!==null){var ei=I.baseState;se=0,wt=nt=je=null,Se=H;do{var Bt=Se.lane,Yi=Se.eventTime;if((D&Bt)===Bt){wt!==null&&(wt=wt.next={eventTime:Yi,lane:0,tag:Se.tag,payload:Se.payload,callback:Se.callback,next:null});e:{var Et=_,ls=Se;switch(Bt=w,Yi=C,ls.tag){case 1:if(Et=ls.payload,typeof Et=="function"){ei=Et.call(Yi,ei,Bt);break e}ei=Et;break e;case 3:Et.flags=Et.flags&-65537|128;case 0:if(Et=ls.payload,Bt=typeof Et=="function"?Et.call(Yi,ei,Bt):Et,Bt==null)break e;ei=s({},ei,Bt);break e;case 2:wh=!0}}Se.callback!==null&&Se.lane!==0&&(_.flags|=64,Bt=I.effects,Bt===null?I.effects=[Se]:Bt.push(Se))}else Yi={eventTime:Yi,lane:Bt,tag:Se.tag,payload:Se.payload,callback:Se.callback,next:null},wt===null?(nt=wt=Yi,je=ei):wt=wt.next=Yi,se|=Bt;if(Se=Se.next,Se===null){if(Se=I.shared.pending,Se===null)break;Bt=Se,Se=Bt.next,Bt.next=null,I.lastBaseUpdate=Bt,I.shared.pending=null}}while(1);if(wt===null&&(je=ei),I.baseState=je,I.firstBaseUpdate=nt,I.lastBaseUpdate=wt,w=I.shared.interleaved,w!==null){I=w;do se|=I.lane,I=I.next;while(I!==w)}else H===null&&(I.shared.lanes=0);zm|=se,_.lanes=se,_.memoizedState=ei}}function Hz(_,w,C){if(_=w.effects,w.effects=null,_!==null)for(w=0;w<_.length;w++){var D=_[w],I=D.callback;if(I!==null){if(D.callback=null,D=C,typeof I!="function")throw Error(o(191,I));I.call(D)}}}var Vz=new n.Component().refs;function O2(_,w,C,D){w=_.memoizedState,C=C(D,w),C=C==null?w:s({},w,C),_.memoizedState=C,_.lanes===0&&(_.updateQueue.baseState=C)}var eb={isMounted:function(_){return(_=_._reactInternals)?T(_)===_:!1},enqueueSetState:function(_,w,C){_=_._reactInternals;var D=Cs(),I=Mh(_),H=su(D,I);H.payload=w,C!=null&&(H.callback=C),bh(_,H),w=pa(_,I,D),w!==null&&Zw(w,_,I)},enqueueReplaceState:function(_,w,C){_=_._reactInternals;var D=Cs(),I=Mh(_),H=su(D,I);H.tag=1,H.payload=w,C!=null&&(H.callback=C),bh(_,H),w=pa(_,I,D),w!==null&&Zw(w,_,I)},enqueueForceUpdate:function(_,w){_=_._reactInternals;var C=Cs(),D=Mh(_),I=su(C,D);I.tag=2,w!=null&&(I.callback=w),bh(_,I),w=pa(_,D,C),w!==null&&Zw(w,_,D)}};function jz(_,w,C,D,I,H,se){return _=_.stateNode,typeof _.shouldComponentUpdate=="function"?_.shouldComponentUpdate(D,H,se):w.prototype&&w.prototype.isPureReactComponent?!Qw(C,D)||!Qw(I,H):!0}function Wz(_,w,C){var D=!1,I=$n,H=w.contextType;return typeof H=="object"&&H!==null?H=ca(H):(I=Tn(w)?To:Mi.current,D=w.contextTypes,H=(D=D!=null)?rn(_,I):$n),w=new w(C,H),_.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=eb,_.stateNode=w,w._reactInternals=_,D&&(_=_.stateNode,_.__reactInternalMemoizedUnmaskedChildContext=I,_.__reactInternalMemoizedMaskedChildContext=H),w}function Xz(_,w,C,D){_=w.state,typeof w.componentWillReceiveProps=="function"&&w.componentWillReceiveProps(C,D),typeof w.UNSAFE_componentWillReceiveProps=="function"&&w.UNSAFE_componentWillReceiveProps(C,D),w.state!==_&&eb.enqueueReplaceState(w,w.state,null)}function F2(_,w,C,D){var I=_.stateNode;I.props=C,I.state=_.memoizedState,I.refs=Vz,B2(_);var H=w.contextType;typeof H=="object"&&H!==null?I.context=ca(H):(H=Tn(w)?To:Mi.current,I.context=rn(_,H)),I.state=_.memoizedState,H=w.getDerivedStateFromProps,typeof H=="function"&&(O2(_,w,H,C),I.state=_.memoizedState),typeof w.getDerivedStateFromProps=="function"||typeof I.getSnapshotBeforeUpdate=="function"||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(w=I.state,typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount(),w!==I.state&&eb.enqueueReplaceState(I,I.state,null),$w(_,C,I,D),I.state=_.memoizedState),typeof I.componentDidMount=="function"&&(_.flags|=4194308)}var Im=[],Lm=0,tb=null,ib=0,ua=[],ha=0,vf=null,ou=1,au="";function yf(_,w){Im[Lm++]=ib,Im[Lm++]=tb,tb=_,ib=w}function qz(_,w,C){ua[ha++]=ou,ua[ha++]=au,ua[ha++]=vf,vf=_;var D=ou;_=au;var I=32-rl(D)-1;D&=~(1<<I),C+=1;var H=32-rl(w)+I;if(30<H){var se=I-I%5;H=(D&(1<<se)-1).toString(32),D>>=se,I-=se,ou=1<<32-rl(w)+I|C<<I|D,au=H+_}else ou=1<<H|C<<I|D,au=_}function N2(_){_.return!==null&&(yf(_,1),qz(_,1,0))}function U2(_){for(;_===tb;)tb=Im[--Lm],Im[Lm]=null,ib=Im[--Lm],Im[Lm]=null;for(;_===vf;)vf=ua[--ha],ua[ha]=null,au=ua[--ha],ua[ha]=null,ou=ua[--ha],ua[ha]=null}var Co=null,Po=null,hn=!1,Ty=!1,ol=null;function Yz(_,w){var C=ma(5,null,null,0);C.elementType="DELETED",C.stateNode=w,C.return=_,w=_.deletions,w===null?(_.deletions=[C],_.flags|=16):w.push(C)}function Qz(_,w){switch(_.tag){case 5:return w=Li(w,_.type,_.pendingProps),w!==null?(_.stateNode=w,Co=_,Po=Xe(w),!0):!1;case 6:return w=gf(w,_.pendingProps),w!==null?(_.stateNode=w,Co=_,Po=null,!0):!1;case 13:if(w=Em(w),w!==null){var C=vf!==null?{id:ou,overflow:au}:null;return _.memoizedState={dehydrated:w,treeContext:C,retryLane:1073741824},C=ma(18,null,null,0),C.stateNode=w,C.return=_,_.child=C,Co=_,Po=null,!0}return!1;default:return!1}}function k2(_){return(_.mode&1)!==0&&(_.flags&128)===0}function z2(_){if(hn){var w=Po;if(w){var C=w;if(!Qz(_,w)){if(k2(_))throw Error(o(418));w=Le(C);var D=Co;w&&Qz(_,w)?Yz(D,C):(_.flags=_.flags&-4097|2,hn=!1,Co=_)}}else{if(k2(_))throw Error(o(418));_.flags=_.flags&-4097|2,hn=!1,Co=_}}}function Kz(_){for(_=_.return;_!==null&&_.tag!==5&&_.tag!==3&&_.tag!==13;)_=_.return;Co=_}function Cy(_){if(!ce||_!==Co)return!1;if(!hn)return Kz(_),hn=!0,!1;if(_.tag!==3&&(_.tag!==5||St(_.type)&&!re(_.type,_.memoizedProps))){var w=Po;if(w){if(k2(_)){for(_=Po;_;)_=Le(_);throw Error(o(418))}for(;w;)Yz(_,w),w=Le(w)}}if(Kz(_),_.tag===13){if(!ce)throw Error(o(316));if(_=_.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(o(317));Po=Re(_)}else Po=Co?Le(_.stateNode):null;return!0}function Bm(){ce&&(Po=Co=null,Ty=hn=!1)}function G2(_){ol===null?ol=[_]:ol.push(_)}function Py(_,w,C){if(_=C.ref,_!==null&&typeof _!="function"&&typeof _!="object"){if(C._owner){if(C=C._owner,C){if(C.tag!==1)throw Error(o(309));var D=C.stateNode}if(!D)throw Error(o(147,_));var I=D,H=""+_;return w!==null&&w.ref!==null&&typeof w.ref=="function"&&w.ref._stringRef===H?w.ref:(w=function(se){var Se=I.refs;Se===Vz&&(Se=I.refs={}),se===null?delete Se[H]:Se[H]=se},w._stringRef=H,w)}if(typeof _!="string")throw Error(o(284));if(!C._owner)throw Error(o(290,_))}return _}function nb(_,w){throw _=Object.prototype.toString.call(w),Error(o(31,_==="[object Object]"?"object with keys {"+Object.keys(w).join(", ")+"}":_))}function Jz(_){var w=_._init;return w(_._payload)}function Zz(_){function w(Fe,Me){if(_){var He=Fe.deletions;He===null?(Fe.deletions=[Me],Fe.flags|=16):He.push(Me)}}function C(Fe,Me){if(!_)return null;for(;Me!==null;)w(Fe,Me),Me=Me.sibling;return null}function D(Fe,Me){for(Fe=new Map;Me!==null;)Me.key!==null?Fe.set(Me.key,Me):Fe.set(Me.index,Me),Me=Me.sibling;return Fe}function I(Fe,Me){return Fe=Th(Fe,Me),Fe.index=0,Fe.sibling=null,Fe}function H(Fe,Me,He){return Fe.index=He,_?(He=Fe.alternate,He!==null?(He=He.index,He<Me?(Fe.flags|=2,Me):He):(Fe.flags|=2,Me)):(Fe.flags|=1048576,Me)}function se(Fe){return _&&Fe.alternate===null&&(Fe.flags|=2),Fe}function Se(Fe,Me,He,ft){return Me===null||Me.tag!==6?(Me=AP(He,Fe.mode,ft),Me.return=Fe,Me):(Me=I(Me,He),Me.return=Fe,Me)}function je(Fe,Me,He,ft){var Mt=He.type;return Mt===h?wt(Fe,Me,He.props.children,ft,He.key):Me!==null&&(Me.elementType===Mt||typeof Mt=="object"&&Mt!==null&&Mt.$$typeof===x&&Jz(Mt)===Me.type)?(ft=I(Me,He.props),ft.ref=Py(Fe,Me,He),ft.return=Fe,ft):(ft=Bb(He.type,He.key,He.props,null,Fe.mode,ft),ft.ref=Py(Fe,Me,He),ft.return=Fe,ft)}function nt(Fe,Me,He,ft){return Me===null||Me.tag!==4||Me.stateNode.containerInfo!==He.containerInfo||Me.stateNode.implementation!==He.implementation?(Me=MP(He,Fe.mode,ft),Me.return=Fe,Me):(Me=I(Me,He.children||[]),Me.return=Fe,Me)}function wt(Fe,Me,He,ft,Mt){return Me===null||Me.tag!==7?(Me=Mf(He,Fe.mode,ft,Mt),Me.return=Fe,Me):(Me=I(Me,He),Me.return=Fe,Me)}function ei(Fe,Me,He){if(typeof Me=="string"&&Me!==""||typeof Me=="number")return Me=AP(""+Me,Fe.mode,He),Me.return=Fe,Me;if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case l:return He=Bb(Me.type,Me.key,Me.props,null,Fe.mode,He),He.ref=Py(Fe,null,Me),He.return=Fe,He;case c:return Me=MP(Me,Fe.mode,He),Me.return=Fe,Me;case x:var ft=Me._init;return ei(Fe,ft(Me._payload),He)}if(W(Me)||A(Me))return Me=Mf(Me,Fe.mode,He,null),Me.return=Fe,Me;nb(Fe,Me)}return null}function Bt(Fe,Me,He,ft){var Mt=Me!==null?Me.key:null;if(typeof He=="string"&&He!==""||typeof He=="number")return Mt!==null?null:Se(Fe,Me,""+He,ft);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case l:return He.key===Mt?je(Fe,Me,He,ft):null;case c:return He.key===Mt?nt(Fe,Me,He,ft):null;case x:return Mt=He._init,Bt(Fe,Me,Mt(He._payload),ft)}if(W(He)||A(He))return Mt!==null?null:wt(Fe,Me,He,ft,null);nb(Fe,He)}return null}function Yi(Fe,Me,He,ft,Mt){if(typeof ft=="string"&&ft!==""||typeof ft=="number")return Fe=Fe.get(He)||null,Se(Me,Fe,""+ft,Mt);if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case l:return Fe=Fe.get(ft.key===null?He:ft.key)||null,je(Me,Fe,ft,Mt);case c:return Fe=Fe.get(ft.key===null?He:ft.key)||null,nt(Me,Fe,ft,Mt);case x:var ai=ft._init;return Yi(Fe,Me,He,ai(ft._payload),Mt)}if(W(ft)||A(ft))return Fe=Fe.get(He)||null,wt(Me,Fe,ft,Mt,null);nb(Me,ft)}return null}function Et(Fe,Me,He,ft){for(var Mt=null,ai=null,ti=Me,Ci=Me=0,Dr=null;ti!==null&&Ci<He.length;Ci++){ti.index>Ci?(Dr=ti,ti=null):Dr=ti.sibling;var Pi=Bt(Fe,ti,He[Ci],ft);if(Pi===null){ti===null&&(ti=Dr);break}_&&ti&&Pi.alternate===null&&w(Fe,ti),Me=H(Pi,Me,Ci),ai===null?Mt=Pi:ai.sibling=Pi,ai=Pi,ti=Dr}if(Ci===He.length)return C(Fe,ti),hn&&yf(Fe,Ci),Mt;if(ti===null){for(;Ci<He.length;Ci++)ti=ei(Fe,He[Ci],ft),ti!==null&&(Me=H(ti,Me,Ci),ai===null?Mt=ti:ai.sibling=ti,ai=ti);return hn&&yf(Fe,Ci),Mt}for(ti=D(Fe,ti);Ci<He.length;Ci++)Dr=Yi(ti,Fe,Ci,He[Ci],ft),Dr!==null&&(_&&Dr.alternate!==null&&ti.delete(Dr.key===null?Ci:Dr.key),Me=H(Dr,Me,Ci),ai===null?Mt=Dr:ai.sibling=Dr,ai=Dr);return _&&ti.forEach(function(Ch){return w(Fe,Ch)}),hn&&yf(Fe,Ci),Mt}function ls(Fe,Me,He,ft){var Mt=A(He);if(typeof Mt!="function")throw Error(o(150));if(He=Mt.call(He),He==null)throw Error(o(151));for(var ai=Mt=null,ti=Me,Ci=Me=0,Dr=null,Pi=He.next();ti!==null&&!Pi.done;Ci++,Pi=He.next()){ti.index>Ci?(Dr=ti,ti=null):Dr=ti.sibling;var Ch=Bt(Fe,ti,Pi.value,ft);if(Ch===null){ti===null&&(ti=Dr);break}_&&ti&&Ch.alternate===null&&w(Fe,ti),Me=H(Ch,Me,Ci),ai===null?Mt=Ch:ai.sibling=Ch,ai=Ch,ti=Dr}if(Pi.done)return C(Fe,ti),hn&&yf(Fe,Ci),Mt;if(ti===null){for(;!Pi.done;Ci++,Pi=He.next())Pi=ei(Fe,Pi.value,ft),Pi!==null&&(Me=H(Pi,Me,Ci),ai===null?Mt=Pi:ai.sibling=Pi,ai=Pi);return hn&&yf(Fe,Ci),Mt}for(ti=D(Fe,ti);!Pi.done;Ci++,Pi=He.next())Pi=Yi(ti,Fe,Ci,Pi.value,ft),Pi!==null&&(_&&Pi.alternate!==null&&ti.delete(Pi.key===null?Ci:Pi.key),Me=H(Pi,Me,Ci),ai===null?Mt=Pi:ai.sibling=Pi,ai=Pi);return _&&ti.forEach(function(Sse){return w(Fe,Sse)}),hn&&yf(Fe,Ci),Mt}function ga(Fe,Me,He,ft){if(typeof He=="object"&&He!==null&&He.type===h&&He.key===null&&(He=He.props.children),typeof He=="object"&&He!==null){switch(He.$$typeof){case l:e:{for(var Mt=He.key,ai=Me;ai!==null;){if(ai.key===Mt){if(Mt=He.type,Mt===h){if(ai.tag===7){C(Fe,ai.sibling),Me=I(ai,He.props.children),Me.return=Fe,Fe=Me;break e}}else if(ai.elementType===Mt||typeof Mt=="object"&&Mt!==null&&Mt.$$typeof===x&&Jz(Mt)===ai.type){C(Fe,ai.sibling),Me=I(ai,He.props),Me.ref=Py(Fe,ai,He),Me.return=Fe,Fe=Me;break e}C(Fe,ai);break}else w(Fe,ai);ai=ai.sibling}He.type===h?(Me=Mf(He.props.children,Fe.mode,ft,He.key),Me.return=Fe,Fe=Me):(ft=Bb(He.type,He.key,He.props,null,Fe.mode,ft),ft.ref=Py(Fe,Me,He),ft.return=Fe,Fe=ft)}return se(Fe);case c:e:{for(ai=He.key;Me!==null;){if(Me.key===ai)if(Me.tag===4&&Me.stateNode.containerInfo===He.containerInfo&&Me.stateNode.implementation===He.implementation){C(Fe,Me.sibling),Me=I(Me,He.children||[]),Me.return=Fe,Fe=Me;break e}else{C(Fe,Me);break}else w(Fe,Me);Me=Me.sibling}Me=MP(He,Fe.mode,ft),Me.return=Fe,Fe=Me}return se(Fe);case x:return ai=He._init,ga(Fe,Me,ai(He._payload),ft)}if(W(He))return Et(Fe,Me,He,ft);if(A(He))return ls(Fe,Me,He,ft);nb(Fe,He)}return typeof He=="string"&&He!==""||typeof He=="number"?(He=""+He,Me!==null&&Me.tag===6?(C(Fe,Me.sibling),Me=I(Me,He),Me.return=Fe,Fe=Me):(C(Fe,Me),Me=AP(He,Fe.mode,ft),Me.return=Fe,Fe=Me),se(Fe)):C(Fe,Me)}return ga}var Om=Zz(!0),$z=Zz(!1),Dy={},da=Vt(Dy),Ry=Vt(Dy),Fm=Vt(Dy);function tc(_){if(_===Dy)throw Error(o(174));return _}function H2(_,w){Lt(Fm,w),Lt(Ry,_),Lt(da,Dy),_=X(w),jt(da),Lt(da,_)}function Nm(){jt(da),jt(Ry),jt(Fm)}function e4(_){var w=tc(Fm.current),C=tc(da.current);w=B(C,_.type,w),C!==w&&(Lt(Ry,_),Lt(da,w))}function V2(_){Ry.current===_&&(jt(da),jt(Ry))}var gn=Vt(0);function rb(_){for(var w=_;w!==null;){if(w.tag===13){var C=w.memoizedState;if(C!==null&&(C=C.dehydrated,C===null||Tm(C)||Kl(C)))return w}else if(w.tag===19&&w.memoizedProps.revealOrder!==void 0){if(w.flags&128)return w}else if(w.child!==null){w.child.return=w,w=w.child;continue}if(w===_)break;for(;w.sibling===null;){if(w.return===null||w.return===_)return null;w=w.return}w.sibling.return=w.return,w=w.sibling}return null}var j2=[];function W2(){for(var _=0;_<j2.length;_++){var w=j2[_];ge?w._workInProgressVersionPrimary=null:w._workInProgressVersionSecondary=null}j2.length=0}var sb=a.ReactCurrentDispatcher,fa=a.ReactCurrentBatchConfig,Um=0,Cn=null,ss=null,Pr=null,ob=!1,Iy=!1,Ly=0,Yre=0;function os(){throw Error(o(321))}function X2(_,w){if(w===null)return!1;for(var C=0;C<w.length&&C<_.length;C++)if(!Zl(_[C],w[C]))return!1;return!0}function q2(_,w,C,D,I,H){if(Um=H,Cn=w,w.memoizedState=null,w.updateQueue=null,w.lanes=0,sb.current=_===null||_.memoizedState===null?Zre:$re,_=C(D,I),Iy){H=0;do{if(Iy=!1,Ly=0,25<=H)throw Error(o(301));H+=1,Pr=ss=null,w.updateQueue=null,sb.current=ese,_=C(D,I)}while(Iy)}if(sb.current=hb,w=ss!==null&&ss.next!==null,Um=0,Pr=ss=Cn=null,ob=!1,w)throw Error(o(300));return _}function Y2(){var _=Ly!==0;return Ly=0,_}function lu(){var _={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pr===null?Cn.memoizedState=Pr=_:Pr=Pr.next=_,Pr}function ic(){if(ss===null){var _=Cn.alternate;_=_!==null?_.memoizedState:null}else _=ss.next;var w=Pr===null?Cn.memoizedState:Pr.next;if(w!==null)Pr=w,ss=_;else{if(_===null)throw Error(o(310));ss=_,_={memoizedState:ss.memoizedState,baseState:ss.baseState,baseQueue:ss.baseQueue,queue:ss.queue,next:null},Pr===null?Cn.memoizedState=Pr=_:Pr=Pr.next=_}return Pr}function xf(_,w){return typeof w=="function"?w(_):w}function ab(_){var w=ic(),C=w.queue;if(C===null)throw Error(o(311));C.lastRenderedReducer=_;var D=ss,I=D.baseQueue,H=C.pending;if(H!==null){if(I!==null){var se=I.next;I.next=H.next,H.next=se}D.baseQueue=I=H,C.pending=null}if(I!==null){H=I.next,D=D.baseState;var Se=se=null,je=null,nt=H;do{var wt=nt.lane;if((Um&wt)===wt)je!==null&&(je=je.next={lane:0,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null}),D=nt.hasEagerState?nt.eagerState:_(D,nt.action);else{var ei={lane:wt,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null};je===null?(Se=je=ei,se=D):je=je.next=ei,Cn.lanes|=wt,zm|=wt}nt=nt.next}while(nt!==null&&nt!==H);je===null?se=D:je.next=Se,Zl(D,w.memoizedState)||(Do=!0),w.memoizedState=D,w.baseState=se,w.baseQueue=je,C.lastRenderedState=D}if(_=C.interleaved,_!==null){I=_;do H=I.lane,Cn.lanes|=H,zm|=H,I=I.next;while(I!==_)}else I===null&&(C.lanes=0);return[w.memoizedState,C.dispatch]}function lb(_){var w=ic(),C=w.queue;if(C===null)throw Error(o(311));C.lastRenderedReducer=_;var D=C.dispatch,I=C.pending,H=w.memoizedState;if(I!==null){C.pending=null;var se=I=I.next;do H=_(H,se.action),se=se.next;while(se!==I);Zl(H,w.memoizedState)||(Do=!0),w.memoizedState=H,w.baseQueue===null&&(w.baseState=H),C.lastRenderedState=H}return[H,D]}function t4(){}function i4(_,w){var C=Cn,D=ic(),I=w(),H=!Zl(D.memoizedState,I);if(H&&(D.memoizedState=I,Do=!0),D=D.queue,Oy(s4.bind(null,C,D,_),[_]),D.getSnapshot!==w||H||Pr!==null&&Pr.memoizedState.tag&1){if(C.flags|=2048,By(9,r4.bind(null,C,D,I,w),void 0,null),er===null)throw Error(o(349));Um&30||n4(C,w,I)}return I}function n4(_,w,C){_.flags|=16384,_={getSnapshot:w,value:C},w=Cn.updateQueue,w===null?(w={lastEffect:null,stores:null},Cn.updateQueue=w,w.stores=[_]):(C=w.stores,C===null?w.stores=[_]:C.push(_))}function r4(_,w,C,D){w.value=C,w.getSnapshot=D,o4(w)&&pa(_,1,-1)}function s4(_,w,C){return C(function(){o4(w)&&pa(_,1,-1)})}function o4(_){var w=_.getSnapshot;_=_.value;try{var C=w();return!Zl(_,C)}catch{return!0}}function Q2(_){var w=lu();return typeof _=="function"&&(_=_()),w.memoizedState=w.baseState=_,_={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xf,lastRenderedState:_},w.queue=_,_=_.dispatch=Jre.bind(null,Cn,_),[w.memoizedState,_]}function By(_,w,C,D){return _={tag:_,create:w,destroy:C,deps:D,next:null},w=Cn.updateQueue,w===null?(w={lastEffect:null,stores:null},Cn.updateQueue=w,w.lastEffect=_.next=_):(C=w.lastEffect,C===null?w.lastEffect=_.next=_:(D=C.next,C.next=_,_.next=D,w.lastEffect=_)),_}function a4(){return ic().memoizedState}function cb(_,w,C,D){var I=lu();Cn.flags|=_,I.memoizedState=By(1|w,C,void 0,D===void 0?null:D)}function ub(_,w,C,D){var I=ic();D=D===void 0?null:D;var H=void 0;if(ss!==null){var se=ss.memoizedState;if(H=se.destroy,D!==null&&X2(D,se.deps)){I.memoizedState=By(w,C,H,D);return}}Cn.flags|=_,I.memoizedState=By(1|w,C,H,D)}function K2(_,w){return cb(8390656,8,_,w)}function Oy(_,w){return ub(2048,8,_,w)}function l4(_,w){return ub(4,2,_,w)}function c4(_,w){return ub(4,4,_,w)}function u4(_,w){if(typeof w=="function")return _=_(),w(_),function(){w(null)};if(w!=null)return _=_(),w.current=_,function(){w.current=null}}function h4(_,w,C){return C=C!=null?C.concat([_]):null,ub(4,4,u4.bind(null,w,_),C)}function J2(){}function d4(_,w){var C=ic();w=w===void 0?null:w;var D=C.memoizedState;return D!==null&&w!==null&&X2(w,D[1])?D[0]:(C.memoizedState=[_,w],_)}function f4(_,w){var C=ic();w=w===void 0?null:w;var D=C.memoizedState;return D!==null&&w!==null&&X2(w,D[1])?D[0]:(_=_(),C.memoizedState=[_,w],_)}function Qre(_,w){var C=Ti;Ti=C!==0&&4>C?C:4,_(!0);var D=fa.transition;fa.transition={};try{_(!1),w()}finally{Ti=C,fa.transition=D}}function p4(){return ic().memoizedState}function Kre(_,w,C){var D=Mh(_);C={lane:D,action:C,hasEagerState:!1,eagerState:null,next:null},m4(_)?g4(w,C):(v4(_,w,C),C=Cs(),_=pa(_,D,C),_!==null&&y4(_,w,D))}function Jre(_,w,C){var D=Mh(_),I={lane:D,action:C,hasEagerState:!1,eagerState:null,next:null};if(m4(_))g4(w,I);else{v4(_,w,I);var H=_.alternate;if(_.lanes===0&&(H===null||H.lanes===0)&&(H=w.lastRenderedReducer,H!==null))try{var se=w.lastRenderedState,Se=H(se,C);if(I.hasEagerState=!0,I.eagerState=Se,Zl(Se,se))return}catch{}finally{}C=Cs(),_=pa(_,D,C),_!==null&&y4(_,w,D)}}function m4(_){var w=_.alternate;return _===Cn||w!==null&&w===Cn}function g4(_,w){Iy=ob=!0;var C=_.pending;C===null?w.next=w:(w.next=C.next,C.next=w),_.pending=w}function v4(_,w,C){er!==null&&_.mode&1&&!(di&2)?(_=w.interleaved,_===null?(C.next=C,ec===null?ec=[w]:ec.push(w)):(C.next=_.next,_.next=C),w.interleaved=C):(_=w.pending,_===null?C.next=C:(C.next=_.next,_.next=C),w.pending=C)}function y4(_,w,C){if(C&4194240){var D=w.lanes;D&=_.pendingLanes,C|=D,w.lanes=C,M2(_,C)}}var hb={readContext:ca,useCallback:os,useContext:os,useEffect:os,useImperativeHandle:os,useInsertionEffect:os,useLayoutEffect:os,useMemo:os,useReducer:os,useRef:os,useState:os,useDebugValue:os,useDeferredValue:os,useTransition:os,useMutableSource:os,useSyncExternalStore:os,useId:os,unstable_isNewReconciler:!1},Zre={readContext:ca,useCallback:function(_,w){return lu().memoizedState=[_,w===void 0?null:w],_},useContext:ca,useEffect:K2,useImperativeHandle:function(_,w,C){return C=C!=null?C.concat([_]):null,cb(4194308,4,u4.bind(null,w,_),C)},useLayoutEffect:function(_,w){return cb(4194308,4,_,w)},useInsertionEffect:function(_,w){return cb(4,2,_,w)},useMemo:function(_,w){var C=lu();return w=w===void 0?null:w,_=_(),C.memoizedState=[_,w],_},useReducer:function(_,w,C){var D=lu();return w=C!==void 0?C(w):w,D.memoizedState=D.baseState=w,_={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_,lastRenderedState:w},D.queue=_,_=_.dispatch=Kre.bind(null,Cn,_),[D.memoizedState,_]},useRef:function(_){var w=lu();return _={current:_},w.memoizedState=_},useState:Q2,useDebugValue:J2,useDeferredValue:function(_){var w=Q2(_),C=w[0],D=w[1];return K2(function(){var I=fa.transition;fa.transition={};try{D(_)}finally{fa.transition=I}},[_]),C},useTransition:function(){var _=Q2(!1),w=_[0];return _=Qre.bind(null,_[1]),lu().memoizedState=_,[w,_]},useMutableSource:function(){},useSyncExternalStore:function(_,w,C){var D=Cn,I=lu();if(hn){if(C===void 0)throw Error(o(407));C=C()}else{if(C=w(),er===null)throw Error(o(349));Um&30||n4(D,w,C)}I.memoizedState=C;var H={value:C,getSnapshot:w};return I.queue=H,K2(s4.bind(null,D,H,_),[_]),D.flags|=2048,By(9,r4.bind(null,D,H,C,w),void 0,null),C},useId:function(){var _=lu(),w=er.identifierPrefix;if(hn){var C=au,D=ou;C=(D&~(1<<32-rl(D)-1)).toString(32)+C,w=":"+w+"R"+C,C=Ly++,0<C&&(w+="H"+C.toString(32)),w+=":"}else C=Yre++,w=":"+w+"r"+C.toString(32)+":";return _.memoizedState=w},unstable_isNewReconciler:!1},$re={readContext:ca,useCallback:d4,useContext:ca,useEffect:Oy,useImperativeHandle:h4,useInsertionEffect:l4,useLayoutEffect:c4,useMemo:f4,useReducer:ab,useRef:a4,useState:function(){return ab(xf)},useDebugValue:J2,useDeferredValue:function(_){var w=ab(xf),C=w[0],D=w[1];return Oy(function(){var I=fa.transition;fa.transition={};try{D(_)}finally{fa.transition=I}},[_]),C},useTransition:function(){var _=ab(xf)[0],w=ic().memoizedState;return[_,w]},useMutableSource:t4,useSyncExternalStore:i4,useId:p4,unstable_isNewReconciler:!1},ese={readContext:ca,useCallback:d4,useContext:ca,useEffect:Oy,useImperativeHandle:h4,useInsertionEffect:l4,useLayoutEffect:c4,useMemo:f4,useReducer:lb,useRef:a4,useState:function(){return lb(xf)},useDebugValue:J2,useDeferredValue:function(_){var w=lb(xf),C=w[0],D=w[1];return Oy(function(){var I=fa.transition;fa.transition={};try{D(_)}finally{fa.transition=I}},[_]),C},useTransition:function(){var _=lb(xf)[0],w=ic().memoizedState;return[_,w]},useMutableSource:t4,useSyncExternalStore:i4,useId:p4,unstable_isNewReconciler:!1};function Z2(_,w){try{var C="",D=w;do C+=qre(D),D=D.return;while(D);var I=C}catch(H){I=`
Error generating stack: `+H.message+`
`+H.stack}return{value:_,source:w,stack:I}}function $2(_,w){try{console.error(w.value)}catch(C){setTimeout(function(){throw C})}}var tse=typeof WeakMap=="function"?WeakMap:Map;function x4(_,w,C){C=su(-1,C),C.tag=3,C.payload={element:null};var D=w.value;return C.callback=function(){Tb||(Tb=!0,vP=D),$2(_,w)},C}function _4(_,w,C){C=su(-1,C),C.tag=3;var D=_.type.getDerivedStateFromError;if(typeof D=="function"){var I=w.value;C.payload=function(){return D(I)},C.callback=function(){$2(_,w)}}var H=_.stateNode;return H!==null&&typeof H.componentDidCatch=="function"&&(C.callback=function(){$2(_,w),typeof D!="function"&&(Sh===null?Sh=new Set([this]):Sh.add(this));var se=w.stack;this.componentDidCatch(w.value,{componentStack:se!==null?se:""})}),C}function w4(_,w,C){var D=_.pingCache;if(D===null){D=_.pingCache=new tse;var I=new Set;D.set(w,I)}else I=D.get(w),I===void 0&&(I=new Set,D.set(w,I));I.has(C)||(I.add(C),_=mse.bind(null,_,w,C),w.then(_,_))}function b4(_){do{var w;if((w=_.tag===13)&&(w=_.memoizedState,w=w!==null?w.dehydrated!==null:!0),w)return _;_=_.return}while(_!==null);return null}function S4(_,w,C,D,I){return _.mode&1?(_.flags|=65536,_.lanes=I,_):(_===w?_.flags|=65536:(_.flags|=128,C.flags|=131072,C.flags&=-52805,C.tag===1&&(C.alternate===null?C.tag=17:(w=su(-1,1),w.tag=2,bh(C,w))),C.lanes|=1),_)}function nc(_){_.flags|=4}function A4(_,w){if(_!==null&&_.child===w.child)return!0;if(w.flags&16)return!1;for(_=w.child;_!==null;){if(_.flags&12854||_.subtreeFlags&12854)return!1;_=_.sibling}return!0}var Fy,Ny,db,fb;if(ve)Fy=function(_,w){for(var C=w.child;C!==null;){if(C.tag===5||C.tag===6)G(_,C.stateNode);else if(C.tag!==4&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===w)break;for(;C.sibling===null;){if(C.return===null||C.return===w)return;C=C.return}C.sibling.return=C.return,C=C.sibling}},Ny=function(){},db=function(_,w,C,D,I){if(_=_.memoizedProps,_!==D){var H=w.stateNode,se=tc(da.current);C=K(H,C,_,D,I,se),(w.updateQueue=C)&&nc(w)}},fb=function(_,w,C,D){C!==D&&nc(w)};else if(Y){Fy=function(_,w,C,D){for(var I=w.child;I!==null;){if(I.tag===5){var H=I.stateNode;C&&D&&(H=kt(H,I.type,I.memoizedProps,I)),G(_,H)}else if(I.tag===6)H=I.stateNode,C&&D&&(H=mn(H,I.memoizedProps,I)),G(_,H);else if(I.tag!==4){if(I.tag===22&&I.memoizedState!==null)H=I.child,H!==null&&(H.return=I),Fy(_,I,!0,!0);else if(I.child!==null){I.child.return=I,I=I.child;continue}}if(I===w)break;for(;I.sibling===null;){if(I.return===null||I.return===w)return;I=I.return}I.sibling.return=I.return,I=I.sibling}};var M4=function(_,w,C,D){for(var I=w.child;I!==null;){if(I.tag===5){var H=I.stateNode;C&&D&&(H=kt(H,I.type,I.memoizedProps,I)),qt(_,H)}else if(I.tag===6)H=I.stateNode,C&&D&&(H=mn(H,I.memoizedProps,I)),qt(_,H);else if(I.tag!==4){if(I.tag===22&&I.memoizedState!==null)H=I.child,H!==null&&(H.return=I),M4(_,I,!0,!0);else if(I.child!==null){I.child.return=I,I=I.child;continue}}if(I===w)break;for(;I.sibling===null;){if(I.return===null||I.return===w)return;I=I.return}I.sibling.return=I.return,I=I.sibling}};Ny=function(_,w){var C=w.stateNode;if(!A4(_,w)){_=C.containerInfo;var D=mt(_);M4(D,w,!1,!1),C.pendingChildren=D,nc(w),mi(_,D)}},db=function(_,w,C,D,I){var H=_.stateNode,se=_.memoizedProps;if((_=A4(_,w))&&se===D)w.stateNode=H;else{var Se=w.stateNode,je=tc(da.current),nt=null;se!==D&&(nt=K(Se,C,se,D,I,je)),_&&nt===null?w.stateNode=H:(H=qe(H,nt,C,se,D,w,_,Se),Z(H,C,D,I,je)&&nc(w),w.stateNode=H,_?nc(w):Fy(H,w,!1,!1))}},fb=function(_,w,C,D){C!==D?(_=tc(Fm.current),C=tc(da.current),w.stateNode=J(D,_,C,w),nc(w)):w.stateNode=_.stateNode}}else Ny=function(){},db=function(){},fb=function(){};function Uy(_,w){if(!hn)switch(_.tailMode){case"hidden":w=_.tail;for(var C=null;w!==null;)w.alternate!==null&&(C=w),w=w.sibling;C===null?_.tail=null:C.sibling=null;break;case"collapsed":C=_.tail;for(var D=null;C!==null;)C.alternate!==null&&(D=C),C=C.sibling;D===null?w||_.tail===null?_.tail=null:_.tail.sibling=null:D.sibling=null}}function as(_){var w=_.alternate!==null&&_.alternate.child===_.child,C=0,D=0;if(w)for(var I=_.child;I!==null;)C|=I.lanes|I.childLanes,D|=I.subtreeFlags&14680064,D|=I.flags&14680064,I.return=_,I=I.sibling;else for(I=_.child;I!==null;)C|=I.lanes|I.childLanes,D|=I.subtreeFlags,D|=I.flags,I.return=_,I=I.sibling;return _.subtreeFlags|=D,_.childLanes=C,w}function ise(_,w,C){var D=w.pendingProps;switch(U2(w),w.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return as(w),null;case 1:return Tn(w.type)&&_h(),as(w),null;case 3:return D=w.stateNode,Nm(),jt(un),jt(Mi),W2(),D.pendingContext&&(D.context=D.pendingContext,D.pendingContext=null),(_===null||_.child===null)&&(Cy(w)?nc(w):_===null||_.memoizedState.isDehydrated&&!(w.flags&256)||(w.flags|=1024,ol!==null&&(_P(ol),ol=null))),Ny(_,w),as(w),null;case 5:V2(w),C=tc(Fm.current);var I=w.type;if(_!==null&&w.stateNode!=null)db(_,w,I,D,C),_.ref!==w.ref&&(w.flags|=512,w.flags|=2097152);else{if(!D){if(w.stateNode===null)throw Error(o(166));return as(w),null}if(_=tc(da.current),Cy(w)){if(!ce)throw Error(o(175));_=bt(w.stateNode,w.type,w.memoizedProps,C,_,w,!Ty),w.updateQueue=_,_!==null&&nc(w)}else{var H=k(I,D,C,_,w);Fy(H,w,!1,!1),w.stateNode=H,Z(H,I,D,C,_)&&nc(w)}w.ref!==null&&(w.flags|=512,w.flags|=2097152)}return as(w),null;case 6:if(_&&w.stateNode!=null)fb(_,w,_.memoizedProps,D);else{if(typeof D!="string"&&w.stateNode===null)throw Error(o(166));if(_=tc(Fm.current),C=tc(da.current),Cy(w)){if(!ce)throw Error(o(176));if(_=w.stateNode,D=w.memoizedProps,(C=$(_,D,w,!Ty))&&(I=Co,I!==null))switch(H=(I.mode&1)!==0,I.tag){case 3:Tt(I.stateNode.containerInfo,_,D,H);break;case 5:Ht(I.type,I.memoizedProps,I.stateNode,_,D,H)}C&&nc(w)}else w.stateNode=J(D,_,C,w)}return as(w),null;case 13:if(jt(gn),D=w.memoizedState,hn&&Po!==null&&w.mode&1&&!(w.flags&128)){for(_=Po;_;)_=Le(_);return Bm(),w.flags|=98560,w}if(D!==null&&D.dehydrated!==null){if(D=Cy(w),_===null){if(!D)throw Error(o(318));if(!ce)throw Error(o(344));if(_=w.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(o(317));we(_,w)}else Bm(),!(w.flags&128)&&(w.memoizedState=null),w.flags|=4;return as(w),null}return ol!==null&&(_P(ol),ol=null),w.flags&128?(w.lanes=C,w):(D=D!==null,C=!1,_===null?Cy(w):C=_.memoizedState!==null,D&&!C&&(w.child.flags|=8192,w.mode&1&&(_===null||gn.current&1?pr===0&&(pr=3):bP())),w.updateQueue!==null&&(w.flags|=4),as(w),null);case 4:return Nm(),Ny(_,w),_===null&&xe(w.stateNode.containerInfo),as(w),null;case 10:return I2(w.type._context),as(w),null;case 17:return Tn(w.type)&&_h(),as(w),null;case 19:if(jt(gn),I=w.memoizedState,I===null)return as(w),null;if(D=(w.flags&128)!==0,H=I.rendering,H===null)if(D)Uy(I,!1);else{if(pr!==0||_!==null&&_.flags&128)for(_=w.child;_!==null;){if(H=rb(_),H!==null){for(w.flags|=128,Uy(I,!1),_=H.updateQueue,_!==null&&(w.updateQueue=_,w.flags|=4),w.subtreeFlags=0,_=C,D=w.child;D!==null;)C=D,I=_,C.flags&=14680066,H=C.alternate,H===null?(C.childLanes=0,C.lanes=I,C.child=null,C.subtreeFlags=0,C.memoizedProps=null,C.memoizedState=null,C.updateQueue=null,C.dependencies=null,C.stateNode=null):(C.childLanes=H.childLanes,C.lanes=H.lanes,C.child=H.child,C.subtreeFlags=0,C.deletions=null,C.memoizedProps=H.memoizedProps,C.memoizedState=H.memoizedState,C.updateQueue=H.updateQueue,C.type=H.type,I=H.dependencies,C.dependencies=I===null?null:{lanes:I.lanes,firstContext:I.firstContext}),D=D.sibling;return Lt(gn,gn.current&1|2),w.child}_=_.sibling}I.tail!==null&&Cr()>gP&&(w.flags|=128,D=!0,Uy(I,!1),w.lanes=4194304)}else{if(!D)if(_=rb(H),_!==null){if(w.flags|=128,D=!0,_=_.updateQueue,_!==null&&(w.updateQueue=_,w.flags|=4),Uy(I,!0),I.tail===null&&I.tailMode==="hidden"&&!H.alternate&&!hn)return as(w),null}else 2*Cr()-I.renderingStartTime>gP&&C!==1073741824&&(w.flags|=128,D=!0,Uy(I,!1),w.lanes=4194304);I.isBackwards?(H.sibling=w.child,w.child=H):(_=I.last,_!==null?_.sibling=H:w.child=H,I.last=H)}return I.tail!==null?(w=I.tail,I.rendering=w,I.tail=w.sibling,I.renderingStartTime=Cr(),w.sibling=null,_=gn.current,Lt(gn,D?_&1|2:_&1),w):(as(w),null);case 22:case 23:return wP(),D=w.memoizedState!==null,_!==null&&_.memoizedState!==null!==D&&(w.flags|=8192),D&&w.mode&1?Ro&1073741824&&(as(w),ve&&w.subtreeFlags&6&&(w.flags|=8192)):as(w),null;case 24:return null;case 25:return null}throw Error(o(156,w.tag))}var nse=a.ReactCurrentOwner,Do=!1;function Ts(_,w,C,D){w.child=_===null?$z(w,null,C,D):Om(w,_.child,C,D)}function E4(_,w,C,D,I){C=C.render;var H=w.ref;return Rm(w,I),D=q2(_,w,C,D,H,I),C=Y2(),_!==null&&!Do?(w.updateQueue=_.updateQueue,w.flags&=-2053,_.lanes&=~I,cu(_,w,I)):(hn&&C&&N2(w),w.flags|=1,Ts(_,w,D,I),w.child)}function T4(_,w,C,D,I){if(_===null){var H=C.type;return typeof H=="function"&&!SP(H)&&H.defaultProps===void 0&&C.compare===null&&C.defaultProps===void 0?(w.tag=15,w.type=H,C4(_,w,H,D,I)):(_=Bb(C.type,null,D,w,w.mode,I),_.ref=w.ref,_.return=w,w.child=_)}if(H=_.child,!(_.lanes&I)){var se=H.memoizedProps;if(C=C.compare,C=C!==null?C:Qw,C(se,D)&&_.ref===w.ref)return cu(_,w,I)}return w.flags|=1,_=Th(H,D),_.ref=w.ref,_.return=w,w.child=_}function C4(_,w,C,D,I){if(_!==null&&Qw(_.memoizedProps,D)&&_.ref===w.ref)if(Do=!1,(_.lanes&I)!==0)_.flags&131072&&(Do=!0);else return w.lanes=_.lanes,cu(_,w,I);return eP(_,w,C,D,I)}function P4(_,w,C){var D=w.pendingProps,I=D.children,H=_!==null?_.memoizedState:null;if(D.mode==="hidden")if(!(w.mode&1))w.memoizedState={baseLanes:0,cachePool:null},Lt(km,Ro),Ro|=C;else if(C&1073741824)w.memoizedState={baseLanes:0,cachePool:null},D=H!==null?H.baseLanes:C,Lt(km,Ro),Ro|=D;else return _=H!==null?H.baseLanes|C:C,w.lanes=w.childLanes=1073741824,w.memoizedState={baseLanes:_,cachePool:null},w.updateQueue=null,Lt(km,Ro),Ro|=_,null;else H!==null?(D=H.baseLanes|C,w.memoizedState=null):D=C,Lt(km,Ro),Ro|=D;return Ts(_,w,I,C),w.child}function D4(_,w){var C=w.ref;(_===null&&C!==null||_!==null&&_.ref!==C)&&(w.flags|=512,w.flags|=2097152)}function eP(_,w,C,D,I){var H=Tn(C)?To:Mi.current;return H=rn(w,H),Rm(w,I),C=q2(_,w,C,D,H,I),D=Y2(),_!==null&&!Do?(w.updateQueue=_.updateQueue,w.flags&=-2053,_.lanes&=~I,cu(_,w,I)):(hn&&D&&N2(w),w.flags|=1,Ts(_,w,C,I),w.child)}function R4(_,w,C,D,I){if(Tn(C)){var H=!0;Pm(w)}else H=!1;if(Rm(w,I),w.stateNode===null)_!==null&&(_.alternate=null,w.alternate=null,w.flags|=2),Wz(w,C,D),F2(w,C,D,I),D=!0;else if(_===null){var se=w.stateNode,Se=w.memoizedProps;se.props=Se;var je=se.context,nt=C.contextType;typeof nt=="object"&&nt!==null?nt=ca(nt):(nt=Tn(C)?To:Mi.current,nt=rn(w,nt));var wt=C.getDerivedStateFromProps,ei=typeof wt=="function"||typeof se.getSnapshotBeforeUpdate=="function";ei||typeof se.UNSAFE_componentWillReceiveProps!="function"&&typeof se.componentWillReceiveProps!="function"||(Se!==D||je!==nt)&&Xz(w,se,D,nt),wh=!1;var Bt=w.memoizedState;se.state=Bt,$w(w,D,se,I),je=w.memoizedState,Se!==D||Bt!==je||un.current||wh?(typeof wt=="function"&&(O2(w,C,wt,D),je=w.memoizedState),(Se=wh||jz(w,C,Se,D,Bt,je,nt))?(ei||typeof se.UNSAFE_componentWillMount!="function"&&typeof se.componentWillMount!="function"||(typeof se.componentWillMount=="function"&&se.componentWillMount(),typeof se.UNSAFE_componentWillMount=="function"&&se.UNSAFE_componentWillMount()),typeof se.componentDidMount=="function"&&(w.flags|=4194308)):(typeof se.componentDidMount=="function"&&(w.flags|=4194308),w.memoizedProps=D,w.memoizedState=je),se.props=D,se.state=je,se.context=nt,D=Se):(typeof se.componentDidMount=="function"&&(w.flags|=4194308),D=!1)}else{se=w.stateNode,zz(_,w),Se=w.memoizedProps,nt=w.type===w.elementType?Se:sl(w.type,Se),se.props=nt,ei=w.pendingProps,Bt=se.context,je=C.contextType,typeof je=="object"&&je!==null?je=ca(je):(je=Tn(C)?To:Mi.current,je=rn(w,je));var Yi=C.getDerivedStateFromProps;(wt=typeof Yi=="function"||typeof se.getSnapshotBeforeUpdate=="function")||typeof se.UNSAFE_componentWillReceiveProps!="function"&&typeof se.componentWillReceiveProps!="function"||(Se!==ei||Bt!==je)&&Xz(w,se,D,je),wh=!1,Bt=w.memoizedState,se.state=Bt,$w(w,D,se,I);var Et=w.memoizedState;Se!==ei||Bt!==Et||un.current||wh?(typeof Yi=="function"&&(O2(w,C,Yi,D),Et=w.memoizedState),(nt=wh||jz(w,C,nt,D,Bt,Et,je)||!1)?(wt||typeof se.UNSAFE_componentWillUpdate!="function"&&typeof se.componentWillUpdate!="function"||(typeof se.componentWillUpdate=="function"&&se.componentWillUpdate(D,Et,je),typeof se.UNSAFE_componentWillUpdate=="function"&&se.UNSAFE_componentWillUpdate(D,Et,je)),typeof se.componentDidUpdate=="function"&&(w.flags|=4),typeof se.getSnapshotBeforeUpdate=="function"&&(w.flags|=1024)):(typeof se.componentDidUpdate!="function"||Se===_.memoizedProps&&Bt===_.memoizedState||(w.flags|=4),typeof se.getSnapshotBeforeUpdate!="function"||Se===_.memoizedProps&&Bt===_.memoizedState||(w.flags|=1024),w.memoizedProps=D,w.memoizedState=Et),se.props=D,se.state=Et,se.context=je,D=nt):(typeof se.componentDidUpdate!="function"||Se===_.memoizedProps&&Bt===_.memoizedState||(w.flags|=4),typeof se.getSnapshotBeforeUpdate!="function"||Se===_.memoizedProps&&Bt===_.memoizedState||(w.flags|=1024),D=!1)}return tP(_,w,C,D,H,I)}function tP(_,w,C,D,I,H){D4(_,w);var se=(w.flags&128)!==0;if(!D&&!se)return I&&Ay(w,C,!1),cu(_,w,H);D=w.stateNode,nse.current=w;var Se=se&&typeof C.getDerivedStateFromError!="function"?null:D.render();return w.flags|=1,_!==null&&se?(w.child=Om(w,_.child,null,H),w.child=Om(w,null,Se,H)):Ts(_,w,Se,H),w.memoizedState=D.state,I&&Ay(w,C,!0),w.child}function I4(_){var w=_.stateNode;w.pendingContext?rs(_,w.pendingContext,w.pendingContext!==w.context):w.context&&rs(_,w.context,!1),H2(_,w.containerInfo)}function L4(_,w,C,D,I){return Bm(),G2(I),w.flags|=256,Ts(_,w,C,D),w.child}var pb={dehydrated:null,treeContext:null,retryLane:0};function mb(_){return{baseLanes:_,cachePool:null}}function B4(_,w,C){var D=w.pendingProps,I=gn.current,H=!1,se=(w.flags&128)!==0,Se;if((Se=se)||(Se=_!==null&&_.memoizedState===null?!1:(I&2)!==0),Se?(H=!0,w.flags&=-129):(_===null||_.memoizedState!==null)&&(I|=1),Lt(gn,I&1),_===null)return z2(w),_=w.memoizedState,_!==null&&(_=_.dehydrated,_!==null)?(w.mode&1?Kl(_)?w.lanes=8:w.lanes=1073741824:w.lanes=1,null):(I=D.children,_=D.fallback,H?(D=w.mode,H=w.child,I={mode:"hidden",children:I},!(D&1)&&H!==null?(H.childLanes=0,H.pendingProps=I):H=Ob(I,D,0,null),_=Mf(_,D,C,null),H.return=w,_.return=w,H.sibling=_,w.child=H,w.child.memoizedState=mb(C),w.memoizedState=pb,_):iP(w,I));if(I=_.memoizedState,I!==null){if(Se=I.dehydrated,Se!==null){if(se)return w.flags&256?(w.flags&=-257,gb(_,w,C,Error(o(422)))):w.memoizedState!==null?(w.child=_.child,w.flags|=128,null):(H=D.fallback,I=w.mode,D=Ob({mode:"visible",children:D.children},I,0,null),H=Mf(H,I,C,null),H.flags|=2,D.return=w,H.return=w,D.sibling=H,w.child=D,w.mode&1&&Om(w,_.child,null,C),w.child.memoizedState=mb(C),w.memoizedState=pb,H);if(!(w.mode&1))w=gb(_,w,C,null);else if(Kl(Se))w=gb(_,w,C,Error(o(419)));else if(D=(C&_.childLanes)!==0,Do||D){if(D=er,D!==null){switch(C&-C){case 4:H=2;break;case 16:H=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:H=32;break;case 536870912:H=268435456;break;default:H=0}D=H&(D.suspendedLanes|C)?0:H,D!==0&&D!==I.retryLane&&(I.retryLane=D,pa(_,D,-1))}bP(),w=gb(_,w,C,Error(o(421)))}else Tm(Se)?(w.flags|=128,w.child=_.child,w=gse.bind(null,_),ie(Se,w),w=null):(C=I.treeContext,ce&&(Po=Ye(Se),Co=w,hn=!0,ol=null,Ty=!1,C!==null&&(ua[ha++]=ou,ua[ha++]=au,ua[ha++]=vf,ou=C.id,au=C.overflow,vf=w)),w=iP(w,w.pendingProps.children),w.flags|=4096);return w}return H?(D=F4(_,w,D.children,D.fallback,C),H=w.child,I=_.child.memoizedState,H.memoizedState=I===null?mb(C):{baseLanes:I.baseLanes|C,cachePool:null},H.childLanes=_.childLanes&~C,w.memoizedState=pb,D):(C=O4(_,w,D.children,C),w.memoizedState=null,C)}return H?(D=F4(_,w,D.children,D.fallback,C),H=w.child,I=_.child.memoizedState,H.memoizedState=I===null?mb(C):{baseLanes:I.baseLanes|C,cachePool:null},H.childLanes=_.childLanes&~C,w.memoizedState=pb,D):(C=O4(_,w,D.children,C),w.memoizedState=null,C)}function iP(_,w){return w=Ob({mode:"visible",children:w},_.mode,0,null),w.return=_,_.child=w}function O4(_,w,C,D){var I=_.child;return _=I.sibling,C=Th(I,{mode:"visible",children:C}),!(w.mode&1)&&(C.lanes=D),C.return=w,C.sibling=null,_!==null&&(D=w.deletions,D===null?(w.deletions=[_],w.flags|=16):D.push(_)),w.child=C}function F4(_,w,C,D,I){var H=w.mode;_=_.child;var se=_.sibling,Se={mode:"hidden",children:C};return!(H&1)&&w.child!==_?(C=w.child,C.childLanes=0,C.pendingProps=Se,w.deletions=null):(C=Th(_,Se),C.subtreeFlags=_.subtreeFlags&14680064),se!==null?D=Th(se,D):(D=Mf(D,H,I,null),D.flags|=2),D.return=w,C.return=w,C.sibling=D,w.child=C,D}function gb(_,w,C,D){return D!==null&&G2(D),Om(w,_.child,null,C),_=iP(w,w.pendingProps.children),_.flags|=2,w.memoizedState=null,_}function N4(_,w,C){_.lanes|=w;var D=_.alternate;D!==null&&(D.lanes|=w),L2(_.return,w,C)}function nP(_,w,C,D,I){var H=_.memoizedState;H===null?_.memoizedState={isBackwards:w,rendering:null,renderingStartTime:0,last:D,tail:C,tailMode:I}:(H.isBackwards=w,H.rendering=null,H.renderingStartTime=0,H.last=D,H.tail=C,H.tailMode=I)}function U4(_,w,C){var D=w.pendingProps,I=D.revealOrder,H=D.tail;if(Ts(_,w,D.children,C),D=gn.current,D&2)D=D&1|2,w.flags|=128;else{if(_!==null&&_.flags&128)e:for(_=w.child;_!==null;){if(_.tag===13)_.memoizedState!==null&&N4(_,C,w);else if(_.tag===19)N4(_,C,w);else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===w)break e;for(;_.sibling===null;){if(_.return===null||_.return===w)break e;_=_.return}_.sibling.return=_.return,_=_.sibling}D&=1}if(Lt(gn,D),!(w.mode&1))w.memoizedState=null;else switch(I){case"forwards":for(C=w.child,I=null;C!==null;)_=C.alternate,_!==null&&rb(_)===null&&(I=C),C=C.sibling;C=I,C===null?(I=w.child,w.child=null):(I=C.sibling,C.sibling=null),nP(w,!1,I,C,H);break;case"backwards":for(C=null,I=w.child,w.child=null;I!==null;){if(_=I.alternate,_!==null&&rb(_)===null){w.child=I;break}_=I.sibling,I.sibling=C,C=I,I=_}nP(w,!0,C,null,H);break;case"together":nP(w,!1,null,null,void 0);break;default:w.memoizedState=null}return w.child}function cu(_,w,C){if(_!==null&&(w.dependencies=_.dependencies),zm|=w.lanes,!(C&w.childLanes))return null;if(_!==null&&w.child!==_.child)throw Error(o(153));if(w.child!==null){for(_=w.child,C=Th(_,_.pendingProps),w.child=C,C.return=w;_.sibling!==null;)_=_.sibling,C=C.sibling=Th(_,_.pendingProps),C.return=w;C.sibling=null}return w.child}function rse(_,w,C){switch(w.tag){case 3:I4(w),Bm();break;case 5:e4(w);break;case 1:Tn(w.type)&&Pm(w);break;case 4:H2(w,w.stateNode.containerInfo);break;case 10:kz(w,w.type._context,w.memoizedProps.value);break;case 13:var D=w.memoizedState;if(D!==null)return D.dehydrated!==null?(Lt(gn,gn.current&1),w.flags|=128,null):C&w.child.childLanes?B4(_,w,C):(Lt(gn,gn.current&1),_=cu(_,w,C),_!==null?_.sibling:null);Lt(gn,gn.current&1);break;case 19:if(D=(C&w.childLanes)!==0,_.flags&128){if(D)return U4(_,w,C);w.flags|=128}var I=w.memoizedState;if(I!==null&&(I.rendering=null,I.tail=null,I.lastEffect=null),Lt(gn,gn.current),D)break;return null;case 22:case 23:return w.lanes=0,P4(_,w,C)}return cu(_,w,C)}function sse(_,w){switch(U2(w),w.tag){case 1:return Tn(w.type)&&_h(),_=w.flags,_&65536?(w.flags=_&-65537|128,w):null;case 3:return Nm(),jt(un),jt(Mi),W2(),_=w.flags,_&65536&&!(_&128)?(w.flags=_&-65537|128,w):null;case 5:return V2(w),null;case 13:if(jt(gn),_=w.memoizedState,_!==null&&_.dehydrated!==null){if(w.alternate===null)throw Error(o(340));Bm()}return _=w.flags,_&65536?(w.flags=_&-65537|128,w):null;case 19:return jt(gn),null;case 4:return Nm(),null;case 10:return I2(w.type._context),null;case 22:case 23:return wP(),null;case 24:return null;default:return null}}var vb=!1,_f=!1,ose=typeof WeakSet=="function"?WeakSet:Set,dt=null;function yb(_,w){var C=_.ref;if(C!==null)if(typeof C=="function")try{C(null)}catch(D){Js(_,w,D)}else C.current=null}function rP(_,w,C){try{C()}catch(D){Js(_,w,D)}}var k4=!1;function ase(_,w){for(j(_.containerInfo),dt=w;dt!==null;)if(_=dt,w=_.child,(_.subtreeFlags&1028)!==0&&w!==null)w.return=_,dt=w;else for(;dt!==null;){_=dt;try{var C=_.alternate;if(_.flags&1024)switch(_.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var D=C.memoizedProps,I=C.memoizedState,H=_.stateNode,se=H.getSnapshotBeforeUpdate(_.elementType===_.type?D:sl(_.type,D),I);H.__reactInternalSnapshotBeforeUpdate=se}break;case 3:ve&&Be(_.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(Se){Js(_,_.return,Se)}if(w=_.sibling,w!==null){w.return=_.return,dt=w;break}dt=_.return}return C=k4,k4=!1,C}function wf(_,w,C){var D=w.updateQueue;if(D=D!==null?D.lastEffect:null,D!==null){var I=D=D.next;do{if((I.tag&_)===_){var H=I.destroy;I.destroy=void 0,H!==void 0&&rP(w,C,H)}I=I.next}while(I!==D)}}function ky(_,w){if(w=w.updateQueue,w=w!==null?w.lastEffect:null,w!==null){var C=w=w.next;do{if((C.tag&_)===_){var D=C.create;C.destroy=D()}C=C.next}while(C!==w)}}function sP(_){var w=_.ref;if(w!==null){var C=_.stateNode;switch(_.tag){case 5:_=Q(C);break;default:_=C}typeof w=="function"?w(_):w.current=_}}function z4(_,w,C){if(Jl&&typeof Jl.onCommitFiberUnmount=="function")try{Jl.onCommitFiberUnmount(qw,w)}catch{}switch(w.tag){case 0:case 11:case 14:case 15:if(_=w.updateQueue,_!==null&&(_=_.lastEffect,_!==null)){var D=_=_.next;do{var I=D,H=I.destroy;I=I.tag,H!==void 0&&(I&2||I&4)&&rP(w,C,H),D=D.next}while(D!==_)}break;case 1:if(yb(w,C),_=w.stateNode,typeof _.componentWillUnmount=="function")try{_.props=w.memoizedProps,_.state=w.memoizedState,_.componentWillUnmount()}catch(se){Js(w,C,se)}break;case 5:yb(w,C);break;case 4:ve?X4(_,w,C):Y&&Y&&(w=w.stateNode.containerInfo,C=mt(w),zn(w,C))}}function G4(_,w,C){for(var D=w;;)if(z4(_,D,C),D.child===null||ve&&D.tag===4){if(D===w)break;for(;D.sibling===null;){if(D.return===null||D.return===w)return;D=D.return}D.sibling.return=D.return,D=D.sibling}else D.child.return=D,D=D.child}function H4(_){var w=_.alternate;w!==null&&(_.alternate=null,H4(w)),_.child=null,_.deletions=null,_.sibling=null,_.tag===5&&(w=_.stateNode,w!==null&&Ne(w)),_.stateNode=null,_.return=null,_.dependencies=null,_.memoizedProps=null,_.memoizedState=null,_.pendingProps=null,_.stateNode=null,_.updateQueue=null}function V4(_){return _.tag===5||_.tag===3||_.tag===4}function j4(_){e:for(;;){for(;_.sibling===null;){if(_.return===null||V4(_.return))return null;_=_.return}for(_.sibling.return=_.return,_=_.sibling;_.tag!==5&&_.tag!==6&&_.tag!==18;){if(_.flags&2||_.child===null||_.tag===4)continue e;_.child.return=_,_=_.child}if(!(_.flags&2))return _.stateNode}}function W4(_){if(ve){e:{for(var w=_.return;w!==null;){if(V4(w))break e;w=w.return}throw Error(o(160))}var C=w;switch(C.tag){case 5:w=C.stateNode,C.flags&32&&(ut(w),C.flags&=-33),C=j4(_),aP(_,C,w);break;case 3:case 4:w=C.stateNode.containerInfo,C=j4(_),oP(_,C,w);break;default:throw Error(o(161))}}}function oP(_,w,C){var D=_.tag;if(D===5||D===6)_=_.stateNode,w?ke(C,_,w):Ve(C,_);else if(D!==4&&(_=_.child,_!==null))for(oP(_,w,C),_=_.sibling;_!==null;)oP(_,w,C),_=_.sibling}function aP(_,w,C){var D=_.tag;if(D===5||D===6)_=_.stateNode,w?Ae(C,_,w):We(C,_);else if(D!==4&&(_=_.child,_!==null))for(aP(_,w,C),_=_.sibling;_!==null;)aP(_,w,C),_=_.sibling}function X4(_,w,C){for(var D=w,I=!1,H,se;;){if(!I){I=D.return;e:for(;;){if(I===null)throw Error(o(160));switch(H=I.stateNode,I.tag){case 5:se=!1;break e;case 3:H=H.containerInfo,se=!0;break e;case 4:H=H.containerInfo,se=!0;break e}I=I.return}I=!0}if(D.tag===5||D.tag===6)G4(_,D,C),se?Je(H,D.stateNode):Ue(H,D.stateNode);else if(D.tag===18)se?vt(H,D.stateNode):et(H,D.stateNode);else if(D.tag===4){if(D.child!==null){H=D.stateNode.containerInfo,se=!0,D.child.return=D,D=D.child;continue}}else if(z4(_,D,C),D.child!==null){D.child.return=D,D=D.child;continue}if(D===w)break;for(;D.sibling===null;){if(D.return===null||D.return===w)return;D=D.return,D.tag===4&&(I=!1)}D.sibling.return=D.return,D=D.sibling}}function lP(_,w){if(ve){switch(w.tag){case 0:case 11:case 14:case 15:wf(3,w,w.return),ky(3,w),wf(5,w,w.return);return;case 1:return;case 5:var C=w.stateNode;if(C!=null){var D=w.memoizedProps;_=_!==null?_.memoizedProps:D;var I=w.type,H=w.updateQueue;w.updateQueue=null,H!==null&&ne(C,H,I,_,D,w)}return;case 6:if(w.stateNode===null)throw Error(o(162));C=w.memoizedProps,me(w.stateNode,_!==null?_.memoizedProps:C,C);return;case 3:ce&&_!==null&&_.memoizedState.isDehydrated&&_e(w.stateNode.containerInfo);return;case 12:return;case 13:xb(w);return;case 19:xb(w);return;case 17:return}throw Error(o(163))}switch(w.tag){case 0:case 11:case 14:case 15:wf(3,w,w.return),ky(3,w),wf(5,w,w.return);return;case 12:return;case 13:xb(w);return;case 19:xb(w);return;case 3:ce&&_!==null&&_.memoizedState.isDehydrated&&_e(w.stateNode.containerInfo);break;case 22:case 23:return}e:if(Y){switch(w.tag){case 1:case 5:case 6:break e;case 3:case 4:w=w.stateNode,zn(w.containerInfo,w.pendingChildren);break e}throw Error(o(163))}}function xb(_){var w=_.updateQueue;if(w!==null){_.updateQueue=null;var C=_.stateNode;C===null&&(C=_.stateNode=new ose),w.forEach(function(D){var I=vse.bind(null,_,D);C.has(D)||(C.add(D),D.then(I,I))})}}function lse(_,w){for(dt=w;dt!==null;){w=dt;var C=w.deletions;if(C!==null)for(var D=0;D<C.length;D++){var I=C[D];try{var H=_;ve?X4(H,I,w):G4(H,I,w);var se=I.alternate;se!==null&&(se.return=null),I.return=null}catch(Mt){Js(I,w,Mt)}}if(C=w.child,w.subtreeFlags&12854&&C!==null)C.return=w,dt=C;else for(;dt!==null;){w=dt;try{var Se=w.flags;if(Se&32&&ve&&ut(w.stateNode),Se&512){var je=w.alternate;if(je!==null){var nt=je.ref;nt!==null&&(typeof nt=="function"?nt(null):nt.current=null)}}if(Se&8192)switch(w.tag){case 13:if(w.memoizedState!==null){var wt=w.alternate;(wt===null||wt.memoizedState===null)&&(mP=Cr())}break;case 22:var ei=w.memoizedState!==null,Bt=w.alternate,Yi=Bt!==null&&Bt.memoizedState!==null;if(C=w,ve){e:if(D=C,I=ei,H=null,ve)for(var Et=D;;){if(Et.tag===5){if(H===null){H=Et;var ls=Et.stateNode;I?Pt(ls):pe(Et.stateNode,Et.memoizedProps)}}else if(Et.tag===6){if(H===null){var ga=Et.stateNode;I?q(ga):oe(ga,Et.memoizedProps)}}else if((Et.tag!==22&&Et.tag!==23||Et.memoizedState===null||Et===D)&&Et.child!==null){Et.child.return=Et,Et=Et.child;continue}if(Et===D)break;for(;Et.sibling===null;){if(Et.return===null||Et.return===D)break e;H===Et&&(H=null),Et=Et.return}H===Et&&(H=null),Et.sibling.return=Et.return,Et=Et.sibling}}if(ei&&!Yi&&C.mode&1){dt=C;for(var Fe=C.child;Fe!==null;){for(C=dt=Fe;dt!==null;){D=dt;var Me=D.child;switch(D.tag){case 0:case 11:case 14:case 15:wf(4,D,D.return);break;case 1:yb(D,D.return);var He=D.stateNode;if(typeof He.componentWillUnmount=="function"){var ft=D.return;try{He.props=D.memoizedProps,He.state=D.memoizedState,He.componentWillUnmount()}catch(Mt){Js(D,ft,Mt)}}break;case 5:yb(D,D.return);break;case 22:if(D.memoizedState!==null){Q4(C);continue}}Me!==null?(Me.return=D,dt=Me):Q4(C)}Fe=Fe.sibling}}}switch(Se&4102){case 2:W4(w),w.flags&=-3;break;case 6:W4(w),w.flags&=-3,lP(w.alternate,w);break;case 4096:w.flags&=-4097;break;case 4100:w.flags&=-4097,lP(w.alternate,w);break;case 4:lP(w.alternate,w)}}catch(Mt){Js(w,w.return,Mt)}if(C=w.sibling,C!==null){C.return=w.return,dt=C;break}dt=w.return}}}function cse(_,w,C){dt=_,q4(_)}function q4(_,w,C){for(var D=(_.mode&1)!==0;dt!==null;){var I=dt,H=I.child;if(I.tag===22&&D){var se=I.memoizedState!==null||vb;if(!se){var Se=I.alternate,je=Se!==null&&Se.memoizedState!==null||_f;Se=vb;var nt=_f;if(vb=se,(_f=je)&&!nt)for(dt=I;dt!==null;)se=dt,je=se.child,se.tag===22&&se.memoizedState!==null?K4(I):je!==null?(je.return=se,dt=je):K4(I);for(;H!==null;)dt=H,q4(H),H=H.sibling;dt=I,vb=Se,_f=nt}Y4(_)}else I.subtreeFlags&8772&&H!==null?(H.return=I,dt=H):Y4(_)}}function Y4(_){for(;dt!==null;){var w=dt;if(w.flags&8772){var C=w.alternate;try{if(w.flags&8772)switch(w.tag){case 0:case 11:case 15:_f||ky(5,w);break;case 1:var D=w.stateNode;if(w.flags&4&&!_f)if(C===null)D.componentDidMount();else{var I=w.elementType===w.type?C.memoizedProps:sl(w.type,C.memoizedProps);D.componentDidUpdate(I,C.memoizedState,D.__reactInternalSnapshotBeforeUpdate)}var H=w.updateQueue;H!==null&&Hz(w,H,D);break;case 3:var se=w.updateQueue;if(se!==null){if(C=null,w.child!==null)switch(w.child.tag){case 5:C=Q(w.child.stateNode);break;case 1:C=w.child.stateNode}Hz(w,se,C)}break;case 5:var Se=w.stateNode;C===null&&w.flags&4&&be(Se,w.type,w.memoizedProps,w);break;case 6:break;case 4:break;case 12:break;case 13:if(ce&&w.memoizedState===null){var je=w.alternate;if(je!==null){var nt=je.memoizedState;if(nt!==null){var wt=nt.dehydrated;wt!==null&&Oe(wt)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}_f||w.flags&512&&sP(w)}catch(ei){Js(w,w.return,ei)}}if(w===_){dt=null;break}if(C=w.sibling,C!==null){C.return=w.return,dt=C;break}dt=w.return}}function Q4(_){for(;dt!==null;){var w=dt;if(w===_){dt=null;break}var C=w.sibling;if(C!==null){C.return=w.return,dt=C;break}dt=w.return}}function K4(_){for(;dt!==null;){var w=dt;try{switch(w.tag){case 0:case 11:case 15:var C=w.return;try{ky(4,w)}catch(je){Js(w,C,je)}break;case 1:var D=w.stateNode;if(typeof D.componentDidMount=="function"){var I=w.return;try{D.componentDidMount()}catch(je){Js(w,I,je)}}var H=w.return;try{sP(w)}catch(je){Js(w,H,je)}break;case 5:var se=w.return;try{sP(w)}catch(je){Js(w,se,je)}}}catch(je){Js(w,w.return,je)}if(w===_){dt=null;break}var Se=w.sibling;if(Se!==null){Se.return=w.return,dt=Se;break}dt=w.return}}var _b=0,wb=1,bb=2,Sb=3,Ab=4;if(typeof Symbol=="function"&&Symbol.for){var zy=Symbol.for;_b=zy("selector.component"),wb=zy("selector.has_pseudo_class"),bb=zy("selector.role"),Sb=zy("selector.test_id"),Ab=zy("selector.text")}function cP(_){var w=de(_);if(w!=null){if(typeof w.memoizedProps["data-testname"]!="string")throw Error(o(364));return w}if(_=at(_),_===null)throw Error(o(362));return _.stateNode.current}function uP(_,w){switch(w.$$typeof){case _b:if(_.type===w.value)return!0;break;case wb:e:{w=w.value,_=[_,0];for(var C=0;C<_.length;){var D=_[C++],I=_[C++],H=w[I];if(D.tag!==5||!V(D)){for(;H!=null&&uP(D,H);)I++,H=w[I];if(I===w.length){w=!0;break e}else for(D=D.child;D!==null;)_.push(D,I),D=D.sibling}}w=!1}return w;case bb:if(_.tag===5&&ue(_.stateNode,w.value))return!0;break;case Ab:if((_.tag===5||_.tag===6)&&(_=O(_),_!==null&&0<=_.indexOf(w.value)))return!0;break;case Sb:if(_.tag===5&&(_=_.memoizedProps["data-testname"],typeof _=="string"&&_.toLowerCase()===w.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function hP(_){switch(_.$$typeof){case _b:return"<"+(E(_.value)||"Unknown")+">";case wb:return":has("+(hP(_)||"")+")";case bb:return'[role="'+_.value+'"]';case Ab:return'"'+_.value+'"';case Sb:return'[data-testname="'+_.value+'"]';default:throw Error(o(365))}}function J4(_,w){var C=[];_=[_,0];for(var D=0;D<_.length;){var I=_[D++],H=_[D++],se=w[H];if(I.tag!==5||!V(I)){for(;se!=null&&uP(I,se);)H++,se=w[H];if(H===w.length)C.push(I);else for(I=I.child;I!==null;)_.push(I,H),I=I.sibling}}return C}function dP(_,w){if(!tt)throw Error(o(363));_=cP(_),_=J4(_,w),w=[],_=Array.from(_);for(var C=0;C<_.length;){var D=_[C++];if(D.tag===5)V(D)||w.push(D.stateNode);else for(D=D.child;D!==null;)_.push(D),D=D.sibling}return w}var use=Math.ceil,Mb=a.ReactCurrentDispatcher,fP=a.ReactCurrentOwner,Hn=a.ReactCurrentBatchConfig,di=0,er=null,tr=null,Wr=0,Ro=0,km=Vt(0),pr=0,Gy=null,zm=0,Eb=0,pP=0,Hy=null,Qs=null,mP=0,gP=1/0;function Gm(){gP=Cr()+500}var Tb=!1,vP=null,Sh=null,Cb=!1,Ah=null,Pb=0,Vy=0,yP=null,Db=-1,Rb=0;function Cs(){return di&6?Cr():Db!==-1?Db:Db=Cr()}function Mh(_){return _.mode&1?di&2&&Wr!==0?Wr&-Wr:Xre.transition!==null?(Rb===0&&(_=jw,jw<<=1,!(jw&4194240)&&(jw=64),Rb=_),Rb):(_=Ti,_!==0?_:Ce()):1}function pa(_,w,C){if(50<Vy)throw Vy=0,yP=null,Error(o(185));var D=Ib(_,w);return D===null?null:(Ey(D,w,C),(!(di&2)||D!==er)&&(D===er&&(!(di&2)&&(Eb|=w),pr===4&&Eh(D,Wr)),Ks(D,C),w===1&&di===0&&!(_.mode&1)&&(Gm(),Yw&&$l())),D)}function Ib(_,w){_.lanes|=w;var C=_.alternate;for(C!==null&&(C.lanes|=w),C=_,_=_.return;_!==null;)_.childLanes|=w,C=_.alternate,C!==null&&(C.childLanes|=w),C=_,_=_.return;return C.tag===3?C.stateNode:null}function Ks(_,w){var C=_.callbackNode;Nre(_,w);var D=Xw(_,_===er?Wr:0);if(D===0)C!==null&&Nz(C),_.callbackNode=null,_.callbackPriority=0;else if(w=D&-D,_.callbackPriority!==w){if(C!=null&&Nz(C),w===1)_.tag===0?Wre($4.bind(null,_)):Uz($4.bind(null,_)),Ie?Ge(function(){di===0&&$l()}):E2(T2,$l),C=null;else{switch(Fz(D)){case 1:C=T2;break;case 4:C=Gre;break;case 16:C=C2;break;case 536870912:C=Hre;break;default:C=C2}C=lG(C,Z4.bind(null,_))}_.callbackPriority=w,_.callbackNode=C}}function Z4(_,w){if(Db=-1,Rb=0,di&6)throw Error(o(327));var C=_.callbackNode;if(Af()&&_.callbackNode!==C)return null;var D=Xw(_,_===er?Wr:0);if(D===0)return null;if(D&30||D&_.expiredLanes||w)w=Lb(_,D);else{w=D;var I=di;di|=2;var H=iG();(er!==_||Wr!==w)&&(Gm(),bf(_,w));do try{fse();break}catch(Se){tG(_,Se)}while(1);R2(),Mb.current=H,di=I,tr!==null?w=0:(er=null,Wr=0,w=pr)}if(w!==0){if(w===2&&(I=S2(_),I!==0&&(D=I,w=xP(_,I))),w===1)throw C=Gy,bf(_,0),Eh(_,D),Ks(_,Cr()),C;if(w===6)Eh(_,D);else{if(I=_.current.alternate,!(D&30)&&!hse(I)&&(w=Lb(_,D),w===2&&(H=S2(_),H!==0&&(D=H,w=xP(_,H))),w===1))throw C=Gy,bf(_,0),Eh(_,D),Ks(_,Cr()),C;switch(_.finishedWork=I,_.finishedLanes=D,w){case 0:case 1:throw Error(o(345));case 2:Sf(_,Qs);break;case 3:if(Eh(_,D),(D&130023424)===D&&(w=mP+500-Cr(),10<w)){if(Xw(_,0)!==0)break;if(I=_.suspendedLanes,(I&D)!==D){Cs(),_.pingedLanes|=_.suspendedLanes&I;break}_.timeoutHandle=le(Sf.bind(null,_,Qs),w);break}Sf(_,Qs);break;case 4:if(Eh(_,D),(D&4194240)===D)break;for(w=_.eventTimes,I=-1;0<D;){var se=31-rl(D);H=1<<se,se=w[se],se>I&&(I=se),D&=~H}if(D=I,D=Cr()-D,D=(120>D?120:480>D?480:1080>D?1080:1920>D?1920:3e3>D?3e3:4320>D?4320:1960*use(D/1960))-D,10<D){_.timeoutHandle=le(Sf.bind(null,_,Qs),D);break}Sf(_,Qs);break;case 5:Sf(_,Qs);break;default:throw Error(o(329))}}}return Ks(_,Cr()),_.callbackNode===C?Z4.bind(null,_):null}function xP(_,w){var C=Hy;return _.current.memoizedState.isDehydrated&&(bf(_,w).flags|=256),_=Lb(_,w),_!==2&&(w=Qs,Qs=C,w!==null&&_P(w)),_}function _P(_){Qs===null?Qs=_:Qs.push.apply(Qs,_)}function hse(_){for(var w=_;;){if(w.flags&16384){var C=w.updateQueue;if(C!==null&&(C=C.stores,C!==null))for(var D=0;D<C.length;D++){var I=C[D],H=I.getSnapshot;I=I.value;try{if(!Zl(H(),I))return!1}catch{return!1}}}if(C=w.child,w.subtreeFlags&16384&&C!==null)C.return=w,w=C;else{if(w===_)break;for(;w.sibling===null;){if(w.return===null||w.return===_)return!0;w=w.return}w.sibling.return=w.return,w=w.sibling}}return!0}function Eh(_,w){for(w&=~pP,w&=~Eb,_.suspendedLanes|=w,_.pingedLanes&=~w,_=_.expirationTimes;0<w;){var C=31-rl(w),D=1<<C;_[C]=-1,w&=~D}}function $4(_){if(di&6)throw Error(o(327));Af();var w=Xw(_,0);if(!(w&1))return Ks(_,Cr()),null;var C=Lb(_,w);if(_.tag!==0&&C===2){var D=S2(_);D!==0&&(w=D,C=xP(_,D))}if(C===1)throw C=Gy,bf(_,0),Eh(_,w),Ks(_,Cr()),C;if(C===6)throw Error(o(345));return _.finishedWork=_.current.alternate,_.finishedLanes=w,Sf(_,Qs),Ks(_,Cr()),null}function eG(_){Ah!==null&&Ah.tag===0&&!(di&6)&&Af();var w=di;di|=1;var C=Hn.transition,D=Ti;try{if(Hn.transition=null,Ti=1,_)return _()}finally{Ti=D,Hn.transition=C,di=w,!(di&6)&&$l()}}function wP(){Ro=km.current,jt(km)}function bf(_,w){_.finishedWork=null,_.finishedLanes=0;var C=_.timeoutHandle;if(C!==fe&&(_.timeoutHandle=fe,ae(C)),tr!==null)for(C=tr.return;C!==null;){var D=C;switch(U2(D),D.tag){case 1:D=D.type.childContextTypes,D!=null&&_h();break;case 3:Nm(),jt(un),jt(Mi),W2();break;case 5:V2(D);break;case 4:Nm();break;case 13:jt(gn);break;case 19:jt(gn);break;case 10:I2(D.type._context);break;case 22:case 23:wP()}C=C.return}if(er=_,tr=_=Th(_.current,null),Wr=Ro=w,pr=0,Gy=null,pP=Eb=zm=0,Qs=Hy=null,ec!==null){for(w=0;w<ec.length;w++)if(C=ec[w],D=C.interleaved,D!==null){C.interleaved=null;var I=D.next,H=C.pending;if(H!==null){var se=H.next;H.next=I,D.next=se}C.pending=D}ec=null}return _}function tG(_,w){do{var C=tr;try{if(R2(),sb.current=hb,ob){for(var D=Cn.memoizedState;D!==null;){var I=D.queue;I!==null&&(I.pending=null),D=D.next}ob=!1}if(Um=0,Pr=ss=Cn=null,Iy=!1,Ly=0,fP.current=null,C===null||C.return===null){pr=1,Gy=w,tr=null;break}e:{var H=_,se=C.return,Se=C,je=w;if(w=Wr,Se.flags|=32768,je!==null&&typeof je=="object"&&typeof je.then=="function"){var nt=je,wt=Se,ei=wt.tag;if(!(wt.mode&1)&&(ei===0||ei===11||ei===15)){var Bt=wt.alternate;Bt?(wt.updateQueue=Bt.updateQueue,wt.memoizedState=Bt.memoizedState,wt.lanes=Bt.lanes):(wt.updateQueue=null,wt.memoizedState=null)}var Yi=b4(se);if(Yi!==null){Yi.flags&=-257,S4(Yi,se,Se,H,w),Yi.mode&1&&w4(H,nt,w),w=Yi,je=nt;var Et=w.updateQueue;if(Et===null){var ls=new Set;ls.add(je),w.updateQueue=ls}else Et.add(je);break e}else{if(!(w&1)){w4(H,nt,w),bP();break e}je=Error(o(426))}}else if(hn&&Se.mode&1){var ga=b4(se);if(ga!==null){!(ga.flags&65536)&&(ga.flags|=256),S4(ga,se,Se,H,w),G2(je);break e}}H=je,pr!==4&&(pr=2),Hy===null?Hy=[H]:Hy.push(H),je=Z2(je,Se),Se=se;do{switch(Se.tag){case 3:Se.flags|=65536,w&=-w,Se.lanes|=w;var Fe=x4(Se,je,w);Gz(Se,Fe);break e;case 1:H=je;var Me=Se.type,He=Se.stateNode;if(!(Se.flags&128)&&(typeof Me.getDerivedStateFromError=="function"||He!==null&&typeof He.componentDidCatch=="function"&&(Sh===null||!Sh.has(He)))){Se.flags|=65536,w&=-w,Se.lanes|=w;var ft=_4(Se,H,w);Gz(Se,ft);break e}}Se=Se.return}while(Se!==null)}rG(C)}catch(Mt){w=Mt,tr===C&&C!==null&&(tr=C=C.return);continue}break}while(1)}function iG(){var _=Mb.current;return Mb.current=hb,_===null?hb:_}function bP(){(pr===0||pr===3||pr===2)&&(pr=4),er===null||!(zm&268435455)&&!(Eb&268435455)||Eh(er,Wr)}function Lb(_,w){var C=di;di|=2;var D=iG();er===_&&Wr===w||bf(_,w);do try{dse();break}catch(I){tG(_,I)}while(1);if(R2(),di=C,Mb.current=D,tr!==null)throw Error(o(261));return er=null,Wr=0,pr}function dse(){for(;tr!==null;)nG(tr)}function fse(){for(;tr!==null&&!kre();)nG(tr)}function nG(_){var w=aG(_.alternate,_,Ro);_.memoizedProps=_.pendingProps,w===null?rG(_):tr=w,fP.current=null}function rG(_){var w=_;do{var C=w.alternate;if(_=w.return,w.flags&32768){if(C=sse(C,w),C!==null){C.flags&=32767,tr=C;return}if(_!==null)_.flags|=32768,_.subtreeFlags=0,_.deletions=null;else{pr=6,tr=null;return}}else if(C=ise(C,w,Ro),C!==null){tr=C;return}if(w=w.sibling,w!==null){tr=w;return}tr=w=_}while(w!==null);pr===0&&(pr=5)}function Sf(_,w){var C=Ti,D=Hn.transition;try{Hn.transition=null,Ti=1,pse(_,w,C)}finally{Hn.transition=D,Ti=C}return null}function pse(_,w,C){do Af();while(Ah!==null);if(di&6)throw Error(o(327));var D=_.finishedWork,I=_.finishedLanes;if(D===null)return null;if(_.finishedWork=null,_.finishedLanes=0,D===_.current)throw Error(o(177));_.callbackNode=null,_.callbackPriority=0;var H=D.lanes|D.childLanes;if(Ure(_,H),_===er&&(tr=er=null,Wr=0),!(D.subtreeFlags&2064)&&!(D.flags&2064)||Cb||(Cb=!0,lG(C2,function(){return Af(),null})),H=(D.flags&15990)!==0,D.subtreeFlags&15990||H){H=Hn.transition,Hn.transition=null;var se=Ti;Ti=1;var Se=di;di|=4,fP.current=null,ase(_,D),lse(_,D),z(_.containerInfo),_.current=D,cse(D),zre(),di=Se,Ti=se,Hn.transition=H}else _.current=D;if(Cb&&(Cb=!1,Ah=_,Pb=I),H=_.pendingLanes,H===0&&(Sh=null),Vre(D.stateNode),Ks(_,Cr()),w!==null)for(C=_.onRecoverableError,D=0;D<w.length;D++)C(w[D]);if(Tb)throw Tb=!1,_=vP,vP=null,_;return Pb&1&&_.tag!==0&&Af(),H=_.pendingLanes,H&1?_===yP?Vy++:(Vy=0,yP=_):Vy=0,$l(),null}function Af(){if(Ah!==null){var _=Fz(Pb),w=Hn.transition,C=Ti;try{if(Hn.transition=null,Ti=16>_?16:_,Ah===null)var D=!1;else{if(_=Ah,Ah=null,Pb=0,di&6)throw Error(o(331));var I=di;for(di|=4,dt=_.current;dt!==null;){var H=dt,se=H.child;if(dt.flags&16){var Se=H.deletions;if(Se!==null){for(var je=0;je<Se.length;je++){var nt=Se[je];for(dt=nt;dt!==null;){var wt=dt;switch(wt.tag){case 0:case 11:case 15:wf(8,wt,H)}var ei=wt.child;if(ei!==null)ei.return=wt,dt=ei;else for(;dt!==null;){wt=dt;var Bt=wt.sibling,Yi=wt.return;if(H4(wt),wt===nt){dt=null;break}if(Bt!==null){Bt.return=Yi,dt=Bt;break}dt=Yi}}}var Et=H.alternate;if(Et!==null){var ls=Et.child;if(ls!==null){Et.child=null;do{var ga=ls.sibling;ls.sibling=null,ls=ga}while(ls!==null)}}dt=H}}if(H.subtreeFlags&2064&&se!==null)se.return=H,dt=se;else e:for(;dt!==null;){if(H=dt,H.flags&2048)switch(H.tag){case 0:case 11:case 15:wf(9,H,H.return)}var Fe=H.sibling;if(Fe!==null){Fe.return=H.return,dt=Fe;break e}dt=H.return}}var Me=_.current;for(dt=Me;dt!==null;){se=dt;var He=se.child;if(se.subtreeFlags&2064&&He!==null)He.return=se,dt=He;else e:for(se=Me;dt!==null;){if(Se=dt,Se.flags&2048)try{switch(Se.tag){case 0:case 11:case 15:ky(9,Se)}}catch(Mt){Js(Se,Se.return,Mt)}if(Se===se){dt=null;break e}var ft=Se.sibling;if(ft!==null){ft.return=Se.return,dt=ft;break e}dt=Se.return}}if(di=I,$l(),Jl&&typeof Jl.onPostCommitFiberRoot=="function")try{Jl.onPostCommitFiberRoot(qw,_)}catch{}D=!0}return D}finally{Ti=C,Hn.transition=w}}return!1}function sG(_,w,C){w=Z2(C,w),w=x4(_,w,1),bh(_,w),w=Cs(),_=Ib(_,1),_!==null&&(Ey(_,1,w),Ks(_,w))}function Js(_,w,C){if(_.tag===3)sG(_,_,C);else for(;w!==null;){if(w.tag===3){sG(w,_,C);break}else if(w.tag===1){var D=w.stateNode;if(typeof w.type.getDerivedStateFromError=="function"||typeof D.componentDidCatch=="function"&&(Sh===null||!Sh.has(D))){_=Z2(C,_),_=_4(w,_,1),bh(w,_),_=Cs(),w=Ib(w,1),w!==null&&(Ey(w,1,_),Ks(w,_));break}}w=w.return}}function mse(_,w,C){var D=_.pingCache;D!==null&&D.delete(w),w=Cs(),_.pingedLanes|=_.suspendedLanes&C,er===_&&(Wr&C)===C&&(pr===4||pr===3&&(Wr&130023424)===Wr&&500>Cr()-mP?bf(_,0):pP|=C),Ks(_,w)}function oG(_,w){w===0&&(_.mode&1?(w=Ww,Ww<<=1,!(Ww&130023424)&&(Ww=4194304)):w=1);var C=Cs();_=Ib(_,w),_!==null&&(Ey(_,w,C),Ks(_,C))}function gse(_){var w=_.memoizedState,C=0;w!==null&&(C=w.retryLane),oG(_,C)}function vse(_,w){var C=0;switch(_.tag){case 13:var D=_.stateNode,I=_.memoizedState;I!==null&&(C=I.retryLane);break;case 19:D=_.stateNode;break;default:throw Error(o(314))}D!==null&&D.delete(w),oG(_,C)}var aG;aG=function(_,w,C){if(_!==null)if(_.memoizedProps!==w.pendingProps||un.current)Do=!0;else{if(!(_.lanes&C)&&!(w.flags&128))return Do=!1,rse(_,w,C);Do=!!(_.flags&131072)}else Do=!1,hn&&w.flags&1048576&&qz(w,ib,w.index);switch(w.lanes=0,w.tag){case 2:var D=w.type;_!==null&&(_.alternate=null,w.alternate=null,w.flags|=2),_=w.pendingProps;var I=rn(w,Mi.current);Rm(w,C),I=q2(null,w,D,_,I,C);var H=Y2();return w.flags|=1,typeof I=="object"&&I!==null&&typeof I.render=="function"&&I.$$typeof===void 0?(w.tag=1,w.memoizedState=null,w.updateQueue=null,Tn(D)?(H=!0,Pm(w)):H=!1,w.memoizedState=I.state!==null&&I.state!==void 0?I.state:null,B2(w),I.updater=eb,w.stateNode=I,I._reactInternals=w,F2(w,D,_,C),w=tP(null,w,D,!0,H,C)):(w.tag=0,hn&&H&&N2(w),Ts(null,w,I,C),w=w.child),w;case 16:D=w.elementType;e:{switch(_!==null&&(_.alternate=null,w.alternate=null,w.flags|=2),_=w.pendingProps,I=D._init,D=I(D._payload),w.type=D,I=w.tag=xse(D),_=sl(D,_),I){case 0:w=eP(null,w,D,_,C);break e;case 1:w=R4(null,w,D,_,C);break e;case 11:w=E4(null,w,D,_,C);break e;case 14:w=T4(null,w,D,sl(D.type,_),C);break e}throw Error(o(306,D,""))}return w;case 0:return D=w.type,I=w.pendingProps,I=w.elementType===D?I:sl(D,I),eP(_,w,D,I,C);case 1:return D=w.type,I=w.pendingProps,I=w.elementType===D?I:sl(D,I),R4(_,w,D,I,C);case 3:e:{if(I4(w),_===null)throw Error(o(387));D=w.pendingProps,H=w.memoizedState,I=H.element,zz(_,w),$w(w,D,null,C);var se=w.memoizedState;if(D=se.element,ce&&H.isDehydrated)if(H={element:D,isDehydrated:!1,cache:se.cache,transitions:se.transitions},w.updateQueue.baseState=H,w.memoizedState=H,w.flags&256){I=Error(o(423)),w=L4(_,w,D,C,I);break e}else if(D!==I){I=Error(o(424)),w=L4(_,w,D,C,I);break e}else for(ce&&(Po=De(w.stateNode.containerInfo),Co=w,hn=!0,ol=null,Ty=!1),C=$z(w,null,D,C),w.child=C;C;)C.flags=C.flags&-3|4096,C=C.sibling;else{if(Bm(),D===I){w=cu(_,w,C);break e}Ts(_,w,D,C)}w=w.child}return w;case 5:return e4(w),_===null&&z2(w),D=w.type,I=w.pendingProps,H=_!==null?_.memoizedProps:null,se=I.children,re(D,I)?se=null:H!==null&&re(D,H)&&(w.flags|=32),D4(_,w),Ts(_,w,se,C),w.child;case 6:return _===null&&z2(w),null;case 13:return B4(_,w,C);case 4:return H2(w,w.stateNode.containerInfo),D=w.pendingProps,_===null?w.child=Om(w,null,D,C):Ts(_,w,D,C),w.child;case 11:return D=w.type,I=w.pendingProps,I=w.elementType===D?I:sl(D,I),E4(_,w,D,I,C);case 7:return Ts(_,w,w.pendingProps,C),w.child;case 8:return Ts(_,w,w.pendingProps.children,C),w.child;case 12:return Ts(_,w,w.pendingProps.children,C),w.child;case 10:e:{if(D=w.type._context,I=w.pendingProps,H=w.memoizedProps,se=I.value,kz(w,D,se),H!==null)if(Zl(H.value,se)){if(H.children===I.children&&!un.current){w=cu(_,w,C);break e}}else for(H=w.child,H!==null&&(H.return=w);H!==null;){var Se=H.dependencies;if(Se!==null){se=H.child;for(var je=Se.firstContext;je!==null;){if(je.context===D){if(H.tag===1){je=su(-1,C&-C),je.tag=2;var nt=H.updateQueue;if(nt!==null){nt=nt.shared;var wt=nt.pending;wt===null?je.next=je:(je.next=wt.next,wt.next=je),nt.pending=je}}H.lanes|=C,je=H.alternate,je!==null&&(je.lanes|=C),L2(H.return,C,w),Se.lanes|=C;break}je=je.next}}else if(H.tag===10)se=H.type===w.type?null:H.child;else if(H.tag===18){if(se=H.return,se===null)throw Error(o(341));se.lanes|=C,Se=se.alternate,Se!==null&&(Se.lanes|=C),L2(se,C,w),se=H.sibling}else se=H.child;if(se!==null)se.return=H;else for(se=H;se!==null;){if(se===w){se=null;break}if(H=se.sibling,H!==null){H.return=se.return,se=H;break}se=se.return}H=se}Ts(_,w,I.children,C),w=w.child}return w;case 9:return I=w.type,D=w.pendingProps.children,Rm(w,C),I=ca(I),D=D(I),w.flags|=1,Ts(_,w,D,C),w.child;case 14:return D=w.type,I=sl(D,w.pendingProps),I=sl(D.type,I),T4(_,w,D,I,C);case 15:return C4(_,w,w.type,w.pendingProps,C);case 17:return D=w.type,I=w.pendingProps,I=w.elementType===D?I:sl(D,I),_!==null&&(_.alternate=null,w.alternate=null,w.flags|=2),w.tag=1,Tn(D)?(_=!0,Pm(w)):_=!1,Rm(w,C),Wz(w,D,I),F2(w,D,I,C),tP(null,w,D,!0,_,C);case 19:return U4(_,w,C);case 22:return P4(_,w,C)}throw Error(o(156,w.tag))};function lG(_,w){return E2(_,w)}function yse(_,w,C,D){this.tag=_,this.key=C,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=w,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=D,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ma(_,w,C,D){return new yse(_,w,C,D)}function SP(_){return _=_.prototype,!(!_||!_.isReactComponent)}function xse(_){if(typeof _=="function")return SP(_)?1:0;if(_!=null){if(_=_.$$typeof,_===m)return 11;if(_===y)return 14}return 2}function Th(_,w){var C=_.alternate;return C===null?(C=ma(_.tag,w,_.key,_.mode),C.elementType=_.elementType,C.type=_.type,C.stateNode=_.stateNode,C.alternate=_,_.alternate=C):(C.pendingProps=w,C.type=_.type,C.flags=0,C.subtreeFlags=0,C.deletions=null),C.flags=_.flags&14680064,C.childLanes=_.childLanes,C.lanes=_.lanes,C.child=_.child,C.memoizedProps=_.memoizedProps,C.memoizedState=_.memoizedState,C.updateQueue=_.updateQueue,w=_.dependencies,C.dependencies=w===null?null:{lanes:w.lanes,firstContext:w.firstContext},C.sibling=_.sibling,C.index=_.index,C.ref=_.ref,C}function Bb(_,w,C,D,I,H){var se=2;if(D=_,typeof _=="function")SP(_)&&(se=1);else if(typeof _=="string")se=5;else e:switch(_){case h:return Mf(C.children,I,H,w);case u:se=8,I|=8;break;case d:return _=ma(12,C,w,I|2),_.elementType=d,_.lanes=H,_;case v:return _=ma(13,C,w,I),_.elementType=v,_.lanes=H,_;case g:return _=ma(19,C,w,I),_.elementType=g,_.lanes=H,_;case b:return Ob(C,I,H,w);default:if(typeof _=="object"&&_!==null)switch(_.$$typeof){case f:se=10;break e;case p:se=9;break e;case m:se=11;break e;case y:se=14;break e;case x:se=16,D=null;break e}throw Error(o(130,_==null?_:typeof _,""))}return w=ma(se,C,w,I),w.elementType=_,w.type=D,w.lanes=H,w}function Mf(_,w,C,D){return _=ma(7,_,D,w),_.lanes=C,_}function Ob(_,w,C,D){return _=ma(22,_,D,w),_.elementType=b,_.lanes=C,_.stateNode={},_}function AP(_,w,C){return _=ma(6,_,null,w),_.lanes=C,_}function MP(_,w,C){return w=ma(4,_.children!==null?_.children:[],_.key,w),w.lanes=C,w.stateNode={containerInfo:_.containerInfo,pendingChildren:null,implementation:_.implementation},w}function _se(_,w,C,D,I){this.tag=w,this.containerInfo=_,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=fe,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=A2(0),this.expirationTimes=A2(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=A2(0),this.identifierPrefix=D,this.onRecoverableError=I,ce&&(this.mutableSourceEagerHydrationData=null)}function cG(_,w,C,D,I,H,se,Se,je){return _=new _se(_,w,C,Se,je),w===1?(w=1,H===!0&&(w|=8)):w=0,H=ma(3,null,null,w),_.current=H,H.stateNode=_,H.memoizedState={element:D,isDehydrated:C,cache:null,transitions:null},B2(H),_}function uG(_){if(!_)return $n;_=_._reactInternals;e:{if(T(_)!==_||_.tag!==1)throw Error(o(170));var w=_;do{switch(w.tag){case 3:w=w.stateNode.context;break e;case 1:if(Tn(w.type)){w=w.stateNode.__reactInternalMemoizedMergedChildContext;break e}}w=w.return}while(w!==null);throw Error(o(171))}if(_.tag===1){var C=_.type;if(Tn(C))return Cm(_,C,w)}return w}function hG(_){var w=_._reactInternals;if(w===void 0)throw typeof _.render=="function"?Error(o(188)):(_=Object.keys(_).join(","),Error(o(268,_)));return _=U(w),_===null?null:_.stateNode}function dG(_,w){if(_=_.memoizedState,_!==null&&_.dehydrated!==null){var C=_.retryLane;_.retryLane=C!==0&&C<w?C:w}}function EP(_,w){dG(_,w),(_=_.alternate)&&dG(_,w)}function wse(_){return _=U(_),_===null?null:_.stateNode}function bse(){return null}return i.attemptContinuousHydration=function(_){if(_.tag===13){var w=Cs();pa(_,134217728,w),EP(_,134217728)}},i.attemptHydrationAtCurrentPriority=function(_){if(_.tag===13){var w=Cs(),C=Mh(_);pa(_,C,w),EP(_,C)}},i.attemptSynchronousHydration=function(_){switch(_.tag){case 3:var w=_.stateNode;if(w.current.memoizedState.isDehydrated){var C=My(w.pendingLanes);C!==0&&(M2(w,C|1),Ks(w,Cr()),!(di&6)&&(Gm(),$l()))}break;case 13:var D=Cs();eG(function(){return pa(_,1,D)}),EP(_,1)}},i.batchedUpdates=function(_,w){var C=di;di|=1;try{return _(w)}finally{di=C,di===0&&(Gm(),Yw&&$l())}},i.createComponentSelector=function(_){return{$$typeof:_b,value:_}},i.createContainer=function(_,w,C,D,I,H,se){return cG(_,w,!1,null,C,D,I,H,se)},i.createHasPseudoClassSelector=function(_){return{$$typeof:wb,value:_}},i.createHydrationContainer=function(_,w,C,D,I,H,se,Se,je){return _=cG(C,D,!0,_,I,H,se,Se,je),_.context=uG(null),C=_.current,D=Cs(),I=Mh(C),H=su(D,I),H.callback=w??null,bh(C,H),_.current.lanes=I,Ey(_,I,D),Ks(_,D),_},i.createPortal=function(_,w,C){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:D==null?null:""+D,children:_,containerInfo:w,implementation:C}},i.createRoleSelector=function(_){return{$$typeof:bb,value:_}},i.createTestNameSelector=function(_){return{$$typeof:Sb,value:_}},i.createTextSelector=function(_){return{$$typeof:Ab,value:_}},i.deferredUpdates=function(_){var w=Ti,C=Hn.transition;try{return Hn.transition=null,Ti=16,_()}finally{Ti=w,Hn.transition=C}},i.discreteUpdates=function(_,w,C,D,I){var H=Ti,se=Hn.transition;try{return Hn.transition=null,Ti=1,_(w,C,D,I)}finally{Ti=H,Hn.transition=se,di===0&&Gm()}},i.findAllNodes=dP,i.findBoundingRects=function(_,w){if(!tt)throw Error(o(363));w=dP(_,w),_=[];for(var C=0;C<w.length;C++)_.push(ee(w[C]));for(w=_.length-1;0<w;w--){C=_[w];for(var D=C.x,I=D+C.width,H=C.y,se=H+C.height,Se=w-1;0<=Se;Se--)if(w!==Se){var je=_[Se],nt=je.x,wt=nt+je.width,ei=je.y,Bt=ei+je.height;if(D>=nt&&H>=ei&&I<=wt&&se<=Bt){_.splice(w,1);break}else if(D!==nt||C.width!==je.width||Bt<H||ei>se){if(!(H!==ei||C.height!==je.height||wt<D||nt>I)){nt>D&&(je.width+=nt-D,je.x=D),wt<I&&(je.width=I-nt),_.splice(w,1);break}}else{ei>H&&(je.height+=ei-H,je.y=H),Bt<se&&(je.height=se-ei),_.splice(w,1);break}}}return _},i.findHostInstance=hG,i.findHostInstanceWithNoPortals=function(_){return _=R(_),_=_!==null?N(_):null,_===null?null:_.stateNode},i.findHostInstanceWithWarning=function(_){return hG(_)},i.flushControlled=function(_){var w=di;di|=1;var C=Hn.transition,D=Ti;try{Hn.transition=null,Ti=1,_()}finally{Ti=D,Hn.transition=C,di=w,di===0&&(Gm(),$l())}},i.flushPassiveEffects=Af,i.flushSync=eG,i.focusWithin=function(_,w){if(!tt)throw Error(o(363));for(_=cP(_),w=J4(_,w),w=Array.from(w),_=0;_<w.length;){var C=w[_++];if(!V(C)){if(C.tag===5&&Ee(C.stateNode))return!0;for(C=C.child;C!==null;)w.push(C),C=C.sibling}}return!1},i.getCurrentUpdatePriority=function(){return Ti},i.getFindAllNodesFailureDescription=function(_,w){if(!tt)throw Error(o(363));var C=0,D=[];_=[cP(_),0];for(var I=0;I<_.length;){var H=_[I++],se=_[I++],Se=w[se];if((H.tag!==5||!V(H))&&(uP(H,Se)&&(D.push(hP(Se)),se++,se>C&&(C=se)),se<w.length))for(H=H.child;H!==null;)_.push(H,se),H=H.sibling}if(C<w.length){for(_=[];C<w.length;C++)_.push(hP(w[C]));return`findAllNodes was able to match part of the selector:
  `+(D.join(" > ")+`

No matching component was found for:
  `)+_.join(" > ")}return null},i.getPublicRootInstance=function(_){if(_=_.current,!_.child)return null;switch(_.child.tag){case 5:return Q(_.child.stateNode);default:return _.child.stateNode}},i.injectIntoDevTools=function(_){if(_={bundleType:_.bundleType,version:_.version,rendererPackageName:_.rendererPackageName,rendererConfig:_.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:wse,findFiberByHostInstance:_.findFiberByHostInstance||bse,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")_=!1;else{var w=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(w.isDisabled||!w.supportsFiber)_=!0;else{try{qw=w.inject(_),Jl=w}catch{}_=!!w.checkDCE}}return _},i.isAlreadyRendering=function(){return!1},i.observeVisibleRects=function(_,w,C,D){if(!tt)throw Error(o(363));_=dP(_,w);var I=Te(_,C,D).disconnect;return{disconnect:function(){I()}}},i.registerMutableSourceForHydration=function(_,w){var C=w._getVersion;C=C(w._source),_.mutableSourceEagerHydrationData==null?_.mutableSourceEagerHydrationData=[w,C]:_.mutableSourceEagerHydrationData.push(w,C)},i.runWithPriority=function(_,w){var C=Ti;try{return Ti=_,w()}finally{Ti=C}},i.shouldError=function(){return null},i.shouldSuspend=function(){return!1},i.updateContainer=function(_,w,C,D){var I=w.current,H=Cs(),se=Mh(I);return C=uG(C),w.context===null?w.context=C:w.pendingContext=C,w=su(H,se),w.payload={element:_},D=D===void 0?null:D,D!==null&&(w.callback=D),bh(I,w),_=pa(I,se,H),_!==null&&Zw(_,I,se),se},i};YK.exports=Yme;var Qme=YK.exports;const Kme=xF(Qme);var QK={exports:{}},KK={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(B,j){var z=B.length;B.push(j);e:for(;0<z;){var k=z-1>>>1,G=B[k];if(0<r(G,j))B[k]=j,B[z]=G,z=k;else break e}}function i(B){return B.length===0?null:B[0]}function n(B){if(B.length===0)return null;var j=B[0],z=B.pop();if(z!==j){B[0]=z;e:for(var k=0,G=B.length,Z=G>>>1;k<Z;){var K=2*(k+1)-1,re=B[K],J=K+1,le=B[J];if(0>r(re,z))J<G&&0>r(le,re)?(B[k]=le,B[J]=z,k=J):(B[k]=re,B[K]=z,k=K);else if(J<G&&0>r(le,z))B[k]=le,B[J]=z,k=J;else break e}}return j}function r(B,j){var z=B.sortIndex-j.sortIndex;return z!==0?z:B.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,u=null,d=3,f=!1,p=!1,m=!1,v=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(B){for(var j=i(c);j!==null;){if(j.callback===null)n(c);else if(j.startTime<=B)n(c),j.sortIndex=j.expirationTime,e(l,j);else break;j=i(c)}}function b(B){if(m=!1,x(B),!p)if(i(l)!==null)p=!0,Q(S);else{var j=i(c);j!==null&&X(b,j.startTime-B)}}function S(B,j){p=!1,m&&(m=!1,g(M),M=-1),f=!0;var z=d;try{for(x(j),u=i(l);u!==null&&(!(u.expirationTime>j)||B&&!R());){var k=u.callback;if(typeof k=="function"){u.callback=null,d=u.priorityLevel;var G=k(u.expirationTime<=j);j=t.unstable_now(),typeof G=="function"?u.callback=G:u===i(l)&&n(l),x(j)}else n(l);u=i(l)}if(u!==null)var Z=!0;else{var K=i(c);K!==null&&X(b,K.startTime-j),Z=!1}return Z}finally{u=null,d=z,f=!1}}var A=!1,E=null,M=-1,T=5,P=-1;function R(){return!(t.unstable_now()-P<T)}function U(){if(E!==null){var B=t.unstable_now();P=B;var j=!0;try{j=E(!0,B)}finally{j?F():(A=!1,E=null)}}else A=!1}var F;if(typeof y=="function")F=function(){y(U)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,W=N.port2;N.port1.onmessage=U,F=function(){W.postMessage(null)}}else F=function(){v(U,0)};function Q(B){E=B,A||(A=!0,F())}function X(B,j){M=v(function(){B(t.unstable_now())},j)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,Q(S))},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return i(l)},t.unstable_next=function(B){switch(d){case 1:case 2:case 3:var j=3;break;default:j=d}var z=d;d=j;try{return B()}finally{d=z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(B,j){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var z=d;d=B;try{return j()}finally{d=z}},t.unstable_scheduleCallback=function(B,j,z){var k=t.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?k+z:k):z=k,B){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=z+G,B={id:h++,callback:j,priorityLevel:B,startTime:z,expirationTime:G,sortIndex:-1},z>k?(B.sortIndex=z,e(c,B),i(l)===null&&B===i(c)&&(m?(g(M),M=-1):m=!0,X(b,z-k))):(B.sortIndex=G,e(l,B),p||f||(p=!0,Q(S))),B},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(B){var j=d;return function(){var z=d;d=j;try{return B.apply(this,arguments)}finally{d=z}}}})(KK);QK.exports=KK;var oV=QK.exports;const Jme=t=>typeof t=="object"&&typeof t.then=="function",_p=[];function JK(t,e,i=(n,r)=>n===r){if(t===e)return!0;if(!t||!e)return!1;const n=t.length;if(e.length!==n)return!1;for(let r=0;r<n;r++)if(!i(t[r],e[r]))return!1;return!0}function ZK(t,e=null,i=!1,n={}){e===null&&(e=[t]);for(const s of _p)if(JK(e,s.keys,s.equal)){if(i)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return n.lifespan&&n.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,n.lifespan)),s.response;if(!i)throw s.promise}const r={keys:e,equal:n.equal,remove:()=>{const s=_p.indexOf(r);s!==-1&&_p.splice(s,1)},promise:(Jme(t)?t:t(...e)).then(s=>{r.response=s,n.lifespan&&n.lifespan>0&&(r.timeout=setTimeout(r.remove,n.lifespan))}).catch(s=>r.error=s)};if(_p.push(r),!i)throw r.promise}const Zme=(t,e,i)=>ZK(t,e,!1,i),$me=(t,e,i)=>void ZK(t,e,!0,i),ege=t=>{if(t===void 0||t.length===0)_p.splice(0,_p.length);else{const e=_p.find(i=>JK(t,i.keys,i.equal));e&&e.remove()}},uU={},tge=t=>void Object.assign(uU,t);function ige(t,e){function i(h,{args:u=[],attach:d,...f},p){let m=`${h[0].toUpperCase()}${h.slice(1)}`,v;if(h==="primitive"){if(f.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const g=f.object;v=Xg(g,{type:h,root:p,attach:d,primitive:!0})}else{const g=uU[m];if(!g)throw new Error(`R3F: ${m} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(u))throw new Error("R3F: The args prop must be an array!");v=Xg(new g(...u),{type:h,root:p,attach:d,memoizedProps:{args:u}})}return v.__r3f.attach===void 0&&(v instanceof si?v.__r3f.attach="geometry":v instanceof dr&&(v.__r3f.attach="material")),m!=="inject"&&FD(v,f),v}function n(h,u){let d=!1;if(u){var f,p;(f=u.__r3f)!=null&&f.attach?OD(h,u,u.__r3f.attach):u.isObject3D&&h.isObject3D&&(h.add(u),d=!0),d||(p=h.__r3f)==null||p.objects.push(u),u.__r3f||Xg(u,{}),u.__r3f.parent=h,XL(u),qg(u)}}function r(h,u,d){let f=!1;if(u){var p,m;if((p=u.__r3f)!=null&&p.attach)OD(h,u,u.__r3f.attach);else if(u.isObject3D&&h.isObject3D){u.parent=h,u.dispatchEvent({type:"added"});const v=h.children.filter(y=>y!==u),g=v.indexOf(d);h.children=[...v.slice(0,g),u,...v.slice(g)],f=!0}f||(m=h.__r3f)==null||m.objects.push(u),u.__r3f||Xg(u,{}),u.__r3f.parent=h,XL(u),qg(u)}}function s(h,u,d=!1){h&&[...h].forEach(f=>o(u,f,d))}function o(h,u,d){if(u){var f,p,m;if(u.__r3f&&(u.__r3f.parent=null),(f=h.__r3f)!=null&&f.objects&&(h.__r3f.objects=h.__r3f.objects.filter(b=>b!==u)),(p=u.__r3f)!=null&&p.attach)hV(h,u,u.__r3f.attach);else if(u.isObject3D&&h.isObject3D){var v;h.remove(u),(v=u.__r3f)!=null&&v.root&&uge(u.__r3f.root,u)}const y=(m=u.__r3f)==null?void 0:m.primitive,x=d===void 0?u.dispose!==null&&!y:d;if(!y){var g;s((g=u.__r3f)==null?void 0:g.objects,u,x),s(u.children,u,x)}delete u.__r3f,x&&u.dispose&&u.type!=="Scene"&&oV.unstable_scheduleCallback(oV.unstable_IdlePriority,()=>{try{u.dispose()}catch{}}),qg(h)}}function a(h,u,d,f){var p;const m=(p=h.__r3f)==null?void 0:p.parent;if(!m)return;const v=i(u,d,h.__r3f.root);if(h.children){for(const g of h.children)g.__r3f&&n(v,g);h.children=h.children.filter(g=>!g.__r3f)}h.__r3f.objects.forEach(g=>n(v,g)),h.__r3f.objects=[],h.__r3f.autoRemovedBeforeAppend||o(m,h),v.parent&&(v.__r3f.autoRemovedBeforeAppend=!0),n(m,v),v.raycast&&v.__r3f.eventCount&&v.__r3f.root.getState().internal.interaction.push(v),[f,f.alternate].forEach(g=>{g!==null&&(g.stateNode=v,g.ref&&(typeof g.ref=="function"?g.ref(v):g.ref.current=v))})}const l=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:Kme({createInstance:i,removeChild:o,appendChild:n,appendInitialChild:n,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(h,u)=>{if(!u)return;const d=h.getState().scene;d.__r3f&&(d.__r3f.root=h,n(d,u))},removeChildFromContainer:(h,u)=>{u&&o(h.getState().scene,u)},insertInContainerBefore:(h,u,d)=>{if(!u||!d)return;const f=h.getState().scene;f.__r3f&&r(f,u,d)},getRootHostContext:()=>null,getChildHostContext:h=>h,finalizeInitialChildren(h){var u;return!!((u=h==null?void 0:h.__r3f)!=null?u:{}).handlers},prepareUpdate(h,u,d,f){var p;if(((p=h==null?void 0:h.__r3f)!=null?p:{}).primitive&&f.object&&f.object!==h)return[!0];{const{args:v=[],children:g,...y}=f,{args:x=[],children:b,...S}=d;if(!Array.isArray(v))throw new Error("R3F: the args prop must be an array!");if(v.some((E,M)=>E!==x[M]))return[!0];const A=sJ(h,y,S,!0);return A.changes.length?[!1,A]:null}},commitUpdate(h,[u,d],f,p,m,v){u?a(h,f,m,v):FD(h,d)},commitMount(h,u,d,f){var p;const m=(p=h.__r3f)!=null?p:{};h.raycast&&m.handlers&&m.eventCount&&h.__r3f.root.getState().internal.interaction.push(h)},getPublicInstance:h=>h,prepareForCommit:()=>null,preparePortalMount:h=>Xg(h.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(h){var u;const{attach:d,parent:f}=(u=h.__r3f)!=null?u:{};d&&f&&hV(f,h,d),h.isObject3D&&(h.visible=!1),qg(h)},unhideInstance(h,u){var d;const{attach:f,parent:p}=(d=h.__r3f)!=null?d:{};f&&p&&OD(p,h,f),(h.isObject3D&&u.visible==null||u.visible)&&(h.visible=!0),qg(h)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():mv.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&ln.fun(performance.now)?performance.now:ln.fun(Date.now)?Date.now:()=>0,scheduleTimeout:ln.fun(setTimeout)?setTimeout:void 0,cancelTimeout:ln.fun(clearTimeout)?clearTimeout:void 0}),applyProps:FD}}var aV,lV;const BD=t=>"colorSpace"in t||"outputColorSpace"in t,$K=()=>{var t;return(t=uU.ColorManagement)!=null?t:null},eJ=t=>t&&t.isOrthographicCamera,nge=t=>t&&t.hasOwnProperty("current"),ww=typeof window<"u"&&((aV=window.document)!=null&&aV.createElement||((lV=window.navigator)==null?void 0:lV.product)==="ReactNative")?ye.useLayoutEffect:ye.useEffect;function tJ(t){const e=ye.useRef(t);return ww(()=>void(e.current=t),[t]),e}function rge({set:t}){return ww(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}class iJ extends ye.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}iJ.getDerivedStateFromError=()=>({error:!0});const nJ="__default",cV=new Map,sge=t=>t&&!!t.memoized&&!!t.changes;function rJ(t){var e;const i=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(t)?Math.min(Math.max(t[0],i),t[1]):t}const lx=t=>{var e;return(e=t.__r3f)==null?void 0:e.root.getState()},ln={obj:t=>t===Object(t)&&!ln.arr(t)&&typeof t!="function",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",boo:t=>typeof t=="boolean",und:t=>t===void 0,arr:t=>Array.isArray(t),equ(t,e,{arrays:i="shallow",objects:n="reference",strict:r=!0}={}){if(typeof t!=typeof e||!!t!=!!e)return!1;if(ln.str(t)||ln.num(t))return t===e;const s=ln.obj(t);if(s&&n==="reference")return t===e;const o=ln.arr(t);if(o&&i==="reference")return t===e;if((o||s)&&t===e)return!0;let a;for(a in t)if(!(a in e))return!1;if(s&&i==="shallow"&&n==="shallow"){for(a in r?e:t)if(!ln.equ(t[a],e[a],{strict:r,objects:"reference"}))return!1}else for(a in r?e:t)if(t[a]!==e[a])return!1;if(ln.und(a)){if(o&&t.length===0&&e.length===0||s&&Object.keys(t).length===0&&Object.keys(e).length===0)return!0;if(t!==e)return!1}return!0}};function oge(t){const e={nodes:{},materials:{}};return t&&t.traverse(i=>{i.name&&(e.nodes[i.name]=i),i.material&&!e.materials[i.material.name]&&(e.materials[i.material.name]=i.material)}),e}function age(t){t.dispose&&t.type!=="Scene"&&t.dispose();for(const e in t)e.dispose==null||e.dispose(),delete t[e]}function Xg(t,e){const i=t;return i.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},t}function WL(t,e){let i=t;if(e.includes("-")){const n=e.split("-"),r=n.pop();return i=n.reduce((s,o)=>s[o],t),{target:i,key:r}}else return{target:i,key:e}}const uV=/-\d+$/;function OD(t,e,i){if(ln.str(i)){if(uV.test(i)){const s=i.replace(uV,""),{target:o,key:a}=WL(t,s);Array.isArray(o[a])||(o[a]=[])}const{target:n,key:r}=WL(t,i);e.__r3f.previousAttach=n[r],n[r]=e}else e.__r3f.previousAttach=i(t,e)}function hV(t,e,i){var n,r;if(ln.str(i)){const{target:s,key:o}=WL(t,i),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(n=e.__r3f)==null||n.previousAttach==null||n.previousAttach(t,e);(r=e.__r3f)==null||delete r.previousAttach}function sJ(t,{children:e,key:i,ref:n,...r},{children:s,key:o,ref:a,...l}={},c=!1){var h;const u=(h=t==null?void 0:t.__r3f)!=null?h:{},d=Object.entries(r),f=[];if(c){const m=Object.keys(l);for(let v=0;v<m.length;v++)r.hasOwnProperty(m[v])||d.unshift([m[v],nJ+"remove"])}d.forEach(([m,v])=>{var g;if((g=t.__r3f)!=null&&g.primitive&&m==="object"||ln.equ(v,l[m]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(m))return f.push([m,v,!0,[]]);let y=[];m.includes("-")&&(y=m.split("-")),f.push([m,v,!1,y]);for(const x in r){const b=r[x];x.startsWith(`${m}-`)&&f.push([x,b,!1,x.split("-")])}});const p={...r};return u.memoizedProps&&u.memoizedProps.args&&(p.args=u.memoizedProps.args),u.memoizedProps&&u.memoizedProps.attach&&(p.attach=u.memoizedProps.attach),{memoized:p,changes:f}}function FD(t,e){var i,n,r;const s=(i=t.__r3f)!=null?i:{},o=s.root,a=(n=o==null||o.getState==null?void 0:o.getState())!=null?n:{},{memoized:l,changes:c}=sge(e)?e:sJ(t,e),h=s.eventCount;t.__r3f&&(t.__r3f.memoizedProps=l);for(let d=0;d<c.length;d++){let[f,p,m,v]=c[d];if(BD(t)){const b="srgb",S="srgb-linear";f==="encoding"?(f="colorSpace",p=p===3001?b:S):f==="outputEncoding"&&(f="outputColorSpace",p=p===3001?b:S)}let g=t,y=g[f];if(v.length&&(y=v.reduce((x,b)=>x[b],t),!(y&&y.set))){const[x,...b]=v.reverse();g=b.reverse().reduce((S,A)=>S[A],t),f=x}if(p===nJ+"remove")if(g.constructor){let x=cV.get(g.constructor);x||(x=new g.constructor,cV.set(g.constructor,x)),p=x[f]}else p=0;if(m)p?s.handlers[f]=p:delete s.handlers[f],s.eventCount=Object.keys(s.handlers).length;else if(y&&y.set&&(y.copy||y instanceof Lp)){if(Array.isArray(p))y.fromArray?y.fromArray(p):y.set(...p);else if(y.copy&&p&&p.constructor&&y.constructor===p.constructor)y.copy(p);else if(p!==void 0){const x=y instanceof ht;!x&&y.setScalar?y.setScalar(p):y instanceof Lp&&p instanceof Lp?y.mask=p.mask:y.set(p),!$K()&&!a.linear&&x&&y.convertSRGBToLinear()}}else if(g[f]=p,g[f]instanceof pn&&g[f].format===no&&g[f].type===Nc){const x=g[f];BD(x)&&BD(a.gl)?x.colorSpace=a.gl.outputColorSpace:x.encoding=a.gl.outputEncoding}qg(t)}if(s.parent&&a.internal&&t.raycast&&h!==s.eventCount){const d=a.internal.interaction.indexOf(t);d>-1&&a.internal.interaction.splice(d,1),s.eventCount&&a.internal.interaction.push(t)}return!(c.length===1&&c[0][0]==="onUpdate")&&c.length&&(r=t.__r3f)!=null&&r.parent&&XL(t),t}function qg(t){var e,i;const n=(e=t.__r3f)==null||(i=e.root)==null||i.getState==null?void 0:i.getState();n&&n.internal.frames===0&&n.invalidate()}function XL(t){t.onUpdate==null||t.onUpdate(t)}function lge(t,e){t.manual||(eJ(t)?(t.left=e.width/-2,t.right=e.width/2,t.top=e.height/2,t.bottom=e.height/-2):t.aspect=e.width/e.height,t.updateProjectionMatrix(),t.updateMatrixWorld())}function zS(t){return(t.eventObject||t.object).uuid+"/"+t.index+t.instanceId}function cge(){var t;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return mv.DefaultEventPriority;switch((t=e.event)==null?void 0:t.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return mv.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return mv.ContinuousEventPriority;default:return mv.DefaultEventPriority}}function oJ(t,e,i,n){const r=i.get(e);r&&(i.delete(e),i.size===0&&(t.delete(n),r.target.releasePointerCapture(n)))}function uge(t,e){const{internal:i}=t.getState();i.interaction=i.interaction.filter(n=>n!==e),i.initialHits=i.initialHits.filter(n=>n!==e),i.hovered.forEach((n,r)=>{(n.eventObject===e||n.object===e)&&i.hovered.delete(r)}),i.capturedMap.forEach((n,r)=>{oJ(i.capturedMap,e,n,r)})}function hge(t){function e(l){const{internal:c}=t.getState(),h=l.offsetX-c.initialClick[0],u=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(h*h+u*u))}function i(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(h=>{var u;return(u=c.__r3f)==null?void 0:u.handlers["onPointer"+h]}))}function n(l,c){const h=t.getState(),u=new Set,d=[],f=c?c(h.internal.interaction):h.internal.interaction;for(let g=0;g<f.length;g++){const y=lx(f[g]);y&&(y.raycaster.camera=void 0)}h.previousRoot||h.events.compute==null||h.events.compute(l,h);function p(g){const y=lx(g);if(!y||!y.events.enabled||y.raycaster.camera===null)return[];if(y.raycaster.camera===void 0){var x;y.events.compute==null||y.events.compute(l,y,(x=y.previousRoot)==null?void 0:x.getState()),y.raycaster.camera===void 0&&(y.raycaster.camera=null)}return y.raycaster.camera?y.raycaster.intersectObject(g,!0):[]}let m=f.flatMap(p).sort((g,y)=>{const x=lx(g.object),b=lx(y.object);return!x||!b?g.distance-y.distance:b.events.priority-x.events.priority||g.distance-y.distance}).filter(g=>{const y=zS(g);return u.has(y)?!1:(u.add(y),!0)});h.events.filter&&(m=h.events.filter(m,h));for(const g of m){let y=g.object;for(;y;){var v;(v=y.__r3f)!=null&&v.eventCount&&d.push({...g,eventObject:y}),y=y.parent}}if("pointerId"in l&&h.internal.capturedMap.has(l.pointerId))for(let g of h.internal.capturedMap.get(l.pointerId).values())u.has(zS(g.intersection))||d.push(g.intersection);return d}function r(l,c,h,u){const d=t.getState();if(l.length){const f={stopped:!1};for(const p of l){const m=lx(p.object)||d,{raycaster:v,pointer:g,camera:y,internal:x}=m,b=new te(g.x,g.y,0).unproject(y),S=P=>{var R,U;return(R=(U=x.capturedMap.get(P))==null?void 0:U.has(p.eventObject))!=null?R:!1},A=P=>{const R={intersection:p,target:c.target};x.capturedMap.has(P)?x.capturedMap.get(P).set(p.eventObject,R):x.capturedMap.set(P,new Map([[p.eventObject,R]])),c.target.setPointerCapture(P)},E=P=>{const R=x.capturedMap.get(P);R&&oJ(x.capturedMap,p.eventObject,R,P)};let M={};for(let P in c){let R=c[P];typeof R!="function"&&(M[P]=R)}let T={...p,...M,pointer:g,intersections:l,stopped:f.stopped,delta:h,unprojectedPoint:b,ray:v.ray,camera:y,stopPropagation(){const P="pointerId"in c&&x.capturedMap.get(c.pointerId);if((!P||P.has(p.eventObject))&&(T.stopped=f.stopped=!0,x.hovered.size&&Array.from(x.hovered.values()).find(R=>R.eventObject===p.eventObject))){const R=l.slice(0,l.indexOf(p));s([...R,p])}},target:{hasPointerCapture:S,setPointerCapture:A,releasePointerCapture:E},currentTarget:{hasPointerCapture:S,setPointerCapture:A,releasePointerCapture:E},nativeEvent:c};if(u(T),f.stopped===!0)break}}return l}function s(l){const{internal:c}=t.getState();for(const h of c.hovered.values())if(!l.length||!l.find(u=>u.object===h.object&&u.index===h.index&&u.instanceId===h.instanceId)){const d=h.eventObject.__r3f,f=d==null?void 0:d.handlers;if(c.hovered.delete(zS(h)),d!=null&&d.eventCount){const p={...h,intersections:l};f.onPointerOut==null||f.onPointerOut(p),f.onPointerLeave==null||f.onPointerLeave(p)}}}function o(l,c){for(let h=0;h<c.length;h++){const u=c[h].__r3f;u==null||u.handlers.onPointerMissed==null||u.handlers.onPointerMissed(l)}}function a(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return c=>{const{internal:h}=t.getState();"pointerId"in c&&h.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{h.capturedMap.has(c.pointerId)&&(h.capturedMap.delete(c.pointerId),s([]))})}}return function(h){const{onPointerMissed:u,internal:d}=t.getState();d.lastEvent.current=h;const f=l==="onPointerMove",p=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",v=n(h,f?i:void 0),g=p?e(h):0;l==="onPointerDown"&&(d.initialClick=[h.offsetX,h.offsetY],d.initialHits=v.map(x=>x.eventObject)),p&&!v.length&&g<=2&&(o(h,d.interaction),u&&u(h)),f&&s(v);function y(x){const b=x.eventObject,S=b.__r3f,A=S==null?void 0:S.handlers;if(S!=null&&S.eventCount)if(f){if(A.onPointerOver||A.onPointerEnter||A.onPointerOut||A.onPointerLeave){const E=zS(x),M=d.hovered.get(E);M?M.stopped&&x.stopPropagation():(d.hovered.set(E,x),A.onPointerOver==null||A.onPointerOver(x),A.onPointerEnter==null||A.onPointerEnter(x))}A.onPointerMove==null||A.onPointerMove(x)}else{const E=A[l];E?(!p||d.initialHits.includes(b))&&(o(h,d.interaction.filter(M=>!d.initialHits.includes(M))),E(x)):p&&d.initialHits.includes(b)&&o(h,d.interaction.filter(M=>!d.initialHits.includes(M)))}}r(v,h,g,y)}}return{handlePointer:a}}const aJ=t=>!!(t!=null&&t.render),lJ=ye.createContext(null),dge=(t,e)=>{const i=qK((a,l)=>{const c=new te,h=new te,u=new te;function d(g=l().camera,y=h,x=l().size){const{width:b,height:S,top:A,left:E}=x,M=b/S;y instanceof te?u.copy(y):u.set(...y);const T=g.getWorldPosition(c).distanceTo(u);if(eJ(g))return{width:b/g.zoom,height:S/g.zoom,top:A,left:E,factor:1,distance:T,aspect:M};{const P=g.fov*Math.PI/180,R=2*Math.tan(P/2)*T,U=R*(b/S);return{width:U,height:R,top:A,left:E,factor:b/U,distance:T,aspect:M}}}let f;const p=g=>a(y=>({performance:{...y.performance,current:g}})),m=new Qe;return{set:a,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(g=1)=>t(l(),g),advance:(g,y)=>e(g,y,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new oU,pointer:m,mouse:m,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const g=l();f&&clearTimeout(f),g.performance.current!==g.performance.min&&p(g.performance.min),f=setTimeout(()=>p(l().performance.max),g.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:d},setEvents:g=>a(y=>({...y,events:{...y.events,...g}})),setSize:(g,y,x,b,S)=>{const A=l().camera,E={width:g,height:y,top:b||0,left:S||0,updateStyle:x};a(M=>({size:E,viewport:{...M.viewport,...d(A,h,E)}}))},setDpr:g=>a(y=>{const x=rJ(g);return{viewport:{...y.viewport,dpr:x,initialDpr:y.viewport.initialDpr||x}}}),setFrameloop:(g="always")=>{const y=l().clock;y.stop(),y.elapsedTime=0,g!=="never"&&(y.start(),y.elapsedTime=0),a(()=>({frameloop:g}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:ye.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(g,y,x)=>{const b=l().internal;return b.priority=b.priority+(y>0?1:0),b.subscribers.push({ref:g,priority:y,store:x}),b.subscribers=b.subscribers.sort((S,A)=>S.priority-A.priority),()=>{const S=l().internal;S!=null&&S.subscribers&&(S.priority=S.priority-(y>0?1:0),S.subscribers=S.subscribers.filter(A=>A.ref!==g))}}}}}),n=i.getState();let r=n.size,s=n.viewport.dpr,o=n.camera;return i.subscribe(()=>{const{camera:a,size:l,viewport:c,gl:h,set:u}=i.getState();if(l!==r||c.dpr!==s){var d;r=l,s=c.dpr,lge(a,l),h.setPixelRatio(c.dpr);const f=(d=l.updateStyle)!=null?d:typeof HTMLCanvasElement<"u"&&h.domElement instanceof HTMLCanvasElement;h.setSize(l.width,l.height,f)}a!==o&&(o=a,u(f=>({viewport:{...f.viewport,...f.viewport.getCurrentViewport(a)}})))}),i.subscribe(a=>t(a)),i};let GS,fge=new Set,pge=new Set,mge=new Set;function ND(t,e){if(t.size)for(const{callback:i}of t.values())i(e)}function cx(t,e){switch(t){case"before":return ND(fge,e);case"after":return ND(pge,e);case"tail":return ND(mge,e)}}let UD,kD;function zD(t,e,i){let n=e.clock.getDelta();for(e.frameloop==="never"&&typeof t=="number"&&(n=t-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=t),UD=e.internal.subscribers,GS=0;GS<UD.length;GS++)kD=UD[GS],kD.ref.current(kD.store.getState(),n,i);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function gge(t){let e=!1,i,n,r;function s(l){n=requestAnimationFrame(s),e=!0,i=0,cx("before",l);for(const h of t.values()){var c;r=h.store.getState(),r.internal.active&&(r.frameloop==="always"||r.internal.frames>0)&&!((c=r.gl.xr)!=null&&c.isPresenting)&&(i+=zD(l,r))}if(cx("after",l),i===0)return cx("tail",l),e=!1,cancelAnimationFrame(n)}function o(l,c=1){var h;if(!l)return t.forEach(u=>o(u.store.getState()),c);(h=l.gl.xr)!=null&&h.isPresenting||!l.internal.active||l.frameloop==="never"||(l.internal.frames=Math.min(60,l.internal.frames+c),e||(e=!0,requestAnimationFrame(s)))}function a(l,c=!0,h,u){if(c&&cx("before",l),h)zD(l,h,u);else for(const d of t.values())zD(l,d.store.getState());c&&cx("after",l)}return{loop:s,invalidate:o,advance:a}}function cJ(){const t=ye.useContext(lJ);if(!t)throw new Error("R3F: Hooks can only be used within the Canvas component!");return t}function Ia(t=i=>i,e){return cJ()(t,e)}function uJ(t,e=0){const i=cJ(),n=i.getState().internal.subscribe,r=tJ(t);return ww(()=>n(r,e,i),[e,n,i]),null}function hJ(t,e){return function(i,...n){const r=new i;return t&&t(r),Promise.all(n.map(s=>new Promise((o,a)=>r.load(s,l=>{l.scene&&Object.assign(l,oge(l.scene)),o(l)},e,l=>a(new Error(`Could not load ${s}: ${l.message})`))))))}}function bw(t,e,i,n){const r=Array.isArray(e)?e:[e],s=Zme(hJ(i,n),[t,...r],{equal:ln.equ});return Array.isArray(e)?s:s[0]}bw.preload=function(t,e,i){const n=Array.isArray(e)?e:[e];return $me(hJ(i),[t,...n])};bw.clear=function(t,e){const i=Array.isArray(e)?e:[e];return ege([t,...i])};const w0=new Map,{invalidate:dV,advance:fV}=gge(w0),{reconciler:CE,applyProps:hg}=ige(w0,cge),dg={objects:"shallow",strict:!1},vge=(t,e)=>{const i=typeof t=="function"?t(e):t;return aJ(i)?i:new NN({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...t})};function yge(t,e){if(e)return e;if(typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&t.parentElement){const{width:i,height:n,top:r,left:s}=t.parentElement.getBoundingClientRect();return{width:i,height:n,top:r,left:s}}else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height,top:0,left:0};return{width:0,height:0,top:0,left:0}}function xge(t){const e=w0.get(t),i=e==null?void 0:e.fiber,n=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=n||dge(dV,fV),o=i||CE.createContainer(s,mv.ConcurrentRoot,null,!1,null,"",r,null);e||w0.set(t,{fiber:o,store:s});let a,l=!1,c;return{configure(h={}){let{gl:u,size:d,scene:f,events:p,onCreated:m,shadows:v=!1,linear:g=!1,flat:y=!1,legacy:x=!1,orthographic:b=!1,frameloop:S="always",dpr:A=[1,2],performance:E,raycaster:M,camera:T,onPointerMissed:P}=h,R=s.getState(),U=R.gl;R.gl||R.set({gl:U=vge(u,t)});let F=R.raycaster;F||R.set({raycaster:F=new jK});const{params:N,...W}=M||{};if(ln.equ(W,F,dg)||hg(F,{...W}),ln.equ(N,F.params,dg)||hg(F,{params:{...F.params,...N}}),!R.camera||R.camera===c&&!ln.equ(c,T,dg)){c=T;const k=T instanceof dw,G=k?T:b?new Bl(0,0,0,0,.1,1e3):new fn(75,0,.1,1e3);k||(G.position.z=5,T&&hg(G,T),!R.camera&&!(T!=null&&T.rotation)&&G.lookAt(0,0,0)),R.set({camera:G})}if(!R.scene){let k;f instanceof TE?k=f:(k=new TE,f&&hg(k,f)),R.set({scene:Xg(k)})}if(!R.xr){const k=(K,re)=>{const J=s.getState();J.frameloop!=="never"&&fV(K,!0,J,re)},G=()=>{const K=s.getState();K.gl.xr.enabled=K.gl.xr.isPresenting,K.gl.xr.setAnimationLoop(K.gl.xr.isPresenting?k:null),K.gl.xr.isPresenting||dV(K)},Z={connect(){const K=s.getState().gl;K.xr.addEventListener("sessionstart",G),K.xr.addEventListener("sessionend",G)},disconnect(){const K=s.getState().gl;K.xr.removeEventListener("sessionstart",G),K.xr.removeEventListener("sessionend",G)}};U.xr&&Z.connect(),R.set({xr:Z})}if(U.shadowMap){const k=U.shadowMap.enabled,G=U.shadowMap.type;if(U.shadowMap.enabled=!!v,ln.boo(v))U.shadowMap.type=S1;else if(ln.str(v)){var Q;const Z={basic:KY,percentage:aC,soft:S1,variance:wl};U.shadowMap.type=(Q=Z[v])!=null?Q:S1}else ln.obj(v)&&Object.assign(U.shadowMap,v);(k!==U.shadowMap.enabled||G!==U.shadowMap.type)&&(U.shadowMap.needsUpdate=!0)}const X=$K();X&&("enabled"in X?X.enabled=!x:"legacyMode"in X&&(X.legacyMode=x)),hg(U,{outputEncoding:g?3e3:3001,toneMapping:y?Ll:gN}),R.legacy!==x&&R.set(()=>({legacy:x})),R.linear!==g&&R.set(()=>({linear:g})),R.flat!==y&&R.set(()=>({flat:y})),u&&!ln.fun(u)&&!aJ(u)&&!ln.equ(u,U,dg)&&hg(U,u),p&&!R.events.handlers&&R.set({events:p(s)});const z=yge(t,d);return ln.equ(z,R.size,dg)||R.setSize(z.width,z.height,z.updateStyle,z.top,z.left),A&&R.viewport.dpr!==rJ(A)&&R.setDpr(A),R.frameloop!==S&&R.setFrameloop(S),R.onPointerMissed||R.set({onPointerMissed:P}),E&&!ln.equ(E,R.performance,dg)&&R.set(k=>({performance:{...k.performance,...E}})),a=m,l=!0,this},render(h){return l||this.configure(),CE.updateContainer(ye.createElement(_ge,{store:s,children:h,onCreated:a,rootElement:t}),o,null,()=>{}),s},unmount(){dJ(t)}}}function _ge({store:t,children:e,onCreated:i,rootElement:n}){return ww(()=>{const r=t.getState();r.set(s=>({internal:{...s.internal,active:!0}})),i&&i(r),t.getState().events.connected||r.events.connect==null||r.events.connect(n)},[]),ye.createElement(lJ.Provider,{value:t},e)}function dJ(t,e){const i=w0.get(t),n=i==null?void 0:i.fiber;if(n){const r=i==null?void 0:i.store.getState();r&&(r.internal.active=!1),CE.updateContainer(null,n,null,()=>{r&&setTimeout(()=>{try{var s,o,a,l;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=r.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(l=r.gl)!=null&&l.xr&&r.xr.disconnect(),age(r),w0.delete(t),e&&e(t)}catch{}},500)})}}CE.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:ye.version});function b0(){return b0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},b0.apply(this,arguments)}function qL(t,e,i){var n,r,s,o,a;e==null&&(e=100);function l(){var h=Date.now()-o;h<e&&h>=0?n=setTimeout(l,e-h):(n=null,i||(a=t.apply(s,r),s=r=null))}var c=function(){s=this,r=arguments,o=Date.now();var h=i&&!n;return n||(n=setTimeout(l,e)),h&&(a=t.apply(s,r),s=r=null),a};return c.clear=function(){n&&(clearTimeout(n),n=null)},c.flush=function(){n&&(a=t.apply(s,r),s=r=null,clearTimeout(n),n=null)},c}qL.debounce=qL;var wge=qL;const pV=xF(wge);function bge(t){let{debounce:e,scroll:i,polyfill:n,offsetSize:r}=t===void 0?{debounce:0,scroll:!1,offsetSize:!1}:t;const s=n||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[o,a]=ye.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=ye.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o}),c=e?typeof e=="number"?e:e.scroll:null,h=e?typeof e=="number"?e:e.resize:null,u=ye.useRef(!1);ye.useEffect(()=>(u.current=!0,()=>void(u.current=!1)));const[d,f,p]=ye.useMemo(()=>{const y=()=>{if(!l.current.element)return;const{left:x,top:b,width:S,height:A,bottom:E,right:M,x:T,y:P}=l.current.element.getBoundingClientRect(),R={left:x,top:b,width:S,height:A,bottom:E,right:M,x:T,y:P};l.current.element instanceof HTMLElement&&r&&(R.height=l.current.element.offsetHeight,R.width=l.current.element.offsetWidth),Object.freeze(R),u.current&&!Ege(l.current.lastBounds,R)&&a(l.current.lastBounds=R)};return[y,h?pV(y,h):y,c?pV(y,c):y]},[a,r,c,h]);function m(){l.current.scrollContainers&&(l.current.scrollContainers.forEach(y=>y.removeEventListener("scroll",p,!0)),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null)}function v(){l.current.element&&(l.current.resizeObserver=new s(p),l.current.resizeObserver.observe(l.current.element),i&&l.current.scrollContainers&&l.current.scrollContainers.forEach(y=>y.addEventListener("scroll",p,{capture:!0,passive:!0})))}const g=y=>{!y||y===l.current.element||(m(),l.current.element=y,l.current.scrollContainers=fJ(y),v())};return Age(p,!!i),Sge(f),ye.useEffect(()=>{m(),v()},[i,p,f]),ye.useEffect(()=>m,[]),[g,o,d]}function Sge(t){ye.useEffect(()=>{const e=t;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[t])}function Age(t,e){ye.useEffect(()=>{if(e){const i=t;return window.addEventListener("scroll",i,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",i,!0)}},[t,e])}function fJ(t){const e=[];if(!t||t===document.body)return e;const{overflow:i,overflowX:n,overflowY:r}=window.getComputedStyle(t);return[i,n,r].some(s=>s==="auto"||s==="scroll")&&e.push(t),[...e,...fJ(t.parentElement)]}const Mge=["x","y","top","bottom","left","right","width","height"],Ege=(t,e)=>Mge.every(i=>t[i]===e[i]);var Tge=Object.defineProperty,Cge=Object.defineProperties,Pge=Object.getOwnPropertyDescriptors,mV=Object.getOwnPropertySymbols,Dge=Object.prototype.hasOwnProperty,Rge=Object.prototype.propertyIsEnumerable,gV=(t,e,i)=>e in t?Tge(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,vV=(t,e)=>{for(var i in e||(e={}))Dge.call(e,i)&&gV(t,i,e[i]);if(mV)for(var i of mV(e))Rge.call(e,i)&&gV(t,i,e[i]);return t},Ige=(t,e)=>Cge(t,Pge(e));function pJ(t,e,i){if(!t)return;if(i(t)===!0)return t;let n=e?t.return:t.child;for(;n;){const r=pJ(n,e,i);if(r)return r;n=e?null:n.sibling}}function mJ(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const hU=mJ(ye.createContext(null));class gJ extends ye.Component{render(){return ye.createElement(hU.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:yV,ReactCurrentDispatcher:xV}=ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function Lge(){const t=ye.useContext(hU);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=ye.useId();return ye.useMemo(()=>{for(const n of[yV==null?void 0:yV.current,t,t==null?void 0:t.alternate]){if(!n)continue;const r=pJ(n,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(r)return r}},[t,e])}function Bge(){var t,e;const i=Lge(),[n]=ye.useState(()=>new Map);n.clear();let r=i;for(;r;){const s=(t=r.type)==null?void 0:t._context;s&&s!==hU&&!n.has(s)&&n.set(s,(e=xV==null?void 0:xV.current)==null?void 0:e.readContext(mJ(s))),r=r.return}return n}function Oge(){const t=Bge();return ye.useMemo(()=>Array.from(t.keys()).reduce((e,i)=>n=>ye.createElement(e,null,ye.createElement(i.Provider,Ige(vV({},n),{value:t.get(i)}))),e=>ye.createElement(gJ,vV({},e))),[t])}const GD={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Fge(t){const{handlePointer:e}=hge(t);return{priority:1,enabled:!0,compute(i,n,r){n.pointer.set(i.offsetX/n.size.width*2-1,-(i.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(GD).reduce((i,n)=>({...i,[n]:e(n)}),{}),update:()=>{var i;const{events:n,internal:r}=t.getState();(i=r.lastEvent)!=null&&i.current&&n.handlers&&n.handlers.onPointerMove(r.lastEvent.current)},connect:i=>{var n;const{set:r,events:s}=t.getState();s.disconnect==null||s.disconnect(),r(o=>({events:{...o.events,connected:i}})),Object.entries((n=s.handlers)!=null?n:[]).forEach(([o,a])=>{const[l,c]=GD[o];i.addEventListener(l,a,{passive:c})})},disconnect:()=>{const{set:i,events:n}=t.getState();if(n.connected){var r;Object.entries((r=n.handlers)!=null?r:[]).forEach(([s,o])=>{if(n&&n.connected instanceof HTMLElement){const[a]=GD[s];n.connected.removeEventListener(a,o)}}),i(s=>({events:{...s.events,connected:void 0}}))}}}}const Nge=ye.forwardRef(function({children:e,fallback:i,resize:n,style:r,gl:s,events:o=Fge,eventSource:a,eventPrefix:l,shadows:c,linear:h,flat:u,legacy:d,orthographic:f,frameloop:p,dpr:m,performance:v,raycaster:g,camera:y,onPointerMissed:x,onCreated:b,...S},A){ye.useMemo(()=>tge(Vme),[]);const E=Oge(),[M,T]=bge({scroll:!0,debounce:{scroll:50,resize:0},...n}),P=ye.useRef(null),R=ye.useRef(null);ye.useImperativeHandle(A,()=>P.current);const U=tJ(x),[F,N]=ye.useState(!1),[W,Q]=ye.useState(!1);if(F)throw F;if(W)throw W;const X=ye.useRef(null);ww(()=>{const j=P.current;T.width>0&&T.height>0&&j&&(X.current||(X.current=xge(j)),X.current.configure({gl:s,events:o,shadows:c,linear:h,flat:u,legacy:d,orthographic:f,frameloop:p,dpr:m,performance:v,raycaster:g,camera:y,size:T,onPointerMissed:(...z)=>U.current==null?void 0:U.current(...z),onCreated:z=>{z.events.connect==null||z.events.connect(a?nge(a)?a.current:a:R.current),l&&z.setEvents({compute:(k,G)=>{const Z=k[l+"X"],K=k[l+"Y"];G.pointer.set(Z/G.size.width*2-1,-(K/G.size.height)*2+1),G.raycaster.setFromCamera(G.pointer,G.camera)}}),b==null||b(z)}}),X.current.render(ye.createElement(E,null,ye.createElement(iJ,{set:Q},ye.createElement(ye.Suspense,{fallback:ye.createElement(rge,{set:N})},e)))))}),ye.useEffect(()=>{const j=P.current;if(j)return()=>dJ(j)},[]);const B=a?"none":"auto";return ye.createElement("div",b0({ref:R,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:B,...r}},S),ye.createElement("div",{ref:M,style:{width:"100%",height:"100%"}},ye.createElement("canvas",{ref:P,style:{display:"block"}},i)))}),Uge=ye.forwardRef(function(e,i){return ye.createElement(gJ,null,ye.createElement(Nge,b0({},e,{ref:i})))}),Sw=new te,dU=new te,kge=new te;function zge(t,e,i){const n=Sw.setFromMatrixPosition(t.matrixWorld);n.project(e);const r=i.width/2,s=i.height/2;return[n.x*r+r,-(n.y*s)+s]}function Gge(t,e){const i=Sw.setFromMatrixPosition(t.matrixWorld),n=dU.setFromMatrixPosition(e.matrixWorld),r=i.sub(n),s=e.getWorldDirection(kge);return r.angleTo(s)>Math.PI/2}function Hge(t,e,i,n){const r=Sw.setFromMatrixPosition(t.matrixWorld),s=r.clone();s.project(e),i.setFromCamera(s,e);const o=i.intersectObjects(n,!0);if(o.length){const a=o[0].distance;return r.distanceTo(i.ray.origin)<a}return!0}function Vge(t,e){if(e instanceof Bl)return e.zoom;if(e instanceof fn){const i=Sw.setFromMatrixPosition(t.matrixWorld),n=dU.setFromMatrixPosition(e.matrixWorld),r=e.fov*Math.PI/180,s=i.distanceTo(n);return 1/(2*Math.tan(r/2)*s)}else return 1}function jge(t,e,i){if(e instanceof fn||e instanceof Bl){const n=Sw.setFromMatrixPosition(t.matrixWorld),r=dU.setFromMatrixPosition(e.matrixWorld),s=n.distanceTo(r),o=(i[1]-i[0])/(e.far-e.near),a=i[1]-o*e.far;return Math.round(o*s+a)}}const YL=t=>Math.abs(t)<1e-10?0:t;function vJ(t,e,i=""){let n="matrix3d(";for(let r=0;r!==16;r++)n+=YL(e[r]*t.elements[r])+(r!==15?",":")");return i+n}const Wge=(t=>e=>vJ(e,t))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),Xge=(t=>(e,i)=>vJ(e,t(i),"translate(-50%,-50%)"))(t=>[1/t,1/t,1/t,1,-1/t,-1/t,-1/t,-1,1/t,1/t,1/t,1,1,1,1,1]);function qge(t){return t&&typeof t=="object"&&"current"in t}const Yge=ye.forwardRef(({children:t,eps:e=.001,style:i,className:n,prepend:r,center:s,fullscreen:o,portal:a,distanceFactor:l,sprite:c=!1,transform:h=!1,occlude:u,onOcclude:d,castShadow:f,receiveShadow:p,material:m,geometry:v,zIndexRange:g=[16777271,0],calculatePosition:y=zge,as:x="div",wrapperClass:b,pointerEvents:S="auto",...A},E)=>{const{gl:M,camera:T,scene:P,size:R,raycaster:U,events:F,viewport:N}=Ia(),[W]=ye.useState(()=>document.createElement(x)),Q=ye.useRef(),X=ye.useRef(null),B=ye.useRef(0),j=ye.useRef([0,0]),z=ye.useRef(null),k=ye.useRef(null),G=(a==null?void 0:a.current)||F.connected||M.domElement.parentNode,Z=ye.useRef(null),K=ye.useRef(!1),re=ye.useMemo(()=>u&&u!=="blending"||Array.isArray(u)&&u.length&&qge(u[0]),[u]);ye.useLayoutEffect(()=>{const ge=M.domElement;u&&u==="blending"?(ge.style.zIndex=`${Math.floor(g[0]/2)}`,ge.style.position="absolute",ge.style.pointerEvents="none"):(ge.style.zIndex=null,ge.style.position=null,ge.style.pointerEvents=null)},[u]),ye.useLayoutEffect(()=>{if(X.current){const ge=Q.current=HY(W);if(P.updateMatrixWorld(),h)W.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const ve=y(X.current,T,R);W.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${ve[0]}px,${ve[1]}px,0);transform-origin:0 0;`}return G&&(r?G.prepend(W):G.appendChild(W)),()=>{G&&G.removeChild(W),ge.unmount()}}},[G,h]),ye.useLayoutEffect(()=>{b&&(W.className=b)},[b]);const J=ye.useMemo(()=>h?{position:"absolute",top:0,left:0,width:R.width,height:R.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...o&&{top:-R.height/2,left:-R.width/2,width:R.width,height:R.height},...i},[i,s,o,R,h]),le=ye.useMemo(()=>({position:"absolute",pointerEvents:S}),[S]);ye.useLayoutEffect(()=>{if(K.current=!1,h){var ge;(ge=Q.current)==null||ge.render(ye.createElement("div",{ref:z,style:J},ye.createElement("div",{ref:k,style:le},ye.createElement("div",{ref:E,className:n,style:i,children:t}))))}else{var ve;(ve=Q.current)==null||ve.render(ye.createElement("div",{ref:E,style:J,className:n,children:t}))}});const ae=ye.useRef(!0);uJ(ge=>{if(X.current){T.updateMatrixWorld(),X.current.updateWorldMatrix(!0,!1);const ve=h?j.current:y(X.current,T,R);if(h||Math.abs(B.current-T.zoom)>e||Math.abs(j.current[0]-ve[0])>e||Math.abs(j.current[1]-ve[1])>e){const Y=Gge(X.current,T);let ce=!1;re&&(u!=="blending"?ce=[P]:Array.isArray(u)&&(ce=u.map(Ne=>Ne.current)));const de=ae.current;if(ce){const Ne=Hge(X.current,T,U,ce);ae.current=Ne&&!Y}else ae.current=!Y;de!==ae.current&&(d?d(!ae.current):W.style.display=ae.current?"block":"none");const xe=Math.floor(g[0]/2),Ce=u?re?[g[0],xe]:[xe-1,0]:g;if(W.style.zIndex=`${jge(X.current,T,Ce)}`,h){const[Ne,Ie]=[R.width/2,R.height/2],Ge=T.projectionMatrix.elements[5]*Ie,{isOrthographicCamera:tt,top:at,left:ee,bottom:O,right:V}=T,ue=Wge(T.matrixWorldInverse),Ee=tt?`scale(${Ge})translate(${YL(-(V+ee)/2)}px,${YL((at+O)/2)}px)`:`translateZ(${Ge}px)`;let Te=X.current.matrixWorld;c&&(Te=T.matrixWorldInverse.clone().transpose().copyPosition(Te).scale(X.current.scale),Te.elements[3]=Te.elements[7]=Te.elements[11]=0,Te.elements[15]=1),W.style.width=R.width+"px",W.style.height=R.height+"px",W.style.perspective=tt?"":`${Ge}px`,z.current&&k.current&&(z.current.style.transform=`${Ee}${ue}translate(${Ne}px,${Ie}px)`,k.current.style.transform=Xge(Te,1/((l||10)/400)))}else{const Ne=l===void 0?1:Vge(X.current,T)*l;W.style.transform=`translate3d(${ve[0]}px,${ve[1]}px,0) scale(${Ne})`}j.current=ve,B.current=T.zoom}}if(!re&&Z.current&&!K.current)if(h){if(z.current){const ve=z.current.children[0];if(ve!=null&&ve.clientWidth&&ve!=null&&ve.clientHeight){const{isOrthographicCamera:Y}=T;if(Y||v)A.scale&&(Array.isArray(A.scale)?A.scale instanceof te?Z.current.scale.copy(A.scale.clone().divideScalar(1)):Z.current.scale.set(1/A.scale[0],1/A.scale[1],1/A.scale[2]):Z.current.scale.setScalar(1/A.scale));else{const ce=(l||10)/400,de=ve.clientWidth*ce,xe=ve.clientHeight*ce;Z.current.scale.set(de,xe,1)}K.current=!0}}}else{const ve=W.children[0];if(ve!=null&&ve.clientWidth&&ve!=null&&ve.clientHeight){const Y=1/N.factor,ce=ve.clientWidth*Y,de=ve.clientHeight*Y;Z.current.scale.set(ce,de,1),K.current=!0}Z.current.lookAt(ge.camera.position)}});const fe=ye.useMemo(()=>({vertexShader:h?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom" 
            is false. 
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;
            
            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[h]);return ye.createElement("group",b0({},A,{ref:X}),u&&!re&&ye.createElement("mesh",{castShadow:f,receiveShadow:p,ref:Z},v||ye.createElement("planeGeometry",null),m||ye.createElement("shaderMaterial",{side:ka,vertexShader:fe.vertexShader,fragmentShader:fe.fragmentShader})))});let ux=0;const Qge=qK(t=>(pv.onStart=(e,i,n)=>{t({active:!0,item:e,loaded:i,total:n,progress:(i-ux)/(n-ux)*100})},pv.onLoad=()=>{t({active:!1})},pv.onError=e=>t(i=>({errors:[...i.errors,e]})),pv.onProgress=(e,i,n)=>{i===n&&(ux=n),t({active:!0,item:e,loaded:i,total:n,progress:(i-ux)/(n-ux)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0}));function _V(t,e){if(e===BQ)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),t;if(e===AE||e===AN){let i=t.getIndex();if(i===null){const o=[],a=t.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);t.setIndex(o),i=t.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t}const n=i.count-2,r=[];if(i)if(e===AE)for(let o=1;o<=n;o++)r.push(i.getX(0)),r.push(i.getX(o)),r.push(i.getX(o+1));else for(let o=0;o<n;o++)o%2===0?(r.push(i.getX(o)),r.push(i.getX(o+1)),r.push(i.getX(o+2))):(r.push(i.getX(o+2)),r.push(i.getX(o+1)),r.push(i.getX(o)));r.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=t.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),t}var Kge=Object.defineProperty,Jge=(t,e,i)=>e in t?Kge(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,ii=(t,e,i)=>(Jge(t,typeof e!="symbol"?e+"":e,i),i);const wV=(t,e)=>(t%e+e)%e;let Zge=class extends $c{constructor(e,i){super(),ii(this,"object"),ii(this,"domElement"),ii(this,"enabled",!0),ii(this,"target",new te),ii(this,"minDistance",0),ii(this,"maxDistance",1/0),ii(this,"minZoom",0),ii(this,"maxZoom",1/0),ii(this,"minPolarAngle",0),ii(this,"maxPolarAngle",Math.PI),ii(this,"minAzimuthAngle",-1/0),ii(this,"maxAzimuthAngle",1/0),ii(this,"enableDamping",!1),ii(this,"dampingFactor",.05),ii(this,"enableZoom",!0),ii(this,"zoomSpeed",1),ii(this,"enableRotate",!0),ii(this,"rotateSpeed",1),ii(this,"enablePan",!0),ii(this,"panSpeed",1),ii(this,"screenSpacePanning",!0),ii(this,"keyPanSpeed",7),ii(this,"autoRotate",!1),ii(this,"autoRotateSpeed",2),ii(this,"reverseOrbit",!1),ii(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),ii(this,"mouseButtons",{LEFT:Qf.ROTATE,MIDDLE:Qf.DOLLY,RIGHT:Qf.PAN}),ii(this,"touches",{ONE:Kf.ROTATE,TWO:Kf.DOLLY_PAN}),ii(this,"target0"),ii(this,"position0"),ii(this,"zoom0"),ii(this,"_domElementKeyEvents",null),ii(this,"getPolarAngle"),ii(this,"getAzimuthalAngle"),ii(this,"setPolarAngle"),ii(this,"setAzimuthalAngle"),ii(this,"getDistance"),ii(this,"listenToKeyEvents"),ii(this,"saveState"),ii(this,"reset"),ii(this,"update"),ii(this,"connect"),ii(this,"dispose"),this.object=e,this.domElement=i,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>h.phi,this.getAzimuthalAngle=()=>h.theta,this.setPolarAngle=ne=>{let Ae=wV(ne,2*Math.PI),ke=h.phi;ke<0&&(ke+=2*Math.PI),Ae<0&&(Ae+=2*Math.PI);let Ue=Math.abs(Ae-ke);2*Math.PI-Ue<Ue&&(Ae<ke?Ae+=2*Math.PI:ke+=2*Math.PI),u.phi=Ae-ke,n.update()},this.setAzimuthalAngle=ne=>{let Ae=wV(ne,2*Math.PI),ke=h.theta;ke<0&&(ke+=2*Math.PI),Ae<0&&(Ae+=2*Math.PI);let Ue=Math.abs(Ae-ke);2*Math.PI-Ue<Ue&&(Ae<ke?Ae+=2*Math.PI:ke+=2*Math.PI),u.theta=Ae-ke,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=ne=>{ne.addEventListener("keydown",V),this._domElementKeyEvents=ne},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(r),n.update(),l=a.NONE},this.update=(()=>{const ne=new te,Ae=new Gr().setFromUnitVectors(e.up,new te(0,1,0)),ke=Ae.clone().invert(),Ue=new te,Je=new Gr,ut=2*Math.PI;return function(){const q=n.object.position;ne.copy(q).sub(n.target),ne.applyQuaternion(Ae),h.setFromVector3(ne),n.autoRotate&&l===a.NONE&&U(P()),n.enableDamping?(h.theta+=u.theta*n.dampingFactor,h.phi+=u.phi*n.dampingFactor):(h.theta+=u.theta,h.phi+=u.phi);let pe=n.minAzimuthAngle,oe=n.maxAzimuthAngle;return isFinite(pe)&&isFinite(oe)&&(pe<-Math.PI?pe+=ut:pe>Math.PI&&(pe-=ut),oe<-Math.PI?oe+=ut:oe>Math.PI&&(oe-=ut),pe<=oe?h.theta=Math.max(pe,Math.min(oe,h.theta)):h.theta=h.theta>(pe+oe)/2?Math.max(pe,h.theta):Math.min(oe,h.theta)),h.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,h.phi)),h.makeSafe(),h.radius*=d,h.radius=Math.max(n.minDistance,Math.min(n.maxDistance,h.radius)),n.enableDamping===!0?n.target.addScaledVector(f,n.dampingFactor):n.target.add(f),ne.setFromSpherical(h),ne.applyQuaternion(ke),q.copy(n.target).add(ne),n.object.lookAt(n.target),n.enableDamping===!0?(u.theta*=1-n.dampingFactor,u.phi*=1-n.dampingFactor,f.multiplyScalar(1-n.dampingFactor)):(u.set(0,0,0),f.set(0,0,0)),d=1,p||Ue.distanceToSquared(n.object.position)>c||8*(1-Je.dot(n.object.quaternion))>c?(n.dispatchEvent(r),Ue.copy(n.object.position),Je.copy(n.object.quaternion),p=!1,!0):!1}})(),this.connect=ne=>{ne===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),n.domElement=ne,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",Te),n.domElement.addEventListener("pointerdown",Ne),n.domElement.addEventListener("pointercancel",tt),n.domElement.addEventListener("wheel",O)},this.dispose=()=>{var ne,Ae,ke,Ue,Je,ut;(ne=n.domElement)==null||ne.removeEventListener("contextmenu",Te),(Ae=n.domElement)==null||Ae.removeEventListener("pointerdown",Ne),(ke=n.domElement)==null||ke.removeEventListener("pointercancel",tt),(Ue=n.domElement)==null||Ue.removeEventListener("wheel",O),(Je=n.domElement)==null||Je.ownerDocument.removeEventListener("pointermove",Ie),(ut=n.domElement)==null||ut.ownerDocument.removeEventListener("pointerup",Ge),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",V)};const n=this,r={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const c=1e-6,h=new jL,u=new jL;let d=1;const f=new te;let p=!1;const m=new Qe,v=new Qe,g=new Qe,y=new Qe,x=new Qe,b=new Qe,S=new Qe,A=new Qe,E=new Qe,M=[],T={};function P(){return 2*Math.PI/60/60*n.autoRotateSpeed}function R(){return Math.pow(.95,n.zoomSpeed)}function U(ne){n.reverseOrbit?u.theta+=ne:u.theta-=ne}function F(ne){n.reverseOrbit?u.phi+=ne:u.phi-=ne}const N=(()=>{const ne=new te;return function(ke,Ue){ne.setFromMatrixColumn(Ue,0),ne.multiplyScalar(-ke),f.add(ne)}})(),W=(()=>{const ne=new te;return function(ke,Ue){n.screenSpacePanning===!0?ne.setFromMatrixColumn(Ue,1):(ne.setFromMatrixColumn(Ue,0),ne.crossVectors(n.object.up,ne)),ne.multiplyScalar(ke),f.add(ne)}})(),Q=(()=>{const ne=new te;return function(ke,Ue){const Je=n.domElement;if(Je&&n.object instanceof fn&&n.object.isPerspectiveCamera){const ut=n.object.position;ne.copy(ut).sub(n.target);let Pt=ne.length();Pt*=Math.tan(n.object.fov/2*Math.PI/180),N(2*ke*Pt/Je.clientHeight,n.object.matrix),W(2*Ue*Pt/Je.clientHeight,n.object.matrix)}else Je&&n.object instanceof Bl&&n.object.isOrthographicCamera?(N(ke*(n.object.right-n.object.left)/n.object.zoom/Je.clientWidth,n.object.matrix),W(Ue*(n.object.top-n.object.bottom)/n.object.zoom/Je.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function X(ne){n.object instanceof fn&&n.object.isPerspectiveCamera?d/=ne:n.object instanceof Bl&&n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*ne)),n.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function B(ne){n.object instanceof fn&&n.object.isPerspectiveCamera?d*=ne:n.object instanceof Bl&&n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/ne)),n.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function j(ne){m.set(ne.clientX,ne.clientY)}function z(ne){S.set(ne.clientX,ne.clientY)}function k(ne){y.set(ne.clientX,ne.clientY)}function G(ne){v.set(ne.clientX,ne.clientY),g.subVectors(v,m).multiplyScalar(n.rotateSpeed);const Ae=n.domElement;Ae&&(U(2*Math.PI*g.x/Ae.clientHeight),F(2*Math.PI*g.y/Ae.clientHeight)),m.copy(v),n.update()}function Z(ne){A.set(ne.clientX,ne.clientY),E.subVectors(A,S),E.y>0?X(R()):E.y<0&&B(R()),S.copy(A),n.update()}function K(ne){x.set(ne.clientX,ne.clientY),b.subVectors(x,y).multiplyScalar(n.panSpeed),Q(b.x,b.y),y.copy(x),n.update()}function re(ne){ne.deltaY<0?B(R()):ne.deltaY>0&&X(R()),n.update()}function J(ne){let Ae=!1;switch(ne.code){case n.keys.UP:Q(0,n.keyPanSpeed),Ae=!0;break;case n.keys.BOTTOM:Q(0,-n.keyPanSpeed),Ae=!0;break;case n.keys.LEFT:Q(n.keyPanSpeed,0),Ae=!0;break;case n.keys.RIGHT:Q(-n.keyPanSpeed,0),Ae=!0;break}Ae&&(ne.preventDefault(),n.update())}function le(){if(M.length==1)m.set(M[0].pageX,M[0].pageY);else{const ne=.5*(M[0].pageX+M[1].pageX),Ae=.5*(M[0].pageY+M[1].pageY);m.set(ne,Ae)}}function ae(){if(M.length==1)y.set(M[0].pageX,M[0].pageY);else{const ne=.5*(M[0].pageX+M[1].pageX),Ae=.5*(M[0].pageY+M[1].pageY);y.set(ne,Ae)}}function fe(){const ne=M[0].pageX-M[1].pageX,Ae=M[0].pageY-M[1].pageY,ke=Math.sqrt(ne*ne+Ae*Ae);S.set(0,ke)}function ge(){n.enableZoom&&fe(),n.enablePan&&ae()}function ve(){n.enableZoom&&fe(),n.enableRotate&&le()}function Y(ne){if(M.length==1)v.set(ne.pageX,ne.pageY);else{const ke=be(ne),Ue=.5*(ne.pageX+ke.x),Je=.5*(ne.pageY+ke.y);v.set(Ue,Je)}g.subVectors(v,m).multiplyScalar(n.rotateSpeed);const Ae=n.domElement;Ae&&(U(2*Math.PI*g.x/Ae.clientHeight),F(2*Math.PI*g.y/Ae.clientHeight)),m.copy(v)}function ce(ne){if(M.length==1)x.set(ne.pageX,ne.pageY);else{const Ae=be(ne),ke=.5*(ne.pageX+Ae.x),Ue=.5*(ne.pageY+Ae.y);x.set(ke,Ue)}b.subVectors(x,y).multiplyScalar(n.panSpeed),Q(b.x,b.y),y.copy(x)}function de(ne){const Ae=be(ne),ke=ne.pageX-Ae.x,Ue=ne.pageY-Ae.y,Je=Math.sqrt(ke*ke+Ue*Ue);A.set(0,Je),E.set(0,Math.pow(A.y/S.y,n.zoomSpeed)),X(E.y),S.copy(A)}function xe(ne){n.enableZoom&&de(ne),n.enablePan&&ce(ne)}function Ce(ne){n.enableZoom&&de(ne),n.enableRotate&&Y(ne)}function Ne(ne){var Ae,ke;n.enabled!==!1&&(M.length===0&&((Ae=n.domElement)==null||Ae.ownerDocument.addEventListener("pointermove",Ie),(ke=n.domElement)==null||ke.ownerDocument.addEventListener("pointerup",Ge)),We(ne),ne.pointerType==="touch"?ue(ne):at(ne))}function Ie(ne){n.enabled!==!1&&(ne.pointerType==="touch"?Ee(ne):ee(ne))}function Ge(ne){var Ae,ke,Ue;Ve(ne),M.length===0&&((Ae=n.domElement)==null||Ae.releasePointerCapture(ne.pointerId),(ke=n.domElement)==null||ke.ownerDocument.removeEventListener("pointermove",Ie),(Ue=n.domElement)==null||Ue.ownerDocument.removeEventListener("pointerup",Ge)),n.dispatchEvent(o),l=a.NONE}function tt(ne){Ve(ne)}function at(ne){let Ae;switch(ne.button){case 0:Ae=n.mouseButtons.LEFT;break;case 1:Ae=n.mouseButtons.MIDDLE;break;case 2:Ae=n.mouseButtons.RIGHT;break;default:Ae=-1}switch(Ae){case Qf.DOLLY:if(n.enableZoom===!1)return;z(ne),l=a.DOLLY;break;case Qf.ROTATE:if(ne.ctrlKey||ne.metaKey||ne.shiftKey){if(n.enablePan===!1)return;k(ne),l=a.PAN}else{if(n.enableRotate===!1)return;j(ne),l=a.ROTATE}break;case Qf.PAN:if(ne.ctrlKey||ne.metaKey||ne.shiftKey){if(n.enableRotate===!1)return;j(ne),l=a.ROTATE}else{if(n.enablePan===!1)return;k(ne),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&n.dispatchEvent(s)}function ee(ne){if(n.enabled!==!1)switch(l){case a.ROTATE:if(n.enableRotate===!1)return;G(ne);break;case a.DOLLY:if(n.enableZoom===!1)return;Z(ne);break;case a.PAN:if(n.enablePan===!1)return;K(ne);break}}function O(ne){n.enabled===!1||n.enableZoom===!1||l!==a.NONE&&l!==a.ROTATE||(ne.preventDefault(),n.dispatchEvent(s),re(ne),n.dispatchEvent(o))}function V(ne){n.enabled===!1||n.enablePan===!1||J(ne)}function ue(ne){switch(me(ne),M.length){case 1:switch(n.touches.ONE){case Kf.ROTATE:if(n.enableRotate===!1)return;le(),l=a.TOUCH_ROTATE;break;case Kf.PAN:if(n.enablePan===!1)return;ae(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(n.touches.TWO){case Kf.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;ge(),l=a.TOUCH_DOLLY_PAN;break;case Kf.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;ve(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&n.dispatchEvent(s)}function Ee(ne){switch(me(ne),l){case a.TOUCH_ROTATE:if(n.enableRotate===!1)return;Y(ne),n.update();break;case a.TOUCH_PAN:if(n.enablePan===!1)return;ce(ne),n.update();break;case a.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;xe(ne),n.update();break;case a.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Ce(ne),n.update();break;default:l=a.NONE}}function Te(ne){n.enabled!==!1&&ne.preventDefault()}function We(ne){M.push(ne)}function Ve(ne){delete T[ne.pointerId];for(let Ae=0;Ae<M.length;Ae++)if(M[Ae].pointerId==ne.pointerId){M.splice(Ae,1);return}}function me(ne){let Ae=T[ne.pointerId];Ae===void 0&&(Ae=new Qe,T[ne.pointerId]=Ae),Ae.set(ne.pageX,ne.pageY)}function be(ne){const Ae=ne.pointerId===M[0].pointerId?M[1]:M[0];return T[Ae.pointerId]}i!==void 0&&this.connect(i),this.update()}};class fU extends Es{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(i){return new nve(i)}),this.register(function(i){return new hve(i)}),this.register(function(i){return new dve(i)}),this.register(function(i){return new fve(i)}),this.register(function(i){return new sve(i)}),this.register(function(i){return new ove(i)}),this.register(function(i){return new ave(i)}),this.register(function(i){return new lve(i)}),this.register(function(i){return new ive(i)}),this.register(function(i){return new cve(i)}),this.register(function(i){return new rve(i)}),this.register(function(i){return new uve(i)}),this.register(function(i){return new eve(i)}),this.register(function(i){return new pve(i)}),this.register(function(i){return new mve(i)})}load(e,i,n,r){const s=this;let o;this.resourcePath!==""?o=this.resourcePath:this.path!==""?o=this.path:o=kc.extractUrlBase(e),this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new ia(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(h){i(h),s.manager.itemEnd(e)},a)}catch(h){a(h)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,i,n,r){let s;const o={},a={};if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(kc.decodeText(new Uint8Array(e.slice(0,4)))===yJ){try{o[_i.KHR_BINARY_GLTF]=new gve(e)}catch(h){r&&r(h);return}s=JSON.parse(o[_i.KHR_BINARY_GLTF].content)}else s=JSON.parse(kc.decodeText(new Uint8Array(e)));else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const l=new Pve(s,{path:i||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const h=this.pluginCallbacks[c](l);a[h.name]=h,o[h.name]=!0}if(s.extensionsUsed)for(let c=0;c<s.extensionsUsed.length;++c){const h=s.extensionsUsed[c],u=s.extensionsRequired||[];switch(h){case _i.KHR_MATERIALS_UNLIT:o[h]=new tve;break;case _i.KHR_DRACO_MESH_COMPRESSION:o[h]=new vve(s,this.dracoLoader);break;case _i.KHR_TEXTURE_TRANSFORM:o[h]=new yve;break;case _i.KHR_MESH_QUANTIZATION:o[h]=new xve;break;default:u.indexOf(h)>=0&&a[h]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}l.setExtensions(o),l.setPlugins(a),l.parse(n,r)}parseAsync(e,i){const n=this;return new Promise(function(r,s){n.parse(e,i,r,s)})}}function $ge(){let t={};return{get:function(e){return t[e]},add:function(e,i){t[e]=i},remove:function(e){delete t[e]},removeAll:function(){t={}}}}const _i={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class eve{constructor(e){this.parser=e,this.name=_i.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,i=this.parser.json.nodes||[];for(let n=0,r=i.length;n<r;n++){const s=i[n];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const i=this.parser,n="light:"+e;let r=i.cache.get(n);if(r)return r;const s=i.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const h=new ht(16777215);l.color!==void 0&&h.fromArray(l.color);const u=l.range!==void 0?l.range:0;switch(l.type){case"directional":c=new rU(h),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new nU(h),c.distance=u;break;case"spot":c=new iU(h),c.distance=u,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,td(c,l),l.intensity!==void 0&&(c.intensity=l.intensity),c.name=i.createUniqueName(l.name||"light_"+e),r=Promise.resolve(c),i.cache.add(n,r),r}getDependency(e,i){if(e==="light")return this._loadLight(i)}createNodeAttachment(e){const i=this,n=this.parser,s=n.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return n._getNodeRef(i.cache,a,l)})}}class tve{constructor(){this.name=_i.KHR_MATERIALS_UNLIT}getMaterialType(){return jo}extendParams(e,i,n){const r=[];e.color=new ht(1,1,1),e.opacity=1;const s=i.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}s.baseColorTexture!==void 0&&r.push(n.assignTexture(e,"map",s.baseColorTexture,3001))}return Promise.all(r)}}class ive{constructor(e){this.parser=e,this.name=_i.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,i){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return s!==void 0&&(i.emissiveIntensity=s),Promise.resolve()}}class nve{constructor(e){this.parser=e,this.name=_i.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:eu}extendMaterialParams(e,i){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(o.clearcoatFactor!==void 0&&(i.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(n.assignTexture(i,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(i.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(n.assignTexture(i,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(n.assignTexture(i,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;i.clearcoatNormalScale=new Qe(a,a)}return Promise.all(s)}}class rve{constructor(e){this.parser=e,this.name=_i.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:eu}extendMaterialParams(e,i){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.iridescenceFactor!==void 0&&(i.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(n.assignTexture(i,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(i.iridescenceIOR=o.iridescenceIor),i.iridescenceThicknessRange===void 0&&(i.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(i.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(i.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(n.assignTexture(i,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class sve{constructor(e){this.parser=e,this.name=_i.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:eu}extendMaterialParams(e,i){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];i.sheenColor=new ht(0,0,0),i.sheenRoughness=0,i.sheen=1;const o=r.extensions[this.name];return o.sheenColorFactor!==void 0&&i.sheenColor.fromArray(o.sheenColorFactor),o.sheenRoughnessFactor!==void 0&&(i.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(n.assignTexture(i,"sheenColorMap",o.sheenColorTexture,3001)),o.sheenRoughnessTexture!==void 0&&s.push(n.assignTexture(i,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class ove{constructor(e){this.parser=e,this.name=_i.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:eu}extendMaterialParams(e,i){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.transmissionFactor!==void 0&&(i.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(n.assignTexture(i,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class ave{constructor(e){this.parser=e,this.name=_i.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:eu}extendMaterialParams(e,i){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];i.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(n.assignTexture(i,"thicknessMap",o.thicknessTexture)),i.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return i.attenuationColor=new ht(a[0],a[1],a[2]),Promise.all(s)}}class lve{constructor(e){this.parser=e,this.name=_i.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:eu}extendMaterialParams(e,i){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return i.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class cve{constructor(e){this.parser=e,this.name=_i.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:eu}extendMaterialParams(e,i){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];i.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(n.assignTexture(i,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return i.specularColor=new ht(a[0],a[1],a[2]),o.specularColorTexture!==void 0&&s.push(n.assignTexture(i,"specularColorMap",o.specularColorTexture,3001)),Promise.all(s)}}class uve{constructor(e){this.parser=e,this.name=_i.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:eu}extendMaterialParams(e,i){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.anisotropyStrength!==void 0&&(i.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(i.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(n.assignTexture(i,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class hve{constructor(e){this.parser=e,this.name=_i.KHR_TEXTURE_BASISU}loadTexture(e){const i=this.parser,n=i.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=i.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return i.loadTextureImage(e,s.source,o)}}class dve{constructor(e){this.parser=e,this.name=_i.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const i=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[i])return null;const o=s.extensions[i],a=r.images[o.source];let l=n.textureLoader;if(a.uri){const c=n.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(i)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const i=new Image;i.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",i.onload=i.onerror=function(){e(i.height===1)}})),this.isSupported}}class fve{constructor(e){this.parser=e,this.name=_i.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const i=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[i])return null;const o=s.extensions[i],a=r.images[o.source];let l=n.textureLoader;if(a.uri){const c=n.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(i)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const i=new Image;i.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",i.onload=i.onerror=function(){e(i.height===1)}})),this.isSupported}}class pve{constructor(e){this.name=_i.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const i=this.parser.json,n=i.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const r=n.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const l=r.byteOffset||0,c=r.byteLength||0,h=r.count,u=r.byteStride,d=new Uint8Array(a,l,c);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(h,u,d,r.mode,r.filter).then(function(f){return f.buffer}):o.ready.then(function(){const f=new ArrayBuffer(h*u);return o.decodeGltfBuffer(new Uint8Array(f),h,u,d,r.mode,r.filter),f})})}else return null}}class mve{constructor(e){this.name=_i.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const i=this.parser.json,n=i.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const r=i.meshes[n.mesh];for(const c of r.primitives)if(c.mode!==Ca.TRIANGLES&&c.mode!==Ca.TRIANGLE_STRIP&&c.mode!==Ca.TRIANGLE_FAN&&c.mode!==void 0)return null;const o=n.extensions[this.name].attributes,a=[],l={};for(const c in o)a.push(this.parser.getDependency("accessor",o[c]).then(h=>(l[c]=h,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const h=c.pop(),u=h.isGroup?h.children:[h],d=c[0].count,f=[];for(const p of u){const m=new Wt,v=new te,g=new Gr,y=new te(1,1,1),x=new zN(p.geometry,p.material,d);for(let b=0;b<d;b++)l.TRANSLATION&&v.fromBufferAttribute(l.TRANSLATION,b),l.ROTATION&&g.fromBufferAttribute(l.ROTATION,b),l.SCALE&&y.fromBufferAttribute(l.SCALE,b),x.setMatrixAt(b,m.compose(v,g,y));for(const b in l)b!=="TRANSLATION"&&b!=="ROTATION"&&b!=="SCALE"&&p.geometry.setAttribute(b,l[b]);Si.prototype.copy.call(x,p),this.parser.assignFinalMaterial(x),f.push(x)}return h.isGroup?(h.clear(),h.add(...f),h):f[0]}))}}const yJ="glTF",hx=12,bV={JSON:1313821514,BIN:5130562};class gve{constructor(e){this.name=_i.KHR_BINARY_GLTF,this.content=null,this.body=null;const i=new DataView(e,0,hx);if(this.header={magic:kc.decodeText(new Uint8Array(e.slice(0,4))),version:i.getUint32(4,!0),length:i.getUint32(8,!0)},this.header.magic!==yJ)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-hx,r=new DataView(e,hx);let s=0;for(;s<n;){const o=r.getUint32(s,!0);s+=4;const a=r.getUint32(s,!0);if(s+=4,a===bV.JSON){const l=new Uint8Array(e,hx+s,o);this.content=kc.decodeText(l)}else if(a===bV.BIN){const l=hx+s;this.body=e.slice(l,l+o)}s+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class vve{constructor(e,i){if(!i)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=_i.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=i,this.dracoLoader.preload()}decodePrimitive(e,i){const n=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const h in o){const u=QL[h]||h.toLowerCase();a[u]=o[h]}for(const h in e.attributes){const u=QL[h]||h.toLowerCase();if(o[h]!==void 0){const d=n.accessors[e.attributes[h]],f=zv[d.componentType];c[u]=f.name,l[u]=d.normalized===!0}}return i.getDependency("bufferView",s).then(function(h){return new Promise(function(u){r.decodeDracoFile(h,function(d){for(const f in d.attributes){const p=d.attributes[f],m=l[f];m!==void 0&&(p.normalized=m)}u(d)},a,c)})})}}class yve{constructor(){this.name=_i.KHR_TEXTURE_TRANSFORM}extendTexture(e,i){return(i.texCoord===void 0||i.texCoord===e.channel)&&i.offset===void 0&&i.rotation===void 0&&i.scale===void 0||(e=e.clone(),i.texCoord!==void 0&&(e.channel=i.texCoord),i.offset!==void 0&&e.offset.fromArray(i.offset),i.rotation!==void 0&&(e.rotation=i.rotation),i.scale!==void 0&&e.repeat.fromArray(i.scale),e.needsUpdate=!0),e}}class xve{constructor(){this.name=_i.KHR_MESH_QUANTIZATION}}class xJ extends ry{constructor(e,i,n,r){super(e,i,n,r)}copySampleValue_(e){const i=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)i[o]=n[s+o];return i}interpolate_(e,i,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=a*2,c=a*3,h=r-i,u=(n-i)/h,d=u*u,f=d*u,p=e*c,m=p-c,v=-2*f+3*d,g=f-d,y=1-v,x=g-d+u;for(let b=0;b!==a;b++){const S=o[m+b+a],A=o[m+b+l]*h,E=o[p+b+a],M=o[p+b]*h;s[b]=y*S+x*A+v*E+g*M}return s}}const _ve=new Gr;class wve extends xJ{interpolate_(e,i,n,r){const s=super.interpolate_(e,i,n,r);return _ve.fromArray(s).normalize().toArray(s),s}}const Ca={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},zv={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},SV={9728:Ln,9729:xn,9984:y_,9985:cC,9986:Nv,9987:Wc},AV={33071:Jr,33648:d0,10497:Yd},HD={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},QL={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...cw.replace(/\D+/g,"")>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Oh={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},bve={CUBICSPLINE:void 0,LINEAR:tm,STEP:p0},VD={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Sve(t){return t.DefaultMaterial===void 0&&(t.DefaultMaterial=new _w({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:jc})),t.DefaultMaterial}function Of(t,e,i){for(const n in i.extensions)t[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=i.extensions[n])}function td(t,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Ave(t,e,i){let n=!1,r=!1,s=!1;for(let c=0,h=e.length;c<h;c++){const u=e[c];if(u.POSITION!==void 0&&(n=!0),u.NORMAL!==void 0&&(r=!0),u.COLOR_0!==void 0&&(s=!0),n&&r&&s)break}if(!n&&!r&&!s)return Promise.resolve(t);const o=[],a=[],l=[];for(let c=0,h=e.length;c<h;c++){const u=e[c];if(n){const d=u.POSITION!==void 0?i.getDependency("accessor",u.POSITION):t.attributes.position;o.push(d)}if(r){const d=u.NORMAL!==void 0?i.getDependency("accessor",u.NORMAL):t.attributes.normal;a.push(d)}if(s){const d=u.COLOR_0!==void 0?i.getDependency("accessor",u.COLOR_0):t.attributes.color;l.push(d)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const h=c[0],u=c[1],d=c[2];return n&&(t.morphAttributes.position=h),r&&(t.morphAttributes.normal=u),s&&(t.morphAttributes.color=d),t.morphTargetsRelative=!0,t})}function Mve(t,e){if(t.updateMorphTargets(),e.weights!==void 0)for(let i=0,n=e.weights.length;i<n;i++)t.morphTargetInfluences[i]=e.weights[i];if(e.extras&&Array.isArray(e.extras.targetNames)){const i=e.extras.targetNames;if(t.morphTargetInfluences.length===i.length){t.morphTargetDictionary={};for(let n=0,r=i.length;n<r;n++)t.morphTargetDictionary[i[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Eve(t){let e;const i=t.extensions&&t.extensions[_i.KHR_DRACO_MESH_COMPRESSION];if(i?e="draco:"+i.bufferView+":"+i.indices+":"+jD(i.attributes):e=t.indices+":"+jD(t.attributes)+":"+t.mode,t.targets!==void 0)for(let n=0,r=t.targets.length;n<r;n++)e+=":"+jD(t.targets[n]);return e}function jD(t){let e="";const i=Object.keys(t).sort();for(let n=0,r=i.length;n<r;n++)e+=i[n]+":"+t[i[n]]+";";return e}function KL(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Tve(t){return t.search(/\.jpe?g($|\?)/i)>0||t.search(/^data\:image\/jpeg/)===0?"image/jpeg":t.search(/\.webp($|\?)/i)>0||t.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const Cve=new Wt;class Pve{constructor(e={},i={}){this.json=e,this.extensions={},this.plugins={},this.options=i,this.cache=new $ge,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=!1,s=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||r&&s<98?this.textureLoader=new LK(this.options.manager):this.textureLoader=new zK(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new ia(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,i){const n=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:n,userData:{}};Of(s,a,r),td(a,r),Promise.all(n._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(i)}_markDefs(){const e=this.json.nodes||[],i=this.json.skins||[],n=this.json.meshes||[];for(let r=0,s=i.length;r<s;r++){const o=i[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(n[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,i){i!==void 0&&(e.refs[i]===void 0&&(e.refs[i]=e.uses[i]=0),e.refs[i]++)}_getNodeRef(e,i,n){if(e.refs[i]<=1)return n;const r=n.clone(),s=(o,a)=>{const l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(const[c,h]of o.children.entries())s(h,a.children[c])};return s(n,r),r.name+="_instance_"+e.uses[i]++,r}_invokeOne(e){const i=Object.values(this.plugins);i.push(this);for(let n=0;n<i.length;n++){const r=e(i[n]);if(r)return r}return null}_invokeAll(e){const i=Object.values(this.plugins);i.unshift(this);const n=[];for(let r=0;r<i.length;r++){const s=e(i[r]);s&&n.push(s)}return n}getDependency(e,i){const n=e+":"+i;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(i);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(i)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(i)});break;case"accessor":r=this.loadAccessor(i);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(i)});break;case"buffer":r=this.loadBuffer(i);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(i)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(i)});break;case"skin":r=this.loadSkin(i);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(i)});break;case"camera":r=this.loadCamera(i);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,i)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(n,r)}return r}getDependencies(e){let i=this.cache.get(e);if(!i){const n=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];i=Promise.all(r.map(function(s,o){return n.getDependency(e,o)})),this.cache.add(e,i)}return i}loadBuffer(e){const i=this.json.buffers[e],n=this.fileLoader;if(i.type&&i.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+i.type+" buffer type is not supported.");if(i.uri===void 0&&e===0)return Promise.resolve(this.extensions[_i.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){n.load(kc.resolveURL(i.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+i.uri+'".'))})})}loadBufferView(e){const i=this.json.bufferViews[e];return this.getDependency("buffer",i.buffer).then(function(n){const r=i.byteLength||0,s=i.byteOffset||0;return n.slice(s,s+r)})}loadAccessor(e){const i=this,n=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){const o=HD[r.type],a=zv[r.componentType],l=r.normalized===!0,c=new a(r.count*o);return Promise.resolve(new Ri(c,o,l))}const s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=HD[r.type],c=zv[r.componentType],h=c.BYTES_PER_ELEMENT,u=h*l,d=r.byteOffset||0,f=r.bufferView!==void 0?n.bufferViews[r.bufferView].byteStride:void 0,p=r.normalized===!0;let m,v;if(f&&f!==u){const g=Math.floor(d/f),y="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+g+":"+r.count;let x=i.cache.get(y);x||(m=new c(a,g*f,r.count*f/h),x=new mw(m,f/h),i.cache.add(y,x)),v=new Qd(x,l,d%f/h,p)}else a===null?m=new c(r.count*l):m=new c(a,d,r.count*l),v=new Ri(m,l,p);if(r.sparse!==void 0){const g=HD.SCALAR,y=zv[r.sparse.indices.componentType],x=r.sparse.indices.byteOffset||0,b=r.sparse.values.byteOffset||0,S=new y(o[1],x,r.sparse.count*g),A=new c(o[2],b,r.sparse.count*l);a!==null&&(v=new Ri(v.array.slice(),v.itemSize,v.normalized));for(let E=0,M=S.length;E<M;E++){const T=S[E];if(v.setX(T,A[E*l]),l>=2&&v.setY(T,A[E*l+1]),l>=3&&v.setZ(T,A[E*l+2]),l>=4&&v.setW(T,A[E*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return v})}loadTexture(e){const i=this.json,n=this.options,s=i.textures[e].source,o=i.images[s];let a=this.textureLoader;if(o.uri){const l=n.manager.getHandler(o.uri);l!==null&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,i,n){const r=this,s=this.json,o=s.textures[e],a=s.images[i],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(i,n).then(function(h){h.flipY=!1,h.name=o.name||a.name||"",h.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(h.name=a.uri);const d=(s.samplers||{})[o.sampler]||{};return h.magFilter=SV[d.magFilter]||xn,h.minFilter=SV[d.minFilter]||Wc,h.wrapS=AV[d.wrapS]||Yd,h.wrapT=AV[d.wrapT]||Yd,r.associations.set(h,{textures:e}),h}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,i){const n=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(u=>u.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(o.bufferView!==void 0)l=n.getDependency("bufferView",o.bufferView).then(function(u){c=!0;const d=new Blob([u],{type:o.mimeType});return l=a.createObjectURL(d),l});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(l).then(function(u){return new Promise(function(d,f){let p=d;i.isImageBitmapLoader===!0&&(p=function(m){const v=new pn(m);v.needsUpdate=!0,d(v)}),i.load(kc.resolveURL(u,s.path),p,void 0,f)})}).then(function(u){return c===!0&&a.revokeObjectURL(l),u.userData.mimeType=o.mimeType||Tve(o.uri),u}).catch(function(u){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),u});return this.sourceCache[e]=h,h}assignTexture(e,i,n,r){const s=this;return this.getDependency("texture",n.index).then(function(o){if(!o)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(o=o.clone(),o.channel=n.texCoord),s.extensions[_i.KHR_TEXTURE_TRANSFORM]){const a=n.extensions!==void 0?n.extensions[_i.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[_i.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return r!==void 0&&("colorSpace"in o?o.colorSpace=r===3001?"srgb":"srgb-linear":o.encoding=r),e[i]=o,o})}assignFinalMaterial(e){const i=e.geometry;let n=e.material;const r=i.attributes.tangent===void 0,s=i.attributes.color!==void 0,o=i.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new yC,dr.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,l.sizeAttenuation=!1,this.cache.add(a,l)),n=l}else if(e.isLine){const a="LineBasicMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new Ms,dr.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,this.cache.add(a,l)),n=l}if(r||s||o){let a="ClonedMaterial:"+n.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=n.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(n))),n=l}e.material=n}getMaterialType(){return _w}loadMaterial(e){const i=this,n=this.json,r=this.extensions,s=n.materials[e];let o;const a={},l=s.extensions||{},c=[];if(l[_i.KHR_MATERIALS_UNLIT]){const u=r[_i.KHR_MATERIALS_UNLIT];o=u.getMaterialType(),c.push(u.extendParams(a,s,i))}else{const u=s.pbrMetallicRoughness||{};if(a.color=new ht(1,1,1),a.opacity=1,Array.isArray(u.baseColorFactor)){const d=u.baseColorFactor;a.color.fromArray(d),a.opacity=d[3]}u.baseColorTexture!==void 0&&c.push(i.assignTexture(a,"map",u.baseColorTexture,3001)),a.metalness=u.metallicFactor!==void 0?u.metallicFactor:1,a.roughness=u.roughnessFactor!==void 0?u.roughnessFactor:1,u.metallicRoughnessTexture!==void 0&&(c.push(i.assignTexture(a,"metalnessMap",u.metallicRoughnessTexture)),c.push(i.assignTexture(a,"roughnessMap",u.metallicRoughnessTexture))),o=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=ka);const h=s.alphaMode||VD.OPAQUE;if(h===VD.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,h===VD.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==jo&&(c.push(i.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new Qe(1,1),s.normalTexture.scale!==void 0)){const u=s.normalTexture.scale;a.normalScale.set(u,u)}return s.occlusionTexture!==void 0&&o!==jo&&(c.push(i.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==jo&&(a.emissive=new ht().fromArray(s.emissiveFactor)),s.emissiveTexture!==void 0&&o!==jo&&c.push(i.assignTexture(a,"emissiveMap",s.emissiveTexture,3001)),Promise.all(c).then(function(){const u=new o(a);return s.name&&(u.name=s.name),td(u,s),i.associations.set(u,{materials:e}),s.extensions&&Of(r,u,s),u})}createUniqueName(e){const i=bi.sanitizeNodeName(e||"");return i in this.nodeNamesUsed?i+"_"+ ++this.nodeNamesUsed[i]:(this.nodeNamesUsed[i]=0,i)}loadGeometries(e){const i=this,n=this.extensions,r=this.primitiveCache;function s(a){return n[_i.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,i).then(function(l){return MV(l,a,i)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],h=Eve(c),u=r[h];if(u)o.push(u.promise);else{let d;c.extensions&&c.extensions[_i.KHR_DRACO_MESH_COMPRESSION]?d=s(c):d=MV(new si,c,i),r[h]={primitive:c,promise:d},o.push(d)}}return Promise.all(o)}loadMesh(e){const i=this,n=this.json,r=this.extensions,s=n.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const h=o[l].material===void 0?Sve(this.cache):this.getDependency("material",o[l].material);a.push(h)}return a.push(i.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),h=l[l.length-1],u=[];for(let f=0,p=h.length;f<p;f++){const m=h[f],v=o[f];let g;const y=c[f];if(v.mode===Ca.TRIANGLES||v.mode===Ca.TRIANGLE_STRIP||v.mode===Ca.TRIANGLE_FAN||v.mode===void 0)g=s.isSkinnedMesh===!0?new kN(m,y):new Ur(m,y),g.isSkinnedMesh===!0&&g.normalizeSkinWeights(),v.mode===Ca.TRIANGLE_STRIP?g.geometry=_V(g.geometry,AN):v.mode===Ca.TRIANGLE_FAN&&(g.geometry=_V(g.geometry,AE));else if(v.mode===Ca.LINES)g=new Wl(m,y);else if(v.mode===Ca.LINE_STRIP)g=new ch(m,y);else if(v.mode===Ca.LINE_LOOP)g=new GN(m,y);else if(v.mode===Ca.POINTS)g=new HN(m,y);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+v.mode);Object.keys(g.geometry.morphAttributes).length>0&&Mve(g,s),g.name=i.createUniqueName(s.name||"mesh_"+e),td(g,s),v.extensions&&Of(r,g,v),i.assignFinalMaterial(g),u.push(g)}for(let f=0,p=u.length;f<p;f++)i.associations.set(u[f],{meshes:e,primitives:f});if(u.length===1)return s.extensions&&Of(r,u[0],s),u[0];const d=new qu;s.extensions&&Of(r,d,s),i.associations.set(d,{meshes:e});for(let f=0,p=u.length;f<p;f++)d.add(u[f]);return d})}loadCamera(e){let i;const n=this.json.cameras[e],r=n[n.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?i=new fn(YQ.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):n.type==="orthographic"&&(i=new Bl(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(i.name=this.createUniqueName(n.name)),td(i,n),Promise.resolve(i)}loadSkin(e){const i=this.json.skins[e],n=[];for(let r=0,s=i.joints.length;r<s;r++)n.push(this._loadNodeShallow(i.joints[r]));return i.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",i.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(r){const s=r.pop(),o=r,a=[],l=[];for(let c=0,h=o.length;c<h;c++){const u=o[c];if(u){a.push(u);const d=new Wt;s!==null&&d.fromArray(s.array,c*16),l.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',i.joints[c])}return new gw(a,l)})}loadAnimation(e){const n=this.json.animations[e],r=n.name?n.name:"animation_"+e,s=[],o=[],a=[],l=[],c=[];for(let h=0,u=n.channels.length;h<u;h++){const d=n.channels[h],f=n.samplers[d.sampler],p=d.target,m=p.node,v=n.parameters!==void 0?n.parameters[f.input]:f.input,g=n.parameters!==void 0?n.parameters[f.output]:f.output;p.node!==void 0&&(s.push(this.getDependency("node",m)),o.push(this.getDependency("accessor",v)),a.push(this.getDependency("accessor",g)),l.push(f),c.push(p))}return Promise.all([Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c)]).then(function(h){const u=h[0],d=h[1],f=h[2],p=h[3],m=h[4],v=[];for(let g=0,y=u.length;g<y;g++){const x=u[g],b=d[g],S=f[g],A=p[g],E=m[g];if(x===void 0)continue;x.updateMatrix();let M;switch(Oh[E.path]){case Oh.weights:M=y0;break;case Oh.rotation:M=Kd;break;case Oh.position:case Oh.scale:default:M=x0;break}const T=x.name?x.name:x.uuid,P=A.interpolation!==void 0?bve[A.interpolation]:tm,R=[];Oh[E.path]===Oh.weights?x.traverse(function(F){F.morphTargetInfluences&&R.push(F.name?F.name:F.uuid)}):R.push(T);let U=S.array;if(S.normalized){const F=KL(U.constructor),N=new Float32Array(U.length);for(let W=0,Q=U.length;W<Q;W++)N[W]=U[W]*F;U=N}for(let F=0,N=R.length;F<N;F++){const W=new M(R[F]+"."+Oh[E.path],b.array,U,P);A.interpolation==="CUBICSPLINE"&&(W.createInterpolant=function(X){const B=this instanceof Kd?wve:xJ;return new B(this.times,this.values,this.getValueSize()/3,X)},W.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),v.push(W)}}return new _0(r,void 0,v)})}createNodeMesh(e){const i=this.json,n=this,r=i.nodes[e];return r.mesh===void 0?null:n.getDependency("mesh",r.mesh).then(function(s){const o=n._getNodeRef(n.meshCache,r.mesh,s);return r.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const i=this.json,n=this,r=i.nodes[e],s=n._loadNodeShallow(e),o=[],a=r.children||[];for(let c=0,h=a.length;c<h;c++)o.push(n.getDependency("node",a[c]));const l=r.skin===void 0?Promise.resolve(null):n.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){const h=c[0],u=c[1],d=c[2];d!==null&&h.traverse(function(f){f.isSkinnedMesh&&f.bind(d,Cve)});for(let f=0,p=u.length;f<p;f++)h.add(u[f]);return h})}_loadNodeShallow(e){const i=this.json,n=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=i.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),s.camera!==void 0&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let h;if(s.isBone===!0?h=new vC:c.length>1?h=new qu:c.length===1?h=c[0]:h=new Si,h!==c[0])for(let u=0,d=c.length;u<d;u++)h.add(c[u]);if(s.name&&(h.userData.name=s.name,h.name=o),td(h,s),s.extensions&&Of(n,h,s),s.matrix!==void 0){const u=new Wt;u.fromArray(s.matrix),h.applyMatrix4(u)}else s.translation!==void 0&&h.position.fromArray(s.translation),s.rotation!==void 0&&h.quaternion.fromArray(s.rotation),s.scale!==void 0&&h.scale.fromArray(s.scale);return r.associations.has(h)||r.associations.set(h,{}),r.associations.get(h).nodes=e,h}),this.nodeCache[e]}loadScene(e){const i=this.extensions,n=this.json.scenes[e],r=this,s=new qu;n.name&&(s.name=r.createUniqueName(n.name)),td(s,n),n.extensions&&Of(i,s,n);const o=n.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let h=0,u=l.length;h<u;h++)s.add(l[h]);const c=h=>{const u=new Map;for(const[d,f]of r.associations)(d instanceof dr||d instanceof pn)&&u.set(d,f);return h.traverse(d=>{const f=r.associations.get(d);f!=null&&u.set(d,f)}),u};return r.associations=c(s),s})}}function Dve(t,e,i){const n=e.attributes,r=new jl;if(n.POSITION!==void 0){const a=i.json.accessors[n.POSITION],l=a.min,c=a.max;if(l!==void 0&&c!==void 0){if(r.set(new te(l[0],l[1],l[2]),new te(c[0],c[1],c[2])),a.normalized){const h=KL(zv[a.componentType]);r.min.multiplyScalar(h),r.max.multiplyScalar(h)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const a=new te,l=new te;for(let c=0,h=s.length;c<h;c++){const u=s[c];if(u.POSITION!==void 0){const d=i.json.accessors[u.POSITION],f=d.min,p=d.max;if(f!==void 0&&p!==void 0){if(l.setX(Math.max(Math.abs(f[0]),Math.abs(p[0]))),l.setY(Math.max(Math.abs(f[1]),Math.abs(p[1]))),l.setZ(Math.max(Math.abs(f[2]),Math.abs(p[2]))),d.normalized){const m=KL(zv[d.componentType]);l.multiplyScalar(m)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}t.boundingBox=r;const o=new nl;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,t.boundingSphere=o}function MV(t,e,i){const n=e.attributes,r=[];function s(o,a){return i.getDependency("accessor",o).then(function(l){t.setAttribute(a,l)})}for(const o in n){const a=QL[o]||o.toLowerCase();a in t.attributes||r.push(s(n[o],a))}if(e.indices!==void 0&&!t.index){const o=i.getDependency("accessor",e.indices).then(function(a){t.setIndex(a)});r.push(o)}return td(t,e),Dve(t,e,i),Promise.all(r).then(function(){return e.targets!==void 0?Ave(t,e.targets,i):t})}const WD=new WeakMap;class Rve extends Es{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,i,n,r){const s=new ia(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{const a={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,a).then(i).catch(r)},n,r)}decodeDracoFile(e,i,n,r){const s={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,s).then(i)}decodeGeometry(e,i){for(const l in i.attributeTypes){const c=i.attributeTypes[l];c.BYTES_PER_ELEMENT!==void 0&&(i.attributeTypes[l]=c.name)}const n=JSON.stringify(i);if(WD.has(e)){const l=WD.get(e);if(l.key===n)return l.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,o=e.byteLength,a=this._getWorker(s,o).then(l=>(r=l,new Promise((c,h)=>{r._callbacks[s]={resolve:c,reject:h},r.postMessage({type:"decode",id:s,taskConfig:i,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),WD.set(e,{key:n,promise:a}),a}_createGeometry(e){const i=new si;e.index&&i.setIndex(new Ri(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const r=e.attributes[n],s=r.name,o=r.array,a=r.itemSize;i.setAttribute(s,new Ri(o,a))}return i}_loadLibrary(e,i){const n=new ia(this.manager);return n.setPath(this.decoderPath),n.setResponseType(i),n.setWithCredentials(this.withCredentials),new Promise((r,s)=>{n.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",i=[];return e?i.push(this._loadLibrary("draco_decoder.js","text")):(i.push(this._loadLibrary("draco_wasm_wrapper.js","text")),i.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(i).then(n=>{const r=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const s=Ive.toString(),o=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,i){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const o=s.data;switch(o.type){case"decode":r._callbacks[o.id].resolve(o);break;case"error":r._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=i,n._taskLoad+=i,n})}_releaseTask(e,i){e._taskLoad-=e._taskCosts[i],delete e._callbacks[i],delete e._taskCosts[i]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function Ive(){let t,e;onmessage=function(o){const a=o.data;switch(a.type){case"init":t=a.decoderConfig,e=new Promise(function(h){t.onModuleLoaded=function(u){h({draco:u})},DracoDecoderModule(t)});break;case"decode":const l=a.buffer,c=a.taskConfig;e.then(h=>{const u=h.draco,d=new u.Decoder,f=new u.DecoderBuffer;f.Init(new Int8Array(l),l.byteLength);try{const p=i(u,d,f,c),m=p.attributes.map(v=>v.array.buffer);p.index&&m.push(p.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:p},m)}catch(p){console.error(p),self.postMessage({type:"error",id:a.id,error:p.message})}finally{u.destroy(f),u.destroy(d)}});break}};function i(o,a,l,c){const h=c.attributeIDs,u=c.attributeTypes;let d,f;const p=a.GetEncodedGeometryType(l);if(p===o.TRIANGULAR_MESH)d=new o.Mesh,f=a.DecodeBufferToMesh(l,d);else if(p===o.POINT_CLOUD)d=new o.PointCloud,f=a.DecodeBufferToPointCloud(l,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!f.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());const m={index:null,attributes:[]};for(const v in h){const g=self[u[v]];let y,x;if(c.useUniqueIDs)x=h[v],y=a.GetAttributeByUniqueId(d,x);else{if(x=a.GetAttributeId(d,o[h[v]]),x===-1)continue;y=a.GetAttribute(d,x)}m.attributes.push(r(o,a,d,v,g,y))}return p===o.TRIANGULAR_MESH&&(m.index=n(o,a,d)),o.destroy(d),m}function n(o,a,l){const h=l.num_faces()*3,u=h*4,d=o._malloc(u);a.GetTrianglesUInt32Array(l,u,d);const f=new Uint32Array(o.HEAPF32.buffer,d,h).slice();return o._free(d),{array:f,itemSize:1}}function r(o,a,l,c,h,u){const d=u.num_components(),p=l.num_points()*d,m=p*h.BYTES_PER_ELEMENT,v=s(o,h),g=o._malloc(m);a.GetAttributeDataArrayForAllPoints(l,u,v,m,g);const y=new h(o.HEAPF32.buffer,g,p).slice();return o._free(g),{name:c,array:y,itemSize:d}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}let HS;const XD=()=>{if(HS)return HS;const t="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",i=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),n=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let r=t;WebAssembly.validate(i)&&(r=e);let s;const o=WebAssembly.instantiate(a(r),{}).then(u=>{s=u.instance,s.exports.__wasm_call_ctors()});function a(u){const d=new Uint8Array(u.length);for(let p=0;p<u.length;++p){const m=u.charCodeAt(p);d[p]=m>96?m-71:m>64?m-65:m>47?m+4:m>46?63:62}let f=0;for(let p=0;p<u.length;++p)d[f++]=d[p]<60?n[d[p]]:(d[p]-60)*64+d[++p];return d.buffer.slice(0,f)}function l(u,d,f,p,m,v){const g=s.exports.sbrk,y=f+3&-4,x=g(y*p),b=g(m.length),S=new Uint8Array(s.exports.memory.buffer);S.set(m,b);const A=u(x,f,p,b,m.length);if(A===0&&v&&v(x,y,p),d.set(S.subarray(x,x+f*p)),g(x-g(0)),A!==0)throw new Error(`Malformed buffer data: ${A}`)}const c={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},h={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return HS={ready:o,supported:!0,decodeVertexBuffer(u,d,f,p,m){l(s.exports.meshopt_decodeVertexBuffer,u,d,f,p,s.exports[c[m]])},decodeIndexBuffer(u,d,f,p){l(s.exports.meshopt_decodeIndexBuffer,u,d,f,p)},decodeIndexSequence(u,d,f,p){l(s.exports.meshopt_decodeIndexSequence,u,d,f,p)},decodeGltfBuffer(u,d,f,p,m,v){l(s.exports[h[m]],u,d,f,p,s.exports[c[v]])}},HS};let VS=null;function _J(t,e,i){return n=>{i&&i(n),t&&(VS||(VS=new Rve),VS.setDecoderPath(typeof t=="string"?t:"https://www.gstatic.com/draco/versioned/decoders/1.5.5/"),n.setDRACOLoader(VS)),e&&n.setMeshoptDecoder(typeof XD=="function"?XD():XD)}}function pU(t,e=!0,i=!0,n){return bw(fU,t,_J(e,i,n))}pU.preload=(t,e=!0,i=!0,n)=>bw.preload(fU,t,_J(e,i,n));pU.clear=t=>bw.clear(fU,t);const Lve=ye.forwardRef(({makeDefault:t,camera:e,regress:i,domElement:n,enableDamping:r=!0,keyEvents:s=!1,onChange:o,onStart:a,onEnd:l,...c},h)=>{const u=Ia(A=>A.invalidate),d=Ia(A=>A.camera),f=Ia(A=>A.gl),p=Ia(A=>A.events),m=Ia(A=>A.setEvents),v=Ia(A=>A.set),g=Ia(A=>A.get),y=Ia(A=>A.performance),x=e||d,b=n||p.connected||f.domElement,S=ye.useMemo(()=>new Zge(x),[x]);return uJ(()=>{S.enabled&&S.update()},-1),ye.useEffect(()=>(s&&S.connect(s===!0?b:s),S.connect(b),()=>void S.dispose()),[s,b,i,S,u]),ye.useEffect(()=>{const A=T=>{u(),i&&y.regress(),o&&o(T)},E=T=>{a&&a(T)},M=T=>{l&&l(T)};return S.addEventListener("change",A),S.addEventListener("start",E),S.addEventListener("end",M),()=>{S.removeEventListener("start",E),S.removeEventListener("end",M),S.removeEventListener("change",A)}},[o,a,l,S,u,m]),ye.useEffect(()=>{if(t){const A=g().controls;return v({controls:S}),()=>v({controls:A})}},[t,S]),ye.createElement("primitive",b0({ref:h,object:S,enableDamping:r},c))});function Bve({all:t,scene:e,camera:i}){const n=Ia(({gl:o})=>o),r=Ia(({camera:o})=>o),s=Ia(({scene:o})=>o);return ye.useLayoutEffect(()=>{const o=[];t&&(e||s).traverse(c=>{c.visible===!1&&(o.push(c),c.visible=!0)}),n.compile(e||s,i||r);const a=new LN(128);new IN(.01,1e5,a).update(n,e||s),a.dispose(),o.forEach(c=>c.visible=!1)},[]),null}const Ove=()=>{const{progress:t}=Qge();return rt.jsxs(Yge,{as:"div",center:!0,style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[rt.jsx("span",{className:"canvas-loader"}),rt.jsxs("p",{style:{fontSize:14,color:"#F1F1F1",fontWeight:800,marginTop:40},children:[t.toFixed(2),"%"]})]})},Fve=()=>{const t=pU("./planet/scene.gltf");return rt.jsx("primitive",{object:t.scene,scale:2.5,"position-y":0,"rotation-y":0})},Nve=()=>rt.jsx(Uge,{shadows:!0,frameloop:"demand",dpr:[1,2],gl:{preserveDrawingBuffer:!0},camera:{fov:45,near:.1,far:200,position:[-4,3,6]},children:rt.jsxs(ye.Suspense,{fallback:rt.jsx(Ove,{}),children:[rt.jsx(Lve,{autoRotate:!0,enableZoom:!1,maxPolarAngle:Math.PI/2,minPolarAngle:Math.PI/2}),rt.jsx(Fve,{}),rt.jsx(Bve,{all:!0})]})});function C1(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function wJ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}new Qe;new Qe;var ya=function t(e,i,n){var r=this;wJ(this,t),C1(this,"dot2",function(s,o){return r.x*s+r.y*o}),C1(this,"dot3",function(s,o,a){return r.x*s+r.y*o+r.z*a}),this.x=e,this.y=i,this.z=n},Uve=[new ya(1,1,0),new ya(-1,1,0),new ya(1,-1,0),new ya(-1,-1,0),new ya(1,0,1),new ya(-1,0,1),new ya(1,0,-1),new ya(-1,0,-1),new ya(0,1,1),new ya(0,-1,1),new ya(0,1,-1),new ya(0,-1,-1)],EV=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],TV=new Array(512),CV=new Array(512),kve=function(e){e>0&&e<1&&(e*=65536),e=Math.floor(e),e<256&&(e|=e<<8);for(var i=0;i<256;i++){var n;i&1?n=EV[i]^e&255:n=EV[i]^e>>8&255,TV[i]=TV[i+256]=n,CV[i]=CV[i+256]=Uve[n%12]}};kve(0);function zve(t){if(typeof t=="number")t=Math.abs(t);else if(typeof t=="string"){var e=t;t=0;for(var i=0;i<e.length;i++)t=(t+(i+1)*(e.charCodeAt(i)%96))%2147483647}return t===0&&(t=311),t}function PV(t){var e=zve(t);return function(){var i=e*48271%2147483647;return e=i,i/2147483647}}var Gve=function t(e){var i=this;wJ(this,t),C1(this,"seed",0),C1(this,"init",function(n){i.seed=n,i.value=PV(n)}),C1(this,"value",PV(this.seed)),this.init(e)};new Gve(Math.random());var Hve=Object.defineProperty,Vve=Object.defineProperties,jve=Object.getOwnPropertyDescriptors,DV=Object.getOwnPropertySymbols,Wve=Object.prototype.hasOwnProperty,Xve=Object.prototype.propertyIsEnumerable,RV=(t,e,i)=>e in t?Hve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,dx=(t,e)=>{for(var i in e||(e={}))Wve.call(e,i)&&RV(t,i,e[i]);if(DV)for(var i of DV(e))Xve.call(e,i)&&RV(t,i,e[i]);return t},fx=(t,e)=>Vve(t,jve(e)),qve=class extends ye.Component{constructor(t){super(t),this.ref=Ul.createRef(),this.state={style:{}};const e={reverse:!1,max:35,perspective:1e3,easing:"cubic-bezier(.03,.98,.52,.99)",scale:"1.1",speed:"1000",transition:!0,axis:null,reset:!0};this.width=null,this.height=null,this.left=null,this.top=null,this.transitionTimeout=null,this.updateCall=null,this.element=null,this.settings=Object.assign({},e,this.props.options),this.reverse=this.settings.reverse?-1:1,this.onMouseEnter=this.onMouseEnter.bind(this,this.props.onMouseEnter),this.onMouseMove=this.onMouseMove.bind(this,this.props.onMouseMove),this.onMouseLeave=this.onMouseLeave.bind(this,this.props.onMouseLeave)}componentDidMount(){this.element=this.ref.current,setTimeout(()=>{this.element.parentElement.querySelector(":hover")===this.element&&this.onMouseEnter()},0)}componentWillUnmount(){clearTimeout(this.transitionTimeout),cancelAnimationFrame(this.updateCall)}onMouseEnter(t=()=>{},e){return this.updateElementPosition(),this.setState(Object.assign({},this.state,{style:fx(dx({},this.state.style),{willChange:"transform"})})),this.setTransition(),t(e)}reset(){window.requestAnimationFrame(()=>{this.setState(Object.assign({},this.state,{style:fx(dx({},this.state.style),{transform:`perspective(${this.settings.perspective}px) rotateX(0deg) rotateY(0deg) scale3d(1, 1, 1)`})}))})}onMouseMove(t=()=>{},e){return e.persist(),this.updateCall!==null&&window.cancelAnimationFrame(this.updateCall),this.event=e,this.updateCall=requestAnimationFrame(this.update.bind(this,e)),t(e)}setTransition(){clearTimeout(this.transitionTimeout),this.setState(Object.assign({},this.state,{style:fx(dx({},this.state.style),{transition:`${this.settings.speed}ms ${this.settings.easing}`})})),this.transitionTimeout=setTimeout(()=>{this.setState(Object.assign({},this.state,{style:fx(dx({},this.state.style),{transition:""})}))},this.settings.speed)}onMouseLeave(t=()=>{},e){return this.setTransition(),this.settings.reset&&this.reset(),t(e)}getValues(t){const e=(t.nativeEvent.clientX-this.left)/this.width,i=(t.nativeEvent.clientY-this.top)/this.height,n=Math.min(Math.max(e,0),1),r=Math.min(Math.max(i,0),1),s=(this.reverse*(this.settings.max/2-n*this.settings.max)).toFixed(2),o=(this.reverse*(r*this.settings.max-this.settings.max/2)).toFixed(2),a=n*100,l=r*100;return{tiltX:s,tiltY:o,percentageX:a,percentageY:l}}updateElementPosition(){const t=this.element.getBoundingClientRect();this.width=this.element.offsetWidth,this.height=this.element.offsetHeight,this.left=t.left,this.top=t.top}update(t){const e=this.getValues(t);this.setState(Object.assign({},this.state,{style:fx(dx({},this.state.style),{transform:`perspective(${this.settings.perspective}px) rotateX(${this.settings.axis==="x"?0:e.tiltY}deg) rotateY(${this.settings.axis==="y"?0:e.tiltX}deg) scale3d(${this.settings.scale}, ${this.settings.scale}, ${this.settings.scale})`})})),this.updateCall=null}render(){const t=Object.assign({},this.props.style,this.state.style);return rt.jsx("div",{style:t,ref:this.ref,className:this.props.className,onMouseEnter:this.onMouseEnter,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,children:this.props.children})}};const bJ=ye.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),FC=ye.createContext({}),mU=ye.createContext(null),NC=typeof document<"u",IV=NC?ye.useLayoutEffect:ye.useEffect,SJ=ye.createContext({strict:!1});function Yve(t,e,i,n){const{visualElement:r}=ye.useContext(FC),s=ye.useContext(SJ),o=ye.useContext(mU),a=ye.useContext(bJ).reducedMotion,l=ye.useRef();n=n||s.renderer,!l.current&&n&&(l.current=n(t,{visualState:e,parent:r,props:i,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:a}));const c=l.current;return ye.useInsertionEffect(()=>{c&&c.update(i,o)}),IV(()=>{c&&c.render()}),ye.useEffect(()=>{c&&c.updateFeatures()}),(window.HandoffAppearAnimations?IV:ye.useEffect)(()=>{c&&c.animationState&&c.animationState.animateChanges()}),c}function gv(t){return typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Qve(t,e,i){return ye.useCallback(n=>{n&&t.mount&&t.mount(n),e&&(n?e.mount(n):e.unmount()),i&&(typeof i=="function"?i(n):gv(i)&&(i.current=n))},[e])}function C_(t){return typeof t=="string"||Array.isArray(t)}function UC(t){return typeof t=="object"&&typeof t.start=="function"}const gU=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],vU=["initial",...gU];function kC(t){return UC(t.animate)||vU.some(e=>C_(t[e]))}function AJ(t){return!!(kC(t)||t.variants)}function Kve(t,e){if(kC(t)){const{initial:i,animate:n}=t;return{initial:i===!1||C_(i)?i:void 0,animate:C_(n)?n:void 0}}return t.inherit!==!1?e:{}}function Jve(t){const{initial:e,animate:i}=Kve(t,ye.useContext(FC));return ye.useMemo(()=>({initial:e,animate:i}),[LV(e),LV(i)])}function LV(t){return Array.isArray(t)?t.join(" "):t}const BV={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},P_={};for(const t in BV)P_[t]={isEnabled:e=>BV[t].some(i=>!!e[i])};function Zve(t){for(const e in t)P_[e]={...P_[e],...t[e]}}const MJ=ye.createContext({}),EJ=ye.createContext({}),$ve=Symbol.for("motionComponentSymbol");function e0e({preloadedFeatures:t,createVisualElement:e,useRender:i,useVisualState:n,Component:r}){t&&Zve(t);function s(a,l){let c;const h={...ye.useContext(bJ),...a,layoutId:t0e(a)},{isStatic:u}=h,d=Jve(a),f=n(a,u);if(!u&&NC){d.visualElement=Yve(r,f,h,e);const p=ye.useContext(EJ),m=ye.useContext(SJ).strict;d.visualElement&&(c=d.visualElement.loadFeatures(h,m,t,p))}return ye.createElement(FC.Provider,{value:d},c&&d.visualElement?ye.createElement(c,{visualElement:d.visualElement,...h}):null,i(r,a,Qve(f,d.visualElement,l),f,u,d.visualElement))}const o=ye.forwardRef(s);return o[$ve]=r,o}function t0e({layoutId:t}){const e=ye.useContext(MJ).id;return e&&t!==void 0?e+"-"+t:t}function i0e(t){function e(n,r={}){return e0e(t(n,r))}if(typeof Proxy>"u")return e;const i=new Map;return new Proxy(e,{get:(n,r)=>(i.has(r)||i.set(r,e(r)),i.get(r))})}const n0e=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function yU(t){return typeof t!="string"||t.includes("-")?!1:!!(n0e.indexOf(t)>-1||/[A-Z]/.test(t))}const PE={};function r0e(t){Object.assign(PE,t)}const Aw=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],ym=new Set(Aw);function TJ(t,{layout:e,layoutId:i}){return ym.has(t)||t.startsWith("origin")||(e||i!==void 0)&&(!!PE[t]||t==="opacity")}const So=t=>!!(t&&t.getVelocity),s0e={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},o0e=Aw.length;function a0e(t,{enableHardwareAcceleration:e=!0,allowTransformNone:i=!0},n,r){let s="";for(let o=0;o<o0e;o++){const a=Aw[o];if(t[a]!==void 0){const l=s0e[a]||a;s+=`${l}(${t[a]}) `}}return e&&!t.z&&(s+="translateZ(0)"),s=s.trim(),r?s=r(t,n?"":s):i&&n&&(s="none"),s}const CJ=t=>e=>typeof e=="string"&&e.startsWith(t),PJ=CJ("--"),JL=CJ("var(--"),l0e=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,c0e=(t,e)=>e&&typeof t=="number"?e.transform(t):t,Jd=(t,e,i)=>Math.min(Math.max(i,t),e),xm={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},P1={...xm,transform:t=>Jd(0,1,t)},jS={...xm,default:1},D1=t=>Math.round(t*1e5)/1e5,zC=/(-)?([\d]*\.?[\d])+/g,DJ=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,u0e=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Mw(t){return typeof t=="string"}const Ew=t=>({test:e=>Mw(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Kh=Ew("deg"),zc=Ew("%"),zt=Ew("px"),h0e=Ew("vh"),d0e=Ew("vw"),OV={...zc,parse:t=>zc.parse(t)/100,transform:t=>zc.transform(t*100)},FV={...xm,transform:Math.round},RJ={borderWidth:zt,borderTopWidth:zt,borderRightWidth:zt,borderBottomWidth:zt,borderLeftWidth:zt,borderRadius:zt,radius:zt,borderTopLeftRadius:zt,borderTopRightRadius:zt,borderBottomRightRadius:zt,borderBottomLeftRadius:zt,width:zt,maxWidth:zt,height:zt,maxHeight:zt,size:zt,top:zt,right:zt,bottom:zt,left:zt,padding:zt,paddingTop:zt,paddingRight:zt,paddingBottom:zt,paddingLeft:zt,margin:zt,marginTop:zt,marginRight:zt,marginBottom:zt,marginLeft:zt,rotate:Kh,rotateX:Kh,rotateY:Kh,rotateZ:Kh,scale:jS,scaleX:jS,scaleY:jS,scaleZ:jS,skew:Kh,skewX:Kh,skewY:Kh,distance:zt,translateX:zt,translateY:zt,translateZ:zt,x:zt,y:zt,z:zt,perspective:zt,transformPerspective:zt,opacity:P1,originX:OV,originY:OV,originZ:zt,zIndex:FV,fillOpacity:P1,strokeOpacity:P1,numOctaves:FV};function xU(t,e,i,n){const{style:r,vars:s,transform:o,transformOrigin:a}=t;let l=!1,c=!1,h=!0;for(const u in e){const d=e[u];if(PJ(u)){s[u]=d;continue}const f=RJ[u],p=c0e(d,f);if(ym.has(u)){if(l=!0,o[u]=p,!h)continue;d!==(f.default||0)&&(h=!1)}else u.startsWith("origin")?(c=!0,a[u]=p):r[u]=p}if(e.transform||(l||n?r.transform=a0e(t.transform,i,h,n):r.transform&&(r.transform="none")),c){const{originX:u="50%",originY:d="50%",originZ:f=0}=a;r.transformOrigin=`${u} ${d} ${f}`}}const _U=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function IJ(t,e,i){for(const n in e)!So(e[n])&&!TJ(n,i)&&(t[n]=e[n])}function f0e({transformTemplate:t},e,i){return ye.useMemo(()=>{const n=_U();return xU(n,e,{enableHardwareAcceleration:!i},t),Object.assign({},n.vars,n.style)},[e])}function p0e(t,e,i){const n=t.style||{},r={};return IJ(r,n,t),Object.assign(r,f0e(t,e,i)),t.transformValues?t.transformValues(r):r}function m0e(t,e,i){const n={},r=p0e(t,e,i);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=r,n}const g0e=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onLayoutAnimationStart","onLayoutAnimationComplete","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","ignoreStrict","viewport"]);function DE(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||g0e.has(t)}let LJ=t=>!DE(t);function v0e(t){t&&(LJ=e=>e.startsWith("on")?!DE(e):t(e))}try{v0e(require("@emotion/is-prop-valid").default)}catch{}function y0e(t,e,i){const n={};for(const r in t)r==="values"&&typeof t.values=="object"||(LJ(r)||i===!0&&DE(r)||!e&&!DE(r)||t.draggable&&r.startsWith("onDrag"))&&(n[r]=t[r]);return n}function NV(t,e,i){return typeof t=="string"?t:zt.transform(e+i*t)}function x0e(t,e,i){const n=NV(e,t.x,t.width),r=NV(i,t.y,t.height);return`${n} ${r}`}const _0e={offset:"stroke-dashoffset",array:"stroke-dasharray"},w0e={offset:"strokeDashoffset",array:"strokeDasharray"};function b0e(t,e,i=1,n=0,r=!0){t.pathLength=1;const s=r?_0e:w0e;t[s.offset]=zt.transform(-n);const o=zt.transform(e),a=zt.transform(i);t[s.array]=`${o} ${a}`}function wU(t,{attrX:e,attrY:i,attrScale:n,originX:r,originY:s,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...c},h,u,d){if(xU(t,c,h,d),u){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:f,style:p,dimensions:m}=t;f.transform&&(m&&(p.transform=f.transform),delete f.transform),m&&(r!==void 0||s!==void 0||p.transform)&&(p.transformOrigin=x0e(m,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(f.x=e),i!==void 0&&(f.y=i),n!==void 0&&(f.scale=n),o!==void 0&&b0e(f,o,a,l,!1)}const BJ=()=>({..._U(),attrs:{}}),bU=t=>typeof t=="string"&&t.toLowerCase()==="svg";function S0e(t,e,i,n){const r=ye.useMemo(()=>{const s=BJ();return wU(s,e,{enableHardwareAcceleration:!1},bU(n),t.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(t.style){const s={};IJ(s,t.style,t),r.style={...s,...r.style}}return r}function A0e(t=!1){return(i,n,r,{latestValues:s},o)=>{const l=(yU(i)?S0e:m0e)(n,s,o,i),h={...y0e(n,typeof i=="string",t),...l,ref:r},{children:u}=n,d=ye.useMemo(()=>So(u)?u.get():u,[u]);return ye.createElement(i,{...h,children:d})}}const SU=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();function OJ(t,{style:e,vars:i},n,r){Object.assign(t.style,e,r&&r.getProjectionStyles(n));for(const s in i)t.style.setProperty(s,i[s])}const FJ=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function NJ(t,e,i,n){OJ(t,e,void 0,n);for(const r in e.attrs)t.setAttribute(FJ.has(r)?r:SU(r),e.attrs[r])}function AU(t,e){const{style:i}=t,n={};for(const r in i)(So(i[r])||e.style&&So(e.style[r])||TJ(r,t))&&(n[r]=i[r]);return n}function UJ(t,e){const i=AU(t,e);for(const n in t)if(So(t[n])||So(e[n])){const r=Aw.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;i[r]=t[n]}return i}function MU(t,e,i,n={},r={}){return typeof e=="function"&&(e=e(i!==void 0?i:t.custom,n,r)),typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"&&(e=e(i!==void 0?i:t.custom,n,r)),e}function M0e(t){const e=ye.useRef(null);return e.current===null&&(e.current=t()),e.current}const RE=t=>Array.isArray(t),E0e=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),T0e=t=>RE(t)?t[t.length-1]||0:t;function IM(t){const e=So(t)?t.get():t;return E0e(e)?e.toValue():e}function C0e({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:i},n,r,s){const o={latestValues:P0e(n,r,s,t),renderState:e()};return i&&(o.mount=a=>i(n,a,o)),o}const kJ=t=>(e,i)=>{const n=ye.useContext(FC),r=ye.useContext(mU),s=()=>C0e(t,e,n,r);return i?s():M0e(s)};function P0e(t,e,i,n){const r={},s=n(t,{});for(const d in s)r[d]=IM(s[d]);let{initial:o,animate:a}=t;const l=kC(t),c=AJ(t);e&&c&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let h=i?i.initial===!1:!1;h=h||o===!1;const u=h?a:o;return u&&typeof u!="boolean"&&!UC(u)&&(Array.isArray(u)?u:[u]).forEach(f=>{const p=MU(t,f);if(!p)return;const{transitionEnd:m,transition:v,...g}=p;for(const y in g){let x=g[y];if(Array.isArray(x)){const b=h?x.length-1:0;x=x[b]}x!==null&&(r[y]=x)}for(const y in m)r[y]=m[y]}),r}const D0e={useVisualState:kJ({scrapeMotionValuesFromProps:UJ,createRenderState:BJ,onMount:(t,e,{renderState:i,latestValues:n})=>{try{i.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{i.dimensions={x:0,y:0,width:0,height:0}}wU(i,n,{enableHardwareAcceleration:!1},bU(e.tagName),t.transformTemplate),NJ(e,i)}})},R0e={useVisualState:kJ({scrapeMotionValuesFromProps:AU,createRenderState:_U})};function I0e(t,{forwardMotionProps:e=!1},i,n){return{...yU(t)?D0e:R0e,preloadedFeatures:i,useRender:A0e(e),createVisualElement:n,Component:t}}function Yu(t,e,i,n={passive:!0}){return t.addEventListener(e,i,n),()=>t.removeEventListener(e,i)}const zJ=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function GC(t,e="page"){return{point:{x:t[e+"X"],y:t[e+"Y"]}}}const L0e=t=>e=>zJ(e)&&t(e,GC(e));function eh(t,e,i,n){return Yu(t,e,L0e(i),n)}const B0e=(t,e)=>i=>e(t(i)),Ld=(...t)=>t.reduce(B0e);function GJ(t){let e=null;return()=>{const i=()=>{e=null};return e===null?(e=t,i):!1}}const UV=GJ("dragHorizontal"),kV=GJ("dragVertical");function HJ(t){let e=!1;if(t==="y")e=kV();else if(t==="x")e=UV();else{const i=UV(),n=kV();i&&n?e=()=>{i(),n()}:(i&&i(),n&&n())}return e}function VJ(){const t=HJ(!0);return t?(t(),!1):!0}class hf{constructor(e){this.isMounted=!1,this.node=e}update(){}}const ur=t=>t;function O0e(t){let e=[],i=[],n=0,r=!1,s=!1;const o=new WeakSet,a={schedule:(l,c=!1,h=!1)=>{const u=h&&r,d=u?e:i;return c&&o.add(l),d.indexOf(l)===-1&&(d.push(l),u&&r&&(n=e.length)),l},cancel:l=>{const c=i.indexOf(l);c!==-1&&i.splice(c,1),o.delete(l)},process:l=>{if(r){s=!0;return}if(r=!0,[e,i]=[i,e],i.length=0,n=e.length,n)for(let c=0;c<n;c++){const h=e[c];h(l),o.has(h)&&(a.schedule(h),t())}r=!1,s&&(s=!1,a.process(l))}};return a}const WS=["prepare","read","update","preRender","render","postRender"],F0e=40;function N0e(t,e){let i=!1,n=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=WS.reduce((u,d)=>(u[d]=O0e(()=>i=!0),u),{}),o=u=>s[u].process(r),a=u=>{i=!1,r.delta=n?1e3/60:Math.max(Math.min(u-r.timestamp,F0e),1),r.timestamp=u,r.isProcessing=!0,WS.forEach(o),r.isProcessing=!1,i&&e&&(n=!1,t(a))},l=()=>{i=!0,n=!0,r.isProcessing||t(a)};return{schedule:WS.reduce((u,d)=>{const f=s[d];return u[d]=(p,m=!1,v=!1)=>(i||l(),f.schedule(p,m,v)),u},{}),cancel:u=>WS.forEach(d=>s[d].cancel(u)),state:r,steps:s}}const{schedule:An,cancel:uh,state:ps,steps:qD}=N0e(typeof requestAnimationFrame<"u"?requestAnimationFrame:ur,!0);function zV(t,e){const i="pointer"+(e?"enter":"leave"),n="onHover"+(e?"Start":"End"),r=(s,o)=>{if(s.type==="touch"||VJ())return;const a=t.getProps();t.animationState&&a.whileHover&&t.animationState.setActive("whileHover",e),a[n]&&An.update(()=>a[n](s,o))};return eh(t.current,i,r,{passive:!t.getProps()[n]})}class U0e extends hf{mount(){this.unmount=Ld(zV(this.node,!0),zV(this.node,!1))}unmount(){}}class k0e extends hf{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Ld(Yu(this.node.current,"focus",()=>this.onFocus()),Yu(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const jJ=(t,e)=>e?t===e?!0:jJ(t,e.parentElement):!1;function YD(t,e){if(!e)return;const i=new PointerEvent("pointer"+t);e(i,GC(i))}class z0e extends hf{constructor(){super(...arguments),this.removeStartListeners=ur,this.removeEndListeners=ur,this.removeAccessibleListeners=ur,this.startPointerPress=(e,i)=>{if(this.removeEndListeners(),this.isPressing)return;const n=this.node.getProps(),s=eh(window,"pointerup",(a,l)=>{if(!this.checkPressEnd())return;const{onTap:c,onTapCancel:h}=this.node.getProps();An.update(()=>{jJ(this.node.current,a.target)?c&&c(a,l):h&&h(a,l)})},{passive:!(n.onTap||n.onPointerUp)}),o=eh(window,"pointercancel",(a,l)=>this.cancelPress(a,l),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=Ld(s,o),this.startPress(e,i)},this.startAccessiblePress=()=>{const e=s=>{if(s.key!=="Enter"||this.isPressing)return;const o=a=>{a.key!=="Enter"||!this.checkPressEnd()||YD("up",(l,c)=>{const{onTap:h}=this.node.getProps();h&&An.update(()=>h(l,c))})};this.removeEndListeners(),this.removeEndListeners=Yu(this.node.current,"keyup",o),YD("down",(a,l)=>{this.startPress(a,l)})},i=Yu(this.node.current,"keydown",e),n=()=>{this.isPressing&&YD("cancel",(s,o)=>this.cancelPress(s,o))},r=Yu(this.node.current,"blur",n);this.removeAccessibleListeners=Ld(i,r)}}startPress(e,i){this.isPressing=!0;const{onTapStart:n,whileTap:r}=this.node.getProps();r&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&An.update(()=>n(e,i))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!VJ()}cancelPress(e,i){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&An.update(()=>n(e,i))}mount(){const e=this.node.getProps(),i=eh(this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),n=Yu(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Ld(i,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const ZL=new WeakMap,QD=new WeakMap,G0e=t=>{const e=ZL.get(t.target);e&&e(t)},H0e=t=>{t.forEach(G0e)};function V0e({root:t,...e}){const i=t||document;QD.has(i)||QD.set(i,{});const n=QD.get(i),r=JSON.stringify(e);return n[r]||(n[r]=new IntersectionObserver(H0e,{root:t,...e})),n[r]}function j0e(t,e,i){const n=V0e(e);return ZL.set(t,i),n.observe(t),()=>{ZL.delete(t),n.unobserve(t)}}const W0e={some:0,all:1};class X0e extends hf{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:i,margin:n,amount:r="some",once:s}=e,o={root:i?i.current:void 0,rootMargin:n,threshold:typeof r=="number"?r:W0e[r]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,s&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:h,onViewportLeave:u}=this.node.getProps(),d=c?h:u;d&&d(l)};return j0e(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:i}=this.node;["amount","margin","root"].some(q0e(e,i))&&this.startObserver()}unmount(){}}function q0e({viewport:t={}},{viewport:e={}}={}){return i=>t[i]!==e[i]}const Y0e={inView:{Feature:X0e},tap:{Feature:z0e},focus:{Feature:k0e},hover:{Feature:U0e}};function WJ(t,e){if(!Array.isArray(e))return!1;const i=e.length;if(i!==t.length)return!1;for(let n=0;n<i;n++)if(e[n]!==t[n])return!1;return!0}function Q0e(t){const e={};return t.values.forEach((i,n)=>e[n]=i.get()),e}function K0e(t){const e={};return t.values.forEach((i,n)=>e[n]=i.getVelocity()),e}function HC(t,e,i){const n=t.getProps();return MU(n,e,i!==void 0?i:n.custom,Q0e(t),K0e(t))}const J0e="framerAppearId",Z0e="data-"+SU(J0e);let $0e=ur,EU=ur;const Bd=t=>t*1e3,th=t=>t/1e3,eye={current:!1},XJ=t=>Array.isArray(t)&&typeof t[0]=="number";function qJ(t){return!!(!t||typeof t=="string"&&YJ[t]||XJ(t)||Array.isArray(t)&&t.every(qJ))}const e1=([t,e,i,n])=>`cubic-bezier(${t}, ${e}, ${i}, ${n})`,YJ={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:e1([0,.65,.55,1]),circOut:e1([.55,0,1,.45]),backIn:e1([.31,.01,.66,-.59]),backOut:e1([.33,1.53,.69,.99])};function QJ(t){if(t)return XJ(t)?e1(t):Array.isArray(t)?t.map(QJ):YJ[t]}function tye(t,e,i,{delay:n=0,duration:r,repeat:s=0,repeatType:o="loop",ease:a,times:l}={}){const c={[e]:i};l&&(c.offset=l);const h=QJ(a);return Array.isArray(h)&&(c.easing=h),t.animate(c,{delay:n,duration:r,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}function iye(t,{repeat:e,repeatType:i="loop"}){const n=e&&i!=="loop"&&e%2===1?0:t.length-1;return t[n]}const KJ=(t,e,i)=>(((1-3*i+3*e)*t+(3*i-6*e))*t+3*e)*t,nye=1e-7,rye=12;function sye(t,e,i,n,r){let s,o,a=0;do o=e+(i-e)/2,s=KJ(o,n,r)-t,s>0?i=o:e=o;while(Math.abs(s)>nye&&++a<rye);return o}function Tw(t,e,i,n){if(t===e&&i===n)return ur;const r=s=>sye(s,0,1,t,i);return s=>s===0||s===1?s:KJ(r(s),e,n)}const oye=Tw(.42,0,1,1),aye=Tw(0,0,.58,1),JJ=Tw(.42,0,.58,1),lye=t=>Array.isArray(t)&&typeof t[0]!="number",ZJ=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,$J=t=>e=>1-t(1-e),eZ=t=>1-Math.sin(Math.acos(t)),TU=$J(eZ),cye=ZJ(TU),tZ=Tw(.33,1.53,.69,.99),CU=$J(tZ),uye=ZJ(CU),hye=t=>(t*=2)<1?.5*CU(t):.5*(2-Math.pow(2,-10*(t-1))),dye={linear:ur,easeIn:oye,easeInOut:JJ,easeOut:aye,circIn:eZ,circInOut:cye,circOut:TU,backIn:CU,backInOut:uye,backOut:tZ,anticipate:hye},GV=t=>{if(Array.isArray(t)){EU(t.length===4);const[e,i,n,r]=t;return Tw(e,i,n,r)}else if(typeof t=="string")return dye[t];return t},PU=(t,e)=>i=>!!(Mw(i)&&u0e.test(i)&&i.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(i,e)),iZ=(t,e,i)=>n=>{if(!Mw(n))return n;const[r,s,o,a]=n.match(zC);return{[t]:parseFloat(r),[e]:parseFloat(s),[i]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},fye=t=>Jd(0,255,t),KD={...xm,transform:t=>Math.round(fye(t))},wp={test:PU("rgb","red"),parse:iZ("red","green","blue"),transform:({red:t,green:e,blue:i,alpha:n=1})=>"rgba("+KD.transform(t)+", "+KD.transform(e)+", "+KD.transform(i)+", "+D1(P1.transform(n))+")"};function pye(t){let e="",i="",n="",r="";return t.length>5?(e=t.substring(1,3),i=t.substring(3,5),n=t.substring(5,7),r=t.substring(7,9)):(e=t.substring(1,2),i=t.substring(2,3),n=t.substring(3,4),r=t.substring(4,5),e+=e,i+=i,n+=n,r+=r),{red:parseInt(e,16),green:parseInt(i,16),blue:parseInt(n,16),alpha:r?parseInt(r,16)/255:1}}const $L={test:PU("#"),parse:pye,transform:wp.transform},vv={test:PU("hsl","hue"),parse:iZ("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:i,alpha:n=1})=>"hsla("+Math.round(t)+", "+zc.transform(D1(e))+", "+zc.transform(D1(i))+", "+D1(P1.transform(n))+")"},Ns={test:t=>wp.test(t)||$L.test(t)||vv.test(t),parse:t=>wp.test(t)?wp.parse(t):vv.test(t)?vv.parse(t):$L.parse(t),transform:t=>Mw(t)?t:t.hasOwnProperty("red")?wp.transform(t):vv.transform(t)},wn=(t,e,i)=>-i*t+i*e+t;function JD(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+(e-t)*6*i:i<1/2?e:i<2/3?t+(e-t)*(2/3-i)*6:t}function mye({hue:t,saturation:e,lightness:i,alpha:n}){t/=360,e/=100,i/=100;let r=0,s=0,o=0;if(!e)r=s=o=i;else{const a=i<.5?i*(1+e):i+e-i*e,l=2*i-a;r=JD(l,a,t+1/3),s=JD(l,a,t),o=JD(l,a,t-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:n}}const ZD=(t,e,i)=>{const n=t*t;return Math.sqrt(Math.max(0,i*(e*e-n)+n))},gye=[$L,wp,vv],vye=t=>gye.find(e=>e.test(t));function HV(t){const e=vye(t);let i=e.parse(t);return e===vv&&(i=mye(i)),i}const nZ=(t,e)=>{const i=HV(t),n=HV(e),r={...i};return s=>(r.red=ZD(i.red,n.red,s),r.green=ZD(i.green,n.green,s),r.blue=ZD(i.blue,n.blue,s),r.alpha=wn(i.alpha,n.alpha,s),wp.transform(r))};function yye(t){var e,i;return isNaN(t)&&Mw(t)&&(((e=t.match(zC))===null||e===void 0?void 0:e.length)||0)+(((i=t.match(DJ))===null||i===void 0?void 0:i.length)||0)>0}const rZ={regex:l0e,countKey:"Vars",token:"${v}",parse:ur},sZ={regex:DJ,countKey:"Colors",token:"${c}",parse:Ns.parse},oZ={regex:zC,countKey:"Numbers",token:"${n}",parse:xm.parse};function $D(t,{regex:e,countKey:i,token:n,parse:r}){const s=t.tokenised.match(e);s&&(t["num"+i]=s.length,t.tokenised=t.tokenised.replace(e,n),t.values.push(...s.map(r)))}function IE(t){const e=t.toString(),i={value:e,tokenised:e,values:[],numVars:0,numColors:0,numNumbers:0};return i.value.includes("var(--")&&$D(i,rZ),$D(i,sZ),$D(i,oZ),i}function aZ(t){return IE(t).values}function lZ(t){const{values:e,numColors:i,numVars:n,tokenised:r}=IE(t),s=e.length;return o=>{let a=r;for(let l=0;l<s;l++)l<n?a=a.replace(rZ.token,o[l]):l<n+i?a=a.replace(sZ.token,Ns.transform(o[l])):a=a.replace(oZ.token,D1(o[l]));return a}}const xye=t=>typeof t=="number"?0:t;function _ye(t){const e=aZ(t);return lZ(t)(e.map(xye))}const Zd={test:yye,parse:aZ,createTransformer:lZ,getAnimatableNone:_ye},cZ=(t,e)=>i=>`${i>0?e:t}`;function uZ(t,e){return typeof t=="number"?i=>wn(t,e,i):Ns.test(t)?nZ(t,e):t.startsWith("var(")?cZ(t,e):dZ(t,e)}const hZ=(t,e)=>{const i=[...t],n=i.length,r=t.map((s,o)=>uZ(s,e[o]));return s=>{for(let o=0;o<n;o++)i[o]=r[o](s);return i}},wye=(t,e)=>{const i={...t,...e},n={};for(const r in i)t[r]!==void 0&&e[r]!==void 0&&(n[r]=uZ(t[r],e[r]));return r=>{for(const s in n)i[s]=n[s](r);return i}},dZ=(t,e)=>{const i=Zd.createTransformer(e),n=IE(t),r=IE(e);return n.numVars===r.numVars&&n.numColors===r.numColors&&n.numNumbers>=r.numNumbers?Ld(hZ(n.values,r.values),i):cZ(t,e)},D_=(t,e,i)=>{const n=e-t;return n===0?1:(i-t)/n},VV=(t,e)=>i=>wn(t,e,i);function bye(t){return typeof t=="number"?VV:typeof t=="string"?Ns.test(t)?nZ:dZ:Array.isArray(t)?hZ:typeof t=="object"?wye:VV}function Sye(t,e,i){const n=[],r=i||bye(t[0]),s=t.length-1;for(let o=0;o<s;o++){let a=r(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||ur:e;a=Ld(l,a)}n.push(a)}return n}function fZ(t,e,{clamp:i=!0,ease:n,mixer:r}={}){const s=t.length;if(EU(s===e.length),s===1)return()=>e[0];t[0]>t[s-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=Sye(e,n,r),a=o.length,l=c=>{let h=0;if(a>1)for(;h<t.length-2&&!(c<t[h+1]);h++);const u=D_(t[h],t[h+1],c);return o[h](u)};return i?c=>l(Jd(t[0],t[s-1],c)):l}function Aye(t,e){const i=t[t.length-1];for(let n=1;n<=e;n++){const r=D_(0,e,n);t.push(wn(i,1,r))}}function Mye(t){const e=[0];return Aye(e,t.length-1),e}function Eye(t,e){return t.map(i=>i*e)}function Tye(t,e){return t.map(()=>e||JJ).splice(0,t.length-1)}function LE({duration:t=300,keyframes:e,times:i,ease:n="easeInOut"}){const r=lye(n)?n.map(GV):GV(n),s={done:!1,value:e[0]},o=Eye(i&&i.length===e.length?i:Mye(e),t),a=fZ(o,e,{ease:Array.isArray(r)?r:Tye(e,r)});return{calculatedDuration:t,next:l=>(s.value=a(l),s.done=l>=t,s)}}function pZ(t,e){return e?t*(1e3/e):0}const Cye=5;function mZ(t,e,i){const n=Math.max(e-Cye,0);return pZ(i-t(n),e-n)}const eR=.001,Pye=.01,jV=10,Dye=.05,Rye=1;function Iye({duration:t=800,bounce:e=.25,velocity:i=0,mass:n=1}){let r,s;$0e(t<=Bd(jV));let o=1-e;o=Jd(Dye,Rye,o),t=Jd(Pye,jV,th(t)),o<1?(r=c=>{const h=c*o,u=h*t,d=h-i,f=eB(c,o),p=Math.exp(-u);return eR-d/f*p},s=c=>{const u=c*o*t,d=u*i+i,f=Math.pow(o,2)*Math.pow(c,2)*t,p=Math.exp(-u),m=eB(Math.pow(c,2),o);return(-r(c)+eR>0?-1:1)*((d-f)*p)/m}):(r=c=>{const h=Math.exp(-c*t),u=(c-i)*t+1;return-eR+h*u},s=c=>{const h=Math.exp(-c*t),u=(i-c)*(t*t);return h*u});const a=5/t,l=Bye(r,s,a);if(t=Bd(t),isNaN(l))return{stiffness:100,damping:10,duration:t};{const c=Math.pow(l,2)*n;return{stiffness:c,damping:o*2*Math.sqrt(n*c),duration:t}}}const Lye=12;function Bye(t,e,i){let n=i;for(let r=1;r<Lye;r++)n=n-t(n)/e(n);return n}function eB(t,e){return t*Math.sqrt(1-e*e)}const Oye=["duration","bounce"],Fye=["stiffness","damping","mass"];function WV(t,e){return e.some(i=>t[i]!==void 0)}function Nye(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!WV(t,Fye)&&WV(t,Oye)){const i=Iye(t);e={...e,...i,velocity:0,mass:1},e.isResolvedFromDuration=!0}return e}function gZ({keyframes:t,restDelta:e,restSpeed:i,...n}){const r=t[0],s=t[t.length-1],o={done:!1,value:r},{stiffness:a,damping:l,mass:c,velocity:h,duration:u,isResolvedFromDuration:d}=Nye(n),f=h?-th(h):0,p=l/(2*Math.sqrt(a*c)),m=s-r,v=th(Math.sqrt(a/c)),g=Math.abs(m)<5;i||(i=g?.01:2),e||(e=g?.005:.5);let y;if(p<1){const x=eB(v,p);y=b=>{const S=Math.exp(-p*v*b);return s-S*((f+p*v*m)/x*Math.sin(x*b)+m*Math.cos(x*b))}}else if(p===1)y=x=>s-Math.exp(-v*x)*(m+(f+v*m)*x);else{const x=v*Math.sqrt(p*p-1);y=b=>{const S=Math.exp(-p*v*b),A=Math.min(x*b,300);return s-S*((f+p*v*m)*Math.sinh(A)+x*m*Math.cosh(A))/x}}return{calculatedDuration:d&&u||null,next:x=>{const b=y(x);if(d)o.done=x>=u;else{let S=f;x!==0&&(p<1?S=mZ(y,x,b):S=0);const A=Math.abs(S)<=i,E=Math.abs(s-b)<=e;o.done=A&&E}return o.value=o.done?s:b,o}}}function XV({keyframes:t,velocity:e=0,power:i=.8,timeConstant:n=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:h}){const u=t[0],d={done:!1,value:u},f=M=>a!==void 0&&M<a||l!==void 0&&M>l,p=M=>a===void 0?l:l===void 0||Math.abs(a-M)<Math.abs(l-M)?a:l;let m=i*e;const v=u+m,g=o===void 0?v:o(v);g!==v&&(m=g-u);const y=M=>-m*Math.exp(-M/n),x=M=>g+y(M),b=M=>{const T=y(M),P=x(M);d.done=Math.abs(T)<=c,d.value=d.done?g:P};let S,A;const E=M=>{f(d.value)&&(S=M,A=gZ({keyframes:[d.value,p(d.value)],velocity:mZ(x,M,d.value),damping:r,stiffness:s,restDelta:c,restSpeed:h}))};return E(0),{calculatedDuration:null,next:M=>{let T=!1;return!A&&S===void 0&&(T=!0,b(M),E(M)),S!==void 0&&M>S?A.next(M-S):(!T&&b(M),d)}}}const Uye=t=>{const e=({timestamp:i})=>t(i);return{start:()=>An.update(e,!0),stop:()=>uh(e),now:()=>ps.isProcessing?ps.timestamp:performance.now()}},qV=2e4;function YV(t){let e=0;const i=50;let n=t.next(e);for(;!n.done&&e<qV;)e+=i,n=t.next(e);return e>=qV?1/0:e}const kye={decay:XV,inertia:XV,tween:LE,keyframes:LE,spring:gZ};function BE({autoplay:t=!0,delay:e=0,driver:i=Uye,keyframes:n,type:r="keyframes",repeat:s=0,repeatDelay:o=0,repeatType:a="loop",onPlay:l,onStop:c,onComplete:h,onUpdate:u,...d}){let f=1,p=!1,m,v;const g=()=>{v=new Promise(k=>{m=k})};g();let y;const x=kye[r]||LE;let b;x!==LE&&typeof n[0]!="number"&&(b=fZ([0,100],n,{clamp:!1}),n=[0,100]);const S=x({...d,keyframes:n});let A;a==="mirror"&&(A=x({...d,keyframes:[...n].reverse(),velocity:-(d.velocity||0)}));let E="idle",M=null,T=null,P=null;S.calculatedDuration===null&&s&&(S.calculatedDuration=YV(S));const{calculatedDuration:R}=S;let U=1/0,F=1/0;R!==null&&(U=R+o,F=U*(s+1)-o);let N=0;const W=k=>{if(T===null)return;f>0&&(T=Math.min(T,k)),f<0&&(T=Math.min(k-F/f,T)),M!==null?N=M:N=Math.round(k-T)*f;const G=N-e*(f>=0?1:-1),Z=f>=0?G<0:G>F;N=Math.max(G,0),E==="finished"&&M===null&&(N=F);let K=N,re=S;if(s){const fe=N/U;let ge=Math.floor(fe),ve=fe%1;!ve&&fe>=1&&(ve=1),ve===1&&ge--,ge=Math.min(ge,s+1);const Y=!!(ge%2);Y&&(a==="reverse"?(ve=1-ve,o&&(ve-=o/U)):a==="mirror"&&(re=A));let ce=Jd(0,1,ve);N>F&&(ce=a==="reverse"&&Y?1:0),K=ce*U}const J=Z?{done:!1,value:n[0]}:re.next(K);b&&(J.value=b(J.value));let{done:le}=J;!Z&&R!==null&&(le=f>=0?N>=F:N<=0);const ae=M===null&&(E==="finished"||E==="running"&&le);return u&&u(J.value),ae&&B(),J},Q=()=>{y&&y.stop(),y=void 0},X=()=>{E="idle",Q(),m(),g(),T=P=null},B=()=>{E="finished",h&&h(),Q(),m()},j=()=>{if(p)return;y||(y=i(W));const k=y.now();l&&l(),M!==null?T=k-M:(!T||E==="finished")&&(T=k),E==="finished"&&g(),P=T,M=null,E="running",y.start()};t&&j();const z={then(k,G){return v.then(k,G)},get time(){return th(N)},set time(k){k=Bd(k),N=k,M!==null||!y||f===0?M=k:T=y.now()-k/f},get duration(){const k=S.calculatedDuration===null?YV(S):S.calculatedDuration;return th(k)},get speed(){return f},set speed(k){k===f||!y||(f=k,z.time=th(N))},get state(){return E},play:j,pause:()=>{E="paused",M=N},stop:()=>{p=!0,E!=="idle"&&(E="idle",c&&c(),X())},cancel:()=>{P!==null&&W(P),X()},complete:()=>{E="finished"},sample:k=>(T=0,W(k))};return z}function zye(t){let e;return()=>(e===void 0&&(e=t()),e)}const Gye=zye(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Hye=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),XS=10,Vye=2e4,jye=(t,e)=>e.type==="spring"||t==="backgroundColor"||!qJ(e.ease);function Wye(t,e,{onUpdate:i,onComplete:n,...r}){if(!(Gye()&&Hye.has(e)&&!r.repeatDelay&&r.repeatType!=="mirror"&&r.damping!==0&&r.type!=="inertia"))return!1;let o=!1,a,l;const c=()=>{l=new Promise(g=>{a=g})};c();let{keyframes:h,duration:u=300,ease:d,times:f}=r;if(jye(e,r)){const g=BE({...r,repeat:0,delay:0});let y={done:!1,value:h[0]};const x=[];let b=0;for(;!y.done&&b<Vye;)y=g.sample(b),x.push(y.value),b+=XS;f=void 0,h=x,u=b-XS,d="linear"}const p=tye(t.owner.current,e,h,{...r,duration:u,ease:d,times:f}),m=()=>p.cancel(),v=()=>{An.update(m),a(),c()};return p.onfinish=()=>{t.set(iye(h,r)),n&&n(),v()},{then(g,y){return l.then(g,y)},get timeline(){return p.timeline},set timeline(g){p.timeline=g,p.onfinish=null},get time(){return th(p.currentTime||0)},set time(g){p.currentTime=Bd(g)},get speed(){return p.playbackRate},set speed(g){p.playbackRate=g},get duration(){return th(u)},play:()=>{o||(p.play(),uh(m))},pause:()=>p.pause(),stop:()=>{if(o=!0,p.playState==="idle")return;const{currentTime:g}=p;if(g){const y=BE({...r,autoplay:!1});t.setWithVelocity(y.sample(g-XS).value,y.sample(g).value,XS)}v()},complete:()=>p.finish(),cancel:v}}function Xye({keyframes:t,delay:e,onUpdate:i,onComplete:n}){const r=()=>(i&&i(t[t.length-1]),n&&n(),{time:0,speed:1,duration:0,play:ur,pause:ur,stop:ur,then:s=>(s(),Promise.resolve()),cancel:ur,complete:ur});return e?BE({keyframes:[0,1],duration:0,delay:e,onComplete:r}):r()}const qye={type:"spring",stiffness:500,damping:25,restSpeed:10},Yye=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),Qye={type:"keyframes",duration:.8},Kye={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Jye=(t,{keyframes:e})=>e.length>2?Qye:ym.has(t)?t.startsWith("scale")?Yye(e[1]):qye:Kye,tB=(t,e)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Zd.test(e)||e==="0")&&!e.startsWith("url(")),Zye=new Set(["brightness","contrast","saturate","opacity"]);function $ye(t){const[e,i]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=i.match(zC)||[];if(!n)return t;const r=i.replace(n,"");let s=Zye.has(e)?1:0;return n!==i&&(s*=100),e+"("+s+r+")"}const exe=/([a-z-]*)\(.*?\)/g,iB={...Zd,getAnimatableNone:t=>{const e=t.match(exe);return e?e.map($ye).join(" "):t}},txe={...RJ,color:Ns,backgroundColor:Ns,outlineColor:Ns,fill:Ns,stroke:Ns,borderColor:Ns,borderTopColor:Ns,borderRightColor:Ns,borderBottomColor:Ns,borderLeftColor:Ns,filter:iB,WebkitFilter:iB},DU=t=>txe[t];function vZ(t,e){let i=DU(t);return i!==iB&&(i=Zd),i.getAnimatableNone?i.getAnimatableNone(e):void 0}const yZ=t=>/^0[^.\s]+$/.test(t);function ixe(t){if(typeof t=="number")return t===0;if(t!==null)return t==="none"||t==="0"||yZ(t)}function nxe(t,e,i,n){const r=tB(e,i);let s;Array.isArray(i)?s=[...i]:s=[null,i];const o=n.from!==void 0?n.from:t.get();let a;const l=[];for(let c=0;c<s.length;c++)s[c]===null&&(s[c]=c===0?o:s[c-1]),ixe(s[c])&&l.push(c),typeof s[c]=="string"&&s[c]!=="none"&&s[c]!=="0"&&(a=s[c]);if(r&&l.length&&a)for(let c=0;c<l.length;c++){const h=l[c];s[h]=vZ(e,a)}return s}function rxe({when:t,delay:e,delayChildren:i,staggerChildren:n,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:a,from:l,elapsed:c,...h}){return!!Object.keys(h).length}function xZ(t,e){return t[e]||t.default||t}const RU=(t,e,i,n={})=>r=>{const s=xZ(n,t)||{},o=s.delay||n.delay||0;let{elapsed:a=0}=n;a=a-Bd(o);const l=nxe(e,t,i,s),c=l[0],h=l[l.length-1],u=tB(t,c),d=tB(t,h);let f={keyframes:l,velocity:e.getVelocity(),ease:"easeOut",...s,delay:-a,onUpdate:p=>{e.set(p),s.onUpdate&&s.onUpdate(p)},onComplete:()=>{r(),s.onComplete&&s.onComplete()}};if(rxe(s)||(f={...f,...Jye(t,f)}),f.duration&&(f.duration=Bd(f.duration)),f.repeatDelay&&(f.repeatDelay=Bd(f.repeatDelay)),!u||!d||eye.current||s.type===!1)return Xye(f);if(e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const p=Wye(e,t,f);if(p)return p}return BE(f)};function OE(t){return!!(So(t)&&t.add)}const sxe=t=>/^\-?\d*\.?\d+$/.test(t);function IU(t,e){t.indexOf(e)===-1&&t.push(e)}function LU(t,e){const i=t.indexOf(e);i>-1&&t.splice(i,1)}class BU{constructor(){this.subscriptions=[]}add(e){return IU(this.subscriptions,e),()=>LU(this.subscriptions,e)}notify(e,i,n){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,i,n);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,i,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const oxe=t=>!isNaN(parseFloat(t));class axe{constructor(e,i={}){this.version="10.13.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,r=!0)=>{this.prev=this.current,this.current=n;const{delta:s,timestamp:o}=ps;this.lastUpdated!==o&&(this.timeDelta=s,this.lastUpdated=o,An.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>An.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=oxe(this.current),this.owner=i.owner}onChange(e){return this.on("change",e)}on(e,i){this.events[e]||(this.events[e]=new BU);const n=this.events[e].add(i);return e==="change"?()=>{n(),An.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,i){this.passiveEffect=e,this.stopPassiveEffect=i}set(e,i=!0){!i||!this.passiveEffect?this.updateAndNotify(e,i):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,i,n){this.set(i),this.prev=e,this.timeDelta=n}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?pZ(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(i=>{this.hasAnimated=!0,this.animation=e(i),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function S0(t,e){return new axe(t,e)}const _Z=t=>e=>e.test(t),lxe={test:t=>t==="auto",parse:t=>t},wZ=[xm,zt,zc,Kh,d0e,h0e,lxe],px=t=>wZ.find(_Z(t)),cxe=[...wZ,Ns,Zd],uxe=t=>cxe.find(_Z(t));function hxe(t,e,i){t.hasValue(e)?t.getValue(e).set(i):t.addValue(e,S0(i))}function dxe(t,e){const i=HC(t,e);let{transitionEnd:n={},transition:r={},...s}=i?t.makeTargetAnimatable(i,!1):{};s={...s,...n};for(const o in s){const a=T0e(s[o]);hxe(t,o,a)}}function fxe(t,e,i){var n,r;const s=Object.keys(e).filter(a=>!t.hasValue(a)),o=s.length;if(o)for(let a=0;a<o;a++){const l=s[a],c=e[l];let h=null;Array.isArray(c)&&(h=c[0]),h===null&&(h=(r=(n=i[l])!==null&&n!==void 0?n:t.readValue(l))!==null&&r!==void 0?r:e[l]),h!=null&&(typeof h=="string"&&(sxe(h)||yZ(h))?h=parseFloat(h):!uxe(h)&&Zd.test(c)&&(h=vZ(l,c)),t.addValue(l,S0(h,{owner:t})),i[l]===void 0&&(i[l]=h),h!==null&&t.setBaseTarget(l,h))}}function pxe(t,e){return e?(e[t]||e.default||e).from:void 0}function mxe(t,e,i){const n={};for(const r in t){const s=pxe(r,e);if(s!==void 0)n[r]=s;else{const o=i.getValue(r);o&&(n[r]=o.get())}}return n}function gxe({protectedKeys:t,needsAnimating:e},i){const n=t.hasOwnProperty(i)&&e[i]!==!0;return e[i]=!1,n}function bZ(t,e,{delay:i=0,transitionOverride:n,type:r}={}){let{transition:s=t.getDefaultTransition(),transitionEnd:o,...a}=t.makeTargetAnimatable(e);const l=t.getValue("willChange");n&&(s=n);const c=[],h=r&&t.animationState&&t.animationState.getState()[r];for(const u in a){const d=t.getValue(u),f=a[u];if(!d||f===void 0||h&&gxe(h,u))continue;const p={delay:i,elapsed:0,...s};if(window.HandoffAppearAnimations&&!d.hasAnimated){const v=t.getProps()[Z0e];v&&(p.elapsed=window.HandoffAppearAnimations(v,u,d,An))}d.start(RU(u,d,f,t.shouldReduceMotion&&ym.has(u)?{type:!1}:p));const m=d.animation;OE(l)&&(l.add(u),m.then(()=>l.remove(u))),c.push(m)}return o&&Promise.all(c).then(()=>{o&&dxe(t,o)}),c}function nB(t,e,i={}){const n=HC(t,e,i.custom);let{transition:r=t.getDefaultTransition()||{}}=n||{};i.transitionOverride&&(r=i.transitionOverride);const s=n?()=>Promise.all(bZ(t,n,i)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(l=0)=>{const{delayChildren:c=0,staggerChildren:h,staggerDirection:u}=r;return vxe(t,e,c+l,h,u,i)}:()=>Promise.resolve(),{when:a}=r;if(a){const[l,c]=a==="beforeChildren"?[s,o]:[o,s];return l().then(()=>c())}else return Promise.all([s(),o(i.delay)])}function vxe(t,e,i=0,n=0,r=1,s){const o=[],a=(t.variantChildren.size-1)*n,l=r===1?(c=0)=>c*n:(c=0)=>a-c*n;return Array.from(t.variantChildren).sort(yxe).forEach((c,h)=>{c.notify("AnimationStart",e),o.push(nB(c,e,{...s,delay:i+l(h)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(o)}function yxe(t,e){return t.sortNodePosition(e)}function xxe(t,e,i={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const r=e.map(s=>nB(t,s,i));n=Promise.all(r)}else if(typeof e=="string")n=nB(t,e,i);else{const r=typeof e=="function"?HC(t,e,i.custom):e;n=Promise.all(bZ(t,r,i))}return n.then(()=>t.notify("AnimationComplete",e))}const _xe=[...gU].reverse(),wxe=gU.length;function bxe(t){return e=>Promise.all(e.map(({animation:i,options:n})=>xxe(t,i,n)))}function Sxe(t){let e=bxe(t);const i=Mxe();let n=!0;const r=(l,c)=>{const h=HC(t,c);if(h){const{transition:u,transitionEnd:d,...f}=h;l={...l,...f,...d}}return l};function s(l){e=l(t)}function o(l,c){const h=t.getProps(),u=t.getVariantContext(!0)||{},d=[],f=new Set;let p={},m=1/0;for(let g=0;g<wxe;g++){const y=_xe[g],x=i[y],b=h[y]!==void 0?h[y]:u[y],S=C_(b),A=y===c?x.isActive:null;A===!1&&(m=g);let E=b===u[y]&&b!==h[y]&&S;if(E&&n&&t.manuallyAnimateOnMount&&(E=!1),x.protectedKeys={...p},!x.isActive&&A===null||!b&&!x.prevProp||UC(b)||typeof b=="boolean")continue;const M=Axe(x.prevProp,b);let T=M||y===c&&x.isActive&&!E&&S||g>m&&S;const P=Array.isArray(b)?b:[b];let R=P.reduce(r,{});A===!1&&(R={});const{prevResolvedValues:U={}}=x,F={...U,...R},N=W=>{T=!0,f.delete(W),x.needsAnimating[W]=!0};for(const W in F){const Q=R[W],X=U[W];p.hasOwnProperty(W)||(Q!==X?RE(Q)&&RE(X)?!WJ(Q,X)||M?N(W):x.protectedKeys[W]=!0:Q!==void 0?N(W):f.add(W):Q!==void 0&&f.has(W)?N(W):x.protectedKeys[W]=!0)}x.prevProp=b,x.prevResolvedValues=R,x.isActive&&(p={...p,...R}),n&&t.blockInitialAnimation&&(T=!1),T&&!E&&d.push(...P.map(W=>({animation:W,options:{type:y,...l}})))}if(f.size){const g={};f.forEach(y=>{const x=t.getBaseTarget(y);x!==void 0&&(g[y]=x)}),d.push({animation:g})}let v=!!d.length;return n&&h.initial===!1&&!t.manuallyAnimateOnMount&&(v=!1),n=!1,v?e(d):Promise.resolve()}function a(l,c,h){var u;if(i[l].isActive===c)return Promise.resolve();(u=t.variantChildren)===null||u===void 0||u.forEach(f=>{var p;return(p=f.animationState)===null||p===void 0?void 0:p.setActive(l,c)}),i[l].isActive=c;const d=o(h,l);for(const f in i)i[f].protectedKeys={};return d}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>i}}function Axe(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!WJ(e,t):!1}function Ff(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Mxe(){return{animate:Ff(!0),whileInView:Ff(),whileHover:Ff(),whileTap:Ff(),whileDrag:Ff(),whileFocus:Ff(),exit:Ff()}}class Exe extends hf{constructor(e){super(e),e.animationState||(e.animationState=Sxe(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),UC(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:i}=this.node.prevProps||{};e!==i&&this.updateAnimationControlsSubscription()}unmount(){}}let Txe=0;class Cxe extends hf{constructor(){super(...arguments),this.id=Txe++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:i,custom:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const s=this.node.animationState.setActive("exit",!e,{custom:n??this.node.getProps().custom});i&&!e&&s.then(()=>i(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Pxe={animation:{Feature:Exe},exit:{Feature:Cxe}},QV=(t,e)=>Math.abs(t-e);function Dxe(t,e){const i=QV(t.x,e.x),n=QV(t.y,e.y);return Math.sqrt(i**2+n**2)}class SZ{constructor(e,i,{transformPagePoint:n}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const c=iR(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,u=Dxe(c.offset,{x:0,y:0})>=3;if(!h&&!u)return;const{point:d}=c,{timestamp:f}=ps;this.history.push({...d,timestamp:f});const{onStart:p,onMove:m}=this.handlers;h||(p&&p(this.lastMoveEvent,c),this.startEvent=this.lastMoveEvent),m&&m(this.lastMoveEvent,c)},this.handlePointerMove=(c,h)=>{this.lastMoveEvent=c,this.lastMoveEventInfo=tR(h,this.transformPagePoint),An.update(this.updatePoint,!0)},this.handlePointerUp=(c,h)=>{if(this.end(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const{onEnd:u,onSessionEnd:d}=this.handlers,f=iR(c.type==="pointercancel"?this.lastMoveEventInfo:tR(h,this.transformPagePoint),this.history);this.startEvent&&u&&u(c,f),d&&d(c,f)},!zJ(e))return;this.handlers=i,this.transformPagePoint=n;const r=GC(e),s=tR(r,this.transformPagePoint),{point:o}=s,{timestamp:a}=ps;this.history=[{...o,timestamp:a}];const{onSessionStart:l}=i;l&&l(e,iR(s,this.history)),this.removeListeners=Ld(eh(window,"pointermove",this.handlePointerMove),eh(window,"pointerup",this.handlePointerUp),eh(window,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),uh(this.updatePoint)}}function tR(t,e){return e?{point:e(t.point)}:t}function KV(t,e){return{x:t.x-e.x,y:t.y-e.y}}function iR({point:t},e){return{point:t,delta:KV(t,AZ(e)),offset:KV(t,Rxe(e)),velocity:Ixe(e,.1)}}function Rxe(t){return t[0]}function AZ(t){return t[t.length-1]}function Ixe(t,e){if(t.length<2)return{x:0,y:0};let i=t.length-1,n=null;const r=AZ(t);for(;i>=0&&(n=t[i],!(r.timestamp-n.timestamp>Bd(e)));)i--;if(!n)return{x:0,y:0};const s=th(r.timestamp-n.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-n.x)/s,y:(r.y-n.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function na(t){return t.max-t.min}function rB(t,e=0,i=.01){return Math.abs(t-e)<=i}function JV(t,e,i,n=.5){t.origin=n,t.originPoint=wn(e.min,e.max,t.origin),t.scale=na(i)/na(e),(rB(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=wn(i.min,i.max,t.origin)-t.originPoint,(rB(t.translate)||isNaN(t.translate))&&(t.translate=0)}function R1(t,e,i,n){JV(t.x,e.x,i.x,n?n.originX:void 0),JV(t.y,e.y,i.y,n?n.originY:void 0)}function ZV(t,e,i){t.min=i.min+e.min,t.max=t.min+na(e)}function Lxe(t,e,i){ZV(t.x,e.x,i.x),ZV(t.y,e.y,i.y)}function $V(t,e,i){t.min=e.min-i.min,t.max=t.min+na(e)}function I1(t,e,i){$V(t.x,e.x,i.x),$V(t.y,e.y,i.y)}function Bxe(t,{min:e,max:i},n){return e!==void 0&&t<e?t=n?wn(e,t,n.min):Math.max(t,e):i!==void 0&&t>i&&(t=n?wn(i,t,n.max):Math.min(t,i)),t}function ej(t,e,i){return{min:e!==void 0?t.min+e:void 0,max:i!==void 0?t.max+i-(t.max-t.min):void 0}}function Oxe(t,{top:e,left:i,bottom:n,right:r}){return{x:ej(t.x,i,r),y:ej(t.y,e,n)}}function tj(t,e){let i=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([i,n]=[n,i]),{min:i,max:n}}function Fxe(t,e){return{x:tj(t.x,e.x),y:tj(t.y,e.y)}}function Nxe(t,e){let i=.5;const n=na(t),r=na(e);return r>n?i=D_(e.min,e.max-n,t.min):n>r&&(i=D_(t.min,t.max-r,e.min)),Jd(0,1,i)}function Uxe(t,e){const i={};return e.min!==void 0&&(i.min=e.min-t.min),e.max!==void 0&&(i.max=e.max-t.min),i}const sB=.35;function kxe(t=sB){return t===!1?t=0:t===!0&&(t=sB),{x:ij(t,"left","right"),y:ij(t,"top","bottom")}}function ij(t,e,i){return{min:nj(t,e),max:nj(t,i)}}function nj(t,e){return typeof t=="number"?t:t[e]||0}const rj=()=>({translate:0,scale:1,origin:0,originPoint:0}),yv=()=>({x:rj(),y:rj()}),sj=()=>({min:0,max:0}),sr=()=>({x:sj(),y:sj()});function xc(t){return[t("x"),t("y")]}function MZ({top:t,left:e,right:i,bottom:n}){return{x:{min:e,max:i},y:{min:t,max:n}}}function zxe({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function Gxe(t,e){if(!e)return t;const i=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:i.y,left:i.x,bottom:n.y,right:n.x}}function nR(t){return t===void 0||t===1}function oB({scale:t,scaleX:e,scaleY:i}){return!nR(t)||!nR(e)||!nR(i)}function Zf(t){return oB(t)||EZ(t)||t.z||t.rotate||t.rotateX||t.rotateY}function EZ(t){return oj(t.x)||oj(t.y)}function oj(t){return t&&t!=="0%"}function FE(t,e,i){const n=t-i,r=e*n;return i+r}function aj(t,e,i,n,r){return r!==void 0&&(t=FE(t,r,n)),FE(t,i,n)+e}function aB(t,e=0,i=1,n,r){t.min=aj(t.min,e,i,n,r),t.max=aj(t.max,e,i,n,r)}function TZ(t,{x:e,y:i}){aB(t.x,e.translate,e.scale,e.originPoint),aB(t.y,i.translate,i.scale,i.originPoint)}function Hxe(t,e,i,n=!1){const r=i.length;if(!r)return;e.x=e.y=1;let s,o;for(let a=0;a<r;a++){s=i[a],o=s.projectionDelta;const l=s.instance;l&&l.style&&l.style.display==="contents"||(n&&s.options.layoutScroll&&s.scroll&&s!==s.root&&xv(t,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,TZ(t,o)),n&&Zf(s.latestValues)&&xv(t,s.latestValues))}e.x=lj(e.x),e.y=lj(e.y)}function lj(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function id(t,e){t.min=t.min+e,t.max=t.max+e}function cj(t,e,[i,n,r]){const s=e[r]!==void 0?e[r]:.5,o=wn(t.min,t.max,s);aB(t,e[i],e[n],o,e.scale)}const Vxe=["x","scaleX","originX"],jxe=["y","scaleY","originY"];function xv(t,e){cj(t.x,e,Vxe),cj(t.y,e,jxe)}function CZ(t,e){return MZ(Gxe(t.getBoundingClientRect(),e))}function Wxe(t,e,i){const n=CZ(t,i),{scroll:r}=e;return r&&(id(n.x,r.offset.x),id(n.y,r.offset.y)),n}const Xxe=new WeakMap;class qxe{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=sr(),this.visualElement=e}start(e,{snapToCursor:i=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const r=l=>{this.stopAnimation(),i&&this.snapToCursor(GC(l,"page").point)},s=(l,c)=>{const{drag:h,dragPropagation:u,onDragStart:d}=this.getProps();if(h&&!u&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=HJ(h),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),xc(p=>{let m=this.getAxisMotionValue(p).get()||0;if(zc.test(m)){const{projection:v}=this.visualElement;if(v&&v.layout){const g=v.layout.layoutBox[p];g&&(m=na(g)*(parseFloat(m)/100))}}this.originPoint[p]=m}),d&&An.update(()=>d(l,c),!1,!0);const{animationState:f}=this.visualElement;f&&f.setActive("whileDrag",!0)},o=(l,c)=>{const{dragPropagation:h,dragDirectionLock:u,onDirectionLock:d,onDrag:f}=this.getProps();if(!h&&!this.openGlobalLock)return;const{offset:p}=c;if(u&&this.currentDirection===null){this.currentDirection=Yxe(p),this.currentDirection!==null&&d&&d(this.currentDirection);return}this.updateAxis("x",c.point,p),this.updateAxis("y",c.point,p),this.visualElement.render(),f&&f(l,c)},a=(l,c)=>this.stop(l,c);this.panSession=new SZ(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:a},{transformPagePoint:this.visualElement.getTransformPagePoint()})}stop(e,i){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:r}=i;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&An.update(()=>s(e,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:i}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),i&&i.setActive("whileDrag",!1)}updateAxis(e,i,n){const{drag:r}=this.getProps();if(!n||!qS(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(o=Bxe(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:i}=this.getProps(),{layout:n}=this.visualElement.projection||{},r=this.constraints;e&&gv(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&n?this.constraints=Oxe(n.layoutBox,e):this.constraints=!1,this.elastic=kxe(i),r!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&xc(s=>{this.getAxisMotionValue(s)&&(this.constraints[s]=Uxe(n.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:i}=this.getProps();if(!e||!gv(e))return!1;const n=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=Wxe(n,r.root,this.visualElement.getTransformPagePoint());let o=Fxe(r.layout.layoutBox,s);if(i){const a=i(zxe(o));this.hasMutatedConstraints=!!a,a&&(o=MZ(a))}return o}startAnimation(e){const{drag:i,dragMomentum:n,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=xc(h=>{if(!qS(h,i,this.currentDirection))return;let u=l&&l[h]||{};o&&(u={min:0,max:0});const d=r?200:1e6,f=r?40:1e7,p={type:"inertia",velocity:n?e[h]:0,bounceStiffness:d,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...s,...u};return this.startAxisValueAnimation(h,p)});return Promise.all(c).then(a)}startAxisValueAnimation(e,i){const n=this.getAxisMotionValue(e);return n.start(RU(e,n,0,i))}stopAnimation(){xc(e=>this.getAxisMotionValue(e).stop())}getAxisMotionValue(e){const i="_drag"+e.toUpperCase(),n=this.visualElement.getProps(),r=n[i];return r||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){xc(i=>{const{drag:n}=this.getProps();if(!qS(i,n,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(i);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[i];s.set(e[i]-wn(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:i}=this.getProps(),{projection:n}=this.visualElement;if(!gv(i)||!n||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};xc(o=>{const a=this.getAxisMotionValue(o);if(a){const l=a.get();r[o]=Nxe({min:l,max:l},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),xc(o=>{if(!qS(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(wn(l,c,r[o]))})}addListeners(){if(!this.visualElement.current)return;Xxe.set(this.visualElement,this);const e=this.visualElement.current,i=eh(e,"pointerdown",l=>{const{drag:c,dragListener:h=!0}=this.getProps();c&&h&&this.start(l)}),n=()=>{const{dragConstraints:l}=this.getProps();gv(l)&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",n);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),n();const o=Yu(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(xc(h=>{const u=this.getAxisMotionValue(h);u&&(this.originPoint[h]+=l[h].translate,u.set(u.get()+l[h].translate))}),this.visualElement.render())});return()=>{o(),i(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:i=!1,dragDirectionLock:n=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=sB,dragMomentum:a=!0}=e;return{...e,drag:i,dragDirectionLock:n,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function qS(t,e,i){return(e===!0||e===t)&&(i===null||i===t)}function Yxe(t,e=10){let i=null;return Math.abs(t.y)>e?i="y":Math.abs(t.x)>e&&(i="x"),i}class Qxe extends hf{constructor(e){super(e),this.removeGroupControls=ur,this.removeListeners=ur,this.controls=new qxe(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ur}unmount(){this.removeGroupControls(),this.removeListeners()}}const uj=t=>(e,i)=>{t&&An.update(()=>t(e,i))};class Kxe extends hf{constructor(){super(...arguments),this.removePointerDownListener=ur}onPointerDown(e){this.session=new SZ(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint()})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:i,onPan:n,onPanEnd:r}=this.node.getProps();return{onSessionStart:uj(e),onStart:uj(i),onMove:n,onEnd:(s,o)=>{delete this.session,r&&An.update(()=>r(s,o))}}}mount(){this.removePointerDownListener=eh(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function Jxe(){const t=ye.useContext(mU);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:i,register:n}=t,r=ye.useId();return ye.useEffect(()=>n(r),[]),!e&&i?[!1,()=>i&&i(r)]:[!0]}const LM={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function hj(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const mx={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(zt.test(t))t=parseFloat(t);else return t;const i=hj(t,e.target.x),n=hj(t,e.target.y);return`${i}% ${n}%`}},Zxe={correct:(t,{treeScale:e,projectionDelta:i})=>{const n=t,r=Zd.parse(t);if(r.length>5)return n;const s=Zd.createTransformer(t),o=typeof r[0]!="number"?1:0,a=i.x.scale*e.x,l=i.y.scale*e.y;r[0+o]/=a,r[1+o]/=l;const c=wn(a,l,.5);return typeof r[2+o]=="number"&&(r[2+o]/=c),typeof r[3+o]=="number"&&(r[3+o]/=c),s(r)}};class $xe extends Ul.Component{componentDidMount(){const{visualElement:e,layoutGroup:i,switchLayoutGroup:n,layoutId:r}=this.props,{projection:s}=e;r0e(e1e),s&&(i.group&&i.group.add(s),n&&n.register&&r&&n.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),LM.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:i,visualElement:n,drag:r,isPresent:s}=this.props,o=n.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==i||i===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||An.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:i,switchLayoutGroup:n}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),i&&i.group&&i.group.remove(r),n&&n.deregister&&n.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function PZ(t){const[e,i]=Jxe(),n=ye.useContext(MJ);return Ul.createElement($xe,{...t,layoutGroup:n,switchLayoutGroup:ye.useContext(EJ),isPresent:e,safeToRemove:i})}const e1e={borderRadius:{...mx,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:mx,borderTopRightRadius:mx,borderBottomLeftRadius:mx,borderBottomRightRadius:mx,boxShadow:Zxe},DZ=["TopLeft","TopRight","BottomLeft","BottomRight"],t1e=DZ.length,dj=t=>typeof t=="string"?parseFloat(t):t,fj=t=>typeof t=="number"||zt.test(t);function i1e(t,e,i,n,r,s){r?(t.opacity=wn(0,i.opacity!==void 0?i.opacity:1,n1e(n)),t.opacityExit=wn(e.opacity!==void 0?e.opacity:1,0,r1e(n))):s&&(t.opacity=wn(e.opacity!==void 0?e.opacity:1,i.opacity!==void 0?i.opacity:1,n));for(let o=0;o<t1e;o++){const a=`border${DZ[o]}Radius`;let l=pj(e,a),c=pj(i,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||fj(l)===fj(c)?(t[a]=Math.max(wn(dj(l),dj(c),n),0),(zc.test(c)||zc.test(l))&&(t[a]+="%")):t[a]=c}(e.rotate||i.rotate)&&(t.rotate=wn(e.rotate||0,i.rotate||0,n))}function pj(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const n1e=RZ(0,.5,TU),r1e=RZ(.5,.95,ur);function RZ(t,e,i){return n=>n<t?0:n>e?1:i(D_(t,e,n))}function mj(t,e){t.min=e.min,t.max=e.max}function xa(t,e){mj(t.x,e.x),mj(t.y,e.y)}function gj(t,e,i,n,r){return t-=e,t=FE(t,1/i,n),r!==void 0&&(t=FE(t,1/r,n)),t}function s1e(t,e=0,i=1,n=.5,r,s=t,o=t){if(zc.test(e)&&(e=parseFloat(e),e=wn(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=wn(s.min,s.max,n);t===s&&(a-=e),t.min=gj(t.min,e,i,a,r),t.max=gj(t.max,e,i,a,r)}function vj(t,e,[i,n,r],s,o){s1e(t,e[i],e[n],e[r],e.scale,s,o)}const o1e=["x","scaleX","originX"],a1e=["y","scaleY","originY"];function yj(t,e,i,n){vj(t.x,e,o1e,i?i.x:void 0,n?n.x:void 0),vj(t.y,e,a1e,i?i.y:void 0,n?n.y:void 0)}function xj(t){return t.translate===0&&t.scale===1}function IZ(t){return xj(t.x)&&xj(t.y)}function lB(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}function _j(t){return na(t.x)/na(t.y)}class l1e{constructor(){this.members=[]}add(e){IU(this.members,e),e.scheduleRender()}remove(e){if(LU(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const i=this.members[this.members.length-1];i&&this.promote(i)}}relegate(e){const i=this.members.findIndex(r=>e===r);if(i===0)return!1;let n;for(let r=i;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){n=s;break}}return n?(this.promote(n),!0):!1}promote(e,i){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,i&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:i,resumingFrom:n}=e;i.onExitComplete&&i.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function wj(t,e,i){let n="";const r=t.x.translate/e.x,s=t.y.translate/e.y;if((r||s)&&(n=`translate3d(${r}px, ${s}px, 0) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),i){const{rotate:l,rotateX:c,rotateY:h}=i;l&&(n+=`rotate(${l}deg) `),c&&(n+=`rotateX(${c}deg) `),h&&(n+=`rotateY(${h}deg) `)}const o=t.x.scale*e.x,a=t.y.scale*e.y;return(o!==1||a!==1)&&(n+=`scale(${o}, ${a})`),n||"none"}const c1e=(t,e)=>t.depth-e.depth;class u1e{constructor(){this.children=[],this.isDirty=!1}add(e){IU(this.children,e),this.isDirty=!0}remove(e){LU(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(c1e),this.isDirty=!1,this.children.forEach(e)}}function h1e(t,e){const i=performance.now(),n=({timestamp:r})=>{const s=r-i;s>=e&&(uh(n),t(s-e))};return An.read(n,!0),()=>uh(n)}function d1e(t){window.MotionDebug&&window.MotionDebug.record(t)}function f1e(t){return t instanceof SVGElement&&t.tagName!=="svg"}function p1e(t,e,i){const n=So(t)?t:S0(t);return n.start(RU("",n,e,i)),n.animation}const bj=["","X","Y","Z"],Sj=1e3;let m1e=0;const $f={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function LZ({attachResizeListener:t,defaultParent:e,measureScroll:i,checkIsScrollRoot:n,resetTransform:r}){return class{constructor(o={},a=e==null?void 0:e()){this.id=m1e++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{$f.totalNodes=$f.resolvedTargetDeltas=$f.recalculatedProjection=0,this.nodes.forEach(y1e),this.nodes.forEach(S1e),this.nodes.forEach(A1e),this.nodes.forEach(x1e),d1e($f)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new u1e)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new BU),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=f1e(o),this.instance=o;const{layoutId:l,layout:c,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(c||l)&&(this.isLayoutDirty=!0),t){let u;const d=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,u&&u(),u=h1e(d,250),LM.hasAnimatedSinceResize&&(LM.hasAnimatedSinceResize=!1,this.nodes.forEach(Mj))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||c)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeTargetChanged:f,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const m=this.options.transition||h.getDefaultTransition()||P1e,{onLayoutAnimationStart:v,onLayoutAnimationComplete:g}=h.getProps(),y=!this.targetLayout||!lB(this.targetLayout,p)||f,x=!d&&f;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||x||d&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(u,x);const b={...xZ(m,"layout"),onPlay:v,onComplete:g};(h.shouldReduceMotion||this.options.layoutRoot)&&(b.delay=0,b.type=!1),this.startAnimation(b)}else d||Mj(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,uh(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(M1e),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const u=this.path[h];u.shouldResetTransform=!0,u.updateScroll("snapshot"),u.options.layoutRoot&&u.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Aj);return}this.isUpdating||this.nodes.forEach(w1e),this.isUpdating=!1,this.nodes.forEach(b1e),this.nodes.forEach(g1e),this.nodes.forEach(v1e),this.clearAllSnapshots();const a=performance.now();ps.delta=Jd(0,1e3/60,a-ps.timestamp),ps.timestamp=a,ps.isProcessing=!0,qD.update.process(ps),qD.preRender.process(ps),qD.render.process(ps),ps.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(_1e),this.sharedNodes.forEach(E1e)}scheduleUpdateProjection(){An.preRender(this.updateProjection,!1,!0)}scheduleCheckAfterUnmount(){An.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=sr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:n(this.instance),offset:i(this.instance)})}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform,a=this.projectionDelta&&!IZ(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,h=c!==this.prevTransformTemplateValue;o&&(a||Zf(this.latestValues)||h)&&(r(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),R1e(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return sr();const a=o.measureViewportBox(),{scroll:l}=this.root;return l&&(id(a.x,l.offset.x),id(a.y,l.offset.y)),a}removeElementScroll(o){const a=sr();xa(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l],{scroll:h,options:u}=c;if(c!==this.root&&h&&u.layoutScroll){if(h.isRoot){xa(a,o);const{scroll:d}=this.root;d&&(id(a.x,-d.offset.x),id(a.y,-d.offset.y))}id(a.x,h.offset.x),id(a.y,h.offset.y)}}return a}applyTransform(o,a=!1){const l=sr();xa(l,o);for(let c=0;c<this.path.length;c++){const h=this.path[c];!a&&h.options.layoutScroll&&h.scroll&&h!==h.root&&xv(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Zf(h.latestValues)&&xv(l,h.latestValues)}return Zf(this.latestValues)&&xv(l,this.latestValues),l}removeTransform(o){const a=sr();xa(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Zf(c.latestValues))continue;oB(c.latestValues)&&c.updateSnapshot();const h=sr(),u=c.measurePageBox();xa(h,u),yj(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,h)}return Zf(this.latestValues)&&yj(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ps.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:u,layoutId:d}=this.options;if(!(!this.layout||!(u||d))){if(this.resolvedRelativeTargetAt=ps.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=sr(),this.relativeTargetOrigin=sr(),I1(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),xa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=sr(),this.targetWithTransforms=sr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Lxe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):xa(this.target,this.layout.layoutBox),TZ(this.target,this.targetDelta)):xa(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=sr(),this.relativeTargetOrigin=sr(),I1(this.relativeTargetOrigin,this.target,f.target),xa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}$f.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||oB(this.parent.latestValues)||EZ(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===ps.timestamp&&(c=!1),c)return;const{layout:h,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||u))return;xa(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,f=this.treeScale.y;Hxe(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox);const{target:p}=a;if(!p){this.projectionTransform&&(this.projectionDelta=yv(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=yv(),this.projectionDeltaWithTransform=yv());const m=this.projectionTransform;R1(this.projectionDelta,this.layoutCorrected,p,this.latestValues),this.projectionTransform=wj(this.projectionDelta,this.treeScale),(this.projectionTransform!==m||this.treeScale.x!==d||this.treeScale.y!==f)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p)),$f.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const a=this.getStack();a&&a.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},h={...this.latestValues},u=yv();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const d=sr(),f=l?l.source:void 0,p=this.layout?this.layout.source:void 0,m=f!==p,v=this.getStack(),g=!v||v.members.length<=1,y=!!(m&&!g&&this.options.crossfade===!0&&!this.path.some(C1e));this.animationProgress=0;let x;this.mixTargetDelta=b=>{const S=b/1e3;Ej(u.x,o.x,S),Ej(u.y,o.y,S),this.setTargetDelta(u),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(I1(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),T1e(this.relativeTarget,this.relativeTargetOrigin,d,S),x&&lB(this.relativeTarget,x)&&(this.isProjectionDirty=!1),x||(x=sr()),xa(x,this.relativeTarget)),m&&(this.animationValues=h,i1e(h,c,this.latestValues,S,y,g)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=S},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(uh(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=An.update(()=>{LM.hasAnimatedSinceResize=!0,this.currentAnimation=p1e(0,Sj,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Sj),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:h}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&BZ(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||sr();const u=na(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+u;const d=na(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+d}xa(a,l),xv(a,h),R1(this.projectionDeltaWithTransform,this.layoutCorrected,a,h)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new l1e),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.rotate||l.rotateX||l.rotateY||l.rotateZ)&&(a=!0),!a)return;const c={};for(let h=0;h<bj.length;h++){const u="rotate"+bj[h];l[u]&&(c[u]=l[u],o.setStaticValue(u,0))}o.render();for(const h in c)o.setStaticValue(h,c[h]);o.scheduleRender()}getProjectionStyles(o={}){var a,l;const c={};if(!this.instance||this.isSVG)return c;if(this.isVisible)c.visibility="";else return{visibility:"hidden"};const h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=IM(o.pointerEvents)||"",c.transform=h?h(this.latestValues,""):"none",c;const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){const m={};return this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=IM(o.pointerEvents)||""),this.hasProjected&&!Zf(this.latestValues)&&(m.transform=h?h({},""):"none",this.hasProjected=!1),m}const d=u.animationValues||u.latestValues;this.applyTransformsToTarget(),c.transform=wj(this.projectionDeltaWithTransform,this.treeScale,d),h&&(c.transform=h(d,c.transform));const{x:f,y:p}=this.projectionDelta;c.transformOrigin=`${f.origin*100}% ${p.origin*100}% 0`,u.animationValues?c.opacity=u===this?(l=(a=d.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:c.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const m in PE){if(d[m]===void 0)continue;const{correct:v,applyTo:g}=PE[m],y=c.transform==="none"?d[m]:v(d[m],u);if(g){const x=g.length;for(let b=0;b<x;b++)c[g[b]]=y}else c[m]=y}return this.options.layoutId&&(c.pointerEvents=u===this?IM(o.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(Aj),this.root.sharedNodes.clear()}}}function g1e(t){t.updateLayout()}function v1e(t){var e;const i=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&i&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:r}=t.layout,{animationType:s}=t.options,o=i.source!==t.layout.source;s==="size"?xc(u=>{const d=o?i.measuredBox[u]:i.layoutBox[u],f=na(d);d.min=n[u].min,d.max=d.min+f}):BZ(s,i.layoutBox,n)&&xc(u=>{const d=o?i.measuredBox[u]:i.layoutBox[u],f=na(n[u]);d.max=d.min+f,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[u].max=t.relativeTarget[u].min+f)});const a=yv();R1(a,n,i.layoutBox);const l=yv();o?R1(l,t.applyTransform(r,!0),i.measuredBox):R1(l,n,i.layoutBox);const c=!IZ(a);let h=!1;if(!t.resumeFrom){const u=t.getClosestProjectingParent();if(u&&!u.resumeFrom){const{snapshot:d,layout:f}=u;if(d&&f){const p=sr();I1(p,i.layoutBox,d.layoutBox);const m=sr();I1(m,n,f.layoutBox),lB(p,m)||(h=!0),u.options.layoutRoot&&(t.relativeTarget=m,t.relativeTargetOrigin=p,t.relativeParent=u)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:i,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeTargetChanged:h})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function y1e(t){$f.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function x1e(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function _1e(t){t.clearSnapshot()}function Aj(t){t.clearMeasurements()}function w1e(t){t.isLayoutDirty=!1}function b1e(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function Mj(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function S1e(t){t.resolveTargetDelta()}function A1e(t){t.calcProjection()}function M1e(t){t.resetRotation()}function E1e(t){t.removeLeadSnapshot()}function Ej(t,e,i){t.translate=wn(e.translate,0,i),t.scale=wn(e.scale,1,i),t.origin=e.origin,t.originPoint=e.originPoint}function Tj(t,e,i,n){t.min=wn(e.min,i.min,n),t.max=wn(e.max,i.max,n)}function T1e(t,e,i,n){Tj(t.x,e.x,i.x,n),Tj(t.y,e.y,i.y,n)}function C1e(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const P1e={duration:.45,ease:[.4,0,.1,1]};let NE;const D1e=()=>navigator.userAgent.toLowerCase().includes("applewebkit/");function Cj(t){t.min=NE(t.min),t.max=NE(t.max)}function R1e(t){NE||(NE=D1e()?Math.round:e=>Math.round(e*2)/2),Cj(t.x),Cj(t.y)}function BZ(t,e,i){return t==="position"||t==="preserve-aspect"&&!rB(_j(e),_j(i),.2)}const I1e=LZ({attachResizeListener:(t,e)=>Yu(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rR={current:void 0},OZ=LZ({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!rR.current){const t=new I1e({});t.mount(window),t.setOptions({layoutScroll:!0}),rR.current=t}return rR.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),L1e={pan:{Feature:Kxe},drag:{Feature:Qxe,ProjectionNode:OZ,MeasureLayout:PZ}},B1e=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function O1e(t){const e=B1e.exec(t);if(!e)return[,];const[,i,n]=e;return[i,n]}function cB(t,e,i=1){const[n,r]=O1e(t);if(!n)return;const s=window.getComputedStyle(e).getPropertyValue(n);return s?s.trim():JL(r)?cB(r,e,i+1):r}function F1e(t,{...e},i){const n=t.current;if(!(n instanceof Element))return{target:e,transitionEnd:i};i&&(i={...i}),t.values.forEach(r=>{const s=r.get();if(!JL(s))return;const o=cB(s,n);o&&r.set(o)});for(const r in e){const s=e[r];if(!JL(s))continue;const o=cB(s,n);o&&(e[r]=o,i||(i={}),i[r]===void 0&&(i[r]=s))}return{target:e,transitionEnd:i}}const N1e=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),FZ=t=>N1e.has(t),U1e=t=>Object.keys(t).some(FZ),Pj=t=>t===xm||t===zt,Dj=(t,e)=>parseFloat(t.split(", ")[e]),Rj=(t,e)=>(i,{transform:n})=>{if(n==="none"||!n)return 0;const r=n.match(/^matrix3d\((.+)\)$/);if(r)return Dj(r[1],e);{const s=n.match(/^matrix\((.+)\)$/);return s?Dj(s[1],t):0}},k1e=new Set(["x","y","z"]),z1e=Aw.filter(t=>!k1e.has(t));function G1e(t){const e=[];return z1e.forEach(i=>{const n=t.getValue(i);n!==void 0&&(e.push([i,n.get()]),n.set(i.startsWith("scale")?1:0))}),e.length&&t.render(),e}const A0={width:({x:t},{paddingLeft:e="0",paddingRight:i="0"})=>t.max-t.min-parseFloat(e)-parseFloat(i),height:({y:t},{paddingTop:e="0",paddingBottom:i="0"})=>t.max-t.min-parseFloat(e)-parseFloat(i),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:Rj(4,13),y:Rj(5,14)};A0.translateX=A0.x;A0.translateY=A0.y;const H1e=(t,e,i)=>{const n=e.measureViewportBox(),r=e.current,s=getComputedStyle(r),{display:o}=s,a={};o==="none"&&e.setStaticValue("display",t.display||"block"),i.forEach(c=>{a[c]=A0[c](n,s)}),e.render();const l=e.measureViewportBox();return i.forEach(c=>{const h=e.getValue(c);h&&h.jump(a[c]),t[c]=A0[c](l,s)}),t},V1e=(t,e,i={},n={})=>{e={...e},n={...n};const r=Object.keys(e).filter(FZ);let s=[],o=!1;const a=[];if(r.forEach(l=>{const c=t.getValue(l);if(!t.hasValue(l))return;let h=i[l],u=px(h);const d=e[l];let f;if(RE(d)){const p=d.length,m=d[0]===null?1:0;h=d[m],u=px(h);for(let v=m;v<p&&d[v]!==null;v++)f?EU(px(d[v])===f):f=px(d[v])}else f=px(d);if(u!==f)if(Pj(u)&&Pj(f)){const p=c.get();typeof p=="string"&&c.set(parseFloat(p)),typeof d=="string"?e[l]=parseFloat(d):Array.isArray(d)&&f===zt&&(e[l]=d.map(parseFloat))}else u!=null&&u.transform&&(f!=null&&f.transform)&&(h===0||d===0)?h===0?c.set(f.transform(h)):e[l]=u.transform(d):(o||(s=G1e(t),o=!0),a.push(l),n[l]=n[l]!==void 0?n[l]:e[l],c.jump(d))}),a.length){const l=a.indexOf("height")>=0?window.pageYOffset:null,c=H1e(e,t,a);return s.length&&s.forEach(([h,u])=>{t.getValue(h).set(u)}),t.render(),NC&&l!==null&&window.scrollTo({top:l}),{target:c,transitionEnd:n}}else return{target:e,transitionEnd:n}};function j1e(t,e,i,n){return U1e(e)?V1e(t,e,i,n):{target:e,transitionEnd:n}}const W1e=(t,e,i,n)=>{const r=F1e(t,e,n);return e=r.target,n=r.transitionEnd,j1e(t,e,i,n)},uB={current:null},NZ={current:!1};function X1e(){if(NZ.current=!0,!!NC)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>uB.current=t.matches;t.addListener(e),e()}else uB.current=!1}function q1e(t,e,i){const{willChange:n}=e;for(const r in e){const s=e[r],o=i[r];if(So(s))t.addValue(r,s),OE(n)&&n.add(r);else if(So(o))t.addValue(r,S0(s,{owner:t})),OE(n)&&n.remove(r);else if(o!==s)if(t.hasValue(r)){const a=t.getValue(r);!a.hasAnimated&&a.set(s)}else{const a=t.getStaticValue(r);t.addValue(r,S0(a!==void 0?a:s,{owner:t}))}}for(const r in i)e[r]===void 0&&t.removeValue(r);return e}const Ij=new WeakMap,UZ=Object.keys(P_),Y1e=UZ.length,Lj=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],Q1e=vU.length;class K1e{constructor({parent:e,props:i,presenceContext:n,reducedMotionConfig:r,visualState:s},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>An.render(this.render,!1,!0);const{latestValues:a,renderState:l}=s;this.latestValues=a,this.baseTarget={...a},this.initialValues=i.initial?{...a}:{},this.renderState=l,this.parent=e,this.props=i,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=o,this.isControllingVariants=kC(i),this.isVariantNode=AJ(i),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:c,...h}=this.scrapeMotionValuesFromProps(i,{});for(const u in h){const d=h[u];a[u]!==void 0&&So(d)&&(d.set(a[u],!1),OE(c)&&c.add(u))}}scrapeMotionValuesFromProps(e,i){return{}}mount(e){this.current=e,Ij.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((i,n)=>this.bindToMotionValue(n,i)),NZ.current||X1e(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:uB.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){Ij.delete(this.current),this.projection&&this.projection.unmount(),uh(this.notifyUpdate),uh(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,i){const n=ym.has(e),r=i.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&An.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),s=i.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{r(),s()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...i},n,r,s){let o,a;for(let l=0;l<Y1e;l++){const c=UZ[l],{isEnabled:h,Feature:u,ProjectionNode:d,MeasureLayout:f}=P_[c];d&&(o=d),h(i)&&(!this.features[c]&&u&&(this.features[c]=new u(this)),f&&(a=f))}if(!this.projection&&o){this.projection=new o(this.latestValues,this.parent&&this.parent.projection);const{layoutId:l,layout:c,drag:h,dragConstraints:u,layoutScroll:d,layoutRoot:f}=i;this.projection.setOptions({layoutId:l,layout:c,alwaysMeasureLayout:!!h||u&&gv(u),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof c=="string"?c:"both",initialPromotionConfig:s,layoutScroll:d,layoutRoot:f})}return a}updateFeatures(){for(const e in this.features){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):sr()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,i){this.latestValues[e]=i}makeTargetAnimatable(e,i=!0){return this.makeTargetAnimatableFromInstance(e,this.props,i)}update(e,i){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=i;for(let n=0;n<Lj.length;n++){const r=Lj[n];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s=e["on"+r];s&&(this.propEventSubscriptions[r]=this.on(r,s))}this.prevMotionValues=q1e(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const i={};for(let n=0;n<Q1e;n++){const r=vU[n],s=this.props[r];(C_(s)||s===!1)&&(i[r]=s)}return i}addVariantChild(e){const i=this.getClosestVariantNode();if(i)return i.variantChildren&&i.variantChildren.add(e),()=>i.variantChildren.delete(e)}addValue(e,i){i!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,i)),this.values.set(e,i),this.latestValues[e]=i.get()}removeValue(e){this.values.delete(e);const i=this.valueSubscriptions.get(e);i&&(i(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,i){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&i!==void 0&&(n=S0(i,{owner:this}),this.addValue(e,n)),n}readValue(e){var i;return this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(i=this.getBaseTargetFromProps(this.props,e))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,e,this.options)}setBaseTarget(e,i){this.baseTarget[e]=i}getBaseTarget(e){var i;const{initial:n}=this.props,r=typeof n=="string"||typeof n=="object"?(i=MU(this.props,n))===null||i===void 0?void 0:i[e]:void 0;if(n&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!So(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,i){return this.events[e]||(this.events[e]=new BU),this.events[e].add(i)}notify(e,...i){this.events[e]&&this.events[e].notify(...i)}}class kZ extends K1e{sortInstanceNodePosition(e,i){return e.compareDocumentPosition(i)&2?1:-1}getBaseTargetFromProps(e,i){return e.style?e.style[i]:void 0}removeValueFromRenderState(e,{vars:i,style:n}){delete i[e],delete n[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:i,...n},{transformValues:r},s){let o=mxe(n,e||{},this);if(r&&(i&&(i=r(i)),n&&(n=r(n)),o&&(o=r(o))),s){fxe(this,n,o);const a=W1e(this,n,o,i);i=a.transitionEnd,n=a.target}return{transition:e,transitionEnd:i,...n}}}function J1e(t){return window.getComputedStyle(t)}class Z1e extends kZ{readValueFromInstance(e,i){if(ym.has(i)){const n=DU(i);return n&&n.default||0}else{const n=J1e(e),r=(PJ(i)?n.getPropertyValue(i):n[i])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:i}){return CZ(e,i)}build(e,i,n,r){xU(e,i,n,r.transformTemplate)}scrapeMotionValuesFromProps(e,i){return AU(e,i)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;So(e)&&(this.childSubscription=e.on("change",i=>{this.current&&(this.current.textContent=`${i}`)}))}renderInstance(e,i,n,r){OJ(e,i,n,r)}}class $1e extends kZ{constructor(){super(...arguments),this.isSVGTag=!1}getBaseTargetFromProps(e,i){return e[i]}readValueFromInstance(e,i){if(ym.has(i)){const n=DU(i);return n&&n.default||0}return i=FJ.has(i)?i:SU(i),e.getAttribute(i)}measureInstanceViewportBox(){return sr()}scrapeMotionValuesFromProps(e,i){return UJ(e,i)}build(e,i,n,r){wU(e,i,n,this.isSVGTag,r.transformTemplate)}renderInstance(e,i,n,r){NJ(e,i,n,r)}mount(e){this.isSVGTag=bU(e.tagName),super.mount(e)}}const e_e=(t,e)=>yU(t)?new $1e(e,{enableHardwareAcceleration:!1}):new Z1e(e,{enableHardwareAcceleration:!0}),t_e={layout:{ProjectionNode:OZ,MeasureLayout:PZ}},i_e={...Pxe,...Y0e,...L1e,...t_e},M0=i0e((t,e)=>I0e(t,e,i_e,e_e)),R_={paddingX:"sm:px-16 px-6",paddingY:"sm:py-16 py-6",padding:"sm:px-16 px-6 sm:py-16 py-10",heroHeadText:"font-black text-white lg:text-[80px] sm:text-[60px] xs:text-[50px] text-[40px] lg:leading-[98px] mt-2",heroSubText:"text-[#dfd9ff] font-medium lg:text-[30px] sm:text-[26px] xs:text-[20px] text-[16px] lg:leading-[40px]",sectionHeadText:"text-white font-black md:text-[60px] sm:text-[50px] xs:text-[40px] text-[30px]",sectionSubText:"sm:text-[18px] text-[14px] text-secondary uppercase tracking-wider"},n_e="/Paarth_Website/assets/logo-color-3dcd07e0.svg",r_e="/Paarth_Website/assets/backend-565fc01f.png",s_e="/Paarth_Website/assets/creator-dbbffaec.png",o_e="/Paarth_Website/assets/mobile-896ef2f5.png",a_e="/Paarth_Website/assets/web-0d05165f.png",l_e="/Paarth_Website/assets/github-3b4e1609.png",c_e=[{title:"Full Stack Developer",icon:a_e},{title:"Django Developer",icon:o_e},{title:"React Developer",icon:r_e},{title:"ASP.NET Developer",icon:s_e}],u_e=t=>({hidden:{y:-50,opacity:0},show:{y:0,opacity:1,transition:{type:"spring",duration:1.25,delay:t}}}),zZ=(t,e,i,n)=>({hidden:{x:t==="left"?100:t==="right"?-100:0,y:t==="up"?100:t==="down"?-100:0,opacity:0},show:{x:0,y:0,opacity:1,transition:{type:e,delay:i,duration:n,ease:"easeOut"}}}),Bj=(t,e,i,n)=>({hidden:{x:t==="left"?"-100%":t==="right"?"100%":0,y:t==="up"||t==="down"?"100%":0},show:{x:0,y:0,transition:{type:e,delay:i,duration:n,ease:"easeOut"}}}),h_e=(t,e)=>({hidden:{},show:{transition:{staggerChildren:t,delayChildren:e||0}}}),GZ=(t,e)=>function(){return rt.jsxs(M0.section,{variants:h_e(),initial:"hidden",whileInView:"show",viewport:{once:!0,amount:.25},className:`${R_.padding} max-w-7xl mx-auto relative z-0`,children:[rt.jsx("span",{className:"hash-span",id:e,children:" "}),rt.jsx(t,{})]})},d_e=({index:t,title:e,icon:i})=>rt.jsx(qve,{className:"xs:w-[250px] w-full",children:rt.jsx(M0.div,{variants:zZ("right","spring",t*.5,.75),className:"w-full green-pink-gradient p-[1px] rounded-[20px] shadow-card",children:rt.jsxs("div",{options:{max:45,scale:1,speed:450},className:"bg-tertiary rounded-[20px] py-5 px-12 min-h-[280px] flex justify-evenly items-center flex-col",children:[rt.jsx("img",{src:i,alt:"web-development",className:"w-16 h-16 object-contain"}),rt.jsx("h3",{className:"text-white text-[20px] font-bold text-center",children:e})]})})}),f_e=()=>rt.jsxs(rt.Fragment,{children:[rt.jsxs(M0.div,{variants:u_e(),children:[rt.jsx("p",{className:R_.sectionSubText,children:"Introduction"}),rt.jsx("h2",{className:R_.sectionHeadText,id:"about",children:"Overview."})]}),rt.jsx(M0.p,{variants:zZ("","",.1,1),className:"mt-4 text-secondary text-[17px] max-w-3xl leading-[30px]",children:"I'm currently a student going in to my third year of computer science at McMaster University I'm a Full Stack Developer with a passion for creating exceptional digital experiences. With a background in both front-end and back-end technologies, I specialize in crafting dynamic and user-friendly web applications."}),rt.jsx("div",{className:"mt-20 flex flex-wrap gap-10",children:c_e.map((t,e)=>rt.jsx(d_e,{index:e,...t},t.title))})]}),p_e=GZ(f_e,"about"),I_={_origin:"https://api.emailjs.com"},m_e=(t,e="https://api.emailjs.com")=>{I_._userID=t,I_._origin=e},HZ=(t,e,i)=>{if(!t)throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!e)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!i)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates";return!0};class Oj{constructor(e){this.status=e?e.status:0,this.text=e?e.responseText:"Network Error"}}const VZ=(t,e,i={})=>new Promise((n,r)=>{const s=new XMLHttpRequest;s.addEventListener("load",({target:o})=>{const a=new Oj(o);a.status===200||a.text==="OK"?n(a):r(a)}),s.addEventListener("error",({target:o})=>{r(new Oj(o))}),s.open("POST",I_._origin+t,!0),Object.keys(i).forEach(o=>{s.setRequestHeader(o,i[o])}),s.send(e)}),g_e=(t,e,i,n)=>{const r=n||I_._userID;return HZ(r,t,e),VZ("/api/v1.0/email/send",JSON.stringify({lib_version:"3.11.0",user_id:r,service_id:t,template_id:e,template_params:i}),{"Content-type":"application/json"})},v_e=t=>{let e;if(typeof t=="string"?e=document.querySelector(t):e=t,!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of form";return e},y_e=(t,e,i,n)=>{const r=n||I_._userID,s=v_e(i);HZ(r,t,e);const o=new FormData(s);return o.append("lib_version","3.11.0"),o.append("service_id",t),o.append("template_id",e),o.append("user_id",r),VZ("/api/v1.0/email/send-form",o)},x_e={init:m_e,send:g_e,sendForm:y_e},__e=()=>{const t=ye.useRef(),[e,i]=ye.useState({name:"",email:"",message:""}),[n,r]=ye.useState(!1),s=a=>{const{target:l}=a,{name:c,value:h}=l;i({...e,[c]:h})},o=a=>{a.preventDefault(),r(!0),x_e.send("service_29uzio2","template_byz7l49",{from_name:e.name,to_name:"Paarth Kadakia",from_email:e.email,to_email:"paarth.kadakia24@gmail.com",message:e.message},"iraNkQr8t77CXcN_y").then(()=>{r(!1),alert("Thank you. I will get back to you as soon as possible."),i({name:"",email:"",message:""})},l=>{r(!1),console.error(l),alert("Ahh, something went wrong. Please try again.")})};return rt.jsxs("div",{className:"xl:mt-12 flex xl:flex-row flex-col-reverse gap-10 overflow-hidden",children:[rt.jsxs(M0.div,{variants:Bj("left","tween",.2,1),className:"flex-[0.75] bg-black-100 p-8 rounded-2xl",children:[rt.jsx("p",{className:R_.sectionSubText,children:"Get in touch"}),rt.jsx("h3",{className:R_.sectionHeadText,id:"contact",children:"Contact."}),rt.jsxs("form",{ref:t,onSubmit:o,className:"mt-12 flex flex-col gap-8",children:[rt.jsxs("label",{className:"flex flex-col",children:[rt.jsx("span",{className:"text-white font-medium mb-4",children:"Your Name"}),rt.jsx("input",{type:"text",name:"name",value:e.name,onChange:s,placeholder:"What's your name?",className:"bg-tertiary py-4 px-6 placeholder:text-secondary text-white rounded-lg outline-none border-none font-medium"})]}),rt.jsxs("label",{className:"flex flex-col",children:[rt.jsx("span",{className:"text-white font-medium mb-4",children:"Your email"}),rt.jsx("input",{type:"email",name:"email",value:e.email,onChange:s,placeholder:"What's your web address?",className:"bg-tertiary py-4 px-6 placeholder:text-secondary text-white rounded-lg outline-none border-none font-medium"})]}),rt.jsxs("label",{className:"flex flex-col",children:[rt.jsx("span",{className:"text-white font-medium mb-4",children:"Your Message"}),rt.jsx("textarea",{rows:7,name:"message",value:e.message,onChange:s,placeholder:"What you want to say?",className:"bg-tertiary py-4 px-6 placeholder:text-secondary text-white rounded-lg outline-none border-none font-medium"})]}),rt.jsx("button",{type:"submit",className:"bg-tertiary py-3 px-8 rounded-xl outline-none w-fit text-white font-bold shadow-md shadow-primary",children:n?"Sending...":"Send"})]})]}),rt.jsx(M0.div,{variants:Bj("right","tween",.2,1),className:"xl:flex-1 xl:h-auto md:h-[550px] h-[350px]",children:rt.jsx(Nve,{})})]})},w_e=GZ(__e,"contact");function Lu(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function jZ(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}/*!
 * GSAP 3.12.2
 * https://greensock.com
 *
 * @license Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var $o={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},E0={duration:.5,overwrite:!1,delay:0},OU,ws,On,Va=1e8,Ji=1/Va,hB=Math.PI*2,b_e=hB/4,S_e=0,WZ=Math.sqrt,A_e=Math.cos,M_e=Math.sin,Vr=function(e){return typeof e=="string"},kn=function(e){return typeof e=="function"},hh=function(e){return typeof e=="number"},FU=function(e){return typeof e>"u"},qc=function(e){return typeof e=="object"},go=function(e){return e!==!1},NU=function(){return typeof window<"u"},YS=function(e){return kn(e)||Vr(e)},XZ=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},bs=Array.isArray,dB=/(?:-?\.?\d|\.)+/gi,qZ=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,_v=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,sR=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,YZ=/[+-]=-?[.\d]+/,QZ=/[^,'"\[\]\s]+/gi,E_e=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,yn,Pa,fB,UU,ra={},UE={},KZ,JZ=function(e){return(UE=rm(e,ra))&&Ao},kU=function(e,i){return console.warn("Invalid property",e,"set to",i,"Missing plugin? gsap.registerPlugin()")},kE=function(e,i){return!i&&console.warn(e)},ZZ=function(e,i){return e&&(ra[e]=i)&&UE&&(UE[e]=i)||ra},L_=function(){return 0},T_e={suppressEvents:!0,isStart:!0,kill:!1},BM={suppressEvents:!0,kill:!1},C_e={suppressEvents:!0},zU={},Od=[],pB={},$Z,Uo={},oR={},Fj=30,OM=[],GU="",HU=function(e){var i=e[0],n,r;if(qc(i)||kn(i)||(e=[e]),!(n=(i._gsap||{}).harness)){for(r=OM.length;r--&&!OM[r].targetTest(i););n=OM[r]}for(r=e.length;r--;)e[r]&&(e[r]._gsap||(e[r]._gsap=new S$(e[r],n)))||e.splice(r,1);return e},Op=function(e){return e._gsap||HU(ja(e))[0]._gsap},e$=function(e,i,n){return(n=e[i])&&kn(n)?e[i]():FU(n)&&e.getAttribute&&e.getAttribute(i)||n},vo=function(e,i){return(e=e.split(",")).forEach(i)||e},qn=function(e){return Math.round(e*1e5)/1e5||0},Kr=function(e){return Math.round(e*1e7)/1e7||0},Gv=function(e,i){var n=i.charAt(0),r=parseFloat(i.substr(2));return e=parseFloat(e),n==="+"?e+r:n==="-"?e-r:n==="*"?e*r:e/r},P_e=function(e,i){for(var n=i.length,r=0;e.indexOf(i[r])<0&&++r<n;);return r<n},zE=function(){var e=Od.length,i=Od.slice(0),n,r;for(pB={},Od.length=0,n=0;n<e;n++)r=i[n],r&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},t$=function(e,i,n,r){Od.length&&!ws&&zE(),e.render(i,n,r||ws&&i<0&&(e._initted||e._startAt)),Od.length&&!ws&&zE()},i$=function(e){var i=parseFloat(e);return(i||i===0)&&(e+"").match(QZ).length<2?i:Vr(e)?e.trim():e},n$=function(e){return e},Za=function(e,i){for(var n in i)n in e||(e[n]=i[n]);return e},D_e=function(e){return function(i,n){for(var r in n)r in i||r==="duration"&&e||r==="ease"||(i[r]=n[r])}},rm=function(e,i){for(var n in i)e[n]=i[n];return e},Nj=function t(e,i){for(var n in i)n!=="__proto__"&&n!=="constructor"&&n!=="prototype"&&(e[n]=qc(i[n])?t(e[n]||(e[n]={}),i[n]):i[n]);return e},GE=function(e,i){var n={},r;for(r in e)r in i||(n[r]=e[r]);return n},L1=function(e){var i=e.parent||yn,n=e.keyframes?D_e(bs(e.keyframes)):Za;if(go(e.inherit))for(;i;)n(e,i.vars.defaults),i=i.parent||i._dp;return e},R_e=function(e,i){for(var n=e.length,r=n===i.length;r&&n--&&e[n]===i[n];);return n<0},r$=function(e,i,n,r,s){n===void 0&&(n="_first"),r===void 0&&(r="_last");var o=e[r],a;if(s)for(a=i[s];o&&o[s]>a;)o=o._prev;return o?(i._next=o._next,o._next=i):(i._next=e[n],e[n]=i),i._next?i._next._prev=i:e[r]=i,i._prev=o,i.parent=i._dp=e,i},VC=function(e,i,n,r){n===void 0&&(n="_first"),r===void 0&&(r="_last");var s=i._prev,o=i._next;s?s._next=o:e[n]===i&&(e[n]=o),o?o._prev=s:e[r]===i&&(e[r]=s),i._next=i._prev=i.parent=null},$d=function(e,i){e.parent&&(!i||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},Fp=function(e,i){if(e&&(!i||i._end>e._dur||i._start<0))for(var n=e;n;)n._dirty=1,n=n.parent;return e},I_e=function(e){for(var i=e.parent;i&&i.parent;)i._dirty=1,i.totalDuration(),i=i.parent;return e},mB=function(e,i,n,r){return e._startAt&&(ws?e._startAt.revert(BM):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(i,!0,r))},L_e=function t(e){return!e||e._ts&&t(e.parent)},Uj=function(e){return e._repeat?T0(e._tTime,e=e.duration()+e._rDelay)*e:0},T0=function(e,i){var n=Math.floor(e/=i);return e&&n===e?n-1:n},HE=function(e,i){return(e-i._start)*i._ts+(i._ts>=0?0:i._dirty?i.totalDuration():i._tDur)},jC=function(e){return e._end=Kr(e._start+(e._tDur/Math.abs(e._ts||e._rts||Ji)||0))},WC=function(e,i){var n=e._dp;return n&&n.smoothChildTiming&&e._ts&&(e._start=Kr(n._time-(e._ts>0?i/e._ts:((e._dirty?e.totalDuration():e._tDur)-i)/-e._ts)),jC(e),n._dirty||Fp(n,e)),e},s$=function(e,i){var n;if((i._time||!i._dur&&i._initted||i._start<e._time&&(i._dur||!i.add))&&(n=HE(e.rawTime(),i),(!i._dur||Cw(0,i.totalDuration(),n)-i._tTime>Ji)&&i.render(n,!0)),Fp(e,i)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(n=e;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;e._zTime=-Ji}},Ec=function(e,i,n,r){return i.parent&&$d(i),i._start=Kr((hh(n)?n:n||e!==yn?Ta(e,n,i):e._time)+i._delay),i._end=Kr(i._start+(i.totalDuration()/Math.abs(i.timeScale())||0)),r$(e,i,"_first","_last",e._sort?"_start":0),gB(i)||(e._recent=i),r||s$(e,i),e._ts<0&&WC(e,e._tTime),e},o$=function(e,i){return(ra.ScrollTrigger||kU("scrollTrigger",i))&&ra.ScrollTrigger.create(i,e)},a$=function(e,i,n,r,s){if(jU(e,i,s),!e._initted)return 1;if(!n&&e._pt&&!ws&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&$Z!==Go.frame)return Od.push(e),e._lazy=[s,r],1},B_e=function t(e){var i=e.parent;return i&&i._ts&&i._initted&&!i._lock&&(i.rawTime()<0||t(i))},gB=function(e){var i=e.data;return i==="isFromStart"||i==="isStart"},O_e=function(e,i,n,r){var s=e.ratio,o=i<0||!i&&(!e._start&&B_e(e)&&!(!e._initted&&gB(e))||(e._ts<0||e._dp._ts<0)&&!gB(e))?0:1,a=e._rDelay,l=0,c,h,u;if(a&&e._repeat&&(l=Cw(0,e._tDur,i),h=T0(l,a),e._yoyo&&h&1&&(o=1-o),h!==T0(e._tTime,a)&&(s=1-o,e.vars.repeatRefresh&&e._initted&&e.invalidate())),o!==s||ws||r||e._zTime===Ji||!i&&e._zTime){if(!e._initted&&a$(e,i,r,n,l))return;for(u=e._zTime,e._zTime=i||(n?Ji:0),n||(n=i&&!u),e.ratio=o,e._from&&(o=1-o),e._time=0,e._tTime=l,c=e._pt;c;)c.r(o,c.d),c=c._next;i<0&&mB(e,i,n,!0),e._onUpdate&&!n&&Wa(e,"onUpdate"),l&&e._repeat&&!n&&e.parent&&Wa(e,"onRepeat"),(i>=e._tDur||i<0)&&e.ratio===o&&(o&&$d(e,1),!n&&!ws&&(Wa(e,o?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=i)},F_e=function(e,i,n){var r;if(n>i)for(r=e._first;r&&r._start<=n;){if(r.data==="isPause"&&r._start>i)return r;r=r._next}else for(r=e._last;r&&r._start>=n;){if(r.data==="isPause"&&r._start<i)return r;r=r._prev}},C0=function(e,i,n,r){var s=e._repeat,o=Kr(i)||0,a=e._tTime/e._tDur;return a&&!r&&(e._time*=o/e._dur),e._dur=o,e._tDur=s?s<0?1e10:Kr(o*(s+1)+e._rDelay*s):o,a>0&&!r&&WC(e,e._tTime=e._tDur*a),e.parent&&jC(e),n||Fp(e.parent,e),e},kj=function(e){return e instanceof ro?Fp(e):C0(e,e._dur)},N_e={_start:0,endTime:L_,totalDuration:L_},Ta=function t(e,i,n){var r=e.labels,s=e._recent||N_e,o=e.duration()>=Va?s.endTime(!1):e._dur,a,l,c;return Vr(i)&&(isNaN(i)||i in r)?(l=i.charAt(0),c=i.substr(-1)==="%",a=i.indexOf("="),l==="<"||l===">"?(a>=0&&(i=i.replace(/=/,"")),(l==="<"?s._start:s.endTime(s._repeat>=0))+(parseFloat(i.substr(1))||0)*(c?(a<0?s:n).totalDuration()/100:1)):a<0?(i in r||(r[i]=o),r[i]):(l=parseFloat(i.charAt(a-1)+i.substr(a+1)),c&&n&&(l=l/100*(bs(n)?n[0]:n).totalDuration()),a>1?t(e,i.substr(0,a-1),n)+l:o+l)):i==null?o:+i},B1=function(e,i,n){var r=hh(i[1]),s=(r?2:1)+(e<2?0:1),o=i[s],a,l;if(r&&(o.duration=i[1]),o.parent=n,e){for(a=o,l=n;l&&!("immediateRender"in a);)a=l.vars.defaults||{},l=go(l.vars.inherit)&&l.parent;o.immediateRender=go(a.immediateRender),e<2?o.runBackwards=1:o.startAt=i[s-1]}return new or(i[0],o,i[s+1])},df=function(e,i){return e||e===0?i(e):i},Cw=function(e,i,n){return n<e?e:n>i?i:n},ys=function(e,i){return!Vr(e)||!(i=E_e.exec(e))?"":i[1]},U_e=function(e,i,n){return df(n,function(r){return Cw(e,i,r)})},vB=[].slice,l$=function(e,i){return e&&qc(e)&&"length"in e&&(!i&&!e.length||e.length-1 in e&&qc(e[0]))&&!e.nodeType&&e!==Pa},k_e=function(e,i,n){return n===void 0&&(n=[]),e.forEach(function(r){var s;return Vr(r)&&!i||l$(r,1)?(s=n).push.apply(s,ja(r)):n.push(r)})||n},ja=function(e,i,n){return On&&!i&&On.selector?On.selector(e):Vr(e)&&!n&&(fB||!P0())?vB.call((i||UU).querySelectorAll(e),0):bs(e)?k_e(e,n):l$(e)?vB.call(e,0):e?[e]:[]},yB=function(e){return e=ja(e)[0]||kE("Invalid scope")||{},function(i){var n=e.current||e.nativeElement||e;return ja(i,n.querySelectorAll?n:n===e?kE("Invalid scope")||UU.createElement("div"):e)}},c$=function(e){return e.sort(function(){return .5-Math.random()})},u$=function(e){if(kn(e))return e;var i=qc(e)?e:{each:e},n=Np(i.ease),r=i.from||0,s=parseFloat(i.base)||0,o={},a=r>0&&r<1,l=isNaN(r)||a,c=i.axis,h=r,u=r;return Vr(r)?h=u={center:.5,edges:.5,end:1}[r]||0:!a&&l&&(h=r[0],u=r[1]),function(d,f,p){var m=(p||i).length,v=o[m],g,y,x,b,S,A,E,M,T;if(!v){if(T=i.grid==="auto"?0:(i.grid||[1,Va])[1],!T){for(E=-Va;E<(E=p[T++].getBoundingClientRect().left)&&T<m;);T--}for(v=o[m]=[],g=l?Math.min(T,m)*h-.5:r%T,y=T===Va?0:l?m*u/T-.5:r/T|0,E=0,M=Va,A=0;A<m;A++)x=A%T-g,b=y-(A/T|0),v[A]=S=c?Math.abs(c==="y"?b:x):WZ(x*x+b*b),S>E&&(E=S),S<M&&(M=S);r==="random"&&c$(v),v.max=E-M,v.min=M,v.v=m=(parseFloat(i.amount)||parseFloat(i.each)*(T>m?m-1:c?c==="y"?m/T:T:Math.max(T,m/T))||0)*(r==="edges"?-1:1),v.b=m<0?s-m:s,v.u=ys(i.amount||i.each)||0,n=n&&m<0?_$(n):n}return m=(v[d]-v.min)/v.max||0,Kr(v.b+(n?n(m):m)*v.v)+v.u}},xB=function(e){var i=Math.pow(10,((e+"").split(".")[1]||"").length);return function(n){var r=Kr(Math.round(parseFloat(n)/e)*e*i);return(r-r%1)/i+(hh(n)?0:ys(n))}},h$=function(e,i){var n=bs(e),r,s;return!n&&qc(e)&&(r=n=e.radius||Va,e.values?(e=ja(e.values),(s=!hh(e[0]))&&(r*=r)):e=xB(e.increment)),df(i,n?kn(e)?function(o){return s=e(o),Math.abs(s-o)<=r?s:o}:function(o){for(var a=parseFloat(s?o.x:o),l=parseFloat(s?o.y:0),c=Va,h=0,u=e.length,d,f;u--;)s?(d=e[u].x-a,f=e[u].y-l,d=d*d+f*f):d=Math.abs(e[u]-a),d<c&&(c=d,h=u);return h=!r||c<=r?e[h]:o,s||h===o||hh(o)?h:h+ys(o)}:xB(e))},d$=function(e,i,n,r){return df(bs(e)?!i:n===!0?!!(n=0):!r,function(){return bs(e)?e[~~(Math.random()*e.length)]:(n=n||1e-5)&&(r=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((e-n/2+Math.random()*(i-e+n*.99))/n)*n*r)/r})},z_e=function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return function(r){return i.reduce(function(s,o){return o(s)},r)}},G_e=function(e,i){return function(n){return e(parseFloat(n))+(i||ys(n))}},H_e=function(e,i,n){return p$(e,i,0,1,n)},f$=function(e,i,n){return df(n,function(r){return e[~~i(r)]})},V_e=function t(e,i,n){var r=i-e;return bs(e)?f$(e,t(0,e.length),i):df(n,function(s){return(r+(s-e)%r)%r+e})},j_e=function t(e,i,n){var r=i-e,s=r*2;return bs(e)?f$(e,t(0,e.length-1),i):df(n,function(o){return o=(s+(o-e)%s)%s||0,e+(o>r?s-o:o)})},B_=function(e){for(var i=0,n="",r,s,o,a;~(r=e.indexOf("random(",i));)o=e.indexOf(")",r),a=e.charAt(r+7)==="[",s=e.substr(r+7,o-r-7).match(a?QZ:dB),n+=e.substr(i,r-i)+d$(a?s:+s[0],a?0:+s[1],+s[2]||1e-5),i=o+1;return n+e.substr(i,e.length-i)},p$=function(e,i,n,r,s){var o=i-e,a=r-n;return df(s,function(l){return n+((l-e)/o*a||0)})},W_e=function t(e,i,n,r){var s=isNaN(e+i)?0:function(f){return(1-f)*e+f*i};if(!s){var o=Vr(e),a={},l,c,h,u,d;if(n===!0&&(r=1)&&(n=null),o)e={p:e},i={p:i};else if(bs(e)&&!bs(i)){for(h=[],u=e.length,d=u-2,c=1;c<u;c++)h.push(t(e[c-1],e[c]));u--,s=function(p){p*=u;var m=Math.min(d,~~p);return h[m](p-m)},n=i}else r||(e=rm(bs(e)?[]:{},e));if(!h){for(l in i)VU.call(a,e,l,"get",i[l]);s=function(p){return qU(p,a)||(o?e.p:e)}}}return df(n,s)},zj=function(e,i,n){var r=e.labels,s=Va,o,a,l;for(o in r)a=r[o]-i,a<0==!!n&&a&&s>(a=Math.abs(a))&&(l=o,s=a);return l},Wa=function(e,i,n){var r=e.vars,s=r[i],o=On,a=e._ctx,l,c,h;if(s)return l=r[i+"Params"],c=r.callbackScope||e,n&&Od.length&&zE(),a&&(On=a),h=l?s.apply(c,l):s.call(c),On=o,h},t1=function(e){return $d(e),e.scrollTrigger&&e.scrollTrigger.kill(!!ws),e.progress()<1&&Wa(e,"onInterrupt"),e},wv,m$=[],g$=function(e){if(NU()&&e){e=!e.name&&e.default||e;var i=e.name,n=kn(e),r=i&&!n&&e.init?function(){this._props=[]}:e,s={init:L_,render:qU,add:VU,kill:awe,modifier:owe,rawVars:0},o={targetTest:0,get:0,getSetter:XU,aliases:{},register:0};if(P0(),e!==r){if(Uo[i])return;Za(r,Za(GE(e,s),o)),rm(r.prototype,rm(s,GE(e,o))),Uo[r.prop=i]=r,e.targetTest&&(OM.push(r),zU[i]=1),i=(i==="css"?"CSS":i.charAt(0).toUpperCase()+i.substr(1))+"Plugin"}ZZ(i,r),e.register&&e.register(Ao,r,yo)}else e&&m$.push(e)},Qi=255,i1={aqua:[0,Qi,Qi],lime:[0,Qi,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Qi],navy:[0,0,128],white:[Qi,Qi,Qi],olive:[128,128,0],yellow:[Qi,Qi,0],orange:[Qi,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Qi,0,0],pink:[Qi,192,203],cyan:[0,Qi,Qi],transparent:[Qi,Qi,Qi,0]},aR=function(e,i,n){return e+=e<0?1:e>1?-1:0,(e*6<1?i+(n-i)*e*6:e<.5?n:e*3<2?i+(n-i)*(2/3-e)*6:i)*Qi+.5|0},v$=function(e,i,n){var r=e?hh(e)?[e>>16,e>>8&Qi,e&Qi]:0:i1.black,s,o,a,l,c,h,u,d,f,p;if(!r){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),i1[e])r=i1[e];else if(e.charAt(0)==="#"){if(e.length<6&&(s=e.charAt(1),o=e.charAt(2),a=e.charAt(3),e="#"+s+s+o+o+a+a+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return r=parseInt(e.substr(1,6),16),[r>>16,r>>8&Qi,r&Qi,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),r=[e>>16,e>>8&Qi,e&Qi]}else if(e.substr(0,3)==="hsl"){if(r=p=e.match(dB),!i)l=+r[0]%360/360,c=+r[1]/100,h=+r[2]/100,o=h<=.5?h*(c+1):h+c-h*c,s=h*2-o,r.length>3&&(r[3]*=1),r[0]=aR(l+1/3,s,o),r[1]=aR(l,s,o),r[2]=aR(l-1/3,s,o);else if(~e.indexOf("="))return r=e.match(qZ),n&&r.length<4&&(r[3]=1),r}else r=e.match(dB)||i1.transparent;r=r.map(Number)}return i&&!p&&(s=r[0]/Qi,o=r[1]/Qi,a=r[2]/Qi,u=Math.max(s,o,a),d=Math.min(s,o,a),h=(u+d)/2,u===d?l=c=0:(f=u-d,c=h>.5?f/(2-u-d):f/(u+d),l=u===s?(o-a)/f+(o<a?6:0):u===o?(a-s)/f+2:(s-o)/f+4,l*=60),r[0]=~~(l+.5),r[1]=~~(c*100+.5),r[2]=~~(h*100+.5)),n&&r.length<4&&(r[3]=1),r},y$=function(e){var i=[],n=[],r=-1;return e.split(Fd).forEach(function(s){var o=s.match(_v)||[];i.push.apply(i,o),n.push(r+=o.length+1)}),i.c=n,i},Gj=function(e,i,n){var r="",s=(e+r).match(Fd),o=i?"hsla(":"rgba(",a=0,l,c,h,u;if(!s)return e;if(s=s.map(function(d){return(d=v$(d,i,1))&&o+(i?d[0]+","+d[1]+"%,"+d[2]+"%,"+d[3]:d.join(","))+")"}),n&&(h=y$(e),l=n.c,l.join(r)!==h.c.join(r)))for(c=e.replace(Fd,"1").split(_v),u=c.length-1;a<u;a++)r+=c[a]+(~l.indexOf(a)?s.shift()||o+"0,0,0,0)":(h.length?h:s.length?s:n).shift());if(!c)for(c=e.split(Fd),u=c.length-1;a<u;a++)r+=c[a]+s[a];return r+c[u]},Fd=function(){var t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in i1)t+="|"+e+"\\b";return new RegExp(t+")","gi")}(),X_e=/hsl[a]?\(/,x$=function(e){var i=e.join(" "),n;if(Fd.lastIndex=0,Fd.test(i))return n=X_e.test(i),e[1]=Gj(e[1],n),e[0]=Gj(e[0],n,y$(e[1])),!0},O_,Go=function(){var t=Date.now,e=500,i=33,n=t(),r=n,s=1e3/240,o=s,a=[],l,c,h,u,d,f,p=function m(v){var g=t()-r,y=v===!0,x,b,S,A;if(g>e&&(n+=g-i),r+=g,S=r-n,x=S-o,(x>0||y)&&(A=++u.frame,d=S-u.time*1e3,u.time=S=S/1e3,o+=x+(x>=s?4:s-x),b=1),y||(l=c(m)),b)for(f=0;f<a.length;f++)a[f](S,d,A,v)};return u={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(v){return d/(1e3/(v||60))},wake:function(){KZ&&(!fB&&NU()&&(Pa=fB=window,UU=Pa.document||{},ra.gsap=Ao,(Pa.gsapVersions||(Pa.gsapVersions=[])).push(Ao.version),JZ(UE||Pa.GreenSockGlobals||!Pa.gsap&&Pa||{}),h=Pa.requestAnimationFrame,m$.forEach(g$)),l&&u.sleep(),c=h||function(v){return setTimeout(v,o-u.time*1e3+1|0)},O_=1,p(2))},sleep:function(){(h?Pa.cancelAnimationFrame:clearTimeout)(l),O_=0,c=L_},lagSmoothing:function(v,g){e=v||1/0,i=Math.min(g||33,e)},fps:function(v){s=1e3/(v||240),o=u.time*1e3+s},add:function(v,g,y){var x=g?function(b,S,A,E){v(b,S,A,E),u.remove(x)}:v;return u.remove(v),a[y?"unshift":"push"](x),P0(),x},remove:function(v,g){~(g=a.indexOf(v))&&a.splice(g,1)&&f>=g&&f--},_listeners:a},u}(),P0=function(){return!O_&&Go.wake()},wi={},q_e=/^[\d.\-M][\d.\-,\s]/,Y_e=/["']/g,Q_e=function(e){for(var i={},n=e.substr(1,e.length-3).split(":"),r=n[0],s=1,o=n.length,a,l,c;s<o;s++)l=n[s],a=s!==o-1?l.lastIndexOf(","):l.length,c=l.substr(0,a),i[r]=isNaN(c)?c.replace(Y_e,"").trim():+c,r=l.substr(a+1).trim();return i},K_e=function(e){var i=e.indexOf("(")+1,n=e.indexOf(")"),r=e.indexOf("(",i);return e.substring(i,~r&&r<n?e.indexOf(")",n+1):n)},J_e=function(e){var i=(e+"").split("("),n=wi[i[0]];return n&&i.length>1&&n.config?n.config.apply(null,~e.indexOf("{")?[Q_e(i[1])]:K_e(e).split(",").map(i$)):wi._CE&&q_e.test(e)?wi._CE("",e):n},_$=function(e){return function(i){return 1-e(1-i)}},w$=function t(e,i){for(var n=e._first,r;n;)n instanceof ro?t(n,i):n.vars.yoyoEase&&(!n._yoyo||!n._repeat)&&n._yoyo!==i&&(n.timeline?t(n.timeline,i):(r=n._ease,n._ease=n._yEase,n._yEase=r,n._yoyo=i)),n=n._next},Np=function(e,i){return e&&(kn(e)?e:wi[e]||J_e(e))||i},_m=function(e,i,n,r){n===void 0&&(n=function(l){return 1-i(1-l)}),r===void 0&&(r=function(l){return l<.5?i(l*2)/2:1-i((1-l)*2)/2});var s={easeIn:i,easeOut:n,easeInOut:r},o;return vo(e,function(a){wi[a]=ra[a]=s,wi[o=a.toLowerCase()]=n;for(var l in s)wi[o+(l==="easeIn"?".in":l==="easeOut"?".out":".inOut")]=wi[a+"."+l]=s[l]}),s},b$=function(e){return function(i){return i<.5?(1-e(1-i*2))/2:.5+e((i-.5)*2)/2}},lR=function t(e,i,n){var r=i>=1?i:1,s=(n||(e?.3:.45))/(i<1?i:1),o=s/hB*(Math.asin(1/r)||0),a=function(h){return h===1?1:r*Math.pow(2,-10*h)*M_e((h-o)*s)+1},l=e==="out"?a:e==="in"?function(c){return 1-a(1-c)}:b$(a);return s=hB/s,l.config=function(c,h){return t(e,c,h)},l},cR=function t(e,i){i===void 0&&(i=1.70158);var n=function(o){return o?--o*o*((i+1)*o+i)+1:0},r=e==="out"?n:e==="in"?function(s){return 1-n(1-s)}:b$(n);return r.config=function(s){return t(e,s)},r};vo("Linear,Quad,Cubic,Quart,Quint,Strong",function(t,e){var i=e<5?e+1:e;_m(t+",Power"+(i-1),e?function(n){return Math.pow(n,i)}:function(n){return n},function(n){return 1-Math.pow(1-n,i)},function(n){return n<.5?Math.pow(n*2,i)/2:1-Math.pow((1-n)*2,i)/2})});wi.Linear.easeNone=wi.none=wi.Linear.easeIn;_m("Elastic",lR("in"),lR("out"),lR());(function(t,e){var i=1/e,n=2*i,r=2.5*i,s=function(a){return a<i?t*a*a:a<n?t*Math.pow(a-1.5/e,2)+.75:a<r?t*(a-=2.25/e)*a+.9375:t*Math.pow(a-2.625/e,2)+.984375};_m("Bounce",function(o){return 1-s(1-o)},s)})(7.5625,2.75);_m("Expo",function(t){return t?Math.pow(2,10*(t-1)):0});_m("Circ",function(t){return-(WZ(1-t*t)-1)});_m("Sine",function(t){return t===1?1:-A_e(t*b_e)+1});_m("Back",cR("in"),cR("out"),cR());wi.SteppedEase=wi.steps=ra.SteppedEase={config:function(e,i){e===void 0&&(e=1);var n=1/e,r=e+(i?0:1),s=i?1:0,o=1-Ji;return function(a){return((r*Cw(0,o,a)|0)+s)*n}}};E0.ease=wi["quad.out"];vo("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(t){return GU+=t+","+t+"Params,"});var S$=function(e,i){this.id=S_e++,e._gsap=this,this.target=e,this.harness=i,this.get=i?i.get:e$,this.set=i?i.getSetter:XU},F_=function(){function t(i){this.vars=i,this._delay=+i.delay||0,(this._repeat=i.repeat===1/0?-2:i.repeat||0)&&(this._rDelay=i.repeatDelay||0,this._yoyo=!!i.yoyo||!!i.yoyoEase),this._ts=1,C0(this,+i.duration,1,1),this.data=i.data,On&&(this._ctx=On,On.data.push(this)),O_||Go.wake()}var e=t.prototype;return e.delay=function(n){return n||n===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+n-this._delay),this._delay=n,this):this._delay},e.duration=function(n){return arguments.length?this.totalDuration(this._repeat>0?n+(n+this._rDelay)*this._repeat:n):this.totalDuration()&&this._dur},e.totalDuration=function(n){return arguments.length?(this._dirty=0,C0(this,this._repeat<0?n:(n-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(n,r){if(P0(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(WC(this,n),!s._dp||s.parent||s$(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&n<this._tDur||this._ts<0&&n>0||!this._tDur&&!n)&&Ec(this._dp,this,this._start-this._delay)}return(this._tTime!==n||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===Ji||!n&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=n),t$(this,n,r)),this},e.time=function(n,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),n+Uj(this))%(this._dur+this._rDelay)||(n?this._dur:0),r):this._time},e.totalProgress=function(n,r){return arguments.length?this.totalTime(this.totalDuration()*n,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(n,r){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-n:n)+Uj(this),r):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(n,r){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(n-1)*s,r):this._repeat?T0(this._tTime,s)+1:1},e.timeScale=function(n){if(!arguments.length)return this._rts===-Ji?0:this._rts;if(this._rts===n)return this;var r=this.parent&&this._ts?HE(this.parent._time,this):this._tTime;return this._rts=+n||0,this._ts=this._ps||n===-Ji?0:this._rts,this.totalTime(Cw(-Math.abs(this._delay),this._tDur,r),!0),jC(this),I_e(this)},e.paused=function(n){return arguments.length?(this._ps!==n&&(this._ps=n,n?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(P0(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==Ji&&(this._tTime-=Ji)))),this):this._ps},e.startTime=function(n){if(arguments.length){this._start=n;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&Ec(r,this,n-this._delay),this}return this._start},e.endTime=function(n){return this._start+(go(n)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(n){var r=this.parent||this._dp;return r?n&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?HE(r.rawTime(n),this):this._tTime:this._tTime},e.revert=function(n){n===void 0&&(n=C_e);var r=ws;return ws=n,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(n),this.totalTime(-.01,n.suppressEvents)),this.data!=="nested"&&n.kill!==!1&&this.kill(),ws=r,this},e.globalTime=function(n){for(var r=this,s=arguments.length?n:r.rawTime();r;)s=r._start+s/(r._ts||1),r=r._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1/0:this._sat.globalTime(n):s},e.repeat=function(n){return arguments.length?(this._repeat=n===1/0?-2:n,kj(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(n){if(arguments.length){var r=this._time;return this._rDelay=n,kj(this),r?this.time(r):this}return this._rDelay},e.yoyo=function(n){return arguments.length?(this._yoyo=n,this):this._yoyo},e.seek=function(n,r){return this.totalTime(Ta(this,n),go(r))},e.restart=function(n,r){return this.play().totalTime(n?-this._delay:0,go(r))},e.play=function(n,r){return n!=null&&this.seek(n,r),this.reversed(!1).paused(!1)},e.reverse=function(n,r){return n!=null&&this.seek(n||this.totalDuration(),r),this.reversed(!0).paused(!1)},e.pause=function(n,r){return n!=null&&this.seek(n,r),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(n){return arguments.length?(!!n!==this.reversed()&&this.timeScale(-this._rts||(n?-Ji:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-Ji,this},e.isActive=function(){var n=this.parent||this._dp,r=this._start,s;return!!(!n||this._ts&&this._initted&&n.isActive()&&(s=n.rawTime(!0))>=r&&s<this.endTime(!0)-Ji)},e.eventCallback=function(n,r,s){var o=this.vars;return arguments.length>1?(r?(o[n]=r,s&&(o[n+"Params"]=s),n==="onUpdate"&&(this._onUpdate=r)):delete o[n],this):o[n]},e.then=function(n){var r=this;return new Promise(function(s){var o=kn(n)?n:n$,a=function(){var c=r.then;r.then=null,kn(o)&&(o=o(r))&&(o.then||o===r)&&(r.then=c),s(o),r.then=c};r._initted&&r.totalProgress()===1&&r._ts>=0||!r._tTime&&r._ts<0?a():r._prom=a})},e.kill=function(){t1(this)},t}();Za(F_.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Ji,_prom:0,_ps:!1,_rts:1});var ro=function(t){jZ(e,t);function e(n,r){var s;return n===void 0&&(n={}),s=t.call(this,n)||this,s.labels={},s.smoothChildTiming=!!n.smoothChildTiming,s.autoRemoveChildren=!!n.autoRemoveChildren,s._sort=go(n.sortChildren),yn&&Ec(n.parent||yn,Lu(s),r),n.reversed&&s.reverse(),n.paused&&s.paused(!0),n.scrollTrigger&&o$(Lu(s),n.scrollTrigger),s}var i=e.prototype;return i.to=function(r,s,o){return B1(0,arguments,this),this},i.from=function(r,s,o){return B1(1,arguments,this),this},i.fromTo=function(r,s,o,a){return B1(2,arguments,this),this},i.set=function(r,s,o){return s.duration=0,s.parent=this,L1(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new or(r,s,Ta(this,o),1),this},i.call=function(r,s,o){return Ec(this,or.delayedCall(0,r,s),o)},i.staggerTo=function(r,s,o,a,l,c,h){return o.duration=s,o.stagger=o.stagger||a,o.onComplete=c,o.onCompleteParams=h,o.parent=this,new or(r,o,Ta(this,l)),this},i.staggerFrom=function(r,s,o,a,l,c,h){return o.runBackwards=1,L1(o).immediateRender=go(o.immediateRender),this.staggerTo(r,s,o,a,l,c,h)},i.staggerFromTo=function(r,s,o,a,l,c,h,u){return a.startAt=o,L1(a).immediateRender=go(a.immediateRender),this.staggerTo(r,s,a,l,c,h,u)},i.render=function(r,s,o){var a=this._time,l=this._dirty?this.totalDuration():this._tDur,c=this._dur,h=r<=0?0:Kr(r),u=this._zTime<0!=r<0&&(this._initted||!c),d,f,p,m,v,g,y,x,b,S,A,E;if(this!==yn&&h>l&&r>=0&&(h=l),h!==this._tTime||o||u){if(a!==this._time&&c&&(h+=this._time-a,r+=this._time-a),d=h,b=this._start,x=this._ts,g=!x,u&&(c||(a=this._zTime),(r||!s)&&(this._zTime=r)),this._repeat){if(A=this._yoyo,v=c+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(v*100+r,s,o);if(d=Kr(h%v),h===l?(m=this._repeat,d=c):(m=~~(h/v),m&&m===h/v&&(d=c,m--),d>c&&(d=c)),S=T0(this._tTime,v),!a&&this._tTime&&S!==m&&this._tTime-S*v-this._dur<=0&&(S=m),A&&m&1&&(d=c-d,E=1),m!==S&&!this._lock){var M=A&&S&1,T=M===(A&&m&1);if(m<S&&(M=!M),a=M?0:h%c?c:h,this._lock=1,this.render(a||(E?0:Kr(m*v)),s,!c)._lock=0,this._tTime=h,!s&&this.parent&&Wa(this,"onRepeat"),this.vars.repeatRefresh&&!E&&(this.invalidate()._lock=1),a&&a!==this._time||g!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(c=this._dur,l=this._tDur,T&&(this._lock=2,a=M?c:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!E&&this.invalidate()),this._lock=0,!this._ts&&!g)return this;w$(this,E)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(y=F_e(this,Kr(a),Kr(d)),y&&(h-=d-(d=y._start))),this._tTime=h,this._time=d,this._act=!x,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,a=0),!a&&d&&!s&&!m&&(Wa(this,"onStart"),this._tTime!==h))return this;if(d>=a&&r>=0)for(f=this._first;f;){if(p=f._next,(f._act||d>=f._start)&&f._ts&&y!==f){if(f.parent!==this)return this.render(r,s,o);if(f.render(f._ts>0?(d-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(d-f._start)*f._ts,s,o),d!==this._time||!this._ts&&!g){y=0,p&&(h+=this._zTime=-Ji);break}}f=p}else{f=this._last;for(var P=r<0?r:d;f;){if(p=f._prev,(f._act||P<=f._end)&&f._ts&&y!==f){if(f.parent!==this)return this.render(r,s,o);if(f.render(f._ts>0?(P-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(P-f._start)*f._ts,s,o||ws&&(f._initted||f._startAt)),d!==this._time||!this._ts&&!g){y=0,p&&(h+=this._zTime=P?-Ji:Ji);break}}f=p}}if(y&&!s&&(this.pause(),y.render(d>=a?0:-Ji)._zTime=d>=a?1:-1,this._ts))return this._start=b,jC(this),this.render(r,s,o);this._onUpdate&&!s&&Wa(this,"onUpdate",!0),(h===l&&this._tTime>=this.totalDuration()||!h&&a)&&(b===this._start||Math.abs(x)!==Math.abs(this._ts))&&(this._lock||((r||!c)&&(h===l&&this._ts>0||!h&&this._ts<0)&&$d(this,1),!s&&!(r<0&&!a)&&(h||a||!l)&&(Wa(this,h===l&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(h<l&&this.timeScale()>0)&&this._prom())))}return this},i.add=function(r,s){var o=this;if(hh(s)||(s=Ta(this,s,r)),!(r instanceof F_)){if(bs(r))return r.forEach(function(a){return o.add(a,s)}),this;if(Vr(r))return this.addLabel(r,s);if(kn(r))r=or.delayedCall(0,r);else return this}return this!==r?Ec(this,r,s):this},i.getChildren=function(r,s,o,a){r===void 0&&(r=!0),s===void 0&&(s=!0),o===void 0&&(o=!0),a===void 0&&(a=-Va);for(var l=[],c=this._first;c;)c._start>=a&&(c instanceof or?s&&l.push(c):(o&&l.push(c),r&&l.push.apply(l,c.getChildren(!0,s,o)))),c=c._next;return l},i.getById=function(r){for(var s=this.getChildren(1,1,1),o=s.length;o--;)if(s[o].vars.id===r)return s[o]},i.remove=function(r){return Vr(r)?this.removeLabel(r):kn(r)?this.killTweensOf(r):(VC(this,r),r===this._recent&&(this._recent=this._last),Fp(this))},i.totalTime=function(r,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Kr(Go.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),t.prototype.totalTime.call(this,r,s),this._forcing=0,this):this._tTime},i.addLabel=function(r,s){return this.labels[r]=Ta(this,s),this},i.removeLabel=function(r){return delete this.labels[r],this},i.addPause=function(r,s,o){var a=or.delayedCall(0,s||L_,o);return a.data="isPause",this._hasPause=1,Ec(this,a,Ta(this,r))},i.removePause=function(r){var s=this._first;for(r=Ta(this,r);s;)s._start===r&&s.data==="isPause"&&$d(s),s=s._next},i.killTweensOf=function(r,s,o){for(var a=this.getTweensOf(r,o),l=a.length;l--;)hd!==a[l]&&a[l].kill(r,s);return this},i.getTweensOf=function(r,s){for(var o=[],a=ja(r),l=this._first,c=hh(s),h;l;)l instanceof or?P_e(l._targets,a)&&(c?(!hd||l._initted&&l._ts)&&l.globalTime(0)<=s&&l.globalTime(l.totalDuration())>s:!s||l.isActive())&&o.push(l):(h=l.getTweensOf(a,s)).length&&o.push.apply(o,h),l=l._next;return o},i.tweenTo=function(r,s){s=s||{};var o=this,a=Ta(o,r),l=s,c=l.startAt,h=l.onStart,u=l.onStartParams,d=l.immediateRender,f,p=or.to(o,Za({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:s.duration||Math.abs((a-(c&&"time"in c?c.time:o._time))/o.timeScale())||Ji,onStart:function(){if(o.pause(),!f){var v=s.duration||Math.abs((a-(c&&"time"in c?c.time:o._time))/o.timeScale());p._dur!==v&&C0(p,v,0,1).render(p._time,!0,!0),f=1}h&&h.apply(p,u||[])}},s));return d?p.render(0):p},i.tweenFromTo=function(r,s,o){return this.tweenTo(s,Za({startAt:{time:Ta(this,r)}},o))},i.recent=function(){return this._recent},i.nextLabel=function(r){return r===void 0&&(r=this._time),zj(this,Ta(this,r))},i.previousLabel=function(r){return r===void 0&&(r=this._time),zj(this,Ta(this,r),1)},i.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+Ji)},i.shiftChildren=function(r,s,o){o===void 0&&(o=0);for(var a=this._first,l=this.labels,c;a;)a._start>=o&&(a._start+=r,a._end+=r),a=a._next;if(s)for(c in l)l[c]>=o&&(l[c]+=r);return Fp(this)},i.invalidate=function(r){var s=this._first;for(this._lock=0;s;)s.invalidate(r),s=s._next;return t.prototype.invalidate.call(this,r)},i.clear=function(r){r===void 0&&(r=!0);for(var s=this._first,o;s;)o=s._next,this.remove(s),s=o;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),Fp(this)},i.totalDuration=function(r){var s=0,o=this,a=o._last,l=Va,c,h,u;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-r:r));if(o._dirty){for(u=o.parent;a;)c=a._prev,a._dirty&&a.totalDuration(),h=a._start,h>l&&o._sort&&a._ts&&!o._lock?(o._lock=1,Ec(o,a,h-a._delay,1)._lock=0):l=h,h<0&&a._ts&&(s-=h,(!u&&!o._dp||u&&u.smoothChildTiming)&&(o._start+=h/o._ts,o._time-=h,o._tTime-=h),o.shiftChildren(-h,!1,-1/0),l=0),a._end>s&&a._ts&&(s=a._end),a=c;C0(o,o===yn&&o._time>s?o._time:s,1,1),o._dirty=0}return o._tDur},e.updateRoot=function(r){if(yn._ts&&(t$(yn,HE(r,yn)),$Z=Go.frame),Go.frame>=Fj){Fj+=$o.autoSleep||120;var s=yn._first;if((!s||!s._ts)&&$o.autoSleep&&Go._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||Go.sleep()}}},e}(F_);Za(ro.prototype,{_lock:0,_hasPause:0,_forcing:0});var Z_e=function(e,i,n,r,s,o,a){var l=new yo(this._pt,e,i,0,1,P$,null,s),c=0,h=0,u,d,f,p,m,v,g,y;for(l.b=n,l.e=r,n+="",r+="",(g=~r.indexOf("random("))&&(r=B_(r)),o&&(y=[n,r],o(y,e,i),n=y[0],r=y[1]),d=n.match(sR)||[];u=sR.exec(r);)p=u[0],m=r.substring(c,u.index),f?f=(f+1)%5:m.substr(-5)==="rgba("&&(f=1),p!==d[h++]&&(v=parseFloat(d[h-1])||0,l._pt={_next:l._pt,p:m||h===1?m:",",s:v,c:p.charAt(1)==="="?Gv(v,p)-v:parseFloat(p)-v,m:f&&f<4?Math.round:0},c=sR.lastIndex);return l.c=c<r.length?r.substring(c,r.length):"",l.fp=a,(YZ.test(r)||g)&&(l.e=0),this._pt=l,l},VU=function(e,i,n,r,s,o,a,l,c,h){kn(r)&&(r=r(s||0,e,o));var u=e[i],d=n!=="get"?n:kn(u)?c?e[i.indexOf("set")||!kn(e["get"+i.substr(3)])?i:"get"+i.substr(3)](c):e[i]():u,f=kn(u)?c?nwe:T$:WU,p;if(Vr(r)&&(~r.indexOf("random(")&&(r=B_(r)),r.charAt(1)==="="&&(p=Gv(d,r)+(ys(d)||0),(p||p===0)&&(r=p))),!h||d!==r||_B)return!isNaN(d*r)&&r!==""?(p=new yo(this._pt,e,i,+d||0,r-(d||0),typeof u=="boolean"?swe:C$,0,f),c&&(p.fp=c),a&&p.modifier(a,this,e),this._pt=p):(!u&&!(i in e)&&kU(i,r),Z_e.call(this,e,i,d,r,f,l||$o.stringFilter,c))},$_e=function(e,i,n,r,s){if(kn(e)&&(e=O1(e,s,i,n,r)),!qc(e)||e.style&&e.nodeType||bs(e)||XZ(e))return Vr(e)?O1(e,s,i,n,r):e;var o={},a;for(a in e)o[a]=O1(e[a],s,i,n,r);return o},A$=function(e,i,n,r,s,o){var a,l,c,h;if(Uo[e]&&(a=new Uo[e]).init(s,a.rawVars?i[e]:$_e(i[e],r,s,o,n),n,r,o)!==!1&&(n._pt=l=new yo(n._pt,s,e,0,1,a.render,a,0,a.priority),n!==wv))for(c=n._ptLookup[n._targets.indexOf(s)],h=a._props.length;h--;)c[a._props[h]]=l;return a},hd,_B,jU=function t(e,i,n){var r=e.vars,s=r.ease,o=r.startAt,a=r.immediateRender,l=r.lazy,c=r.onUpdate,h=r.onUpdateParams,u=r.callbackScope,d=r.runBackwards,f=r.yoyoEase,p=r.keyframes,m=r.autoRevert,v=e._dur,g=e._startAt,y=e._targets,x=e.parent,b=x&&x.data==="nested"?x.vars.targets:y,S=e._overwrite==="auto"&&!OU,A=e.timeline,E,M,T,P,R,U,F,N,W,Q,X,B,j;if(A&&(!p||!s)&&(s="none"),e._ease=Np(s,E0.ease),e._yEase=f?_$(Np(f===!0?s:f,E0.ease)):0,f&&e._yoyo&&!e._repeat&&(f=e._yEase,e._yEase=e._ease,e._ease=f),e._from=!A&&!!r.runBackwards,!A||p&&!r.stagger){if(N=y[0]?Op(y[0]).harness:0,B=N&&r[N.prop],E=GE(r,zU),g&&(g._zTime<0&&g.progress(1),i<0&&d&&a&&!m?g.render(-1,!0):g.revert(d&&v?BM:T_e),g._lazy=0),o){if($d(e._startAt=or.set(y,Za({data:"isStart",overwrite:!1,parent:x,immediateRender:!0,lazy:!g&&go(l),startAt:null,delay:0,onUpdate:c,onUpdateParams:h,callbackScope:u,stagger:0},o))),e._startAt._dp=0,e._startAt._sat=e,i<0&&(ws||!a&&!m)&&e._startAt.revert(BM),a&&v&&i<=0&&n<=0){i&&(e._zTime=i);return}}else if(d&&v&&!g){if(i&&(a=!1),T=Za({overwrite:!1,data:"isFromStart",lazy:a&&!g&&go(l),immediateRender:a,stagger:0,parent:x},E),B&&(T[N.prop]=B),$d(e._startAt=or.set(y,T)),e._startAt._dp=0,e._startAt._sat=e,i<0&&(ws?e._startAt.revert(BM):e._startAt.render(-1,!0)),e._zTime=i,!a)t(e._startAt,Ji,Ji);else if(!i)return}for(e._pt=e._ptCache=0,l=v&&go(l)||l&&!v,M=0;M<y.length;M++){if(R=y[M],F=R._gsap||HU(y)[M]._gsap,e._ptLookup[M]=Q={},pB[F.id]&&Od.length&&zE(),X=b===y?M:b.indexOf(R),N&&(W=new N).init(R,B||E,e,X,b)!==!1&&(e._pt=P=new yo(e._pt,R,W.name,0,1,W.render,W,0,W.priority),W._props.forEach(function(z){Q[z]=P}),W.priority&&(U=1)),!N||B)for(T in E)Uo[T]&&(W=A$(T,E,e,X,R,b))?W.priority&&(U=1):Q[T]=P=VU.call(e,R,T,"get",E[T],X,b,0,r.stringFilter);e._op&&e._op[M]&&e.kill(R,e._op[M]),S&&e._pt&&(hd=e,yn.killTweensOf(R,Q,e.globalTime(i)),j=!e.parent,hd=0),e._pt&&l&&(pB[F.id]=1)}U&&D$(e),e._onInit&&e._onInit(e)}e._onUpdate=c,e._initted=(!e._op||e._pt)&&!j,p&&i<=0&&A.render(Va,!0,!0)},ewe=function(e,i,n,r,s,o,a){var l=(e._pt&&e._ptCache||(e._ptCache={}))[i],c,h,u,d;if(!l)for(l=e._ptCache[i]=[],u=e._ptLookup,d=e._targets.length;d--;){if(c=u[d][i],c&&c.d&&c.d._pt)for(c=c.d._pt;c&&c.p!==i&&c.fp!==i;)c=c._next;if(!c)return _B=1,e.vars[i]="+=0",jU(e,a),_B=0,1;l.push(c)}for(d=l.length;d--;)h=l[d],c=h._pt||h,c.s=(r||r===0)&&!s?r:c.s+(r||0)+o*c.c,c.c=n-c.s,h.e&&(h.e=qn(n)+ys(h.e)),h.b&&(h.b=c.s+ys(h.b))},twe=function(e,i){var n=e[0]?Op(e[0]).harness:0,r=n&&n.aliases,s,o,a,l;if(!r)return i;s=rm({},i);for(o in r)if(o in s)for(l=r[o].split(","),a=l.length;a--;)s[l[a]]=s[o];return s},iwe=function(e,i,n,r){var s=i.ease||r||"power1.inOut",o,a;if(bs(i))a=n[e]||(n[e]=[]),i.forEach(function(l,c){return a.push({t:c/(i.length-1)*100,v:l,e:s})});else for(o in i)a=n[o]||(n[o]=[]),o==="ease"||a.push({t:parseFloat(e),v:i[o],e:s})},O1=function(e,i,n,r,s){return kn(e)?e.call(i,n,r,s):Vr(e)&&~e.indexOf("random(")?B_(e):e},M$=GU+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",E$={};vo(M$+",id,stagger,delay,duration,paused,scrollTrigger",function(t){return E$[t]=1});var or=function(t){jZ(e,t);function e(n,r,s,o){var a;typeof r=="number"&&(s.duration=r,r=s,s=null),a=t.call(this,o?r:L1(r))||this;var l=a.vars,c=l.duration,h=l.delay,u=l.immediateRender,d=l.stagger,f=l.overwrite,p=l.keyframes,m=l.defaults,v=l.scrollTrigger,g=l.yoyoEase,y=r.parent||yn,x=(bs(n)||XZ(n)?hh(n[0]):"length"in r)?[n]:ja(n),b,S,A,E,M,T,P,R;if(a._targets=x.length?HU(x):kE("GSAP target "+n+" not found. https://greensock.com",!$o.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=f,p||d||YS(c)||YS(h)){if(r=a.vars,b=a.timeline=new ro({data:"nested",defaults:m||{},targets:y&&y.data==="nested"?y.vars.targets:x}),b.kill(),b.parent=b._dp=Lu(a),b._start=0,d||YS(c)||YS(h)){if(E=x.length,P=d&&u$(d),qc(d))for(M in d)~M$.indexOf(M)&&(R||(R={}),R[M]=d[M]);for(S=0;S<E;S++)A=GE(r,E$),A.stagger=0,g&&(A.yoyoEase=g),R&&rm(A,R),T=x[S],A.duration=+O1(c,Lu(a),S,T,x),A.delay=(+O1(h,Lu(a),S,T,x)||0)-a._delay,!d&&E===1&&A.delay&&(a._delay=h=A.delay,a._start+=h,A.delay=0),b.to(T,A,P?P(S,T,x):0),b._ease=wi.none;b.duration()?c=h=0:a.timeline=0}else if(p){L1(Za(b.vars.defaults,{ease:"none"})),b._ease=Np(p.ease||r.ease||"none");var U=0,F,N,W;if(bs(p))p.forEach(function(Q){return b.to(x,Q,">")}),b.duration();else{A={};for(M in p)M==="ease"||M==="easeEach"||iwe(M,p[M],A,p.easeEach);for(M in A)for(F=A[M].sort(function(Q,X){return Q.t-X.t}),U=0,S=0;S<F.length;S++)N=F[S],W={ease:N.e,duration:(N.t-(S?F[S-1].t:0))/100*c},W[M]=N.v,b.to(x,W,U),U+=W.duration;b.duration()<c&&b.to({},{duration:c-b.duration()})}}c||a.duration(c=b.duration())}else a.timeline=0;return f===!0&&!OU&&(hd=Lu(a),yn.killTweensOf(x),hd=0),Ec(y,Lu(a),s),r.reversed&&a.reverse(),r.paused&&a.paused(!0),(u||!c&&!p&&a._start===Kr(y._time)&&go(u)&&L_e(Lu(a))&&y.data!=="nested")&&(a._tTime=-Ji,a.render(Math.max(0,-h)||0)),v&&o$(Lu(a),v),a}var i=e.prototype;return i.render=function(r,s,o){var a=this._time,l=this._tDur,c=this._dur,h=r<0,u=r>l-Ji&&!h?l:r<Ji?0:r,d,f,p,m,v,g,y,x,b;if(!c)O_e(this,r,s,o);else if(u!==this._tTime||!r||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==h){if(d=u,x=this.timeline,this._repeat){if(m=c+this._rDelay,this._repeat<-1&&h)return this.totalTime(m*100+r,s,o);if(d=Kr(u%m),u===l?(p=this._repeat,d=c):(p=~~(u/m),p&&p===u/m&&(d=c,p--),d>c&&(d=c)),g=this._yoyo&&p&1,g&&(b=this._yEase,d=c-d),v=T0(this._tTime,m),d===a&&!o&&this._initted)return this._tTime=u,this;p!==v&&(x&&this._yEase&&w$(x,g),this.vars.repeatRefresh&&!g&&!this._lock&&(this._lock=o=1,this.render(Kr(m*p),!0).invalidate()._lock=0))}if(!this._initted){if(a$(this,h?r:d,o,s,u))return this._tTime=0,this;if(a!==this._time)return this;if(c!==this._dur)return this.render(r,s,o)}if(this._tTime=u,this._time=d,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=y=(b||this._ease)(d/c),this._from&&(this.ratio=y=1-y),d&&!a&&!s&&!p&&(Wa(this,"onStart"),this._tTime!==u))return this;for(f=this._pt;f;)f.r(y,f.d),f=f._next;x&&x.render(r<0?r:!d&&g?-Ji:x._dur*x._ease(d/this._dur),s,o)||this._startAt&&(this._zTime=r),this._onUpdate&&!s&&(h&&mB(this,r,s,o),Wa(this,"onUpdate")),this._repeat&&p!==v&&this.vars.onRepeat&&!s&&this.parent&&Wa(this,"onRepeat"),(u===this._tDur||!u)&&this._tTime===u&&(h&&!this._onUpdate&&mB(this,r,!0,!0),(r||!c)&&(u===this._tDur&&this._ts>0||!u&&this._ts<0)&&$d(this,1),!s&&!(h&&!a)&&(u||a||g)&&(Wa(this,u===l?"onComplete":"onReverseComplete",!0),this._prom&&!(u<l&&this.timeScale()>0)&&this._prom()))}return this},i.targets=function(){return this._targets},i.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),t.prototype.invalidate.call(this,r)},i.resetTo=function(r,s,o,a){O_||Go.wake(),this._ts||this.play();var l=Math.min(this._dur,(this._dp._time-this._start)*this._ts),c;return this._initted||jU(this,l),c=this._ease(l/this._dur),ewe(this,r,s,o,a,c,l)?this.resetTo(r,s,o,a):(WC(this,0),this.parent||r$(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},i.kill=function(r,s){if(s===void 0&&(s="all"),!r&&(!s||s==="all"))return this._lazy=this._pt=0,this.parent?t1(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(r,s,hd&&hd.vars.overwrite!==!0)._first||t1(this),this.parent&&o!==this.timeline.totalDuration()&&C0(this,this._dur*this.timeline._tDur/o,0,1),this}var a=this._targets,l=r?ja(r):a,c=this._ptLookup,h=this._pt,u,d,f,p,m,v,g;if((!s||s==="all")&&R_e(a,l))return s==="all"&&(this._pt=0),t1(this);for(u=this._op=this._op||[],s!=="all"&&(Vr(s)&&(m={},vo(s,function(y){return m[y]=1}),s=m),s=twe(a,s)),g=a.length;g--;)if(~l.indexOf(a[g])){d=c[g],s==="all"?(u[g]=s,p=d,f={}):(f=u[g]=u[g]||{},p=s);for(m in p)v=d&&d[m],v&&((!("kill"in v.d)||v.d.kill(m)===!0)&&VC(this,v,"_pt"),delete d[m]),f!=="all"&&(f[m]=1)}return this._initted&&!this._pt&&h&&t1(this),this},e.to=function(r,s){return new e(r,s,arguments[2])},e.from=function(r,s){return B1(1,arguments)},e.delayedCall=function(r,s,o,a){return new e(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:s,onReverseComplete:s,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},e.fromTo=function(r,s,o){return B1(2,arguments)},e.set=function(r,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new e(r,s)},e.killTweensOf=function(r,s,o){return yn.killTweensOf(r,s,o)},e}(F_);Za(or.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});vo("staggerTo,staggerFrom,staggerFromTo",function(t){or[t]=function(){var e=new ro,i=vB.call(arguments,0);return i.splice(t==="staggerFromTo"?5:4,0,0),e[t].apply(e,i)}});var WU=function(e,i,n){return e[i]=n},T$=function(e,i,n){return e[i](n)},nwe=function(e,i,n,r){return e[i](r.fp,n)},rwe=function(e,i,n){return e.setAttribute(i,n)},XU=function(e,i){return kn(e[i])?T$:FU(e[i])&&e.setAttribute?rwe:WU},C$=function(e,i){return i.set(i.t,i.p,Math.round((i.s+i.c*e)*1e6)/1e6,i)},swe=function(e,i){return i.set(i.t,i.p,!!(i.s+i.c*e),i)},P$=function(e,i){var n=i._pt,r="";if(!e&&i.b)r=i.b;else if(e===1&&i.e)r=i.e;else{for(;n;)r=n.p+(n.m?n.m(n.s+n.c*e):Math.round((n.s+n.c*e)*1e4)/1e4)+r,n=n._next;r+=i.c}i.set(i.t,i.p,r,i)},qU=function(e,i){for(var n=i._pt;n;)n.r(e,n.d),n=n._next},owe=function(e,i,n,r){for(var s=this._pt,o;s;)o=s._next,s.p===r&&s.modifier(e,i,n),s=o},awe=function(e){for(var i=this._pt,n,r;i;)r=i._next,i.p===e&&!i.op||i.op===e?VC(this,i,"_pt"):i.dep||(n=1),i=r;return!n},lwe=function(e,i,n,r){r.mSet(e,i,r.m.call(r.tween,n,r.mt),r)},D$=function(e){for(var i=e._pt,n,r,s,o;i;){for(n=i._next,r=s;r&&r.pr>i.pr;)r=r._next;(i._prev=r?r._prev:o)?i._prev._next=i:s=i,(i._next=r)?r._prev=i:o=i,i=n}e._pt=s},yo=function(){function t(i,n,r,s,o,a,l,c,h){this.t=n,this.s=s,this.c=o,this.p=r,this.r=a||C$,this.d=l||this,this.set=c||WU,this.pr=h||0,this._next=i,i&&(i._prev=this)}var e=t.prototype;return e.modifier=function(n,r,s){this.mSet=this.mSet||this.set,this.set=lwe,this.m=n,this.mt=s,this.tween=r},t}();vo(GU+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(t){return zU[t]=1});ra.TweenMax=ra.TweenLite=or;ra.TimelineLite=ra.TimelineMax=ro;yn=new ro({sortChildren:!1,defaults:E0,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});$o.stringFilter=x$;var Up=[],FM={},cwe=[],Hj=0,uwe=0,uR=function(e){return(FM[e]||cwe).map(function(i){return i()})},wB=function(){var e=Date.now(),i=[];e-Hj>2&&(uR("matchMediaInit"),Up.forEach(function(n){var r=n.queries,s=n.conditions,o,a,l,c;for(a in r)o=Pa.matchMedia(r[a]).matches,o&&(l=1),o!==s[a]&&(s[a]=o,c=1);c&&(n.revert(),l&&i.push(n))}),uR("matchMediaRevert"),i.forEach(function(n){return n.onMatch(n)}),Hj=e,uR("matchMedia"))},R$=function(){function t(i,n){this.selector=n&&yB(n),this.data=[],this._r=[],this.isReverted=!1,this.id=uwe++,i&&this.add(i)}var e=t.prototype;return e.add=function(n,r,s){kn(n)&&(s=r,r=n,n=kn);var o=this,a=function(){var c=On,h=o.selector,u;return c&&c!==o&&c.data.push(o),s&&(o.selector=yB(s)),On=o,u=r.apply(o,arguments),kn(u)&&o._r.push(u),On=c,o.selector=h,o.isReverted=!1,u};return o.last=a,n===kn?a(o):n?o[n]=a:a},e.ignore=function(n){var r=On;On=null,n(this),On=r},e.getTweens=function(){var n=[];return this.data.forEach(function(r){return r instanceof t?n.push.apply(n,r.getTweens()):r instanceof or&&!(r.parent&&r.parent.data==="nested")&&n.push(r)}),n},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(n,r){var s=this;if(n){var o=this.getTweens();this.data.forEach(function(l){l.data==="isFlip"&&(l.revert(),l.getChildren(!0,!0,!1).forEach(function(c){return o.splice(o.indexOf(c),1)}))}),o.map(function(l){return{g:l.globalTime(0),t:l}}).sort(function(l,c){return c.g-l.g||-1/0}).forEach(function(l){return l.t.revert(n)}),this.data.forEach(function(l){return!(l instanceof or)&&l.revert&&l.revert(n)}),this._r.forEach(function(l){return l(n,s)}),this.isReverted=!0}else this.data.forEach(function(l){return l.kill&&l.kill()});if(this.clear(),r)for(var a=Up.length;a--;)Up[a].id===this.id&&Up.splice(a,1)},e.revert=function(n){this.kill(n||{})},t}(),hwe=function(){function t(i){this.contexts=[],this.scope=i}var e=t.prototype;return e.add=function(n,r,s){qc(n)||(n={matches:n});var o=new R$(0,s||this.scope),a=o.conditions={},l,c,h;On&&!o.selector&&(o.selector=On.selector),this.contexts.push(o),r=o.add("onMatch",r),o.queries=n;for(c in n)c==="all"?h=1:(l=Pa.matchMedia(n[c]),l&&(Up.indexOf(o)<0&&Up.push(o),(a[c]=l.matches)&&(h=1),l.addListener?l.addListener(wB):l.addEventListener("change",wB)));return h&&r(o),this},e.revert=function(n){this.kill(n||{})},e.kill=function(n){this.contexts.forEach(function(r){return r.kill(n,!0)})},t}(),VE={registerPlugin:function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];i.forEach(function(r){return g$(r)})},timeline:function(e){return new ro(e)},getTweensOf:function(e,i){return yn.getTweensOf(e,i)},getProperty:function(e,i,n,r){Vr(e)&&(e=ja(e)[0]);var s=Op(e||{}).get,o=n?n$:i$;return n==="native"&&(n=""),e&&(i?o((Uo[i]&&Uo[i].get||s)(e,i,n,r)):function(a,l,c){return o((Uo[a]&&Uo[a].get||s)(e,a,l,c))})},quickSetter:function(e,i,n){if(e=ja(e),e.length>1){var r=e.map(function(h){return Ao.quickSetter(h,i,n)}),s=r.length;return function(h){for(var u=s;u--;)r[u](h)}}e=e[0]||{};var o=Uo[i],a=Op(e),l=a.harness&&(a.harness.aliases||{})[i]||i,c=o?function(h){var u=new o;wv._pt=0,u.init(e,n?h+n:h,wv,0,[e]),u.render(1,u),wv._pt&&qU(1,wv)}:a.set(e,l);return o?c:function(h){return c(e,l,n?h+n:h,a,1)}},quickTo:function(e,i,n){var r,s=Ao.to(e,rm((r={},r[i]="+=0.1",r.paused=!0,r),n||{})),o=function(l,c,h){return s.resetTo(i,l,c,h)};return o.tween=s,o},isTweening:function(e){return yn.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Np(e.ease,E0.ease)),Nj(E0,e||{})},config:function(e){return Nj($o,e||{})},registerEffect:function(e){var i=e.name,n=e.effect,r=e.plugins,s=e.defaults,o=e.extendTimeline;(r||"").split(",").forEach(function(a){return a&&!Uo[a]&&!ra[a]&&kE(i+" effect requires "+a+" plugin.")}),oR[i]=function(a,l,c){return n(ja(a),Za(l||{},s),c)},o&&(ro.prototype[i]=function(a,l,c){return this.add(oR[i](a,qc(l)?l:(c=l)&&{},this),c)})},registerEase:function(e,i){wi[e]=Np(i)},parseEase:function(e,i){return arguments.length?Np(e,i):wi},getById:function(e){return yn.getById(e)},exportRoot:function(e,i){e===void 0&&(e={});var n=new ro(e),r,s;for(n.smoothChildTiming=go(e.smoothChildTiming),yn.remove(n),n._dp=0,n._time=n._tTime=yn._time,r=yn._first;r;)s=r._next,(i||!(!r._dur&&r instanceof or&&r.vars.onComplete===r._targets[0]))&&Ec(n,r,r._start-r._delay),r=s;return Ec(yn,n,0),n},context:function(e,i){return e?new R$(e,i):On},matchMedia:function(e){return new hwe(e)},matchMediaRefresh:function(){return Up.forEach(function(e){var i=e.conditions,n,r;for(r in i)i[r]&&(i[r]=!1,n=1);n&&e.revert()})||wB()},addEventListener:function(e,i){var n=FM[e]||(FM[e]=[]);~n.indexOf(i)||n.push(i)},removeEventListener:function(e,i){var n=FM[e],r=n&&n.indexOf(i);r>=0&&n.splice(r,1)},utils:{wrap:V_e,wrapYoyo:j_e,distribute:u$,random:d$,snap:h$,normalize:H_e,getUnit:ys,clamp:U_e,splitColor:v$,toArray:ja,selector:yB,mapRange:p$,pipe:z_e,unitize:G_e,interpolate:W_e,shuffle:c$},install:JZ,effects:oR,ticker:Go,updateRoot:ro.updateRoot,plugins:Uo,globalTimeline:yn,core:{PropTween:yo,globals:ZZ,Tween:or,Timeline:ro,Animation:F_,getCache:Op,_removeLinkedListItem:VC,reverting:function(){return ws},context:function(e){return e&&On&&(On.data.push(e),e._ctx=On),On},suppressOverwrites:function(e){return OU=e}}};vo("to,from,fromTo,delayedCall,set,killTweensOf",function(t){return VE[t]=or[t]});Go.add(ro.updateRoot);wv=VE.to({},{duration:0});var dwe=function(e,i){for(var n=e._pt;n&&n.p!==i&&n.op!==i&&n.fp!==i;)n=n._next;return n},fwe=function(e,i){var n=e._targets,r,s,o;for(r in i)for(s=n.length;s--;)o=e._ptLookup[s][r],o&&(o=o.d)&&(o._pt&&(o=dwe(o,r)),o&&o.modifier&&o.modifier(i[r],e,n[s],r))},hR=function(e,i){return{name:e,rawVars:1,init:function(r,s,o){o._onInit=function(a){var l,c;if(Vr(s)&&(l={},vo(s,function(h){return l[h]=1}),s=l),i){l={};for(c in s)l[c]=i(s[c]);s=l}fwe(a,s)}}}},Ao=VE.registerPlugin({name:"attr",init:function(e,i,n,r,s){var o,a,l;this.tween=n;for(o in i)l=e.getAttribute(o)||"",a=this.add(e,"setAttribute",(l||0)+"",i[o],r,s,0,0,o),a.op=o,a.b=l,this._props.push(o)},render:function(e,i){for(var n=i._pt;n;)ws?n.set(n.t,n.p,n.b,n):n.r(e,n.d),n=n._next}},{name:"endArray",init:function(e,i){for(var n=i.length;n--;)this.add(e,n,e[n]||0,i[n],0,0,0,0,0,1)}},hR("roundProps",xB),hR("modifiers"),hR("snap",h$))||VE;or.version=ro.version=Ao.version="3.12.2";KZ=1;NU()&&P0();wi.Power0;wi.Power1;wi.Power2;wi.Power3;wi.Power4;wi.Linear;wi.Quad;wi.Cubic;wi.Quart;wi.Quint;wi.Strong;wi.Elastic;wi.Back;wi.SteppedEase;wi.Bounce;wi.Sine;wi.Expo;wi.Circ;/*!
 * CSSPlugin 3.12.2
 * https://greensock.com
 *
 * Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Vj,dd,Hv,YU,bp,jj,QU,pwe=function(){return typeof window<"u"},dh={},ep=180/Math.PI,Vv=Math.PI/180,fg=Math.atan2,Wj=1e8,KU=/([A-Z])/g,mwe=/(left|right|width|margin|padding|x)/i,gwe=/[\s,\(]\S/,Ic={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},bB=function(e,i){return i.set(i.t,i.p,Math.round((i.s+i.c*e)*1e4)/1e4+i.u,i)},vwe=function(e,i){return i.set(i.t,i.p,e===1?i.e:Math.round((i.s+i.c*e)*1e4)/1e4+i.u,i)},ywe=function(e,i){return i.set(i.t,i.p,e?Math.round((i.s+i.c*e)*1e4)/1e4+i.u:i.b,i)},xwe=function(e,i){var n=i.s+i.c*e;i.set(i.t,i.p,~~(n+(n<0?-.5:.5))+i.u,i)},I$=function(e,i){return i.set(i.t,i.p,e?i.e:i.b,i)},L$=function(e,i){return i.set(i.t,i.p,e!==1?i.b:i.e,i)},_we=function(e,i,n){return e.style[i]=n},wwe=function(e,i,n){return e.style.setProperty(i,n)},bwe=function(e,i,n){return e._gsap[i]=n},Swe=function(e,i,n){return e._gsap.scaleX=e._gsap.scaleY=n},Awe=function(e,i,n,r,s){var o=e._gsap;o.scaleX=o.scaleY=n,o.renderTransform(s,o)},Mwe=function(e,i,n,r,s){var o=e._gsap;o[i]=n,o.renderTransform(s,o)},bn="transform",Ol=bn+"Origin",Ewe=function t(e,i){var n=this,r=this.target,s=r.style;if(e in dh&&s){if(this.tfm=this.tfm||{},e!=="transform")e=Ic[e]||e,~e.indexOf(",")?e.split(",").forEach(function(o){return n.tfm[o]=ku(r,o)}):this.tfm[e]=r._gsap.x?r._gsap[e]:ku(r,e);else return Ic.transform.split(",").forEach(function(o){return t.call(n,o,i)});if(this.props.indexOf(bn)>=0)return;r._gsap.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(Ol,i,"")),e=bn}(s||i)&&this.props.push(e,i,s[e])},B$=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},Twe=function(){var e=this.props,i=this.target,n=i.style,r=i._gsap,s,o;for(s=0;s<e.length;s+=3)e[s+1]?i[e[s]]=e[s+2]:e[s+2]?n[e[s]]=e[s+2]:n.removeProperty(e[s].substr(0,2)==="--"?e[s]:e[s].replace(KU,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)r[o]=this.tfm[o];r.svg&&(r.renderTransform(),i.setAttribute("data-svg-origin",this.svgo||"")),s=QU(),(!s||!s.isStart)&&!n[bn]&&(B$(n),r.uncache=1)}},O$=function(e,i){var n={target:e,props:[],revert:Twe,save:Ewe};return e._gsap||Ao.core.getCache(e),i&&i.split(",").forEach(function(r){return n.save(r)}),n},F$,SB=function(e,i){var n=dd.createElementNS?dd.createElementNS((i||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):dd.createElement(e);return n.style?n:dd.createElement(e)},Gc=function t(e,i,n){var r=getComputedStyle(e);return r[i]||r.getPropertyValue(i.replace(KU,"-$1").toLowerCase())||r.getPropertyValue(i)||!n&&t(e,D0(i)||i,1)||""},Xj="O,Moz,ms,Ms,Webkit".split(","),D0=function(e,i,n){var r=i||bp,s=r.style,o=5;if(e in s&&!n)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);o--&&!(Xj[o]+e in s););return o<0?null:(o===3?"ms":o>=0?Xj[o]:"")+e},AB=function(){pwe()&&window.document&&(Vj=window,dd=Vj.document,Hv=dd.documentElement,bp=SB("div")||{style:{}},SB("div"),bn=D0(bn),Ol=bn+"Origin",bp.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",F$=!!D0("perspective"),QU=Ao.core.reverting,YU=1)},dR=function t(e){var i=SB("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),n=this.parentNode,r=this.nextSibling,s=this.style.cssText,o;if(Hv.appendChild(i),i.appendChild(this),this.style.display="block",e)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=t}catch{}else this._gsapBBox&&(o=this._gsapBBox());return n&&(r?n.insertBefore(this,r):n.appendChild(this)),Hv.removeChild(i),this.style.cssText=s,o},qj=function(e,i){for(var n=i.length;n--;)if(e.hasAttribute(i[n]))return e.getAttribute(i[n])},N$=function(e){var i;try{i=e.getBBox()}catch{i=dR.call(e,!0)}return i&&(i.width||i.height)||e.getBBox===dR||(i=dR.call(e,!0)),i&&!i.width&&!i.x&&!i.y?{x:+qj(e,["x","cx","x1"])||0,y:+qj(e,["y","cy","y1"])||0,width:0,height:0}:i},U$=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&N$(e))},N_=function(e,i){if(i){var n=e.style;i in dh&&i!==Ol&&(i=bn),n.removeProperty?((i.substr(0,2)==="ms"||i.substr(0,6)==="webkit")&&(i="-"+i),n.removeProperty(i.replace(KU,"-$1").toLowerCase())):n.removeAttribute(i)}},fd=function(e,i,n,r,s,o){var a=new yo(e._pt,i,n,0,1,o?L$:I$);return e._pt=a,a.b=r,a.e=s,e._props.push(n),a},Yj={deg:1,rad:1,turn:1},Cwe={grid:1,flex:1},ef=function t(e,i,n,r){var s=parseFloat(n)||0,o=(n+"").trim().substr((s+"").length)||"px",a=bp.style,l=mwe.test(i),c=e.tagName.toLowerCase()==="svg",h=(c?"client":"offset")+(l?"Width":"Height"),u=100,d=r==="px",f=r==="%",p,m,v,g;return r===o||!s||Yj[r]||Yj[o]?s:(o!=="px"&&!d&&(s=t(e,i,n,"px")),g=e.getCTM&&U$(e),(f||o==="%")&&(dh[i]||~i.indexOf("adius"))?(p=g?e.getBBox()[l?"width":"height"]:e[h],qn(f?s/p*u:s/100*p)):(a[l?"width":"height"]=u+(d?o:r),m=~i.indexOf("adius")||r==="em"&&e.appendChild&&!c?e:e.parentNode,g&&(m=(e.ownerSVGElement||{}).parentNode),(!m||m===dd||!m.appendChild)&&(m=dd.body),v=m._gsap,v&&f&&v.width&&l&&v.time===Go.time&&!v.uncache?qn(s/v.width*u):((f||o==="%")&&!Cwe[Gc(m,"display")]&&(a.position=Gc(e,"position")),m===e&&(a.position="static"),m.appendChild(bp),p=bp[h],m.removeChild(bp),a.position="absolute",l&&f&&(v=Op(m),v.time=Go.time,v.width=m[h]),qn(d?p*s/u:p&&s?u/p*s:0))))},ku=function(e,i,n,r){var s;return YU||AB(),i in Ic&&i!=="transform"&&(i=Ic[i],~i.indexOf(",")&&(i=i.split(",")[0])),dh[i]&&i!=="transform"?(s=k_(e,r),s=i!=="transformOrigin"?s[i]:s.svg?s.origin:WE(Gc(e,Ol))+" "+s.zOrigin+"px"):(s=e.style[i],(!s||s==="auto"||r||~(s+"").indexOf("calc("))&&(s=jE[i]&&jE[i](e,i,n)||Gc(e,i)||e$(e,i)||(i==="opacity"?1:0))),n&&!~(s+"").trim().indexOf(" ")?ef(e,i,s,n)+n:s},Pwe=function(e,i,n,r){if(!n||n==="none"){var s=D0(i,e,1),o=s&&Gc(e,s,1);o&&o!==n?(i=s,n=o):i==="borderColor"&&(n=Gc(e,"borderTopColor"))}var a=new yo(this._pt,e.style,i,0,1,P$),l=0,c=0,h,u,d,f,p,m,v,g,y,x,b,S;if(a.b=n,a.e=r,n+="",r+="",r==="auto"&&(e.style[i]=r,r=Gc(e,i)||r,e.style[i]=n),h=[n,r],x$(h),n=h[0],r=h[1],d=n.match(_v)||[],S=r.match(_v)||[],S.length){for(;u=_v.exec(r);)v=u[0],y=r.substring(l,u.index),p?p=(p+1)%5:(y.substr(-5)==="rgba("||y.substr(-5)==="hsla(")&&(p=1),v!==(m=d[c++]||"")&&(f=parseFloat(m)||0,b=m.substr((f+"").length),v.charAt(1)==="="&&(v=Gv(f,v)+b),g=parseFloat(v),x=v.substr((g+"").length),l=_v.lastIndex-x.length,x||(x=x||$o.units[i]||b,l===r.length&&(r+=x,a.e+=x)),b!==x&&(f=ef(e,i,m,x)||0),a._pt={_next:a._pt,p:y||c===1?y:",",s:f,c:g-f,m:p&&p<4||i==="zIndex"?Math.round:0});a.c=l<r.length?r.substring(l,r.length):""}else a.r=i==="display"&&r==="none"?L$:I$;return YZ.test(r)&&(a.e=0),this._pt=a,a},Qj={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Dwe=function(e){var i=e.split(" "),n=i[0],r=i[1]||"50%";return(n==="top"||n==="bottom"||r==="left"||r==="right")&&(e=n,n=r,r=e),i[0]=Qj[n]||n,i[1]=Qj[r]||r,i.join(" ")},Rwe=function(e,i){if(i.tween&&i.tween._time===i.tween._dur){var n=i.t,r=n.style,s=i.u,o=n._gsap,a,l,c;if(s==="all"||s===!0)r.cssText="",l=1;else for(s=s.split(","),c=s.length;--c>-1;)a=s[c],dh[a]&&(l=1,a=a==="transformOrigin"?Ol:bn),N_(n,a);l&&(N_(n,bn),o&&(o.svg&&n.removeAttribute("transform"),k_(n,1),o.uncache=1,B$(r)))}},jE={clearProps:function(e,i,n,r,s){if(s.data!=="isFromStart"){var o=e._pt=new yo(e._pt,i,n,0,0,Rwe);return o.u=r,o.pr=-10,o.tween=s,e._props.push(n),1}}},U_=[1,0,0,1,0,0],k$={},z$=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},Kj=function(e){var i=Gc(e,bn);return z$(i)?U_:i.substr(7).match(qZ).map(qn)},JU=function(e,i){var n=e._gsap||Op(e),r=e.style,s=Kj(e),o,a,l,c;return n.svg&&e.getAttribute("transform")?(l=e.transform.baseVal.consolidate().matrix,s=[l.a,l.b,l.c,l.d,l.e,l.f],s.join(",")==="1,0,0,1,0,0"?U_:s):(s===U_&&!e.offsetParent&&e!==Hv&&!n.svg&&(l=r.display,r.display="block",o=e.parentNode,(!o||!e.offsetParent)&&(c=1,a=e.nextElementSibling,Hv.appendChild(e)),s=Kj(e),l?r.display=l:N_(e,"display"),c&&(a?o.insertBefore(e,a):o?o.appendChild(e):Hv.removeChild(e))),i&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},MB=function(e,i,n,r,s,o){var a=e._gsap,l=s||JU(e,!0),c=a.xOrigin||0,h=a.yOrigin||0,u=a.xOffset||0,d=a.yOffset||0,f=l[0],p=l[1],m=l[2],v=l[3],g=l[4],y=l[5],x=i.split(" "),b=parseFloat(x[0])||0,S=parseFloat(x[1])||0,A,E,M,T;n?l!==U_&&(E=f*v-p*m)&&(M=b*(v/E)+S*(-m/E)+(m*y-v*g)/E,T=b*(-p/E)+S*(f/E)-(f*y-p*g)/E,b=M,S=T):(A=N$(e),b=A.x+(~x[0].indexOf("%")?b/100*A.width:b),S=A.y+(~(x[1]||x[0]).indexOf("%")?S/100*A.height:S)),r||r!==!1&&a.smooth?(g=b-c,y=S-h,a.xOffset=u+(g*f+y*m)-g,a.yOffset=d+(g*p+y*v)-y):a.xOffset=a.yOffset=0,a.xOrigin=b,a.yOrigin=S,a.smooth=!!r,a.origin=i,a.originIsAbsolute=!!n,e.style[Ol]="0px 0px",o&&(fd(o,a,"xOrigin",c,b),fd(o,a,"yOrigin",h,S),fd(o,a,"xOffset",u,a.xOffset),fd(o,a,"yOffset",d,a.yOffset)),e.setAttribute("data-svg-origin",b+" "+S)},k_=function(e,i){var n=e._gsap||new S$(e);if("x"in n&&!i&&!n.uncache)return n;var r=e.style,s=n.scaleX<0,o="px",a="deg",l=getComputedStyle(e),c=Gc(e,Ol)||"0",h,u,d,f,p,m,v,g,y,x,b,S,A,E,M,T,P,R,U,F,N,W,Q,X,B,j,z,k,G,Z,K,re;return h=u=d=m=v=g=y=x=b=0,f=p=1,n.svg=!!(e.getCTM&&U$(e)),l.translate&&((l.translate!=="none"||l.scale!=="none"||l.rotate!=="none")&&(r[bn]=(l.translate!=="none"?"translate3d("+(l.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(l.rotate!=="none"?"rotate("+l.rotate+") ":"")+(l.scale!=="none"?"scale("+l.scale.split(" ").join(",")+") ":"")+(l[bn]!=="none"?l[bn]:"")),r.scale=r.rotate=r.translate="none"),E=JU(e,n.svg),n.svg&&(n.uncache?(B=e.getBBox(),c=n.xOrigin-B.x+"px "+(n.yOrigin-B.y)+"px",X=""):X=!i&&e.getAttribute("data-svg-origin"),MB(e,X||c,!!X||n.originIsAbsolute,n.smooth!==!1,E)),S=n.xOrigin||0,A=n.yOrigin||0,E!==U_&&(R=E[0],U=E[1],F=E[2],N=E[3],h=W=E[4],u=Q=E[5],E.length===6?(f=Math.sqrt(R*R+U*U),p=Math.sqrt(N*N+F*F),m=R||U?fg(U,R)*ep:0,y=F||N?fg(F,N)*ep+m:0,y&&(p*=Math.abs(Math.cos(y*Vv))),n.svg&&(h-=S-(S*R+A*F),u-=A-(S*U+A*N))):(re=E[6],Z=E[7],z=E[8],k=E[9],G=E[10],K=E[11],h=E[12],u=E[13],d=E[14],M=fg(re,G),v=M*ep,M&&(T=Math.cos(-M),P=Math.sin(-M),X=W*T+z*P,B=Q*T+k*P,j=re*T+G*P,z=W*-P+z*T,k=Q*-P+k*T,G=re*-P+G*T,K=Z*-P+K*T,W=X,Q=B,re=j),M=fg(-F,G),g=M*ep,M&&(T=Math.cos(-M),P=Math.sin(-M),X=R*T-z*P,B=U*T-k*P,j=F*T-G*P,K=N*P+K*T,R=X,U=B,F=j),M=fg(U,R),m=M*ep,M&&(T=Math.cos(M),P=Math.sin(M),X=R*T+U*P,B=W*T+Q*P,U=U*T-R*P,Q=Q*T-W*P,R=X,W=B),v&&Math.abs(v)+Math.abs(m)>359.9&&(v=m=0,g=180-g),f=qn(Math.sqrt(R*R+U*U+F*F)),p=qn(Math.sqrt(Q*Q+re*re)),M=fg(W,Q),y=Math.abs(M)>2e-4?M*ep:0,b=K?1/(K<0?-K:K):0),n.svg&&(X=e.getAttribute("transform"),n.forceCSS=e.setAttribute("transform","")||!z$(Gc(e,bn)),X&&e.setAttribute("transform",X))),Math.abs(y)>90&&Math.abs(y)<270&&(s?(f*=-1,y+=m<=0?180:-180,m+=m<=0?180:-180):(p*=-1,y+=y<=0?180:-180)),i=i||n.uncache,n.x=h-((n.xPercent=h&&(!i&&n.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-h)?-50:0)))?e.offsetWidth*n.xPercent/100:0)+o,n.y=u-((n.yPercent=u&&(!i&&n.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-u)?-50:0)))?e.offsetHeight*n.yPercent/100:0)+o,n.z=d+o,n.scaleX=qn(f),n.scaleY=qn(p),n.rotation=qn(m)+a,n.rotationX=qn(v)+a,n.rotationY=qn(g)+a,n.skewX=y+a,n.skewY=x+a,n.transformPerspective=b+o,(n.zOrigin=parseFloat(c.split(" ")[2])||0)&&(r[Ol]=WE(c)),n.xOffset=n.yOffset=0,n.force3D=$o.force3D,n.renderTransform=n.svg?Lwe:F$?G$:Iwe,n.uncache=0,n},WE=function(e){return(e=e.split(" "))[0]+" "+e[1]},fR=function(e,i,n){var r=ys(i);return qn(parseFloat(i)+parseFloat(ef(e,"x",n+"px",r)))+r},Iwe=function(e,i){i.z="0px",i.rotationY=i.rotationX="0deg",i.force3D=0,G$(e,i)},Nf="0deg",gx="0px",Uf=") ",G$=function(e,i){var n=i||this,r=n.xPercent,s=n.yPercent,o=n.x,a=n.y,l=n.z,c=n.rotation,h=n.rotationY,u=n.rotationX,d=n.skewX,f=n.skewY,p=n.scaleX,m=n.scaleY,v=n.transformPerspective,g=n.force3D,y=n.target,x=n.zOrigin,b="",S=g==="auto"&&e&&e!==1||g===!0;if(x&&(u!==Nf||h!==Nf)){var A=parseFloat(h)*Vv,E=Math.sin(A),M=Math.cos(A),T;A=parseFloat(u)*Vv,T=Math.cos(A),o=fR(y,o,E*T*-x),a=fR(y,a,-Math.sin(A)*-x),l=fR(y,l,M*T*-x+x)}v!==gx&&(b+="perspective("+v+Uf),(r||s)&&(b+="translate("+r+"%, "+s+"%) "),(S||o!==gx||a!==gx||l!==gx)&&(b+=l!==gx||S?"translate3d("+o+", "+a+", "+l+") ":"translate("+o+", "+a+Uf),c!==Nf&&(b+="rotate("+c+Uf),h!==Nf&&(b+="rotateY("+h+Uf),u!==Nf&&(b+="rotateX("+u+Uf),(d!==Nf||f!==Nf)&&(b+="skew("+d+", "+f+Uf),(p!==1||m!==1)&&(b+="scale("+p+", "+m+Uf),y.style[bn]=b||"translate(0, 0)"},Lwe=function(e,i){var n=i||this,r=n.xPercent,s=n.yPercent,o=n.x,a=n.y,l=n.rotation,c=n.skewX,h=n.skewY,u=n.scaleX,d=n.scaleY,f=n.target,p=n.xOrigin,m=n.yOrigin,v=n.xOffset,g=n.yOffset,y=n.forceCSS,x=parseFloat(o),b=parseFloat(a),S,A,E,M,T;l=parseFloat(l),c=parseFloat(c),h=parseFloat(h),h&&(h=parseFloat(h),c+=h,l+=h),l||c?(l*=Vv,c*=Vv,S=Math.cos(l)*u,A=Math.sin(l)*u,E=Math.sin(l-c)*-d,M=Math.cos(l-c)*d,c&&(h*=Vv,T=Math.tan(c-h),T=Math.sqrt(1+T*T),E*=T,M*=T,h&&(T=Math.tan(h),T=Math.sqrt(1+T*T),S*=T,A*=T)),S=qn(S),A=qn(A),E=qn(E),M=qn(M)):(S=u,M=d,A=E=0),(x&&!~(o+"").indexOf("px")||b&&!~(a+"").indexOf("px"))&&(x=ef(f,"x",o,"px"),b=ef(f,"y",a,"px")),(p||m||v||g)&&(x=qn(x+p-(p*S+m*E)+v),b=qn(b+m-(p*A+m*M)+g)),(r||s)&&(T=f.getBBox(),x=qn(x+r/100*T.width),b=qn(b+s/100*T.height)),T="matrix("+S+","+A+","+E+","+M+","+x+","+b+")",f.setAttribute("transform",T),y&&(f.style[bn]=T)},Bwe=function(e,i,n,r,s){var o=360,a=Vr(s),l=parseFloat(s)*(a&&~s.indexOf("rad")?ep:1),c=l-r,h=r+c+"deg",u,d;return a&&(u=s.split("_")[1],u==="short"&&(c%=o,c!==c%(o/2)&&(c+=c<0?o:-o)),u==="cw"&&c<0?c=(c+o*Wj)%o-~~(c/o)*o:u==="ccw"&&c>0&&(c=(c-o*Wj)%o-~~(c/o)*o)),e._pt=d=new yo(e._pt,i,n,r,c,vwe),d.e=h,d.u="deg",e._props.push(n),d},Jj=function(e,i){for(var n in i)e[n]=i[n];return e},Owe=function(e,i,n){var r=Jj({},n._gsap),s="perspective,force3D,transformOrigin,svgOrigin",o=n.style,a,l,c,h,u,d,f,p;r.svg?(c=n.getAttribute("transform"),n.setAttribute("transform",""),o[bn]=i,a=k_(n,1),N_(n,bn),n.setAttribute("transform",c)):(c=getComputedStyle(n)[bn],o[bn]=i,a=k_(n,1),o[bn]=c);for(l in dh)c=r[l],h=a[l],c!==h&&s.indexOf(l)<0&&(f=ys(c),p=ys(h),u=f!==p?ef(n,l,c,p):parseFloat(c),d=parseFloat(h),e._pt=new yo(e._pt,a,l,u,d-u,bB),e._pt.u=p||0,e._props.push(l));Jj(a,r)};vo("padding,margin,Width,Radius",function(t,e){var i="Top",n="Right",r="Bottom",s="Left",o=(e<3?[i,n,r,s]:[i+s,i+n,r+n,r+s]).map(function(a){return e<2?t+a:"border"+a+t});jE[e>1?"border"+t:t]=function(a,l,c,h,u){var d,f;if(arguments.length<4)return d=o.map(function(p){return ku(a,p,c)}),f=d.join(" "),f.split(d[0]).length===5?d[0]:f;d=(h+"").split(" "),f={},o.forEach(function(p,m){return f[p]=d[m]=d[m]||d[(m-1)/2|0]}),a.init(l,f,u)}});var H$={name:"css",register:AB,targetTest:function(e){return e.style&&e.nodeType},init:function(e,i,n,r,s){var o=this._props,a=e.style,l=n.vars.startAt,c,h,u,d,f,p,m,v,g,y,x,b,S,A,E,M;YU||AB(),this.styles=this.styles||O$(e),M=this.styles.props,this.tween=n;for(m in i)if(m!=="autoRound"&&(h=i[m],!(Uo[m]&&A$(m,i,n,r,e,s)))){if(f=typeof h,p=jE[m],f==="function"&&(h=h.call(n,r,e,s),f=typeof h),f==="string"&&~h.indexOf("random(")&&(h=B_(h)),p)p(this,e,m,h,n)&&(E=1);else if(m.substr(0,2)==="--")c=(getComputedStyle(e).getPropertyValue(m)+"").trim(),h+="",Fd.lastIndex=0,Fd.test(c)||(v=ys(c),g=ys(h)),g?v!==g&&(c=ef(e,m,c,g)+g):v&&(h+=v),this.add(a,"setProperty",c,h,r,s,0,0,m),o.push(m),M.push(m,0,a[m]);else if(f!=="undefined"){if(l&&m in l?(c=typeof l[m]=="function"?l[m].call(n,r,e,s):l[m],Vr(c)&&~c.indexOf("random(")&&(c=B_(c)),ys(c+"")||(c+=$o.units[m]||ys(ku(e,m))||""),(c+"").charAt(1)==="="&&(c=ku(e,m))):c=ku(e,m),d=parseFloat(c),y=f==="string"&&h.charAt(1)==="="&&h.substr(0,2),y&&(h=h.substr(2)),u=parseFloat(h),m in Ic&&(m==="autoAlpha"&&(d===1&&ku(e,"visibility")==="hidden"&&u&&(d=0),M.push("visibility",0,a.visibility),fd(this,a,"visibility",d?"inherit":"hidden",u?"inherit":"hidden",!u)),m!=="scale"&&m!=="transform"&&(m=Ic[m],~m.indexOf(",")&&(m=m.split(",")[0]))),x=m in dh,x){if(this.styles.save(m),b||(S=e._gsap,S.renderTransform&&!i.parseTransform||k_(e,i.parseTransform),A=i.smoothOrigin!==!1&&S.smooth,b=this._pt=new yo(this._pt,a,bn,0,1,S.renderTransform,S,0,-1),b.dep=1),m==="scale")this._pt=new yo(this._pt,S,"scaleY",S.scaleY,(y?Gv(S.scaleY,y+u):u)-S.scaleY||0,bB),this._pt.u=0,o.push("scaleY",m),m+="X";else if(m==="transformOrigin"){M.push(Ol,0,a[Ol]),h=Dwe(h),S.svg?MB(e,h,0,A,0,this):(g=parseFloat(h.split(" ")[2])||0,g!==S.zOrigin&&fd(this,S,"zOrigin",S.zOrigin,g),fd(this,a,m,WE(c),WE(h)));continue}else if(m==="svgOrigin"){MB(e,h,1,A,0,this);continue}else if(m in k$){Bwe(this,S,m,d,y?Gv(d,y+h):h);continue}else if(m==="smoothOrigin"){fd(this,S,"smooth",S.smooth,h);continue}else if(m==="force3D"){S[m]=h;continue}else if(m==="transform"){Owe(this,h,e);continue}}else m in a||(m=D0(m)||m);if(x||(u||u===0)&&(d||d===0)&&!gwe.test(h)&&m in a)v=(c+"").substr((d+"").length),u||(u=0),g=ys(h)||(m in $o.units?$o.units[m]:v),v!==g&&(d=ef(e,m,c,g)),this._pt=new yo(this._pt,x?S:a,m,d,(y?Gv(d,y+u):u)-d,!x&&(g==="px"||m==="zIndex")&&i.autoRound!==!1?xwe:bB),this._pt.u=g||0,v!==g&&g!=="%"&&(this._pt.b=c,this._pt.r=ywe);else if(m in a)Pwe.call(this,e,m,c,y?y+h:h);else if(m in e)this.add(e,m,c||e[m],y?y+h:h,r,s);else if(m!=="parseTransform"){kU(m,h);continue}x||(m in a?M.push(m,0,a[m]):M.push(m,1,c||e[m])),o.push(m)}}E&&D$(this)},render:function(e,i){if(i.tween._time||!QU())for(var n=i._pt;n;)n.r(e,n.d),n=n._next;else i.styles.revert()},get:ku,aliases:Ic,getSetter:function(e,i,n){var r=Ic[i];return r&&r.indexOf(",")<0&&(i=r),i in dh&&i!==Ol&&(e._gsap.x||ku(e,"x"))?n&&jj===n?i==="scale"?Swe:bwe:(jj=n||{})&&(i==="scale"?Awe:Mwe):e.style&&!FU(e.style[i])?_we:~i.indexOf("-")?wwe:XU(e,i)},core:{_removeProperty:N_,_getMatrix:JU}};Ao.utils.checkPrefix=D0;Ao.core.getStyleSaver=O$;(function(t,e,i,n){var r=vo(t+","+e+","+i,function(s){dh[s]=1});vo(e,function(s){$o.units[s]="deg",k$[s]=1}),Ic[r[13]]=t+","+e,vo(n,function(s){var o=s.split(":");Ic[o[1]]=r[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");vo("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(t){$o.units[t]="px"});Ao.registerPlugin(H$);var n1=Ao.registerPlugin(H$)||Ao;n1.core.Tween;var lo=function(){return lo=Object.assign||function(e){for(var i,n=1,r=arguments.length;n<r;n++){i=arguments[n];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},lo.apply(this,arguments)};function XE(t,e,i){if(i||arguments.length===2)for(var n=0,r=e.length,s;n<r;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))}var on="-ms-",F1="-moz-",Oi="-webkit-",V$="comm",XC="rule",ZU="decl",Fwe="@import",j$="@keyframes",Nwe="@layer",Uwe=Math.abs,$U=String.fromCharCode,EB=Object.assign;function kwe(t,e){return Fr(t,0)^45?(((e<<2^Fr(t,0))<<2^Fr(t,1))<<2^Fr(t,2))<<2^Fr(t,3):0}function W$(t){return t.trim()}function Bu(t,e){return(t=e.exec(t))?t[0]:t}function li(t,e,i){return t.replace(e,i)}function NM(t,e){return t.indexOf(e)}function Fr(t,e){return t.charCodeAt(e)|0}function R0(t,e,i){return t.slice(e,i)}function wc(t){return t.length}function X$(t){return t.length}function r1(t,e){return e.push(t),t}function zwe(t,e){return t.map(e).join("")}function Zj(t,e){return t.filter(function(i){return!Bu(i,e)})}var qC=1,I0=1,q$=0,$a=0,lr=0,sy="";function YC(t,e,i,n,r,s,o,a){return{value:t,root:e,parent:i,type:n,props:r,children:s,line:qC,column:I0,length:o,return:"",siblings:a}}function Jh(t,e){return EB(YC("",null,null,"",null,null,0,t.siblings),t,{length:-t.length},e)}function pg(t){for(;t.root;)t=Jh(t.root,{children:[t]});r1(t,t.siblings)}function Gwe(){return lr}function Hwe(){return lr=$a>0?Fr(sy,--$a):0,I0--,lr===10&&(I0=1,qC--),lr}function Fl(){return lr=$a<q$?Fr(sy,$a++):0,I0++,lr===10&&(I0=1,qC++),lr}function kp(){return Fr(sy,$a)}function UM(){return $a}function QC(t,e){return R0(sy,t,e)}function TB(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Vwe(t){return qC=I0=1,q$=wc(sy=t),$a=0,[]}function jwe(t){return sy="",t}function pR(t){return W$(QC($a-1,CB(t===91?t+2:t===40?t+1:t)))}function Wwe(t){for(;(lr=kp())&&lr<33;)Fl();return TB(t)>2||TB(lr)>3?"":" "}function Xwe(t,e){for(;--e&&Fl()&&!(lr<48||lr>102||lr>57&&lr<65||lr>70&&lr<97););return QC(t,UM()+(e<6&&kp()==32&&Fl()==32))}function CB(t){for(;Fl();)switch(lr){case t:return $a;case 34:case 39:t!==34&&t!==39&&CB(lr);break;case 40:t===41&&CB(t);break;case 92:Fl();break}return $a}function qwe(t,e){for(;Fl()&&t+lr!==47+10;)if(t+lr===42+42&&kp()===47)break;return"/*"+QC(e,$a-1)+"*"+$U(t===47?t:Fl())}function Ywe(t){for(;!TB(kp());)Fl();return QC(t,$a)}function Qwe(t){return jwe(kM("",null,null,null,[""],t=Vwe(t),0,[0],t))}function kM(t,e,i,n,r,s,o,a,l){for(var c=0,h=0,u=o,d=0,f=0,p=0,m=1,v=1,g=1,y=0,x="",b=r,S=s,A=n,E=x;v;)switch(p=y,y=Fl()){case 40:if(p!=108&&Fr(E,u-1)==58){NM(E+=li(pR(y),"&","&\f"),"&\f")!=-1&&(g=-1);break}case 34:case 39:case 91:E+=pR(y);break;case 9:case 10:case 13:case 32:E+=Wwe(p);break;case 92:E+=Xwe(UM()-1,7);continue;case 47:switch(kp()){case 42:case 47:r1(Kwe(qwe(Fl(),UM()),e,i,l),l);break;default:E+="/"}break;case 123*m:a[c++]=wc(E)*g;case 125*m:case 59:case 0:switch(y){case 0:case 125:v=0;case 59+h:g==-1&&(E=li(E,/\f/g,"")),f>0&&wc(E)-u&&r1(f>32?e6(E+";",n,i,u-1,l):e6(li(E," ","")+";",n,i,u-2,l),l);break;case 59:E+=";";default:if(r1(A=$j(E,e,i,c,h,r,a,x,b=[],S=[],u,s),s),y===123)if(h===0)kM(E,e,A,A,b,s,u,a,S);else switch(d===99&&Fr(E,3)===110?100:d){case 100:case 108:case 109:case 115:kM(t,A,A,n&&r1($j(t,A,A,0,0,r,a,x,r,b=[],u,S),S),r,S,u,a,n?b:S);break;default:kM(E,A,A,A,[""],S,0,a,S)}}c=h=f=0,m=g=1,x=E="",u=o;break;case 58:u=1+wc(E),f=p;default:if(m<1){if(y==123)--m;else if(y==125&&m++==0&&Hwe()==125)continue}switch(E+=$U(y),y*m){case 38:g=h>0?1:(E+="\f",-1);break;case 44:a[c++]=(wc(E)-1)*g,g=1;break;case 64:kp()===45&&(E+=pR(Fl())),d=kp(),h=u=wc(x=E+=Ywe(UM())),y++;break;case 45:p===45&&wc(E)==2&&(m=0)}}return s}function $j(t,e,i,n,r,s,o,a,l,c,h,u){for(var d=r-1,f=r===0?s:[""],p=X$(f),m=0,v=0,g=0;m<n;++m)for(var y=0,x=R0(t,d+1,d=Uwe(v=o[m])),b=t;y<p;++y)(b=W$(v>0?f[y]+" "+x:li(x,/&\f/g,f[y])))&&(l[g++]=b);return YC(t,e,i,r===0?XC:a,l,c,h,u)}function Kwe(t,e,i,n){return YC(t,e,i,V$,$U(Gwe()),R0(t,2,-2),0,n)}function e6(t,e,i,n,r){return YC(t,e,i,ZU,R0(t,0,n),R0(t,n+1,-1),n,r)}function Y$(t,e,i){switch(kwe(t,e)){case 5103:return Oi+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Oi+t+t;case 4789:return F1+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Oi+t+F1+t+on+t+t;case 5936:switch(Fr(t,e+11)){case 114:return Oi+t+on+li(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Oi+t+on+li(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Oi+t+on+li(t,/[svh]\w+-[tblr]{2}/,"lr")+t}case 6828:case 4268:case 2903:return Oi+t+on+t+t;case 6165:return Oi+t+on+"flex-"+t+t;case 5187:return Oi+t+li(t,/(\w+).+(:[^]+)/,Oi+"box-$1$2"+on+"flex-$1$2")+t;case 5443:return Oi+t+on+"flex-item-"+li(t,/flex-|-self/g,"")+(Bu(t,/flex-|baseline/)?"":on+"grid-row-"+li(t,/flex-|-self/g,""))+t;case 4675:return Oi+t+on+"flex-line-pack"+li(t,/align-content|flex-|-self/g,"")+t;case 5548:return Oi+t+on+li(t,"shrink","negative")+t;case 5292:return Oi+t+on+li(t,"basis","preferred-size")+t;case 6060:return Oi+"box-"+li(t,"-grow","")+Oi+t+on+li(t,"grow","positive")+t;case 4554:return Oi+li(t,/([^-])(transform)/g,"$1"+Oi+"$2")+t;case 6187:return li(li(li(t,/(zoom-|grab)/,Oi+"$1"),/(image-set)/,Oi+"$1"),t,"")+t;case 5495:case 3959:return li(t,/(image-set\([^]*)/,Oi+"$1$`$1");case 4968:return li(li(t,/(.+:)(flex-)?(.*)/,Oi+"box-pack:$3"+on+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Oi+t+t;case 4200:if(!Bu(t,/flex-|baseline/))return on+"grid-column-align"+R0(t,e)+t;break;case 2592:case 3360:return on+li(t,"template-","")+t;case 4384:case 3616:return i&&i.some(function(n,r){return e=r,Bu(n.props,/grid-\w+-end/)})?~NM(t+(i=i[e].value),"span")?t:on+li(t,"-start","")+t+on+"grid-row-span:"+(~NM(i,"span")?Bu(i,/\d+/):+Bu(i,/\d+/)-+Bu(t,/\d+/))+";":on+li(t,"-start","")+t;case 4896:case 4128:return i&&i.some(function(n){return Bu(n.props,/grid-\w+-start/)})?t:on+li(li(t,"-end","-span"),"span ","")+t;case 4095:case 3583:case 4068:case 2532:return li(t,/(.+)-inline(.+)/,Oi+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(wc(t)-1-e>6)switch(Fr(t,e+1)){case 109:if(Fr(t,e+4)!==45)break;case 102:return li(t,/(.+:)(.+)-([^]+)/,"$1"+Oi+"$2-$3$1"+F1+(Fr(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~NM(t,"stretch")?Y$(li(t,"stretch","fill-available"),e,i)+t:t}break;case 5152:case 5920:return li(t,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(n,r,s,o,a,l,c){return on+r+":"+s+c+(o?on+r+"-span:"+(a?l:+l-+s)+c:"")+t});case 4949:if(Fr(t,e+6)===121)return li(t,":",":"+Oi)+t;break;case 6444:switch(Fr(t,Fr(t,14)===45?18:11)){case 120:return li(t,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+Oi+(Fr(t,14)===45?"inline-":"")+"box$3$1"+Oi+"$2$3$1"+on+"$2box$3")+t;case 100:return li(t,":",":"+on)+t}break;case 5719:case 2647:case 2135:case 3927:case 2391:return li(t,"scroll-","scroll-snap-")+t}return t}function qE(t,e){for(var i="",n=0;n<t.length;n++)i+=e(t[n],n,t,e)||"";return i}function Jwe(t,e,i,n){switch(t.type){case Nwe:if(t.children.length)break;case Fwe:case ZU:return t.return=t.return||t.value;case V$:return"";case j$:return t.return=t.value+"{"+qE(t.children,n)+"}";case XC:if(!wc(t.value=t.props.join(",")))return""}return wc(i=qE(t.children,n))?t.return=t.value+"{"+i+"}":""}function Zwe(t){var e=X$(t);return function(i,n,r,s){for(var o="",a=0;a<e;a++)o+=t[a](i,n,r,s)||"";return o}}function $we(t){return function(e){e.root||(e=e.return)&&t(e)}}function ebe(t,e,i,n){if(t.length>-1&&!t.return)switch(t.type){case ZU:t.return=Y$(t.value,t.length,i);return;case j$:return qE([Jh(t,{value:li(t.value,"@","@"+Oi)})],n);case XC:if(t.length)return zwe(i=t.props,function(r){switch(Bu(r,n=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":pg(Jh(t,{props:[li(r,/:(read-\w+)/,":"+F1+"$1")]})),pg(Jh(t,{props:[r]})),EB(t,{props:Zj(i,n)});break;case"::placeholder":pg(Jh(t,{props:[li(r,/:(plac\w+)/,":"+Oi+"input-$1")]})),pg(Jh(t,{props:[li(r,/:(plac\w+)/,":"+F1+"$1")]})),pg(Jh(t,{props:[li(r,/:(plac\w+)/,on+"input-$1")]})),pg(Jh(t,{props:[r]})),EB(t,{props:Zj(i,n)});break}return""})}}var tbe={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},L0=typeof process<"u"&&process.env!==void 0&&({}.REACT_APP_SC_ATTR||{}.SC_ATTR)||"data-styled",ek=typeof window<"u"&&"HTMLElement"in window,ibe=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&process.env!==void 0&&{}.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&{}.REACT_APP_SC_DISABLE_SPEEDY!==""?{}.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&{}.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&process.env!==void 0&&{}.SC_DISABLE_SPEEDY!==void 0&&{}.SC_DISABLE_SPEEDY!==""&&{}.SC_DISABLE_SPEEDY!=="false"&&{}.SC_DISABLE_SPEEDY),KC=Object.freeze([]),B0=Object.freeze({});function nbe(t,e,i){return i===void 0&&(i=B0),t.theme!==i.theme&&t.theme||e||i.theme}var Q$=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),rbe=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,sbe=/(^-|-$)/g;function t6(t){return t.replace(rbe,"-").replace(sbe,"")}var obe=/(a)(d)/gi,i6=function(t){return String.fromCharCode(t+(t>25?39:97))};function PB(t){var e,i="";for(e=Math.abs(t);e>52;e=e/52|0)i=i6(e%52)+i;return(i6(e%52)+i).replace(obe,"$1-$2")}var mR,bv=function(t,e){for(var i=e.length;i;)t=33*t^e.charCodeAt(--i);return t},K$=function(t){return bv(5381,t)};function abe(t){return PB(K$(t)>>>0)}function lbe(t){return t.displayName||t.name||"Component"}function gR(t){return typeof t=="string"&&!0}var J$=typeof Symbol=="function"&&Symbol.for,Z$=J$?Symbol.for("react.memo"):60115,cbe=J$?Symbol.for("react.forward_ref"):60112,ube={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},hbe={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},$$={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},dbe=((mR={})[cbe]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},mR[Z$]=$$,mR);function n6(t){return("type"in(e=t)&&e.type.$$typeof)===Z$?$$:"$$typeof"in t?dbe[t.$$typeof]:ube;var e}var fbe=Object.defineProperty,pbe=Object.getOwnPropertyNames,r6=Object.getOwnPropertySymbols,mbe=Object.getOwnPropertyDescriptor,gbe=Object.getPrototypeOf,s6=Object.prototype;function eee(t,e,i){if(typeof e!="string"){if(s6){var n=gbe(e);n&&n!==s6&&eee(t,n,i)}var r=pbe(e);r6&&(r=r.concat(r6(e)));for(var s=n6(t),o=n6(e),a=0;a<r.length;++a){var l=r[a];if(!(l in hbe||i&&i[l]||o&&l in o||s&&l in s)){var c=mbe(e,l);try{fbe(t,l,c)}catch{}}}}return t}function O0(t){return typeof t=="function"}function tk(t){return typeof t=="object"&&"styledComponentId"in t}function Sp(t,e){return t&&e?"".concat(t," ").concat(e):t||e||""}function o6(t,e){if(t.length===0)return"";for(var i=t[0],n=1;n<t.length;n++)i+=e?e+t[n]:t[n];return i}function z_(t){return t!==null&&typeof t=="object"&&t.constructor.name===Object.name&&!("props"in t&&t.$$typeof)}function DB(t,e,i){if(i===void 0&&(i=!1),!i&&!z_(t)&&!Array.isArray(t))return e;if(Array.isArray(e))for(var n=0;n<e.length;n++)t[n]=DB(t[n],e[n]);else if(z_(e))for(var n in e)t[n]=DB(t[n],e[n]);return t}function ik(t,e){Object.defineProperty(t,"toString",{value:e})}function Pw(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(t," for more information.").concat(e.length>0?" Args: ".concat(e.join(", ")):""))}var vbe=function(){function t(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}return t.prototype.indexOfGroup=function(e){for(var i=0,n=0;n<e;n++)i+=this.groupSizes[n];return i},t.prototype.insertRules=function(e,i){if(e>=this.groupSizes.length){for(var n=this.groupSizes,r=n.length,s=r;e>=s;)if((s<<=1)<0)throw Pw(16,"".concat(e));this.groupSizes=new Uint32Array(s),this.groupSizes.set(n),this.length=s;for(var o=r;o<s;o++)this.groupSizes[o]=0}for(var a=this.indexOfGroup(e+1),l=(o=0,i.length);o<l;o++)this.tag.insertRule(a,i[o])&&(this.groupSizes[e]++,a++)},t.prototype.clearGroup=function(e){if(e<this.length){var i=this.groupSizes[e],n=this.indexOfGroup(e),r=n+i;this.groupSizes[e]=0;for(var s=n;s<r;s++)this.tag.deleteRule(n)}},t.prototype.getGroup=function(e){var i="";if(e>=this.length||this.groupSizes[e]===0)return i;for(var n=this.groupSizes[e],r=this.indexOfGroup(e),s=r+n,o=r;o<s;o++)i+="".concat(this.tag.getRule(o)).concat(`/*!sc*/
`);return i},t}(),zM=new Map,YE=new Map,vR=1,QS=function(t){if(zM.has(t))return zM.get(t);for(;YE.has(vR);)vR++;var e=vR++;return zM.set(t,e),YE.set(e,t),e},ybe=function(t,e){zM.set(t,e),YE.set(e,t)},xbe="style[".concat(L0,"][").concat("data-styled-version",'="').concat("6.0.7",'"]'),_be=new RegExp("^".concat(L0,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),wbe=function(t,e,i){for(var n,r=i.split(","),s=0,o=r.length;s<o;s++)(n=r[s])&&t.registerName(e,n)},bbe=function(t,e){for(var i,n=((i=e.textContent)!==null&&i!==void 0?i:"").split(`/*!sc*/
`),r=[],s=0,o=n.length;s<o;s++){var a=n[s].trim();if(a){var l=a.match(_be);if(l){var c=0|parseInt(l[1],10),h=l[2];c!==0&&(ybe(h,c),wbe(t,h,l[3]),t.getTag().insertRules(c,r)),r.length=0}else r.push(a)}}};function Sbe(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var tee=function(t){var e=document.head,i=t||e,n=document.createElement("style"),r=function(a){var l=Array.from(a.querySelectorAll("style[".concat(L0,"]")));return l[l.length-1]}(i),s=r!==void 0?r.nextSibling:null;n.setAttribute(L0,"active"),n.setAttribute("data-styled-version","6.0.7");var o=Sbe();return o&&n.setAttribute("nonce",o),i.insertBefore(n,s),n},Abe=function(){function t(e){this.element=tee(e),this.element.appendChild(document.createTextNode("")),this.sheet=function(i){if(i.sheet)return i.sheet;for(var n=document.styleSheets,r=0,s=n.length;r<s;r++){var o=n[r];if(o.ownerNode===i)return o}throw Pw(17)}(this.element),this.length=0}return t.prototype.insertRule=function(e,i){try{return this.sheet.insertRule(i,e),this.length++,!0}catch{return!1}},t.prototype.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},t.prototype.getRule=function(e){var i=this.sheet.cssRules[e];return i&&i.cssText?i.cssText:""},t}(),Mbe=function(){function t(e){this.element=tee(e),this.nodes=this.element.childNodes,this.length=0}return t.prototype.insertRule=function(e,i){if(e<=this.length&&e>=0){var n=document.createTextNode(i);return this.element.insertBefore(n,this.nodes[e]||null),this.length++,!0}return!1},t.prototype.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},t.prototype.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},t}(),Ebe=function(){function t(e){this.rules=[],this.length=0}return t.prototype.insertRule=function(e,i){return e<=this.length&&(this.rules.splice(e,0,i),this.length++,!0)},t.prototype.deleteRule=function(e){this.rules.splice(e,1),this.length--},t.prototype.getRule=function(e){return e<this.length?this.rules[e]:""},t}(),a6=ek,Tbe={isServer:!ek,useCSSOMInjection:!ibe},iee=function(){function t(e,i,n){e===void 0&&(e=B0),i===void 0&&(i={});var r=this;this.options=lo(lo({},Tbe),e),this.gs=i,this.names=new Map(n),this.server=!!e.isServer,!this.server&&ek&&a6&&(a6=!1,function(s){for(var o=document.querySelectorAll(xbe),a=0,l=o.length;a<l;a++){var c=o[a];c&&c.getAttribute(L0)!=="active"&&(bbe(s,c),c.parentNode&&c.parentNode.removeChild(c))}}(this)),ik(this,function(){return function(s){for(var o=s.getTag(),a=o.length,l="",c=function(u){var d=function(g){return YE.get(g)}(u);if(d===void 0)return"continue";var f=s.names.get(d),p=o.getGroup(u);if(f===void 0||p.length===0)return"continue";var m="".concat(L0,".g").concat(u,'[id="').concat(d,'"]'),v="";f!==void 0&&f.forEach(function(g){g.length>0&&(v+="".concat(g,","))}),l+="".concat(p).concat(m,'{content:"').concat(v,'"}').concat(`/*!sc*/
`)},h=0;h<a;h++)c(h);return l}(r)})}return t.registerId=function(e){return QS(e)},t.prototype.reconstructWithOptions=function(e,i){return i===void 0&&(i=!0),new t(lo(lo({},this.options),e),this.gs,i&&this.names||void 0)},t.prototype.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},t.prototype.getTag=function(){return this.tag||(this.tag=(e=function(i){var n=i.useCSSOMInjection,r=i.target;return i.isServer?new Ebe(r):n?new Abe(r):new Mbe(r)}(this.options),new vbe(e)));var e},t.prototype.hasNameForId=function(e,i){return this.names.has(e)&&this.names.get(e).has(i)},t.prototype.registerName=function(e,i){if(QS(e),this.names.has(e))this.names.get(e).add(i);else{var n=new Set;n.add(i),this.names.set(e,n)}},t.prototype.insertRules=function(e,i,n){this.registerName(e,i),this.getTag().insertRules(QS(e),n)},t.prototype.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},t.prototype.clearRules=function(e){this.getTag().clearGroup(QS(e)),this.clearNames(e)},t.prototype.clearTag=function(){this.tag=void 0},t}(),Cbe=/&/g,Pbe=/^\s*\/\/.*$/gm;function nee(t,e){return t.map(function(i){return i.type==="rule"&&(i.value="".concat(e," ").concat(i.value),i.value=i.value.replaceAll(",",",".concat(e," ")),i.props=i.props.map(function(n){return"".concat(e," ").concat(n)})),Array.isArray(i.children)&&i.type!=="@keyframes"&&(i.children=nee(i.children,e)),i})}function Dbe(t){var e,i,n,r=t===void 0?B0:t,s=r.options,o=s===void 0?B0:s,a=r.plugins,l=a===void 0?KC:a,c=function(d,f,p){return p===i||p.startsWith(i)&&p.endsWith(i)&&p.replaceAll(i,"").length>0?".".concat(e):d},h=l.slice();h.push(function(d){d.type===XC&&d.value.includes("&")&&(d.props[0]=d.props[0].replace(Cbe,i).replace(n,c))}),o.prefix&&h.push(ebe),h.push(Jwe);var u=function(d,f,p,m){f===void 0&&(f=""),p===void 0&&(p=""),m===void 0&&(m="&"),e=m,i=f,n=new RegExp("\\".concat(i,"\\b"),"g");var v=d.replace(Pbe,""),g=Qwe(p||f?"".concat(p," ").concat(f," { ").concat(v," }"):v);o.namespace&&(g=nee(g,o.namespace));var y=[];return qE(g,Zwe(h.concat($we(function(x){return y.push(x)})))),y};return u.hash=l.length?l.reduce(function(d,f){return f.name||Pw(15),bv(d,f.name)},5381).toString():"",u}var Rbe=new iee,RB=Dbe(),ree=Ul.createContext({shouldForwardProp:void 0,styleSheet:Rbe,stylis:RB});ree.Consumer;Ul.createContext(void 0);function l6(){return ye.useContext(ree)}var Ibe=function(){function t(e,i){var n=this;this.inject=function(r,s){s===void 0&&(s=RB);var o=n.name+s.hash;r.hasNameForId(n.id,o)||r.insertRules(n.id,o,s(n.rules,o,"@keyframes"))},this.name=e,this.id="sc-keyframes-".concat(e),this.rules=i,ik(this,function(){throw Pw(12,String(n.name))})}return t.prototype.getName=function(e){return e===void 0&&(e=RB),this.name+e.hash},t}(),Lbe=function(t){return t>="A"&&t<="Z"};function c6(t){for(var e="",i=0;i<t.length;i++){var n=t[i];if(i===1&&n==="-"&&t[0]==="-")return t;Lbe(n)?e+="-"+n.toLowerCase():e+=n}return e.startsWith("ms-")?"-"+e:e}var see=function(t){return t==null||t===!1||t===""},oee=function(t){var e,i,n=[];for(var r in t){var s=t[r];t.hasOwnProperty(r)&&!see(s)&&(Array.isArray(s)&&s.isCss||O0(s)?n.push("".concat(c6(r),":"),s,";"):z_(s)?n.push.apply(n,XE(XE(["".concat(r," {")],oee(s),!1),["}"],!1)):n.push("".concat(c6(r),": ").concat((e=r,(i=s)==null||typeof i=="boolean"||i===""?"":typeof i!="number"||i===0||e in tbe||e.startsWith("--")?String(i).trim():"".concat(i,"px")),";")))}return n};function zp(t,e,i,n){if(see(t))return[];if(tk(t))return[".".concat(t.styledComponentId)];if(O0(t)){if(!O0(s=t)||s.prototype&&s.prototype.isReactComponent||!e)return[t];var r=t(e);return zp(r,e,i,n)}var s;return t instanceof Ibe?i?(t.inject(i,n),[t.getName(n)]):[t]:z_(t)?oee(t):Array.isArray(t)?Array.prototype.concat.apply(KC,t.map(function(o){return zp(o,e,i,n)})):[t.toString()]}function Bbe(t){for(var e=0;e<t.length;e+=1){var i=t[e];if(O0(i)&&!tk(i))return!1}return!0}var Obe=K$("6.0.7"),Fbe=function(){function t(e,i,n){this.rules=e,this.staticRulesId="",this.isStatic=(n===void 0||n.isStatic)&&Bbe(e),this.componentId=i,this.baseHash=bv(Obe,i),this.baseStyle=n,iee.registerId(i)}return t.prototype.generateAndInjectStyles=function(e,i,n){var r=this.baseStyle?this.baseStyle.generateAndInjectStyles(e,i,n):"";if(this.isStatic&&!n.hash)if(this.staticRulesId&&i.hasNameForId(this.componentId,this.staticRulesId))r=Sp(r,this.staticRulesId);else{var s=o6(zp(this.rules,e,i,n)),o=PB(bv(this.baseHash,s)>>>0);if(!i.hasNameForId(this.componentId,o)){var a=n(s,".".concat(o),void 0,this.componentId);i.insertRules(this.componentId,o,a)}r=Sp(r,o),this.staticRulesId=o}else{for(var l=bv(this.baseHash,n.hash),c="",h=0;h<this.rules.length;h++){var u=this.rules[h];if(typeof u=="string")c+=u;else if(u){var d=o6(zp(u,e,i,n));l=bv(l,d),c+=d}}if(c){var f=PB(l>>>0);i.hasNameForId(this.componentId,f)||i.insertRules(this.componentId,f,n(c,".".concat(f),void 0,this.componentId)),r=Sp(r,f)}}return r},t}(),aee=Ul.createContext(void 0);aee.Consumer;var yR={};function Nbe(t,e,i){var n=tk(t),r=t,s=!gR(t),o=e.attrs,a=o===void 0?KC:o,l=e.componentId,c=l===void 0?function(x,b){var S=typeof x!="string"?"sc":t6(x);yR[S]=(yR[S]||0)+1;var A="".concat(S,"-").concat(abe("6.0.7"+S+yR[S]));return b?"".concat(b,"-").concat(A):A}(e.displayName,e.parentComponentId):l,h=e.displayName;h===void 0&&function(x){return gR(x)?"styled.".concat(x):"Styled(".concat(lbe(x),")")}(t);var u=e.displayName&&e.componentId?"".concat(t6(e.displayName),"-").concat(e.componentId):e.componentId||c,d=n&&r.attrs?r.attrs.concat(a).filter(Boolean):a,f=e.shouldForwardProp;if(n&&r.shouldForwardProp){var p=r.shouldForwardProp;if(e.shouldForwardProp){var m=e.shouldForwardProp;f=function(x,b){return p(x,b)&&m(x,b)}}else f=p}var v=new Fbe(i,u,n?r.componentStyle:void 0);function g(x,b){return function(S,A,E){var M=S.attrs,T=S.componentStyle,P=S.defaultProps,R=S.foldedComponentIds,U=S.styledComponentId,F=S.target,N=Ul.useContext(aee),W=l6(),Q=S.shouldForwardProp||W.shouldForwardProp,X=function(Z,K,re){for(var J,le=lo(lo({},K),{className:void 0,theme:re}),ae=0;ae<Z.length;ae+=1){var fe=O0(J=Z[ae])?J(le):J;for(var ge in fe)le[ge]=ge==="className"?Sp(le[ge],fe[ge]):ge==="style"?lo(lo({},le[ge]),fe[ge]):fe[ge]}return K.className&&(le.className=Sp(le.className,K.className)),le}(M,A,nbe(A,N,P)||B0),B=X.as||F,j={};for(var z in X)X[z]===void 0||z[0]==="$"||z==="as"||z==="theme"||(z==="forwardedAs"?j.as=X.forwardedAs:Q&&!Q(z,B)||(j[z]=X[z]));var k=function(Z,K){var re=l6(),J=Z.generateAndInjectStyles(K,re.styleSheet,re.stylis);return J}(T,X),G=Sp(R,U);return k&&(G+=" "+k),X.className&&(G+=" "+X.className),j[gR(B)&&!Q$.has(B)?"class":"className"]=G,j.ref=E,ye.createElement(B,j)}(y,x,b)}var y=Ul.forwardRef(g);return y.attrs=d,y.componentStyle=v,y.shouldForwardProp=f,y.foldedComponentIds=n?Sp(r.foldedComponentIds,r.styledComponentId):"",y.styledComponentId=u,y.target=n?r.target:t,Object.defineProperty(y,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(x){this._foldedDefaultProps=n?function(b){for(var S=[],A=1;A<arguments.length;A++)S[A-1]=arguments[A];for(var E=0,M=S;E<M.length;E++)DB(b,M[E],!0);return b}({},r.defaultProps,x):x}}),ik(y,function(){return".".concat(y.styledComponentId)}),s&&eee(y,t,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),y}function u6(t,e){for(var i=[t[0]],n=0,r=e.length;n<r;n+=1)i.push(e[n],t[n+1]);return i}var h6=function(t){return Object.assign(t,{isCss:!0})};function Ube(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(O0(t)||z_(t)){var n=t;return h6(zp(u6(KC,XE([n],e,!0))))}var r=t;return e.length===0&&r.length===1&&typeof r[0]=="string"?zp(r):h6(zp(u6(r,e)))}function IB(t,e,i){if(i===void 0&&(i=B0),!e)throw Pw(1,e);var n=function(r){for(var s=[],o=1;o<arguments.length;o++)s[o-1]=arguments[o];return t(e,i,Ube.apply(void 0,XE([r],s,!1)))};return n.attrs=function(r){return IB(t,e,lo(lo({},i),{attrs:Array.prototype.concat(i.attrs,r).filter(Boolean)}))},n.withConfig=function(r){return IB(t,e,lo(lo({},i),r))},n}var lee=function(t){return IB(Nbe,t)},cee=lee;Q$.forEach(function(t){cee[t]=lee(t)});const kbe="_logo_37puz_4",zbe="_shadow_37puz_7",Gbe="_video_37puz_16",Hbe="_header_37puz_21",Vbe="_nav_37puz_29",jbe="_ul_37puz_38",Wbe="_a_37puz_43",Xbe="_hamburger_37puz_53",qbe="_bar_37puz_70",Ybe="_main_37puz_98",Qbe="_parallax_37puz_104",Kbe="_text_37puz_239",Jbe="_h2_37puz_247",Zbe="_h1_37puz_254",$be="_vingnette_37puz_279",Ds={logo:kbe,shadow:zbe,video:Gbe,header:Hbe,nav:Vbe,ul:jbe,a:Wbe,hamburger:Xbe,bar:qbe,main:Ybe,parallax:Qbe,"bg-img":"_bg-img_37puz_112","fog-7":"_fog-7_37puz_120","fog-1":"_fog-1_37puz_127","mountain-10":"_mountain-10_37puz_135","fog-2":"_fog-2_37puz_142","mountain-9":"_mountain-9_37puz_149","mountain-8":"_mountain-8_37puz_156","fog-3":"_fog-3_37puz_163","mountain-7":"_mountain-7_37puz_170","mountain-6":"_mountain-6_37puz_177","fog-4":"_fog-4_37puz_184","mountain-5":"_mountain-5_37puz_191","fog-5":"_fog-5_37puz_198","mountain-4":"_mountain-4_37puz_205","mountain-3":"_mountain-3_37puz_212","fog-6":"_fog-6_37puz_219","mountain-2":"_mountain-2_37puz_226","mountain-1":"_mountain-1_37puz_135",text:Kbe,h2:Jbe,h1:Zbe,"sun-rays":"_sun-rays_37puz_260","black-shadow":"_black-shadow_37puz_269",vingnette:$be},eSe="/Paarth_Website/assets/bg2-6d970cfe.mp4",tSe=cee.main`
  position: relative;
  height: 100vh;
  width: 100vw;
  overflow: hidden;
`,iSe=()=>{let t=ye.useRef();ye.useRef(),ye.useRef(),ye.useRef(),ye.useRef(),ye.useRef(),ye.useRef(),ye.useRef(),ye.useRef(),ye.useRef(),ye.useRef(),ye.useRef(),ye.useRef(),ye.useRef(),ye.useRef(),ye.useRef(),ye.useRef(),ye.useRef();let e=ye.useRef(),i=ye.useRef();return ye.useRef(),ye.useRef(),ye.useRef(),ye.useRef(),ye.useLayoutEffect(()=>{let n=n1.context(()=>{n1.from(e,{opacity:0,duration:3.5,ease:"power3.out",delay:2}),n1.from(i,{opacity:0,duration:3.5,ease:"power3.out",delay:2})},Ds.parallax);return console.log(t.offsetHeight),n1.to("about",{ScrollTrigger:{snap:"about"}}),()=>n.revert()},[]),rt.jsxs("html",{lang:"en",children:[rt.jsx("head",{children:rt.jsx("link",{rel:"stylesheet",href:Ds.style})}),rt.jsxs("body",{className:Ds.body,children:[rt.jsx("header",{className:`${Ds.hide} ${Ds.header}`,ref:n=>e=n,children:rt.jsxs("nav",{className:Ds.nav,children:[rt.jsx("img",{src:n_e,alt:"Travelo",className:Ds.logo}),rt.jsxs("ul",{className:Ds.ul,children:[rt.jsx("li",{children:rt.jsx("a",{className:Ds.a,href:"#project",children:"Projects"})}),rt.jsx("li",{children:rt.jsx("a",{className:Ds.a,href:"#about",children:"About"})}),rt.jsx("li",{children:rt.jsx("a",{className:Ds.a,href:"#contact",children:"Contact"})})]})]})}),rt.jsxs(tSe,{children:[rt.jsx("video",{className:Ds.video,src:eSe,autoPlay:!0,muted:!0}),rt.jsx("div",{className:Ds.shadow,ref:n=>i=n})]})]}),rt.jsx("body",{className:`${Ds.body} ${Ds.text}`})]})},nSe="_container_q2y4s_3",rSe="_body_q2y4s_23",sSe="_h3_q2y4s_33",oSe="_card_q2y4s_57",aSe="_h2_q2y4s_57",lSe="_p_q2y4s_69",cSe="_p1_q2y4s_77",uSe="_image2_q2y4s_85",hSe="_circle_q2y4s_125",dSe="_image_q2y4s_85",fSe="_content_q2y4s_289",hl={container:nSe,body:rSe,h3:sSe,card:oSe,h2:aSe,p:lSe,p1:cSe,image2:uSe,circle:hSe,image:dSe,content:fSe},pSe="/Paarth_Website/assets/bugtracker-95325793.png",mSe="/Paarth_Website/assets/django-c6a7146b.png",gSe="/Paarth_Website/assets/mywebsite-f95d7c17.png";class vSe extends ye.Component{render(){let e=0;const i=[{id:-1,name:"Bug Tracker",content:"Simple ASP.NET website created to track and store bugs from projects I've built. Levels of authorization and authentication are involved so multiple people can be registered to track their individual bugs. MVC architecture used connected to an SQL database and supports CRUD operations.",image:pSe,source:"https://github.com/PaarthKadakiaGitHub/BugTracker",tags:[{name:"ASP.NET Core 6 MVC",color:"blue-text-gradient"},{name:"Microsoft SQL",color:"green-text-gradient"},{name:"C#",color:"pink-text-gradient"}]},{id:0,name:"Social Media Website",content:"Created an instagram like social media platform which has user login and signup to post pictures and see pictures of other friends that they follow. There also is a recommendation bar for other PKMedia users. You can like and comment under other user posts and the user who posted updating the database to all users. ",image:mSe,source:"https://github.com/PaarthKadakiaGitHub/Social-Media-App",tags:[{name:"react",color:"blue-text-gradient"},{name:"mongodb",color:"green-text-gradient"},{name:"tailwind",color:"pink-text-gradient"}]},{id:1,name:"My Website",content:"A react based website utilizing lots of javascript libraries that create for an immersive experience. GSAP libraries are added to create the load in animation when seeing the website and Tilt libraries are used for the smooth load in animation of the page elements and threeJS for the spinning globe",image:gSe,source:"https://github.com/PaarthKadakiaGitHub/Paarth_Website",tags:[{name:"react",color:"blue-text-gradient"},{name:"mongodb",color:"green-text-gradient"},{name:"tailwind",color:"pink-text-gradient"}]}];return rt.jsxs("body",{className:hl.body,children:[rt.jsx("div",{children:rt.jsx("div",{className:hl.h3,id:"project",children:"Projects"})}),rt.jsx("div",{className:hl.container,children:i.map(n=>rt.jsx("div",{className:hl.card,style:{"--i":n.id,"--j":n.id+1},children:rt.jsxs("div",{className:hl.content,children:[rt.jsxs("button",{onClick:()=>window.open(n.source,"_blank"),children:[rt.jsx("div",{children:rt.jsx("img",{src:l_e,alt:"source code",className:`${hl.image2}`})}),rt.jsx("div",{className:hl.circle})]}),rt.jsx("div",{children:rt.jsx("img",{className:hl.image,src:n.image})}),rt.jsx("h2",{className:hl.h2,children:n.name}),rt.jsx("p",{className:hl.p,children:n.content}),rt.jsx("p",{children:" "}),n.tags.map(r=>ye.createElement("p",{...e++,key:n.id+e,className:`${hl.p1} text-[14px] ${r.color}`},"#",r.name," "))]})},n.id))})]})}}const ySe="modulepreload",xSe=function(t){return"/Paarth_Website/"+t},d6={},Dw=function(e,i,n){if(!i||i.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(i.map(s=>{if(s=xSe(s),s in d6)return;d6[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!n)for(let h=r.length-1;h>=0;h--){const u=r[h];if(u.href===s&&(!o||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":ySe,o||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),o)return new Promise((h,u)=>{c.addEventListener("load",h),c.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};var _Se=Object.create,nk=Object.defineProperty,wSe=Object.getOwnPropertyDescriptor,bSe=Object.getOwnPropertyNames,SSe=Object.getPrototypeOf,ASe=Object.prototype.hasOwnProperty,JC=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),MSe=(t,e)=>{for(var i in e)nk(t,i,{get:e[i],enumerable:!0})},ESe=(t,e,i,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of bSe(e))!ASe.call(t,r)&&r!==i&&nk(t,r,{get:()=>e[r],enumerable:!(n=wSe(e,r))||n.enumerable});return t},Rw=(t,e,i)=>(i=t!=null?_Se(SSe(t)):{},ESe(e||!t||!t.__esModule?nk(i,"default",{value:t,enumerable:!0}):i,t)),TSe=JC((t,e)=>{(function(i,n){typeof t=="object"?e.exports=n():typeof define=="function"&&define.amd?define(n):i.Alea=n()})(t,function(){return i.importState=function(r){var s=new i;return s.importState(r),s},i;function i(){return function(r){var s=0,o=0,a=0,l=1;r.length==0&&(r=[+new Date]);var c=n();s=c(" "),o=c(" "),a=c(" ");for(var h=0;h<r.length;h++)s-=c(r[h]),s<0&&(s+=1),o-=c(r[h]),o<0&&(o+=1),a-=c(r[h]),a<0&&(a+=1);c=null;var u=function(){var d=2091639*s+l*23283064365386963e-26;return s=o,o=a,a=d-(l=d|0)};return u.next=u,u.uint32=function(){return u()*4294967296},u.fract53=function(){return u()+(u()*2097152|0)*11102230246251565e-32},u.version="Alea 0.9",u.args=r,u.exportState=function(){return[s,o,a,l]},u.importState=function(d){s=+d[0]||0,o=+d[1]||0,a=+d[2]||0,l=+d[3]||0},u}(Array.prototype.slice.call(arguments))}function n(){var r=4022871197,s=function(o){o=o.toString();for(var a=0;a<o.length;a++){r+=o.charCodeAt(a);var l=.02519603282416938*r;r=l>>>0,l-=r,l*=r,r=l>>>0,l-=r,r+=l*4294967296}return(r>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})}),uee=JC((t,e)=>{(function(i,n){typeof t=="object"&&typeof e<"u"?n(t):typeof define=="function"&&define.amd?define(["exports"],n):n((i=typeof globalThis<"u"?globalThis:i||self).SVDJS={})})(t,function(i){i.SVD=function(n,r,s,o,a){if(r=r===void 0||r,s=s===void 0||s,a=1e-64/(o=o||Math.pow(2,-52)),!n)throw new TypeError("Matrix a is not defined");var l,c,h,u,d,f,p,m,v,g,y,x,b=n[0].length,S=n.length;if(S<b)throw new TypeError("Invalid matrix: m < n");for(var A=[],E=[],M=[],T=r==="f"?S:b,P=g=p=0;P<S;P++)E[P]=new Array(T).fill(0);for(P=0;P<b;P++)M[P]=new Array(b).fill(0);var R,U=new Array(b).fill(0);for(P=0;P<S;P++)for(l=0;l<b;l++)E[P][l]=n[P][l];for(P=0;P<b;P++){for(A[P]=p,v=0,h=P+1,l=P;l<S;l++)v+=Math.pow(E[l][P],2);if(v<a)p=0;else for(m=(f=E[P][P])*(p=f<0?Math.sqrt(v):-Math.sqrt(v))-v,E[P][P]=f-p,l=h;l<b;l++){for(v=0,c=P;c<S;c++)v+=E[c][P]*E[c][l];for(f=v/m,c=P;c<S;c++)E[c][l]=E[c][l]+f*E[c][P]}for(U[P]=p,v=0,l=h;l<b;l++)v+=Math.pow(E[P][l],2);if(v<a)p=0;else{for(m=(f=E[P][P+1])*(p=f<0?Math.sqrt(v):-Math.sqrt(v))-v,E[P][P+1]=f-p,l=h;l<b;l++)A[l]=E[P][l]/m;for(l=h;l<S;l++){for(v=0,c=h;c<b;c++)v+=E[l][c]*E[P][c];for(c=h;c<b;c++)E[l][c]=E[l][c]+v*A[c]}}g<(y=Math.abs(U[P])+Math.abs(A[P]))&&(g=y)}if(s)for(P=b-1;0<=P;P--){if(p!==0){for(m=E[P][P+1]*p,l=h;l<b;l++)M[l][P]=E[P][l]/m;for(l=h;l<b;l++){for(v=0,c=h;c<b;c++)v+=E[P][c]*M[c][l];for(c=h;c<b;c++)M[c][l]=M[c][l]+v*M[c][P]}}for(l=h;l<b;l++)M[P][l]=0,M[l][P]=0;M[P][P]=1,p=A[P],h=P}if(r){if(r==="f")for(P=b;P<S;P++){for(l=b;l<S;l++)E[P][l]=0;E[P][P]=1}for(P=b-1;0<=P;P--){for(h=P+1,p=U[P],l=h;l<T;l++)E[P][l]=0;if(p!==0){for(m=E[P][P]*p,l=h;l<T;l++){for(v=0,c=h;c<S;c++)v+=E[c][P]*E[c][l];for(f=v/m,c=P;c<S;c++)E[c][l]=E[c][l]+f*E[c][P]}for(l=P;l<S;l++)E[l][P]=E[l][P]/p}else for(l=P;l<S;l++)E[l][P]=0;E[P][P]=E[P][P]+1}}for(o*=g,c=b-1;0<=c;c--)for(var F=0;F<50;F++){for(R=!1,h=c;0<=h;h--){if(Math.abs(A[h])<=o){R=!0;break}if(Math.abs(U[h-1])<=o)break}if(!R){for(d=0,u=h-(v=1),P=h;P<c+1&&(f=v*A[P],A[P]=d*A[P],!(Math.abs(f)<=o));P++)if(p=U[P],U[P]=Math.sqrt(f*f+p*p),d=p/(m=U[P]),v=-f/m,r)for(l=0;l<S;l++)y=E[l][u],x=E[l][P],E[l][u]=y*d+x*v,E[l][P]=-y*v+x*d}if(x=U[c],h===c){if(x<0&&(U[c]=-x,s))for(l=0;l<b;l++)M[l][c]=-M[l][c];break}for(g=U[h],f=(((y=U[c-1])-x)*(y+x)+((p=A[c-1])-(m=A[c]))*(p+m))/(2*m*y),p=Math.sqrt(f*f+1),f=((g-x)*(g+x)+m*(y/(f<0?f-p:f+p)-m))/g,P=h+(v=d=1);P<c+1;P++){if(p=A[P],y=U[P],m=v*p,p*=d,x=Math.sqrt(f*f+m*m),f=g*(d=f/(A[P-1]=x))+p*(v=m/x),p=-g*v+p*d,m=y*v,y*=d,s)for(l=0;l<b;l++)g=M[l][P-1],x=M[l][P],M[l][P-1]=g*d+x*v,M[l][P]=-g*v+x*d;if(x=Math.sqrt(f*f+m*m),f=(d=f/(U[P-1]=x))*p+(v=m/x)*y,g=-v*p+d*y,r)for(l=0;l<S;l++)y=E[l][P-1],x=E[l][P],E[l][P-1]=y*d+x*v,E[l][P]=-y*v+x*d}A[h]=0,A[c]=f,U[c]=g}for(P=0;P<b;P++)U[P]<o&&(U[P]=0);return{u:E,q:U,v:M}},i.VERSION="1.1.1",Object.defineProperty(i,"__esModule",{value:!0})})}),CSe=JC(t=>{(function(){var e=function(){this.init()};e.prototype={init:function(){var u=this||i;return u._counter=1e3,u._html5AudioPool=[],u.html5PoolSize=10,u._codecs={},u._howls=[],u._muted=!1,u._volume=1,u._canPlayEvent="canplaythrough",u._navigator=typeof window<"u"&&window.navigator?window.navigator:null,u.masterGain=null,u.noAudio=!1,u.usingWebAudio=!0,u.autoSuspend=!0,u.ctx=null,u.autoUnlock=!0,u._setup(),u},volume:function(u){var d=this||i;if(u=parseFloat(u),d.ctx||h(),typeof u<"u"&&u>=0&&u<=1){if(d._volume=u,d._muted)return d;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(u,i.ctx.currentTime);for(var f=0;f<d._howls.length;f++)if(!d._howls[f]._webAudio)for(var p=d._howls[f]._getSoundIds(),m=0;m<p.length;m++){var v=d._howls[f]._soundById(p[m]);v&&v._node&&(v._node.volume=v._volume*u)}return d}return d._volume},mute:function(u){var d=this||i;d.ctx||h(),d._muted=u,d.usingWebAudio&&d.masterGain.gain.setValueAtTime(u?0:d._volume,i.ctx.currentTime);for(var f=0;f<d._howls.length;f++)if(!d._howls[f]._webAudio)for(var p=d._howls[f]._getSoundIds(),m=0;m<p.length;m++){var v=d._howls[f]._soundById(p[m]);v&&v._node&&(v._node.muted=u?!0:v._muted)}return d},stop:function(){for(var u=this||i,d=0;d<u._howls.length;d++)u._howls[d].stop();return u},unload:function(){for(var u=this||i,d=u._howls.length-1;d>=0;d--)u._howls[d].unload();return u.usingWebAudio&&u.ctx&&typeof u.ctx.close<"u"&&(u.ctx.close(),u.ctx=null,h()),u},codecs:function(u){return(this||i)._codecs[u.replace(/^x-/,"")]},_setup:function(){var u=this||i;if(u.state=u.ctx&&u.ctx.state||"suspended",u._autoSuspend(),!u.usingWebAudio)if(typeof Audio<"u")try{var d=new Audio;typeof d.oncanplaythrough>"u"&&(u._canPlayEvent="canplay")}catch{u.noAudio=!0}else u.noAudio=!0;try{var d=new Audio;d.muted&&(u.noAudio=!0)}catch{}return u.noAudio||u._setupCodecs(),u},_setupCodecs:function(){var u=this||i,d=null;try{d=typeof Audio<"u"?new Audio:null}catch{return u}if(!d||typeof d.canPlayType!="function")return u;var f=d.canPlayType("audio/mpeg;").replace(/^no$/,""),p=u._navigator?u._navigator.userAgent:"",m=p.match(/OPR\/([0-6].)/g),v=m&&parseInt(m[0].split("/")[1],10)<33,g=p.indexOf("Safari")!==-1&&p.indexOf("Chrome")===-1,y=p.match(/Version\/(.*?) /),x=g&&y&&parseInt(y[1],10)<15;return u._codecs={mp3:!!(!v&&(f||d.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!f,opus:!!d.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(d.canPlayType('audio/wav; codecs="1"')||d.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!d.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!d.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(d.canPlayType("audio/x-m4a;")||d.canPlayType("audio/m4a;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(d.canPlayType("audio/x-m4b;")||d.canPlayType("audio/m4b;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(d.canPlayType("audio/x-mp4;")||d.canPlayType("audio/mp4;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!x&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!x&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!d.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(d.canPlayType("audio/x-flac;")||d.canPlayType("audio/flac;")).replace(/^no$/,"")},u},_unlockAudio:function(){var u=this||i;if(!(u._audioUnlocked||!u.ctx)){u._audioUnlocked=!1,u.autoUnlock=!1,!u._mobileUnloaded&&u.ctx.sampleRate!==44100&&(u._mobileUnloaded=!0,u.unload()),u._scratchBuffer=u.ctx.createBuffer(1,1,22050);var d=function(f){for(;u._html5AudioPool.length<u.html5PoolSize;)try{var p=new Audio;p._unlocked=!0,u._releaseHtml5Audio(p)}catch{u.noAudio=!0;break}for(var m=0;m<u._howls.length;m++)if(!u._howls[m]._webAudio)for(var v=u._howls[m]._getSoundIds(),g=0;g<v.length;g++){var y=u._howls[m]._soundById(v[g]);y&&y._node&&!y._node._unlocked&&(y._node._unlocked=!0,y._node.load())}u._autoResume();var x=u.ctx.createBufferSource();x.buffer=u._scratchBuffer,x.connect(u.ctx.destination),typeof x.start>"u"?x.noteOn(0):x.start(0),typeof u.ctx.resume=="function"&&u.ctx.resume(),x.onended=function(){x.disconnect(0),u._audioUnlocked=!0,document.removeEventListener("touchstart",d,!0),document.removeEventListener("touchend",d,!0),document.removeEventListener("click",d,!0),document.removeEventListener("keydown",d,!0);for(var b=0;b<u._howls.length;b++)u._howls[b]._emit("unlock")}};return document.addEventListener("touchstart",d,!0),document.addEventListener("touchend",d,!0),document.addEventListener("click",d,!0),document.addEventListener("keydown",d,!0),u}},_obtainHtml5Audio:function(){var u=this||i;if(u._html5AudioPool.length)return u._html5AudioPool.pop();var d=new Audio().play();return d&&typeof Promise<"u"&&(d instanceof Promise||typeof d.then=="function")&&d.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(u){var d=this||i;return u._unlocked&&d._html5AudioPool.push(u),d},_autoSuspend:function(){var u=this;if(!(!u.autoSuspend||!u.ctx||typeof u.ctx.suspend>"u"||!i.usingWebAudio)){for(var d=0;d<u._howls.length;d++)if(u._howls[d]._webAudio){for(var f=0;f<u._howls[d]._sounds.length;f++)if(!u._howls[d]._sounds[f]._paused)return u}return u._suspendTimer&&clearTimeout(u._suspendTimer),u._suspendTimer=setTimeout(function(){if(u.autoSuspend){u._suspendTimer=null,u.state="suspending";var p=function(){u.state="suspended",u._resumeAfterSuspend&&(delete u._resumeAfterSuspend,u._autoResume())};u.ctx.suspend().then(p,p)}},3e4),u}},_autoResume:function(){var u=this;if(!(!u.ctx||typeof u.ctx.resume>"u"||!i.usingWebAudio))return u.state==="running"&&u.ctx.state!=="interrupted"&&u._suspendTimer?(clearTimeout(u._suspendTimer),u._suspendTimer=null):u.state==="suspended"||u.state==="running"&&u.ctx.state==="interrupted"?(u.ctx.resume().then(function(){u.state="running";for(var d=0;d<u._howls.length;d++)u._howls[d]._emit("resume")}),u._suspendTimer&&(clearTimeout(u._suspendTimer),u._suspendTimer=null)):u.state==="suspending"&&(u._resumeAfterSuspend=!0),u}};var i=new e,n=function(u){var d=this;if(!u.src||u.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}d.init(u)};n.prototype={init:function(u){var d=this;return i.ctx||h(),d._autoplay=u.autoplay||!1,d._format=typeof u.format!="string"?u.format:[u.format],d._html5=u.html5||!1,d._muted=u.mute||!1,d._loop=u.loop||!1,d._pool=u.pool||5,d._preload=typeof u.preload=="boolean"||u.preload==="metadata"?u.preload:!0,d._rate=u.rate||1,d._sprite=u.sprite||{},d._src=typeof u.src!="string"?u.src:[u.src],d._volume=u.volume!==void 0?u.volume:1,d._xhr={method:u.xhr&&u.xhr.method?u.xhr.method:"GET",headers:u.xhr&&u.xhr.headers?u.xhr.headers:null,withCredentials:u.xhr&&u.xhr.withCredentials?u.xhr.withCredentials:!1},d._duration=0,d._state="unloaded",d._sounds=[],d._endTimers={},d._queue=[],d._playLock=!1,d._onend=u.onend?[{fn:u.onend}]:[],d._onfade=u.onfade?[{fn:u.onfade}]:[],d._onload=u.onload?[{fn:u.onload}]:[],d._onloaderror=u.onloaderror?[{fn:u.onloaderror}]:[],d._onplayerror=u.onplayerror?[{fn:u.onplayerror}]:[],d._onpause=u.onpause?[{fn:u.onpause}]:[],d._onplay=u.onplay?[{fn:u.onplay}]:[],d._onstop=u.onstop?[{fn:u.onstop}]:[],d._onmute=u.onmute?[{fn:u.onmute}]:[],d._onvolume=u.onvolume?[{fn:u.onvolume}]:[],d._onrate=u.onrate?[{fn:u.onrate}]:[],d._onseek=u.onseek?[{fn:u.onseek}]:[],d._onunlock=u.onunlock?[{fn:u.onunlock}]:[],d._onresume=[],d._webAudio=i.usingWebAudio&&!d._html5,typeof i.ctx<"u"&&i.ctx&&i.autoUnlock&&i._unlockAudio(),i._howls.push(d),d._autoplay&&d._queue.push({event:"play",action:function(){d.play()}}),d._preload&&d._preload!=="none"&&d.load(),d},load:function(){var u=this,d=null;if(i.noAudio){u._emit("loaderror",null,"No audio support.");return}typeof u._src=="string"&&(u._src=[u._src]);for(var f=0;f<u._src.length;f++){var p,m;if(u._format&&u._format[f])p=u._format[f];else{if(m=u._src[f],typeof m!="string"){u._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}p=/^data:audio\/([^;,]+);/i.exec(m),p||(p=/\.([^.]+)$/.exec(m.split("?",1)[0])),p&&(p=p[1].toLowerCase())}if(p||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),p&&i.codecs(p)){d=u._src[f];break}}if(!d){u._emit("loaderror",null,"No codec support for selected audio sources.");return}return u._src=d,u._state="loading",window.location.protocol==="https:"&&d.slice(0,5)==="http:"&&(u._html5=!0,u._webAudio=!1),new r(u),u._webAudio&&o(u),u},play:function(u,d){var f=this,p=null;if(typeof u=="number")p=u,u=null;else{if(typeof u=="string"&&f._state==="loaded"&&!f._sprite[u])return null;if(typeof u>"u"&&(u="__default",!f._playLock)){for(var m=0,v=0;v<f._sounds.length;v++)f._sounds[v]._paused&&!f._sounds[v]._ended&&(m++,p=f._sounds[v]._id);m===1?u=null:p=null}}var g=p?f._soundById(p):f._inactiveSound();if(!g)return null;if(p&&!u&&(u=g._sprite||"__default"),f._state!=="loaded"){g._sprite=u,g._ended=!1;var y=g._id;return f._queue.push({event:"play",action:function(){f.play(y)}}),y}if(p&&!g._paused)return d||f._loadQueue("play"),g._id;f._webAudio&&i._autoResume();var x=Math.max(0,g._seek>0?g._seek:f._sprite[u][0]/1e3),b=Math.max(0,(f._sprite[u][0]+f._sprite[u][1])/1e3-x),S=b*1e3/Math.abs(g._rate),A=f._sprite[u][0]/1e3,E=(f._sprite[u][0]+f._sprite[u][1])/1e3;g._sprite=u,g._ended=!1;var M=function(){g._paused=!1,g._seek=x,g._start=A,g._stop=E,g._loop=!!(g._loop||f._sprite[u][2])};if(x>=E){f._ended(g);return}var T=g._node;if(f._webAudio){var P=function(){f._playLock=!1,M(),f._refreshBuffer(g);var N=g._muted||f._muted?0:g._volume;T.gain.setValueAtTime(N,i.ctx.currentTime),g._playStart=i.ctx.currentTime,typeof T.bufferSource.start>"u"?g._loop?T.bufferSource.noteGrainOn(0,x,86400):T.bufferSource.noteGrainOn(0,x,b):g._loop?T.bufferSource.start(0,x,86400):T.bufferSource.start(0,x,b),S!==1/0&&(f._endTimers[g._id]=setTimeout(f._ended.bind(f,g),S)),d||setTimeout(function(){f._emit("play",g._id),f._loadQueue()},0)};i.state==="running"&&i.ctx.state!=="interrupted"?P():(f._playLock=!0,f.once("resume",P),f._clearTimer(g._id))}else{var R=function(){T.currentTime=x,T.muted=g._muted||f._muted||i._muted||T.muted,T.volume=g._volume*i.volume(),T.playbackRate=g._rate;try{var N=T.play();if(N&&typeof Promise<"u"&&(N instanceof Promise||typeof N.then=="function")?(f._playLock=!0,M(),N.then(function(){f._playLock=!1,T._unlocked=!0,d?f._loadQueue():f._emit("play",g._id)}).catch(function(){f._playLock=!1,f._emit("playerror",g._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),g._ended=!0,g._paused=!0})):d||(f._playLock=!1,M(),f._emit("play",g._id)),T.playbackRate=g._rate,T.paused){f._emit("playerror",g._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}u!=="__default"||g._loop?f._endTimers[g._id]=setTimeout(f._ended.bind(f,g),S):(f._endTimers[g._id]=function(){f._ended(g),T.removeEventListener("ended",f._endTimers[g._id],!1)},T.addEventListener("ended",f._endTimers[g._id],!1))}catch(W){f._emit("playerror",g._id,W)}};T.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(T.src=f._src,T.load());var U=window&&window.ejecta||!T.readyState&&i._navigator.isCocoonJS;if(T.readyState>=3||U)R();else{f._playLock=!0,f._state="loading";var F=function(){f._state="loaded",R(),T.removeEventListener(i._canPlayEvent,F,!1)};T.addEventListener(i._canPlayEvent,F,!1),f._clearTimer(g._id)}}return g._id},pause:function(u){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"pause",action:function(){d.pause(u)}}),d;for(var f=d._getSoundIds(u),p=0;p<f.length;p++){d._clearTimer(f[p]);var m=d._soundById(f[p]);if(m&&!m._paused&&(m._seek=d.seek(f[p]),m._rateSeek=0,m._paused=!0,d._stopFade(f[p]),m._node))if(d._webAudio){if(!m._node.bufferSource)continue;typeof m._node.bufferSource.stop>"u"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),d._cleanBuffer(m._node)}else(!isNaN(m._node.duration)||m._node.duration===1/0)&&m._node.pause();arguments[1]||d._emit("pause",m?m._id:null)}return d},stop:function(u,d){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"stop",action:function(){f.stop(u)}}),f;for(var p=f._getSoundIds(u),m=0;m<p.length;m++){f._clearTimer(p[m]);var v=f._soundById(p[m]);v&&(v._seek=v._start||0,v._rateSeek=0,v._paused=!0,v._ended=!0,f._stopFade(p[m]),v._node&&(f._webAudio?v._node.bufferSource&&(typeof v._node.bufferSource.stop>"u"?v._node.bufferSource.noteOff(0):v._node.bufferSource.stop(0),f._cleanBuffer(v._node)):(!isNaN(v._node.duration)||v._node.duration===1/0)&&(v._node.currentTime=v._start||0,v._node.pause(),v._node.duration===1/0&&f._clearSound(v._node))),d||f._emit("stop",v._id))}return f},mute:function(u,d){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"mute",action:function(){f.mute(u,d)}}),f;if(typeof d>"u")if(typeof u=="boolean")f._muted=u;else return f._muted;for(var p=f._getSoundIds(d),m=0;m<p.length;m++){var v=f._soundById(p[m]);v&&(v._muted=u,v._interval&&f._stopFade(v._id),f._webAudio&&v._node?v._node.gain.setValueAtTime(u?0:v._volume,i.ctx.currentTime):v._node&&(v._node.muted=i._muted?!0:u),f._emit("mute",v._id))}return f},volume:function(){var u=this,d=arguments,f,p;if(d.length===0)return u._volume;if(d.length===1||d.length===2&&typeof d[1]>"u"){var m=u._getSoundIds(),v=m.indexOf(d[0]);v>=0?p=parseInt(d[0],10):f=parseFloat(d[0])}else d.length>=2&&(f=parseFloat(d[0]),p=parseInt(d[1],10));var g;if(typeof f<"u"&&f>=0&&f<=1){if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"volume",action:function(){u.volume.apply(u,d)}}),u;typeof p>"u"&&(u._volume=f),p=u._getSoundIds(p);for(var y=0;y<p.length;y++)g=u._soundById(p[y]),g&&(g._volume=f,d[2]||u._stopFade(p[y]),u._webAudio&&g._node&&!g._muted?g._node.gain.setValueAtTime(f,i.ctx.currentTime):g._node&&!g._muted&&(g._node.volume=f*i.volume()),u._emit("volume",g._id))}else return g=p?u._soundById(p):u._sounds[0],g?g._volume:0;return u},fade:function(u,d,f,p){var m=this;if(m._state!=="loaded"||m._playLock)return m._queue.push({event:"fade",action:function(){m.fade(u,d,f,p)}}),m;u=Math.min(Math.max(0,parseFloat(u)),1),d=Math.min(Math.max(0,parseFloat(d)),1),f=parseFloat(f),m.volume(u,p);for(var v=m._getSoundIds(p),g=0;g<v.length;g++){var y=m._soundById(v[g]);if(y){if(p||m._stopFade(v[g]),m._webAudio&&!y._muted){var x=i.ctx.currentTime,b=x+f/1e3;y._volume=u,y._node.gain.setValueAtTime(u,x),y._node.gain.linearRampToValueAtTime(d,b)}m._startFadeInterval(y,u,d,f,v[g],typeof p>"u")}}return m},_startFadeInterval:function(u,d,f,p,m,v){var g=this,y=d,x=f-d,b=Math.abs(x/.01),S=Math.max(4,b>0?p/b:p),A=Date.now();u._fadeTo=f,u._interval=setInterval(function(){var E=(Date.now()-A)/p;A=Date.now(),y+=x*E,y=Math.round(y*100)/100,x<0?y=Math.max(f,y):y=Math.min(f,y),g._webAudio?u._volume=y:g.volume(y,u._id,!0),v&&(g._volume=y),(f<d&&y<=f||f>d&&y>=f)&&(clearInterval(u._interval),u._interval=null,u._fadeTo=null,g.volume(f,u._id),g._emit("fade",u._id))},S)},_stopFade:function(u){var d=this,f=d._soundById(u);return f&&f._interval&&(d._webAudio&&f._node.gain.cancelScheduledValues(i.ctx.currentTime),clearInterval(f._interval),f._interval=null,d.volume(f._fadeTo,u),f._fadeTo=null,d._emit("fade",u)),d},loop:function(){var u=this,d=arguments,f,p,m;if(d.length===0)return u._loop;if(d.length===1)if(typeof d[0]=="boolean")f=d[0],u._loop=f;else return m=u._soundById(parseInt(d[0],10)),m?m._loop:!1;else d.length===2&&(f=d[0],p=parseInt(d[1],10));for(var v=u._getSoundIds(p),g=0;g<v.length;g++)m=u._soundById(v[g]),m&&(m._loop=f,u._webAudio&&m._node&&m._node.bufferSource&&(m._node.bufferSource.loop=f,f&&(m._node.bufferSource.loopStart=m._start||0,m._node.bufferSource.loopEnd=m._stop,u.playing(v[g])&&(u.pause(v[g],!0),u.play(v[g],!0)))));return u},rate:function(){var u=this,d=arguments,f,p;if(d.length===0)p=u._sounds[0]._id;else if(d.length===1){var m=u._getSoundIds(),v=m.indexOf(d[0]);v>=0?p=parseInt(d[0],10):f=parseFloat(d[0])}else d.length===2&&(f=parseFloat(d[0]),p=parseInt(d[1],10));var g;if(typeof f=="number"){if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"rate",action:function(){u.rate.apply(u,d)}}),u;typeof p>"u"&&(u._rate=f),p=u._getSoundIds(p);for(var y=0;y<p.length;y++)if(g=u._soundById(p[y]),g){u.playing(p[y])&&(g._rateSeek=u.seek(p[y]),g._playStart=u._webAudio?i.ctx.currentTime:g._playStart),g._rate=f,u._webAudio&&g._node&&g._node.bufferSource?g._node.bufferSource.playbackRate.setValueAtTime(f,i.ctx.currentTime):g._node&&(g._node.playbackRate=f);var x=u.seek(p[y]),b=(u._sprite[g._sprite][0]+u._sprite[g._sprite][1])/1e3-x,S=b*1e3/Math.abs(g._rate);(u._endTimers[p[y]]||!g._paused)&&(u._clearTimer(p[y]),u._endTimers[p[y]]=setTimeout(u._ended.bind(u,g),S)),u._emit("rate",g._id)}}else return g=u._soundById(p),g?g._rate:u._rate;return u},seek:function(){var u=this,d=arguments,f,p;if(d.length===0)u._sounds.length&&(p=u._sounds[0]._id);else if(d.length===1){var m=u._getSoundIds(),v=m.indexOf(d[0]);v>=0?p=parseInt(d[0],10):u._sounds.length&&(p=u._sounds[0]._id,f=parseFloat(d[0]))}else d.length===2&&(f=parseFloat(d[0]),p=parseInt(d[1],10));if(typeof p>"u")return 0;if(typeof f=="number"&&(u._state!=="loaded"||u._playLock))return u._queue.push({event:"seek",action:function(){u.seek.apply(u,d)}}),u;var g=u._soundById(p);if(g)if(typeof f=="number"&&f>=0){var y=u.playing(p);y&&u.pause(p,!0),g._seek=f,g._ended=!1,u._clearTimer(p),!u._webAudio&&g._node&&!isNaN(g._node.duration)&&(g._node.currentTime=f);var x=function(){y&&u.play(p,!0),u._emit("seek",p)};if(y&&!u._webAudio){var b=function(){u._playLock?setTimeout(b,0):x()};setTimeout(b,0)}else x()}else if(u._webAudio){var S=u.playing(p)?i.ctx.currentTime-g._playStart:0,A=g._rateSeek?g._rateSeek-g._seek:0;return g._seek+(A+S*Math.abs(g._rate))}else return g._node.currentTime;return u},playing:function(u){var d=this;if(typeof u=="number"){var f=d._soundById(u);return f?!f._paused:!1}for(var p=0;p<d._sounds.length;p++)if(!d._sounds[p]._paused)return!0;return!1},duration:function(u){var d=this,f=d._duration,p=d._soundById(u);return p&&(f=d._sprite[p._sprite][1]/1e3),f},state:function(){return this._state},unload:function(){for(var u=this,d=u._sounds,f=0;f<d.length;f++)d[f]._paused||u.stop(d[f]._id),u._webAudio||(u._clearSound(d[f]._node),d[f]._node.removeEventListener("error",d[f]._errorFn,!1),d[f]._node.removeEventListener(i._canPlayEvent,d[f]._loadFn,!1),d[f]._node.removeEventListener("ended",d[f]._endFn,!1),i._releaseHtml5Audio(d[f]._node)),delete d[f]._node,u._clearTimer(d[f]._id);var p=i._howls.indexOf(u);p>=0&&i._howls.splice(p,1);var m=!0;for(f=0;f<i._howls.length;f++)if(i._howls[f]._src===u._src||u._src.indexOf(i._howls[f]._src)>=0){m=!1;break}return s&&m&&delete s[u._src],i.noAudio=!1,u._state="unloaded",u._sounds=[],u=null,null},on:function(u,d,f,p){var m=this,v=m["_on"+u];return typeof d=="function"&&v.push(p?{id:f,fn:d,once:p}:{id:f,fn:d}),m},off:function(u,d,f){var p=this,m=p["_on"+u],v=0;if(typeof d=="number"&&(f=d,d=null),d||f)for(v=0;v<m.length;v++){var g=f===m[v].id;if(d===m[v].fn&&g||!d&&g){m.splice(v,1);break}}else if(u)p["_on"+u]=[];else{var y=Object.keys(p);for(v=0;v<y.length;v++)y[v].indexOf("_on")===0&&Array.isArray(p[y[v]])&&(p[y[v]]=[])}return p},once:function(u,d,f){var p=this;return p.on(u,d,f,1),p},_emit:function(u,d,f){for(var p=this,m=p["_on"+u],v=m.length-1;v>=0;v--)(!m[v].id||m[v].id===d||u==="load")&&(setTimeout((function(g){g.call(this,d,f)}).bind(p,m[v].fn),0),m[v].once&&p.off(u,m[v].fn,m[v].id));return p._loadQueue(u),p},_loadQueue:function(u){var d=this;if(d._queue.length>0){var f=d._queue[0];f.event===u&&(d._queue.shift(),d._loadQueue()),u||f.action()}return d},_ended:function(u){var d=this,f=u._sprite;if(!d._webAudio&&u._node&&!u._node.paused&&!u._node.ended&&u._node.currentTime<u._stop)return setTimeout(d._ended.bind(d,u),100),d;var p=!!(u._loop||d._sprite[f][2]);if(d._emit("end",u._id),!d._webAudio&&p&&d.stop(u._id,!0).play(u._id),d._webAudio&&p){d._emit("play",u._id),u._seek=u._start||0,u._rateSeek=0,u._playStart=i.ctx.currentTime;var m=(u._stop-u._start)*1e3/Math.abs(u._rate);d._endTimers[u._id]=setTimeout(d._ended.bind(d,u),m)}return d._webAudio&&!p&&(u._paused=!0,u._ended=!0,u._seek=u._start||0,u._rateSeek=0,d._clearTimer(u._id),d._cleanBuffer(u._node),i._autoSuspend()),!d._webAudio&&!p&&d.stop(u._id,!0),d},_clearTimer:function(u){var d=this;if(d._endTimers[u]){if(typeof d._endTimers[u]!="function")clearTimeout(d._endTimers[u]);else{var f=d._soundById(u);f&&f._node&&f._node.removeEventListener("ended",d._endTimers[u],!1)}delete d._endTimers[u]}return d},_soundById:function(u){for(var d=this,f=0;f<d._sounds.length;f++)if(u===d._sounds[f]._id)return d._sounds[f];return null},_inactiveSound:function(){var u=this;u._drain();for(var d=0;d<u._sounds.length;d++)if(u._sounds[d]._ended)return u._sounds[d].reset();return new r(u)},_drain:function(){var u=this,d=u._pool,f=0,p=0;if(!(u._sounds.length<d)){for(p=0;p<u._sounds.length;p++)u._sounds[p]._ended&&f++;for(p=u._sounds.length-1;p>=0;p--){if(f<=d)return;u._sounds[p]._ended&&(u._webAudio&&u._sounds[p]._node&&u._sounds[p]._node.disconnect(0),u._sounds.splice(p,1),f--)}}},_getSoundIds:function(u){var d=this;if(typeof u>"u"){for(var f=[],p=0;p<d._sounds.length;p++)f.push(d._sounds[p]._id);return f}else return[u]},_refreshBuffer:function(u){var d=this;return u._node.bufferSource=i.ctx.createBufferSource(),u._node.bufferSource.buffer=s[d._src],u._panner?u._node.bufferSource.connect(u._panner):u._node.bufferSource.connect(u._node),u._node.bufferSource.loop=u._loop,u._loop&&(u._node.bufferSource.loopStart=u._start||0,u._node.bufferSource.loopEnd=u._stop||0),u._node.bufferSource.playbackRate.setValueAtTime(u._rate,i.ctx.currentTime),d},_cleanBuffer:function(u){var d=this,f=i._navigator&&i._navigator.vendor.indexOf("Apple")>=0;if(i._scratchBuffer&&u.bufferSource&&(u.bufferSource.onended=null,u.bufferSource.disconnect(0),f))try{u.bufferSource.buffer=i._scratchBuffer}catch{}return u.bufferSource=null,d},_clearSound:function(u){var d=/MSIE |Trident\//.test(i._navigator&&i._navigator.userAgent);d||(u.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(u){this._parent=u,this.init()};r.prototype={init:function(){var u=this,d=u._parent;return u._muted=d._muted,u._loop=d._loop,u._volume=d._volume,u._rate=d._rate,u._seek=0,u._paused=!0,u._ended=!0,u._sprite="__default",u._id=++i._counter,d._sounds.push(u),u.create(),u},create:function(){var u=this,d=u._parent,f=i._muted||u._muted||u._parent._muted?0:u._volume;return d._webAudio?(u._node=typeof i.ctx.createGain>"u"?i.ctx.createGainNode():i.ctx.createGain(),u._node.gain.setValueAtTime(f,i.ctx.currentTime),u._node.paused=!0,u._node.connect(i.masterGain)):i.noAudio||(u._node=i._obtainHtml5Audio(),u._errorFn=u._errorListener.bind(u),u._node.addEventListener("error",u._errorFn,!1),u._loadFn=u._loadListener.bind(u),u._node.addEventListener(i._canPlayEvent,u._loadFn,!1),u._endFn=u._endListener.bind(u),u._node.addEventListener("ended",u._endFn,!1),u._node.src=d._src,u._node.preload=d._preload===!0?"auto":d._preload,u._node.volume=f*i.volume(),u._node.load()),u},reset:function(){var u=this,d=u._parent;return u._muted=d._muted,u._loop=d._loop,u._volume=d._volume,u._rate=d._rate,u._seek=0,u._rateSeek=0,u._paused=!0,u._ended=!0,u._sprite="__default",u._id=++i._counter,u},_errorListener:function(){var u=this;u._parent._emit("loaderror",u._id,u._node.error?u._node.error.code:0),u._node.removeEventListener("error",u._errorFn,!1)},_loadListener:function(){var u=this,d=u._parent;d._duration=Math.ceil(u._node.duration*10)/10,Object.keys(d._sprite).length===0&&(d._sprite={__default:[0,d._duration*1e3]}),d._state!=="loaded"&&(d._state="loaded",d._emit("load"),d._loadQueue()),u._node.removeEventListener(i._canPlayEvent,u._loadFn,!1)},_endListener:function(){var u=this,d=u._parent;d._duration===1/0&&(d._duration=Math.ceil(u._node.duration*10)/10,d._sprite.__default[1]===1/0&&(d._sprite.__default[1]=d._duration*1e3),d._ended(u)),u._node.removeEventListener("ended",u._endFn,!1)}};var s={},o=function(u){var d=u._src;if(s[d]){u._duration=s[d].duration,c(u);return}if(/^data:[^;]+;base64,/.test(d)){for(var f=atob(d.split(",")[1]),p=new Uint8Array(f.length),m=0;m<f.length;++m)p[m]=f.charCodeAt(m);l(p.buffer,u)}else{var v=new XMLHttpRequest;v.open(u._xhr.method,d,!0),v.withCredentials=u._xhr.withCredentials,v.responseType="arraybuffer",u._xhr.headers&&Object.keys(u._xhr.headers).forEach(function(g){v.setRequestHeader(g,u._xhr.headers[g])}),v.onload=function(){var g=(v.status+"")[0];if(g!=="0"&&g!=="2"&&g!=="3"){u._emit("loaderror",null,"Failed loading audio file with status: "+v.status+".");return}l(v.response,u)},v.onerror=function(){u._webAudio&&(u._html5=!0,u._webAudio=!1,u._sounds=[],delete s[d],u.load())},a(v)}},a=function(u){try{u.send()}catch{u.onerror()}},l=function(u,d){var f=function(){d._emit("loaderror",null,"Decoding audio data failed.")},p=function(m){m&&d._sounds.length>0?(s[d._src]=m,c(d,m)):f()};typeof Promise<"u"&&i.ctx.decodeAudioData.length===1?i.ctx.decodeAudioData(u).then(p).catch(f):i.ctx.decodeAudioData(u,p,f)},c=function(u,d){d&&!u._duration&&(u._duration=d.duration),Object.keys(u._sprite).length===0&&(u._sprite={__default:[0,u._duration*1e3]}),u._state!=="loaded"&&(u._state="loaded",u._emit("load"),u._loadQueue())},h=function(){if(i.usingWebAudio){try{typeof AudioContext<"u"?i.ctx=new AudioContext:typeof webkitAudioContext<"u"?i.ctx=new webkitAudioContext:i.usingWebAudio=!1}catch{i.usingWebAudio=!1}i.ctx||(i.usingWebAudio=!1);var u=/iP(hone|od|ad)/.test(i._navigator&&i._navigator.platform),d=i._navigator&&i._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),f=d?parseInt(d[1],10):null;if(u&&f&&f<9){var p=/safari/.test(i._navigator&&i._navigator.userAgent.toLowerCase());i._navigator&&!p&&(i.usingWebAudio=!1)}i.usingWebAudio&&(i.masterGain=typeof i.ctx.createGain>"u"?i.ctx.createGainNode():i.ctx.createGain(),i.masterGain.gain.setValueAtTime(i._muted?0:i._volume,i.ctx.currentTime),i.masterGain.connect(i.ctx.destination)),i._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:i,Howl:n}}),typeof t<"u"&&(t.Howler=i,t.Howl=n),typeof global<"u"?(global.HowlerGlobal=e,global.Howler=i,global.Howl=n,global.Sound=r):typeof window<"u"&&(window.HowlerGlobal=e,window.Howler=i,window.Howl=n,window.Sound=r)})(),function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(i){var n=this;if(!n.ctx||!n.ctx.listener)return n;for(var r=n._howls.length-1;r>=0;r--)n._howls[r].stereo(i);return n},HowlerGlobal.prototype.pos=function(i,n,r){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(n=typeof n!="number"?s._pos[1]:n,r=typeof r!="number"?s._pos[2]:r,typeof i=="number")s._pos=[i,n,r],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(i,n,r,s,o,a){var l=this;if(!l.ctx||!l.ctx.listener)return l;var c=l._orientation;if(n=typeof n!="number"?c[1]:n,r=typeof r!="number"?c[2]:r,s=typeof s!="number"?c[3]:s,o=typeof o!="number"?c[4]:o,a=typeof a!="number"?c[5]:a,typeof i=="number")l._orientation=[i,n,r,s,o,a],typeof l.ctx.listener.forwardX<"u"?(l.ctx.listener.forwardX.setTargetAtTime(i,Howler.ctx.currentTime,.1),l.ctx.listener.forwardY.setTargetAtTime(n,Howler.ctx.currentTime,.1),l.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),l.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),l.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),l.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1)):l.ctx.listener.setOrientation(i,n,r,s,o,a);else return c;return l},Howl.prototype.init=function(i){return function(n){var r=this;return r._orientation=n.orientation||[1,0,0],r._stereo=n.stereo||null,r._pos=n.pos||null,r._pannerAttr={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:360,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:360,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:0,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:"inverse",maxDistance:typeof n.maxDistance<"u"?n.maxDistance:1e4,panningModel:typeof n.panningModel<"u"?n.panningModel:"HRTF",refDistance:typeof n.refDistance<"u"?n.refDistance:1,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:1},r._onstereo=n.onstereo?[{fn:n.onstereo}]:[],r._onpos=n.onpos?[{fn:n.onpos}]:[],r._onorientation=n.onorientation?[{fn:n.onorientation}]:[],i.call(this,n)}}(Howl.prototype.init),Howl.prototype.stereo=function(i,n){var r=this;if(!r._webAudio)return r;if(r._state!=="loaded")return r._queue.push({event:"stereo",action:function(){r.stereo(i,n)}}),r;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof n>"u")if(typeof i=="number")r._stereo=i,r._pos=[i,0,0];else return r._stereo;for(var o=r._getSoundIds(n),a=0;a<o.length;a++){var l=r._soundById(o[a]);if(l)if(typeof i=="number")l._stereo=i,l._pos=[i,0,0],l._node&&(l._pannerAttr.panningModel="equalpower",(!l._panner||!l._panner.pan)&&e(l,s),s==="spatial"?typeof l._panner.positionX<"u"?(l._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):l._panner.setPosition(i,0,0):l._panner.pan.setValueAtTime(i,Howler.ctx.currentTime)),r._emit("stereo",l._id);else return l._stereo}return r},Howl.prototype.pos=function(i,n,r,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"pos",action:function(){o.pos(i,n,r,s)}}),o;if(n=typeof n!="number"?0:n,r=typeof r!="number"?-.5:r,typeof s>"u")if(typeof i=="number")o._pos=[i,n,r];else return o._pos;for(var a=o._getSoundIds(s),l=0;l<a.length;l++){var c=o._soundById(a[l]);if(c)if(typeof i=="number")c._pos=[i,n,r],c._node&&((!c._panner||c._panner.pan)&&e(c,"spatial"),typeof c._panner.positionX<"u"?(c._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):c._panner.setPosition(i,n,r)),o._emit("pos",c._id);else return c._pos}return o},Howl.prototype.orientation=function(i,n,r,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"orientation",action:function(){o.orientation(i,n,r,s)}}),o;if(n=typeof n!="number"?o._orientation[1]:n,r=typeof r!="number"?o._orientation[2]:r,typeof s>"u")if(typeof i=="number")o._orientation=[i,n,r];else return o._orientation;for(var a=o._getSoundIds(s),l=0;l<a.length;l++){var c=o._soundById(a[l]);if(c)if(typeof i=="number")c._orientation=[i,n,r],c._node&&(c._panner||(c._pos||(c._pos=o._pos||[0,0,-.5]),e(c,"spatial")),typeof c._panner.orientationX<"u"?(c._panner.orientationX.setValueAtTime(i,Howler.ctx.currentTime),c._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),c._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):c._panner.setOrientation(i,n,r)),o._emit("orientation",c._id);else return c._orientation}return o},Howl.prototype.pannerAttr=function(){var i=this,n=arguments,r,s,o;if(!i._webAudio)return i;if(n.length===0)return i._pannerAttr;if(n.length===1)if(typeof n[0]=="object")r=n[0],typeof s>"u"&&(r.pannerAttr||(r.pannerAttr={coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor,panningModel:r.panningModel}),i._pannerAttr={coneInnerAngle:typeof r.pannerAttr.coneInnerAngle<"u"?r.pannerAttr.coneInnerAngle:i._coneInnerAngle,coneOuterAngle:typeof r.pannerAttr.coneOuterAngle<"u"?r.pannerAttr.coneOuterAngle:i._coneOuterAngle,coneOuterGain:typeof r.pannerAttr.coneOuterGain<"u"?r.pannerAttr.coneOuterGain:i._coneOuterGain,distanceModel:typeof r.pannerAttr.distanceModel<"u"?r.pannerAttr.distanceModel:i._distanceModel,maxDistance:typeof r.pannerAttr.maxDistance<"u"?r.pannerAttr.maxDistance:i._maxDistance,refDistance:typeof r.pannerAttr.refDistance<"u"?r.pannerAttr.refDistance:i._refDistance,rolloffFactor:typeof r.pannerAttr.rolloffFactor<"u"?r.pannerAttr.rolloffFactor:i._rolloffFactor,panningModel:typeof r.pannerAttr.panningModel<"u"?r.pannerAttr.panningModel:i._panningModel});else return o=i._soundById(parseInt(n[0],10)),o?o._pannerAttr:i._pannerAttr;else n.length===2&&(r=n[0],s=parseInt(n[1],10));for(var a=i._getSoundIds(s),l=0;l<a.length;l++)if(o=i._soundById(a[l]),o){var c=o._pannerAttr;c={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:c.coneInnerAngle,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:c.coneOuterAngle,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:c.coneOuterGain,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:c.distanceModel,maxDistance:typeof r.maxDistance<"u"?r.maxDistance:c.maxDistance,refDistance:typeof r.refDistance<"u"?r.refDistance:c.refDistance,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:c.rolloffFactor,panningModel:typeof r.panningModel<"u"?r.panningModel:c.panningModel};var h=o._panner;h?(h.coneInnerAngle=c.coneInnerAngle,h.coneOuterAngle=c.coneOuterAngle,h.coneOuterGain=c.coneOuterGain,h.distanceModel=c.distanceModel,h.maxDistance=c.maxDistance,h.refDistance=c.refDistance,h.rolloffFactor=c.rolloffFactor,h.panningModel=c.panningModel):(o._pos||(o._pos=i._pos||[0,0,-.5]),e(o,"spatial"))}return i},Sound.prototype.init=function(i){return function(){var n=this,r=n._parent;n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,i.call(this),n._stereo?r.stereo(n._stereo):n._pos&&r.pos(n._pos[0],n._pos[1],n._pos[2],n._id)}}(Sound.prototype.init),Sound.prototype.reset=function(i){return function(){var n=this,r=n._parent;return n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,n._stereo?r.stereo(n._stereo):n._pos?r.pos(n._pos[0],n._pos[1],n._pos[2],n._id):n._panner&&(n._panner.disconnect(0),n._panner=void 0,r._refreshBuffer(n)),i.call(this)}}(Sound.prototype.reset);var e=function(i,n){n=n||"spatial",n==="spatial"?(i._panner=Howler.ctx.createPanner(),i._panner.coneInnerAngle=i._pannerAttr.coneInnerAngle,i._panner.coneOuterAngle=i._pannerAttr.coneOuterAngle,i._panner.coneOuterGain=i._pannerAttr.coneOuterGain,i._panner.distanceModel=i._pannerAttr.distanceModel,i._panner.maxDistance=i._pannerAttr.maxDistance,i._panner.refDistance=i._pannerAttr.refDistance,i._panner.rolloffFactor=i._pannerAttr.rolloffFactor,i._panner.panningModel=i._pannerAttr.panningModel,typeof i._panner.positionX<"u"?(i._panner.positionX.setValueAtTime(i._pos[0],Howler.ctx.currentTime),i._panner.positionY.setValueAtTime(i._pos[1],Howler.ctx.currentTime),i._panner.positionZ.setValueAtTime(i._pos[2],Howler.ctx.currentTime)):i._panner.setPosition(i._pos[0],i._pos[1],i._pos[2]),typeof i._panner.orientationX<"u"?(i._panner.orientationX.setValueAtTime(i._orientation[0],Howler.ctx.currentTime),i._panner.orientationY.setValueAtTime(i._orientation[1],Howler.ctx.currentTime),i._panner.orientationZ.setValueAtTime(i._orientation[2],Howler.ctx.currentTime)):i._panner.setOrientation(i._orientation[0],i._orientation[1],i._orientation[2])):(i._panner=Howler.ctx.createStereoPanner(),i._panner.pan.setValueAtTime(i._stereo,Howler.ctx.currentTime)),i._panner.connect(i._node),i._paused||i._parent.pause(i._id,!0).play(i._id,!0)}}()}),PSe=JC((t,e)=>{e.exports=function(i,n){for(var r=i.split("."),s=n.split("."),o=0;o<3;o++){var a=Number(r[o]),l=Number(s[o]);if(a>l)return 1;if(l>a)return-1;if(!isNaN(a)&&isNaN(l))return 1;if(isNaN(a)&&!isNaN(l))return-1}return 0}}),oy="149",_a={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},DSe=0,f6=1,RSe=2,rk=1,ISe=2,s1=3,Hl=0,kr=1,Wo=2,fr=0,jv=1,p6=2,m6=3,g6=4,LSe=5,Yg=100,BSe=101,OSe=102,v6=103,y6=104,FSe=200,NSe=201,USe=202,kSe=203,hee=204,dee=205,zSe=206,GSe=207,HSe=208,VSe=209,jSe=210,WSe=0,XSe=1,qSe=2,LB=3,YSe=4,QSe=5,KSe=6,JSe=7,fee=0,ZSe=1,$Se=2,ih=0,eAe=1,tAe=2,iAe=3,nAe=4,rAe=5,pee=300,sm=301,om=302,BB=303,OB=304,Iw=306,Qu=1e3,Qn=1001,FB=1002,Zi=1003,x6=1004,xR=1005,ri=1006,sAe=1007,F0=1008,As=1009,oAe=1010,aAe=1011,mee=1012,lAe=1013,pd=1014,Xo=1015,N0=1016,cAe=1017,uAe=1018,Gp=1020,hAe=1021,za=1023,dAe=1024,fAe=1025,Hp=1026,am=1027,pAe=1028,mAe=1029,gee=1030,gAe=1031,vAe=1033,_R=33776,wR=33777,bR=33778,SR=33779,_6=35840,w6=35841,b6=35842,S6=35843,yAe=36196,A6=37492,M6=37496,E6=37808,T6=37809,C6=37810,P6=37811,D6=37812,R6=37813,I6=37814,L6=37815,B6=37816,O6=37817,F6=37818,N6=37819,U6=37820,k6=37821,AR=36492,xAe=36283,z6=36284,G6=36285,H6=36286,vee=2200,yee=2201,sk=2202,QE=2300,KE=2301,MR=2302,Sv=2400,Av=2401,JE=2402,ok=2500,_Ae=2501,Yc=3e3,Qt=3001,vh=3200,xee=3201,wAe=0,bAe=1,_c="srgb",ZE="srgb-linear",ER=7680,SAe=519,NB=35044,V6="300 es",UB=1035,is=class{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});let i=this._listeners;i[t]===void 0&&(i[t]=[]),i[t].indexOf(e)===-1&&i[t].push(e)}hasEventListener(t,e){if(this._listeners===void 0)return!1;let i=this._listeners;return i[t]!==void 0&&i[t].indexOf(e)!==-1}removeEventListener(t,e){if(this._listeners===void 0)return;let i=this._listeners[t];if(i!==void 0){let n=i.indexOf(e);n!==-1&&i.splice(n,1)}}dispatchEvent(t){if(this._listeners===void 0)return;let e=this._listeners[t.type];if(e!==void 0){t.target=this;let i=e.slice(0);for(let n=0,r=i.length;n<r;n++)i[n].call(this,t);t.target=null}}},fs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],j6=1234567,N1=Math.PI/180,G_=180/Math.PI;function qa(){let t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(fs[t&255]+fs[t>>8&255]+fs[t>>16&255]+fs[t>>24&255]+"-"+fs[e&255]+fs[e>>8&255]+"-"+fs[e>>16&15|64]+fs[e>>24&255]+"-"+fs[i&63|128]+fs[i>>8&255]+"-"+fs[i>>16&255]+fs[i>>24&255]+fs[n&255]+fs[n>>8&255]+fs[n>>16&255]+fs[n>>24&255]).toLowerCase()}function _r(t,e,i){return Math.max(e,Math.min(i,t))}function ak(t,e){return(t%e+e)%e}function AAe(t,e,i,n,r){return n+(t-e)*(r-n)/(i-e)}function MAe(t,e,i){return t!==e?(i-t)/(e-t):0}function U1(t,e,i){return(1-i)*t+i*e}function EAe(t,e,i,n){return U1(t,e,1-Math.exp(-i*n))}function TAe(t,e=1){return e-Math.abs(ak(t,e*2)-e)}function CAe(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e),t*t*(3-2*t))}function PAe(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e),t*t*t*(t*(t*6-15)+10))}function DAe(t,e){return t+Math.floor(Math.random()*(e-t+1))}function RAe(t,e){return t+Math.random()*(e-t)}function IAe(t){return t*(.5-Math.random())}function LAe(t){t!==void 0&&(j6=t);let e=j6+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function BAe(t){return t*N1}function OAe(t){return t*G_}function kB(t){return(t&t-1)===0&&t!==0}function _ee(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function $E(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function FAe(t,e,i,n,r){let s=Math.cos,o=Math.sin,a=s(i/2),l=o(i/2),c=s((e+n)/2),h=o((e+n)/2),u=s((e-n)/2),d=o((e-n)/2),f=s((n-e)/2),p=o((n-e)/2);switch(r){case"XYX":t.set(a*h,l*u,l*d,a*c);break;case"YZY":t.set(l*d,a*h,l*u,a*c);break;case"ZXZ":t.set(l*u,l*d,a*h,a*c);break;case"XZX":t.set(a*h,l*p,l*f,a*c);break;case"YXY":t.set(l*f,a*h,l*p,a*c);break;case"ZYZ":t.set(l*p,l*f,a*h,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Ku(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function Ki(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}var hi=Object.freeze({__proto__:null,DEG2RAD:N1,RAD2DEG:G_,ceilPowerOfTwo:_ee,clamp:_r,damp:EAe,degToRad:BAe,denormalize:Ku,euclideanModulo:ak,floorPowerOfTwo:$E,generateUUID:qa,inverseLerp:MAe,isPowerOfTwo:kB,lerp:U1,mapLinear:AAe,normalize:Ki,pingpong:TAe,radToDeg:OAe,randFloat:RAe,randFloatSpread:IAe,randInt:DAe,seededRandom:LAe,setQuaternionFromProperEuler:FAe,smootherstep:PAe,smoothstep:CAe}),he=class{constructor(t=0,e=0){he.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){let e=this.x,i=this.y,n=t.elements;return this.x=n[0]*e+n[3]*i+n[6],this.y=n[1]*e+n[4]*i+n[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){let e=this.x-t.x,i=this.y-t.y;return e*e+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){let i=Math.cos(e),n=Math.sin(e),r=this.x-t.x,s=this.y-t.y;return this.x=r*i-s*n+t.x,this.y=r*n+s*i+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Zr=class{constructor(){Zr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(t,e,i,n,r,s,o,a,l){let c=this.elements;return c[0]=t,c[1]=n,c[2]=o,c[3]=e,c[4]=r,c[5]=a,c[6]=i,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){let e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this}extractBasis(t,e,i){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(t){let e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){let i=t.elements,n=e.elements,r=this.elements,s=i[0],o=i[3],a=i[6],l=i[1],c=i[4],h=i[7],u=i[2],d=i[5],f=i[8],p=n[0],m=n[3],v=n[6],g=n[1],y=n[4],x=n[7],b=n[2],S=n[5],A=n[8];return r[0]=s*p+o*g+a*b,r[3]=s*m+o*y+a*S,r[6]=s*v+o*x+a*A,r[1]=l*p+c*g+h*b,r[4]=l*m+c*y+h*S,r[7]=l*v+c*x+h*A,r[2]=u*p+d*g+f*b,r[5]=u*m+d*y+f*S,r[8]=u*v+d*x+f*A,this}multiplyScalar(t){let e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){let t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8];return e*s*c-e*o*l-i*r*c+i*o*a+n*r*l-n*s*a}invert(){let t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],h=c*s-o*l,u=o*a-c*r,d=l*r-s*a,f=e*h+i*u+n*d;if(f===0)return this.set(0,0,0,0,0,0,0,0,0);let p=1/f;return t[0]=h*p,t[1]=(n*l-c*i)*p,t[2]=(o*i-n*s)*p,t[3]=u*p,t[4]=(c*e-n*a)*p,t[5]=(n*r-o*e)*p,t[6]=d*p,t[7]=(i*a-l*e)*p,t[8]=(s*e-i*r)*p,this}transpose(){let t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){let e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,i,n,r,s,o){let a=Math.cos(r),l=Math.sin(r);return this.set(i*a,i*l,-i*(a*s+l*o)+s+t,-n*l,n*a,-n*(-l*s+a*o)+o+e,0,0,1),this}scale(t,e){return this.premultiply(TR.makeScale(t,e)),this}rotate(t){return this.premultiply(TR.makeRotation(-t)),this}translate(t,e){return this.premultiply(TR.makeTranslation(t,e)),this}makeTranslation(t,e){return this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){let e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,i,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){let e=this.elements,i=t.elements;for(let n=0;n<9;n++)if(e[n]!==i[n])return!1;return!0}fromArray(t,e=0){for(let i=0;i<9;i++)this.elements[i]=t[i+e];return this}toArray(t=[],e=0){let i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t}clone(){return new this.constructor().fromArray(this.elements)}},TR=new Zr;function wee(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}var NAe={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function KS(t,e){return new NAe[t](e)}function eT(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function Vp(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function GM(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}var CR={[_c]:{[ZE]:Vp},[ZE]:{[_c]:GM}},Rs={legacyMode:!0,get workingColorSpace(){return ZE},set workingColorSpace(t){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(t,e,i){if(this.legacyMode||e===i||!e||!i)return t;if(CR[e]&&CR[e][i]!==void 0){let n=CR[e][i];return t.r=n(t.r),t.g=n(t.g),t.b=n(t.b),t}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)}},bee={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},mr={r:0,g:0,b:0},dl={h:0,s:0,l:0},JS={h:0,s:0,l:0};function PR(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+(e-t)*6*i:i<1/2?e:i<2/3?t+(e-t)*6*(2/3-i):t}function ZS(t,e){return e.r=t.r,e.g=t.g,e.b=t.b,e}var It=class{constructor(t,e,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,e===void 0&&i===void 0?this.set(t):this.setRGB(t,e,i)}set(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=_c){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,Rs.toWorkingColorSpace(this,e),this}setRGB(t,e,i,n=Rs.workingColorSpace){return this.r=t,this.g=e,this.b=i,Rs.toWorkingColorSpace(this,n),this}setHSL(t,e,i,n=Rs.workingColorSpace){if(t=ak(t,1),e=_r(e,0,1),i=_r(i,0,1),e===0)this.r=this.g=this.b=i;else{let r=i<=.5?i*(1+e):i+e-i*e,s=2*i-r;this.r=PR(s,r,t+1/3),this.g=PR(s,r,t),this.b=PR(s,r,t-1/3)}return Rs.toWorkingColorSpace(this,n),this}setStyle(t,e=_c){function i(r){r!==void 0&&parseFloat(r)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let r,s=n[1],o=n[2];switch(s){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,Rs.toWorkingColorSpace(this,e),i(r[4]),this;if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,Rs.toWorkingColorSpace(this,e),i(r[4]),this;break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){let a=parseFloat(r[1])/360,l=parseFloat(r[2])/100,c=parseFloat(r[3])/100;return i(r[4]),this.setHSL(a,l,c,e)}break}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){let r=n[1],s=r.length;if(s===3)return this.r=parseInt(r.charAt(0)+r.charAt(0),16)/255,this.g=parseInt(r.charAt(1)+r.charAt(1),16)/255,this.b=parseInt(r.charAt(2)+r.charAt(2),16)/255,Rs.toWorkingColorSpace(this,e),this;if(s===6)return this.r=parseInt(r.charAt(0)+r.charAt(1),16)/255,this.g=parseInt(r.charAt(2)+r.charAt(3),16)/255,this.b=parseInt(r.charAt(4)+r.charAt(5),16)/255,Rs.toWorkingColorSpace(this,e),this}return t&&t.length>0?this.setColorName(t,e):this}setColorName(t,e=_c){let i=bee[t.toLowerCase()];return i!==void 0?this.setHex(i,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Vp(t.r),this.g=Vp(t.g),this.b=Vp(t.b),this}copyLinearToSRGB(t){return this.r=GM(t.r),this.g=GM(t.g),this.b=GM(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=_c){return Rs.fromWorkingColorSpace(ZS(this,mr),t),_r(mr.r*255,0,255)<<16^_r(mr.g*255,0,255)<<8^_r(mr.b*255,0,255)<<0}getHexString(t=_c){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=Rs.workingColorSpace){Rs.fromWorkingColorSpace(ZS(this,mr),e);let i=mr.r,n=mr.g,r=mr.b,s=Math.max(i,n,r),o=Math.min(i,n,r),a,l,c=(o+s)/2;if(o===s)a=0,l=0;else{let h=s-o;switch(l=c<=.5?h/(s+o):h/(2-s-o),s){case i:a=(n-r)/h+(n<r?6:0);break;case n:a=(r-i)/h+2;break;case r:a=(i-n)/h+4;break}a/=6}return t.h=a,t.s=l,t.l=c,t}getRGB(t,e=Rs.workingColorSpace){return Rs.fromWorkingColorSpace(ZS(this,mr),e),t.r=mr.r,t.g=mr.g,t.b=mr.b,t}getStyle(t=_c){return Rs.fromWorkingColorSpace(ZS(this,mr),t),t!==_c?`color(${t} ${mr.r} ${mr.g} ${mr.b})`:`rgb(${mr.r*255|0},${mr.g*255|0},${mr.b*255|0})`}offsetHSL(t,e,i){return this.getHSL(dl),dl.h+=t,dl.s+=e,dl.l+=i,this.setHSL(dl.h,dl.s,dl.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,i){return this.r=t.r+(e.r-t.r)*i,this.g=t.g+(e.g-t.g)*i,this.b=t.b+(e.b-t.b)*i,this}lerpHSL(t,e){this.getHSL(dl),t.getHSL(JS);let i=U1(dl.h,JS.h,e),n=U1(dl.s,JS.s,e),r=U1(dl.l,JS.l,e);return this.setHSL(i,n,r),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};It.NAMES=bee;var mg,See=class{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{mg===void 0&&(mg=eT("canvas")),mg.width=t.width,mg.height=t.height;let i=mg.getContext("2d");t instanceof ImageData?i.putImageData(t,0,0):i.drawImage(t,0,0,t.width,t.height),e=mg}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){let e=eT("canvas");e.width=t.width,e.height=t.height;let i=e.getContext("2d");i.drawImage(t,0,0,t.width,t.height);let n=i.getImageData(0,0,t.width,t.height),r=n.data;for(let s=0;s<r.length;s++)r[s]=Vp(r[s]/255)*255;return i.putImageData(n,0,0),e}else if(t.data){let e=t.data.slice(0);for(let i=0;i<e.length;i++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[i]=Math.floor(Vp(e[i]/255)*255):e[i]=Vp(e[i]);return{data:e,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}},Aee=class{constructor(t=null){this.isSource=!0,this.uuid=qa(),this.data=t,this.version=0}set needsUpdate(t){t===!0&&this.version++}toJSON(t){let e=t===void 0||typeof t=="string";if(!e&&t.images[this.uuid]!==void 0)return t.images[this.uuid];let i={uuid:this.uuid,url:""},n=this.data;if(n!==null){let r;if(Array.isArray(n)){r=[];for(let s=0,o=n.length;s<o;s++)n[s].isDataTexture?r.push(DR(n[s].image)):r.push(DR(n[s]))}else r=DR(n);i.url=r}return e||(t.images[this.uuid]=i),i}};function DR(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?See.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var UAe=0,br=class extends is{constructor(t=br.DEFAULT_IMAGE,e=br.DEFAULT_MAPPING,i=Qn,n=Qn,r=ri,s=F0,o=za,a=As,l=br.DEFAULT_ANISOTROPY,c=Yc){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:UAe++}),this.uuid=qa(),this.name="",this.source=new Aee(t),this.mipmaps=[],this.mapping=e,this.wrapS=i,this.wrapT=n,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new he(0,0),this.repeat=new he(1,1),this.center=new he(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Zr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){let e=t===void 0||typeof t=="string";if(!e&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];let i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),e||(t.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==pee)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Qu:t.x=t.x-Math.floor(t.x);break;case Qn:t.x=t.x<0?0:1;break;case FB:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case Qu:t.y=t.y-Math.floor(t.y);break;case Qn:t.y=t.y<0?0:1;break;case FB:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}};br.DEFAULT_IMAGE=null;br.DEFAULT_MAPPING=pee;br.DEFAULT_ANISOTROPY=1;var Kt=class{constructor(t=0,e=0,i=0,n=1){Kt.prototype.isVector4=!0,this.x=t,this.y=e,this.z=i,this.w=n}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){let e=this.x,i=this.y,n=this.z,r=this.w,s=t.elements;return this.x=s[0]*e+s[4]*i+s[8]*n+s[12]*r,this.y=s[1]*e+s[5]*i+s[9]*n+s[13]*r,this.z=s[2]*e+s[6]*i+s[10]*n+s[14]*r,this.w=s[3]*e+s[7]*i+s[11]*n+s[15]*r,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);let e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,i,n,r,s=t.elements,o=s[0],a=s[4],l=s[8],c=s[1],h=s[5],u=s[9],d=s[2],f=s[6],p=s[10];if(Math.abs(a-c)<.01&&Math.abs(l-d)<.01&&Math.abs(u-f)<.01){if(Math.abs(a+c)<.1&&Math.abs(l+d)<.1&&Math.abs(u+f)<.1&&Math.abs(o+h+p-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;let v=(o+1)/2,g=(h+1)/2,y=(p+1)/2,x=(a+c)/4,b=(l+d)/4,S=(u+f)/4;return v>g&&v>y?v<.01?(i=0,n=.707106781,r=.707106781):(i=Math.sqrt(v),n=x/i,r=b/i):g>y?g<.01?(i=.707106781,n=0,r=.707106781):(n=Math.sqrt(g),i=x/n,r=S/n):y<.01?(i=.707106781,n=.707106781,r=0):(r=Math.sqrt(y),i=b/r,n=S/r),this.set(i,n,r,e),this}let m=Math.sqrt((f-u)*(f-u)+(l-d)*(l-d)+(c-a)*(c-a));return Math.abs(m)<.001&&(m=1),this.x=(f-u)/m,this.y=(l-d)/m,this.z=(c-a)/m,this.w=Math.acos((o+h+p-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this.w=t.w+(e.w-t.w)*i,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},Hi=class extends is{constructor(t=1,e=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=t,this.height=e,this.depth=1,this.scissor=new Kt(0,0,t,e),this.scissorTest=!1,this.viewport=new Kt(0,0,t,e);let n={width:t,height:e,depth:1};this.texture=new br(n,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.internalFormat=i.internalFormat!==void 0?i.internalFormat:null,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:ri,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!1,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null,this.samples=i.samples!==void 0?i.samples:0}setSize(t,e,i=1){(this.width!==t||this.height!==e||this.depth!==i)&&(this.width=t,this.height=e,this.depth=i,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return new this.constructor().copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.isRenderTargetTexture=!0;let e=Object.assign({},t.texture.image);return this.texture.source=new Aee(e),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,t.depthTexture!==null&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},Mee=class extends br{constructor(t=null,e=1,i=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:e,height:i,depth:n},this.magFilter=Zi,this.minFilter=Zi,this.wrapR=Qn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},kAe=class extends br{constructor(t=null,e=1,i=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:e,height:i,depth:n},this.magFilter=Zi,this.minFilter=Zi,this.wrapR=Qn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},zAe=class extends Hi{constructor(t=1,e=1,i=1,n={}){super(t,e,n),this.isWebGLMultipleRenderTargets=!0;let r=this.texture;this.texture=[];for(let s=0;s<i;s++)this.texture[s]=r.clone(),this.texture[s].isRenderTargetTexture=!0}setSize(t,e,i=1){if(this.width!==t||this.height!==e||this.depth!==i){this.width=t,this.height=e,this.depth=i;for(let n=0,r=this.texture.length;n<r;n++)this.texture[n].image.width=t,this.texture[n].image.height=e,this.texture[n].image.depth=i;this.dispose()}return this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e),this}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,t.depthTexture!==null&&(this.depthTexture=t.depthTexture.clone()),this.texture.length=0;for(let e=0,i=t.texture.length;e<i;e++)this.texture[e]=t.texture[e].clone(),this.texture[e].isRenderTargetTexture=!0;return this}},Zt=class{constructor(t=0,e=0,i=0,n=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=i,this._w=n}static slerpFlat(t,e,i,n,r,s,o){let a=i[n+0],l=i[n+1],c=i[n+2],h=i[n+3],u=r[s+0],d=r[s+1],f=r[s+2],p=r[s+3];if(o===0){t[e+0]=a,t[e+1]=l,t[e+2]=c,t[e+3]=h;return}if(o===1){t[e+0]=u,t[e+1]=d,t[e+2]=f,t[e+3]=p;return}if(h!==p||a!==u||l!==d||c!==f){let m=1-o,v=a*u+l*d+c*f+h*p,g=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){let b=Math.sqrt(y),S=Math.atan2(b,v*g);m=Math.sin(m*S)/b,o=Math.sin(o*S)/b}let x=o*g;if(a=a*m+u*x,l=l*m+d*x,c=c*m+f*x,h=h*m+p*x,m===1-o){let b=1/Math.sqrt(a*a+l*l+c*c+h*h);a*=b,l*=b,c*=b,h*=b}}t[e]=a,t[e+1]=l,t[e+2]=c,t[e+3]=h}static multiplyQuaternionsFlat(t,e,i,n,r,s){let o=i[n],a=i[n+1],l=i[n+2],c=i[n+3],h=r[s],u=r[s+1],d=r[s+2],f=r[s+3];return t[e]=o*f+c*h+a*d-l*u,t[e+1]=a*f+c*u+l*h-o*d,t[e+2]=l*f+c*d+o*u-a*h,t[e+3]=c*f-o*h-a*u-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){let i=t._x,n=t._y,r=t._z,s=t._order,o=Math.cos,a=Math.sin,l=o(i/2),c=o(n/2),h=o(r/2),u=a(i/2),d=a(n/2),f=a(r/2);switch(s){case"XYZ":this._x=u*c*h+l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h-u*d*f;break;case"YXZ":this._x=u*c*h+l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h+u*d*f;break;case"ZXY":this._x=u*c*h-l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h-u*d*f;break;case"ZYX":this._x=u*c*h-l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h+u*d*f;break;case"YZX":this._x=u*c*h+l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h-u*d*f;break;case"XZY":this._x=u*c*h-l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h+u*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return e!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,e){let i=e/2,n=Math.sin(i);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(t){let e=t.elements,i=e[0],n=e[4],r=e[8],s=e[1],o=e[5],a=e[9],l=e[2],c=e[6],h=e[10],u=i+o+h;if(u>0){let d=.5/Math.sqrt(u+1);this._w=.25/d,this._x=(c-a)*d,this._y=(r-l)*d,this._z=(s-n)*d}else if(i>o&&i>h){let d=2*Math.sqrt(1+i-o-h);this._w=(c-a)/d,this._x=.25*d,this._y=(n+s)/d,this._z=(r+l)/d}else if(o>h){let d=2*Math.sqrt(1+o-i-h);this._w=(r-l)/d,this._x=(n+s)/d,this._y=.25*d,this._z=(a+c)/d}else{let d=2*Math.sqrt(1+h-i-o);this._w=(s-n)/d,this._x=(r+l)/d,this._y=(a+c)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let i=t.dot(e)+1;return i<Number.EPSILON?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=i):(this._x=0,this._y=-t.z,this._z=t.y,this._w=i)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=i),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(_r(this.dot(t),-1,1)))}rotateTowards(t,e){let i=this.angleTo(t);if(i===0)return this;let n=Math.min(1,e/i);return this.slerp(t,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){let i=t._x,n=t._y,r=t._z,s=t._w,o=e._x,a=e._y,l=e._z,c=e._w;return this._x=i*c+s*o+n*l-r*a,this._y=n*c+s*a+r*o-i*l,this._z=r*c+s*l+i*a-n*o,this._w=s*c-i*o-n*a-r*l,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);let i=this._x,n=this._y,r=this._z,s=this._w,o=s*t._w+i*t._x+n*t._y+r*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=s,this._x=i,this._y=n,this._z=r,this;let a=1-o*o;if(a<=Number.EPSILON){let d=1-e;return this._w=d*s+e*this._w,this._x=d*i+e*this._x,this._y=d*n+e*this._y,this._z=d*r+e*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(a),c=Math.atan2(l,o),h=Math.sin((1-e)*c)/l,u=Math.sin(e*c)/l;return this._w=s*h+this._w*u,this._x=i*h+this._x*u,this._y=n*h+this._y*u,this._z=r*h+this._z*u,this._onChangeCallback(),this}slerpQuaternions(t,e,i){return this.copy(t).slerp(e,i)}random(){let t=Math.random(),e=Math.sqrt(1-t),i=Math.sqrt(t),n=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(e*Math.cos(n),i*Math.sin(r),i*Math.cos(r),e*Math.sin(n))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},L=class{constructor(t=0,e=0,i=0){L.prototype.isVector3=!0,this.x=t,this.y=e,this.z=i}set(t,e,i){return i===void 0&&(i=this.z),this.x=t,this.y=e,this.z=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(W6.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(W6.setFromAxisAngle(t,e))}applyMatrix3(t){let e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[3]*i+r[6]*n,this.y=r[1]*e+r[4]*i+r[7]*n,this.z=r[2]*e+r[5]*i+r[8]*n,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){let e=this.x,i=this.y,n=this.z,r=t.elements,s=1/(r[3]*e+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*e+r[4]*i+r[8]*n+r[12])*s,this.y=(r[1]*e+r[5]*i+r[9]*n+r[13])*s,this.z=(r[2]*e+r[6]*i+r[10]*n+r[14])*s,this}applyQuaternion(t){let e=this.x,i=this.y,n=this.z,r=t.x,s=t.y,o=t.z,a=t.w,l=a*e+s*n-o*i,c=a*i+o*e-r*n,h=a*n+r*i-s*e,u=-r*e-s*i-o*n;return this.x=l*a+u*-r+c*-o-h*-s,this.y=c*a+u*-s+h*-r-l*-o,this.z=h*a+u*-o+l*-s-c*-r,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){let e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*n,this.y=r[1]*e+r[5]*i+r[9]*n,this.z=r[2]*e+r[6]*i+r[10]*n,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){let i=t.x,n=t.y,r=t.z,s=e.x,o=e.y,a=e.z;return this.x=n*a-r*o,this.y=r*s-i*a,this.z=i*o-n*s,this}projectOnVector(t){let e=t.lengthSq();if(e===0)return this.set(0,0,0);let i=t.dot(this)/e;return this.copy(t).multiplyScalar(i)}projectOnPlane(t){return RR.copy(this).projectOnVector(t),this.sub(RR)}reflect(t){return this.sub(RR.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){let e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;let i=this.dot(t)/e;return Math.acos(_r(i,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){let e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,i){let n=Math.sin(e)*t;return this.x=n*Math.sin(i),this.y=Math.cos(e)*t,this.z=n*Math.cos(i),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,i){return this.x=t*Math.sin(e),this.y=i,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){let e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){let e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=n,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,e*4)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,e*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let t=(Math.random()-.5)*2,e=Math.random()*Math.PI*2,i=Math.sqrt(1-t**2);return this.x=i*Math.cos(e),this.y=i*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},RR=new L,W6=new Zt,Zn=class{constructor(t=new L(1/0,1/0,1/0),e=new L(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,i=1/0,n=1/0,r=-1/0,s=-1/0,o=-1/0;for(let a=0,l=t.length;a<l;a+=3){let c=t[a],h=t[a+1],u=t[a+2];c<e&&(e=c),h<i&&(i=h),u<n&&(n=u),c>r&&(r=c),h>s&&(s=h),u>o&&(o=u)}return this.min.set(e,i,n),this.max.set(r,s,o),this}setFromBufferAttribute(t){let e=1/0,i=1/0,n=1/0,r=-1/0,s=-1/0,o=-1/0;for(let a=0,l=t.count;a<l;a++){let c=t.getX(a),h=t.getY(a),u=t.getZ(a);c<e&&(e=c),h<i&&(i=h),u<n&&(n=u),c>r&&(r=c),h>s&&(s=h),u>o&&(o=u)}return this.min.set(e,i,n),this.max.set(r,s,o),this}setFromPoints(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){let i=kf.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);let i=t.geometry;if(i!==void 0)if(e&&i.attributes!=null&&i.attributes.position!==void 0){let r=i.attributes.position;for(let s=0,o=r.count;s<o;s++)kf.fromBufferAttribute(r,s).applyMatrix4(t.matrixWorld),this.expandByPoint(kf)}else i.boundingBox===null&&i.computeBoundingBox(),IR.copy(i.boundingBox),IR.applyMatrix4(t.matrixWorld),this.union(IR);let n=t.children;for(let r=0,s=n.length;r<s;r++)this.expandByObject(n[r],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,kf),kf.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,i;return t.normal.x>0?(e=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=-t.constant&&i>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(vx),$S.subVectors(this.max,vx),gg.subVectors(t.a,vx),vg.subVectors(t.b,vx),yg.subVectors(t.c,vx),Fh.subVectors(vg,gg),Nh.subVectors(yg,vg),zf.subVectors(gg,yg);let e=[0,-Fh.z,Fh.y,0,-Nh.z,Nh.y,0,-zf.z,zf.y,Fh.z,0,-Fh.x,Nh.z,0,-Nh.x,zf.z,0,-zf.x,-Fh.y,Fh.x,0,-Nh.y,Nh.x,0,-zf.y,zf.x,0];return!LR(e,gg,vg,yg,$S)||(e=[1,0,0,0,1,0,0,0,1],!LR(e,gg,vg,yg,$S))?!1:(eA.crossVectors(Fh,Nh),e=[eA.x,eA.y,eA.z],LR(e,gg,vg,yg,$S))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return kf.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=this.getSize(kf).length()*.5,t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(vu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),vu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),vu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),vu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),vu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),vu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),vu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),vu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(vu),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},vu=[new L,new L,new L,new L,new L,new L,new L,new L],kf=new L,IR=new Zn,gg=new L,vg=new L,yg=new L,Fh=new L,Nh=new L,zf=new L,vx=new L,$S=new L,eA=new L,Gf=new L;function LR(t,e,i,n,r){for(let s=0,o=t.length-3;s<=o;s+=3){Gf.fromArray(t,s);let a=r.x*Math.abs(Gf.x)+r.y*Math.abs(Gf.y)+r.z*Math.abs(Gf.z),l=e.dot(Gf),c=i.dot(Gf),h=n.dot(Gf);if(Math.max(-Math.max(l,c,h),Math.min(l,c,h))>a)return!1}return!0}var GAe=new Zn,yx=new L,BR=new L,sa=class{constructor(t=new L,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){let i=this.center;e!==void 0?i.copy(e):GAe.setFromPoints(t).getCenter(i);let n=0;for(let r=0,s=t.length;r<s;r++)n=Math.max(n,i.distanceToSquared(t[r]));return this.radius=Math.sqrt(n),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){let e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){let i=this.center.distanceToSquared(t);return e.copy(t),i>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;yx.subVectors(t,this.center);let e=yx.lengthSq();if(e>this.radius*this.radius){let i=Math.sqrt(e),n=(i-this.radius)*.5;this.center.addScaledVector(yx,n/i),this.radius+=n}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(BR.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(yx.copy(t.center).add(BR)),this.expandByPoint(yx.copy(t.center).sub(BR))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}},yu=new L,OR=new L,tA=new L,Uh=new L,FR=new L,iA=new L,NR=new L,ay=class{constructor(t=new L,e=new L(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,yu)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);let i=e.dot(this.direction);return i<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){let e=yu.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(yu.copy(this.direction).multiplyScalar(e).add(this.origin),yu.distanceToSquared(t))}distanceSqToSegment(t,e,i,n){OR.copy(t).add(e).multiplyScalar(.5),tA.copy(e).sub(t).normalize(),Uh.copy(this.origin).sub(OR);let r=t.distanceTo(e)*.5,s=-this.direction.dot(tA),o=Uh.dot(this.direction),a=-Uh.dot(tA),l=Uh.lengthSq(),c=Math.abs(1-s*s),h,u,d,f;if(c>0)if(h=s*a-o,u=s*o-a,f=r*c,h>=0)if(u>=-f)if(u<=f){let p=1/c;h*=p,u*=p,d=h*(h+s*u+2*o)+u*(s*h+u+2*a)+l}else u=r,h=Math.max(0,-(s*u+o)),d=-h*h+u*(u+2*a)+l;else u=-r,h=Math.max(0,-(s*u+o)),d=-h*h+u*(u+2*a)+l;else u<=-f?(h=Math.max(0,-(-s*r+o)),u=h>0?-r:Math.min(Math.max(-r,-a),r),d=-h*h+u*(u+2*a)+l):u<=f?(h=0,u=Math.min(Math.max(-r,-a),r),d=u*(u+2*a)+l):(h=Math.max(0,-(s*r+o)),u=h>0?r:Math.min(Math.max(-r,-a),r),d=-h*h+u*(u+2*a)+l);else u=s>0?-r:r,h=Math.max(0,-(s*u+o)),d=-h*h+u*(u+2*a)+l;return i&&i.copy(this.direction).multiplyScalar(h).add(this.origin),n&&n.copy(tA).multiplyScalar(u).add(OR),d}intersectSphere(t,e){yu.subVectors(t.center,this.origin);let i=yu.dot(this.direction),n=yu.dot(yu)-i*i,r=t.radius*t.radius;if(n>r)return null;let s=Math.sqrt(r-n),o=i-s,a=i+s;return o<0&&a<0?null:o<0?this.at(a,e):this.at(o,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){let e=t.normal.dot(this.direction);if(e===0)return t.distanceToPoint(this.origin)===0?0:null;let i=-(this.origin.dot(t.normal)+t.constant)/e;return i>=0?i:null}intersectPlane(t,e){let i=this.distanceToPlane(t);return i===null?null:this.at(i,e)}intersectsPlane(t){let e=t.distanceToPoint(this.origin);return e===0||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let i,n,r,s,o,a,l=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,u=this.origin;return l>=0?(i=(t.min.x-u.x)*l,n=(t.max.x-u.x)*l):(i=(t.max.x-u.x)*l,n=(t.min.x-u.x)*l),c>=0?(r=(t.min.y-u.y)*c,s=(t.max.y-u.y)*c):(r=(t.max.y-u.y)*c,s=(t.min.y-u.y)*c),i>s||r>n||((r>i||isNaN(i))&&(i=r),(s<n||isNaN(n))&&(n=s),h>=0?(o=(t.min.z-u.z)*h,a=(t.max.z-u.z)*h):(o=(t.max.z-u.z)*h,a=(t.min.z-u.z)*h),i>a||o>n)||((o>i||i!==i)&&(i=o),(a<n||n!==n)&&(n=a),n<0)?null:this.at(i>=0?i:n,e)}intersectsBox(t){return this.intersectBox(t,yu)!==null}intersectTriangle(t,e,i,n,r){FR.subVectors(e,t),iA.subVectors(i,t),NR.crossVectors(FR,iA);let s=this.direction.dot(NR),o;if(s>0){if(n)return null;o=1}else if(s<0)o=-1,s=-s;else return null;Uh.subVectors(this.origin,t);let a=o*this.direction.dot(iA.crossVectors(Uh,iA));if(a<0)return null;let l=o*this.direction.dot(FR.cross(Uh));if(l<0||a+l>s)return null;let c=-o*Uh.dot(NR);return c<0?null:this.at(c/s,r)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},$e=class{constructor(){$e.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(t,e,i,n,r,s,o,a,l,c,h,u,d,f,p,m){let v=this.elements;return v[0]=t,v[4]=e,v[8]=i,v[12]=n,v[1]=r,v[5]=s,v[9]=o,v[13]=a,v[2]=l,v[6]=c,v[10]=h,v[14]=u,v[3]=d,v[7]=f,v[11]=p,v[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new $e().fromArray(this.elements)}copy(t){let e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this}copyPosition(t){let e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this}setFromMatrix3(t){let e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this}extractRotation(t){let e=this.elements,i=t.elements,n=1/xg.setFromMatrixColumn(t,0).length(),r=1/xg.setFromMatrixColumn(t,1).length(),s=1/xg.setFromMatrixColumn(t,2).length();return e[0]=i[0]*n,e[1]=i[1]*n,e[2]=i[2]*n,e[3]=0,e[4]=i[4]*r,e[5]=i[5]*r,e[6]=i[6]*r,e[7]=0,e[8]=i[8]*s,e[9]=i[9]*s,e[10]=i[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){let e=this.elements,i=t.x,n=t.y,r=t.z,s=Math.cos(i),o=Math.sin(i),a=Math.cos(n),l=Math.sin(n),c=Math.cos(r),h=Math.sin(r);if(t.order==="XYZ"){let u=s*c,d=s*h,f=o*c,p=o*h;e[0]=a*c,e[4]=-a*h,e[8]=l,e[1]=d+f*l,e[5]=u-p*l,e[9]=-o*a,e[2]=p-u*l,e[6]=f+d*l,e[10]=s*a}else if(t.order==="YXZ"){let u=a*c,d=a*h,f=l*c,p=l*h;e[0]=u+p*o,e[4]=f*o-d,e[8]=s*l,e[1]=s*h,e[5]=s*c,e[9]=-o,e[2]=d*o-f,e[6]=p+u*o,e[10]=s*a}else if(t.order==="ZXY"){let u=a*c,d=a*h,f=l*c,p=l*h;e[0]=u-p*o,e[4]=-s*h,e[8]=f+d*o,e[1]=d+f*o,e[5]=s*c,e[9]=p-u*o,e[2]=-s*l,e[6]=o,e[10]=s*a}else if(t.order==="ZYX"){let u=s*c,d=s*h,f=o*c,p=o*h;e[0]=a*c,e[4]=f*l-d,e[8]=u*l+p,e[1]=a*h,e[5]=p*l+u,e[9]=d*l-f,e[2]=-l,e[6]=o*a,e[10]=s*a}else if(t.order==="YZX"){let u=s*a,d=s*l,f=o*a,p=o*l;e[0]=a*c,e[4]=p-u*h,e[8]=f*h+d,e[1]=h,e[5]=s*c,e[9]=-o*c,e[2]=-l*c,e[6]=d*h+f,e[10]=u-p*h}else if(t.order==="XZY"){let u=s*a,d=s*l,f=o*a,p=o*l;e[0]=a*c,e[4]=-h,e[8]=l*c,e[1]=u*h+p,e[5]=s*c,e[9]=d*h-f,e[2]=f*h-d,e[6]=o*c,e[10]=p*h+u}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(HAe,t,VAe)}lookAt(t,e,i){let n=this.elements;return Bo.subVectors(t,e),Bo.lengthSq()===0&&(Bo.z=1),Bo.normalize(),kh.crossVectors(i,Bo),kh.lengthSq()===0&&(Math.abs(i.z)===1?Bo.x+=1e-4:Bo.z+=1e-4,Bo.normalize(),kh.crossVectors(i,Bo)),kh.normalize(),nA.crossVectors(Bo,kh),n[0]=kh.x,n[4]=nA.x,n[8]=Bo.x,n[1]=kh.y,n[5]=nA.y,n[9]=Bo.y,n[2]=kh.z,n[6]=nA.z,n[10]=Bo.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){let i=t.elements,n=e.elements,r=this.elements,s=i[0],o=i[4],a=i[8],l=i[12],c=i[1],h=i[5],u=i[9],d=i[13],f=i[2],p=i[6],m=i[10],v=i[14],g=i[3],y=i[7],x=i[11],b=i[15],S=n[0],A=n[4],E=n[8],M=n[12],T=n[1],P=n[5],R=n[9],U=n[13],F=n[2],N=n[6],W=n[10],Q=n[14],X=n[3],B=n[7],j=n[11],z=n[15];return r[0]=s*S+o*T+a*F+l*X,r[4]=s*A+o*P+a*N+l*B,r[8]=s*E+o*R+a*W+l*j,r[12]=s*M+o*U+a*Q+l*z,r[1]=c*S+h*T+u*F+d*X,r[5]=c*A+h*P+u*N+d*B,r[9]=c*E+h*R+u*W+d*j,r[13]=c*M+h*U+u*Q+d*z,r[2]=f*S+p*T+m*F+v*X,r[6]=f*A+p*P+m*N+v*B,r[10]=f*E+p*R+m*W+v*j,r[14]=f*M+p*U+m*Q+v*z,r[3]=g*S+y*T+x*F+b*X,r[7]=g*A+y*P+x*N+b*B,r[11]=g*E+y*R+x*W+b*j,r[15]=g*M+y*U+x*Q+b*z,this}multiplyScalar(t){let e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){let t=this.elements,e=t[0],i=t[4],n=t[8],r=t[12],s=t[1],o=t[5],a=t[9],l=t[13],c=t[2],h=t[6],u=t[10],d=t[14],f=t[3],p=t[7],m=t[11],v=t[15];return f*(+r*a*h-n*l*h-r*o*u+i*l*u+n*o*d-i*a*d)+p*(+e*a*d-e*l*u+r*s*u-n*s*d+n*l*c-r*a*c)+m*(+e*l*h-e*o*d-r*s*h+i*s*d+r*o*c-i*l*c)+v*(-n*o*c-e*a*h+e*o*u+n*s*h-i*s*u+i*a*c)}transpose(){let t=this.elements,e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,i){let n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=e,n[14]=i),this}invert(){let t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],h=t[9],u=t[10],d=t[11],f=t[12],p=t[13],m=t[14],v=t[15],g=h*m*l-p*u*l+p*a*d-o*m*d-h*a*v+o*u*v,y=f*u*l-c*m*l-f*a*d+s*m*d+c*a*v-s*u*v,x=c*p*l-f*h*l+f*o*d-s*p*d-c*o*v+s*h*v,b=f*h*a-c*p*a-f*o*u+s*p*u+c*o*m-s*h*m,S=e*g+i*y+n*x+r*b;if(S===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let A=1/S;return t[0]=g*A,t[1]=(p*u*r-h*m*r-p*n*d+i*m*d+h*n*v-i*u*v)*A,t[2]=(o*m*r-p*a*r+p*n*l-i*m*l-o*n*v+i*a*v)*A,t[3]=(h*a*r-o*u*r-h*n*l+i*u*l+o*n*d-i*a*d)*A,t[4]=y*A,t[5]=(c*m*r-f*u*r+f*n*d-e*m*d-c*n*v+e*u*v)*A,t[6]=(f*a*r-s*m*r-f*n*l+e*m*l+s*n*v-e*a*v)*A,t[7]=(s*u*r-c*a*r+c*n*l-e*u*l-s*n*d+e*a*d)*A,t[8]=x*A,t[9]=(f*h*r-c*p*r-f*i*d+e*p*d+c*i*v-e*h*v)*A,t[10]=(s*p*r-f*o*r+f*i*l-e*p*l-s*i*v+e*o*v)*A,t[11]=(c*o*r-s*h*r-c*i*l+e*h*l+s*i*d-e*o*d)*A,t[12]=b*A,t[13]=(c*p*n-f*h*n+f*i*u-e*p*u-c*i*m+e*h*m)*A,t[14]=(f*o*n-s*p*n-f*i*a+e*p*a+s*i*m-e*o*m)*A,t[15]=(s*h*n-c*o*n+c*i*a-e*h*a-s*i*u+e*o*u)*A,this}scale(t){let e=this.elements,i=t.x,n=t.y,r=t.z;return e[0]*=i,e[4]*=n,e[8]*=r,e[1]*=i,e[5]*=n,e[9]*=r,e[2]*=i,e[6]*=n,e[10]*=r,e[3]*=i,e[7]*=n,e[11]*=r,this}getMaxScaleOnAxis(){let t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,n))}makeTranslation(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this}makeRotationX(t){let e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this}makeRotationY(t){let e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this}makeRotationZ(t){let e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){let i=Math.cos(e),n=Math.sin(e),r=1-i,s=t.x,o=t.y,a=t.z,l=r*s,c=r*o;return this.set(l*s+i,l*o-n*a,l*a+n*o,0,l*o+n*a,c*o+i,c*a-n*s,0,l*a-n*o,c*a+n*s,r*a*a+i,0,0,0,0,1),this}makeScale(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this}makeShear(t,e,i,n,r,s){return this.set(1,i,r,0,t,1,s,0,e,n,1,0,0,0,0,1),this}compose(t,e,i){let n=this.elements,r=e._x,s=e._y,o=e._z,a=e._w,l=r+r,c=s+s,h=o+o,u=r*l,d=r*c,f=r*h,p=s*c,m=s*h,v=o*h,g=a*l,y=a*c,x=a*h,b=i.x,S=i.y,A=i.z;return n[0]=(1-(p+v))*b,n[1]=(d+x)*b,n[2]=(f-y)*b,n[3]=0,n[4]=(d-x)*S,n[5]=(1-(u+v))*S,n[6]=(m+g)*S,n[7]=0,n[8]=(f+y)*A,n[9]=(m-g)*A,n[10]=(1-(u+p))*A,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this}decompose(t,e,i){let n=this.elements,r=xg.set(n[0],n[1],n[2]).length(),s=xg.set(n[4],n[5],n[6]).length(),o=xg.set(n[8],n[9],n[10]).length();this.determinant()<0&&(r=-r),t.x=n[12],t.y=n[13],t.z=n[14],fl.copy(this);let a=1/r,l=1/s,c=1/o;return fl.elements[0]*=a,fl.elements[1]*=a,fl.elements[2]*=a,fl.elements[4]*=l,fl.elements[5]*=l,fl.elements[6]*=l,fl.elements[8]*=c,fl.elements[9]*=c,fl.elements[10]*=c,e.setFromRotationMatrix(fl),i.x=r,i.y=s,i.z=o,this}makePerspective(t,e,i,n,r,s){let o=this.elements,a=2*r/(e-t),l=2*r/(i-n),c=(e+t)/(e-t),h=(i+n)/(i-n),u=-(s+r)/(s-r),d=-2*s*r/(s-r);return o[0]=a,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=l,o[9]=h,o[13]=0,o[2]=0,o[6]=0,o[10]=u,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(t,e,i,n,r,s){let o=this.elements,a=1/(e-t),l=1/(i-n),c=1/(s-r),h=(e+t)*a,u=(i+n)*l,d=(s+r)*c;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-h,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-u,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(t){let e=this.elements,i=t.elements;for(let n=0;n<16;n++)if(e[n]!==i[n])return!1;return!0}fromArray(t,e=0){for(let i=0;i<16;i++)this.elements[i]=t[i+e];return this}toArray(t=[],e=0){let i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}},xg=new L,fl=new $e,HAe=new L(0,0,0),VAe=new L(1,1,1),kh=new L,nA=new L,Bo=new L,X6=new $e,q6=new Zt,Nr=class{constructor(t=0,e=0,i=0,n=Nr.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=i,this._order=n}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,i,n=this._order){return this._x=t,this._y=e,this._z=i,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,i=!0){let n=t.elements,r=n[0],s=n[4],o=n[8],a=n[1],l=n[5],c=n[9],h=n[2],u=n[6],d=n[10];switch(e){case"XYZ":this._y=Math.asin(_r(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-_r(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-h,r),this._z=0);break;case"ZXY":this._x=Math.asin(_r(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(a,r));break;case"ZYX":this._y=Math.asin(-_r(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(u,d),this._z=Math.atan2(a,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(_r(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-h,r)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-_r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(u,l),this._y=Math.atan2(o,r)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,i===!0&&this._onChangeCallback(),this}setFromQuaternion(t,e,i){return X6.makeRotationFromQuaternion(t),this.setFromRotationMatrix(X6,e,i)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return q6.setFromEuler(this),this.setFromQuaternion(q6,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};Nr.DEFAULT_ORDER="XYZ";var lk=class{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}},jAe=0,Y6=new L,_g=new Zt,xu=new $e,rA=new L,xx=new L,WAe=new L,XAe=new Zt,Q6=new L(1,0,0),K6=new L(0,1,0),J6=new L(0,0,1),qAe={type:"added"},Z6={type:"removed"},ji=class extends is{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:jAe++}),this.uuid=qa(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ji.DEFAULT_UP.clone();let t=new L,e=new Nr,i=new Zt,n=new L(1,1,1);function r(){i.setFromEuler(e,!1)}function s(){e.setFromQuaternion(i,void 0,!1)}e._onChange(r),i._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new $e},normalMatrix:{value:new Zr}}),this.matrix=new $e,this.matrixWorld=new $e,this.matrixAutoUpdate=ji.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=ji.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new lk,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return _g.setFromAxisAngle(t,e),this.quaternion.multiply(_g),this}rotateOnWorldAxis(t,e){return _g.setFromAxisAngle(t,e),this.quaternion.premultiply(_g),this}rotateX(t){return this.rotateOnAxis(Q6,t)}rotateY(t){return this.rotateOnAxis(K6,t)}rotateZ(t){return this.rotateOnAxis(J6,t)}translateOnAxis(t,e){return Y6.copy(t).applyQuaternion(this.quaternion),this.position.add(Y6.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(Q6,t)}translateY(t){return this.translateOnAxis(K6,t)}translateZ(t){return this.translateOnAxis(J6,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(xu.copy(this.matrixWorld).invert())}lookAt(t,e,i){t.isVector3?rA.copy(t):rA.set(t,e,i);let n=this.parent;this.updateWorldMatrix(!0,!1),xx.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?xu.lookAt(xx,rA,this.up):xu.lookAt(rA,xx,this.up),this.quaternion.setFromRotationMatrix(xu),n&&(xu.extractRotation(n.matrixWorld),_g.setFromRotationMatrix(xu),this.quaternion.premultiply(_g.invert()))}add(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(qAe)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}let e=this.children.indexOf(t);return e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(Z6)),this}removeFromParent(){let t=this.parent;return t!==null&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){let e=this.children[t];e.parent=null,e.dispatchEvent(Z6)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),xu.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),xu.multiply(t.parent.matrixWorld)),t.applyMatrix4(xu),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let i=0,n=this.children.length;i<n;i++){let r=this.children[i].getObjectByProperty(t,e);if(r!==void 0)return r}}getObjectsByProperty(t,e){let i=[];this[t]===e&&i.push(this);for(let n=0,r=this.children.length;n<r;n++){let s=this.children[n].getObjectsByProperty(t,e);s.length>0&&(i=i.concat(s))}return i}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(xx,t,WAe),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(xx,XAe,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);let e=this.children;for(let i=0,n=e.length;i<n;i++)e[i].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);let e=this.children;for(let i=0,n=e.length;i<n;i++)e[i].traverseVisible(t)}traverseAncestors(t){let e=this.parent;e!==null&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);let e=this.children;for(let i=0,n=e.length;i<n;i++){let r=e[i];(r.matrixWorldAutoUpdate===!0||t===!0)&&r.updateMatrixWorld(t)}}updateWorldMatrix(t,e){let i=this.parent;if(t===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e===!0){let n=this.children;for(let r=0,s=n.length;r<s;r++){let o=n[r];o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!1,!0)}}}toJSON(t){let e=t===void 0||typeof t=="string",i={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON()));function r(o,a){return o[a.uuid]===void 0&&(o[a.uuid]=a.toJSON(t)),a.uuid}if(this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(n.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=r(t.geometries,this.geometry);let o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){let a=o.shapes;if(Array.isArray(a))for(let l=0,c=a.length;l<c;l++){let h=a[l];r(t.shapes,h)}else r(t.shapes,a)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(t.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let o=[];for(let a=0,l=this.material.length;a<l;a++)o.push(r(t.materials,this.material[a]));n.material=o}else n.material=r(t.materials,this.material);if(this.children.length>0){n.children=[];for(let o=0;o<this.children.length;o++)n.children.push(this.children[o].toJSON(t).object)}if(this.animations.length>0){n.animations=[];for(let o=0;o<this.animations.length;o++){let a=this.animations[o];n.animations.push(r(t.animations,a))}}if(e){let o=s(t.geometries),a=s(t.materials),l=s(t.textures),c=s(t.images),h=s(t.shapes),u=s(t.skeletons),d=s(t.animations),f=s(t.nodes);o.length>0&&(i.geometries=o),a.length>0&&(i.materials=a),l.length>0&&(i.textures=l),c.length>0&&(i.images=c),h.length>0&&(i.shapes=h),u.length>0&&(i.skeletons=u),d.length>0&&(i.animations=d),f.length>0&&(i.nodes=f)}return i.object=n,i;function s(o){let a=[];for(let l in o){let c=o[l];delete c.metadata,a.push(c)}return a}}clone(t){return new this.constructor().copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(let i=0;i<t.children.length;i++){let n=t.children[i];this.add(n.clone())}return this}};ji.DEFAULT_UP=new L(0,1,0);ji.DEFAULT_MATRIX_AUTO_UPDATE=!0;ji.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var pl=new L,_u=new L,UR=new L,wu=new L,wg=new L,bg=new L,$6=new L,kR=new L,zR=new L,GR=new L,xs=class{constructor(t=new L,e=new L,i=new L){this.a=t,this.b=e,this.c=i}static getNormal(t,e,i,n){n.subVectors(i,e),pl.subVectors(t,e),n.cross(pl);let r=n.lengthSq();return r>0?n.multiplyScalar(1/Math.sqrt(r)):n.set(0,0,0)}static getBarycoord(t,e,i,n,r){pl.subVectors(n,e),_u.subVectors(i,e),UR.subVectors(t,e);let s=pl.dot(pl),o=pl.dot(_u),a=pl.dot(UR),l=_u.dot(_u),c=_u.dot(UR),h=s*l-o*o;if(h===0)return r.set(-2,-1,-1);let u=1/h,d=(l*a-o*c)*u,f=(s*c-o*a)*u;return r.set(1-d-f,f,d)}static containsPoint(t,e,i,n){return this.getBarycoord(t,e,i,n,wu),wu.x>=0&&wu.y>=0&&wu.x+wu.y<=1}static getUV(t,e,i,n,r,s,o,a){return this.getBarycoord(t,e,i,n,wu),a.set(0,0),a.addScaledVector(r,wu.x),a.addScaledVector(s,wu.y),a.addScaledVector(o,wu.z),a}static isFrontFacing(t,e,i,n){return pl.subVectors(i,e),_u.subVectors(t,e),pl.cross(_u).dot(n)<0}set(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this}setFromPointsAndIndices(t,e,i,n){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[n]),this}setFromAttributeAndIndices(t,e,i,n){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,i),this.c.fromBufferAttribute(t,n),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return pl.subVectors(this.c,this.b),_u.subVectors(this.a,this.b),pl.cross(_u).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return xs.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return xs.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,i,n,r){return xs.getUV(t,this.a,this.b,this.c,e,i,n,r)}containsPoint(t){return xs.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return xs.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){let i=this.a,n=this.b,r=this.c,s,o;wg.subVectors(n,i),bg.subVectors(r,i),kR.subVectors(t,i);let a=wg.dot(kR),l=bg.dot(kR);if(a<=0&&l<=0)return e.copy(i);zR.subVectors(t,n);let c=wg.dot(zR),h=bg.dot(zR);if(c>=0&&h<=c)return e.copy(n);let u=a*h-c*l;if(u<=0&&a>=0&&c<=0)return s=a/(a-c),e.copy(i).addScaledVector(wg,s);GR.subVectors(t,r);let d=wg.dot(GR),f=bg.dot(GR);if(f>=0&&d<=f)return e.copy(r);let p=d*l-a*f;if(p<=0&&l>=0&&f<=0)return o=l/(l-f),e.copy(i).addScaledVector(bg,o);let m=c*f-d*h;if(m<=0&&h-c>=0&&d-f>=0)return $6.subVectors(r,n),o=(h-c)/(h-c+(d-f)),e.copy(n).addScaledVector($6,o);let v=1/(m+p+u);return s=p*v,o=u*v,e.copy(i).addScaledVector(wg,s).addScaledVector(bg,o)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},YAe=0,Lw=class extends is{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:YAe++}),this.uuid=qa(),this.name="",this.type="Material",this.blending=jv,this.side=Hl,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=hee,this.blendDst=dee,this.blendEquation=Yg,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=LB,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=SAe,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ER,this.stencilZFail=ER,this.stencilZPass=ER,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(let e in t){let i=t[e];if(i===void 0){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}let n=this[e];if(n===void 0){console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.");continue}n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[e]=i}}toJSON(t){let e=t===void 0||typeof t=="string";e&&(t={textures:{},images:{}});let i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(t).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(t).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==jv&&(i.blending=this.blending),this.side!==Hl&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(i.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(i.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=this.flatShading),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function n(r){let s=[];for(let o in r){let a=r[o];delete a.metadata,s.push(a)}return s}if(e){let r=n(t.textures),s=n(t.images);r.length>0&&(i.textures=r),s.length>0&&(i.images=s)}return i}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;let e=t.clippingPlanes,i=null;if(e!==null){let n=e.length;i=new Array(n);for(let r=0;r!==n;++r)i[r]=e[r].clone()}return this.clippingPlanes=i,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}},ly=class extends Lw{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new It(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=fee,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}},nr=new L,sA=new he,Gt=class{constructor(t,e,i=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=t!==void 0?t.length/e:0,this.normalized=i,this.usage=NB,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,i){t*=this.itemSize,i*=e.itemSize;for(let n=0,r=this.itemSize;n<r;n++)this.array[t+n]=e.array[i+n];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(this.itemSize===2)for(let e=0,i=this.count;e<i;e++)sA.fromBufferAttribute(this,e),sA.applyMatrix3(t),this.setXY(e,sA.x,sA.y);else if(this.itemSize===3)for(let e=0,i=this.count;e<i;e++)nr.fromBufferAttribute(this,e),nr.applyMatrix3(t),this.setXYZ(e,nr.x,nr.y,nr.z);return this}applyMatrix4(t){for(let e=0,i=this.count;e<i;e++)nr.fromBufferAttribute(this,e),nr.applyMatrix4(t),this.setXYZ(e,nr.x,nr.y,nr.z);return this}applyNormalMatrix(t){for(let e=0,i=this.count;e<i;e++)nr.fromBufferAttribute(this,e),nr.applyNormalMatrix(t),this.setXYZ(e,nr.x,nr.y,nr.z);return this}transformDirection(t){for(let e=0,i=this.count;e<i;e++)nr.fromBufferAttribute(this,e),nr.transformDirection(t),this.setXYZ(e,nr.x,nr.y,nr.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=Ku(e,this.array)),e}setX(t,e){return this.normalized&&(e=Ki(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=Ku(e,this.array)),e}setY(t,e){return this.normalized&&(e=Ki(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=Ku(e,this.array)),e}setZ(t,e){return this.normalized&&(e=Ki(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=Ku(e,this.array)),e}setW(t,e){return this.normalized&&(e=Ki(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,i){return t*=this.itemSize,this.normalized&&(e=Ki(e,this.array),i=Ki(i,this.array)),this.array[t+0]=e,this.array[t+1]=i,this}setXYZ(t,e,i,n){return t*=this.itemSize,this.normalized&&(e=Ki(e,this.array),i=Ki(i,this.array),n=Ki(n,this.array)),this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this}setXYZW(t,e,i,n,r){return t*=this.itemSize,this.normalized&&(e=Ki(e,this.array),i=Ki(i,this.array),n=Ki(n,this.array),r=Ki(r,this.array)),this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this.array[t+3]=r,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==NB&&(t.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(t.updateRange=this.updateRange),t}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}},Eee=class extends Gt{constructor(t,e,i){super(new Uint16Array(t),e,i)}},Wv=class extends Gt{constructor(t,e,i){super(new Uint32Array(t),e,i)}},yt=class extends Gt{constructor(t,e,i){super(new Float32Array(t),e,i)}},QAe=0,wa=new $e,HR=new ji,Sg=new L,Oo=new Zn,_x=new Zn,Ir=new L,Ut=class extends is{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:QAe++}),this.uuid=qa(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(wee(t)?Wv:Eee)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,e,i=0){this.groups.push({start:t,count:e,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){let e=this.attributes.position;e!==void 0&&(e.applyMatrix4(t),e.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let r=new Zr().getNormalMatrix(t);i.applyNormalMatrix(r),i.needsUpdate=!0}let n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(t),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return wa.makeRotationFromQuaternion(t),this.applyMatrix4(wa),this}rotateX(t){return wa.makeRotationX(t),this.applyMatrix4(wa),this}rotateY(t){return wa.makeRotationY(t),this.applyMatrix4(wa),this}rotateZ(t){return wa.makeRotationZ(t),this.applyMatrix4(wa),this}translate(t,e,i){return wa.makeTranslation(t,e,i),this.applyMatrix4(wa),this}scale(t,e,i){return wa.makeScale(t,e,i),this.applyMatrix4(wa),this}lookAt(t){return HR.lookAt(t),HR.updateMatrix(),this.applyMatrix4(HR.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Sg).negate(),this.translate(Sg.x,Sg.y,Sg.z),this}setFromPoints(t){let e=[];for(let i=0,n=t.length;i<n;i++){let r=t[i];e.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new yt(e,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Zn);let t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new L(-1/0,-1/0,-1/0),new L(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),e)for(let i=0,n=e.length;i<n;i++){let r=e[i];Oo.setFromBufferAttribute(r),this.morphTargetsRelative?(Ir.addVectors(this.boundingBox.min,Oo.min),this.boundingBox.expandByPoint(Ir),Ir.addVectors(this.boundingBox.max,Oo.max),this.boundingBox.expandByPoint(Ir)):(this.boundingBox.expandByPoint(Oo.min),this.boundingBox.expandByPoint(Oo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new sa);let t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new L,1/0);return}if(t){let i=this.boundingSphere.center;if(Oo.setFromBufferAttribute(t),e)for(let r=0,s=e.length;r<s;r++){let o=e[r];_x.setFromBufferAttribute(o),this.morphTargetsRelative?(Ir.addVectors(Oo.min,_x.min),Oo.expandByPoint(Ir),Ir.addVectors(Oo.max,_x.max),Oo.expandByPoint(Ir)):(Oo.expandByPoint(_x.min),Oo.expandByPoint(_x.max))}Oo.getCenter(i);let n=0;for(let r=0,s=t.count;r<s;r++)Ir.fromBufferAttribute(t,r),n=Math.max(n,i.distanceToSquared(Ir));if(e)for(let r=0,s=e.length;r<s;r++){let o=e[r],a=this.morphTargetsRelative;for(let l=0,c=o.count;l<c;l++)Ir.fromBufferAttribute(o,l),a&&(Sg.fromBufferAttribute(t,l),Ir.add(Sg)),n=Math.max(n,i.distanceToSquared(Ir))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let t=this.index,e=this.attributes;if(t===null||e.position===void 0||e.normal===void 0||e.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let i=t.array,n=e.position.array,r=e.normal.array,s=e.uv.array,o=n.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Gt(new Float32Array(4*o),4));let a=this.getAttribute("tangent").array,l=[],c=[];for(let T=0;T<o;T++)l[T]=new L,c[T]=new L;let h=new L,u=new L,d=new L,f=new he,p=new he,m=new he,v=new L,g=new L;function y(T,P,R){h.fromArray(n,T*3),u.fromArray(n,P*3),d.fromArray(n,R*3),f.fromArray(s,T*2),p.fromArray(s,P*2),m.fromArray(s,R*2),u.sub(h),d.sub(h),p.sub(f),m.sub(f);let U=1/(p.x*m.y-m.x*p.y);!isFinite(U)||(v.copy(u).multiplyScalar(m.y).addScaledVector(d,-p.y).multiplyScalar(U),g.copy(d).multiplyScalar(p.x).addScaledVector(u,-m.x).multiplyScalar(U),l[T].add(v),l[P].add(v),l[R].add(v),c[T].add(g),c[P].add(g),c[R].add(g))}let x=this.groups;x.length===0&&(x=[{start:0,count:i.length}]);for(let T=0,P=x.length;T<P;++T){let R=x[T],U=R.start,F=R.count;for(let N=U,W=U+F;N<W;N+=3)y(i[N+0],i[N+1],i[N+2])}let b=new L,S=new L,A=new L,E=new L;function M(T){A.fromArray(r,T*3),E.copy(A);let P=l[T];b.copy(P),b.sub(A.multiplyScalar(A.dot(P))).normalize(),S.crossVectors(E,P);let R=S.dot(c[T])<0?-1:1;a[T*4]=b.x,a[T*4+1]=b.y,a[T*4+2]=b.z,a[T*4+3]=R}for(let T=0,P=x.length;T<P;++T){let R=x[T],U=R.start,F=R.count;for(let N=U,W=U+F;N<W;N+=3)M(i[N+0]),M(i[N+1]),M(i[N+2])}}computeVertexNormals(){let t=this.index,e=this.getAttribute("position");if(e!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Gt(new Float32Array(e.count*3),3),this.setAttribute("normal",i);else for(let u=0,d=i.count;u<d;u++)i.setXYZ(u,0,0,0);let n=new L,r=new L,s=new L,o=new L,a=new L,l=new L,c=new L,h=new L;if(t)for(let u=0,d=t.count;u<d;u+=3){let f=t.getX(u+0),p=t.getX(u+1),m=t.getX(u+2);n.fromBufferAttribute(e,f),r.fromBufferAttribute(e,p),s.fromBufferAttribute(e,m),c.subVectors(s,r),h.subVectors(n,r),c.cross(h),o.fromBufferAttribute(i,f),a.fromBufferAttribute(i,p),l.fromBufferAttribute(i,m),o.add(c),a.add(c),l.add(c),i.setXYZ(f,o.x,o.y,o.z),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(m,l.x,l.y,l.z)}else for(let u=0,d=e.count;u<d;u+=3)n.fromBufferAttribute(e,u+0),r.fromBufferAttribute(e,u+1),s.fromBufferAttribute(e,u+2),c.subVectors(s,r),h.subVectors(n,r),c.cross(h),i.setXYZ(u+0,c.x,c.y,c.z),i.setXYZ(u+1,c.x,c.y,c.z),i.setXYZ(u+2,c.x,c.y,c.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){let t=this.attributes.normal;for(let e=0,i=t.count;e<i;e++)Ir.fromBufferAttribute(t,e),Ir.normalize(),t.setXYZ(e,Ir.x,Ir.y,Ir.z)}toNonIndexed(){function t(o,a){let l=o.array,c=o.itemSize,h=o.normalized,u=new l.constructor(a.length*c),d=0,f=0;for(let p=0,m=a.length;p<m;p++){o.isInterleavedBufferAttribute?d=a[p]*o.data.stride+o.offset:d=a[p]*c;for(let v=0;v<c;v++)u[f++]=l[d++]}return new Gt(u,c,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let e=new Ut,i=this.index.array,n=this.attributes;for(let o in n){let a=n[o],l=t(a,i);e.setAttribute(o,l)}let r=this.morphAttributes;for(let o in r){let a=[],l=r[o];for(let c=0,h=l.length;c<h;c++){let u=l[c],d=t(u,i);a.push(d)}e.morphAttributes[o]=a}e.morphTargetsRelative=this.morphTargetsRelative;let s=this.groups;for(let o=0,a=s.length;o<a;o++){let l=s[o];e.addGroup(l.start,l.count,l.materialIndex)}return e}toJSON(){let t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){let a=this.parameters;for(let l in a)a[l]!==void 0&&(t[l]=a[l]);return t}t.data={attributes:{}};let e=this.index;e!==null&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});let i=this.attributes;for(let a in i){let l=i[a];t.data.attributes[a]=l.toJSON(t.data)}let n={},r=!1;for(let a in this.morphAttributes){let l=this.morphAttributes[a],c=[];for(let h=0,u=l.length;h<u;h++){let d=l[h];c.push(d.toJSON(t.data))}c.length>0&&(n[a]=c,r=!0)}r&&(t.data.morphAttributes=n,t.data.morphTargetsRelative=this.morphTargetsRelative);let s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));let o=this.boundingSphere;return o!==null&&(t.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let e={};this.name=t.name;let i=t.index;i!==null&&this.setIndex(i.clone(e));let n=t.attributes;for(let l in n){let c=n[l];this.setAttribute(l,c.clone(e))}let r=t.morphAttributes;for(let l in r){let c=[],h=r[l];for(let u=0,d=h.length;u<d;u++)c.push(h[u].clone(e));this.morphAttributes[l]=c}this.morphTargetsRelative=t.morphTargetsRelative;let s=t.groups;for(let l=0,c=s.length;l<c;l++){let h=s[l];this.addGroup(h.start,h.count,h.materialIndex)}let o=t.boundingBox;o!==null&&(this.boundingBox=o.clone());let a=t.boundingSphere;return a!==null&&(this.boundingSphere=a.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,t.parameters!==void 0&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},eW=new $e,Ag=new ay,VR=new sa,wx=new L,bx=new L,Sx=new L,jR=new L,oA=new L,aA=new he,lA=new he,cA=new he,WR=new L,uA=new L,co=class extends ji{constructor(t=new Ut,e=new ly){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){let t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){let i=t[e[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,r=i.length;n<r;n++){let s=i[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=n}}}}getVertexPosition(t,e){let i=this.geometry,n=i.attributes.position,r=i.morphAttributes.position,s=i.morphTargetsRelative;e.fromBufferAttribute(n,t);let o=this.morphTargetInfluences;if(r&&o){oA.set(0,0,0);for(let a=0,l=r.length;a<l;a++){let c=o[a],h=r[a];c!==0&&(jR.fromBufferAttribute(h,t),s?oA.addScaledVector(jR,c):oA.addScaledVector(jR.sub(e),c))}e.add(oA)}return this.isSkinnedMesh&&this.boneTransform(t,e),e}raycast(t,e){let i=this.geometry,n=this.material,r=this.matrixWorld;if(n===void 0||(i.boundingSphere===null&&i.computeBoundingSphere(),VR.copy(i.boundingSphere),VR.applyMatrix4(r),t.ray.intersectsSphere(VR)===!1)||(eW.copy(r).invert(),Ag.copy(t.ray).applyMatrix4(eW),i.boundingBox!==null&&Ag.intersectsBox(i.boundingBox)===!1))return;let s,o=i.index,a=i.attributes.position,l=i.attributes.uv,c=i.attributes.uv2,h=i.groups,u=i.drawRange;if(o!==null)if(Array.isArray(n))for(let d=0,f=h.length;d<f;d++){let p=h[d],m=n[p.materialIndex],v=Math.max(p.start,u.start),g=Math.min(o.count,Math.min(p.start+p.count,u.start+u.count));for(let y=v,x=g;y<x;y+=3){let b=o.getX(y),S=o.getX(y+1),A=o.getX(y+2);s=hA(this,m,t,Ag,l,c,b,S,A),s&&(s.faceIndex=Math.floor(y/3),s.face.materialIndex=p.materialIndex,e.push(s))}}else{let d=Math.max(0,u.start),f=Math.min(o.count,u.start+u.count);for(let p=d,m=f;p<m;p+=3){let v=o.getX(p),g=o.getX(p+1),y=o.getX(p+2);s=hA(this,n,t,Ag,l,c,v,g,y),s&&(s.faceIndex=Math.floor(p/3),e.push(s))}}else if(a!==void 0)if(Array.isArray(n))for(let d=0,f=h.length;d<f;d++){let p=h[d],m=n[p.materialIndex],v=Math.max(p.start,u.start),g=Math.min(a.count,Math.min(p.start+p.count,u.start+u.count));for(let y=v,x=g;y<x;y+=3){let b=y,S=y+1,A=y+2;s=hA(this,m,t,Ag,l,c,b,S,A),s&&(s.faceIndex=Math.floor(y/3),s.face.materialIndex=p.materialIndex,e.push(s))}}else{let d=Math.max(0,u.start),f=Math.min(a.count,u.start+u.count);for(let p=d,m=f;p<m;p+=3){let v=p,g=p+1,y=p+2;s=hA(this,n,t,Ag,l,c,v,g,y),s&&(s.faceIndex=Math.floor(p/3),e.push(s))}}}};function KAe(t,e,i,n,r,s,o,a){let l;if(e.side===kr?l=n.intersectTriangle(o,s,r,!0,a):l=n.intersectTriangle(r,s,o,e.side===Hl,a),l===null)return null;uA.copy(a),uA.applyMatrix4(t.matrixWorld);let c=i.ray.origin.distanceTo(uA);return c<i.near||c>i.far?null:{distance:c,point:uA.clone(),object:t}}function hA(t,e,i,n,r,s,o,a,l){t.getVertexPosition(o,wx),t.getVertexPosition(a,bx),t.getVertexPosition(l,Sx);let c=KAe(t,e,i,n,wx,bx,Sx,WR);if(c){r&&(aA.fromBufferAttribute(r,o),lA.fromBufferAttribute(r,a),cA.fromBufferAttribute(r,l),c.uv=xs.getUV(WR,wx,bx,Sx,aA,lA,cA,new he)),s&&(aA.fromBufferAttribute(s,o),lA.fromBufferAttribute(s,a),cA.fromBufferAttribute(s,l),c.uv2=xs.getUV(WR,wx,bx,Sx,aA,lA,cA,new he));let h={a:o,b:a,c:l,normal:new L,materialIndex:0};xs.getNormal(wx,bx,Sx,h.normal),c.face=h}return c}var Qc=class extends Ut{constructor(t=1,e=1,i=1,n=1,r=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:r,depthSegments:s};let o=this;n=Math.floor(n),r=Math.floor(r),s=Math.floor(s);let a=[],l=[],c=[],h=[],u=0,d=0;f("z","y","x",-1,-1,i,e,t,s,r,0),f("z","y","x",1,-1,i,e,-t,s,r,1),f("x","z","y",1,1,t,i,e,n,s,2),f("x","z","y",1,-1,t,i,-e,n,s,3),f("x","y","z",1,-1,t,e,i,n,r,4),f("x","y","z",-1,-1,t,e,-i,n,r,5),this.setIndex(a),this.setAttribute("position",new yt(l,3)),this.setAttribute("normal",new yt(c,3)),this.setAttribute("uv",new yt(h,2));function f(p,m,v,g,y,x,b,S,A,E,M){let T=x/A,P=b/E,R=x/2,U=b/2,F=S/2,N=A+1,W=E+1,Q=0,X=0,B=new L;for(let j=0;j<W;j++){let z=j*P-U;for(let k=0;k<N;k++){let G=k*T-R;B[p]=G*g,B[m]=z*y,B[v]=F,l.push(B.x,B.y,B.z),B[p]=0,B[m]=0,B[v]=S>0?1:-1,c.push(B.x,B.y,B.z),h.push(k/A),h.push(1-j/E),Q+=1}}for(let j=0;j<E;j++)for(let z=0;z<A;z++){let k=u+z+N*j,G=u+z+N*(j+1),Z=u+(z+1)+N*(j+1),K=u+(z+1)+N*j;a.push(k,G,K),a.push(G,Z,K),X+=6}o.addGroup(d,X,M),d+=X,u+=Q}}static fromJSON(t){return new Qc(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}};function U0(t){let e={};for(let i in t){e[i]={};for(let n in t[i]){let r=t[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?e[i][n]=r.clone():Array.isArray(r)?e[i][n]=r.slice():e[i][n]=r}}return e}function Fs(t){let e={};for(let i=0;i<t.length;i++){let n=U0(t[i]);for(let r in n)e[r]=n[r]}return e}function JAe(t){let e=[];for(let i=0;i<t.length;i++)e.push(t[i].clone());return e}function Tee(t){return t.getRenderTarget()===null&&t.outputEncoding===Qt?_c:ZE}var cy={clone:U0,merge:Fs},ZAe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,$Ae=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,$i=class extends Lw{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=ZAe,this.fragmentShader=$Ae,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=U0(t.uniforms),this.uniformsGroups=JAe(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){let e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(let n in this.uniforms){let r=this.uniforms[n].value;r&&r.isTexture?e.uniforms[n]={type:"t",value:r.toJSON(t).uuid}:r&&r.isColor?e.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?e.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?e.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?e.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?e.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?e.uniforms[n]={type:"m4",value:r.toArray()}:e.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;let i={};for(let n in this.extensions)this.extensions[n]===!0&&(i[n]=!0);return Object.keys(i).length>0&&(e.extensions=i),e}},uy=class extends ji{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new $e,this.projectionMatrix=new $e,this.projectionMatrixInverse=new $e}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},vs=class extends uy{constructor(t=50,e=1,i=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=i,this.far=n,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){let e=.5*this.getFilmHeight()/t;this.fov=G_*2*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){let t=Math.tan(N1*.5*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return G_*2*Math.atan(Math.tan(N1*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,i,n,r,s){this.aspect=t/e,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let t=this.near,e=t*Math.tan(N1*.5*this.fov)/this.zoom,i=2*e,n=this.aspect*i,r=-.5*n,s=this.view;if(this.view!==null&&this.view.enabled){let a=s.fullWidth,l=s.fullHeight;r+=s.offsetX*n/a,e-=s.offsetY*i/l,n*=s.width/a,i*=s.height/l}let o=this.filmOffset;o!==0&&(r+=t*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+n,e,e-i,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){let e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}},Mg=-90,Eg=1,eMe=class extends ji{constructor(t,e,i){super(),this.type="CubeCamera",this.renderTarget=i;let n=new vs(Mg,Eg,t,e);n.layers=this.layers,n.up.set(0,1,0),n.lookAt(1,0,0),this.add(n);let r=new vs(Mg,Eg,t,e);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(-1,0,0),this.add(r);let s=new vs(Mg,Eg,t,e);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);let o=new vs(Mg,Eg,t,e);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(0,-1,0),this.add(o);let a=new vs(Mg,Eg,t,e);a.layers=this.layers,a.up.set(0,1,0),a.lookAt(0,0,1),this.add(a);let l=new vs(Mg,Eg,t,e);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(t,e){this.parent===null&&this.updateMatrixWorld();let i=this.renderTarget,[n,r,s,o,a,l]=this.children,c=t.getRenderTarget(),h=t.toneMapping,u=t.xr.enabled;t.toneMapping=ih,t.xr.enabled=!1;let d=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,t.setRenderTarget(i,0),t.render(e,n),t.setRenderTarget(i,1),t.render(e,r),t.setRenderTarget(i,2),t.render(e,s),t.setRenderTarget(i,3),t.render(e,o),t.setRenderTarget(i,4),t.render(e,a),i.texture.generateMipmaps=d,t.setRenderTarget(i,5),t.render(e,l),t.setRenderTarget(c),t.toneMapping=h,t.xr.enabled=u,i.texture.needsPMREMUpdate=!0}},ck=class extends br{constructor(t,e,i,n,r,s,o,a,l,c){t=t!==void 0?t:[],e=e!==void 0?e:sm,super(t,e,i,n,r,s,o,a,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}},tMe=class extends Hi{constructor(t=1,e={}){super(t,t,e),this.isWebGLCubeRenderTarget=!0;let i={width:t,height:t,depth:1},n=[i,i,i,i,i,i];this.texture=new ck(n,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=e.generateMipmaps!==void 0?e.generateMipmaps:!1,this.texture.minFilter=e.minFilter!==void 0?e.minFilter:ri}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;let i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},n=new Qc(5,5,5),r=new $i({name:"CubemapFromEquirect",uniforms:U0(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:kr,blending:fr});r.uniforms.tEquirect.value=e;let s=new co(n,r),o=e.minFilter;return e.minFilter===F0&&(e.minFilter=ri),new eMe(1,10,this).update(t,s),e.minFilter=o,s.geometry.dispose(),s.material.dispose(),this}clear(t,e,i,n){let r=t.getRenderTarget();for(let s=0;s<6;s++)t.setRenderTarget(this,s),t.clear(e,i,n);t.setRenderTarget(r)}},XR=new L,iMe=new L,nMe=new Zr,zo=class{constructor(t=new L(1,0,0),e=0){this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,i,n){return this.normal.set(t,e,i),this.constant=n,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,i){let n=XR.subVectors(i,e).cross(iMe.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(n,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){let t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){let i=t.delta(XR),n=this.normal.dot(i);if(n===0)return this.distanceToPoint(t.start)===0?e.copy(t.start):null;let r=-(t.start.dot(this.normal)+this.constant)/n;return r<0||r>1?null:e.copy(i).multiplyScalar(r).add(t.start)}intersectsLine(t){let e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return e<0&&i>0||i<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){let i=e||nMe.getNormalMatrix(t),n=this.coplanarPoint(XR).applyMatrix4(t),r=this.normal.applyMatrix3(i).normalize();return this.constant=-n.dot(r),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}},Tg=new sa,dA=new L,uk=class{constructor(t=new zo,e=new zo,i=new zo,n=new zo,r=new zo,s=new zo){this.planes=[t,e,i,n,r,s]}set(t,e,i,n,r,s){let o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(i),o[3].copy(n),o[4].copy(r),o[5].copy(s),this}copy(t){let e=this.planes;for(let i=0;i<6;i++)e[i].copy(t.planes[i]);return this}setFromProjectionMatrix(t){let e=this.planes,i=t.elements,n=i[0],r=i[1],s=i[2],o=i[3],a=i[4],l=i[5],c=i[6],h=i[7],u=i[8],d=i[9],f=i[10],p=i[11],m=i[12],v=i[13],g=i[14],y=i[15];return e[0].setComponents(o-n,h-a,p-u,y-m).normalize(),e[1].setComponents(o+n,h+a,p+u,y+m).normalize(),e[2].setComponents(o+r,h+l,p+d,y+v).normalize(),e[3].setComponents(o-r,h-l,p-d,y-v).normalize(),e[4].setComponents(o-s,h-c,p-f,y-g).normalize(),e[5].setComponents(o+s,h+c,p+f,y+g).normalize(),this}intersectsObject(t){let e=t.geometry;return e.boundingSphere===null&&e.computeBoundingSphere(),Tg.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Tg)}intersectsSprite(t){return Tg.center.set(0,0,0),Tg.radius=.7071067811865476,Tg.applyMatrix4(t.matrixWorld),this.intersectsSphere(Tg)}intersectsSphere(t){let e=this.planes,i=t.center,n=-t.radius;for(let r=0;r<6;r++)if(e[r].distanceToPoint(i)<n)return!1;return!0}intersectsBox(t){let e=this.planes;for(let i=0;i<6;i++){let n=e[i];if(dA.x=n.normal.x>0?t.max.x:t.min.x,dA.y=n.normal.y>0?t.max.y:t.min.y,dA.z=n.normal.z>0?t.max.z:t.min.z,n.distanceToPoint(dA)<0)return!1}return!0}containsPoint(t){let e=this.planes;for(let i=0;i<6;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function Cee(){let t=null,e=!1,i=null,n=null;function r(s,o){i(s,o),n=t.requestAnimationFrame(r)}return{start:function(){e!==!0&&i!==null&&(n=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){i=s},setContext:function(s){t=s}}}function rMe(t,e){let i=e.isWebGL2,n=new WeakMap;function r(c,h){let u=c.array,d=c.usage,f=t.createBuffer();t.bindBuffer(h,f),t.bufferData(h,u,d),c.onUploadCallback();let p;if(u instanceof Float32Array)p=5126;else if(u instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(i)p=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else p=5123;else if(u instanceof Int16Array)p=5122;else if(u instanceof Uint32Array)p=5125;else if(u instanceof Int32Array)p=5124;else if(u instanceof Int8Array)p=5120;else if(u instanceof Uint8Array)p=5121;else if(u instanceof Uint8ClampedArray)p=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:f,type:p,bytesPerElement:u.BYTES_PER_ELEMENT,version:c.version}}function s(c,h,u){let d=h.array,f=h.updateRange;t.bindBuffer(u,c),f.count===-1?t.bufferSubData(u,0,d):(i?t.bufferSubData(u,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):t.bufferSubData(u,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1),h.onUploadCallback()}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),n.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);let h=n.get(c);h&&(t.deleteBuffer(h.buffer),n.delete(c))}function l(c,h){if(c.isGLBufferAttribute){let d=n.get(c);(!d||d.version<c.version)&&n.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);let u=n.get(c);u===void 0?n.set(c,r(c,h)):u.version<c.version&&(s(u.buffer,c,h),u.version=c.version)}return{get:o,remove:a,update:l}}var ZC=class extends Ut{constructor(t=1,e=1,i=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n};let r=t/2,s=e/2,o=Math.floor(i),a=Math.floor(n),l=o+1,c=a+1,h=t/o,u=e/a,d=[],f=[],p=[],m=[];for(let v=0;v<c;v++){let g=v*u-s;for(let y=0;y<l;y++){let x=y*h-r;f.push(x,-g,0),p.push(0,0,1),m.push(y/o),m.push(1-v/a)}}for(let v=0;v<a;v++)for(let g=0;g<o;g++){let y=g+l*v,x=g+l*(v+1),b=g+1+l*(v+1),S=g+1+l*v;d.push(y,x,S),d.push(x,b,S)}this.setIndex(d),this.setAttribute("position",new yt(f,3)),this.setAttribute("normal",new yt(p,3)),this.setAttribute("uv",new yt(m,2))}static fromJSON(t){return new ZC(t.width,t.height,t.widthSegments,t.heightSegments)}},sMe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,oMe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,aMe=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,lMe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,cMe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,uMe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,hMe="vec3 transformed = vec3( position );",dMe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,fMe=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,pMe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,mMe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,gMe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,vMe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,yMe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,xMe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,_Me=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,wMe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,bMe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,SMe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,AMe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,MMe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,EMe=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,TMe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,CMe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,PMe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,DMe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,RMe="gl_FragColor = linearToOutputTexel( gl_FragColor );",IMe=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,LMe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,BMe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,OMe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,FMe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,NMe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,UMe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,kMe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,zMe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,GMe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,HMe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,VMe=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,jMe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,WMe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,XMe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,qMe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,YMe=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,QMe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,KMe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,JMe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,ZMe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,$Me=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,eEe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,tEe=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,iEe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,nEe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,rEe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,sEe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,oEe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,aEe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,lEe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,cEe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,uEe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,hEe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,dEe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,fEe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,pEe=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,mEe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,gEe=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,vEe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,yEe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,xEe=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,_Ee=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,wEe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,bEe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,SEe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,AEe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,MEe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,EEe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,TEe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,CEe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,PEe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,DEe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,REe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,IEe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,LEe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,BEe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,OEe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,FEe=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,NEe=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,UEe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,kEe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,zEe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,GEe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,HEe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,VEe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,jEe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,WEe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,XEe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,qEe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,YEe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,QEe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,KEe=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,JEe=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,ZEe=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,$Ee=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,eTe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,tTe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,iTe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,nTe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,rTe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,sTe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,oTe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,aTe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,lTe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cTe=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,uTe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,hTe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,dTe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,fTe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,pTe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,mTe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,gTe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vTe=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,yTe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,xTe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,_Te=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,wTe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,bTe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,STe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,ATe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,MTe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ETe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,TTe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,CTe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,PTe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,DTe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,RTe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,ITe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,LTe=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,BTe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,OTe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,FTe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Jt={alphamap_fragment:sMe,alphamap_pars_fragment:oMe,alphatest_fragment:aMe,alphatest_pars_fragment:lMe,aomap_fragment:cMe,aomap_pars_fragment:uMe,begin_vertex:hMe,beginnormal_vertex:dMe,bsdfs:fMe,iridescence_fragment:pMe,bumpmap_pars_fragment:mMe,clipping_planes_fragment:gMe,clipping_planes_pars_fragment:vMe,clipping_planes_pars_vertex:yMe,clipping_planes_vertex:xMe,color_fragment:_Me,color_pars_fragment:wMe,color_pars_vertex:bMe,color_vertex:SMe,common:AMe,cube_uv_reflection_fragment:MMe,defaultnormal_vertex:EMe,displacementmap_pars_vertex:TMe,displacementmap_vertex:CMe,emissivemap_fragment:PMe,emissivemap_pars_fragment:DMe,encodings_fragment:RMe,encodings_pars_fragment:IMe,envmap_fragment:LMe,envmap_common_pars_fragment:BMe,envmap_pars_fragment:OMe,envmap_pars_vertex:FMe,envmap_physical_pars_fragment:YMe,envmap_vertex:NMe,fog_vertex:UMe,fog_pars_vertex:kMe,fog_fragment:zMe,fog_pars_fragment:GMe,gradientmap_pars_fragment:HMe,lightmap_fragment:VMe,lightmap_pars_fragment:jMe,lights_lambert_fragment:WMe,lights_lambert_pars_fragment:XMe,lights_pars_begin:qMe,lights_toon_fragment:QMe,lights_toon_pars_fragment:KMe,lights_phong_fragment:JMe,lights_phong_pars_fragment:ZMe,lights_physical_fragment:$Me,lights_physical_pars_fragment:eEe,lights_fragment_begin:tEe,lights_fragment_maps:iEe,lights_fragment_end:nEe,logdepthbuf_fragment:rEe,logdepthbuf_pars_fragment:sEe,logdepthbuf_pars_vertex:oEe,logdepthbuf_vertex:aEe,map_fragment:lEe,map_pars_fragment:cEe,map_particle_fragment:uEe,map_particle_pars_fragment:hEe,metalnessmap_fragment:dEe,metalnessmap_pars_fragment:fEe,morphcolor_vertex:pEe,morphnormal_vertex:mEe,morphtarget_pars_vertex:gEe,morphtarget_vertex:vEe,normal_fragment_begin:yEe,normal_fragment_maps:xEe,normal_pars_fragment:_Ee,normal_pars_vertex:wEe,normal_vertex:bEe,normalmap_pars_fragment:SEe,clearcoat_normal_fragment_begin:AEe,clearcoat_normal_fragment_maps:MEe,clearcoat_pars_fragment:EEe,iridescence_pars_fragment:TEe,output_fragment:CEe,packing:PEe,premultiplied_alpha_fragment:DEe,project_vertex:REe,dithering_fragment:IEe,dithering_pars_fragment:LEe,roughnessmap_fragment:BEe,roughnessmap_pars_fragment:OEe,shadowmap_pars_fragment:FEe,shadowmap_pars_vertex:NEe,shadowmap_vertex:UEe,shadowmask_pars_fragment:kEe,skinbase_vertex:zEe,skinning_pars_vertex:GEe,skinning_vertex:HEe,skinnormal_vertex:VEe,specularmap_fragment:jEe,specularmap_pars_fragment:WEe,tonemapping_fragment:XEe,tonemapping_pars_fragment:qEe,transmission_fragment:YEe,transmission_pars_fragment:QEe,uv_pars_fragment:KEe,uv_pars_vertex:JEe,uv_vertex:ZEe,uv2_pars_fragment:$Ee,uv2_pars_vertex:eTe,uv2_vertex:tTe,worldpos_vertex:iTe,background_vert:nTe,background_frag:rTe,backgroundCube_vert:sTe,backgroundCube_frag:oTe,cube_vert:aTe,cube_frag:lTe,depth_vert:cTe,depth_frag:uTe,distanceRGBA_vert:hTe,distanceRGBA_frag:dTe,equirect_vert:fTe,equirect_frag:pTe,linedashed_vert:mTe,linedashed_frag:gTe,meshbasic_vert:vTe,meshbasic_frag:yTe,meshlambert_vert:xTe,meshlambert_frag:_Te,meshmatcap_vert:wTe,meshmatcap_frag:bTe,meshnormal_vert:STe,meshnormal_frag:ATe,meshphong_vert:MTe,meshphong_frag:ETe,meshphysical_vert:TTe,meshphysical_frag:CTe,meshtoon_vert:PTe,meshtoon_frag:DTe,points_vert:RTe,points_frag:ITe,shadow_vert:LTe,shadow_frag:BTe,sprite_vert:OTe,sprite_frag:FTe},st={common:{diffuse:{value:new It(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Zr},uv2Transform:{value:new Zr},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new he(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new It(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new It(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Zr}},sprite:{diffuse:{value:new It(16777215)},opacity:{value:1},center:{value:new he(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Zr}}},bc={basic:{uniforms:Fs([st.common,st.specularmap,st.envmap,st.aomap,st.lightmap,st.fog]),vertexShader:Jt.meshbasic_vert,fragmentShader:Jt.meshbasic_frag},lambert:{uniforms:Fs([st.common,st.specularmap,st.envmap,st.aomap,st.lightmap,st.emissivemap,st.bumpmap,st.normalmap,st.displacementmap,st.fog,st.lights,{emissive:{value:new It(0)}}]),vertexShader:Jt.meshlambert_vert,fragmentShader:Jt.meshlambert_frag},phong:{uniforms:Fs([st.common,st.specularmap,st.envmap,st.aomap,st.lightmap,st.emissivemap,st.bumpmap,st.normalmap,st.displacementmap,st.fog,st.lights,{emissive:{value:new It(0)},specular:{value:new It(1118481)},shininess:{value:30}}]),vertexShader:Jt.meshphong_vert,fragmentShader:Jt.meshphong_frag},standard:{uniforms:Fs([st.common,st.envmap,st.aomap,st.lightmap,st.emissivemap,st.bumpmap,st.normalmap,st.displacementmap,st.roughnessmap,st.metalnessmap,st.fog,st.lights,{emissive:{value:new It(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Jt.meshphysical_vert,fragmentShader:Jt.meshphysical_frag},toon:{uniforms:Fs([st.common,st.aomap,st.lightmap,st.emissivemap,st.bumpmap,st.normalmap,st.displacementmap,st.gradientmap,st.fog,st.lights,{emissive:{value:new It(0)}}]),vertexShader:Jt.meshtoon_vert,fragmentShader:Jt.meshtoon_frag},matcap:{uniforms:Fs([st.common,st.bumpmap,st.normalmap,st.displacementmap,st.fog,{matcap:{value:null}}]),vertexShader:Jt.meshmatcap_vert,fragmentShader:Jt.meshmatcap_frag},points:{uniforms:Fs([st.points,st.fog]),vertexShader:Jt.points_vert,fragmentShader:Jt.points_frag},dashed:{uniforms:Fs([st.common,st.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Jt.linedashed_vert,fragmentShader:Jt.linedashed_frag},depth:{uniforms:Fs([st.common,st.displacementmap]),vertexShader:Jt.depth_vert,fragmentShader:Jt.depth_frag},normal:{uniforms:Fs([st.common,st.bumpmap,st.normalmap,st.displacementmap,{opacity:{value:1}}]),vertexShader:Jt.meshnormal_vert,fragmentShader:Jt.meshnormal_frag},sprite:{uniforms:Fs([st.sprite,st.fog]),vertexShader:Jt.sprite_vert,fragmentShader:Jt.sprite_frag},background:{uniforms:{uvTransform:{value:new Zr},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Jt.background_vert,fragmentShader:Jt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Jt.backgroundCube_vert,fragmentShader:Jt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Jt.cube_vert,fragmentShader:Jt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Jt.equirect_vert,fragmentShader:Jt.equirect_frag},distanceRGBA:{uniforms:Fs([st.common,st.displacementmap,{referencePosition:{value:new L},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Jt.distanceRGBA_vert,fragmentShader:Jt.distanceRGBA_frag},shadow:{uniforms:Fs([st.lights,st.fog,{color:{value:new It(0)},opacity:{value:1}}]),vertexShader:Jt.shadow_vert,fragmentShader:Jt.shadow_frag}};bc.physical={uniforms:Fs([bc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new he(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new It(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new he},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new It(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new It(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Jt.meshphysical_vert,fragmentShader:Jt.meshphysical_frag};var fA={r:0,b:0,g:0};function NTe(t,e,i,n,r,s,o){let a=new It(0),l=s===!0?0:1,c,h,u=null,d=0,f=null;function p(v,g){let y=!1,x=g.isScene===!0?g.background:null;x&&x.isTexture&&(x=(g.backgroundBlurriness>0?i:e).get(x));let b=t.xr,S=b.getSession&&b.getSession();S&&S.environmentBlendMode==="additive"&&(x=null),x===null?m(a,l):x&&x.isColor&&(m(x,1),y=!0),(t.autoClear||y)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),x&&(x.isCubeTexture||x.mapping===Iw)?(h===void 0&&(h=new co(new Qc(1,1,1),new $i({name:"BackgroundCubeMaterial",uniforms:U0(bc.backgroundCube.uniforms),vertexShader:bc.backgroundCube.vertexShader,fragmentShader:bc.backgroundCube.fragmentShader,side:kr,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(A,E,M){this.matrixWorld.copyPosition(M.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(h)),h.material.uniforms.envMap.value=x,h.material.uniforms.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,h.material.uniforms.backgroundBlurriness.value=g.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,h.material.toneMapped=x.encoding!==Qt,(u!==x||d!==x.version||f!==t.toneMapping)&&(h.material.needsUpdate=!0,u=x,d=x.version,f=t.toneMapping),h.layers.enableAll(),v.unshift(h,h.geometry,h.material,0,0,null)):x&&x.isTexture&&(c===void 0&&(c=new co(new ZC(2,2),new $i({name:"BackgroundMaterial",uniforms:U0(bc.background.uniforms),vertexShader:bc.background.vertexShader,fragmentShader:bc.background.fragmentShader,side:Hl,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=x,c.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,c.material.toneMapped=x.encoding!==Qt,x.matrixAutoUpdate===!0&&x.updateMatrix(),c.material.uniforms.uvTransform.value.copy(x.matrix),(u!==x||d!==x.version||f!==t.toneMapping)&&(c.material.needsUpdate=!0,u=x,d=x.version,f=t.toneMapping),c.layers.enableAll(),v.unshift(c,c.geometry,c.material,0,0,null))}function m(v,g){v.getRGB(fA,Tee(t)),n.buffers.color.setClear(fA.r,fA.g,fA.b,g,o)}return{getClearColor:function(){return a},setClearColor:function(v,g=1){a.set(v),l=g,m(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(v){l=v,m(a,l)},render:p}}function UTe(t,e,i,n){let r=t.getParameter(34921),s=n.isWebGL2?null:e.get("OES_vertex_array_object"),o=n.isWebGL2||s!==null,a={},l=v(null),c=l,h=!1;function u(N,W,Q,X,B){let j=!1;if(o){let z=m(X,Q,W);c!==z&&(c=z,f(c.object)),j=g(N,X,Q,B),j&&y(N,X,Q,B)}else{let z=W.wireframe===!0;(c.geometry!==X.id||c.program!==Q.id||c.wireframe!==z)&&(c.geometry=X.id,c.program=Q.id,c.wireframe=z,j=!0)}B!==null&&i.update(B,34963),(j||h)&&(h=!1,M(N,W,Q,X),B!==null&&t.bindBuffer(34963,i.get(B).buffer))}function d(){return n.isWebGL2?t.createVertexArray():s.createVertexArrayOES()}function f(N){return n.isWebGL2?t.bindVertexArray(N):s.bindVertexArrayOES(N)}function p(N){return n.isWebGL2?t.deleteVertexArray(N):s.deleteVertexArrayOES(N)}function m(N,W,Q){let X=Q.wireframe===!0,B=a[N.id];B===void 0&&(B={},a[N.id]=B);let j=B[W.id];j===void 0&&(j={},B[W.id]=j);let z=j[X];return z===void 0&&(z=v(d()),j[X]=z),z}function v(N){let W=[],Q=[],X=[];for(let B=0;B<r;B++)W[B]=0,Q[B]=0,X[B]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:W,enabledAttributes:Q,attributeDivisors:X,object:N,attributes:{},index:null}}function g(N,W,Q,X){let B=c.attributes,j=W.attributes,z=0,k=Q.getAttributes();for(let G in k)if(k[G].location>=0){let Z=B[G],K=j[G];if(K===void 0&&(G==="instanceMatrix"&&N.instanceMatrix&&(K=N.instanceMatrix),G==="instanceColor"&&N.instanceColor&&(K=N.instanceColor)),Z===void 0||Z.attribute!==K||K&&Z.data!==K.data)return!0;z++}return c.attributesNum!==z||c.index!==X}function y(N,W,Q,X){let B={},j=W.attributes,z=0,k=Q.getAttributes();for(let G in k)if(k[G].location>=0){let Z=j[G];Z===void 0&&(G==="instanceMatrix"&&N.instanceMatrix&&(Z=N.instanceMatrix),G==="instanceColor"&&N.instanceColor&&(Z=N.instanceColor));let K={};K.attribute=Z,Z&&Z.data&&(K.data=Z.data),B[G]=K,z++}c.attributes=B,c.attributesNum=z,c.index=X}function x(){let N=c.newAttributes;for(let W=0,Q=N.length;W<Q;W++)N[W]=0}function b(N){S(N,0)}function S(N,W){let Q=c.newAttributes,X=c.enabledAttributes,B=c.attributeDivisors;Q[N]=1,X[N]===0&&(t.enableVertexAttribArray(N),X[N]=1),B[N]!==W&&((n.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](N,W),B[N]=W)}function A(){let N=c.newAttributes,W=c.enabledAttributes;for(let Q=0,X=W.length;Q<X;Q++)W[Q]!==N[Q]&&(t.disableVertexAttribArray(Q),W[Q]=0)}function E(N,W,Q,X,B,j){n.isWebGL2===!0&&(Q===5124||Q===5125)?t.vertexAttribIPointer(N,W,Q,B,j):t.vertexAttribPointer(N,W,Q,X,B,j)}function M(N,W,Q,X){if(n.isWebGL2===!1&&(N.isInstancedMesh||X.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;x();let B=X.attributes,j=Q.getAttributes(),z=W.defaultAttributeValues;for(let k in j){let G=j[k];if(G.location>=0){let Z=B[k];if(Z===void 0&&(k==="instanceMatrix"&&N.instanceMatrix&&(Z=N.instanceMatrix),k==="instanceColor"&&N.instanceColor&&(Z=N.instanceColor)),Z!==void 0){let K=Z.normalized,re=Z.itemSize,J=i.get(Z);if(J===void 0)continue;let le=J.buffer,ae=J.type,fe=J.bytesPerElement;if(Z.isInterleavedBufferAttribute){let ge=Z.data,ve=ge.stride,Y=Z.offset;if(ge.isInstancedInterleavedBuffer){for(let ce=0;ce<G.locationSize;ce++)S(G.location+ce,ge.meshPerAttribute);N.isInstancedMesh!==!0&&X._maxInstanceCount===void 0&&(X._maxInstanceCount=ge.meshPerAttribute*ge.count)}else for(let ce=0;ce<G.locationSize;ce++)b(G.location+ce);t.bindBuffer(34962,le);for(let ce=0;ce<G.locationSize;ce++)E(G.location+ce,re/G.locationSize,ae,K,ve*fe,(Y+re/G.locationSize*ce)*fe)}else{if(Z.isInstancedBufferAttribute){for(let ge=0;ge<G.locationSize;ge++)S(G.location+ge,Z.meshPerAttribute);N.isInstancedMesh!==!0&&X._maxInstanceCount===void 0&&(X._maxInstanceCount=Z.meshPerAttribute*Z.count)}else for(let ge=0;ge<G.locationSize;ge++)b(G.location+ge);t.bindBuffer(34962,le);for(let ge=0;ge<G.locationSize;ge++)E(G.location+ge,re/G.locationSize,ae,K,re*fe,re/G.locationSize*ge*fe)}}else if(z!==void 0){let K=z[k];if(K!==void 0)switch(K.length){case 2:t.vertexAttrib2fv(G.location,K);break;case 3:t.vertexAttrib3fv(G.location,K);break;case 4:t.vertexAttrib4fv(G.location,K);break;default:t.vertexAttrib1fv(G.location,K)}}}}A()}function T(){U();for(let N in a){let W=a[N];for(let Q in W){let X=W[Q];for(let B in X)p(X[B].object),delete X[B];delete W[Q]}delete a[N]}}function P(N){if(a[N.id]===void 0)return;let W=a[N.id];for(let Q in W){let X=W[Q];for(let B in X)p(X[B].object),delete X[B];delete W[Q]}delete a[N.id]}function R(N){for(let W in a){let Q=a[W];if(Q[N.id]===void 0)continue;let X=Q[N.id];for(let B in X)p(X[B].object),delete X[B];delete Q[N.id]}}function U(){F(),h=!0,c!==l&&(c=l,f(c.object))}function F(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:u,reset:U,resetDefaultState:F,dispose:T,releaseStatesOfGeometry:P,releaseStatesOfProgram:R,initAttributes:x,enableAttribute:b,disableUnusedAttributes:A}}function kTe(t,e,i,n){let r=n.isWebGL2,s;function o(c){s=c}function a(c,h){t.drawArrays(s,c,h),i.update(h,s,1)}function l(c,h,u){if(u===0)return;let d,f;if(r)d=t,f="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[f](s,c,h,u),i.update(h,s,u)}this.setMode=o,this.render=a,this.renderInstances=l}function zTe(t,e,i){let n;function r(){if(n!==void 0)return n;if(e.has("EXT_texture_filter_anisotropic")===!0){let E=e.get("EXT_texture_filter_anisotropic");n=t.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n}function s(E){if(E==="highp"){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";E="mediump"}return E==="mediump"&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let o=typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext,a=i.precision!==void 0?i.precision:"highp",l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);let c=o||e.has("WEBGL_draw_buffers"),h=i.logarithmicDepthBuffer===!0,u=t.getParameter(34930),d=t.getParameter(35660),f=t.getParameter(3379),p=t.getParameter(34076),m=t.getParameter(34921),v=t.getParameter(36347),g=t.getParameter(36348),y=t.getParameter(36349),x=d>0,b=o||e.has("OES_texture_float"),S=x&&b,A=o?t.getParameter(36183):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:h,maxTextures:u,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:m,maxVertexUniforms:v,maxVaryings:g,maxFragmentUniforms:y,vertexTextures:x,floatFragmentTextures:b,floatVertexTextures:S,maxSamples:A}}function GTe(t){let e=this,i=null,n=0,r=!1,s=!1,o=new zo,a=new Zr,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(u,d){let f=u.length!==0||d||n!==0||r;return r=d,n=u.length,f},this.beginShadows=function(){s=!0,h(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(u,d){i=h(u,d,0)},this.setState=function(u,d,f){let p=u.clippingPlanes,m=u.clipIntersection,v=u.clipShadows,g=t.get(u);if(!r||p===null||p.length===0||s&&!v)s?h(null):c();else{let y=s?0:n,x=y*4,b=g.clippingState||null;l.value=b,b=h(p,d,x,f);for(let S=0;S!==x;++S)b[S]=i[S];g.clippingState=b,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=y}};function c(){l.value!==i&&(l.value=i,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function h(u,d,f,p){let m=u!==null?u.length:0,v=null;if(m!==0){if(v=l.value,p!==!0||v===null){let g=f+m*4,y=d.matrixWorldInverse;a.getNormalMatrix(y),(v===null||v.length<g)&&(v=new Float32Array(g));for(let x=0,b=f;x!==m;++x,b+=4)o.copy(u[x]).applyMatrix4(y,a),o.normal.toArray(v,b),v[b+3]=o.constant}l.value=v,l.needsUpdate=!0}return e.numPlanes=m,e.numIntersection=0,v}}function HTe(t){let e=new WeakMap;function i(o,a){return a===BB?o.mapping=sm:a===OB&&(o.mapping=om),o}function n(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){let a=o.mapping;if(a===BB||a===OB)if(e.has(o)){let l=e.get(o).texture;return i(l,o.mapping)}else{let l=o.image;if(l&&l.height>0){let c=new tMe(l.height/2);return c.fromEquirectangularTexture(t,o),e.set(o,c),o.addEventListener("dispose",r),i(c.texture,o.mapping)}else return null}}return o}function r(o){let a=o.target;a.removeEventListener("dispose",r);let l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}var hk=class extends uy{constructor(t=-1,e=1,i=1,n=-1,r=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=i,this.bottom=n,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,e,i,n,r,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2,r=i-t,s=i+t,o=n+e,a=n-e;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=l*this.view.offsetX,s=r+l*this.view.width,o-=c*this.view.offsetY,a=o-c*this.view.height}this.projectionMatrix.makeOrthographic(r,s,o,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){let e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=Object.assign({},this.view)),e}},Mv=4,tW=[.125,.215,.35,.446,.526,.582],ap=20,qR=new hk,iW=new It,YR=null,tp=(1+Math.sqrt(5))/2,Cg=1/tp,nW=[new L(1,1,1),new L(-1,1,1),new L(1,1,-1),new L(-1,1,-1),new L(0,tp,Cg),new L(0,tp,-Cg),new L(Cg,0,tp),new L(-Cg,0,tp),new L(tp,Cg,0),new L(-tp,Cg,0)],rW=class{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,i=.1,n=100){YR=this._renderer.getRenderTarget(),this._setSize(256);let r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(t,i,n,r),e>0&&this._blur(r,0,0,e),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=aW(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=oW(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(YR),t.scissorTest=!1,pA(t,0,0,t.width,t.height)}_fromTexture(t,e){t.mapping===sm||t.mapping===om?this._setSize(t.image.length===0?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),YR=this._renderer.getRenderTarget();let i=e||this._allocateTargets();return this._textureToCubeUV(t,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){let t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,i={magFilter:ri,minFilter:ri,generateMipmaps:!1,type:N0,format:za,encoding:Yc,depthBuffer:!1},n=sW(t,e,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==e){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=sW(t,e,i);let{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=VTe(r)),this._blurMaterial=jTe(r,t,e)}return n}_compileMaterial(t){let e=new co(this._lodPlanes[0],t);this._renderer.compile(e,qR)}_sceneToCubeUV(t,e,i,n){let r=new vs(90,1,e,i),s=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],a=this._renderer,l=a.autoClear,c=a.toneMapping;a.getClearColor(iW),a.toneMapping=ih,a.autoClear=!1;let h=new ly({name:"PMREM.Background",side:kr,depthWrite:!1,depthTest:!1}),u=new co(new Qc,h),d=!1,f=t.background;f?f.isColor&&(h.color.copy(f),t.background=null,d=!0):(h.color.copy(iW),d=!0);for(let p=0;p<6;p++){let m=p%3;m===0?(r.up.set(0,s[p],0),r.lookAt(o[p],0,0)):m===1?(r.up.set(0,0,s[p]),r.lookAt(0,o[p],0)):(r.up.set(0,s[p],0),r.lookAt(0,0,o[p]));let v=this._cubeSize;pA(n,m*v,p>2?v:0,v,v),a.setRenderTarget(n),d&&a.render(u,r),a.render(t,r)}u.geometry.dispose(),u.material.dispose(),a.toneMapping=c,a.autoClear=l,t.background=f}_textureToCubeUV(t,e){let i=this._renderer,n=t.mapping===sm||t.mapping===om;n?(this._cubemapMaterial===null&&(this._cubemapMaterial=aW()),this._cubemapMaterial.uniforms.flipEnvMap.value=t.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=oW());let r=n?this._cubemapMaterial:this._equirectMaterial,s=new co(this._lodPlanes[0],r),o=r.uniforms;o.envMap.value=t;let a=this._cubeSize;pA(e,0,0,3*a,2*a),i.setRenderTarget(e),i.render(s,qR)}_applyPMREM(t){let e=this._renderer,i=e.autoClear;e.autoClear=!1;for(let n=1;n<this._lodPlanes.length;n++){let r=Math.sqrt(this._sigmas[n]*this._sigmas[n]-this._sigmas[n-1]*this._sigmas[n-1]),s=nW[(n-1)%nW.length];this._blur(t,n-1,n,r,s)}e.autoClear=i}_blur(t,e,i,n,r){let s=this._pingPongRenderTarget;this._halfBlur(t,s,e,i,n,"latitudinal",r),this._halfBlur(s,t,i,i,n,"longitudinal",r)}_halfBlur(t,e,i,n,r,s,o){let a=this._renderer,l=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let c=3,h=new co(this._lodPlanes[n],l),u=l.uniforms,d=this._sizeLods[i]-1,f=isFinite(r)?Math.PI/(2*d):2*Math.PI/(2*ap-1),p=r/f,m=isFinite(r)?1+Math.floor(c*p):ap;m>ap&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${ap}`);let v=[],g=0;for(let A=0;A<ap;++A){let E=A/p,M=Math.exp(-E*E/2);v.push(M),A===0?g+=M:A<m&&(g+=2*M)}for(let A=0;A<v.length;A++)v[A]=v[A]/g;u.envMap.value=t.texture,u.samples.value=m,u.weights.value=v,u.latitudinal.value=s==="latitudinal",o&&(u.poleAxis.value=o);let{_lodMax:y}=this;u.dTheta.value=f,u.mipInt.value=y-i;let x=this._sizeLods[n],b=3*x*(n>y-Mv?n-y+Mv:0),S=4*(this._cubeSize-x);pA(e,b,S,3*x,2*x),a.setRenderTarget(e),a.render(h,qR)}};function VTe(t){let e=[],i=[],n=[],r=t,s=t-Mv+1+tW.length;for(let o=0;o<s;o++){let a=Math.pow(2,r);i.push(a);let l=1/a;o>t-Mv?l=tW[o-t+Mv-1]:o===0&&(l=0),n.push(l);let c=1/(a-2),h=-c,u=1+c,d=[h,h,u,h,u,u,h,h,u,u,h,u],f=6,p=6,m=3,v=2,g=1,y=new Float32Array(m*p*f),x=new Float32Array(v*p*f),b=new Float32Array(g*p*f);for(let A=0;A<f;A++){let E=A%3*2/3-1,M=A>2?0:-1,T=[E,M,0,E+2/3,M,0,E+2/3,M+1,0,E,M,0,E+2/3,M+1,0,E,M+1,0];y.set(T,m*p*A),x.set(d,v*p*A);let P=[A,A,A,A,A,A];b.set(P,g*p*A)}let S=new Ut;S.setAttribute("position",new Gt(y,m)),S.setAttribute("uv",new Gt(x,v)),S.setAttribute("faceIndex",new Gt(b,g)),e.push(S),r>Mv&&r--}return{lodPlanes:e,sizeLods:i,sigmas:n}}function sW(t,e,i){let n=new Hi(t,e,i);return n.texture.mapping=Iw,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function pA(t,e,i,n,r){t.viewport.set(e,i,n,r),t.scissor.set(e,i,n,r)}function jTe(t,e,i){let n=new Float32Array(ap),r=new L(0,1,0);return new $i({name:"SphericalGaussianBlur",defines:{n:ap,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:dk(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:fr,depthTest:!1,depthWrite:!1})}function oW(){return new $i({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:dk(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:fr,depthTest:!1,depthWrite:!1})}function aW(){return new $i({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:dk(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:fr,depthTest:!1,depthWrite:!1})}function dk(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function WTe(t){let e=new WeakMap,i=null;function n(a){if(a&&a.isTexture){let l=a.mapping,c=l===BB||l===OB,h=l===sm||l===om;if(c||h)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let u=e.get(a);return i===null&&(i=new rW(t)),u=c?i.fromEquirectangular(a,u):i.fromCubemap(a,u),e.set(a,u),u.texture}else{if(e.has(a))return e.get(a).texture;{let u=a.image;if(c&&u&&u.height>0||h&&u&&r(u)){i===null&&(i=new rW(t));let d=c?i.fromEquirectangular(a):i.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}else return null}}}return a}function r(a){let l=0,c=6;for(let h=0;h<c;h++)a[h]!==void 0&&l++;return l===c}function s(a){let l=a.target;l.removeEventListener("dispose",s);let c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,i!==null&&(i.dispose(),i=null)}return{get:n,dispose:o}}function XTe(t){let e={};function i(n){if(e[n]!==void 0)return e[n];let r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(n)}return e[n]=r,r}return{has:function(n){return i(n)!==null},init:function(n){n.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(n){let r=i(n);return r===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function qTe(t,e,i,n){let r={},s=new WeakMap;function o(u){let d=u.target;d.index!==null&&e.remove(d.index);for(let p in d.attributes)e.remove(d.attributes[p]);d.removeEventListener("dispose",o),delete r[d.id];let f=s.get(d);f&&(e.remove(f),s.delete(d)),n.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,i.memory.geometries--}function a(u,d){return r[d.id]===!0||(d.addEventListener("dispose",o),r[d.id]=!0,i.memory.geometries++),d}function l(u){let d=u.attributes;for(let p in d)e.update(d[p],34962);let f=u.morphAttributes;for(let p in f){let m=f[p];for(let v=0,g=m.length;v<g;v++)e.update(m[v],34962)}}function c(u){let d=[],f=u.index,p=u.attributes.position,m=0;if(f!==null){let y=f.array;m=f.version;for(let x=0,b=y.length;x<b;x+=3){let S=y[x+0],A=y[x+1],E=y[x+2];d.push(S,A,A,E,E,S)}}else{let y=p.array;m=p.version;for(let x=0,b=y.length/3-1;x<b;x+=3){let S=x+0,A=x+1,E=x+2;d.push(S,A,A,E,E,S)}}let v=new(wee(d)?Wv:Eee)(d,1);v.version=m;let g=s.get(u);g&&e.remove(g),s.set(u,v)}function h(u){let d=s.get(u);if(d){let f=u.index;f!==null&&d.version<f.version&&c(u)}else c(u);return s.get(u)}return{get:a,update:l,getWireframeAttribute:h}}function YTe(t,e,i,n){let r=n.isWebGL2,s;function o(d){s=d}let a,l;function c(d){a=d.type,l=d.bytesPerElement}function h(d,f){t.drawElements(s,f,a,d*l),i.update(f,s,1)}function u(d,f,p){if(p===0)return;let m,v;if(r)m=t,v="drawElementsInstanced";else if(m=e.get("ANGLE_instanced_arrays"),v="drawElementsInstancedANGLE",m===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[v](s,f,a,d*l,p),i.update(f,s,p)}this.setMode=o,this.setIndex=c,this.render=h,this.renderInstances=u}function QTe(t){let e={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,o,a){switch(i.calls++,o){case 4:i.triangles+=a*(s/3);break;case 1:i.lines+=a*(s/2);break;case 3:i.lines+=a*(s-1);break;case 2:i.lines+=a*s;break;case 0:i.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){i.frame++,i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:e,render:i,programs:null,autoReset:!0,reset:r,update:n}}function KTe(t,e){return t[0]-e[0]}function JTe(t,e){return Math.abs(e[1])-Math.abs(t[1])}function ZTe(t,e,i){let n={},r=new Float32Array(8),s=new WeakMap,o=new Kt,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(c,h,u,d){let f=c.morphTargetInfluences;if(e.isWebGL2===!0){let p=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,m=p!==void 0?p.length:0,v=s.get(h);if(v===void 0||v.count!==m){let x=function(){N.dispose(),s.delete(h),h.removeEventListener("dispose",x)};v!==void 0&&v.texture.dispose();let b=h.morphAttributes.position!==void 0,S=h.morphAttributes.normal!==void 0,A=h.morphAttributes.color!==void 0,E=h.morphAttributes.position||[],M=h.morphAttributes.normal||[],T=h.morphAttributes.color||[],P=0;b===!0&&(P=1),S===!0&&(P=2),A===!0&&(P=3);let R=h.attributes.position.count*P,U=1;R>e.maxTextureSize&&(U=Math.ceil(R/e.maxTextureSize),R=e.maxTextureSize);let F=new Float32Array(R*U*4*m),N=new Mee(F,R,U,m);N.type=Xo,N.needsUpdate=!0;let W=P*4;for(let Q=0;Q<m;Q++){let X=E[Q],B=M[Q],j=T[Q],z=R*U*4*Q;for(let k=0;k<X.count;k++){let G=k*W;b===!0&&(o.fromBufferAttribute(X,k),F[z+G+0]=o.x,F[z+G+1]=o.y,F[z+G+2]=o.z,F[z+G+3]=0),S===!0&&(o.fromBufferAttribute(B,k),F[z+G+4]=o.x,F[z+G+5]=o.y,F[z+G+6]=o.z,F[z+G+7]=0),A===!0&&(o.fromBufferAttribute(j,k),F[z+G+8]=o.x,F[z+G+9]=o.y,F[z+G+10]=o.z,F[z+G+11]=j.itemSize===4?o.w:1)}}v={count:m,texture:N,size:new he(R,U)},s.set(h,v),h.addEventListener("dispose",x)}let g=0;for(let x=0;x<f.length;x++)g+=f[x];let y=h.morphTargetsRelative?1:1-g;d.getUniforms().setValue(t,"morphTargetBaseInfluence",y),d.getUniforms().setValue(t,"morphTargetInfluences",f),d.getUniforms().setValue(t,"morphTargetsTexture",v.texture,i),d.getUniforms().setValue(t,"morphTargetsTextureSize",v.size)}else{let p=f===void 0?0:f.length,m=n[h.id];if(m===void 0||m.length!==p){m=[];for(let b=0;b<p;b++)m[b]=[b,0];n[h.id]=m}for(let b=0;b<p;b++){let S=m[b];S[0]=b,S[1]=f[b]}m.sort(JTe);for(let b=0;b<8;b++)b<p&&m[b][1]?(a[b][0]=m[b][0],a[b][1]=m[b][1]):(a[b][0]=Number.MAX_SAFE_INTEGER,a[b][1]=0);a.sort(KTe);let v=h.morphAttributes.position,g=h.morphAttributes.normal,y=0;for(let b=0;b<8;b++){let S=a[b],A=S[0],E=S[1];A!==Number.MAX_SAFE_INTEGER&&E?(v&&h.getAttribute("morphTarget"+b)!==v[A]&&h.setAttribute("morphTarget"+b,v[A]),g&&h.getAttribute("morphNormal"+b)!==g[A]&&h.setAttribute("morphNormal"+b,g[A]),r[b]=E,y+=E):(v&&h.hasAttribute("morphTarget"+b)===!0&&h.deleteAttribute("morphTarget"+b),g&&h.hasAttribute("morphNormal"+b)===!0&&h.deleteAttribute("morphNormal"+b),r[b]=0)}let x=h.morphTargetsRelative?1:1-y;d.getUniforms().setValue(t,"morphTargetBaseInfluence",x),d.getUniforms().setValue(t,"morphTargetInfluences",r)}}return{update:l}}function $Te(t,e,i,n){let r=new WeakMap;function s(l){let c=n.render.frame,h=l.geometry,u=e.get(l,h);return r.get(u)!==c&&(e.update(u),r.set(u,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),i.update(l.instanceMatrix,34962),l.instanceColor!==null&&i.update(l.instanceColor,34962)),u}function o(){r=new WeakMap}function a(l){let c=l.target;c.removeEventListener("dispose",a),i.remove(c.instanceMatrix),c.instanceColor!==null&&i.remove(c.instanceColor)}return{update:s,dispose:o}}var Pee=new br,Dee=new Mee,Ree=new kAe,Iee=new ck,lW=[],cW=[],uW=new Float32Array(16),hW=new Float32Array(9),dW=new Float32Array(4);function hy(t,e,i){let n=t[0];if(n<=0||n>0)return t;let r=e*i,s=lW[r];if(s===void 0&&(s=new Float32Array(r),lW[r]=s),e!==0){n.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=i,t[o].toArray(s,a)}return s}function Mr(t,e){if(t.length!==e.length)return!1;for(let i=0,n=t.length;i<n;i++)if(t[i]!==e[i])return!1;return!0}function Er(t,e){for(let i=0,n=e.length;i<n;i++)t[i]=e[i]}function $C(t,e){let i=cW[e];i===void 0&&(i=new Int32Array(e),cW[e]=i);for(let n=0;n!==e;++n)i[n]=t.allocateTextureUnit();return i}function eCe(t,e){let i=this.cache;i[0]!==e&&(t.uniform1f(this.addr,e),i[0]=e)}function tCe(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(Mr(i,e))return;t.uniform2fv(this.addr,e),Er(i,e)}}function iCe(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else if(e.r!==void 0)(i[0]!==e.r||i[1]!==e.g||i[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b);else{if(Mr(i,e))return;t.uniform3fv(this.addr,e),Er(i,e)}}function nCe(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(Mr(i,e))return;t.uniform4fv(this.addr,e),Er(i,e)}}function rCe(t,e){let i=this.cache,n=e.elements;if(n===void 0){if(Mr(i,e))return;t.uniformMatrix2fv(this.addr,!1,e),Er(i,e)}else{if(Mr(i,n))return;dW.set(n),t.uniformMatrix2fv(this.addr,!1,dW),Er(i,n)}}function sCe(t,e){let i=this.cache,n=e.elements;if(n===void 0){if(Mr(i,e))return;t.uniformMatrix3fv(this.addr,!1,e),Er(i,e)}else{if(Mr(i,n))return;hW.set(n),t.uniformMatrix3fv(this.addr,!1,hW),Er(i,n)}}function oCe(t,e){let i=this.cache,n=e.elements;if(n===void 0){if(Mr(i,e))return;t.uniformMatrix4fv(this.addr,!1,e),Er(i,e)}else{if(Mr(i,n))return;uW.set(n),t.uniformMatrix4fv(this.addr,!1,uW),Er(i,n)}}function aCe(t,e){let i=this.cache;i[0]!==e&&(t.uniform1i(this.addr,e),i[0]=e)}function lCe(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(Mr(i,e))return;t.uniform2iv(this.addr,e),Er(i,e)}}function cCe(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(Mr(i,e))return;t.uniform3iv(this.addr,e),Er(i,e)}}function uCe(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(Mr(i,e))return;t.uniform4iv(this.addr,e),Er(i,e)}}function hCe(t,e){let i=this.cache;i[0]!==e&&(t.uniform1ui(this.addr,e),i[0]=e)}function dCe(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(Mr(i,e))return;t.uniform2uiv(this.addr,e),Er(i,e)}}function fCe(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(Mr(i,e))return;t.uniform3uiv(this.addr,e),Er(i,e)}}function pCe(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(Mr(i,e))return;t.uniform4uiv(this.addr,e),Er(i,e)}}function mCe(t,e,i){let n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture2D(e||Pee,r)}function gCe(t,e,i){let n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture3D(e||Ree,r)}function vCe(t,e,i){let n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTextureCube(e||Iee,r)}function yCe(t,e,i){let n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture2DArray(e||Dee,r)}function xCe(t){switch(t){case 5126:return eCe;case 35664:return tCe;case 35665:return iCe;case 35666:return nCe;case 35674:return rCe;case 35675:return sCe;case 35676:return oCe;case 5124:case 35670:return aCe;case 35667:case 35671:return lCe;case 35668:case 35672:return cCe;case 35669:case 35673:return uCe;case 5125:return hCe;case 36294:return dCe;case 36295:return fCe;case 36296:return pCe;case 35678:case 36198:case 36298:case 36306:case 35682:return mCe;case 35679:case 36299:case 36307:return gCe;case 35680:case 36300:case 36308:case 36293:return vCe;case 36289:case 36303:case 36311:case 36292:return yCe}}function _Ce(t,e){t.uniform1fv(this.addr,e)}function wCe(t,e){let i=hy(e,this.size,2);t.uniform2fv(this.addr,i)}function bCe(t,e){let i=hy(e,this.size,3);t.uniform3fv(this.addr,i)}function SCe(t,e){let i=hy(e,this.size,4);t.uniform4fv(this.addr,i)}function ACe(t,e){let i=hy(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,i)}function MCe(t,e){let i=hy(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,i)}function ECe(t,e){let i=hy(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,i)}function TCe(t,e){t.uniform1iv(this.addr,e)}function CCe(t,e){t.uniform2iv(this.addr,e)}function PCe(t,e){t.uniform3iv(this.addr,e)}function DCe(t,e){t.uniform4iv(this.addr,e)}function RCe(t,e){t.uniform1uiv(this.addr,e)}function ICe(t,e){t.uniform2uiv(this.addr,e)}function LCe(t,e){t.uniform3uiv(this.addr,e)}function BCe(t,e){t.uniform4uiv(this.addr,e)}function OCe(t,e,i){let n=this.cache,r=e.length,s=$C(i,r);Mr(n,s)||(t.uniform1iv(this.addr,s),Er(n,s));for(let o=0;o!==r;++o)i.setTexture2D(e[o]||Pee,s[o])}function FCe(t,e,i){let n=this.cache,r=e.length,s=$C(i,r);Mr(n,s)||(t.uniform1iv(this.addr,s),Er(n,s));for(let o=0;o!==r;++o)i.setTexture3D(e[o]||Ree,s[o])}function NCe(t,e,i){let n=this.cache,r=e.length,s=$C(i,r);Mr(n,s)||(t.uniform1iv(this.addr,s),Er(n,s));for(let o=0;o!==r;++o)i.setTextureCube(e[o]||Iee,s[o])}function UCe(t,e,i){let n=this.cache,r=e.length,s=$C(i,r);Mr(n,s)||(t.uniform1iv(this.addr,s),Er(n,s));for(let o=0;o!==r;++o)i.setTexture2DArray(e[o]||Dee,s[o])}function kCe(t){switch(t){case 5126:return _Ce;case 35664:return wCe;case 35665:return bCe;case 35666:return SCe;case 35674:return ACe;case 35675:return MCe;case 35676:return ECe;case 5124:case 35670:return TCe;case 35667:case 35671:return CCe;case 35668:case 35672:return PCe;case 35669:case 35673:return DCe;case 5125:return RCe;case 36294:return ICe;case 36295:return LCe;case 36296:return BCe;case 35678:case 36198:case 36298:case 36306:case 35682:return OCe;case 35679:case 36299:case 36307:return FCe;case 35680:case 36300:case 36308:case 36293:return NCe;case 36289:case 36303:case 36311:case 36292:return UCe}}var zCe=class{constructor(t,e,i){this.id=t,this.addr=i,this.cache=[],this.setValue=xCe(e.type)}},GCe=class{constructor(t,e,i){this.id=t,this.addr=i,this.cache=[],this.size=e.size,this.setValue=kCe(e.type)}},HCe=class{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,e,i){let n=this.seq;for(let r=0,s=n.length;r!==s;++r){let o=n[r];o.setValue(t,e[o.id],i)}}},QR=/(\w+)(\])?(\[|\.)?/g;function fW(t,e){t.seq.push(e),t.map[e.id]=e}function VCe(t,e,i){let n=t.name,r=n.length;for(QR.lastIndex=0;;){let s=QR.exec(n),o=QR.lastIndex,a=s[1],l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===r){fW(i,c===void 0?new zCe(a,t,e):new GCe(a,t,e));break}else{let h=i.map[a];h===void 0&&(h=new HCe(a),fW(i,h)),i=h}}}var HM=class{constructor(t,e){this.seq=[],this.map={};let i=t.getProgramParameter(e,35718);for(let n=0;n<i;++n){let r=t.getActiveUniform(e,n),s=t.getUniformLocation(e,r.name);VCe(r,s,this)}}setValue(t,e,i,n){let r=this.map[e];r!==void 0&&r.setValue(t,i,n)}setOptional(t,e,i){let n=e[i];n!==void 0&&this.setValue(t,i,n)}static upload(t,e,i,n){for(let r=0,s=e.length;r!==s;++r){let o=e[r],a=i[o.id];a.needsUpdate!==!1&&o.setValue(t,a.value,n)}}static seqWithValue(t,e){let i=[];for(let n=0,r=t.length;n!==r;++n){let s=t[n];s.id in e&&i.push(s)}return i}};function pW(t,e,i){let n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),n}var jCe=0;function WCe(t,e){let i=t.split(`
`),n=[],r=Math.max(e-6,0),s=Math.min(e+6,i.length);for(let o=r;o<s;o++){let a=o+1;n.push(`${a===e?">":" "} ${a}: ${i[o]}`)}return n.join(`
`)}function XCe(t){switch(t){case Yc:return["Linear","( value )"];case Qt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function mW(t,e,i){let n=t.getShaderParameter(e,35713),r=t.getShaderInfoLog(e).trim();if(n&&r==="")return"";let s=/ERROR: 0:(\d+)/.exec(r);if(s){let o=parseInt(s[1]);return i.toUpperCase()+`

`+r+`

`+WCe(t.getShaderSource(e),o)}else return r}function qCe(t,e){let i=XCe(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function YCe(t,e){let i;switch(e){case eAe:i="Linear";break;case tAe:i="Reinhard";break;case iAe:i="OptimizedCineon";break;case nAe:i="ACESFilmic";break;case rAe:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),i="Linear"}return"vec3 "+t+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function QCe(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||t.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(o1).join(`
`)}function KCe(t){let e=[];for(let i in t){let n=t[i];n!==!1&&e.push("#define "+i+" "+n)}return e.join(`
`)}function JCe(t,e){let i={},n=t.getProgramParameter(e,35721);for(let r=0;r<n;r++){let s=t.getActiveAttrib(e,r),o=s.name,a=1;s.type===35674&&(a=2),s.type===35675&&(a=3),s.type===35676&&(a=4),i[o]={type:s.type,location:t.getAttribLocation(e,o),locationSize:a}}return i}function o1(t){return t!==""}function gW(t,e){let i=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function vW(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var ZCe=/^[ \t]*#include +<([\w\d./]+)>/gm;function zB(t){return t.replace(ZCe,$Ce)}function $Ce(t,e){let i=Jt[e];if(i===void 0)throw new Error("Can not resolve #include <"+e+">");return zB(i)}var e2e=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function yW(t){return t.replace(e2e,t2e)}function t2e(t,e,i,n){let r="";for(let s=parseInt(e);s<parseInt(i);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function xW(t){let e="precision "+t.precision+` float;
precision `+t.precision+" int;";return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function i2e(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===rk?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===ISe?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===s1&&(e="SHADOWMAP_TYPE_VSM"),e}function n2e(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case sm:case om:e="ENVMAP_TYPE_CUBE";break;case Iw:e="ENVMAP_TYPE_CUBE_UV";break}return e}function r2e(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case om:e="ENVMAP_MODE_REFRACTION";break}return e}function s2e(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case fee:e="ENVMAP_BLENDING_MULTIPLY";break;case ZSe:e="ENVMAP_BLENDING_MIX";break;case $Se:e="ENVMAP_BLENDING_ADD";break}return e}function o2e(t){let e=t.envMapCubeUVHeight;if(e===null)return null;let i=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,i),7*16)),texelHeight:n,maxMip:i}}function a2e(t,e,i,n){let r=t.getContext(),s=i.defines,o=i.vertexShader,a=i.fragmentShader,l=i2e(i),c=n2e(i),h=r2e(i),u=s2e(i),d=o2e(i),f=i.isWebGL2?"":QCe(i),p=KCe(s),m=r.createProgram(),v,g,y=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(v=[p].filter(o1).join(`
`),v.length>0&&(v+=`
`),g=[f,p].filter(o1).join(`
`),g.length>0&&(g+=`
`)):(v=[xW(i),"#define SHADER_NAME "+i.shaderName,p,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+h:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.morphColors&&i.isWebGL2?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(o1).join(`
`),g=[f,xW(i),"#define SHADER_NAME "+i.shaderName,p,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+c:"",i.envMap?"#define "+h:"",i.envMap?"#define "+u:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==ih?"#define TONE_MAPPING":"",i.toneMapping!==ih?Jt.tonemapping_pars_fragment:"",i.toneMapping!==ih?YCe("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",Jt.encodings_pars_fragment,qCe("linearToOutputTexel",i.outputEncoding),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(o1).join(`
`)),o=zB(o),o=gW(o,i),o=vW(o,i),a=zB(a),a=gW(a,i),a=vW(a,i),o=yW(o),a=yW(a),i.isWebGL2&&i.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,v=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+v,g=["#define varying in",i.glslVersion===V6?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===V6?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+g);let x=y+v+o,b=y+g+a,S=pW(r,35633,x),A=pW(r,35632,b);if(r.attachShader(m,S),r.attachShader(m,A),i.index0AttributeName!==void 0?r.bindAttribLocation(m,0,i.index0AttributeName):i.morphTargets===!0&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),t.debug.checkShaderErrors){let T=r.getProgramInfoLog(m).trim(),P=r.getShaderInfoLog(S).trim(),R=r.getShaderInfoLog(A).trim(),U=!0,F=!0;if(r.getProgramParameter(m,35714)===!1){U=!1;let N=mW(r,S,"vertex"),W=mW(r,A,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(m,35715)+`

Program Info Log: `+T+`
`+N+`
`+W)}else T!==""?console.warn("THREE.WebGLProgram: Program Info Log:",T):(P===""||R==="")&&(F=!1);F&&(this.diagnostics={runnable:U,programLog:T,vertexShader:{log:P,prefix:v},fragmentShader:{log:R,prefix:g}})}r.deleteShader(S),r.deleteShader(A);let E;this.getUniforms=function(){return E===void 0&&(E=new HM(r,m)),E};let M;return this.getAttributes=function(){return M===void 0&&(M=JCe(r,m)),M},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.name=i.shaderName,this.id=jCe++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=S,this.fragmentShader=A,this}var l2e=0,c2e=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){let e=t.vertexShader,i=t.fragmentShader,n=this._getShaderStage(e),r=this._getShaderStage(i),s=this._getShaderCacheForMaterial(t);return s.has(n)===!1&&(s.add(n),n.usedTimes++),s.has(r)===!1&&(s.add(r),r.usedTimes++),this}remove(t){let e=this.materialCache.get(t);for(let i of e)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){let e=this.materialCache,i=e.get(t);return i===void 0&&(i=new Set,e.set(t,i)),i}_getShaderStage(t){let e=this.shaderCache,i=e.get(t);return i===void 0&&(i=new u2e(t),e.set(t,i)),i}},u2e=class{constructor(t){this.id=l2e++,this.code=t,this.usedTimes=0}};function h2e(t,e,i,n,r,s,o){let a=new lk,l=new c2e,c=[],h=r.isWebGL2,u=r.logarithmicDepthBuffer,d=r.vertexTextures,f=r.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(M,T,P,R,U){let F=R.fog,N=U.geometry,W=M.isMeshStandardMaterial?R.environment:null,Q=(M.isMeshStandardMaterial?i:e).get(M.envMap||W),X=Q&&Q.mapping===Iw?Q.image.height:null,B=p[M.type];M.precision!==null&&(f=r.getMaxPrecision(M.precision),f!==M.precision&&console.warn("THREE.WebGLProgram.getParameters:",M.precision,"not supported, using",f,"instead."));let j=N.morphAttributes.position||N.morphAttributes.normal||N.morphAttributes.color,z=j!==void 0?j.length:0,k=0;N.morphAttributes.position!==void 0&&(k=1),N.morphAttributes.normal!==void 0&&(k=2),N.morphAttributes.color!==void 0&&(k=3);let G,Z,K,re;if(B){let ge=bc[B];G=ge.vertexShader,Z=ge.fragmentShader}else G=M.vertexShader,Z=M.fragmentShader,l.update(M),K=l.getVertexShaderID(M),re=l.getFragmentShaderID(M);let J=t.getRenderTarget(),le=M.alphaTest>0,ae=M.clearcoat>0,fe=M.iridescence>0;return{isWebGL2:h,shaderID:B,shaderName:M.type,vertexShader:G,fragmentShader:Z,defines:M.defines,customVertexShaderID:K,customFragmentShaderID:re,isRawShaderMaterial:M.isRawShaderMaterial===!0,glslVersion:M.glslVersion,precision:f,instancing:U.isInstancedMesh===!0,instancingColor:U.isInstancedMesh===!0&&U.instanceColor!==null,supportsVertexTextures:d,outputEncoding:J===null?t.outputEncoding:J.isXRRenderTarget===!0?J.texture.encoding:Yc,map:!!M.map,matcap:!!M.matcap,envMap:!!Q,envMapMode:Q&&Q.mapping,envMapCubeUVHeight:X,lightMap:!!M.lightMap,aoMap:!!M.aoMap,emissiveMap:!!M.emissiveMap,bumpMap:!!M.bumpMap,normalMap:!!M.normalMap,objectSpaceNormalMap:M.normalMapType===bAe,tangentSpaceNormalMap:M.normalMapType===wAe,decodeVideoTexture:!!M.map&&M.map.isVideoTexture===!0&&M.map.encoding===Qt,clearcoat:ae,clearcoatMap:ae&&!!M.clearcoatMap,clearcoatRoughnessMap:ae&&!!M.clearcoatRoughnessMap,clearcoatNormalMap:ae&&!!M.clearcoatNormalMap,iridescence:fe,iridescenceMap:fe&&!!M.iridescenceMap,iridescenceThicknessMap:fe&&!!M.iridescenceThicknessMap,displacementMap:!!M.displacementMap,roughnessMap:!!M.roughnessMap,metalnessMap:!!M.metalnessMap,specularMap:!!M.specularMap,specularIntensityMap:!!M.specularIntensityMap,specularColorMap:!!M.specularColorMap,opaque:M.transparent===!1&&M.blending===jv,alphaMap:!!M.alphaMap,alphaTest:le,gradientMap:!!M.gradientMap,sheen:M.sheen>0,sheenColorMap:!!M.sheenColorMap,sheenRoughnessMap:!!M.sheenRoughnessMap,transmission:M.transmission>0,transmissionMap:!!M.transmissionMap,thicknessMap:!!M.thicknessMap,combine:M.combine,vertexTangents:!!M.normalMap&&!!N.attributes.tangent,vertexColors:M.vertexColors,vertexAlphas:M.vertexColors===!0&&!!N.attributes.color&&N.attributes.color.itemSize===4,vertexUvs:!!M.map||!!M.bumpMap||!!M.normalMap||!!M.specularMap||!!M.alphaMap||!!M.emissiveMap||!!M.roughnessMap||!!M.metalnessMap||!!M.clearcoatMap||!!M.clearcoatRoughnessMap||!!M.clearcoatNormalMap||!!M.iridescenceMap||!!M.iridescenceThicknessMap||!!M.displacementMap||!!M.transmissionMap||!!M.thicknessMap||!!M.specularIntensityMap||!!M.specularColorMap||!!M.sheenColorMap||!!M.sheenRoughnessMap,uvsVertexOnly:!(M.map||M.bumpMap||M.normalMap||M.specularMap||M.alphaMap||M.emissiveMap||M.roughnessMap||M.metalnessMap||M.clearcoatNormalMap||M.iridescenceMap||M.iridescenceThicknessMap||M.transmission>0||M.transmissionMap||M.thicknessMap||M.specularIntensityMap||M.specularColorMap||M.sheen>0||M.sheenColorMap||M.sheenRoughnessMap)&&!!M.displacementMap,fog:!!F,useFog:M.fog===!0,fogExp2:F&&F.isFogExp2,flatShading:!!M.flatShading,sizeAttenuation:M.sizeAttenuation,logarithmicDepthBuffer:u,skinning:U.isSkinnedMesh===!0,morphTargets:N.morphAttributes.position!==void 0,morphNormals:N.morphAttributes.normal!==void 0,morphColors:N.morphAttributes.color!==void 0,morphTargetsCount:z,morphTextureStride:k,numDirLights:T.directional.length,numPointLights:T.point.length,numSpotLights:T.spot.length,numSpotLightMaps:T.spotLightMap.length,numRectAreaLights:T.rectArea.length,numHemiLights:T.hemi.length,numDirLightShadows:T.directionalShadowMap.length,numPointLightShadows:T.pointShadowMap.length,numSpotLightShadows:T.spotShadowMap.length,numSpotLightShadowsWithMaps:T.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:M.dithering,shadowMapEnabled:t.shadowMap.enabled&&P.length>0,shadowMapType:t.shadowMap.type,toneMapping:M.toneMapped?t.toneMapping:ih,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:M.premultipliedAlpha,doubleSided:M.side===Wo,flipSided:M.side===kr,useDepthPacking:!!M.depthPacking,depthPacking:M.depthPacking||0,index0AttributeName:M.index0AttributeName,extensionDerivatives:M.extensions&&M.extensions.derivatives,extensionFragDepth:M.extensions&&M.extensions.fragDepth,extensionDrawBuffers:M.extensions&&M.extensions.drawBuffers,extensionShaderTextureLOD:M.extensions&&M.extensions.shaderTextureLOD,rendererExtensionFragDepth:h||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||n.has("EXT_shader_texture_lod"),customProgramCacheKey:M.customProgramCacheKey()}}function v(M){let T=[];if(M.shaderID?T.push(M.shaderID):(T.push(M.customVertexShaderID),T.push(M.customFragmentShaderID)),M.defines!==void 0)for(let P in M.defines)T.push(P),T.push(M.defines[P]);return M.isRawShaderMaterial===!1&&(g(T,M),y(T,M),T.push(t.outputEncoding)),T.push(M.customProgramCacheKey),T.join()}function g(M,T){M.push(T.precision),M.push(T.outputEncoding),M.push(T.envMapMode),M.push(T.envMapCubeUVHeight),M.push(T.combine),M.push(T.vertexUvs),M.push(T.fogExp2),M.push(T.sizeAttenuation),M.push(T.morphTargetsCount),M.push(T.morphAttributeCount),M.push(T.numDirLights),M.push(T.numPointLights),M.push(T.numSpotLights),M.push(T.numSpotLightMaps),M.push(T.numHemiLights),M.push(T.numRectAreaLights),M.push(T.numDirLightShadows),M.push(T.numPointLightShadows),M.push(T.numSpotLightShadows),M.push(T.numSpotLightShadowsWithMaps),M.push(T.shadowMapType),M.push(T.toneMapping),M.push(T.numClippingPlanes),M.push(T.numClipIntersection),M.push(T.depthPacking)}function y(M,T){a.disableAll(),T.isWebGL2&&a.enable(0),T.supportsVertexTextures&&a.enable(1),T.instancing&&a.enable(2),T.instancingColor&&a.enable(3),T.map&&a.enable(4),T.matcap&&a.enable(5),T.envMap&&a.enable(6),T.lightMap&&a.enable(7),T.aoMap&&a.enable(8),T.emissiveMap&&a.enable(9),T.bumpMap&&a.enable(10),T.normalMap&&a.enable(11),T.objectSpaceNormalMap&&a.enable(12),T.tangentSpaceNormalMap&&a.enable(13),T.clearcoat&&a.enable(14),T.clearcoatMap&&a.enable(15),T.clearcoatRoughnessMap&&a.enable(16),T.clearcoatNormalMap&&a.enable(17),T.iridescence&&a.enable(18),T.iridescenceMap&&a.enable(19),T.iridescenceThicknessMap&&a.enable(20),T.displacementMap&&a.enable(21),T.specularMap&&a.enable(22),T.roughnessMap&&a.enable(23),T.metalnessMap&&a.enable(24),T.gradientMap&&a.enable(25),T.alphaMap&&a.enable(26),T.alphaTest&&a.enable(27),T.vertexColors&&a.enable(28),T.vertexAlphas&&a.enable(29),T.vertexUvs&&a.enable(30),T.vertexTangents&&a.enable(31),T.uvsVertexOnly&&a.enable(32),M.push(a.mask),a.disableAll(),T.fog&&a.enable(0),T.useFog&&a.enable(1),T.flatShading&&a.enable(2),T.logarithmicDepthBuffer&&a.enable(3),T.skinning&&a.enable(4),T.morphTargets&&a.enable(5),T.morphNormals&&a.enable(6),T.morphColors&&a.enable(7),T.premultipliedAlpha&&a.enable(8),T.shadowMapEnabled&&a.enable(9),T.physicallyCorrectLights&&a.enable(10),T.doubleSided&&a.enable(11),T.flipSided&&a.enable(12),T.useDepthPacking&&a.enable(13),T.dithering&&a.enable(14),T.specularIntensityMap&&a.enable(15),T.specularColorMap&&a.enable(16),T.transmission&&a.enable(17),T.transmissionMap&&a.enable(18),T.thicknessMap&&a.enable(19),T.sheen&&a.enable(20),T.sheenColorMap&&a.enable(21),T.sheenRoughnessMap&&a.enable(22),T.decodeVideoTexture&&a.enable(23),T.opaque&&a.enable(24),M.push(a.mask)}function x(M){let T=p[M.type],P;if(T){let R=bc[T];P=cy.clone(R.uniforms)}else P=M.uniforms;return P}function b(M,T){let P;for(let R=0,U=c.length;R<U;R++){let F=c[R];if(F.cacheKey===T){P=F,++P.usedTimes;break}}return P===void 0&&(P=new a2e(t,T,M,s),c.push(P)),P}function S(M){if(--M.usedTimes===0){let T=c.indexOf(M);c[T]=c[c.length-1],c.pop(),M.destroy()}}function A(M){l.remove(M)}function E(){l.dispose()}return{getParameters:m,getProgramCacheKey:v,getUniforms:x,acquireProgram:b,releaseProgram:S,releaseShaderCache:A,programs:c,dispose:E}}function d2e(){let t=new WeakMap;function e(s){let o=t.get(s);return o===void 0&&(o={},t.set(s,o)),o}function i(s){t.delete(s)}function n(s,o,a){t.get(s)[o]=a}function r(){t=new WeakMap}return{get:e,remove:i,update:n,dispose:r}}function f2e(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function _W(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function wW(){let t=[],e=0,i=[],n=[],r=[];function s(){e=0,i.length=0,n.length=0,r.length=0}function o(u,d,f,p,m,v){let g=t[e];return g===void 0?(g={id:u.id,object:u,geometry:d,material:f,groupOrder:p,renderOrder:u.renderOrder,z:m,group:v},t[e]=g):(g.id=u.id,g.object=u,g.geometry=d,g.material=f,g.groupOrder=p,g.renderOrder=u.renderOrder,g.z=m,g.group=v),e++,g}function a(u,d,f,p,m,v){let g=o(u,d,f,p,m,v);f.transmission>0?n.push(g):f.transparent===!0?r.push(g):i.push(g)}function l(u,d,f,p,m,v){let g=o(u,d,f,p,m,v);f.transmission>0?n.unshift(g):f.transparent===!0?r.unshift(g):i.unshift(g)}function c(u,d){i.length>1&&i.sort(u||f2e),n.length>1&&n.sort(d||_W),r.length>1&&r.sort(d||_W)}function h(){for(let u=e,d=t.length;u<d;u++){let f=t[u];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:i,transmissive:n,transparent:r,init:s,push:a,unshift:l,finish:h,sort:c}}function p2e(){let t=new WeakMap;function e(n,r){let s=t.get(n),o;return s===void 0?(o=new wW,t.set(n,[o])):r>=s.length?(o=new wW,s.push(o)):o=s[r],o}function i(){t=new WeakMap}return{get:e,dispose:i}}function m2e(){let t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let i;switch(e.type){case"DirectionalLight":i={direction:new L,color:new It};break;case"SpotLight":i={position:new L,direction:new L,color:new It,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new L,color:new It,distance:0,decay:0};break;case"HemisphereLight":i={direction:new L,skyColor:new It,groundColor:new It};break;case"RectAreaLight":i={color:new It,position:new L,halfWidth:new L,halfHeight:new L};break}return t[e.id]=i,i}}}function g2e(){let t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let i;switch(e.type){case"DirectionalLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new he};break;case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new he};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new he,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=i,i}}}var v2e=0;function y2e(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function x2e(t,e){let i=new m2e,n=g2e(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let h=0;h<9;h++)r.probe.push(new L);let s=new L,o=new $e,a=new $e;function l(h,u){let d=0,f=0,p=0;for(let R=0;R<9;R++)r.probe[R].set(0,0,0);let m=0,v=0,g=0,y=0,x=0,b=0,S=0,A=0,E=0,M=0;h.sort(y2e);let T=u!==!0?Math.PI:1;for(let R=0,U=h.length;R<U;R++){let F=h[R],N=F.color,W=F.intensity,Q=F.distance,X=F.shadow&&F.shadow.map?F.shadow.map.texture:null;if(F.isAmbientLight)d+=N.r*W*T,f+=N.g*W*T,p+=N.b*W*T;else if(F.isLightProbe)for(let B=0;B<9;B++)r.probe[B].addScaledVector(F.sh.coefficients[B],W);else if(F.isDirectionalLight){let B=i.get(F);if(B.color.copy(F.color).multiplyScalar(F.intensity*T),F.castShadow){let j=F.shadow,z=n.get(F);z.shadowBias=j.bias,z.shadowNormalBias=j.normalBias,z.shadowRadius=j.radius,z.shadowMapSize=j.mapSize,r.directionalShadow[m]=z,r.directionalShadowMap[m]=X,r.directionalShadowMatrix[m]=F.shadow.matrix,b++}r.directional[m]=B,m++}else if(F.isSpotLight){let B=i.get(F);B.position.setFromMatrixPosition(F.matrixWorld),B.color.copy(N).multiplyScalar(W*T),B.distance=Q,B.coneCos=Math.cos(F.angle),B.penumbraCos=Math.cos(F.angle*(1-F.penumbra)),B.decay=F.decay,r.spot[g]=B;let j=F.shadow;if(F.map&&(r.spotLightMap[E]=F.map,E++,j.updateMatrices(F),F.castShadow&&M++),r.spotLightMatrix[g]=j.matrix,F.castShadow){let z=n.get(F);z.shadowBias=j.bias,z.shadowNormalBias=j.normalBias,z.shadowRadius=j.radius,z.shadowMapSize=j.mapSize,r.spotShadow[g]=z,r.spotShadowMap[g]=X,A++}g++}else if(F.isRectAreaLight){let B=i.get(F);B.color.copy(N).multiplyScalar(W),B.halfWidth.set(F.width*.5,0,0),B.halfHeight.set(0,F.height*.5,0),r.rectArea[y]=B,y++}else if(F.isPointLight){let B=i.get(F);if(B.color.copy(F.color).multiplyScalar(F.intensity*T),B.distance=F.distance,B.decay=F.decay,F.castShadow){let j=F.shadow,z=n.get(F);z.shadowBias=j.bias,z.shadowNormalBias=j.normalBias,z.shadowRadius=j.radius,z.shadowMapSize=j.mapSize,z.shadowCameraNear=j.camera.near,z.shadowCameraFar=j.camera.far,r.pointShadow[v]=z,r.pointShadowMap[v]=X,r.pointShadowMatrix[v]=F.shadow.matrix,S++}r.point[v]=B,v++}else if(F.isHemisphereLight){let B=i.get(F);B.skyColor.copy(F.color).multiplyScalar(W*T),B.groundColor.copy(F.groundColor).multiplyScalar(W*T),r.hemi[x]=B,x++}}y>0&&(e.isWebGL2||t.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=st.LTC_FLOAT_1,r.rectAreaLTC2=st.LTC_FLOAT_2):t.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=st.LTC_HALF_1,r.rectAreaLTC2=st.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=f,r.ambient[2]=p;let P=r.hash;(P.directionalLength!==m||P.pointLength!==v||P.spotLength!==g||P.rectAreaLength!==y||P.hemiLength!==x||P.numDirectionalShadows!==b||P.numPointShadows!==S||P.numSpotShadows!==A||P.numSpotMaps!==E)&&(r.directional.length=m,r.spot.length=g,r.rectArea.length=y,r.point.length=v,r.hemi.length=x,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=S,r.pointShadowMap.length=S,r.spotShadow.length=A,r.spotShadowMap.length=A,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=S,r.spotLightMatrix.length=A+E-M,r.spotLightMap.length=E,r.numSpotLightShadowsWithMaps=M,P.directionalLength=m,P.pointLength=v,P.spotLength=g,P.rectAreaLength=y,P.hemiLength=x,P.numDirectionalShadows=b,P.numPointShadows=S,P.numSpotShadows=A,P.numSpotMaps=E,r.version=v2e++)}function c(h,u){let d=0,f=0,p=0,m=0,v=0,g=u.matrixWorldInverse;for(let y=0,x=h.length;y<x;y++){let b=h[y];if(b.isDirectionalLight){let S=r.directional[d];S.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),S.direction.sub(s),S.direction.transformDirection(g),d++}else if(b.isSpotLight){let S=r.spot[p];S.position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(g),S.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),S.direction.sub(s),S.direction.transformDirection(g),p++}else if(b.isRectAreaLight){let S=r.rectArea[m];S.position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(g),a.identity(),o.copy(b.matrixWorld),o.premultiply(g),a.extractRotation(o),S.halfWidth.set(b.width*.5,0,0),S.halfHeight.set(0,b.height*.5,0),S.halfWidth.applyMatrix4(a),S.halfHeight.applyMatrix4(a),m++}else if(b.isPointLight){let S=r.point[f];S.position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(g),f++}else if(b.isHemisphereLight){let S=r.hemi[v];S.direction.setFromMatrixPosition(b.matrixWorld),S.direction.transformDirection(g),v++}}}return{setup:l,setupView:c,state:r}}function bW(t,e){let i=new x2e(t,e),n=[],r=[];function s(){n.length=0,r.length=0}function o(h){n.push(h)}function a(h){r.push(h)}function l(h){i.setup(n,h)}function c(h){i.setupView(n,h)}return{init:s,state:{lightsArray:n,shadowsArray:r,lights:i},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function _2e(t,e){let i=new WeakMap;function n(s,o=0){let a=i.get(s),l;return a===void 0?(l=new bW(t,e),i.set(s,[l])):o>=a.length?(l=new bW(t,e),a.push(l)):l=a[o],l}function r(){i=new WeakMap}return{get:n,dispose:r}}var Lee=class extends Lw{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=vh,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}},w2e=class extends Lw{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new L,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}},b2e=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,S2e=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function A2e(t,e,i){let n=new uk,r=new he,s=new he,o=new Kt,a=new Lee({depthPacking:xee}),l=new w2e,c={},h=i.maxTextureSize,u={[Hl]:kr,[kr]:Hl,[Wo]:Wo},d=new $i({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new he},radius:{value:4}},vertexShader:b2e,fragmentShader:S2e}),f=d.clone();f.defines.HORIZONTAL_PASS=1;let p=new Ut;p.setAttribute("position",new Gt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let m=new co(p,d),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=rk,this.render=function(b,S,A){if(v.enabled===!1||v.autoUpdate===!1&&v.needsUpdate===!1||b.length===0)return;let E=t.getRenderTarget(),M=t.getActiveCubeFace(),T=t.getActiveMipmapLevel(),P=t.state;P.setBlending(fr),P.buffers.color.setClear(1,1,1,1),P.buffers.depth.setTest(!0),P.setScissorTest(!1);for(let R=0,U=b.length;R<U;R++){let F=b[R],N=F.shadow;if(N===void 0){console.warn("THREE.WebGLShadowMap:",F,"has no shadow.");continue}if(N.autoUpdate===!1&&N.needsUpdate===!1)continue;r.copy(N.mapSize);let W=N.getFrameExtents();if(r.multiply(W),s.copy(N.mapSize),(r.x>h||r.y>h)&&(r.x>h&&(s.x=Math.floor(h/W.x),r.x=s.x*W.x,N.mapSize.x=s.x),r.y>h&&(s.y=Math.floor(h/W.y),r.y=s.y*W.y,N.mapSize.y=s.y)),N.map===null){let X=this.type!==s1?{minFilter:Zi,magFilter:Zi}:{};N.map=new Hi(r.x,r.y,X),N.map.texture.name=F.name+".shadowMap",N.camera.updateProjectionMatrix()}t.setRenderTarget(N.map),t.clear();let Q=N.getViewportCount();for(let X=0;X<Q;X++){let B=N.getViewport(X);o.set(s.x*B.x,s.y*B.y,s.x*B.z,s.y*B.w),P.viewport(o),N.updateMatrices(F,X),n=N.getFrustum(),x(S,A,N.camera,F,this.type)}N.isPointLightShadow!==!0&&this.type===s1&&g(N,A),N.needsUpdate=!1}v.needsUpdate=!1,t.setRenderTarget(E,M,T)};function g(b,S){let A=e.update(m);d.defines.VSM_SAMPLES!==b.blurSamples&&(d.defines.VSM_SAMPLES=b.blurSamples,f.defines.VSM_SAMPLES=b.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),b.mapPass===null&&(b.mapPass=new Hi(r.x,r.y)),d.uniforms.shadow_pass.value=b.map.texture,d.uniforms.resolution.value=b.mapSize,d.uniforms.radius.value=b.radius,t.setRenderTarget(b.mapPass),t.clear(),t.renderBufferDirect(S,null,A,d,m,null),f.uniforms.shadow_pass.value=b.mapPass.texture,f.uniforms.resolution.value=b.mapSize,f.uniforms.radius.value=b.radius,t.setRenderTarget(b.map),t.clear(),t.renderBufferDirect(S,null,A,f,m,null)}function y(b,S,A,E,M,T){let P=null,R=A.isPointLight===!0?b.customDistanceMaterial:b.customDepthMaterial;if(R!==void 0)P=R;else if(P=A.isPointLight===!0?l:a,t.localClippingEnabled&&S.clipShadows===!0&&Array.isArray(S.clippingPlanes)&&S.clippingPlanes.length!==0||S.displacementMap&&S.displacementScale!==0||S.alphaMap&&S.alphaTest>0||S.map&&S.alphaTest>0){let U=P.uuid,F=S.uuid,N=c[U];N===void 0&&(N={},c[U]=N);let W=N[F];W===void 0&&(W=P.clone(),N[F]=W),P=W}return P.visible=S.visible,P.wireframe=S.wireframe,T===s1?P.side=S.shadowSide!==null?S.shadowSide:S.side:P.side=S.shadowSide!==null?S.shadowSide:u[S.side],P.alphaMap=S.alphaMap,P.alphaTest=S.alphaTest,P.map=S.map,P.clipShadows=S.clipShadows,P.clippingPlanes=S.clippingPlanes,P.clipIntersection=S.clipIntersection,P.displacementMap=S.displacementMap,P.displacementScale=S.displacementScale,P.displacementBias=S.displacementBias,P.wireframeLinewidth=S.wireframeLinewidth,P.linewidth=S.linewidth,A.isPointLight===!0&&P.isMeshDistanceMaterial===!0&&(P.referencePosition.setFromMatrixPosition(A.matrixWorld),P.nearDistance=E,P.farDistance=M),P}function x(b,S,A,E,M){if(b.visible===!1)return;if(b.layers.test(S.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&M===s1)&&(!b.frustumCulled||n.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(A.matrixWorldInverse,b.matrixWorld);let P=e.update(b),R=b.material;if(Array.isArray(R)){let U=P.groups;for(let F=0,N=U.length;F<N;F++){let W=U[F],Q=R[W.materialIndex];if(Q&&Q.visible){let X=y(b,Q,E,A.near,A.far,M);t.renderBufferDirect(A,null,P,X,b,W)}}}else if(R.visible){let U=y(b,R,E,A.near,A.far,M);t.renderBufferDirect(A,null,P,U,b,null)}}let T=b.children;for(let P=0,R=T.length;P<R;P++)x(T[P],S,A,E,M)}}function M2e(t,e,i){let n=i.isWebGL2;function r(){let q=!1,pe=new Kt,oe=null,Be=new Kt(0,0,0,0);return{setMask:function(qe){oe!==qe&&!q&&(t.colorMask(qe,qe,qe,qe),oe=qe)},setLocked:function(qe){q=qe},setClear:function(qe,mt,qt,mi,zn){zn===!0&&(qe*=mi,mt*=mi,qt*=mi),pe.set(qe,mt,qt,mi),Be.equals(pe)===!1&&(t.clearColor(qe,mt,qt,mi),Be.copy(pe))},reset:function(){q=!1,oe=null,Be.set(-1,0,0,0)}}}function s(){let q=!1,pe=null,oe=null,Be=null;return{setTest:function(qe){qe?le(2929):ae(2929)},setMask:function(qe){pe!==qe&&!q&&(t.depthMask(qe),pe=qe)},setFunc:function(qe){if(oe!==qe){switch(qe){case WSe:t.depthFunc(512);break;case XSe:t.depthFunc(519);break;case qSe:t.depthFunc(513);break;case LB:t.depthFunc(515);break;case YSe:t.depthFunc(514);break;case QSe:t.depthFunc(518);break;case KSe:t.depthFunc(516);break;case JSe:t.depthFunc(517);break;default:t.depthFunc(515)}oe=qe}},setLocked:function(qe){q=qe},setClear:function(qe){Be!==qe&&(t.clearDepth(qe),Be=qe)},reset:function(){q=!1,pe=null,oe=null,Be=null}}}function o(){let q=!1,pe=null,oe=null,Be=null,qe=null,mt=null,qt=null,mi=null,zn=null;return{setTest:function(kt){q||(kt?le(2960):ae(2960))},setMask:function(kt){pe!==kt&&!q&&(t.stencilMask(kt),pe=kt)},setFunc:function(kt,mn,Li){(oe!==kt||Be!==mn||qe!==Li)&&(t.stencilFunc(kt,mn,Li),oe=kt,Be=mn,qe=Li)},setOp:function(kt,mn,Li){(mt!==kt||qt!==mn||mi!==Li)&&(t.stencilOp(kt,mn,Li),mt=kt,qt=mn,mi=Li)},setLocked:function(kt){q=kt},setClear:function(kt){zn!==kt&&(t.clearStencil(kt),zn=kt)},reset:function(){q=!1,pe=null,oe=null,Be=null,qe=null,mt=null,qt=null,mi=null,zn=null}}}let a=new r,l=new s,c=new o,h=new WeakMap,u=new WeakMap,d={},f={},p=new WeakMap,m=[],v=null,g=!1,y=null,x=null,b=null,S=null,A=null,E=null,M=null,T=!1,P=null,R=null,U=null,F=null,N=null,W=t.getParameter(35661),Q=!1,X=0,B=t.getParameter(7938);B.indexOf("WebGL")!==-1?(X=parseFloat(/^WebGL (\d)/.exec(B)[1]),Q=X>=1):B.indexOf("OpenGL ES")!==-1&&(X=parseFloat(/^OpenGL ES (\d)/.exec(B)[1]),Q=X>=2);let j=null,z={},k=t.getParameter(3088),G=t.getParameter(2978),Z=new Kt().fromArray(k),K=new Kt().fromArray(G);function re(q,pe,oe){let Be=new Uint8Array(4),qe=t.createTexture();t.bindTexture(q,qe),t.texParameteri(q,10241,9728),t.texParameteri(q,10240,9728);for(let mt=0;mt<oe;mt++)t.texImage2D(pe+mt,0,6408,1,1,0,6408,5121,Be);return qe}let J={};J[3553]=re(3553,3553,1),J[34067]=re(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),le(2929),l.setFunc(LB),Ce(!1),Ne(f6),le(2884),de(fr);function le(q){d[q]!==!0&&(t.enable(q),d[q]=!0)}function ae(q){d[q]!==!1&&(t.disable(q),d[q]=!1)}function fe(q,pe){return f[q]!==pe?(t.bindFramebuffer(q,pe),f[q]=pe,n&&(q===36009&&(f[36160]=pe),q===36160&&(f[36009]=pe)),!0):!1}function ge(q,pe){let oe=m,Be=!1;if(q)if(oe=p.get(pe),oe===void 0&&(oe=[],p.set(pe,oe)),q.isWebGLMultipleRenderTargets){let qe=q.texture;if(oe.length!==qe.length||oe[0]!==36064){for(let mt=0,qt=qe.length;mt<qt;mt++)oe[mt]=36064+mt;oe.length=qe.length,Be=!0}}else oe[0]!==36064&&(oe[0]=36064,Be=!0);else oe[0]!==1029&&(oe[0]=1029,Be=!0);Be&&(i.isWebGL2?t.drawBuffers(oe):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(oe))}function ve(q){return v!==q?(t.useProgram(q),v=q,!0):!1}let Y={[Yg]:32774,[BSe]:32778,[OSe]:32779};if(n)Y[v6]=32775,Y[y6]=32776;else{let q=e.get("EXT_blend_minmax");q!==null&&(Y[v6]=q.MIN_EXT,Y[y6]=q.MAX_EXT)}let ce={[FSe]:0,[NSe]:1,[USe]:768,[hee]:770,[jSe]:776,[HSe]:774,[zSe]:772,[kSe]:769,[dee]:771,[VSe]:775,[GSe]:773};function de(q,pe,oe,Be,qe,mt,qt,mi){if(q===fr){g===!0&&(ae(3042),g=!1);return}if(g===!1&&(le(3042),g=!0),q!==LSe){if(q!==y||mi!==T){if((x!==Yg||A!==Yg)&&(t.blendEquation(32774),x=Yg,A=Yg),mi)switch(q){case jv:t.blendFuncSeparate(1,771,1,771);break;case p6:t.blendFunc(1,1);break;case m6:t.blendFuncSeparate(0,769,0,1);break;case g6:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",q);break}else switch(q){case jv:t.blendFuncSeparate(770,771,1,771);break;case p6:t.blendFunc(770,1);break;case m6:t.blendFuncSeparate(0,769,0,1);break;case g6:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",q);break}b=null,S=null,E=null,M=null,y=q,T=mi}return}qe=qe||pe,mt=mt||oe,qt=qt||Be,(pe!==x||qe!==A)&&(t.blendEquationSeparate(Y[pe],Y[qe]),x=pe,A=qe),(oe!==b||Be!==S||mt!==E||qt!==M)&&(t.blendFuncSeparate(ce[oe],ce[Be],ce[mt],ce[qt]),b=oe,S=Be,E=mt,M=qt),y=q,T=!1}function xe(q,pe){q.side===Wo?ae(2884):le(2884);let oe=q.side===kr;pe&&(oe=!oe),Ce(oe),q.blending===jv&&q.transparent===!1?de(fr):de(q.blending,q.blendEquation,q.blendSrc,q.blendDst,q.blendEquationAlpha,q.blendSrcAlpha,q.blendDstAlpha,q.premultipliedAlpha),l.setFunc(q.depthFunc),l.setTest(q.depthTest),l.setMask(q.depthWrite),a.setMask(q.colorWrite);let Be=q.stencilWrite;c.setTest(Be),Be&&(c.setMask(q.stencilWriteMask),c.setFunc(q.stencilFunc,q.stencilRef,q.stencilFuncMask),c.setOp(q.stencilFail,q.stencilZFail,q.stencilZPass)),Ge(q.polygonOffset,q.polygonOffsetFactor,q.polygonOffsetUnits),q.alphaToCoverage===!0?le(32926):ae(32926)}function Ce(q){P!==q&&(q?t.frontFace(2304):t.frontFace(2305),P=q)}function Ne(q){q!==DSe?(le(2884),q!==R&&(q===f6?t.cullFace(1029):q===RSe?t.cullFace(1028):t.cullFace(1032))):ae(2884),R=q}function Ie(q){q!==U&&(Q&&t.lineWidth(q),U=q)}function Ge(q,pe,oe){q?(le(32823),(F!==pe||N!==oe)&&(t.polygonOffset(pe,oe),F=pe,N=oe)):ae(32823)}function tt(q){q?le(3089):ae(3089)}function at(q){q===void 0&&(q=33984+W-1),j!==q&&(t.activeTexture(q),j=q)}function ee(q,pe,oe){oe===void 0&&(j===null?oe=33984+W-1:oe=j);let Be=z[oe];Be===void 0&&(Be={type:void 0,texture:void 0},z[oe]=Be),(Be.type!==q||Be.texture!==pe)&&(j!==oe&&(t.activeTexture(oe),j=oe),t.bindTexture(q,pe||J[q]),Be.type=q,Be.texture=pe)}function O(){let q=z[j];q!==void 0&&q.type!==void 0&&(t.bindTexture(q.type,null),q.type=void 0,q.texture=void 0)}function V(){try{t.compressedTexImage2D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function ue(){try{t.compressedTexImage3D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Ee(){try{t.texSubImage2D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Te(){try{t.texSubImage3D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function We(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Ve(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function me(){try{t.texStorage2D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function be(){try{t.texStorage3D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function ne(){try{t.texImage2D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Ae(){try{t.texImage3D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function ke(q){Z.equals(q)===!1&&(t.scissor(q.x,q.y,q.z,q.w),Z.copy(q))}function Ue(q){K.equals(q)===!1&&(t.viewport(q.x,q.y,q.z,q.w),K.copy(q))}function Je(q,pe){let oe=u.get(pe);oe===void 0&&(oe=new WeakMap,u.set(pe,oe));let Be=oe.get(q);Be===void 0&&(Be=t.getUniformBlockIndex(pe,q.name),oe.set(q,Be))}function ut(q,pe){let oe=u.get(pe).get(q);h.get(pe)!==oe&&(t.uniformBlockBinding(pe,oe,q.__bindingPointIndex),h.set(pe,oe))}function Pt(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.disable(32926),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.bindFramebuffer(36160,null),n===!0&&(t.bindFramebuffer(36009,null),t.bindFramebuffer(36008,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),d={},j=null,z={},f={},p=new WeakMap,m=[],v=null,g=!1,y=null,x=null,b=null,S=null,A=null,E=null,M=null,T=!1,P=null,R=null,U=null,F=null,N=null,Z.set(0,0,t.canvas.width,t.canvas.height),K.set(0,0,t.canvas.width,t.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:le,disable:ae,bindFramebuffer:fe,drawBuffers:ge,useProgram:ve,setBlending:de,setMaterial:xe,setFlipSided:Ce,setCullFace:Ne,setLineWidth:Ie,setPolygonOffset:Ge,setScissorTest:tt,activeTexture:at,bindTexture:ee,unbindTexture:O,compressedTexImage2D:V,compressedTexImage3D:ue,texImage2D:ne,texImage3D:Ae,updateUBOMapping:Je,uniformBlockBinding:ut,texStorage2D:me,texStorage3D:be,texSubImage2D:Ee,texSubImage3D:Te,compressedTexSubImage2D:We,compressedTexSubImage3D:Ve,scissor:ke,viewport:Ue,reset:Pt}}function E2e(t,e,i,n,r,s,o){let a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,h=r.maxTextureSize,u=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap,m,v=new WeakMap,g=!1;try{g=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(ee,O){return g?new OffscreenCanvas(ee,O):eT("canvas")}function x(ee,O,V,ue){let Ee=1;if((ee.width>ue||ee.height>ue)&&(Ee=ue/Math.max(ee.width,ee.height)),Ee<1||O===!0)if(typeof HTMLImageElement<"u"&&ee instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ee instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ee instanceof ImageBitmap){let Te=O?$E:Math.floor,We=Te(Ee*ee.width),Ve=Te(Ee*ee.height);m===void 0&&(m=y(We,Ve));let me=V?y(We,Ve):m;return me.width=We,me.height=Ve,me.getContext("2d").drawImage(ee,0,0,We,Ve),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ee.width+"x"+ee.height+") to ("+We+"x"+Ve+")."),me}else return"data"in ee&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ee.width+"x"+ee.height+")."),ee;return ee}function b(ee){return kB(ee.width)&&kB(ee.height)}function S(ee){return a?!1:ee.wrapS!==Qn||ee.wrapT!==Qn||ee.minFilter!==Zi&&ee.minFilter!==ri}function A(ee,O){return ee.generateMipmaps&&O&&ee.minFilter!==Zi&&ee.minFilter!==ri}function E(ee){t.generateMipmap(ee)}function M(ee,O,V,ue,Ee=!1){if(a===!1)return O;if(ee!==null){if(t[ee]!==void 0)return t[ee];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ee+"'")}let Te=O;return O===6403&&(V===5126&&(Te=33326),V===5131&&(Te=33325),V===5121&&(Te=33321)),O===33319&&(V===5126&&(Te=33328),V===5131&&(Te=33327),V===5121&&(Te=33323)),O===6408&&(V===5126&&(Te=34836),V===5131&&(Te=34842),V===5121&&(Te=ue===Qt&&Ee===!1?35907:32856),V===32819&&(Te=32854),V===32820&&(Te=32855)),(Te===33325||Te===33326||Te===33327||Te===33328||Te===34842||Te===34836)&&e.get("EXT_color_buffer_float"),Te}function T(ee,O,V){return A(ee,V)===!0||ee.isFramebufferTexture&&ee.minFilter!==Zi&&ee.minFilter!==ri?Math.log2(Math.max(O.width,O.height))+1:ee.mipmaps!==void 0&&ee.mipmaps.length>0?ee.mipmaps.length:ee.isCompressedTexture&&Array.isArray(ee.image)?O.mipmaps.length:1}function P(ee){return ee===Zi||ee===x6||ee===xR?9728:9729}function R(ee){let O=ee.target;O.removeEventListener("dispose",R),F(O),O.isVideoTexture&&p.delete(O)}function U(ee){let O=ee.target;O.removeEventListener("dispose",U),W(O)}function F(ee){let O=n.get(ee);if(O.__webglInit===void 0)return;let V=ee.source,ue=v.get(V);if(ue){let Ee=ue[O.__cacheKey];Ee.usedTimes--,Ee.usedTimes===0&&N(ee),Object.keys(ue).length===0&&v.delete(V)}n.remove(ee)}function N(ee){let O=n.get(ee);t.deleteTexture(O.__webglTexture);let V=ee.source,ue=v.get(V);delete ue[O.__cacheKey],o.memory.textures--}function W(ee){let O=ee.texture,V=n.get(ee),ue=n.get(O);if(ue.__webglTexture!==void 0&&(t.deleteTexture(ue.__webglTexture),o.memory.textures--),ee.depthTexture&&ee.depthTexture.dispose(),ee.isWebGLCubeRenderTarget)for(let Ee=0;Ee<6;Ee++)t.deleteFramebuffer(V.__webglFramebuffer[Ee]),V.__webglDepthbuffer&&t.deleteRenderbuffer(V.__webglDepthbuffer[Ee]);else{if(t.deleteFramebuffer(V.__webglFramebuffer),V.__webglDepthbuffer&&t.deleteRenderbuffer(V.__webglDepthbuffer),V.__webglMultisampledFramebuffer&&t.deleteFramebuffer(V.__webglMultisampledFramebuffer),V.__webglColorRenderbuffer)for(let Ee=0;Ee<V.__webglColorRenderbuffer.length;Ee++)V.__webglColorRenderbuffer[Ee]&&t.deleteRenderbuffer(V.__webglColorRenderbuffer[Ee]);V.__webglDepthRenderbuffer&&t.deleteRenderbuffer(V.__webglDepthRenderbuffer)}if(ee.isWebGLMultipleRenderTargets)for(let Ee=0,Te=O.length;Ee<Te;Ee++){let We=n.get(O[Ee]);We.__webglTexture&&(t.deleteTexture(We.__webglTexture),o.memory.textures--),n.remove(O[Ee])}n.remove(O),n.remove(ee)}let Q=0;function X(){Q=0}function B(){let ee=Q;return ee>=l&&console.warn("THREE.WebGLTextures: Trying to use "+ee+" texture units while this GPU supports only "+l),Q+=1,ee}function j(ee){let O=[];return O.push(ee.wrapS),O.push(ee.wrapT),O.push(ee.wrapR||0),O.push(ee.magFilter),O.push(ee.minFilter),O.push(ee.anisotropy),O.push(ee.internalFormat),O.push(ee.format),O.push(ee.type),O.push(ee.generateMipmaps),O.push(ee.premultiplyAlpha),O.push(ee.flipY),O.push(ee.unpackAlignment),O.push(ee.encoding),O.join()}function z(ee,O){let V=n.get(ee);if(ee.isVideoTexture&&tt(ee),ee.isRenderTargetTexture===!1&&ee.version>0&&V.__version!==ee.version){let ue=ee.image;if(ue===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ue.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ae(V,ee,O);return}}i.bindTexture(3553,V.__webglTexture,33984+O)}function k(ee,O){let V=n.get(ee);if(ee.version>0&&V.__version!==ee.version){ae(V,ee,O);return}i.bindTexture(35866,V.__webglTexture,33984+O)}function G(ee,O){let V=n.get(ee);if(ee.version>0&&V.__version!==ee.version){ae(V,ee,O);return}i.bindTexture(32879,V.__webglTexture,33984+O)}function Z(ee,O){let V=n.get(ee);if(ee.version>0&&V.__version!==ee.version){fe(V,ee,O);return}i.bindTexture(34067,V.__webglTexture,33984+O)}let K={[Qu]:10497,[Qn]:33071,[FB]:33648},re={[Zi]:9728,[x6]:9984,[xR]:9986,[ri]:9729,[sAe]:9985,[F0]:9987};function J(ee,O,V){if(V?(t.texParameteri(ee,10242,K[O.wrapS]),t.texParameteri(ee,10243,K[O.wrapT]),(ee===32879||ee===35866)&&t.texParameteri(ee,32882,K[O.wrapR]),t.texParameteri(ee,10240,re[O.magFilter]),t.texParameteri(ee,10241,re[O.minFilter])):(t.texParameteri(ee,10242,33071),t.texParameteri(ee,10243,33071),(ee===32879||ee===35866)&&t.texParameteri(ee,32882,33071),(O.wrapS!==Qn||O.wrapT!==Qn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(ee,10240,P(O.magFilter)),t.texParameteri(ee,10241,P(O.minFilter)),O.minFilter!==Zi&&O.minFilter!==ri&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){let ue=e.get("EXT_texture_filter_anisotropic");if(O.magFilter===Zi||O.minFilter!==xR&&O.minFilter!==F0||O.type===Xo&&e.has("OES_texture_float_linear")===!1||a===!1&&O.type===N0&&e.has("OES_texture_half_float_linear")===!1)return;(O.anisotropy>1||n.get(O).__currentAnisotropy)&&(t.texParameterf(ee,ue.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(O.anisotropy,r.getMaxAnisotropy())),n.get(O).__currentAnisotropy=O.anisotropy)}}function le(ee,O){let V=!1;ee.__webglInit===void 0&&(ee.__webglInit=!0,O.addEventListener("dispose",R));let ue=O.source,Ee=v.get(ue);Ee===void 0&&(Ee={},v.set(ue,Ee));let Te=j(O);if(Te!==ee.__cacheKey){Ee[Te]===void 0&&(Ee[Te]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,V=!0),Ee[Te].usedTimes++;let We=Ee[ee.__cacheKey];We!==void 0&&(Ee[ee.__cacheKey].usedTimes--,We.usedTimes===0&&N(O)),ee.__cacheKey=Te,ee.__webglTexture=Ee[Te].texture}return V}function ae(ee,O,V){let ue=3553;(O.isDataArrayTexture||O.isCompressedArrayTexture)&&(ue=35866),O.isData3DTexture&&(ue=32879);let Ee=le(ee,O),Te=O.source;i.bindTexture(ue,ee.__webglTexture,33984+V);let We=n.get(Te);if(Te.version!==We.__version||Ee===!0){i.activeTexture(33984+V),t.pixelStorei(37440,O.flipY),t.pixelStorei(37441,O.premultiplyAlpha),t.pixelStorei(3317,O.unpackAlignment),t.pixelStorei(37443,0);let Ve=S(O)&&b(O.image)===!1,me=x(O.image,Ve,!1,h);me=at(O,me);let be=b(me)||a,ne=s.convert(O.format,O.encoding),Ae=s.convert(O.type),ke=M(O.internalFormat,ne,Ae,O.encoding,O.isVideoTexture);J(ue,O,be);let Ue,Je=O.mipmaps,ut=a&&O.isVideoTexture!==!0,Pt=We.__version===void 0||Ee===!0,q=T(O,me,be);if(O.isDepthTexture)ke=6402,a?O.type===Xo?ke=36012:O.type===pd?ke=33190:O.type===Gp?ke=35056:ke=33189:O.type===Xo&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),O.format===Hp&&ke===6402&&O.type!==mee&&O.type!==pd&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),O.type=pd,Ae=s.convert(O.type)),O.format===am&&ke===6402&&(ke=34041,O.type!==Gp&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),O.type=Gp,Ae=s.convert(O.type))),Pt&&(ut?i.texStorage2D(3553,1,ke,me.width,me.height):i.texImage2D(3553,0,ke,me.width,me.height,0,ne,Ae,null));else if(O.isDataTexture)if(Je.length>0&&be){ut&&Pt&&i.texStorage2D(3553,q,ke,Je[0].width,Je[0].height);for(let pe=0,oe=Je.length;pe<oe;pe++)Ue=Je[pe],ut?i.texSubImage2D(3553,pe,0,0,Ue.width,Ue.height,ne,Ae,Ue.data):i.texImage2D(3553,pe,ke,Ue.width,Ue.height,0,ne,Ae,Ue.data);O.generateMipmaps=!1}else ut?(Pt&&i.texStorage2D(3553,q,ke,me.width,me.height),i.texSubImage2D(3553,0,0,0,me.width,me.height,ne,Ae,me.data)):i.texImage2D(3553,0,ke,me.width,me.height,0,ne,Ae,me.data);else if(O.isCompressedTexture)if(O.isCompressedArrayTexture){ut&&Pt&&i.texStorage3D(35866,q,ke,Je[0].width,Je[0].height,me.depth);for(let pe=0,oe=Je.length;pe<oe;pe++)Ue=Je[pe],O.format!==za?ne!==null?ut?i.compressedTexSubImage3D(35866,pe,0,0,0,Ue.width,Ue.height,me.depth,ne,Ue.data,0,0):i.compressedTexImage3D(35866,pe,ke,Ue.width,Ue.height,me.depth,0,Ue.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ut?i.texSubImage3D(35866,pe,0,0,0,Ue.width,Ue.height,me.depth,ne,Ae,Ue.data):i.texImage3D(35866,pe,ke,Ue.width,Ue.height,me.depth,0,ne,Ae,Ue.data)}else{ut&&Pt&&i.texStorage2D(3553,q,ke,Je[0].width,Je[0].height);for(let pe=0,oe=Je.length;pe<oe;pe++)Ue=Je[pe],O.format!==za?ne!==null?ut?i.compressedTexSubImage2D(3553,pe,0,0,Ue.width,Ue.height,ne,Ue.data):i.compressedTexImage2D(3553,pe,ke,Ue.width,Ue.height,0,Ue.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ut?i.texSubImage2D(3553,pe,0,0,Ue.width,Ue.height,ne,Ae,Ue.data):i.texImage2D(3553,pe,ke,Ue.width,Ue.height,0,ne,Ae,Ue.data)}else if(O.isDataArrayTexture)ut?(Pt&&i.texStorage3D(35866,q,ke,me.width,me.height,me.depth),i.texSubImage3D(35866,0,0,0,0,me.width,me.height,me.depth,ne,Ae,me.data)):i.texImage3D(35866,0,ke,me.width,me.height,me.depth,0,ne,Ae,me.data);else if(O.isData3DTexture)ut?(Pt&&i.texStorage3D(32879,q,ke,me.width,me.height,me.depth),i.texSubImage3D(32879,0,0,0,0,me.width,me.height,me.depth,ne,Ae,me.data)):i.texImage3D(32879,0,ke,me.width,me.height,me.depth,0,ne,Ae,me.data);else if(O.isFramebufferTexture){if(Pt)if(ut)i.texStorage2D(3553,q,ke,me.width,me.height);else{let pe=me.width,oe=me.height;for(let Be=0;Be<q;Be++)i.texImage2D(3553,Be,ke,pe,oe,0,ne,Ae,null),pe>>=1,oe>>=1}}else if(Je.length>0&&be){ut&&Pt&&i.texStorage2D(3553,q,ke,Je[0].width,Je[0].height);for(let pe=0,oe=Je.length;pe<oe;pe++)Ue=Je[pe],ut?i.texSubImage2D(3553,pe,0,0,ne,Ae,Ue):i.texImage2D(3553,pe,ke,ne,Ae,Ue);O.generateMipmaps=!1}else ut?(Pt&&i.texStorage2D(3553,q,ke,me.width,me.height),i.texSubImage2D(3553,0,0,0,ne,Ae,me)):i.texImage2D(3553,0,ke,ne,Ae,me);A(O,be)&&E(ue),We.__version=Te.version,O.onUpdate&&O.onUpdate(O)}ee.__version=O.version}function fe(ee,O,V){if(O.image.length!==6)return;let ue=le(ee,O),Ee=O.source;i.bindTexture(34067,ee.__webglTexture,33984+V);let Te=n.get(Ee);if(Ee.version!==Te.__version||ue===!0){i.activeTexture(33984+V),t.pixelStorei(37440,O.flipY),t.pixelStorei(37441,O.premultiplyAlpha),t.pixelStorei(3317,O.unpackAlignment),t.pixelStorei(37443,0);let We=O.isCompressedTexture||O.image[0].isCompressedTexture,Ve=O.image[0]&&O.image[0].isDataTexture,me=[];for(let pe=0;pe<6;pe++)!We&&!Ve?me[pe]=x(O.image[pe],!1,!0,c):me[pe]=Ve?O.image[pe].image:O.image[pe],me[pe]=at(O,me[pe]);let be=me[0],ne=b(be)||a,Ae=s.convert(O.format,O.encoding),ke=s.convert(O.type),Ue=M(O.internalFormat,Ae,ke,O.encoding),Je=a&&O.isVideoTexture!==!0,ut=Te.__version===void 0||ue===!0,Pt=T(O,be,ne);J(34067,O,ne);let q;if(We){Je&&ut&&i.texStorage2D(34067,Pt,Ue,be.width,be.height);for(let pe=0;pe<6;pe++){q=me[pe].mipmaps;for(let oe=0;oe<q.length;oe++){let Be=q[oe];O.format!==za?Ae!==null?Je?i.compressedTexSubImage2D(34069+pe,oe,0,0,Be.width,Be.height,Ae,Be.data):i.compressedTexImage2D(34069+pe,oe,Ue,Be.width,Be.height,0,Be.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Je?i.texSubImage2D(34069+pe,oe,0,0,Be.width,Be.height,Ae,ke,Be.data):i.texImage2D(34069+pe,oe,Ue,Be.width,Be.height,0,Ae,ke,Be.data)}}}else{q=O.mipmaps,Je&&ut&&(q.length>0&&Pt++,i.texStorage2D(34067,Pt,Ue,me[0].width,me[0].height));for(let pe=0;pe<6;pe++)if(Ve){Je?i.texSubImage2D(34069+pe,0,0,0,me[pe].width,me[pe].height,Ae,ke,me[pe].data):i.texImage2D(34069+pe,0,Ue,me[pe].width,me[pe].height,0,Ae,ke,me[pe].data);for(let oe=0;oe<q.length;oe++){let Be=q[oe].image[pe].image;Je?i.texSubImage2D(34069+pe,oe+1,0,0,Be.width,Be.height,Ae,ke,Be.data):i.texImage2D(34069+pe,oe+1,Ue,Be.width,Be.height,0,Ae,ke,Be.data)}}else{Je?i.texSubImage2D(34069+pe,0,0,0,Ae,ke,me[pe]):i.texImage2D(34069+pe,0,Ue,Ae,ke,me[pe]);for(let oe=0;oe<q.length;oe++){let Be=q[oe];Je?i.texSubImage2D(34069+pe,oe+1,0,0,Ae,ke,Be.image[pe]):i.texImage2D(34069+pe,oe+1,Ue,Ae,ke,Be.image[pe])}}}A(O,ne)&&E(34067),Te.__version=Ee.version,O.onUpdate&&O.onUpdate(O)}ee.__version=O.version}function ge(ee,O,V,ue,Ee){let Te=s.convert(V.format,V.encoding),We=s.convert(V.type),Ve=M(V.internalFormat,Te,We,V.encoding);n.get(O).__hasExternalTextures||(Ee===32879||Ee===35866?i.texImage3D(Ee,0,Ve,O.width,O.height,O.depth,0,Te,We,null):i.texImage2D(Ee,0,Ve,O.width,O.height,0,Te,We,null)),i.bindFramebuffer(36160,ee),Ge(O)?d.framebufferTexture2DMultisampleEXT(36160,ue,Ee,n.get(V).__webglTexture,0,Ie(O)):(Ee===3553||Ee>=34069&&Ee<=34074)&&t.framebufferTexture2D(36160,ue,Ee,n.get(V).__webglTexture,0),i.bindFramebuffer(36160,null)}function ve(ee,O,V){if(t.bindRenderbuffer(36161,ee),O.depthBuffer&&!O.stencilBuffer){let ue=33189;if(V||Ge(O)){let Ee=O.depthTexture;Ee&&Ee.isDepthTexture&&(Ee.type===Xo?ue=36012:Ee.type===pd&&(ue=33190));let Te=Ie(O);Ge(O)?d.renderbufferStorageMultisampleEXT(36161,Te,ue,O.width,O.height):t.renderbufferStorageMultisample(36161,Te,ue,O.width,O.height)}else t.renderbufferStorage(36161,ue,O.width,O.height);t.framebufferRenderbuffer(36160,36096,36161,ee)}else if(O.depthBuffer&&O.stencilBuffer){let ue=Ie(O);V&&Ge(O)===!1?t.renderbufferStorageMultisample(36161,ue,35056,O.width,O.height):Ge(O)?d.renderbufferStorageMultisampleEXT(36161,ue,35056,O.width,O.height):t.renderbufferStorage(36161,34041,O.width,O.height),t.framebufferRenderbuffer(36160,33306,36161,ee)}else{let ue=O.isWebGLMultipleRenderTargets===!0?O.texture:[O.texture];for(let Ee=0;Ee<ue.length;Ee++){let Te=ue[Ee],We=s.convert(Te.format,Te.encoding),Ve=s.convert(Te.type),me=M(Te.internalFormat,We,Ve,Te.encoding),be=Ie(O);V&&Ge(O)===!1?t.renderbufferStorageMultisample(36161,be,me,O.width,O.height):Ge(O)?d.renderbufferStorageMultisampleEXT(36161,be,me,O.width,O.height):t.renderbufferStorage(36161,me,O.width,O.height)}}t.bindRenderbuffer(36161,null)}function Y(ee,O){if(O&&O.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(36160,ee),!(O.depthTexture&&O.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(O.depthTexture).__webglTexture||O.depthTexture.image.width!==O.width||O.depthTexture.image.height!==O.height)&&(O.depthTexture.image.width=O.width,O.depthTexture.image.height=O.height,O.depthTexture.needsUpdate=!0),z(O.depthTexture,0);let V=n.get(O.depthTexture).__webglTexture,ue=Ie(O);if(O.depthTexture.format===Hp)Ge(O)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,V,0,ue):t.framebufferTexture2D(36160,36096,3553,V,0);else if(O.depthTexture.format===am)Ge(O)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,V,0,ue):t.framebufferTexture2D(36160,33306,3553,V,0);else throw new Error("Unknown depthTexture format")}function ce(ee){let O=n.get(ee),V=ee.isWebGLCubeRenderTarget===!0;if(ee.depthTexture&&!O.__autoAllocateDepthBuffer){if(V)throw new Error("target.depthTexture not supported in Cube render targets");Y(O.__webglFramebuffer,ee)}else if(V){O.__webglDepthbuffer=[];for(let ue=0;ue<6;ue++)i.bindFramebuffer(36160,O.__webglFramebuffer[ue]),O.__webglDepthbuffer[ue]=t.createRenderbuffer(),ve(O.__webglDepthbuffer[ue],ee,!1)}else i.bindFramebuffer(36160,O.__webglFramebuffer),O.__webglDepthbuffer=t.createRenderbuffer(),ve(O.__webglDepthbuffer,ee,!1);i.bindFramebuffer(36160,null)}function de(ee,O,V){let ue=n.get(ee);O!==void 0&&ge(ue.__webglFramebuffer,ee,ee.texture,36064,3553),V!==void 0&&ce(ee)}function xe(ee){let O=ee.texture,V=n.get(ee),ue=n.get(O);ee.addEventListener("dispose",U),ee.isWebGLMultipleRenderTargets!==!0&&(ue.__webglTexture===void 0&&(ue.__webglTexture=t.createTexture()),ue.__version=O.version,o.memory.textures++);let Ee=ee.isWebGLCubeRenderTarget===!0,Te=ee.isWebGLMultipleRenderTargets===!0,We=b(ee)||a;if(Ee){V.__webglFramebuffer=[];for(let Ve=0;Ve<6;Ve++)V.__webglFramebuffer[Ve]=t.createFramebuffer()}else{if(V.__webglFramebuffer=t.createFramebuffer(),Te)if(r.drawBuffers){let Ve=ee.texture;for(let me=0,be=Ve.length;me<be;me++){let ne=n.get(Ve[me]);ne.__webglTexture===void 0&&(ne.__webglTexture=t.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&ee.samples>0&&Ge(ee)===!1){let Ve=Te?O:[O];V.__webglMultisampledFramebuffer=t.createFramebuffer(),V.__webglColorRenderbuffer=[],i.bindFramebuffer(36160,V.__webglMultisampledFramebuffer);for(let me=0;me<Ve.length;me++){let be=Ve[me];V.__webglColorRenderbuffer[me]=t.createRenderbuffer(),t.bindRenderbuffer(36161,V.__webglColorRenderbuffer[me]);let ne=s.convert(be.format,be.encoding),Ae=s.convert(be.type),ke=M(be.internalFormat,ne,Ae,be.encoding,ee.isXRRenderTarget===!0),Ue=Ie(ee);t.renderbufferStorageMultisample(36161,Ue,ke,ee.width,ee.height),t.framebufferRenderbuffer(36160,36064+me,36161,V.__webglColorRenderbuffer[me])}t.bindRenderbuffer(36161,null),ee.depthBuffer&&(V.__webglDepthRenderbuffer=t.createRenderbuffer(),ve(V.__webglDepthRenderbuffer,ee,!0)),i.bindFramebuffer(36160,null)}}if(Ee){i.bindTexture(34067,ue.__webglTexture),J(34067,O,We);for(let Ve=0;Ve<6;Ve++)ge(V.__webglFramebuffer[Ve],ee,O,36064,34069+Ve);A(O,We)&&E(34067),i.unbindTexture()}else if(Te){let Ve=ee.texture;for(let me=0,be=Ve.length;me<be;me++){let ne=Ve[me],Ae=n.get(ne);i.bindTexture(3553,Ae.__webglTexture),J(3553,ne,We),ge(V.__webglFramebuffer,ee,ne,36064+me,3553),A(ne,We)&&E(3553)}i.unbindTexture()}else{let Ve=3553;(ee.isWebGL3DRenderTarget||ee.isWebGLArrayRenderTarget)&&(a?Ve=ee.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),i.bindTexture(Ve,ue.__webglTexture),J(Ve,O,We),ge(V.__webglFramebuffer,ee,O,36064,Ve),A(O,We)&&E(Ve),i.unbindTexture()}ee.depthBuffer&&ce(ee)}function Ce(ee){let O=b(ee)||a,V=ee.isWebGLMultipleRenderTargets===!0?ee.texture:[ee.texture];for(let ue=0,Ee=V.length;ue<Ee;ue++){let Te=V[ue];if(A(Te,O)){let We=ee.isWebGLCubeRenderTarget?34067:3553,Ve=n.get(Te).__webglTexture;i.bindTexture(We,Ve),E(We),i.unbindTexture()}}}function Ne(ee){if(a&&ee.samples>0&&Ge(ee)===!1){let O=ee.isWebGLMultipleRenderTargets?ee.texture:[ee.texture],V=ee.width,ue=ee.height,Ee=16384,Te=[],We=ee.stencilBuffer?33306:36096,Ve=n.get(ee),me=ee.isWebGLMultipleRenderTargets===!0;if(me)for(let be=0;be<O.length;be++)i.bindFramebuffer(36160,Ve.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+be,36161,null),i.bindFramebuffer(36160,Ve.__webglFramebuffer),t.framebufferTexture2D(36009,36064+be,3553,null,0);i.bindFramebuffer(36008,Ve.__webglMultisampledFramebuffer),i.bindFramebuffer(36009,Ve.__webglFramebuffer);for(let be=0;be<O.length;be++){Te.push(36064+be),ee.depthBuffer&&Te.push(We);let ne=Ve.__ignoreDepthValues!==void 0?Ve.__ignoreDepthValues:!1;if(ne===!1&&(ee.depthBuffer&&(Ee|=256),ee.stencilBuffer&&(Ee|=1024)),me&&t.framebufferRenderbuffer(36008,36064,36161,Ve.__webglColorRenderbuffer[be]),ne===!0&&(t.invalidateFramebuffer(36008,[We]),t.invalidateFramebuffer(36009,[We])),me){let Ae=n.get(O[be]).__webglTexture;t.framebufferTexture2D(36009,36064,3553,Ae,0)}t.blitFramebuffer(0,0,V,ue,0,0,V,ue,Ee,9728),f&&t.invalidateFramebuffer(36008,Te)}if(i.bindFramebuffer(36008,null),i.bindFramebuffer(36009,null),me)for(let be=0;be<O.length;be++){i.bindFramebuffer(36160,Ve.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+be,36161,Ve.__webglColorRenderbuffer[be]);let ne=n.get(O[be]).__webglTexture;i.bindFramebuffer(36160,Ve.__webglFramebuffer),t.framebufferTexture2D(36009,36064+be,3553,ne,0)}i.bindFramebuffer(36009,Ve.__webglMultisampledFramebuffer)}}function Ie(ee){return Math.min(u,ee.samples)}function Ge(ee){let O=n.get(ee);return a&&ee.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&O.__useRenderToTexture!==!1}function tt(ee){let O=o.render.frame;p.get(ee)!==O&&(p.set(ee,O),ee.update())}function at(ee,O){let V=ee.encoding,ue=ee.format,Ee=ee.type;return ee.isCompressedTexture===!0||ee.isVideoTexture===!0||ee.format===UB||V!==Yc&&(V===Qt?a===!1?e.has("EXT_sRGB")===!0&&ue===za?(ee.format=UB,ee.minFilter=ri,ee.generateMipmaps=!1):O=See.sRGBToLinear(O):(ue!==za||Ee!==As)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",V)),O}this.allocateTextureUnit=B,this.resetTextureUnits=X,this.setTexture2D=z,this.setTexture2DArray=k,this.setTexture3D=G,this.setTextureCube=Z,this.rebindTextures=de,this.setupRenderTarget=xe,this.updateRenderTargetMipmap=Ce,this.updateMultisampleRenderTarget=Ne,this.setupDepthRenderbuffer=ce,this.setupFrameBufferTexture=ge,this.useMultisampledRTT=Ge}function T2e(t,e,i){let n=i.isWebGL2;function r(s,o=null){let a;if(s===As)return 5121;if(s===cAe)return 32819;if(s===uAe)return 32820;if(s===oAe)return 5120;if(s===aAe)return 5122;if(s===mee)return 5123;if(s===lAe)return 5124;if(s===pd)return 5125;if(s===Xo)return 5126;if(s===N0)return n?5131:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===hAe)return 6406;if(s===za)return 6408;if(s===dAe)return 6409;if(s===fAe)return 6410;if(s===Hp)return 6402;if(s===am)return 34041;if(s===UB)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===pAe)return 6403;if(s===mAe)return 36244;if(s===gee)return 33319;if(s===gAe)return 33320;if(s===vAe)return 36249;if(s===_R||s===wR||s===bR||s===SR)if(o===Qt)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===_R)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===wR)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===bR)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===SR)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===_R)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===wR)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===bR)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===SR)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===_6||s===w6||s===b6||s===S6)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===_6)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===w6)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===b6)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===S6)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===yAe)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===A6||s===M6)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===A6)return o===Qt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===M6)return o===Qt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===E6||s===T6||s===C6||s===P6||s===D6||s===R6||s===I6||s===L6||s===B6||s===O6||s===F6||s===N6||s===U6||s===k6)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===E6)return o===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===T6)return o===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===C6)return o===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===P6)return o===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===D6)return o===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===R6)return o===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===I6)return o===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===L6)return o===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===B6)return o===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===O6)return o===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===F6)return o===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===N6)return o===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===U6)return o===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===k6)return o===Qt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===AR)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===AR)return o===Qt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===xAe||s===z6||s===G6||s===H6)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===AR)return a.COMPRESSED_RED_RGTC1_EXT;if(s===z6)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===G6)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===H6)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Gp?n?34042:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):t[s]!==void 0?t[s]:null}return{convert:r}}var C2e=class extends vs{constructor(t=[]){super(),this.isArrayCamera=!0,this.cameras=t}},Ev=class extends ji{constructor(){super(),this.isGroup=!0,this.type="Group"}},P2e={type:"move"},KR=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Ev,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Ev,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new L,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new L),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Ev,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new L,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new L),this._grip}dispatchEvent(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){let e=this._hand;if(e)for(let i of t.hand.values())this._getHandJoint(e,i)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(t,e,i){let n=null,r=null,s=null,o=this._targetRay,a=this._grip,l=this._hand;if(t&&e.session.visibilityState!=="visible-blurred"){if(l&&t.hand){s=!0;for(let p of t.hand.values()){let m=e.getJointPose(p,i),v=this._getHandJoint(l,p);m!==null&&(v.matrix.fromArray(m.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.jointRadius=m.radius),v.visible=m!==null}let c=l.joints["index-finger-tip"],h=l.joints["thumb-tip"],u=c.position.distanceTo(h.position),d=.02,f=.005;l.inputState.pinching&&u>d+f?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&u<=d-f&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else a!==null&&t.gripSpace&&(r=e.getPose(t.gripSpace,i),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1));o!==null&&(n=e.getPose(t.targetRaySpace,i),n===null&&r!==null&&(n=r),n!==null&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(P2e)))}return o!==null&&(o.visible=n!==null),a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),this}_getHandJoint(t,e){if(t.joints[e.jointName]===void 0){let i=new Ev;i.matrixAutoUpdate=!1,i.visible=!1,t.joints[e.jointName]=i,t.add(i)}return t.joints[e.jointName]}},k0=class extends br{constructor(t,e,i,n,r,s,o,a,l,c){if(c=c!==void 0?c:Hp,c!==Hp&&c!==am)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&c===Hp&&(i=pd),i===void 0&&c===am&&(i=Gp),super(null,n,r,s,o,a,c,i,l),this.isDepthTexture=!0,this.image={width:t,height:e},this.magFilter=o!==void 0?o:Zi,this.minFilter=a!==void 0?a:Zi,this.flipY=!1,this.generateMipmaps=!1}},D2e=class extends is{constructor(t,e){super();let i=this,n=null,r=1,s=null,o="local-floor",a=1,l=null,c=null,h=null,u=null,d=null,f=null,p=e.getContextAttributes(),m=null,v=null,g=[],y=[],x=new Set,b=new Map,S=new vs;S.layers.enable(1),S.viewport=new Kt;let A=new vs;A.layers.enable(2),A.viewport=new Kt;let E=[S,A],M=new C2e;M.layers.enable(1),M.layers.enable(2);let T=null,P=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(k){let G=g[k];return G===void 0&&(G=new KR,g[k]=G),G.getTargetRaySpace()},this.getControllerGrip=function(k){let G=g[k];return G===void 0&&(G=new KR,g[k]=G),G.getGripSpace()},this.getHand=function(k){let G=g[k];return G===void 0&&(G=new KR,g[k]=G),G.getHandSpace()};function R(k){let G=y.indexOf(k.inputSource);if(G===-1)return;let Z=g[G];Z!==void 0&&Z.dispatchEvent({type:k.type,data:k.inputSource})}function U(){n.removeEventListener("select",R),n.removeEventListener("selectstart",R),n.removeEventListener("selectend",R),n.removeEventListener("squeeze",R),n.removeEventListener("squeezestart",R),n.removeEventListener("squeezeend",R),n.removeEventListener("end",U),n.removeEventListener("inputsourceschange",F);for(let k=0;k<g.length;k++){let G=y[k];G!==null&&(y[k]=null,g[k].disconnect(G))}T=null,P=null,t.setRenderTarget(m),d=null,u=null,h=null,n=null,v=null,z.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(k){r=k,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(k){o=k,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(k){l=k},this.getBaseLayer=function(){return u!==null?u:d},this.getBinding=function(){return h},this.getFrame=function(){return f},this.getSession=function(){return n},this.setSession=async function(k){if(n=k,n!==null){if(m=t.getRenderTarget(),n.addEventListener("select",R),n.addEventListener("selectstart",R),n.addEventListener("selectend",R),n.addEventListener("squeeze",R),n.addEventListener("squeezestart",R),n.addEventListener("squeezeend",R),n.addEventListener("end",U),n.addEventListener("inputsourceschange",F),p.xrCompatible!==!0&&await e.makeXRCompatible(),n.renderState.layers===void 0||t.capabilities.isWebGL2===!1){let G={antialias:n.renderState.layers===void 0?p.antialias:!0,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:r};d=new XRWebGLLayer(n,e,G),n.updateRenderState({baseLayer:d}),v=new Hi(d.framebufferWidth,d.framebufferHeight,{format:za,type:As,encoding:t.outputEncoding,stencilBuffer:p.stencil})}else{let G=null,Z=null,K=null;p.depth&&(K=p.stencil?35056:33190,G=p.stencil?am:Hp,Z=p.stencil?Gp:pd);let re={colorFormat:32856,depthFormat:K,scaleFactor:r};h=new XRWebGLBinding(n,e),u=h.createProjectionLayer(re),n.updateRenderState({layers:[u]}),v=new Hi(u.textureWidth,u.textureHeight,{format:za,type:As,depthTexture:new k0(u.textureWidth,u.textureHeight,Z,void 0,void 0,void 0,void 0,void 0,void 0,G),stencilBuffer:p.stencil,encoding:t.outputEncoding,samples:p.antialias?4:0});let J=t.properties.get(v);J.__ignoreDepthValues=u.ignoreDepthValues}v.isXRRenderTarget=!0,this.setFoveation(a),l=null,s=await n.requestReferenceSpace(o),z.setContext(n),z.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}};function F(k){for(let G=0;G<k.removed.length;G++){let Z=k.removed[G],K=y.indexOf(Z);K>=0&&(y[K]=null,g[K].disconnect(Z))}for(let G=0;G<k.added.length;G++){let Z=k.added[G],K=y.indexOf(Z);if(K===-1){for(let J=0;J<g.length;J++)if(J>=y.length){y.push(Z),K=J;break}else if(y[J]===null){y[J]=Z,K=J;break}if(K===-1)break}let re=g[K];re&&re.connect(Z)}}let N=new L,W=new L;function Q(k,G,Z){N.setFromMatrixPosition(G.matrixWorld),W.setFromMatrixPosition(Z.matrixWorld);let K=N.distanceTo(W),re=G.projectionMatrix.elements,J=Z.projectionMatrix.elements,le=re[14]/(re[10]-1),ae=re[14]/(re[10]+1),fe=(re[9]+1)/re[5],ge=(re[9]-1)/re[5],ve=(re[8]-1)/re[0],Y=(J[8]+1)/J[0],ce=le*ve,de=le*Y,xe=K/(-ve+Y),Ce=xe*-ve;G.matrixWorld.decompose(k.position,k.quaternion,k.scale),k.translateX(Ce),k.translateZ(xe),k.matrixWorld.compose(k.position,k.quaternion,k.scale),k.matrixWorldInverse.copy(k.matrixWorld).invert();let Ne=le+xe,Ie=ae+xe,Ge=ce-Ce,tt=de+(K-Ce),at=fe*ae/Ie*Ne,ee=ge*ae/Ie*Ne;k.projectionMatrix.makePerspective(Ge,tt,at,ee,Ne,Ie)}function X(k,G){G===null?k.matrixWorld.copy(k.matrix):k.matrixWorld.multiplyMatrices(G.matrixWorld,k.matrix),k.matrixWorldInverse.copy(k.matrixWorld).invert()}this.updateCamera=function(k){if(n===null)return;M.near=A.near=S.near=k.near,M.far=A.far=S.far=k.far,(T!==M.near||P!==M.far)&&(n.updateRenderState({depthNear:M.near,depthFar:M.far}),T=M.near,P=M.far);let G=k.parent,Z=M.cameras;X(M,G);for(let re=0;re<Z.length;re++)X(Z[re],G);M.matrixWorld.decompose(M.position,M.quaternion,M.scale),k.matrix.copy(M.matrix),k.matrix.decompose(k.position,k.quaternion,k.scale);let K=k.children;for(let re=0,J=K.length;re<J;re++)K[re].updateMatrixWorld(!0);Z.length===2?Q(M,S,A):M.projectionMatrix.copy(S.projectionMatrix)},this.getCamera=function(){return M},this.getFoveation=function(){if(!(u===null&&d===null))return a},this.setFoveation=function(k){a=k,u!==null&&(u.fixedFoveation=k),d!==null&&d.fixedFoveation!==void 0&&(d.fixedFoveation=k)},this.getPlanes=function(){return x};let B=null;function j(k,G){if(c=G.getViewerPose(l||s),f=G,c!==null){let Z=c.views;d!==null&&(t.setRenderTargetFramebuffer(v,d.framebuffer),t.setRenderTarget(v));let K=!1;Z.length!==M.cameras.length&&(M.cameras.length=0,K=!0);for(let re=0;re<Z.length;re++){let J=Z[re],le=null;if(d!==null)le=d.getViewport(J);else{let fe=h.getViewSubImage(u,J);le=fe.viewport,re===0&&(t.setRenderTargetTextures(v,fe.colorTexture,u.ignoreDepthValues?void 0:fe.depthStencilTexture),t.setRenderTarget(v))}let ae=E[re];ae===void 0&&(ae=new vs,ae.layers.enable(re),ae.viewport=new Kt,E[re]=ae),ae.matrix.fromArray(J.transform.matrix),ae.projectionMatrix.fromArray(J.projectionMatrix),ae.viewport.set(le.x,le.y,le.width,le.height),re===0&&M.matrix.copy(ae.matrix),K===!0&&M.cameras.push(ae)}}for(let Z=0;Z<g.length;Z++){let K=y[Z],re=g[Z];K!==null&&re!==void 0&&re.update(K,G,l||s)}if(B&&B(k,G),G.detectedPlanes){i.dispatchEvent({type:"planesdetected",data:G.detectedPlanes});let Z=null;for(let K of x)G.detectedPlanes.has(K)||(Z===null&&(Z=[]),Z.push(K));if(Z!==null)for(let K of Z)x.delete(K),b.delete(K),i.dispatchEvent({type:"planeremoved",data:K});for(let K of G.detectedPlanes)if(!x.has(K))x.add(K),b.set(K,G.lastChangedTime),i.dispatchEvent({type:"planeadded",data:K});else{let re=b.get(K);K.lastChangedTime>re&&(b.set(K,K.lastChangedTime),i.dispatchEvent({type:"planechanged",data:K}))}}f=null}let z=new Cee;z.setAnimationLoop(j),this.setAnimationLoop=function(k){B=k},this.dispose=function(){}}};function R2e(t,e){function i(m,v){v.color.getRGB(m.fogColor.value,Tee(t)),v.isFog?(m.fogNear.value=v.near,m.fogFar.value=v.far):v.isFogExp2&&(m.fogDensity.value=v.density)}function n(m,v,g,y,x){v.isMeshBasicMaterial||v.isMeshLambertMaterial?r(m,v):v.isMeshToonMaterial?(r(m,v),h(m,v)):v.isMeshPhongMaterial?(r(m,v),c(m,v)):v.isMeshStandardMaterial?(r(m,v),u(m,v),v.isMeshPhysicalMaterial&&d(m,v,x)):v.isMeshMatcapMaterial?(r(m,v),f(m,v)):v.isMeshDepthMaterial?r(m,v):v.isMeshDistanceMaterial?(r(m,v),p(m,v)):v.isMeshNormalMaterial?r(m,v):v.isLineBasicMaterial?(s(m,v),v.isLineDashedMaterial&&o(m,v)):v.isPointsMaterial?a(m,v,g,y):v.isSpriteMaterial?l(m,v):v.isShadowMaterial?(m.color.value.copy(v.color),m.opacity.value=v.opacity):v.isShaderMaterial&&(v.uniformsNeedUpdate=!1)}function r(m,v){m.opacity.value=v.opacity,v.color&&m.diffuse.value.copy(v.color),v.emissive&&m.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity),v.map&&(m.map.value=v.map),v.alphaMap&&(m.alphaMap.value=v.alphaMap),v.bumpMap&&(m.bumpMap.value=v.bumpMap,m.bumpScale.value=v.bumpScale,v.side===kr&&(m.bumpScale.value*=-1)),v.displacementMap&&(m.displacementMap.value=v.displacementMap,m.displacementScale.value=v.displacementScale,m.displacementBias.value=v.displacementBias),v.emissiveMap&&(m.emissiveMap.value=v.emissiveMap),v.normalMap&&(m.normalMap.value=v.normalMap,m.normalScale.value.copy(v.normalScale),v.side===kr&&m.normalScale.value.negate()),v.specularMap&&(m.specularMap.value=v.specularMap),v.alphaTest>0&&(m.alphaTest.value=v.alphaTest);let g=e.get(v).envMap;if(g&&(m.envMap.value=g,m.flipEnvMap.value=g.isCubeTexture&&g.isRenderTargetTexture===!1?-1:1,m.reflectivity.value=v.reflectivity,m.ior.value=v.ior,m.refractionRatio.value=v.refractionRatio),v.lightMap){m.lightMap.value=v.lightMap;let b=t.physicallyCorrectLights!==!0?Math.PI:1;m.lightMapIntensity.value=v.lightMapIntensity*b}v.aoMap&&(m.aoMap.value=v.aoMap,m.aoMapIntensity.value=v.aoMapIntensity);let y;v.map?y=v.map:v.specularMap?y=v.specularMap:v.displacementMap?y=v.displacementMap:v.normalMap?y=v.normalMap:v.bumpMap?y=v.bumpMap:v.roughnessMap?y=v.roughnessMap:v.metalnessMap?y=v.metalnessMap:v.alphaMap?y=v.alphaMap:v.emissiveMap?y=v.emissiveMap:v.clearcoatMap?y=v.clearcoatMap:v.clearcoatNormalMap?y=v.clearcoatNormalMap:v.clearcoatRoughnessMap?y=v.clearcoatRoughnessMap:v.iridescenceMap?y=v.iridescenceMap:v.iridescenceThicknessMap?y=v.iridescenceThicknessMap:v.specularIntensityMap?y=v.specularIntensityMap:v.specularColorMap?y=v.specularColorMap:v.transmissionMap?y=v.transmissionMap:v.thicknessMap?y=v.thicknessMap:v.sheenColorMap?y=v.sheenColorMap:v.sheenRoughnessMap&&(y=v.sheenRoughnessMap),y!==void 0&&(y.isWebGLRenderTarget&&(y=y.texture),y.matrixAutoUpdate===!0&&y.updateMatrix(),m.uvTransform.value.copy(y.matrix));let x;v.aoMap?x=v.aoMap:v.lightMap&&(x=v.lightMap),x!==void 0&&(x.isWebGLRenderTarget&&(x=x.texture),x.matrixAutoUpdate===!0&&x.updateMatrix(),m.uv2Transform.value.copy(x.matrix))}function s(m,v){m.diffuse.value.copy(v.color),m.opacity.value=v.opacity}function o(m,v){m.dashSize.value=v.dashSize,m.totalSize.value=v.dashSize+v.gapSize,m.scale.value=v.scale}function a(m,v,g,y){m.diffuse.value.copy(v.color),m.opacity.value=v.opacity,m.size.value=v.size*g,m.scale.value=y*.5,v.map&&(m.map.value=v.map),v.alphaMap&&(m.alphaMap.value=v.alphaMap),v.alphaTest>0&&(m.alphaTest.value=v.alphaTest);let x;v.map?x=v.map:v.alphaMap&&(x=v.alphaMap),x!==void 0&&(x.matrixAutoUpdate===!0&&x.updateMatrix(),m.uvTransform.value.copy(x.matrix))}function l(m,v){m.diffuse.value.copy(v.color),m.opacity.value=v.opacity,m.rotation.value=v.rotation,v.map&&(m.map.value=v.map),v.alphaMap&&(m.alphaMap.value=v.alphaMap),v.alphaTest>0&&(m.alphaTest.value=v.alphaTest);let g;v.map?g=v.map:v.alphaMap&&(g=v.alphaMap),g!==void 0&&(g.matrixAutoUpdate===!0&&g.updateMatrix(),m.uvTransform.value.copy(g.matrix))}function c(m,v){m.specular.value.copy(v.specular),m.shininess.value=Math.max(v.shininess,1e-4)}function h(m,v){v.gradientMap&&(m.gradientMap.value=v.gradientMap)}function u(m,v){m.roughness.value=v.roughness,m.metalness.value=v.metalness,v.roughnessMap&&(m.roughnessMap.value=v.roughnessMap),v.metalnessMap&&(m.metalnessMap.value=v.metalnessMap),e.get(v).envMap&&(m.envMapIntensity.value=v.envMapIntensity)}function d(m,v,g){m.ior.value=v.ior,v.sheen>0&&(m.sheenColor.value.copy(v.sheenColor).multiplyScalar(v.sheen),m.sheenRoughness.value=v.sheenRoughness,v.sheenColorMap&&(m.sheenColorMap.value=v.sheenColorMap),v.sheenRoughnessMap&&(m.sheenRoughnessMap.value=v.sheenRoughnessMap)),v.clearcoat>0&&(m.clearcoat.value=v.clearcoat,m.clearcoatRoughness.value=v.clearcoatRoughness,v.clearcoatMap&&(m.clearcoatMap.value=v.clearcoatMap),v.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=v.clearcoatRoughnessMap),v.clearcoatNormalMap&&(m.clearcoatNormalScale.value.copy(v.clearcoatNormalScale),m.clearcoatNormalMap.value=v.clearcoatNormalMap,v.side===kr&&m.clearcoatNormalScale.value.negate())),v.iridescence>0&&(m.iridescence.value=v.iridescence,m.iridescenceIOR.value=v.iridescenceIOR,m.iridescenceThicknessMinimum.value=v.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=v.iridescenceThicknessRange[1],v.iridescenceMap&&(m.iridescenceMap.value=v.iridescenceMap),v.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=v.iridescenceThicknessMap)),v.transmission>0&&(m.transmission.value=v.transmission,m.transmissionSamplerMap.value=g.texture,m.transmissionSamplerSize.value.set(g.width,g.height),v.transmissionMap&&(m.transmissionMap.value=v.transmissionMap),m.thickness.value=v.thickness,v.thicknessMap&&(m.thicknessMap.value=v.thicknessMap),m.attenuationDistance.value=v.attenuationDistance,m.attenuationColor.value.copy(v.attenuationColor)),m.specularIntensity.value=v.specularIntensity,m.specularColor.value.copy(v.specularColor),v.specularIntensityMap&&(m.specularIntensityMap.value=v.specularIntensityMap),v.specularColorMap&&(m.specularColorMap.value=v.specularColorMap)}function f(m,v){v.matcap&&(m.matcap.value=v.matcap)}function p(m,v){m.referencePosition.value.copy(v.referencePosition),m.nearDistance.value=v.nearDistance,m.farDistance.value=v.farDistance}return{refreshFogUniforms:i,refreshMaterialUniforms:n}}function I2e(t,e,i,n){let r={},s={},o=[],a=i.isWebGL2?t.getParameter(35375):0;function l(y,x){let b=x.program;n.uniformBlockBinding(y,b)}function c(y,x){let b=r[y.id];b===void 0&&(p(y),b=h(y),r[y.id]=b,y.addEventListener("dispose",v));let S=x.program;n.updateUBOMapping(y,S);let A=e.render.frame;s[y.id]!==A&&(d(y),s[y.id]=A)}function h(y){let x=u();y.__bindingPointIndex=x;let b=t.createBuffer(),S=y.__size,A=y.usage;return t.bindBuffer(35345,b),t.bufferData(35345,S,A),t.bindBuffer(35345,null),t.bindBufferBase(35345,x,b),b}function u(){for(let y=0;y<a;y++)if(o.indexOf(y)===-1)return o.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(y){let x=r[y.id],b=y.uniforms,S=y.__cache;t.bindBuffer(35345,x);for(let A=0,E=b.length;A<E;A++){let M=b[A];if(f(M,A,S)===!0){let T=M.__offset,P=Array.isArray(M.value)?M.value:[M.value],R=0;for(let U=0;U<P.length;U++){let F=P[U],N=m(F);typeof F=="number"?(M.__data[0]=F,t.bufferSubData(35345,T+R,M.__data)):F.isMatrix3?(M.__data[0]=F.elements[0],M.__data[1]=F.elements[1],M.__data[2]=F.elements[2],M.__data[3]=F.elements[0],M.__data[4]=F.elements[3],M.__data[5]=F.elements[4],M.__data[6]=F.elements[5],M.__data[7]=F.elements[0],M.__data[8]=F.elements[6],M.__data[9]=F.elements[7],M.__data[10]=F.elements[8],M.__data[11]=F.elements[0]):(F.toArray(M.__data,R),R+=N.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(35345,T,M.__data)}}t.bindBuffer(35345,null)}function f(y,x,b){let S=y.value;if(b[x]===void 0){if(typeof S=="number")b[x]=S;else{let A=Array.isArray(S)?S:[S],E=[];for(let M=0;M<A.length;M++)E.push(A[M].clone());b[x]=E}return!0}else if(typeof S=="number"){if(b[x]!==S)return b[x]=S,!0}else{let A=Array.isArray(b[x])?b[x]:[b[x]],E=Array.isArray(S)?S:[S];for(let M=0;M<A.length;M++){let T=A[M];if(T.equals(E[M])===!1)return T.copy(E[M]),!0}}return!1}function p(y){let x=y.uniforms,b=0,S=16,A=0;for(let E=0,M=x.length;E<M;E++){let T=x[E],P={boundary:0,storage:0},R=Array.isArray(T.value)?T.value:[T.value];for(let U=0,F=R.length;U<F;U++){let N=R[U],W=m(N);P.boundary+=W.boundary,P.storage+=W.storage}if(T.__data=new Float32Array(P.storage/Float32Array.BYTES_PER_ELEMENT),T.__offset=b,E>0){A=b%S;let U=S-A;A!==0&&U-P.boundary<0&&(b+=S-A,T.__offset=b)}b+=P.storage}return A=b%S,A>0&&(b+=S-A),y.__size=b,y.__cache={},this}function m(y){let x={boundary:0,storage:0};return typeof y=="number"?(x.boundary=4,x.storage=4):y.isVector2?(x.boundary=8,x.storage=8):y.isVector3||y.isColor?(x.boundary=16,x.storage=12):y.isVector4?(x.boundary=16,x.storage=16):y.isMatrix3?(x.boundary=48,x.storage=48):y.isMatrix4?(x.boundary=64,x.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),x}function v(y){let x=y.target;x.removeEventListener("dispose",v);let b=o.indexOf(x.__bindingPointIndex);o.splice(b,1),t.deleteBuffer(r[x.id]),delete r[x.id],delete s[x.id]}function g(){for(let y in r)t.deleteBuffer(r[y]);o=[],r={},s={}}return{bind:l,update:c,dispose:g}}function L2e(){let t=eT("canvas");return t.style.display="block",t}function Bee(t={}){this.isWebGLRenderer=!0;let e=t.canvas!==void 0?t.canvas:L2e(),i=t.context!==void 0?t.context:null,n=t.depth!==void 0?t.depth:!0,r=t.stencil!==void 0?t.stencil:!0,s=t.antialias!==void 0?t.antialias:!1,o=t.premultipliedAlpha!==void 0?t.premultipliedAlpha:!0,a=t.preserveDrawingBuffer!==void 0?t.preserveDrawingBuffer:!1,l=t.powerPreference!==void 0?t.powerPreference:"default",c=t.failIfMajorPerformanceCaveat!==void 0?t.failIfMajorPerformanceCaveat:!1,h;i!==null?h=i.getContextAttributes().alpha:h=t.alpha!==void 0?t.alpha:!1;let u=null,d=null,f=[],p=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Yc,this.physicallyCorrectLights=!1,this.toneMapping=ih,this.toneMappingExposure=1;let m=this,v=!1,g=0,y=0,x=null,b=-1,S=null,A=new Kt,E=new Kt,M=null,T=e.width,P=e.height,R=1,U=null,F=null,N=new Kt(0,0,T,P),W=new Kt(0,0,T,P),Q=!1,X=new uk,B=!1,j=!1,z=null,k=new $e,G=new he,Z=new L,K={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function re(){return x===null?R:1}let J=i;function le(ie,Le){for(let Xe=0;Xe<ie.length;Xe++){let De=ie[Xe],Ye=e.getContext(De,Le);if(Ye!==null)return Ye}return null}try{let ie={alpha:!0,depth:n,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${oy}`),e.addEventListener("webglcontextlost",ke,!1),e.addEventListener("webglcontextrestored",Ue,!1),e.addEventListener("webglcontextcreationerror",Je,!1),J===null){let Le=["webgl2","webgl","experimental-webgl"];if(m.isWebGL1Renderer===!0&&Le.shift(),J=le(Le,ie),J===null)throw le(Le)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}J.getShaderPrecisionFormat===void 0&&(J.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ie){throw console.error("THREE.WebGLRenderer: "+ie.message),ie}let ae,fe,ge,ve,Y,ce,de,xe,Ce,Ne,Ie,Ge,tt,at,ee,O,V,ue,Ee,Te,We,Ve,me,be;function ne(){ae=new XTe(J),fe=new zTe(J,ae,t),ae.init(fe),Ve=new T2e(J,ae,fe),ge=new M2e(J,ae,fe),ve=new QTe,Y=new d2e,ce=new E2e(J,ae,ge,Y,fe,Ve,ve),de=new HTe(m),xe=new WTe(m),Ce=new rMe(J,fe),me=new UTe(J,ae,Ce,fe),Ne=new qTe(J,Ce,ve,me),Ie=new $Te(J,Ne,Ce,ve),Ee=new ZTe(J,fe,ce),O=new GTe(Y),Ge=new h2e(m,de,xe,ae,fe,me,O),tt=new R2e(m,Y),at=new p2e,ee=new _2e(ae,fe),ue=new NTe(m,de,xe,ge,Ie,h,o),V=new A2e(m,Ie,fe),be=new I2e(J,ve,fe,ge),Te=new kTe(J,ae,ve,fe),We=new YTe(J,ae,ve,fe),ve.programs=Ge.programs,m.capabilities=fe,m.extensions=ae,m.properties=Y,m.renderLists=at,m.shadowMap=V,m.state=ge,m.info=ve}ne();let Ae=new D2e(m,J);this.xr=Ae,this.getContext=function(){return J},this.getContextAttributes=function(){return J.getContextAttributes()},this.forceContextLoss=function(){let ie=ae.get("WEBGL_lose_context");ie&&ie.loseContext()},this.forceContextRestore=function(){let ie=ae.get("WEBGL_lose_context");ie&&ie.restoreContext()},this.getPixelRatio=function(){return R},this.setPixelRatio=function(ie){ie!==void 0&&(R=ie,this.setSize(T,P,!1))},this.getSize=function(ie){return ie.set(T,P)},this.setSize=function(ie,Le,Xe){if(Ae.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}T=ie,P=Le,e.width=Math.floor(ie*R),e.height=Math.floor(Le*R),Xe!==!1&&(e.style.width=ie+"px",e.style.height=Le+"px"),this.setViewport(0,0,ie,Le)},this.getDrawingBufferSize=function(ie){return ie.set(T*R,P*R).floor()},this.setDrawingBufferSize=function(ie,Le,Xe){T=ie,P=Le,R=Xe,e.width=Math.floor(ie*Xe),e.height=Math.floor(Le*Xe),this.setViewport(0,0,ie,Le)},this.getCurrentViewport=function(ie){return ie.copy(A)},this.getViewport=function(ie){return ie.copy(N)},this.setViewport=function(ie,Le,Xe,De){ie.isVector4?N.set(ie.x,ie.y,ie.z,ie.w):N.set(ie,Le,Xe,De),ge.viewport(A.copy(N).multiplyScalar(R).floor())},this.getScissor=function(ie){return ie.copy(W)},this.setScissor=function(ie,Le,Xe,De){ie.isVector4?W.set(ie.x,ie.y,ie.z,ie.w):W.set(ie,Le,Xe,De),ge.scissor(E.copy(W).multiplyScalar(R).floor())},this.getScissorTest=function(){return Q},this.setScissorTest=function(ie){ge.setScissorTest(Q=ie)},this.setOpaqueSort=function(ie){U=ie},this.setTransparentSort=function(ie){F=ie},this.getClearColor=function(ie){return ie.copy(ue.getClearColor())},this.setClearColor=function(){ue.setClearColor.apply(ue,arguments)},this.getClearAlpha=function(){return ue.getClearAlpha()},this.setClearAlpha=function(){ue.setClearAlpha.apply(ue,arguments)},this.clear=function(ie=!0,Le=!0,Xe=!0){let De=0;ie&&(De|=16384),Le&&(De|=256),Xe&&(De|=1024),J.clear(De)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",ke,!1),e.removeEventListener("webglcontextrestored",Ue,!1),e.removeEventListener("webglcontextcreationerror",Je,!1),at.dispose(),ee.dispose(),Y.dispose(),de.dispose(),xe.dispose(),Ie.dispose(),me.dispose(),be.dispose(),Ge.dispose(),Ae.dispose(),Ae.removeEventListener("sessionstart",Be),Ae.removeEventListener("sessionend",qe),z&&(z.dispose(),z=null),mt.stop()};function ke(ie){ie.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),v=!0}function Ue(){console.log("THREE.WebGLRenderer: Context Restored."),v=!1;let ie=ve.autoReset,Le=V.enabled,Xe=V.autoUpdate,De=V.needsUpdate,Ye=V.type;ne(),ve.autoReset=ie,V.enabled=Le,V.autoUpdate=Xe,V.needsUpdate=De,V.type=Ye}function Je(ie){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ie.statusMessage)}function ut(ie){let Le=ie.target;Le.removeEventListener("dispose",ut),Pt(Le)}function Pt(ie){q(ie),Y.remove(ie)}function q(ie){let Le=Y.get(ie).programs;Le!==void 0&&(Le.forEach(function(Xe){Ge.releaseProgram(Xe)}),ie.isShaderMaterial&&Ge.releaseShaderCache(ie))}this.renderBufferDirect=function(ie,Le,Xe,De,Ye,bt){Le===null&&(Le=K);let $=Ye.isMesh&&Ye.matrixWorld.determinant()<0,we=Em(ie,Le,Xe,De,Ye);ge.setMaterial(De,$);let Re=Xe.index,_e=1;De.wireframe===!0&&(Re=Ne.getWireframeAttribute(Xe),_e=2);let Oe=Xe.drawRange,et=Xe.attributes.position,vt=Oe.start*_e,St=(Oe.start+Oe.count)*_e;bt!==null&&(vt=Math.max(vt,bt.start*_e),St=Math.min(St,(bt.start+bt.count)*_e)),Re!==null?(vt=Math.max(vt,0),St=Math.min(St,Re.count)):et!=null&&(vt=Math.max(vt,0),St=Math.min(St,et.count));let Tt=St-vt;if(Tt<0||Tt===1/0)return;me.setup(Ye,De,we,Xe,Re);let Ht,xt=Te;if(Re!==null&&(Ht=Ce.get(Re),xt=We,xt.setIndex(Ht)),Ye.isMesh)De.wireframe===!0?(ge.setLineWidth(De.wireframeLinewidth*re()),xt.setMode(1)):xt.setMode(4);else if(Ye.isLine){let lt=De.linewidth;lt===void 0&&(lt=1),ge.setLineWidth(lt*re()),Ye.isLineSegments?xt.setMode(1):Ye.isLineLoop?xt.setMode(2):xt.setMode(3)}else Ye.isPoints?xt.setMode(0):Ye.isSprite&&xt.setMode(4);if(Ye.isInstancedMesh)xt.renderInstances(vt,Tt,Ye.count);else if(Xe.isInstancedBufferGeometry){let lt=Xe._maxInstanceCount!==void 0?Xe._maxInstanceCount:1/0,Bi=Math.min(Xe.instanceCount,lt);xt.renderInstances(vt,Tt,Bi)}else xt.render(vt,Tt)},this.compile=function(ie,Le){function Xe(De,Ye,bt){De.transparent===!0&&De.side===Wo&&De.forceSinglePass===!1?(De.side=kr,De.needsUpdate=!0,Li(De,Ye,bt),De.side=Hl,De.needsUpdate=!0,Li(De,Ye,bt),De.side=Wo):Li(De,Ye,bt)}d=ee.get(ie),d.init(),p.push(d),ie.traverseVisible(function(De){De.isLight&&De.layers.test(Le.layers)&&(d.pushLight(De),De.castShadow&&d.pushShadow(De))}),d.setupLights(m.physicallyCorrectLights),ie.traverse(function(De){let Ye=De.material;if(Ye)if(Array.isArray(Ye))for(let bt=0;bt<Ye.length;bt++){let $=Ye[bt];Xe($,ie,De)}else Xe(Ye,ie,De)}),p.pop(),d=null};let pe=null;function oe(ie){pe&&pe(ie)}function Be(){mt.stop()}function qe(){mt.start()}let mt=new Cee;mt.setAnimationLoop(oe),typeof self<"u"&&mt.setContext(self),this.setAnimationLoop=function(ie){pe=ie,Ae.setAnimationLoop(ie),ie===null?mt.stop():mt.start()},Ae.addEventListener("sessionstart",Be),Ae.addEventListener("sessionend",qe),this.render=function(ie,Le){if(Le!==void 0&&Le.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(v===!0)return;ie.matrixWorldAutoUpdate===!0&&ie.updateMatrixWorld(),Le.parent===null&&Le.matrixWorldAutoUpdate===!0&&Le.updateMatrixWorld(),Ae.enabled===!0&&Ae.isPresenting===!0&&(Ae.cameraAutoUpdate===!0&&Ae.updateCamera(Le),Le=Ae.getCamera()),ie.isScene===!0&&ie.onBeforeRender(m,ie,Le,x),d=ee.get(ie,p.length),d.init(),p.push(d),k.multiplyMatrices(Le.projectionMatrix,Le.matrixWorldInverse),X.setFromProjectionMatrix(k),j=this.localClippingEnabled,B=O.init(this.clippingPlanes,j),u=at.get(ie,f.length),u.init(),f.push(u),qt(ie,Le,0,m.sortObjects),u.finish(),m.sortObjects===!0&&u.sort(U,F),B===!0&&O.beginShadows();let Xe=d.state.shadowsArray;if(V.render(Xe,ie,Le),B===!0&&O.endShadows(),this.info.autoReset===!0&&this.info.reset(),ue.render(u,ie),d.setupLights(m.physicallyCorrectLights),Le.isArrayCamera){let De=Le.cameras;for(let Ye=0,bt=De.length;Ye<bt;Ye++){let $=De[Ye];mi(u,ie,$,$.viewport)}}else mi(u,ie,Le);x!==null&&(ce.updateMultisampleRenderTarget(x),ce.updateRenderTargetMipmap(x)),ie.isScene===!0&&ie.onAfterRender(m,ie,Le),me.resetDefaultState(),b=-1,S=null,p.pop(),p.length>0?d=p[p.length-1]:d=null,f.pop(),f.length>0?u=f[f.length-1]:u=null};function qt(ie,Le,Xe,De){if(ie.visible===!1)return;if(ie.layers.test(Le.layers)){if(ie.isGroup)Xe=ie.renderOrder;else if(ie.isLOD)ie.autoUpdate===!0&&ie.update(Le);else if(ie.isLight)d.pushLight(ie),ie.castShadow&&d.pushShadow(ie);else if(ie.isSprite){if(!ie.frustumCulled||X.intersectsSprite(ie)){De&&Z.setFromMatrixPosition(ie.matrixWorld).applyMatrix4(k);let bt=Ie.update(ie),$=ie.material;$.visible&&u.push(ie,bt,$,Xe,Z.z,null)}}else if((ie.isMesh||ie.isLine||ie.isPoints)&&(ie.isSkinnedMesh&&ie.skeleton.frame!==ve.render.frame&&(ie.skeleton.update(),ie.skeleton.frame=ve.render.frame),!ie.frustumCulled||X.intersectsObject(ie))){De&&Z.setFromMatrixPosition(ie.matrixWorld).applyMatrix4(k);let bt=Ie.update(ie),$=ie.material;if(Array.isArray($)){let we=bt.groups;for(let Re=0,_e=we.length;Re<_e;Re++){let Oe=we[Re],et=$[Oe.materialIndex];et&&et.visible&&u.push(ie,bt,et,Xe,Z.z,Oe)}}else $.visible&&u.push(ie,bt,$,Xe,Z.z,null)}}let Ye=ie.children;for(let bt=0,$=Ye.length;bt<$;bt++)qt(Ye[bt],Le,Xe,De)}function mi(ie,Le,Xe,De){let Ye=ie.opaque,bt=ie.transmissive,$=ie.transparent;d.setupLightsView(Xe),B===!0&&O.setGlobalState(m.clippingPlanes,Xe),bt.length>0&&zn(Ye,Le,Xe),De&&ge.viewport(A.copy(De)),Ye.length>0&&kt(Ye,Le,Xe),bt.length>0&&kt(bt,Le,Xe),$.length>0&&kt($,Le,Xe),ge.buffers.depth.setTest(!0),ge.buffers.depth.setMask(!0),ge.buffers.color.setMask(!0),ge.setPolygonOffset(!1)}function zn(ie,Le,Xe){let De=fe.isWebGL2;z===null&&(z=new Hi(1,1,{generateMipmaps:!0,type:ae.has("EXT_color_buffer_half_float")?N0:As,minFilter:F0,samples:De&&s===!0?4:0})),m.getDrawingBufferSize(G),De?z.setSize(G.x,G.y):z.setSize($E(G.x),$E(G.y));let Ye=m.getRenderTarget();m.setRenderTarget(z),m.clear();let bt=m.toneMapping;m.toneMapping=ih,kt(ie,Le,Xe),m.toneMapping=bt,ce.updateMultisampleRenderTarget(z),ce.updateRenderTargetMipmap(z),m.setRenderTarget(Ye)}function kt(ie,Le,Xe){let De=Le.isScene===!0?Le.overrideMaterial:null;for(let Ye=0,bt=ie.length;Ye<bt;Ye++){let $=ie[Ye],we=$.object,Re=$.geometry,_e=De===null?$.material:De,Oe=$.group;we.layers.test(Xe.layers)&&mn(we,Le,Xe,Re,_e,Oe)}}function mn(ie,Le,Xe,De,Ye,bt){ie.onBeforeRender(m,Le,Xe,De,Ye,bt),ie.modelViewMatrix.multiplyMatrices(Xe.matrixWorldInverse,ie.matrixWorld),ie.normalMatrix.getNormalMatrix(ie.modelViewMatrix),Ye.onBeforeRender(m,Le,Xe,De,ie,bt),Ye.transparent===!0&&Ye.side===Wo&&Ye.forceSinglePass===!1?(Ye.side=kr,Ye.needsUpdate=!0,m.renderBufferDirect(Xe,Le,De,Ye,ie,bt),Ye.side=Hl,Ye.needsUpdate=!0,m.renderBufferDirect(Xe,Le,De,Ye,ie,bt),Ye.side=Wo):m.renderBufferDirect(Xe,Le,De,Ye,ie,bt),ie.onAfterRender(m,Le,Xe,De,Ye,bt)}function Li(ie,Le,Xe){Le.isScene!==!0&&(Le=K);let De=Y.get(ie),Ye=d.state.lights,bt=d.state.shadowsArray,$=Ye.state.version,we=Ge.getParameters(ie,Ye.state,bt,Le,Xe),Re=Ge.getProgramCacheKey(we),_e=De.programs;De.environment=ie.isMeshStandardMaterial?Le.environment:null,De.fog=Le.fog,De.envMap=(ie.isMeshStandardMaterial?xe:de).get(ie.envMap||De.environment),_e===void 0&&(ie.addEventListener("dispose",ut),_e=new Map,De.programs=_e);let Oe=_e.get(Re);if(Oe!==void 0){if(De.currentProgram===Oe&&De.lightsStateVersion===$)return gf(ie,we),Oe}else we.uniforms=Ge.getUniforms(ie),ie.onBuild(Xe,we,m),ie.onBeforeCompile(we,m),Oe=Ge.acquireProgram(we,Re),_e.set(Re,Oe),De.uniforms=we.uniforms;let et=De.uniforms;(!ie.isShaderMaterial&&!ie.isRawShaderMaterial||ie.clipping===!0)&&(et.clippingPlanes=O.uniform),gf(ie,we),De.needsLights=Kl(ie),De.lightsStateVersion=$,De.needsLights&&(et.ambientLightColor.value=Ye.state.ambient,et.lightProbe.value=Ye.state.probe,et.directionalLights.value=Ye.state.directional,et.directionalLightShadows.value=Ye.state.directionalShadow,et.spotLights.value=Ye.state.spot,et.spotLightShadows.value=Ye.state.spotShadow,et.rectAreaLights.value=Ye.state.rectArea,et.ltc_1.value=Ye.state.rectAreaLTC1,et.ltc_2.value=Ye.state.rectAreaLTC2,et.pointLights.value=Ye.state.point,et.pointLightShadows.value=Ye.state.pointShadow,et.hemisphereLights.value=Ye.state.hemi,et.directionalShadowMap.value=Ye.state.directionalShadowMap,et.directionalShadowMatrix.value=Ye.state.directionalShadowMatrix,et.spotShadowMap.value=Ye.state.spotShadowMap,et.spotLightMatrix.value=Ye.state.spotLightMatrix,et.spotLightMap.value=Ye.state.spotLightMap,et.pointShadowMap.value=Ye.state.pointShadowMap,et.pointShadowMatrix.value=Ye.state.pointShadowMatrix);let vt=Oe.getUniforms(),St=HM.seqWithValue(vt.seq,et);return De.currentProgram=Oe,De.uniformsList=St,Oe}function gf(ie,Le){let Xe=Y.get(ie);Xe.outputEncoding=Le.outputEncoding,Xe.instancing=Le.instancing,Xe.skinning=Le.skinning,Xe.morphTargets=Le.morphTargets,Xe.morphNormals=Le.morphNormals,Xe.morphColors=Le.morphColors,Xe.morphTargetsCount=Le.morphTargetsCount,Xe.numClippingPlanes=Le.numClippingPlanes,Xe.numIntersection=Le.numClipIntersection,Xe.vertexAlphas=Le.vertexAlphas,Xe.vertexTangents=Le.vertexTangents,Xe.toneMapping=Le.toneMapping}function Em(ie,Le,Xe,De,Ye){Le.isScene!==!0&&(Le=K),ce.resetTextureUnits();let bt=Le.fog,$=De.isMeshStandardMaterial?Le.environment:null,we=x===null?m.outputEncoding:x.isXRRenderTarget===!0?x.texture.encoding:Yc,Re=(De.isMeshStandardMaterial?xe:de).get(De.envMap||$),_e=De.vertexColors===!0&&!!Xe.attributes.color&&Xe.attributes.color.itemSize===4,Oe=!!De.normalMap&&!!Xe.attributes.tangent,et=!!Xe.morphAttributes.position,vt=!!Xe.morphAttributes.normal,St=!!Xe.morphAttributes.color,Tt=De.toneMapped?m.toneMapping:ih,Ht=Xe.morphAttributes.position||Xe.morphAttributes.normal||Xe.morphAttributes.color,xt=Ht!==void 0?Ht.length:0,lt=Y.get(De),Bi=d.state.lights;if(B===!0&&(j===!0||ie!==S)){let Mi=ie===S&&De.id===b;O.setState(De,ie,Mi)}let Ni=!1;De.version===lt.__version?(lt.needsLights&&lt.lightsStateVersion!==Bi.state.version||lt.outputEncoding!==we||Ye.isInstancedMesh&&lt.instancing===!1||!Ye.isInstancedMesh&&lt.instancing===!0||Ye.isSkinnedMesh&&lt.skinning===!1||!Ye.isSkinnedMesh&&lt.skinning===!0||lt.envMap!==Re||De.fog===!0&&lt.fog!==bt||lt.numClippingPlanes!==void 0&&(lt.numClippingPlanes!==O.numPlanes||lt.numIntersection!==O.numIntersection)||lt.vertexAlphas!==_e||lt.vertexTangents!==Oe||lt.morphTargets!==et||lt.morphNormals!==vt||lt.morphColors!==St||lt.toneMapping!==Tt||fe.isWebGL2===!0&&lt.morphTargetsCount!==xt)&&(Ni=!0):(Ni=!0,lt.__version=De.version);let Gn=lt.currentProgram;Ni===!0&&(Gn=Li(De,Le,Ye));let ns=!1,Ai=!1,Vt=!1,jt=Gn.getUniforms(),Lt=lt.uniforms;if(ge.useProgram(Gn.program)&&(ns=!0,Ai=!0,Vt=!0),De.id!==b&&(b=De.id,Ai=!0),ns||S!==ie){if(jt.setValue(J,"projectionMatrix",ie.projectionMatrix),fe.logarithmicDepthBuffer&&jt.setValue(J,"logDepthBufFC",2/(Math.log(ie.far+1)/Math.LN2)),S!==ie&&(S=ie,Ai=!0,Vt=!0),De.isShaderMaterial||De.isMeshPhongMaterial||De.isMeshToonMaterial||De.isMeshStandardMaterial||De.envMap){let Mi=jt.map.cameraPosition;Mi!==void 0&&Mi.setValue(J,Z.setFromMatrixPosition(ie.matrixWorld))}(De.isMeshPhongMaterial||De.isMeshToonMaterial||De.isMeshLambertMaterial||De.isMeshBasicMaterial||De.isMeshStandardMaterial||De.isShaderMaterial)&&jt.setValue(J,"isOrthographic",ie.isOrthographicCamera===!0),(De.isMeshPhongMaterial||De.isMeshToonMaterial||De.isMeshLambertMaterial||De.isMeshBasicMaterial||De.isMeshStandardMaterial||De.isShaderMaterial||De.isShadowMaterial||Ye.isSkinnedMesh)&&jt.setValue(J,"viewMatrix",ie.matrixWorldInverse)}if(Ye.isSkinnedMesh){jt.setOptional(J,Ye,"bindMatrix"),jt.setOptional(J,Ye,"bindMatrixInverse");let Mi=Ye.skeleton;Mi&&(fe.floatVertexTextures?(Mi.boneTexture===null&&Mi.computeBoneTexture(),jt.setValue(J,"boneTexture",Mi.boneTexture,ce),jt.setValue(J,"boneTextureSize",Mi.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let $n=Xe.morphAttributes;if(($n.position!==void 0||$n.normal!==void 0||$n.color!==void 0&&fe.isWebGL2===!0)&&Ee.update(Ye,Xe,De,Gn),(Ai||lt.receiveShadow!==Ye.receiveShadow)&&(lt.receiveShadow=Ye.receiveShadow,jt.setValue(J,"receiveShadow",Ye.receiveShadow)),De.isMeshGouraudMaterial&&De.envMap!==null&&(Lt.envMap.value=Re,Lt.flipEnvMap.value=Re.isCubeTexture&&Re.isRenderTargetTexture===!1?-1:1),Ai&&(jt.setValue(J,"toneMappingExposure",m.toneMappingExposure),lt.needsLights&&Tm(Lt,Vt),bt&&De.fog===!0&&tt.refreshFogUniforms(Lt,bt),tt.refreshMaterialUniforms(Lt,De,R,P,z),HM.upload(J,lt.uniformsList,Lt,ce)),De.isShaderMaterial&&De.uniformsNeedUpdate===!0&&(HM.upload(J,lt.uniformsList,Lt,ce),De.uniformsNeedUpdate=!1),De.isSpriteMaterial&&jt.setValue(J,"center",Ye.center),jt.setValue(J,"modelViewMatrix",Ye.modelViewMatrix),jt.setValue(J,"normalMatrix",Ye.normalMatrix),jt.setValue(J,"modelMatrix",Ye.matrixWorld),Ye.previousModelViewMatrix&&jt.setValue(J,"previousModelViewMatrix",Ye.previousModelViewMatrix),ie.previousProjectionMatrix&&jt.setValue(J,"previousProjectionMatrix",ie.previousProjectionMatrix),De.isShaderMaterial||De.isRawShaderMaterial){let Mi=De.uniformsGroups;for(let un=0,To=Mi.length;un<To;un++)if(fe.isWebGL2){let rn=Mi[un];be.update(rn,Gn),be.bind(rn,Gn)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Gn}function Tm(ie,Le){ie.ambientLightColor.needsUpdate=Le,ie.lightProbe.needsUpdate=Le,ie.directionalLights.needsUpdate=Le,ie.directionalLightShadows.needsUpdate=Le,ie.pointLights.needsUpdate=Le,ie.pointLightShadows.needsUpdate=Le,ie.spotLights.needsUpdate=Le,ie.spotLightShadows.needsUpdate=Le,ie.rectAreaLights.needsUpdate=Le,ie.hemisphereLights.needsUpdate=Le}function Kl(ie){return ie.isMeshLambertMaterial||ie.isMeshToonMaterial||ie.isMeshPhongMaterial||ie.isMeshStandardMaterial||ie.isShadowMaterial||ie.isShaderMaterial&&ie.lights===!0}this.getActiveCubeFace=function(){return g},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return x},this.setRenderTargetTextures=function(ie,Le,Xe){Y.get(ie.texture).__webglTexture=Le,Y.get(ie.depthTexture).__webglTexture=Xe;let De=Y.get(ie);De.__hasExternalTextures=!0,De.__hasExternalTextures&&(De.__autoAllocateDepthBuffer=Xe===void 0,De.__autoAllocateDepthBuffer||ae.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),De.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(ie,Le){let Xe=Y.get(ie);Xe.__webglFramebuffer=Le,Xe.__useDefaultFramebuffer=Le===void 0},this.setRenderTarget=function(ie,Le=0,Xe=0){x=ie,g=Le,y=Xe;let De=!0,Ye=null,bt=!1,$=!1;if(ie){let we=Y.get(ie);we.__useDefaultFramebuffer!==void 0?(ge.bindFramebuffer(36160,null),De=!1):we.__webglFramebuffer===void 0?ce.setupRenderTarget(ie):we.__hasExternalTextures&&ce.rebindTextures(ie,Y.get(ie.texture).__webglTexture,Y.get(ie.depthTexture).__webglTexture);let Re=ie.texture;(Re.isData3DTexture||Re.isDataArrayTexture||Re.isCompressedArrayTexture)&&($=!0);let _e=Y.get(ie).__webglFramebuffer;ie.isWebGLCubeRenderTarget?(Ye=_e[Le],bt=!0):fe.isWebGL2&&ie.samples>0&&ce.useMultisampledRTT(ie)===!1?Ye=Y.get(ie).__webglMultisampledFramebuffer:Ye=_e,A.copy(ie.viewport),E.copy(ie.scissor),M=ie.scissorTest}else A.copy(N).multiplyScalar(R).floor(),E.copy(W).multiplyScalar(R).floor(),M=Q;if(ge.bindFramebuffer(36160,Ye)&&fe.drawBuffers&&De&&ge.drawBuffers(ie,Ye),ge.viewport(A),ge.scissor(E),ge.setScissorTest(M),bt){let we=Y.get(ie.texture);J.framebufferTexture2D(36160,36064,34069+Le,we.__webglTexture,Xe)}else if($){let we=Y.get(ie.texture),Re=Le||0;J.framebufferTextureLayer(36160,36064,we.__webglTexture,Xe||0,Re)}b=-1},this.readRenderTargetPixels=function(ie,Le,Xe,De,Ye,bt,$){if(!(ie&&ie.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let we=Y.get(ie).__webglFramebuffer;if(ie.isWebGLCubeRenderTarget&&$!==void 0&&(we=we[$]),we){ge.bindFramebuffer(36160,we);try{let Re=ie.texture,_e=Re.format,Oe=Re.type;if(_e!==za&&Ve.convert(_e)!==J.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let et=Oe===N0&&(ae.has("EXT_color_buffer_half_float")||fe.isWebGL2&&ae.has("EXT_color_buffer_float"));if(Oe!==As&&Ve.convert(Oe)!==J.getParameter(35738)&&!(Oe===Xo&&(fe.isWebGL2||ae.has("OES_texture_float")||ae.has("WEBGL_color_buffer_float")))&&!et){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Le>=0&&Le<=ie.width-De&&Xe>=0&&Xe<=ie.height-Ye&&J.readPixels(Le,Xe,De,Ye,Ve.convert(_e),Ve.convert(Oe),bt)}finally{let Re=x!==null?Y.get(x).__webglFramebuffer:null;ge.bindFramebuffer(36160,Re)}}},this.copyFramebufferToTexture=function(ie,Le,Xe=0){let De=Math.pow(2,-Xe),Ye=Math.floor(Le.image.width*De),bt=Math.floor(Le.image.height*De);ce.setTexture2D(Le,0),J.copyTexSubImage2D(3553,Xe,0,0,ie.x,ie.y,Ye,bt),ge.unbindTexture()},this.copyTextureToTexture=function(ie,Le,Xe,De=0){let Ye=Le.image.width,bt=Le.image.height,$=Ve.convert(Xe.format),we=Ve.convert(Xe.type);ce.setTexture2D(Xe,0),J.pixelStorei(37440,Xe.flipY),J.pixelStorei(37441,Xe.premultiplyAlpha),J.pixelStorei(3317,Xe.unpackAlignment),Le.isDataTexture?J.texSubImage2D(3553,De,ie.x,ie.y,Ye,bt,$,we,Le.image.data):Le.isCompressedTexture?J.compressedTexSubImage2D(3553,De,ie.x,ie.y,Le.mipmaps[0].width,Le.mipmaps[0].height,$,Le.mipmaps[0].data):J.texSubImage2D(3553,De,ie.x,ie.y,$,we,Le.image),De===0&&Xe.generateMipmaps&&J.generateMipmap(3553),ge.unbindTexture()},this.copyTextureToTexture3D=function(ie,Le,Xe,De,Ye=0){if(m.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let bt=ie.max.x-ie.min.x+1,$=ie.max.y-ie.min.y+1,we=ie.max.z-ie.min.z+1,Re=Ve.convert(De.format),_e=Ve.convert(De.type),Oe;if(De.isData3DTexture)ce.setTexture3D(De,0),Oe=32879;else if(De.isDataArrayTexture)ce.setTexture2DArray(De,0),Oe=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}J.pixelStorei(37440,De.flipY),J.pixelStorei(37441,De.premultiplyAlpha),J.pixelStorei(3317,De.unpackAlignment);let et=J.getParameter(3314),vt=J.getParameter(32878),St=J.getParameter(3316),Tt=J.getParameter(3315),Ht=J.getParameter(32877),xt=Xe.isCompressedTexture?Xe.mipmaps[0]:Xe.image;J.pixelStorei(3314,xt.width),J.pixelStorei(32878,xt.height),J.pixelStorei(3316,ie.min.x),J.pixelStorei(3315,ie.min.y),J.pixelStorei(32877,ie.min.z),Xe.isDataTexture||Xe.isData3DTexture?J.texSubImage3D(Oe,Ye,Le.x,Le.y,Le.z,bt,$,we,Re,_e,xt.data):Xe.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),J.compressedTexSubImage3D(Oe,Ye,Le.x,Le.y,Le.z,bt,$,we,Re,xt.data)):J.texSubImage3D(Oe,Ye,Le.x,Le.y,Le.z,bt,$,we,Re,_e,xt),J.pixelStorei(3314,et),J.pixelStorei(32878,vt),J.pixelStorei(3316,St),J.pixelStorei(3315,Tt),J.pixelStorei(32877,Ht),Ye===0&&De.generateMipmaps&&J.generateMipmap(Oe),ge.unbindTexture()},this.initTexture=function(ie){ie.isCubeTexture?ce.setTextureCube(ie,0):ie.isData3DTexture?ce.setTexture3D(ie,0):ie.isDataArrayTexture||ie.isCompressedArrayTexture?ce.setTexture2DArray(ie,0):ce.setTexture2D(ie,0),ge.unbindTexture()},this.resetState=function(){g=0,y=0,x=null,ge.reset(),me.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var B2e=class extends Bee{};B2e.prototype.isWebGL1Renderer=!0;var Oee=class{constructor(t,e=1,i=1e3){this.isFog=!0,this.name="",this.color=new It(t),this.near=e,this.far=i}clone(){return new Oee(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},Nd=class extends ji{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){let e=super.toJSON(t);return this.fog!==null&&(e.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(e.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(e.object.backgroundIntensity=this.backgroundIntensity),e}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(t){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=t}},O2e=class{constructor(t,e){this.isInterleavedBuffer=!0,this.array=t,this.stride=e,this.count=t!==void 0?t.length/e:0,this.usage=NB,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=qa()}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,i){t*=this.stride,i*=e.stride;for(let n=0,r=this.stride;n<r;n++)this.array[t+n]=e.array[i+n];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=qa()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(e,this.stride);return i.setUsage(this.usage),i}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=qa()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},Is=new L,GB=class{constructor(t,e,i,n=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=t,this.itemSize=e,this.offset=i,this.normalized=n}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,i=this.data.count;e<i;e++)Is.fromBufferAttribute(this,e),Is.applyMatrix4(t),this.setXYZ(e,Is.x,Is.y,Is.z);return this}applyNormalMatrix(t){for(let e=0,i=this.count;e<i;e++)Is.fromBufferAttribute(this,e),Is.applyNormalMatrix(t),this.setXYZ(e,Is.x,Is.y,Is.z);return this}transformDirection(t){for(let e=0,i=this.count;e<i;e++)Is.fromBufferAttribute(this,e),Is.transformDirection(t),this.setXYZ(e,Is.x,Is.y,Is.z);return this}setX(t,e){return this.normalized&&(e=Ki(e,this.array)),this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.normalized&&(e=Ki(e,this.array)),this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.normalized&&(e=Ki(e,this.array)),this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.normalized&&(e=Ki(e,this.array)),this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){let e=this.data.array[t*this.data.stride+this.offset];return this.normalized&&(e=Ku(e,this.array)),e}getY(t){let e=this.data.array[t*this.data.stride+this.offset+1];return this.normalized&&(e=Ku(e,this.array)),e}getZ(t){let e=this.data.array[t*this.data.stride+this.offset+2];return this.normalized&&(e=Ku(e,this.array)),e}getW(t){let e=this.data.array[t*this.data.stride+this.offset+3];return this.normalized&&(e=Ku(e,this.array)),e}setXY(t,e,i){return t=t*this.data.stride+this.offset,this.normalized&&(e=Ki(e,this.array),i=Ki(i,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=i,this}setXYZ(t,e,i,n){return t=t*this.data.stride+this.offset,this.normalized&&(e=Ki(e,this.array),i=Ki(i,this.array),n=Ki(n,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this}setXYZW(t,e,i,n,r){return t=t*this.data.stride+this.offset,this.normalized&&(e=Ki(e,this.array),i=Ki(i,this.array),n=Ki(n,this.array),r=Ki(r,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this.data.array[t+3]=r,this}clone(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let i=0;i<this.count;i++){let n=i*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)e.push(this.data.array[n+r])}return new Gt(new this.array.constructor(e),this.itemSize,this.normalized)}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new GB(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let i=0;i<this.count;i++){let n=i*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)e.push(this.data.array[n+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},Fee=class extends ji{constructor(){super(),this.isBone=!0,this.type="Bone"}},tT=class extends br{constructor(t=null,e=1,i=1,n,r,s,o,a,l=Zi,c=Zi,h,u){super(null,s,o,a,l,c,n,r,h,u),this.isDataTexture=!0,this.image={data:t,width:e,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},SW=new $e,F2e=new $e,fk=class{constructor(t=[],e=[]){this.uuid=qa(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(t.length*16),e.length===0)this.calculateInverses();else if(t.length!==e.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,n=this.bones.length;i<n;i++)this.boneInverses.push(new $e)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,e=this.bones.length;t<e;t++){let i=new $e;this.bones[t]&&i.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let t=0,e=this.bones.length;t<e;t++){let i=this.bones[t];i&&i.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,e=this.bones.length;t<e;t++){let i=this.bones[t];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){let t=this.bones,e=this.boneInverses,i=this.boneMatrices,n=this.boneTexture;for(let r=0,s=t.length;r<s;r++){let o=t[r]?t[r].matrixWorld:F2e;SW.multiplyMatrices(o,e[r]),SW.toArray(i,r*16)}n!==null&&(n.needsUpdate=!0)}clone(){return new fk(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(this.bones.length*4);t=_ee(t),t=Math.max(t,4);let e=new Float32Array(t*t*4);e.set(this.boneMatrices);let i=new tT(e,t,t,za,Xo);return i.needsUpdate=!0,this.boneMatrices=e,this.boneTexture=i,this.boneTextureSize=t,this}getBoneByName(t){for(let e=0,i=this.bones.length;e<i;e++){let n=this.bones[e];if(n.name===t)return n}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,e){this.uuid=t.uuid;for(let i=0,n=t.bones.length;i<n;i++){let r=t.bones[i],s=e[r];s===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),s=new Fee),this.bones.push(s),this.boneInverses.push(new $e().fromArray(t.boneInverses[i]))}return this.init(),this}toJSON(){let t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;let e=this.bones,i=this.boneInverses;for(let n=0,r=e.length;n<r;n++){let s=e[n];t.bones.push(s.uuid);let o=i[n];t.boneInverses.push(o.toArray())}return t}},N2e=class extends Gt{constructor(t,e,i,n=1){super(t,e,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){let t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}},ff=class extends Lw{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new It(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}},AW=new L,MW=new L,EW=new $e,JR=new ay,mA=new sa,iT=class extends ji{constructor(t=new Ut,e=new ff){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){let t=this.geometry;if(t.index===null){let e=t.attributes.position,i=[0];for(let n=1,r=e.count;n<r;n++)AW.fromBufferAttribute(e,n-1),MW.fromBufferAttribute(e,n),i[n]=i[n-1],i[n]+=AW.distanceTo(MW);t.setAttribute("lineDistance",new yt(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,e){let i=this.geometry,n=this.matrixWorld,r=t.params.Line.threshold,s=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),mA.copy(i.boundingSphere),mA.applyMatrix4(n),mA.radius+=r,t.ray.intersectsSphere(mA)===!1)return;EW.copy(n).invert(),JR.copy(t.ray).applyMatrix4(EW);let o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=new L,c=new L,h=new L,u=new L,d=this.isLineSegments?2:1,f=i.index,p=i.attributes.position;if(f!==null){let m=Math.max(0,s.start),v=Math.min(f.count,s.start+s.count);for(let g=m,y=v-1;g<y;g+=d){let x=f.getX(g),b=f.getX(g+1);if(l.fromBufferAttribute(p,x),c.fromBufferAttribute(p,b),JR.distanceSqToSegment(l,c,u,h)>a)continue;u.applyMatrix4(this.matrixWorld);let S=t.ray.origin.distanceTo(u);S<t.near||S>t.far||e.push({distance:S,point:h.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this})}}else{let m=Math.max(0,s.start),v=Math.min(p.count,s.start+s.count);for(let g=m,y=v-1;g<y;g+=d){if(l.fromBufferAttribute(p,g),c.fromBufferAttribute(p,g+1),JR.distanceSqToSegment(l,c,u,h)>a)continue;u.applyMatrix4(this.matrixWorld);let x=t.ray.origin.distanceTo(u);x<t.near||x>t.far||e.push({distance:x,point:h.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){let i=t[e[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,r=i.length;n<r;n++){let s=i[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=n}}}}},TW=new L,CW=new L,Bw=class extends iT{constructor(t,e){super(t,e),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let t=this.geometry;if(t.index===null){let e=t.attributes.position,i=[];for(let n=0,r=e.count;n<r;n+=2)TW.fromBufferAttribute(e,n),CW.fromBufferAttribute(e,n+1),i[n]=n===0?0:i[n-1],i[n+1]=i[n]+TW.distanceTo(CW);t.setAttribute("lineDistance",new yt(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},U2e=class extends br{constructor(t,e,i,n,r,s,o,a,l){super(t,e,i,n,r,s,o,a,l),this.isVideoTexture=!0,this.minFilter=s!==void 0?s:ri,this.magFilter=r!==void 0?r:ri,this.generateMipmaps=!1;let c=this;function h(){c.needsUpdate=!0,t.requestVideoFrameCallback(h)}"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(h)}clone(){return new this.constructor(this.image).copy(this)}update(){let t=this.image;!("requestVideoFrameCallback"in t)&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},tu=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){let i=this.getUtoTmapping(t);return this.getPoint(i,e)}getPoints(t=5){let e=[];for(let i=0;i<=t;i++)e.push(this.getPoint(i/t));return e}getSpacedPoints(t=5){let e=[];for(let i=0;i<=t;i++)e.push(this.getPointAt(i/t));return e}getLength(){let t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let e=[],i,n=this.getPoint(0),r=0;e.push(0);for(let s=1;s<=t;s++)i=this.getPoint(s/t),r+=i.distanceTo(n),e.push(r),n=i;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){let i=this.getLengths(),n=0,r=i.length,s;e?s=e:s=t*i[r-1];let o=0,a=r-1,l;for(;o<=a;)if(n=Math.floor(o+(a-o)/2),l=i[n]-s,l<0)o=n+1;else if(l>0)a=n-1;else{a=n;break}if(n=a,i[n]===s)return n/(r-1);let c=i[n],h=i[n+1]-c,u=(s-c)/h;return(n+u)/(r-1)}getTangent(t,e){let i=t-1e-4,n=t+1e-4;i<0&&(i=0),n>1&&(n=1);let r=this.getPoint(i),s=this.getPoint(n),o=e||(r.isVector2?new he:new L);return o.copy(s).sub(r).normalize(),o}getTangentAt(t,e){let i=this.getUtoTmapping(t);return this.getTangent(i,e)}computeFrenetFrames(t,e){let i=new L,n=[],r=[],s=[],o=new L,a=new $e;for(let d=0;d<=t;d++){let f=d/t;n[d]=this.getTangentAt(f,new L)}r[0]=new L,s[0]=new L;let l=Number.MAX_VALUE,c=Math.abs(n[0].x),h=Math.abs(n[0].y),u=Math.abs(n[0].z);c<=l&&(l=c,i.set(1,0,0)),h<=l&&(l=h,i.set(0,1,0)),u<=l&&i.set(0,0,1),o.crossVectors(n[0],i).normalize(),r[0].crossVectors(n[0],o),s[0].crossVectors(n[0],r[0]);for(let d=1;d<=t;d++){if(r[d]=r[d-1].clone(),s[d]=s[d-1].clone(),o.crossVectors(n[d-1],n[d]),o.length()>Number.EPSILON){o.normalize();let f=Math.acos(_r(n[d-1].dot(n[d]),-1,1));r[d].applyMatrix4(a.makeRotationAxis(o,f))}s[d].crossVectors(n[d],r[d])}if(e===!0){let d=Math.acos(_r(r[0].dot(r[t]),-1,1));d/=t,n[0].dot(o.crossVectors(r[0],r[t]))>0&&(d=-d);for(let f=1;f<=t;f++)r[f].applyMatrix4(a.makeRotationAxis(n[f],d*f)),s[f].crossVectors(n[f],r[f])}return{tangents:n,normals:r,binormals:s}}clone(){return new this.constructor().copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){let t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}},e2=class extends tu{constructor(t=0,e=0,i=1,n=1,r=0,s=Math.PI*2,o=!1,a=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=i,this.yRadius=n,this.aStartAngle=r,this.aEndAngle=s,this.aClockwise=o,this.aRotation=a}getPoint(t,e){let i=e||new he,n=Math.PI*2,r=this.aEndAngle-this.aStartAngle,s=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=n;for(;r>n;)r-=n;r<Number.EPSILON&&(s?r=0:r=n),this.aClockwise===!0&&!s&&(r===n?r=-n:r=r-n);let o=this.aStartAngle+t*r,a=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){let c=Math.cos(this.aRotation),h=Math.sin(this.aRotation),u=a-this.aX,d=l-this.aY;a=u*c-d*h+this.aX,l=u*h+d*c+this.aY}return i.set(a,l)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){let t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}},k2e=class extends e2{constructor(t,e,i,n,r,s){super(t,e,i,i,n,r,s),this.isArcCurve=!0,this.type="ArcCurve"}};function pk(){let t=0,e=0,i=0,n=0;function r(s,o,a,l){t=s,e=a,i=-3*s+3*o-2*a-l,n=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,h,u){let d=(o-s)/c-(a-s)/(c+h)+(a-o)/h,f=(a-o)/h-(l-o)/(h+u)+(l-a)/u;d*=h,f*=h,r(o,a,d,f)},calc:function(s){let o=s*s,a=o*s;return t+e*s+i*o+n*a}}}var gA=new L,ZR=new pk,$R=new pk,e3=new pk,z2e=class extends tu{constructor(t=[],e=!1,i="centripetal",n=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=i,this.tension=n}getPoint(t,e=new L){let i=e,n=this.points,r=n.length,s=(r-(this.closed?0:1))*t,o=Math.floor(s),a=s-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/r)+1)*r:a===0&&o===r-1&&(o=r-2,a=1);let l,c;this.closed||o>0?l=n[(o-1)%r]:(gA.subVectors(n[0],n[1]).add(n[0]),l=gA);let h=n[o%r],u=n[(o+1)%r];if(this.closed||o+2<r?c=n[(o+2)%r]:(gA.subVectors(n[r-1],n[r-2]).add(n[r-1]),c=gA),this.curveType==="centripetal"||this.curveType==="chordal"){let d=this.curveType==="chordal"?.5:.25,f=Math.pow(l.distanceToSquared(h),d),p=Math.pow(h.distanceToSquared(u),d),m=Math.pow(u.distanceToSquared(c),d);p<1e-4&&(p=1),f<1e-4&&(f=p),m<1e-4&&(m=p),ZR.initNonuniformCatmullRom(l.x,h.x,u.x,c.x,f,p,m),$R.initNonuniformCatmullRom(l.y,h.y,u.y,c.y,f,p,m),e3.initNonuniformCatmullRom(l.z,h.z,u.z,c.z,f,p,m)}else this.curveType==="catmullrom"&&(ZR.initCatmullRom(l.x,h.x,u.x,c.x,this.tension),$R.initCatmullRom(l.y,h.y,u.y,c.y,this.tension),e3.initCatmullRom(l.z,h.z,u.z,c.z,this.tension));return i.set(ZR.calc(a),$R.calc(a),e3.calc(a)),i}copy(t){super.copy(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){let n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){let t=super.toJSON();t.points=[];for(let e=0,i=this.points.length;e<i;e++){let n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){let n=t.points[e];this.points.push(new L().fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}};function PW(t,e,i,n,r){let s=(n-e)*.5,o=(r-i)*.5,a=t*t,l=t*a;return(2*i-2*n+s+o)*l+(-3*i+3*n-2*s-o)*a+s*t+i}function G2e(t,e){let i=1-t;return i*i*e}function H2e(t,e){return 2*(1-t)*t*e}function V2e(t,e){return t*t*e}function k1(t,e,i,n){return G2e(t,e)+H2e(t,i)+V2e(t,n)}function j2e(t,e){let i=1-t;return i*i*i*e}function W2e(t,e){let i=1-t;return 3*i*i*t*e}function X2e(t,e){return 3*(1-t)*t*t*e}function q2e(t,e){return t*t*t*e}function z1(t,e,i,n,r){return j2e(t,e)+W2e(t,i)+X2e(t,n)+q2e(t,r)}var El=class extends tu{constructor(e=new he,i=new he,n=new he,r=new he){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=i,this.v2=n,this.v3=r}getPoint(e,i=new he){let n=i,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(z1(e,r.x,s.x,o.x,a.x),z1(e,r.y,s.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},VM=class extends tu{constructor(t=new L,e=new L,i=new L,n=new L){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=i,this.v3=n}getPoint(t,e=new L){let i=e,n=this.v0,r=this.v1,s=this.v2,o=this.v3;return i.set(z1(t,n.x,r.x,s.x,o.x),z1(t,n.y,r.y,s.y,o.y),z1(t,n.z,r.z,s.z,o.z)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}},Nl=class extends tu{constructor(e=new he,i=new he){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=i}getPoint(e,i=new he){let n=i;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,i){return this.getPoint(e,i)}getTangent(e,i){let n=i||new he;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},Nee=class extends tu{constructor(t=new L,e=new L){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=t,this.v2=e}getPoint(t,e=new L){let i=e;return t===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i}getPointAt(t,e){return this.getPoint(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},tf=class extends tu{constructor(t=new he,e=new he,i=new he){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=i}getPoint(t,e=new he){let i=e,n=this.v0,r=this.v1,s=this.v2;return i.set(k1(t,n.x,r.x,s.x),k1(t,n.y,r.y,s.y)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},Y2e=class extends tu{constructor(t=new L,e=new L,i=new L){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=i}getPoint(t,e=new L){let i=e,n=this.v0,r=this.v1,s=this.v2;return i.set(k1(t,n.x,r.x,s.x),k1(t,n.y,r.y,s.y),k1(t,n.z,r.z,s.z)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},mk=class extends tu{constructor(t=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=t}getPoint(t,e=new he){let i=e,n=this.points,r=(n.length-1)*t,s=Math.floor(r),o=r-s,a=n[s===0?s:s-1],l=n[s],c=n[s>n.length-2?n.length-1:s+1],h=n[s>n.length-3?n.length-1:s+2];return i.set(PW(o,a.x,l.x,c.x,h.x),PW(o,a.y,l.y,c.y,h.y)),i}copy(t){super.copy(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){let n=t.points[e];this.points.push(n.clone())}return this}toJSON(){let t=super.toJSON();t.points=[];for(let e=0,i=this.points.length;e<i;e++){let n=this.points[e];t.points.push(n.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){let n=t.points[e];this.points.push(new he().fromArray(n))}return this}},Q2e=Object.freeze({__proto__:null,ArcCurve:k2e,CatmullRomCurve3:z2e,CubicBezierCurve:El,CubicBezierCurve3:VM,EllipseCurve:e2,LineCurve:Nl,LineCurve3:Nee,QuadraticBezierCurve:tf,QuadraticBezierCurve3:Y2e,SplineCurve:mk}),Uee=class extends tu{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){let t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Nl(e,t))}getPoint(t,e){let i=t*this.getLength(),n=this.getCurveLengths(),r=0;for(;r<n.length;){if(n[r]>=i){let s=n[r]-i,o=this.curves[r],a=o.getLength(),l=a===0?0:1-s/a;return o.getPointAt(l,e)}r++}return null}getLength(){let t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let t=[],e=0;for(let i=0,n=this.curves.length;i<n;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){let e=[];for(let i=0;i<=t;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){let e=[],i;for(let n=0,r=this.curves;n<r.length;n++){let s=r[n],o=s.isEllipseCurve?t*2:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?t*s.points.length:t,a=s.getPoints(o);for(let l=0;l<a.length;l++){let c=a[l];i&&i.equals(c)||(e.push(c),i=c)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,i=t.curves.length;e<i;e++){let n=t.curves[e];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this}toJSON(){let t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,i=this.curves.length;e<i;e++){let n=this.curves[e];t.curves.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,i=t.curves.length;e<i;e++){let n=t.curves[e];this.curves.push(new Q2e[n.type]().fromJSON(n))}return this}},nT=class extends Uee{constructor(t){super(),this.type="Path",this.currentPoint=new he,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,i=t.length;e<i;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){let i=new Nl(this.currentPoint.clone(),new he(t,e));return this.curves.push(i),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,i,n){let r=new tf(this.currentPoint.clone(),new he(t,e),new he(i,n));return this.curves.push(r),this.currentPoint.set(i,n),this}bezierCurveTo(t,e,i,n,r,s){let o=new El(this.currentPoint.clone(),new he(t,e),new he(i,n),new he(r,s));return this.curves.push(o),this.currentPoint.set(r,s),this}splineThru(t){let e=[this.currentPoint.clone()].concat(t),i=new mk(e);return this.curves.push(i),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,i,n,r,s){let o=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(t+o,e+a,i,n,r,s),this}absarc(t,e,i,n,r,s){return this.absellipse(t,e,i,i,n,r,s),this}ellipse(t,e,i,n,r,s,o,a){let l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(t+l,e+c,i,n,r,s,o,a),this}absellipse(t,e,i,n,r,s,o,a){let l=new e2(t,e,i,n,r,s,o,a);if(this.curves.length>0){let h=l.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(l);let c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){let t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}},kee=class extends Ut{constructor(t=[new he(0,-.5),new he(.5,0),new he(0,.5)],e=12,i=0,n=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:n},e=Math.floor(e),n=_r(n,0,Math.PI*2);let r=[],s=[],o=[],a=[],l=[],c=1/e,h=new L,u=new he,d=new L,f=new L,p=new L,m=0,v=0;for(let g=0;g<=t.length-1;g++)switch(g){case 0:m=t[g+1].x-t[g].x,v=t[g+1].y-t[g].y,d.x=v*1,d.y=-m,d.z=v*0,p.copy(d),d.normalize(),a.push(d.x,d.y,d.z);break;case t.length-1:a.push(p.x,p.y,p.z);break;default:m=t[g+1].x-t[g].x,v=t[g+1].y-t[g].y,d.x=v*1,d.y=-m,d.z=v*0,f.copy(d),d.x+=p.x,d.y+=p.y,d.z+=p.z,d.normalize(),a.push(d.x,d.y,d.z),p.copy(f)}for(let g=0;g<=e;g++){let y=i+g*c*n,x=Math.sin(y),b=Math.cos(y);for(let S=0;S<=t.length-1;S++){h.x=t[S].x*x,h.y=t[S].y,h.z=t[S].x*b,s.push(h.x,h.y,h.z),u.x=g/e,u.y=S/(t.length-1),o.push(u.x,u.y);let A=a[3*S+0]*x,E=a[3*S+1],M=a[3*S+0]*b;l.push(A,E,M)}}for(let g=0;g<e;g++)for(let y=0;y<t.length-1;y++){let x=y+g*t.length,b=x,S=x+t.length,A=x+t.length+1,E=x+1;r.push(b,S,E),r.push(A,E,S)}this.setIndex(r),this.setAttribute("position",new yt(s,3)),this.setAttribute("uv",new yt(o,2)),this.setAttribute("normal",new yt(l,3))}static fromJSON(t){return new kee(t.points,t.segments,t.phiStart,t.phiLength)}},gk=class extends Ut{constructor(t=1,e=1,i=1,n=32,r=1,s=!1,o=0,a=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a};let l=this;n=Math.floor(n),r=Math.floor(r);let c=[],h=[],u=[],d=[],f=0,p=[],m=i/2,v=0;g(),s===!1&&(t>0&&y(!0),e>0&&y(!1)),this.setIndex(c),this.setAttribute("position",new yt(h,3)),this.setAttribute("normal",new yt(u,3)),this.setAttribute("uv",new yt(d,2));function g(){let x=new L,b=new L,S=0,A=(e-t)/i;for(let E=0;E<=r;E++){let M=[],T=E/r,P=T*(e-t)+t;for(let R=0;R<=n;R++){let U=R/n,F=U*a+o,N=Math.sin(F),W=Math.cos(F);b.x=P*N,b.y=-T*i+m,b.z=P*W,h.push(b.x,b.y,b.z),x.set(N,A,W).normalize(),u.push(x.x,x.y,x.z),d.push(U,1-T),M.push(f++)}p.push(M)}for(let E=0;E<n;E++)for(let M=0;M<r;M++){let T=p[M][E],P=p[M+1][E],R=p[M+1][E+1],U=p[M][E+1];c.push(T,P,U),c.push(P,R,U),S+=6}l.addGroup(v,S,0),v+=S}function y(x){let b=f,S=new he,A=new L,E=0,M=x===!0?t:e,T=x===!0?1:-1;for(let R=1;R<=n;R++)h.push(0,m*T,0),u.push(0,T,0),d.push(.5,.5),f++;let P=f;for(let R=0;R<=n;R++){let U=R/n*a+o,F=Math.cos(U),N=Math.sin(U);A.x=M*N,A.y=m*T,A.z=M*F,h.push(A.x,A.y,A.z),u.push(0,T,0),S.x=F*.5+.5,S.y=N*.5*T+.5,d.push(S.x,S.y),f++}for(let R=0;R<n;R++){let U=b+R,F=P+R;x===!0?c.push(F,F+1,U):c.push(F+1,F,U),E+=3}l.addGroup(v,E,x===!0?1:2),v+=E}}static fromJSON(t){return new gk(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}},zee=class extends gk{constructor(t=1,e=1,i=32,n=1,r=!1,s=0,o=Math.PI*2){super(0,t,e,i,n,r,s,o),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:s,thetaLength:o}}static fromJSON(t){return new zee(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}},vk=class extends Ut{constructor(t=[],e=[],i=1,n=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:i,detail:n};let r=[],s=[];o(n),l(i),c(),this.setAttribute("position",new yt(r,3)),this.setAttribute("normal",new yt(r.slice(),3)),this.setAttribute("uv",new yt(s,2)),n===0?this.computeVertexNormals():this.normalizeNormals();function o(g){let y=new L,x=new L,b=new L;for(let S=0;S<e.length;S+=3)d(e[S+0],y),d(e[S+1],x),d(e[S+2],b),a(y,x,b,g)}function a(g,y,x,b){let S=b+1,A=[];for(let E=0;E<=S;E++){A[E]=[];let M=g.clone().lerp(x,E/S),T=y.clone().lerp(x,E/S),P=S-E;for(let R=0;R<=P;R++)R===0&&E===S?A[E][R]=M:A[E][R]=M.clone().lerp(T,R/P)}for(let E=0;E<S;E++)for(let M=0;M<2*(S-E)-1;M++){let T=Math.floor(M/2);M%2===0?(u(A[E][T+1]),u(A[E+1][T]),u(A[E][T])):(u(A[E][T+1]),u(A[E+1][T+1]),u(A[E+1][T]))}}function l(g){let y=new L;for(let x=0;x<r.length;x+=3)y.x=r[x+0],y.y=r[x+1],y.z=r[x+2],y.normalize().multiplyScalar(g),r[x+0]=y.x,r[x+1]=y.y,r[x+2]=y.z}function c(){let g=new L;for(let y=0;y<r.length;y+=3){g.x=r[y+0],g.y=r[y+1],g.z=r[y+2];let x=m(g)/2/Math.PI+.5,b=v(g)/Math.PI+.5;s.push(x,1-b)}f(),h()}function h(){for(let g=0;g<s.length;g+=6){let y=s[g+0],x=s[g+2],b=s[g+4],S=Math.max(y,x,b),A=Math.min(y,x,b);S>.9&&A<.1&&(y<.2&&(s[g+0]+=1),x<.2&&(s[g+2]+=1),b<.2&&(s[g+4]+=1))}}function u(g){r.push(g.x,g.y,g.z)}function d(g,y){let x=g*3;y.x=t[x+0],y.y=t[x+1],y.z=t[x+2]}function f(){let g=new L,y=new L,x=new L,b=new L,S=new he,A=new he,E=new he;for(let M=0,T=0;M<r.length;M+=9,T+=6){g.set(r[M+0],r[M+1],r[M+2]),y.set(r[M+3],r[M+4],r[M+5]),x.set(r[M+6],r[M+7],r[M+8]),S.set(s[T+0],s[T+1]),A.set(s[T+2],s[T+3]),E.set(s[T+4],s[T+5]),b.copy(g).add(y).add(x).divideScalar(3);let P=m(b);p(S,T+0,g,P),p(A,T+2,y,P),p(E,T+4,x,P)}}function p(g,y,x,b){b<0&&g.x===1&&(s[y]=g.x-1),x.x===0&&x.z===0&&(s[y]=b/2/Math.PI+.5)}function m(g){return Math.atan2(g.z,-g.x)}function v(g){return Math.atan2(-g.y,Math.sqrt(g.x*g.x+g.z*g.z))}}static fromJSON(t){return new vk(t.vertices,t.indices,t.radius,t.details)}},Gee=class extends vk{constructor(t=1,e=0){let i=(1+Math.sqrt(5))/2,n=1/i,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(r,s,t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new Gee(t.radius,t.detail)}},rT=class extends nT{constructor(t){super(t),this.uuid=qa(),this.type="Shape",this.holes=[]}getPointsHoles(t){let e=[];for(let i=0,n=this.holes.length;i<n;i++)e[i]=this.holes[i].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,i=t.holes.length;e<i;e++){let n=t.holes[e];this.holes.push(n.clone())}return this}toJSON(){let t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,i=this.holes.length;e<i;e++){let n=this.holes[e];t.holes.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,i=t.holes.length;e<i;e++){let n=t.holes[e];this.holes.push(new nT().fromJSON(n))}return this}},K2e={triangulate:function(t,e,i=2){let n=e&&e.length,r=n?e[0]*i:t.length,s=Hee(t,0,r,i,!0),o=[];if(!s||s.next===s.prev)return o;let a,l,c,h,u,d,f;if(n&&(s=tPe(t,e,s,i)),t.length>80*i){a=c=t[0],l=h=t[1];for(let p=i;p<r;p+=i)u=t[p],d=t[p+1],u<a&&(a=u),d<l&&(l=d),u>c&&(c=u),d>h&&(h=d);f=Math.max(c-a,h-l),f=f!==0?32767/f:0}return H_(s,o,i,a,l,f,0),o}};function Hee(t,e,i,n,r){let s,o;if(r===dPe(t,e,i,n)>0)for(s=e;s<i;s+=n)o=DW(s,t[s],t[s+1],o);else for(s=i-n;s>=e;s-=n)o=DW(s,t[s],t[s+1],o);return o&&t2(o,o.next)&&(j_(o),o=o.next),o}function lm(t,e){if(!t)return t;e||(e=t);let i=t,n;do if(n=!1,!i.steiner&&(t2(i,i.next)||Sn(i.prev,i,i.next)===0)){if(j_(i),i=e=i.prev,i===i.next)break;n=!0}else i=i.next;while(n||i!==e);return e}function H_(t,e,i,n,r,s,o){if(!t)return;!o&&s&&oPe(t,n,r,s);let a=t,l,c;for(;t.prev!==t.next;){if(l=t.prev,c=t.next,s?Z2e(t,n,r,s):J2e(t)){e.push(l.i/i|0),e.push(t.i/i|0),e.push(c.i/i|0),j_(t),t=c.next,a=c.next;continue}if(t=c,t===a){o?o===1?(t=$2e(lm(t),e,i),H_(t,e,i,n,r,s,2)):o===2&&ePe(t,e,i,n,r,s):H_(lm(t),e,i,n,r,s,1);break}}}function J2e(t){let e=t.prev,i=t,n=t.next;if(Sn(e,i,n)>=0)return!1;let r=e.x,s=i.x,o=n.x,a=e.y,l=i.y,c=n.y,h=r<s?r<o?r:o:s<o?s:o,u=a<l?a<c?a:c:l<c?l:c,d=r>s?r>o?r:o:s>o?s:o,f=a>l?a>c?a:c:l>c?l:c,p=n.next;for(;p!==e;){if(p.x>=h&&p.x<=d&&p.y>=u&&p.y<=f&&Tv(r,a,s,l,o,c,p.x,p.y)&&Sn(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Z2e(t,e,i,n){let r=t.prev,s=t,o=t.next;if(Sn(r,s,o)>=0)return!1;let a=r.x,l=s.x,c=o.x,h=r.y,u=s.y,d=o.y,f=a<l?a<c?a:c:l<c?l:c,p=h<u?h<d?h:d:u<d?u:d,m=a>l?a>c?a:c:l>c?l:c,v=h>u?h>d?h:d:u>d?u:d,g=HB(f,p,e,i,n),y=HB(m,v,e,i,n),x=t.prevZ,b=t.nextZ;for(;x&&x.z>=g&&b&&b.z<=y;){if(x.x>=f&&x.x<=m&&x.y>=p&&x.y<=v&&x!==r&&x!==o&&Tv(a,h,l,u,c,d,x.x,x.y)&&Sn(x.prev,x,x.next)>=0||(x=x.prevZ,b.x>=f&&b.x<=m&&b.y>=p&&b.y<=v&&b!==r&&b!==o&&Tv(a,h,l,u,c,d,b.x,b.y)&&Sn(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;x&&x.z>=g;){if(x.x>=f&&x.x<=m&&x.y>=p&&x.y<=v&&x!==r&&x!==o&&Tv(a,h,l,u,c,d,x.x,x.y)&&Sn(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=y;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=v&&b!==r&&b!==o&&Tv(a,h,l,u,c,d,b.x,b.y)&&Sn(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function $2e(t,e,i){let n=t;do{let r=n.prev,s=n.next.next;!t2(r,s)&&Vee(r,n,n.next,s)&&V_(r,s)&&V_(s,r)&&(e.push(r.i/i|0),e.push(n.i/i|0),e.push(s.i/i|0),j_(n),j_(n.next),n=t=s),n=n.next}while(n!==t);return lm(n)}function ePe(t,e,i,n,r,s){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&cPe(o,a)){let l=jee(o,a);o=lm(o,o.next),l=lm(l,l.next),H_(o,e,i,n,r,s,0),H_(l,e,i,n,r,s,0);return}a=a.next}o=o.next}while(o!==t)}function tPe(t,e,i,n){let r=[],s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*n,l=s<o-1?e[s+1]*n:t.length,c=Hee(t,a,l,n,!1),c===c.next&&(c.steiner=!0),r.push(lPe(c));for(r.sort(iPe),s=0;s<r.length;s++)i=nPe(r[s],i);return i}function iPe(t,e){return t.x-e.x}function nPe(t,e){let i=rPe(t,e);if(!i)return e;let n=jee(i,t);return lm(n,n.next),lm(i,i.next)}function rPe(t,e){let i=e,n=-1/0,r,s=t.x,o=t.y;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){let d=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(d<=s&&d>n&&(n=d,r=i.x<i.next.x?i:i.next,d===s))return r}i=i.next}while(i!==e);if(!r)return null;let a=r,l=r.x,c=r.y,h=1/0,u;i=r;do s>=i.x&&i.x>=l&&s!==i.x&&Tv(o<c?s:n,o,l,c,o<c?n:s,o,i.x,i.y)&&(u=Math.abs(o-i.y)/(s-i.x),V_(i,t)&&(u<h||u===h&&(i.x>r.x||i.x===r.x&&sPe(r,i)))&&(r=i,h=u)),i=i.next;while(i!==a);return r}function sPe(t,e){return Sn(t.prev,t,e.prev)<0&&Sn(e.next,t,t.next)<0}function oPe(t,e,i,n){let r=t;do r.z===0&&(r.z=HB(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,aPe(r)}function aPe(t){let e,i,n,r,s,o,a,l,c=1;do{for(i=t,t=null,s=null,o=0;i;){for(o++,n=i,a=0,e=0;e<c&&(a++,n=n.nextZ,!!n);e++);for(l=c;a>0||l>0&&n;)a!==0&&(l===0||!n||i.z<=n.z)?(r=i,i=i.nextZ,a--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;i=n}s.nextZ=null,c*=2}while(o>1);return t}function HB(t,e,i,n,r){return t=(t-i)*r|0,e=(e-n)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function lPe(t){let e=t,i=t;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==t);return i}function Tv(t,e,i,n,r,s,o,a){return(r-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(n-a)>=(i-o)*(e-a)&&(i-o)*(s-a)>=(r-o)*(n-a)}function cPe(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!uPe(t,e)&&(V_(t,e)&&V_(e,t)&&hPe(t,e)&&(Sn(t.prev,t,e.prev)||Sn(t,e.prev,e))||t2(t,e)&&Sn(t.prev,t,t.next)>0&&Sn(e.prev,e,e.next)>0)}function Sn(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function t2(t,e){return t.x===e.x&&t.y===e.y}function Vee(t,e,i,n){let r=yA(Sn(t,e,i)),s=yA(Sn(t,e,n)),o=yA(Sn(i,n,t)),a=yA(Sn(i,n,e));return!!(r!==s&&o!==a||r===0&&vA(t,i,e)||s===0&&vA(t,n,e)||o===0&&vA(i,t,n)||a===0&&vA(i,e,n))}function vA(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function yA(t){return t>0?1:t<0?-1:0}function uPe(t,e){let i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&Vee(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function V_(t,e){return Sn(t.prev,t,t.next)<0?Sn(t,e,t.next)>=0&&Sn(t,t.prev,e)>=0:Sn(t,e,t.prev)<0||Sn(t,t.next,e)<0}function hPe(t,e){let i=t,n=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do i.y>s!=i.next.y>s&&i.next.y!==i.y&&r<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next;while(i!==t);return n}function jee(t,e){let i=new VB(t.i,t.x,t.y),n=new VB(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,s.next=n,n.prev=s,n}function DW(t,e,i,n){let r=new VB(t,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function j_(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function VB(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function dPe(t,e,i,n){let r=0;for(let s=e,o=i-n;s<i;s+=n)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}var Wee=class{static area(t){let e=t.length,i=0;for(let n=e-1,r=0;r<e;n=r++)i+=t[n].x*t[r].y-t[r].x*t[n].y;return i*.5}static isClockWise(t){return Wee.area(t)<0}static triangulateShape(t,e){let i=[],n=[],r=[];RW(t),IW(i,t);let s=t.length;e.forEach(RW);for(let a=0;a<e.length;a++)n.push(s),s+=e[a].length,IW(i,e[a]);let o=K2e.triangulate(i,n);for(let a=0;a<o.length;a+=3)r.push(o.slice(a,a+3));return r}};function RW(t){let e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function IW(t,e){for(let i=0;i<e.length;i++)t.push(e[i].x),t.push(e[i].y)}var Xee=class extends vk{constructor(t=1,e=0){let i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(n,r,t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new Xee(t.radius,t.detail)}},yk=class extends Ut{constructor(t=1,e=32,i=16,n=0,r=Math.PI*2,s=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:r,thetaStart:s,thetaLength:o},e=Math.max(3,Math.floor(e)),i=Math.max(2,Math.floor(i));let a=Math.min(s+o,Math.PI),l=0,c=[],h=new L,u=new L,d=[],f=[],p=[],m=[];for(let v=0;v<=i;v++){let g=[],y=v/i,x=0;v==0&&s==0?x=.5/e:v==i&&a==Math.PI&&(x=-.5/e);for(let b=0;b<=e;b++){let S=b/e;h.x=-t*Math.cos(n+S*r)*Math.sin(s+y*o),h.y=t*Math.cos(s+y*o),h.z=t*Math.sin(n+S*r)*Math.sin(s+y*o),f.push(h.x,h.y,h.z),u.copy(h).normalize(),p.push(u.x,u.y,u.z),m.push(S+x,1-y),g.push(l++)}c.push(g)}for(let v=0;v<i;v++)for(let g=0;g<e;g++){let y=c[v][g+1],x=c[v][g],b=c[v+1][g],S=c[v+1][g+1];(v!==0||s>0)&&d.push(y,x,S),(v!==i-1||a<Math.PI)&&d.push(x,b,S)}this.setIndex(d),this.setAttribute("position",new yt(f,3)),this.setAttribute("normal",new yt(p,3)),this.setAttribute("uv",new yt(m,2))}static fromJSON(t){return new yk(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}},qee=class extends Ut{constructor(t=1,e=.4,i=64,n=8,r=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:n,p:r,q:s},i=Math.floor(i),n=Math.floor(n);let o=[],a=[],l=[],c=[],h=new L,u=new L,d=new L,f=new L,p=new L,m=new L,v=new L;for(let y=0;y<=i;++y){let x=y/i*r*Math.PI*2;g(x,r,s,t,d),g(x+.01,r,s,t,f),m.subVectors(f,d),v.addVectors(f,d),p.crossVectors(m,v),v.crossVectors(p,m),p.normalize(),v.normalize();for(let b=0;b<=n;++b){let S=b/n*Math.PI*2,A=-e*Math.cos(S),E=e*Math.sin(S);h.x=d.x+(A*v.x+E*p.x),h.y=d.y+(A*v.y+E*p.y),h.z=d.z+(A*v.z+E*p.z),a.push(h.x,h.y,h.z),u.subVectors(h,d).normalize(),l.push(u.x,u.y,u.z),c.push(y/i),c.push(b/n)}}for(let y=1;y<=i;y++)for(let x=1;x<=n;x++){let b=(n+1)*(y-1)+(x-1),S=(n+1)*y+(x-1),A=(n+1)*y+x,E=(n+1)*(y-1)+x;o.push(b,S,E),o.push(S,A,E)}this.setIndex(o),this.setAttribute("position",new yt(a,3)),this.setAttribute("normal",new yt(l,3)),this.setAttribute("uv",new yt(c,2));function g(y,x,b,S,A){let E=Math.cos(y),M=Math.sin(y),T=b/x*y,P=Math.cos(T);A.x=S*(2+P)*.5*E,A.y=S*(2+P)*M*.5,A.z=S*Math.sin(T)*.5}}static fromJSON(t){return new qee(t.radius,t.tube,t.tubularSegments,t.radialSegments,t.p,t.q)}};function zh(t,e,i){return Yee(t)?new t.constructor(t.subarray(e,i!==void 0?i:t.length)):t.slice(e,i)}function xA(t,e,i){return!t||!i&&t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}function Yee(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function fPe(t){function e(r,s){return t[r]-t[s]}let i=t.length,n=new Array(i);for(let r=0;r!==i;++r)n[r]=r;return n.sort(e),n}function LW(t,e,i){let n=t.length,r=new t.constructor(n);for(let s=0,o=0;o!==n;++s){let a=i[s]*e;for(let l=0;l!==e;++l)r[o++]=t[a+l]}return r}function Qee(t,e,i,n){let r=1,s=t[0];for(;s!==void 0&&s[n]===void 0;)s=t[r++];if(s===void 0)return;let o=s[n];if(o!==void 0)if(Array.isArray(o))do o=s[n],o!==void 0&&(e.push(s.time),i.push.apply(i,o)),s=t[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[n],o!==void 0&&(e.push(s.time),o.toArray(i,i.length)),s=t[r++];while(s!==void 0);else do o=s[n],o!==void 0&&(e.push(s.time),i.push(o)),s=t[r++];while(s!==void 0)}var i2=class{constructor(t,e,i,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=n!==void 0?n:new e.constructor(i),this.sampleValues=e,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(t){let e=this.parameterPositions,i=this._cachedIndex,n=e[i],r=e[i-1];e:{t:{let s;i:{n:if(!(t<n)){for(let o=i+2;;){if(n===void 0){if(t<r)break n;return i=e.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===o)break;if(r=n,n=e[++i],t<n)break t}s=e.length;break i}if(!(t>=r)){let o=e[1];t<o&&(i=2,r=o);for(let a=i-2;;){if(r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===a)break;if(n=r,r=e[--i-1],t>=r)break t}s=i,i=0;break i}break e}for(;i<s;){let o=i+s>>>1;t<e[o]?s=o:i=o+1}if(n=e[i],r=e[i-1],r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===void 0)return i=e.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,t,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){let e=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=t*n;for(let s=0;s!==n;++s)e[s]=i[r+s];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},pPe=class extends i2{constructor(t,e,i,n){super(t,e,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Sv,endingEnd:Sv}}intervalChanged_(t,e,i){let n=this.parameterPositions,r=t-2,s=t+1,o=n[r],a=n[s];if(o===void 0)switch(this.getSettings_().endingStart){case Av:r=t,o=2*e-i;break;case JE:r=n.length-2,o=e+n[r]-n[r+1];break;default:r=t,o=i}if(a===void 0)switch(this.getSettings_().endingEnd){case Av:s=t,a=2*i-e;break;case JE:s=1,a=i+n[1]-n[0];break;default:s=t-1,a=e}let l=(i-e)*.5,c=this.valueSize;this._weightPrev=l/(e-o),this._weightNext=l/(a-i),this._offsetPrev=r*c,this._offsetNext=s*c}interpolate_(t,e,i,n){let r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,l=a-o,c=this._offsetPrev,h=this._offsetNext,u=this._weightPrev,d=this._weightNext,f=(i-e)/(n-e),p=f*f,m=p*f,v=-u*m+2*u*p-u*f,g=(1+u)*m+(-1.5-2*u)*p+(-.5+u)*f+1,y=(-1-d)*m+(1.5+d)*p+.5*f,x=d*m-d*p;for(let b=0;b!==o;++b)r[b]=v*s[c+b]+g*s[l+b]+y*s[a+b]+x*s[h+b];return r}},Kee=class extends i2{constructor(t,e,i,n){super(t,e,i,n)}interpolate_(t,e,i,n){let r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,l=a-o,c=(i-e)/(n-e),h=1-c;for(let u=0;u!==o;++u)r[u]=s[l+u]*h+s[a+u]*c;return r}},mPe=class extends i2{constructor(t,e,i,n){super(t,e,i,n)}interpolate_(t){return this.copySampleValue_(t-1)}},iu=class{constructor(t,e,i,n){if(t===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(e===void 0||e.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=xA(e,this.TimeBufferType),this.values=xA(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(t){let e=t.constructor,i;if(e.toJSON!==this.toJSON)i=e.toJSON(t);else{i={name:t.name,times:xA(t.times,Array),values:xA(t.values,Array)};let n=t.getInterpolation();n!==t.DefaultInterpolation&&(i.interpolation=n)}return i.type=t.ValueTypeName,i}InterpolantFactoryMethodDiscrete(t){return new mPe(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new Kee(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new pPe(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case QE:e=this.InterpolantFactoryMethodDiscrete;break;case KE:e=this.InterpolantFactoryMethodLinear;break;case MR:e=this.InterpolantFactoryMethodSmooth;break}if(e===void 0){let i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(t!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return QE;case this.InterpolantFactoryMethodLinear:return KE;case this.InterpolantFactoryMethodSmooth:return MR}}getValueSize(){return this.values.length/this.times.length}shift(t){if(t!==0){let e=this.times;for(let i=0,n=e.length;i!==n;++i)e[i]+=t}return this}scale(t){if(t!==1){let e=this.times;for(let i=0,n=e.length;i!==n;++i)e[i]*=t}return this}trim(t,e){let i=this.times,n=i.length,r=0,s=n-1;for(;r!==n&&i[r]<t;)++r;for(;s!==-1&&i[s]>e;)--s;if(++s,r!==0||s!==n){r>=s&&(s=Math.max(s,1),r=s-1);let o=this.getValueSize();this.times=zh(i,r,s),this.values=zh(this.values,r*o,s*o)}return this}validate(){let t=!0,e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);let i=this.times,n=this.values,r=i.length;r===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let s=null;for(let o=0;o!==r;o++){let a=i[o];if(typeof a=="number"&&isNaN(a)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,a),t=!1;break}if(s!==null&&s>a){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,a,s),t=!1;break}s=a}if(n!==void 0&&Yee(n))for(let o=0,a=n.length;o!==a;++o){let l=n[o];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,l),t=!1;break}}return t}optimize(){let t=zh(this.times),e=zh(this.values),i=this.getValueSize(),n=this.getInterpolation()===MR,r=t.length-1,s=1;for(let o=1;o<r;++o){let a=!1,l=t[o],c=t[o+1];if(l!==c&&(o!==1||l!==t[0]))if(n)a=!0;else{let h=o*i,u=h-i,d=h+i;for(let f=0;f!==i;++f){let p=e[h+f];if(p!==e[u+f]||p!==e[d+f]){a=!0;break}}}if(a){if(o!==s){t[s]=t[o];let h=o*i,u=s*i;for(let d=0;d!==i;++d)e[u+d]=e[h+d]}++s}}if(r>0){t[s]=t[r];for(let o=r*i,a=s*i,l=0;l!==i;++l)e[a+l]=e[o+l];++s}return s!==t.length?(this.times=zh(t,0,s),this.values=zh(e,0,s*i)):(this.times=t,this.values=e),this}clone(){let t=zh(this.times,0),e=zh(this.values,0),i=this.constructor,n=new i(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}};iu.prototype.TimeBufferType=Float32Array;iu.prototype.ValueBufferType=Float32Array;iu.prototype.DefaultInterpolation=KE;var dy=class extends iu{};dy.prototype.ValueTypeName="bool";dy.prototype.ValueBufferType=Array;dy.prototype.DefaultInterpolation=QE;dy.prototype.InterpolantFactoryMethodLinear=void 0;dy.prototype.InterpolantFactoryMethodSmooth=void 0;var Jee=class extends iu{};Jee.prototype.ValueTypeName="color";var sT=class extends iu{};sT.prototype.ValueTypeName="number";var gPe=class extends i2{constructor(t,e,i,n){super(t,e,i,n)}interpolate_(t,e,i,n){let r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=(i-e)/(n-e),l=t*o;for(let c=l+o;l!==c;l+=4)Zt.slerpFlat(r,0,s,l-o,s,l,a);return r}},Ow=class extends iu{InterpolantFactoryMethodLinear(t){return new gPe(this.times,this.values,this.getValueSize(),t)}};Ow.prototype.ValueTypeName="quaternion";Ow.prototype.DefaultInterpolation=KE;Ow.prototype.InterpolantFactoryMethodSmooth=void 0;var fy=class extends iu{};fy.prototype.ValueTypeName="string";fy.prototype.ValueBufferType=Array;fy.prototype.DefaultInterpolation=QE;fy.prototype.InterpolantFactoryMethodLinear=void 0;fy.prototype.InterpolantFactoryMethodSmooth=void 0;var oT=class extends iu{};oT.prototype.ValueTypeName="vector";var jB=class{constructor(t,e=-1,i,n=ok){this.name=t,this.tracks=i,this.duration=e,this.blendMode=n,this.uuid=qa(),this.duration<0&&this.resetDuration()}static parse(t){let e=[],i=t.tracks,n=1/(t.fps||1);for(let s=0,o=i.length;s!==o;++s)e.push(yPe(i[s]).scale(n));let r=new this(t.name,t.duration,e,t.blendMode);return r.uuid=t.uuid,r}static toJSON(t){let e=[],i=t.tracks,n={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let r=0,s=i.length;r!==s;++r)e.push(iu.toJSON(i[r]));return n}static CreateFromMorphTargetSequence(t,e,i,n){let r=e.length,s=[];for(let o=0;o<r;o++){let a=[],l=[];a.push((o+r-1)%r,o,(o+1)%r),l.push(0,1,0);let c=fPe(a);a=LW(a,1,c),l=LW(l,1,c),!n&&a[0]===0&&(a.push(r),l.push(l[0])),s.push(new sT(".morphTargetInfluences["+e[o].name+"]",a,l).scale(1/i))}return new this(t,-1,s)}static findByName(t,e){let i=t;if(!Array.isArray(t)){let n=t;i=n.geometry&&n.geometry.animations||n.animations}for(let n=0;n<i.length;n++)if(i[n].name===e)return i[n];return null}static CreateClipsFromMorphTargetSequences(t,e,i){let n={},r=/^([\w-]*?)([\d]+)$/;for(let o=0,a=t.length;o<a;o++){let l=t[o],c=l.name.match(r);if(c&&c.length>1){let h=c[1],u=n[h];u||(n[h]=u=[]),u.push(l)}}let s=[];for(let o in n)s.push(this.CreateFromMorphTargetSequence(o,n[o],e,i));return s}static parseAnimation(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let i=function(c,h,u,d,f){if(u.length!==0){let p=[],m=[];Qee(u,p,m,d),p.length!==0&&f.push(new c(h,p,m))}},n=[],r=t.name||"default",s=t.fps||30,o=t.blendMode,a=t.length||-1,l=t.hierarchy||[];for(let c=0;c<l.length;c++){let h=l[c].keys;if(!(!h||h.length===0))if(h[0].morphTargets){let u={},d;for(d=0;d<h.length;d++)if(h[d].morphTargets)for(let f=0;f<h[d].morphTargets.length;f++)u[h[d].morphTargets[f]]=-1;for(let f in u){let p=[],m=[];for(let v=0;v!==h[d].morphTargets.length;++v){let g=h[d];p.push(g.time),m.push(g.morphTarget===f?1:0)}n.push(new sT(".morphTargetInfluence["+f+"]",p,m))}a=u.length*s}else{let u=".bones["+e[c].name+"]";i(oT,u+".position",h,"pos",n),i(Ow,u+".quaternion",h,"rot",n),i(oT,u+".scale",h,"scl",n)}}return n.length===0?null:new this(r,a,n,o)}resetDuration(){let t=this.tracks,e=0;for(let i=0,n=t.length;i!==n;++i){let r=this.tracks[i];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){let t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function vPe(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return sT;case"vector":case"vector2":case"vector3":case"vector4":return oT;case"color":return Jee;case"quaternion":return Ow;case"bool":case"boolean":return dy;case"string":return fy}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function yPe(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=vPe(t.type);if(t.times===void 0){let i=[],n=[];Qee(t.keys,i,n,"value"),t.times=i,t.values=n}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}var BW={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},Zee=class{constructor(t,e,i){let n=this,r=!1,s=0,o=0,a,l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=i,this.itemStart=function(c){o++,r===!1&&n.onStart!==void 0&&n.onStart(c,s,o),r=!0},this.itemEnd=function(c){s++,n.onProgress!==void 0&&n.onProgress(c,s,o),s===o&&(r=!1,n.onLoad!==void 0&&n.onLoad())},this.itemError=function(c){n.onError!==void 0&&n.onError(c)},this.resolveURL=function(c){return a?a(c):c},this.setURLModifier=function(c){return a=c,this},this.addHandler=function(c,h){return l.push(c,h),this},this.removeHandler=function(c){let h=l.indexOf(c);return h!==-1&&l.splice(h,2),this},this.getHandler=function(c){for(let h=0,u=l.length;h<u;h+=2){let d=l[h],f=l[h+1];if(d.global&&(d.lastIndex=0),d.test(c))return f}return null}}},xPe=new Zee,xk=class{constructor(t){this.manager=t!==void 0?t:xPe,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){let i=this;return new Promise(function(n,r){i.load(t,n,e,r)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}},bu={},_Pe=class extends Error{constructor(t,e){super(t),this.response=e}},WB=class extends xk{constructor(t){super(t)}load(t,e,i,n){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);let r=BW.get(t);if(r!==void 0)return this.manager.itemStart(t),setTimeout(()=>{e&&e(r),this.manager.itemEnd(t)},0),r;if(bu[t]!==void 0){bu[t].push({onLoad:e,onProgress:i,onError:n});return}bu[t]=[],bu[t].push({onLoad:e,onProgress:i,onError:n});let s=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,a=this.responseType;fetch(s).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;let c=bu[t],h=l.body.getReader(),u=l.headers.get("Content-Length")||l.headers.get("X-File-Size"),d=u?parseInt(u):0,f=d!==0,p=0,m=new ReadableStream({start(v){g();function g(){h.read().then(({done:y,value:x})=>{if(y)v.close();else{p+=x.byteLength;let b=new ProgressEvent("progress",{lengthComputable:f,loaded:p,total:d});for(let S=0,A=c.length;S<A;S++){let E=c[S];E.onProgress&&E.onProgress(b)}v.enqueue(x),g()}})}}});return new Response(m)}else throw new _Pe(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(a){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(c=>new DOMParser().parseFromString(c,o));case"json":return l.json();default:if(o===void 0)return l.text();{let c=/charset="?([^;"\s]*)"?/i.exec(o),h=c&&c[1]?c[1].toLowerCase():void 0,u=new TextDecoder(h);return l.arrayBuffer().then(d=>u.decode(d))}}}).then(l=>{BW.add(t,l);let c=bu[t];delete bu[t];for(let h=0,u=c.length;h<u;h++){let d=c[h];d.onLoad&&d.onLoad(l)}}).catch(l=>{let c=bu[t];if(c===void 0)throw this.manager.itemError(t),l;delete bu[t];for(let h=0,u=c.length;h<u;h++){let d=c[h];d.onError&&d.onError(l)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}},Fw=class extends ji{constructor(t,e=1){super(),this.isLight=!0,this.type="Light",this.color=new It(t),this.intensity=e}dispose(){}copy(t,e){return super.copy(t,e),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){let e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,this.groundColor!==void 0&&(e.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(e.object.distance=this.distance),this.angle!==void 0&&(e.object.angle=this.angle),this.decay!==void 0&&(e.object.decay=this.decay),this.penumbra!==void 0&&(e.object.penumbra=this.penumbra),this.shadow!==void 0&&(e.object.shadow=this.shadow.toJSON()),e}},wPe=class extends Fw{constructor(t,e,i){super(t,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(ji.DEFAULT_UP),this.updateMatrix(),this.groundColor=new It(e)}copy(t,e){return super.copy(t,e),this.groundColor.copy(t.groundColor),this}},t3=new $e,OW=new L,FW=new L,_k=class{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new he(512,512),this.map=null,this.mapPass=null,this.matrix=new $e,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new uk,this._frameExtents=new he(1,1),this._viewportCount=1,this._viewports=[new Kt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){let e=this.camera,i=this.matrix;OW.setFromMatrixPosition(t.matrixWorld),e.position.copy(OW),FW.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(FW),e.updateMatrixWorld(),t3.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(t3),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(t3)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}},bPe=class extends _k{constructor(){super(new vs(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(t){let e=this.camera,i=G_*2*t.angle*this.focus,n=this.mapSize.width/this.mapSize.height,r=t.distance||e.far;(i!==e.fov||n!==e.aspect||r!==e.far)&&(e.fov=i,e.aspect=n,e.far=r,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}},SPe=class extends Fw{constructor(t,e,i=0,n=Math.PI/3,r=0,s=2){super(t,e),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(ji.DEFAULT_UP),this.updateMatrix(),this.target=new ji,this.distance=i,this.angle=n,this.penumbra=r,this.decay=s,this.map=null,this.shadow=new bPe}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}},NW=new $e,Ax=new L,i3=new L,APe=class extends _k{constructor(){super(new vs(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new he(4,2),this._viewportCount=6,this._viewports=[new Kt(2,1,1,1),new Kt(0,1,1,1),new Kt(3,1,1,1),new Kt(1,1,1,1),new Kt(3,0,1,1),new Kt(1,0,1,1)],this._cubeDirections=[new L(1,0,0),new L(-1,0,0),new L(0,0,1),new L(0,0,-1),new L(0,1,0),new L(0,-1,0)],this._cubeUps=[new L(0,1,0),new L(0,1,0),new L(0,1,0),new L(0,1,0),new L(0,0,1),new L(0,0,-1)]}updateMatrices(t,e=0){let i=this.camera,n=this.matrix,r=t.distance||i.far;r!==i.far&&(i.far=r,i.updateProjectionMatrix()),Ax.setFromMatrixPosition(t.matrixWorld),i.position.copy(Ax),i3.copy(i.position),i3.add(this._cubeDirections[e]),i.up.copy(this._cubeUps[e]),i.lookAt(i3),i.updateMatrixWorld(),n.makeTranslation(-Ax.x,-Ax.y,-Ax.z),NW.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(NW)}},MPe=class extends Fw{constructor(t,e,i=0,n=2){super(t,e),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=n,this.shadow=new APe}get power(){return this.intensity*4*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}},EPe=class extends _k{constructor(){super(new hk(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},TPe=class extends Fw{constructor(t,e){super(t,e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(ji.DEFAULT_UP),this.updateMatrix(),this.target=new ji,this.shadow=new EPe}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}},CPe=class extends Ut{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}toJSON(){let t=super.toJSON();return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}},$ee=class extends xk{constructor(t){super(t)}load(t,e,i,n){let r=this,s=new WB(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(t,function(o){try{e(r.parse(JSON.parse(o)))}catch(a){n?n(a):console.error(a),r.manager.itemError(t)}},i,n)}parse(t){let e={},i={};function n(u,d){if(e[d]!==void 0)return e[d];let f=u.interleavedBuffers[d],p=r(u,f.buffer),m=KS(f.type,p),v=new O2e(m,f.stride);return v.uuid=f.uuid,e[d]=v,v}function r(u,d){if(i[d]!==void 0)return i[d];let f=u.arrayBuffers[d],p=new Uint32Array(f).buffer;return i[d]=p,p}let s=t.isInstancedBufferGeometry?new CPe:new Ut,o=t.data.index;if(o!==void 0){let u=KS(o.type,o.array);s.setIndex(new Gt(u,1))}let a=t.data.attributes;for(let u in a){let d=a[u],f;if(d.isInterleavedBufferAttribute){let p=n(t.data,d.data);f=new GB(p,d.itemSize,d.offset,d.normalized)}else{let p=KS(d.type,d.array),m=d.isInstancedBufferAttribute?N2e:Gt;f=new m(p,d.itemSize,d.normalized)}d.name!==void 0&&(f.name=d.name),d.usage!==void 0&&f.setUsage(d.usage),d.updateRange!==void 0&&(f.updateRange.offset=d.updateRange.offset,f.updateRange.count=d.updateRange.count),s.setAttribute(u,f)}let l=t.data.morphAttributes;if(l)for(let u in l){let d=l[u],f=[];for(let p=0,m=d.length;p<m;p++){let v=d[p],g;if(v.isInterleavedBufferAttribute){let y=n(t.data,v.data);g=new GB(y,v.itemSize,v.offset,v.normalized)}else{let y=KS(v.type,v.array);g=new Gt(y,v.itemSize,v.normalized)}v.name!==void 0&&(g.name=v.name),f.push(g)}s.morphAttributes[u]=f}t.data.morphTargetsRelative&&(s.morphTargetsRelative=!0);let c=t.data.groups||t.data.drawcalls||t.data.offsets;if(c!==void 0)for(let u=0,d=c.length;u!==d;++u){let f=c[u];s.addGroup(f.start,f.count,f.materialIndex)}let h=t.data.boundingSphere;if(h!==void 0){let u=new L;h.center!==void 0&&u.fromArray(h.center),s.boundingSphere=new sa(u,h.radius)}return t.name&&(s.name=t.name),t.userData&&(s.userData=t.userData),s}},PPe=class{constructor(t=!0){this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=UW(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let e=UW();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}};function UW(){return(typeof performance>"u"?Date:performance).now()}var DPe=class{constructor(t,e,i){this.binding=t,this.valueSize=i;let n,r,s;switch(e){case"quaternion":n=this._slerp,r=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":n=this._select,r=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:n=this._lerp,r=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=n,this._mixBufferRegionAdditive=r,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){let i=this.buffer,n=this.valueSize,r=t*n+n,s=this.cumulativeWeight;if(s===0){for(let o=0;o!==n;++o)i[r+o]=i[o];s=e}else{s+=e;let o=e/s;this._mixBufferRegion(i,r,0,o,n)}this.cumulativeWeight=s}accumulateAdditive(t){let e=this.buffer,i=this.valueSize,n=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(e,n,0,t,i),this.cumulativeWeightAdditive+=t}apply(t){let e=this.valueSize,i=this.buffer,n=t*e+e,r=this.cumulativeWeight,s=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){let a=e*this._origIndex;this._mixBufferRegion(i,n,a,1-r,e)}s>0&&this._mixBufferRegionAdditive(i,n,this._addIndex*e,1,e);for(let a=e,l=e+e;a!==l;++a)if(i[a]!==i[a+e]){o.setValue(i,n);break}}saveOriginalState(){let t=this.binding,e=this.buffer,i=this.valueSize,n=i*this._origIndex;t.getValue(e,n);for(let r=i,s=n;r!==s;++r)e[r]=e[n+r%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let t=this.valueSize*3;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){let t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let i=t;i<e;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[e+i]=this.buffer[t+i]}_select(t,e,i,n,r){if(n>=.5)for(let s=0;s!==r;++s)t[e+s]=t[i+s]}_slerp(t,e,i,n){Zt.slerpFlat(t,e,t,e,t,i,n)}_slerpAdditive(t,e,i,n,r){let s=this._workIndex*r;Zt.multiplyQuaternionsFlat(t,s,t,e,t,i),Zt.slerpFlat(t,e,t,e,t,s,n)}_lerp(t,e,i,n,r){let s=1-n;for(let o=0;o!==r;++o){let a=e+o;t[a]=t[a]*s+t[i+o]*n}}_lerpAdditive(t,e,i,n,r){for(let s=0;s!==r;++s){let o=e+s;t[o]=t[o]+t[i+s]*n}}},wk="\\[\\]\\.:\\/",RPe=new RegExp("["+wk+"]","g"),bk="[^"+wk+"]",IPe="[^"+wk.replace("\\.","")+"]",LPe=/((?:WC+[\/:])*)/.source.replace("WC",bk),BPe=/(WCOD+)?/.source.replace("WCOD",IPe),OPe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",bk),FPe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",bk),NPe=new RegExp("^"+LPe+BPe+OPe+FPe+"$"),UPe=["material","materials","bones","map"],kPe=class{constructor(t,e,i){let n=i||Xi.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,n)}getValue(t,e){this.bind();let i=this._targetGroup.nCachedObjects_,n=this._bindings[i];n!==void 0&&n.getValue(t,e)}setValue(t,e){let i=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(t,e)}bind(){let t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()}unbind(){let t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}},Xi=class{constructor(t,e,i){this.path=e,this.parsedPath=i||Xi.parseTrackName(e),this.node=Xi.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,i){return t&&t.isAnimationObjectGroup?new Xi.Composite(t,e,i):new Xi(t,e,i)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(RPe,"")}static parseTrackName(t){let e=NPe.exec(t);if(e===null)throw new Error("PropertyBinding: Cannot parse trackName: "+t);let i={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},n=i.nodeName&&i.nodeName.lastIndexOf(".");if(n!==void 0&&n!==-1){let r=i.nodeName.substring(n+1);UPe.indexOf(r)!==-1&&(i.nodeName=i.nodeName.substring(0,n),i.objectName=r)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return i}static findNode(t,e){if(e===void 0||e===""||e==="."||e===-1||e===t.name||e===t.uuid)return t;if(t.skeleton){let i=t.skeleton.getBoneByName(e);if(i!==void 0)return i}if(t.children){let i=function(r){for(let s=0;s<r.length;s++){let o=r[s];if(o.name===e||o.uuid===e)return o;let a=i(o.children);if(a)return a}return null},n=i(t.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){let i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)t[e++]=i[n]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){let i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=t[e++]}_setValue_array_setNeedsUpdate(t,e){let i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){let i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node,e=this.parsedPath,i=e.objectName,n=e.propertyName,r=e.propertyIndex;if(t||(t=Xi.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(i){let l=e.objectIndex;switch(i){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let c=0;c<t.length;c++)if(t[c].name===l){l=c;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}t=t.material.map;break;default:if(t[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[i]}if(l!==void 0){if(t[l]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[l]}}let s=t[n];if(s===void 0){let l=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+n+" but it wasn't found.",t);return}let o=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?o=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(r!==void 0){if(n==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[r]!==void 0&&(r=t.morphTargetDictionary[r])}a=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else s.fromArray!==void 0&&s.toArray!==void 0?(a=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(a=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};Xi.Composite=kPe;Xi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Xi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Xi.prototype.GetterByBindingType=[Xi.prototype._getValue_direct,Xi.prototype._getValue_array,Xi.prototype._getValue_arrayElement,Xi.prototype._getValue_toArray];Xi.prototype.SetterByBindingTypeAndVersioning=[[Xi.prototype._setValue_direct,Xi.prototype._setValue_direct_setNeedsUpdate,Xi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Xi.prototype._setValue_array,Xi.prototype._setValue_array_setNeedsUpdate,Xi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Xi.prototype._setValue_arrayElement,Xi.prototype._setValue_arrayElement_setNeedsUpdate,Xi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Xi.prototype._setValue_fromArray,Xi.prototype._setValue_fromArray_setNeedsUpdate,Xi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var zPe=class{constructor(t,e,i=null,n=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=i,this.blendMode=n;let r=e.tracks,s=r.length,o=new Array(s),a={endingStart:Sv,endingEnd:Sv};for(let l=0;l!==s;++l){let c=r[l].createInterpolant(null);o[l]=c,c.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=yee,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,i){if(t.fadeOut(e),this.fadeIn(e),i){let n=this._clip.duration,r=t._clip.duration,s=r/n,o=n/r;t.warp(1,s,e),this.warp(o,1,e)}return this}crossFadeTo(t,e,i){return t.crossFadeFrom(this,e,i)}stopFading(){let t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,i){let n=this._mixer,r=n.time,s=this.timeScale,o=this._timeScaleInterpolant;o===null&&(o=n._lendControlInterpolant(),this._timeScaleInterpolant=o);let a=o.parameterPositions,l=o.sampleValues;return a[0]=r,a[1]=r+i,l[0]=t/s,l[1]=e/s,this}stopWarping(){let t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,i,n){if(!this.enabled){this._updateWeight(t);return}let r=this._startTime;if(r!==null){let a=(t-r)*i;a<0||i===0?e=0:(this._startTime=null,e=i*a)}e*=this._updateTimeScale(t);let s=this._updateTime(e),o=this._updateWeight(t);if(o>0){let a=this._interpolants,l=this._propertyBindings;switch(this.blendMode){case _Ae:for(let c=0,h=a.length;c!==h;++c)a[c].evaluate(s),l[c].accumulateAdditive(o);break;case ok:default:for(let c=0,h=a.length;c!==h;++c)a[c].evaluate(s),l[c].accumulate(n,o)}}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;let i=this._weightInterpolant;if(i!==null){let n=i.evaluate(t)[0];e*=n,t>i.parameterPositions[1]&&(this.stopFading(),n===0&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;let i=this._timeScaleInterpolant;if(i!==null){let n=i.evaluate(t)[0];e*=n,t>i.parameterPositions[1]&&(this.stopWarping(),e===0?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e}_updateTime(t){let e=this._clip.duration,i=this.loop,n=this.time+t,r=this._loopCount,s=i===sk;if(t===0)return r===-1?n:s&&(r&1)===1?e-n:n;if(i===vee){r===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n>=e)n=e;else if(n<0)n=0;else{this.time=n;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(r===-1&&(t>=0?(r=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),n>=e||n<0){let o=Math.floor(n/e);n-=e*o,r+=Math.abs(o);let a=this.repetitions-r;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,n=t>0?e:0,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(a===1){let l=t<0;this._setEndings(l,!l,s)}else this._setEndings(!1,!1,s);this._loopCount=r,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=n;if(s&&(r&1)===1)return e-n}return n}_setEndings(t,e,i){let n=this._interpolantSettings;i?(n.endingStart=Av,n.endingEnd=Av):(t?n.endingStart=this.zeroSlopeAtStart?Av:Sv:n.endingStart=JE,e?n.endingEnd=this.zeroSlopeAtEnd?Av:Sv:n.endingEnd=JE)}_scheduleFading(t,e,i){let n=this._mixer,r=n.time,s=this._weightInterpolant;s===null&&(s=n._lendControlInterpolant(),this._weightInterpolant=s);let o=s.parameterPositions,a=s.sampleValues;return o[0]=r,a[0]=e,o[1]=r+t,a[1]=i,this}},GPe=new Float32Array(1),HPe=class extends is{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){let i=t._localRoot||this._root,n=t._clip.tracks,r=n.length,s=t._propertyBindings,o=t._interpolants,a=i.uuid,l=this._bindingsByRootAndName,c=l[a];c===void 0&&(c={},l[a]=c);for(let h=0;h!==r;++h){let u=n[h],d=u.name,f=c[d];if(f!==void 0)++f.referenceCount,s[h]=f;else{if(f=s[h],f!==void 0){f._cacheIndex===null&&(++f.referenceCount,this._addInactiveBinding(f,a,d));continue}let p=e&&e._propertyBindings[h].binding.parsedPath;f=new DPe(Xi.create(i,d,p),u.ValueTypeName,u.getValueSize()),++f.referenceCount,this._addInactiveBinding(f,a,d),s[h]=f}o[h].resultBuffer=f.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(t._cacheIndex===null){let i=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,i)}let e=t._propertyBindings;for(let i=0,n=e.length;i!==n;++i){let r=e[i];r.useCount++===0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){let e=t._propertyBindings;for(let i=0,n=e.length;i!==n;++i){let r=e[i];--r.useCount===0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){let e=t._cacheIndex;return e!==null&&e<this._nActiveActions}_addInactiveAction(t,e,i){let n=this._actions,r=this._actionsByClip,s=r[e];if(s===void 0)s={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=s;else{let o=s.knownActions;t._byClipCacheIndex=o.length,o.push(t)}t._cacheIndex=n.length,n.push(t),s.actionByRoot[i]=t}_removeInactiveAction(t){let e=this._actions,i=e[e.length-1],n=t._cacheIndex;i._cacheIndex=n,e[n]=i,e.pop(),t._cacheIndex=null;let r=t._clip.uuid,s=this._actionsByClip,o=s[r],a=o.knownActions,l=a[a.length-1],c=t._byClipCacheIndex;l._byClipCacheIndex=c,a[c]=l,a.pop(),t._byClipCacheIndex=null;let h=o.actionByRoot,u=(t._localRoot||this._root).uuid;delete h[u],a.length===0&&delete s[r],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){let e=t._propertyBindings;for(let i=0,n=e.length;i!==n;++i){let r=e[i];--r.referenceCount===0&&this._removeInactiveBinding(r)}}_lendAction(t){let e=this._actions,i=t._cacheIndex,n=this._nActiveActions++,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r}_takeBackAction(t){let e=this._actions,i=t._cacheIndex,n=--this._nActiveActions,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r}_addInactiveBinding(t,e,i){let n=this._bindingsByRootAndName,r=this._bindings,s=n[e];s===void 0&&(s={},n[e]=s),s[i]=t,t._cacheIndex=r.length,r.push(t)}_removeInactiveBinding(t){let e=this._bindings,i=t.binding,n=i.rootNode.uuid,r=i.path,s=this._bindingsByRootAndName,o=s[n],a=e[e.length-1],l=t._cacheIndex;a._cacheIndex=l,e[l]=a,e.pop(),delete o[r],Object.keys(o).length===0&&delete s[n]}_lendBinding(t){let e=this._bindings,i=t._cacheIndex,n=this._nActiveBindings++,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r}_takeBackBinding(t){let e=this._bindings,i=t._cacheIndex,n=--this._nActiveBindings,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r}_lendControlInterpolant(){let t=this._controlInterpolants,e=this._nActiveControlInterpolants++,i=t[e];return i===void 0&&(i=new Kee(new Float32Array(2),new Float32Array(2),1,GPe),i.__cacheIndex=e,t[e]=i),i}_takeBackControlInterpolant(t){let e=this._controlInterpolants,i=t.__cacheIndex,n=--this._nActiveControlInterpolants,r=e[n];t.__cacheIndex=n,e[n]=t,r.__cacheIndex=i,e[i]=r}clipAction(t,e,i){let n=e||this._root,r=n.uuid,s=typeof t=="string"?jB.findByName(n,t):t,o=s!==null?s.uuid:t,a=this._actionsByClip[o],l=null;if(i===void 0&&(s!==null?i=s.blendMode:i=ok),a!==void 0){let h=a.actionByRoot[r];if(h!==void 0&&h.blendMode===i)return h;l=a.knownActions[0],s===null&&(s=l._clip)}if(s===null)return null;let c=new zPe(this,s,e,i);return this._bindAction(c,l),this._addInactiveAction(c,o,r),c}existingAction(t,e){let i=e||this._root,n=i.uuid,r=typeof t=="string"?jB.findByName(i,t):t,s=r?r.uuid:t,o=this._actionsByClip[s];return o!==void 0&&o.actionByRoot[n]||null}stopAllAction(){let t=this._actions,e=this._nActiveActions;for(let i=e-1;i>=0;--i)t[i].stop();return this}update(t){t*=this.timeScale;let e=this._actions,i=this._nActiveActions,n=this.time+=t,r=Math.sign(t),s=this._accuIndex^=1;for(let l=0;l!==i;++l)e[l]._update(n,t,r,s);let o=this._bindings,a=this._nActiveBindings;for(let l=0;l!==a;++l)o[l].apply(s);return this}setTime(t){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){let e=this._actions,i=t.uuid,n=this._actionsByClip,r=n[i];if(r!==void 0){let s=r.knownActions;for(let o=0,a=s.length;o!==a;++o){let l=s[o];this._deactivateAction(l);let c=l._cacheIndex,h=e[e.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,h._cacheIndex=c,e[c]=h,e.pop(),this._removeInactiveBindingsForAction(l)}delete n[i]}}uncacheRoot(t){let e=t.uuid,i=this._actionsByClip;for(let s in i){let o=i[s].actionByRoot,a=o[e];a!==void 0&&(this._deactivateAction(a),this._removeInactiveAction(a))}let n=this._bindingsByRootAndName,r=n[e];if(r!==void 0)for(let s in r){let o=r[s];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(t,e){let i=this.existingAction(t,e);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}},Ze=class{constructor(t){this.value=t}clone(){return new Ze(this.value.clone===void 0?this.value:this.value.clone())}},ete=class{constructor(t,e,i=0,n=1/0){this.ray=new ay(t,e),this.near=i,this.far=n,this.camera=null,this.layers=new lk,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}intersectObject(t,e=!0,i=[]){return XB(t,this,i,e),i.sort(kW),i}intersectObjects(t,e=!0,i=[]){for(let n=0,r=t.length;n<r;n++)XB(t[n],this,i,e);return i.sort(kW),i}};function kW(t,e){return t.distance-e.distance}function XB(t,e,i,n){if(t.layers.test(e.layers)&&t.raycast(e,i),n===!0){let r=t.children;for(let s=0,o=r.length;s<o;s++)XB(r[s],e,i,!0)}}var zW=class{constructor(t=1,e=0,i=0){return this.radius=t,this.phi=e,this.theta=i,this}set(t,e,i){return this.radius=t,this.phi=e,this.theta=i,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,i){return this.radius=Math.sqrt(t*t+e*e+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,i),this.phi=Math.acos(_r(e/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},GW=new he,VPe=class{constructor(t=new he(1/0,1/0),e=new he(-1/0,-1/0)){this.isBox2=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){let i=GW.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return GW.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},HW=new L,_A=new L,Ya=class{constructor(t=new L,e=new L){this.start=t,this.end=e}set(t,e){return this.start.copy(t),this.end.copy(e),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){HW.subVectors(t,this.start),_A.subVectors(this.end,this.start);let i=_A.dot(_A),n=_A.dot(HW)/i;return e&&(n=_r(n,0,1)),n}closestPointToPoint(t,e,i){let n=this.closestPointToPointParameter(t,e);return this.delta(i).multiplyScalar(n).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},VW=new L,jPe=class extends ji{constructor(t,e){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e,this.type="SpotLightHelper";let i=new Ut,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,o=1,a=32;s<a;s++,o++){let l=s/a*Math.PI*2,c=o/a*Math.PI*2;n.push(Math.cos(l),Math.sin(l),1,Math.cos(c),Math.sin(c),1)}i.setAttribute("position",new yt(n,3));let r=new ff({fog:!1,toneMapped:!1});this.cone=new Bw(i,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),VW.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(VW),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},WPe=class extends co{constructor(t,e,i){let n=new yk(e,4,2),r=new ly({wireframe:!0,fog:!1,toneMapped:!1});super(n,r),this.light=t,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},jW=new L,wA=new L,WW=new L,XPe=class extends ji{constructor(t,e,i){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",e===void 0&&(e=1);let n=new Ut;n.setAttribute("position",new yt([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));let r=new ff({fog:!1,toneMapped:!1});this.lightPlane=new iT(n,r),this.add(this.lightPlane),n=new Ut,n.setAttribute("position",new yt([0,0,0,0,0,1],3)),this.targetLine=new iT(n,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),jW.setFromMatrixPosition(this.light.matrixWorld),wA.setFromMatrixPosition(this.light.target.matrixWorld),WW.subVectors(wA,jW),this.lightPlane.lookAt(wA),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(wA),this.targetLine.scale.z=WW.length()}},bA=new L,Dn=new uy,aT=class extends Bw{constructor(t){let e=new Ut,i=new ff({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],r=[],s={};o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4");function o(f,p){a(f),a(p)}function a(f){n.push(0,0,0),r.push(0,0,0),s[f]===void 0&&(s[f]=[]),s[f].push(n.length/3-1)}e.setAttribute("position",new yt(n,3)),e.setAttribute("color",new yt(r,3)),super(e,i),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();let l=new It(16755200),c=new It(16711680),h=new It(43775),u=new It(16777215),d=new It(3355443);this.setColors(l,c,h,u,d)}setColors(t,e,i,n,r){let s=this.geometry.getAttribute("color");s.setXYZ(0,t.r,t.g,t.b),s.setXYZ(1,t.r,t.g,t.b),s.setXYZ(2,t.r,t.g,t.b),s.setXYZ(3,t.r,t.g,t.b),s.setXYZ(4,t.r,t.g,t.b),s.setXYZ(5,t.r,t.g,t.b),s.setXYZ(6,t.r,t.g,t.b),s.setXYZ(7,t.r,t.g,t.b),s.setXYZ(8,t.r,t.g,t.b),s.setXYZ(9,t.r,t.g,t.b),s.setXYZ(10,t.r,t.g,t.b),s.setXYZ(11,t.r,t.g,t.b),s.setXYZ(12,t.r,t.g,t.b),s.setXYZ(13,t.r,t.g,t.b),s.setXYZ(14,t.r,t.g,t.b),s.setXYZ(15,t.r,t.g,t.b),s.setXYZ(16,t.r,t.g,t.b),s.setXYZ(17,t.r,t.g,t.b),s.setXYZ(18,t.r,t.g,t.b),s.setXYZ(19,t.r,t.g,t.b),s.setXYZ(20,t.r,t.g,t.b),s.setXYZ(21,t.r,t.g,t.b),s.setXYZ(22,t.r,t.g,t.b),s.setXYZ(23,t.r,t.g,t.b),s.setXYZ(24,e.r,e.g,e.b),s.setXYZ(25,e.r,e.g,e.b),s.setXYZ(26,e.r,e.g,e.b),s.setXYZ(27,e.r,e.g,e.b),s.setXYZ(28,e.r,e.g,e.b),s.setXYZ(29,e.r,e.g,e.b),s.setXYZ(30,e.r,e.g,e.b),s.setXYZ(31,e.r,e.g,e.b),s.setXYZ(32,i.r,i.g,i.b),s.setXYZ(33,i.r,i.g,i.b),s.setXYZ(34,i.r,i.g,i.b),s.setXYZ(35,i.r,i.g,i.b),s.setXYZ(36,i.r,i.g,i.b),s.setXYZ(37,i.r,i.g,i.b),s.setXYZ(38,n.r,n.g,n.b),s.setXYZ(39,n.r,n.g,n.b),s.setXYZ(40,r.r,r.g,r.b),s.setXYZ(41,r.r,r.g,r.b),s.setXYZ(42,r.r,r.g,r.b),s.setXYZ(43,r.r,r.g,r.b),s.setXYZ(44,r.r,r.g,r.b),s.setXYZ(45,r.r,r.g,r.b),s.setXYZ(46,r.r,r.g,r.b),s.setXYZ(47,r.r,r.g,r.b),s.setXYZ(48,r.r,r.g,r.b),s.setXYZ(49,r.r,r.g,r.b),s.needsUpdate=!0}update(){let t=this.geometry,e=this.pointMap,i=1,n=1;Dn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),jn("c",e,t,Dn,0,0,-1),jn("t",e,t,Dn,0,0,1),jn("n1",e,t,Dn,-i,-n,-1),jn("n2",e,t,Dn,i,-n,-1),jn("n3",e,t,Dn,-i,n,-1),jn("n4",e,t,Dn,i,n,-1),jn("f1",e,t,Dn,-i,-n,1),jn("f2",e,t,Dn,i,-n,1),jn("f3",e,t,Dn,-i,n,1),jn("f4",e,t,Dn,i,n,1),jn("u1",e,t,Dn,i*.7,n*1.1,-1),jn("u2",e,t,Dn,-i*.7,n*1.1,-1),jn("u3",e,t,Dn,0,n*2,-1),jn("cf1",e,t,Dn,-i,0,1),jn("cf2",e,t,Dn,i,0,1),jn("cf3",e,t,Dn,0,-n,1),jn("cf4",e,t,Dn,0,n,1),jn("cn1",e,t,Dn,-i,0,-1),jn("cn2",e,t,Dn,i,0,-1),jn("cn3",e,t,Dn,0,-n,-1),jn("cn4",e,t,Dn,0,n,-1),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function jn(t,e,i,n,r,s,o){bA.set(r,s,o).unproject(n);let a=e[t];if(a!==void 0){let l=i.getAttribute("position");for(let c=0,h=a.length;c<h;c++)l.setXYZ(a[c],bA.x,bA.y,bA.z)}}var lT=class extends Bw{constructor(t,e=16776960){let i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],r=new Ut;r.setIndex(new Gt(i,1)),r.setAttribute("position",new yt(n,3)),super(r,new ff({color:e,toneMapped:!1})),this.box=t,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(t){let e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}dispose(){this.geometry.dispose(),this.material.dispose()}},qPe=class extends Bw{constructor(t=1){let e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],n=new Ut;n.setAttribute("position",new yt(e,3)),n.setAttribute("color",new yt(i,3));let r=new ff({vertexColors:!0,toneMapped:!1});super(n,r),this.type="AxesHelper"}setColors(t,e,i){let n=new It,r=this.geometry.attributes.color.array;return n.set(t),n.toArray(r,0),n.toArray(r,3),n.set(e),n.toArray(r,6),n.toArray(r,9),n.set(i),n.toArray(r,12),n.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:oy}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=oy);var Mx=".",Sk=Symbol("target"),tte=Symbol("unsubscribe");function qB(t){return t instanceof Date||t instanceof Set||t instanceof Map||t instanceof WeakSet||t instanceof WeakMap||ArrayBuffer.isView(t)}function YPe(t){return(typeof t=="object"?t===null:typeof t!="function")||t instanceof RegExp}var Tc=Array.isArray;function Ak(t){return typeof t=="symbol"}var QPe={after:(t,e)=>Tc(t)?t.slice(e.length):e===""?t:t.slice(e.length+1),concat:(t,e)=>Tc(t)?(t=[...t],e&&t.push(e),t):e&&e.toString!==void 0?(t!==""&&(t+=Mx),Ak(e)?t+e.toString():t+e):t,initial:t=>{if(Tc(t))return t.slice(0,-1);if(t==="")return t;let e=t.lastIndexOf(Mx);return e===-1?"":t.slice(0,e)},last:t=>{if(Tc(t))return t[t.length-1]||"";if(t==="")return t;let e=t.lastIndexOf(Mx);return e===-1?t:t.slice(e+1)},walk:(t,e)=>{if(Tc(t))for(let i of t)e(i);else if(t!==""){let i=0,n=t.indexOf(Mx);if(n===-1)e(t);else for(;i<t.length;)n===-1&&(n=t.length),e(t.slice(i,n)),i=n+1,n=t.indexOf(Mx,i)}},get(t,e){return this.walk(e,i=>{t&&(t=t[i])}),t}},La=QPe;function KPe(t){return typeof t=="object"&&typeof t.next=="function"}function JPe(t,e,i,n,r){let s=t.next;if(e.name==="entries")t.next=function(){let o=s.call(this);return o.done===!1&&(o.value[0]=r(o.value[0],e,o.value[0],n),o.value[1]=r(o.value[1],e,o.value[0],n)),o};else if(e.name==="values"){let o=i[Sk].keys();t.next=function(){let a=s.call(this);return a.done===!1&&(a.value=r(a.value,e,o.next().value,n)),a}}else t.next=function(){let o=s.call(this);return o.done===!1&&(o.value=r(o.value,e,o.value,n)),o};return t}function XW(t,e,i){return t.isUnsubscribed||e.ignoreSymbols&&Ak(i)||e.ignoreUnderscores&&i.charAt(0)==="_"||"ignoreKeys"in e&&e.ignoreKeys.includes(i)}var ZPe=class{constructor(t){this._equals=t,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return this._descriptorCache===void 0&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(t){let e=this._getDescriptorCache(),i=e.get(t);return i===void 0&&(i={},e.set(t,i)),i}_getOwnPropertyDescriptor(t,e){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(t,e);let i=this._getProperties(t),n=i[e];return n===void 0&&(n=Reflect.getOwnPropertyDescriptor(t,e),i[e]=n),n}getProxy(t,e,i,n){if(this.isUnsubscribed)return t;let r=t[n],s=r||t;this._pathCache.set(s,e);let o=this._proxyCache.get(s);return o===void 0&&(o=r===void 0?new Proxy(t,i):t,this._proxyCache.set(s,o)),o}getPath(t){return this.isUnsubscribed?void 0:this._pathCache.get(t)}isDetached(t,e){return!Object.is(t,La.get(e,this.getPath(t)))}defineProperty(t,e,i){return Reflect.defineProperty(t,e,i)?(this.isUnsubscribed||(this._getProperties(t)[e]=i),!0):!1}setProperty(t,e,i,n,r){if(!this._equals(r,i)||!(e in t)){let s=this._getOwnPropertyDescriptor(t,e);return s!==void 0&&"set"in s?Reflect.set(t,e,i,n):Reflect.set(t,e,i)}return!0}deleteProperty(t,e,i){if(Reflect.deleteProperty(t,e)){if(!this.isUnsubscribed){let n=this._getDescriptorCache().get(t);n&&(delete n[e],this._pathCache.delete(i))}return!0}return!1}isSameDescriptor(t,e,i){let n=this._getOwnPropertyDescriptor(e,i);return t!==void 0&&n!==void 0&&Object.is(t.value,n.value)&&(t.writable||!1)===(n.writable||!1)&&(t.enumerable||!1)===(n.enumerable||!1)&&(t.configurable||!1)===(n.configurable||!1)&&t.get===n.get&&t.set===n.set}isGetInvariant(t,e){let i=this._getOwnPropertyDescriptor(t,e);return i!==void 0&&i.configurable!==!0&&i.writable!==!0}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function YB(t){return toString.call(t)==="[object Object]"}function SA(){return!0}function Pg(t,e){return t.length!==e.length||t.some((i,n)=>e[n]!==i)}var ite=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),$Pe=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),nte={push:SA,pop:SA,shift:SA,unshift:SA,copyWithin:Pg,reverse:Pg,sort:Pg,splice:Pg,flat:Pg,fill:Pg},eDe=new Set([...ite,...$Pe,...Object.keys(nte)]);function AA(t,e){if(t.size!==e.size)return!0;for(let i of t)if(!e.has(i))return!0;return!1}var rte=["keys","values","entries"],ste=new Set(["has","toString"]),ote={add:AA,clear:AA,delete:AA,forEach:AA},tDe=new Set([...ste,...Object.keys(ote),...rte]);function MA(t,e){if(t.size!==e.size)return!0;let i;for(let[n,r]of t)if(i=e.get(n),i!==r||i===void 0&&!e.has(n))return!0;return!1}var iDe=new Set([...ste,"get"]),ate={set:MA,clear:MA,delete:MA,forEach:MA},nDe=new Set([...iDe,...Object.keys(ate),...rte]),nf=class{constructor(t,e,i,n){this._path=e,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=n,this._changes=n?[]:null,this.clone=e===void 0?t:this._shallowClone(t)}static isHandledMethod(t){return ite.has(t)}_shallowClone(t){let e=t;if(YB(t))e={...t};else if(Tc(t))e=[...t];else if(t instanceof Date)e=new Date(t);else if(t instanceof Set)e=new Set([...t].map(i=>this._shallowClone(i)));else if(t instanceof Map){e=new Map;for(let[i,n]of t.entries())e.set(i,this._shallowClone(n))}return this._clonedCache.add(e),e}preferredThisArg(t,e,i,n){return t?(Tc(n)?this._onIsChanged=nte[e]:n instanceof Set?this._onIsChanged=ote[e]:n instanceof Map&&(this._onIsChanged=ate[e]),n):i}update(t,e,i){let n=La.after(t,this._path);if(e!=="length"){let r=this.clone;La.walk(n,s=>{r&&r[s]&&(this._clonedCache.has(r[s])||(r[s]=this._shallowClone(r[s])),r=r[s])}),this._hasOnValidate&&this._changes.push({path:n,property:e,previous:i}),r&&r[e]&&(r[e]=i)}this._isChanged=!0}undo(t){let e;for(let i=this._changes.length-1;i!==-1;i--)e=this._changes[i],La.get(t,e.path)[e.property]=e.previous}isChanged(t){return this._onIsChanged===void 0?this._isChanged:this._onIsChanged(this.clone,t)}},qW=class extends nf{static isHandledMethod(t){return eDe.has(t)}},rDe=class extends nf{undo(t){t.setTime(this.clone.getTime())}isChanged(t,e){return!e(this.clone.valueOf(),t.valueOf())}},YW=class extends nf{static isHandledMethod(t){return tDe.has(t)}undo(t){for(let e of this.clone)t.add(e);for(let e of t)this.clone.has(e)||t.delete(e)}},QW=class extends nf{static isHandledMethod(t){return nDe.has(t)}undo(t){for(let[e,i]of this.clone.entries())t.set(e,i);for(let e of t.keys())this.clone.has(e)||t.delete(e)}},sDe=class extends nf{constructor(t,e,i,n){super(void 0,e,i,n),this._arg1=i[0],this._weakValue=t.has(this._arg1)}isChanged(t){return this._weakValue!==t.has(this._arg1)}undo(t){this._weakValue&&!t.has(this._arg1)?t.add(this._arg1):t.delete(this._arg1)}},oDe=class extends nf{constructor(t,e,i,n){super(void 0,e,i,n),this._weakKey=i[0],this._weakHas=t.has(this._weakKey),this._weakValue=t.get(this._weakKey)}isChanged(t){return this._weakValue!==t.get(this._weakKey)}undo(t){let e=t.has(this._weakKey);this._weakHas&&!e?t.set(this._weakKey,this._weakValue):!this._weakHas&&e?t.delete(this._weakKey):this._weakValue!==t.get(this._weakKey)&&t.set(this._weakKey,this._weakValue)}},Qg=class{constructor(t){this._stack=[],this._hasOnValidate=t}static isHandledType(t){return YB(t)||Tc(t)||qB(t)}static isHandledMethod(t,e){return YB(t)?nf.isHandledMethod(e):Tc(t)?qW.isHandledMethod(e):t instanceof Set?YW.isHandledMethod(e):t instanceof Map?QW.isHandledMethod(e):qB(t)}get isCloning(){return this._stack.length>0}start(t,e,i){let n=nf;Tc(t)?n=qW:t instanceof Date?n=rDe:t instanceof Set?n=YW:t instanceof Map?n=QW:t instanceof WeakSet?n=sDe:t instanceof WeakMap&&(n=oDe),this._stack.push(new n(t,e,i,this._hasOnValidate))}update(t,e,i){this._stack[this._stack.length-1].update(t,e,i)}preferredThisArg(t,e,i){let{name:n}=t,r=Qg.isHandledMethod(i,n);return this._stack[this._stack.length-1].preferredThisArg(r,n,e,i)}isChanged(t,e,i){return this._stack[this._stack.length-1].isChanged(t,e,i)}undo(t){this._previousClone!==void 0&&this._previousClone.undo(t)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},aDe={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},Mk=(t,e,i={})=>{i={...aDe,...i};let n=Symbol("ProxyTarget"),{equals:r,isShallow:s,ignoreDetached:o,details:a}=i,l=new ZPe(r),c=typeof i.onValidate=="function",h=new Qg(c),u=(y,x,b,S,A)=>!c||h.isCloning||i.onValidate(La.concat(l.getPath(y),x),b,S,A)===!0,d=(y,x,b,S)=>{!XW(l,i,x)&&!(o&&l.isDetached(y,t))&&f(l.getPath(y),x,b,S)},f=(y,x,b,S,A)=>{h.isCloning?h.update(y,x,S):e(La.concat(y,x),b,S,A)},p=y=>y&&(y[n]||y),m=(y,x,b,S)=>YPe(y)||b==="constructor"||s&&!Qg.isHandledMethod(x,b)||XW(l,i,b)||l.isGetInvariant(x,b)||o&&l.isDetached(x,t)?y:(S===void 0&&(S=l.getPath(x)),l.getProxy(y,La.concat(S,b),v,n)),v={get(y,x,b){if(Ak(x)){if(x===n||x===Sk)return y;if(x===tte&&!l.isUnsubscribed&&l.getPath(y).length===0)return l.unsubscribe(),y}let S=qB(y)?Reflect.get(y,x):Reflect.get(y,x,b);return m(S,y,x)},set(y,x,b,S){b=p(b);let A=y[n]||y,E=A[x];if(r(E,b)&&x in y)return!0;let M=u(y,x,b,E);return M&&l.setProperty(A,x,b,S,E)?(d(y,x,y[x],E),!0):!M},defineProperty(y,x,b){if(!l.isSameDescriptor(b,y,x)){let S=y[x];u(y,x,b.value,S)&&l.defineProperty(y,x,b,S)&&d(y,x,b.value,S)}return!0},deleteProperty(y,x){if(!Reflect.has(y,x))return!0;let b=Reflect.get(y,x),S=u(y,x,void 0,b);return S&&l.deleteProperty(y,x,b)?(d(y,x,void 0,b),!0):!S},apply(y,x,b){let S=x[n]||x;if(l.isUnsubscribed)return Reflect.apply(y,S,b);if((a===!1||a!==!0&&!a.includes(y.name))&&Qg.isHandledType(S)){let A=La.initial(l.getPath(y)),E=Qg.isHandledMethod(S,y.name);h.start(S,A,b);let M=Reflect.apply(y,h.preferredThisArg(y,x,S),E?b.map(R=>p(R)):b),T=h.isChanged(S,r),P=h.stop();if(Qg.isHandledType(M)&&E&&(x instanceof Map&&y.name==="get"&&(A=La.concat(A,b[0])),M=l.getProxy(M,A,v)),T){let R={name:y.name,args:b,result:M},U=h.isCloning?La.initial(A):A,F=h.isCloning?La.last(A):"";u(La.get(t,U),F,S,P,R)?f(U,F,S,P,R):h.undo(S)}return(x instanceof Map||x instanceof Set)&&KPe(M)?JPe(M,y,x,A,m):M}return Reflect.apply(y,x,b)}},g=l.getProxy(t,i.pathAsArray?[]:"",v);return e=e.bind(g),c&&(i.onValidate=i.onValidate.bind(g)),g};Mk.target=t=>t&&t[Sk]||t;Mk.unsubscribe=t=>t[tte]||t;var KW=Mk,lDe=typeof global=="object"&&global&&global.Object===Object&&global,lte=lDe,cDe=typeof self=="object"&&self&&self.Object===Object&&self,uDe=lte||cDe||Function("return this")(),Yl=uDe,hDe=Yl.Symbol,el=hDe,cte=Object.prototype,dDe=cte.hasOwnProperty,fDe=cte.toString,Ex=el?el.toStringTag:void 0;function pDe(t){var e=dDe.call(t,Ex),i=t[Ex];try{t[Ex]=void 0;var n=!0}catch{}var r=fDe.call(t);return n&&(e?t[Ex]=i:delete t[Ex]),r}var mDe=pDe,gDe=Object.prototype,vDe=gDe.toString;function yDe(t){return vDe.call(t)}var xDe=yDe,_De="[object Null]",wDe="[object Undefined]",JW=el?el.toStringTag:void 0;function bDe(t){return t==null?t===void 0?wDe:_De:JW&&JW in Object(t)?mDe(t):xDe(t)}var wm=bDe;function SDe(t){return t!=null&&typeof t=="object"}var fh=SDe,ADe="[object Symbol]";function MDe(t){return typeof t=="symbol"||fh(t)&&wm(t)==ADe}var n2=MDe;function EDe(t,e){for(var i=-1,n=t==null?0:t.length,r=Array(n);++i<n;)r[i]=e(t[i],i,t);return r}var ute=EDe,TDe=Array.isArray,Kc=TDe,CDe=1/0,ZW=el?el.prototype:void 0,$W=ZW?ZW.toString:void 0;function hte(t){if(typeof t=="string")return t;if(Kc(t))return ute(t,hte)+"";if(n2(t))return $W?$W.call(t):"";var e=t+"";return e=="0"&&1/t==-CDe?"-0":e}var PDe=hte,DDe=/\s/;function RDe(t){for(var e=t.length;e--&&DDe.test(t.charAt(e)););return e}var IDe=RDe,LDe=/^\s+/;function BDe(t){return t&&t.slice(0,IDe(t)+1).replace(LDe,"")}var ODe=BDe;function FDe(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Vl=FDe,e8=0/0,NDe=/^[-+]0x[0-9a-f]+$/i,UDe=/^0b[01]+$/i,kDe=/^0o[0-7]+$/i,zDe=parseInt;function GDe(t){if(typeof t=="number")return t;if(n2(t))return e8;if(Vl(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Vl(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=ODe(t);var i=UDe.test(t);return i||kDe.test(t)?zDe(t.slice(2),i?2:8):NDe.test(t)?e8:+t}var t8=GDe;function HDe(t){return t}var VDe=HDe,jDe="[object AsyncFunction]",WDe="[object Function]",XDe="[object GeneratorFunction]",qDe="[object Proxy]";function YDe(t){if(!Vl(t))return!1;var e=wm(t);return e==WDe||e==XDe||e==jDe||e==qDe}var dte=YDe,QDe=Yl["__core-js_shared__"],n3=QDe,i8=function(){var t=/[^.]+$/.exec(n3&&n3.keys&&n3.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function KDe(t){return!!i8&&i8 in t}var JDe=KDe,ZDe=Function.prototype,$De=ZDe.toString;function eRe(t){if(t!=null){try{return $De.call(t)}catch{}try{return t+""}catch{}}return""}var bm=eRe,tRe=/[\\^$.*+?()[\]{}|]/g,iRe=/^\[object .+?Constructor\]$/,nRe=Function.prototype,rRe=Object.prototype,sRe=nRe.toString,oRe=rRe.hasOwnProperty,aRe=RegExp("^"+sRe.call(oRe).replace(tRe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function lRe(t){if(!Vl(t)||JDe(t))return!1;var e=dte(t)?aRe:iRe;return e.test(bm(t))}var cRe=lRe;function uRe(t,e){return t==null?void 0:t[e]}var hRe=uRe;function dRe(t,e){var i=hRe(t,e);return cRe(i)?i:void 0}var Sm=dRe,fRe=Sm(Yl,"WeakMap"),QB=fRe,n8=Object.create,pRe=function(){function t(){}return function(e){if(!Vl(e))return{};if(n8)return n8(e);t.prototype=e;var i=new t;return t.prototype=void 0,i}}(),mRe=pRe;function gRe(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}var vRe=gRe;function yRe(t,e){var i=-1,n=t.length;for(e||(e=Array(n));++i<n;)e[i]=t[i];return e}var xRe=yRe,_Re=800,wRe=16,bRe=Date.now;function SRe(t){var e=0,i=0;return function(){var n=bRe(),r=wRe-(n-i);if(i=n,r>0){if(++e>=_Re)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var ARe=SRe;function MRe(t){return function(){return t}}var ERe=MRe,TRe=function(){try{var t=Sm(Object,"defineProperty");return t({},"",{}),t}catch{}}(),cT=TRe,CRe=cT?function(t,e){return cT(t,"toString",{configurable:!0,enumerable:!1,value:ERe(e),writable:!0})}:VDe,PRe=CRe,DRe=ARe(PRe),RRe=DRe;function IRe(t,e){for(var i=-1,n=t==null?0:t.length;++i<n&&e(t[i],i,t)!==!1;);return t}var LRe=IRe,BRe=9007199254740991,ORe=/^(?:0|[1-9]\d*)$/;function FRe(t,e){var i=typeof t;return e=e??BRe,!!e&&(i=="number"||i!="symbol"&&ORe.test(t))&&t>-1&&t%1==0&&t<e}var Ek=FRe;function NRe(t,e,i){e=="__proto__"&&cT?cT(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}var fte=NRe;function URe(t,e){return t===e||t!==t&&e!==e}var Tk=URe,kRe=Object.prototype,zRe=kRe.hasOwnProperty;function GRe(t,e,i){var n=t[e];(!(zRe.call(t,e)&&Tk(n,i))||i===void 0&&!(e in t))&&fte(t,e,i)}var Ck=GRe;function HRe(t,e,i,n){var r=!i;i||(i={});for(var s=-1,o=e.length;++s<o;){var a=e[s],l=n?n(i[a],t[a],a,i,t):void 0;l===void 0&&(l=t[a]),r?fte(i,a,l):Ck(i,a,l)}return i}var Nw=HRe,r8=Math.max;function VRe(t,e,i){return e=r8(e===void 0?t.length-1:e,0),function(){for(var n=arguments,r=-1,s=r8(n.length-e,0),o=Array(s);++r<s;)o[r]=n[e+r];r=-1;for(var a=Array(e+1);++r<e;)a[r]=n[r];return a[e]=i(o),vRe(t,this,a)}}var jRe=VRe,WRe=9007199254740991;function XRe(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=WRe}var Pk=XRe;function qRe(t){return t!=null&&Pk(t.length)&&!dte(t)}var pte=qRe,YRe=Object.prototype;function QRe(t){var e=t&&t.constructor,i=typeof e=="function"&&e.prototype||YRe;return t===i}var Dk=QRe;function KRe(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}var JRe=KRe,ZRe="[object Arguments]";function $Re(t){return fh(t)&&wm(t)==ZRe}var s8=$Re,mte=Object.prototype,e3e=mte.hasOwnProperty,t3e=mte.propertyIsEnumerable,i3e=s8(function(){return arguments}())?s8:function(t){return fh(t)&&e3e.call(t,"callee")&&!t3e.call(t,"callee")},Rk=i3e;function n3e(){return!1}var r3e=n3e,gte=typeof Qo=="object"&&Qo&&!Qo.nodeType&&Qo,o8=gte&&typeof Ko=="object"&&Ko&&!Ko.nodeType&&Ko,s3e=o8&&o8.exports===gte,a8=s3e?Yl.Buffer:void 0,o3e=a8?a8.isBuffer:void 0,a3e=o3e||r3e,uT=a3e,l3e="[object Arguments]",c3e="[object Array]",u3e="[object Boolean]",h3e="[object Date]",d3e="[object Error]",f3e="[object Function]",p3e="[object Map]",m3e="[object Number]",g3e="[object Object]",v3e="[object RegExp]",y3e="[object Set]",x3e="[object String]",_3e="[object WeakMap]",w3e="[object ArrayBuffer]",b3e="[object DataView]",S3e="[object Float32Array]",A3e="[object Float64Array]",M3e="[object Int8Array]",E3e="[object Int16Array]",T3e="[object Int32Array]",C3e="[object Uint8Array]",P3e="[object Uint8ClampedArray]",D3e="[object Uint16Array]",R3e="[object Uint32Array]",an={};an[S3e]=an[A3e]=an[M3e]=an[E3e]=an[T3e]=an[C3e]=an[P3e]=an[D3e]=an[R3e]=!0;an[l3e]=an[c3e]=an[w3e]=an[u3e]=an[b3e]=an[h3e]=an[d3e]=an[f3e]=an[p3e]=an[m3e]=an[g3e]=an[v3e]=an[y3e]=an[x3e]=an[_3e]=!1;function I3e(t){return fh(t)&&Pk(t.length)&&!!an[wm(t)]}var L3e=I3e;function B3e(t){return function(e){return t(e)}}var Ik=B3e,vte=typeof Qo=="object"&&Qo&&!Qo.nodeType&&Qo,G1=vte&&typeof Ko=="object"&&Ko&&!Ko.nodeType&&Ko,O3e=G1&&G1.exports===vte,r3=O3e&&lte.process,F3e=function(){try{var t=G1&&G1.require&&G1.require("util").types;return t||r3&&r3.binding&&r3.binding("util")}catch{}}(),z0=F3e,l8=z0&&z0.isTypedArray,N3e=l8?Ik(l8):L3e,yte=N3e,U3e=Object.prototype,k3e=U3e.hasOwnProperty;function z3e(t,e){var i=Kc(t),n=!i&&Rk(t),r=!i&&!n&&uT(t),s=!i&&!n&&!r&&yte(t),o=i||n||r||s,a=o?JRe(t.length,String):[],l=a.length;for(var c in t)(e||k3e.call(t,c))&&!(o&&(c=="length"||r&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||Ek(c,l)))&&a.push(c);return a}var xte=z3e;function G3e(t,e){return function(i){return t(e(i))}}var _te=G3e,H3e=_te(Object.keys,Object),V3e=H3e,j3e=Object.prototype,W3e=j3e.hasOwnProperty;function X3e(t){if(!Dk(t))return V3e(t);var e=[];for(var i in Object(t))W3e.call(t,i)&&i!="constructor"&&e.push(i);return e}var q3e=X3e;function Y3e(t){return pte(t)?xte(t):q3e(t)}var Lk=Y3e;function Q3e(t){var e=[];if(t!=null)for(var i in Object(t))e.push(i);return e}var K3e=Q3e,J3e=Object.prototype,Z3e=J3e.hasOwnProperty;function $3e(t){if(!Vl(t))return K3e(t);var e=Dk(t),i=[];for(var n in t)n=="constructor"&&(e||!Z3e.call(t,n))||i.push(n);return i}var eIe=$3e;function tIe(t){return pte(t)?xte(t,!0):eIe(t)}var Bk=tIe,iIe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,nIe=/^\w*$/;function rIe(t,e){if(Kc(t))return!1;var i=typeof t;return i=="number"||i=="symbol"||i=="boolean"||t==null||n2(t)?!0:nIe.test(t)||!iIe.test(t)||e!=null&&t in Object(e)}var sIe=rIe,oIe=Sm(Object,"create"),W_=oIe;function aIe(){this.__data__=W_?W_(null):{},this.size=0}var lIe=aIe;function cIe(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var uIe=cIe,hIe="__lodash_hash_undefined__",dIe=Object.prototype,fIe=dIe.hasOwnProperty;function pIe(t){var e=this.__data__;if(W_){var i=e[t];return i===hIe?void 0:i}return fIe.call(e,t)?e[t]:void 0}var mIe=pIe,gIe=Object.prototype,vIe=gIe.hasOwnProperty;function yIe(t){var e=this.__data__;return W_?e[t]!==void 0:vIe.call(e,t)}var xIe=yIe,_Ie="__lodash_hash_undefined__";function wIe(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=W_&&e===void 0?_Ie:e,this}var bIe=wIe;function py(t){var e=-1,i=t==null?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}py.prototype.clear=lIe;py.prototype.delete=uIe;py.prototype.get=mIe;py.prototype.has=xIe;py.prototype.set=bIe;var c8=py;function SIe(){this.__data__=[],this.size=0}var AIe=SIe;function MIe(t,e){for(var i=t.length;i--;)if(Tk(t[i][0],e))return i;return-1}var r2=MIe,EIe=Array.prototype,TIe=EIe.splice;function CIe(t){var e=this.__data__,i=r2(e,t);if(i<0)return!1;var n=e.length-1;return i==n?e.pop():TIe.call(e,i,1),--this.size,!0}var PIe=CIe;function DIe(t){var e=this.__data__,i=r2(e,t);return i<0?void 0:e[i][1]}var RIe=DIe;function IIe(t){return r2(this.__data__,t)>-1}var LIe=IIe;function BIe(t,e){var i=this.__data__,n=r2(i,t);return n<0?(++this.size,i.push([t,e])):i[n][1]=e,this}var OIe=BIe;function my(t){var e=-1,i=t==null?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}my.prototype.clear=AIe;my.prototype.delete=PIe;my.prototype.get=RIe;my.prototype.has=LIe;my.prototype.set=OIe;var s2=my,FIe=Sm(Yl,"Map"),X_=FIe;function NIe(){this.size=0,this.__data__={hash:new c8,map:new(X_||s2),string:new c8}}var UIe=NIe;function kIe(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var zIe=kIe;function GIe(t,e){var i=t.__data__;return zIe(e)?i[typeof e=="string"?"string":"hash"]:i.map}var o2=GIe;function HIe(t){var e=o2(this,t).delete(t);return this.size-=e?1:0,e}var VIe=HIe;function jIe(t){return o2(this,t).get(t)}var WIe=jIe;function XIe(t){return o2(this,t).has(t)}var qIe=XIe;function YIe(t,e){var i=o2(this,t),n=i.size;return i.set(t,e),this.size+=i.size==n?0:1,this}var QIe=YIe;function gy(t){var e=-1,i=t==null?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}gy.prototype.clear=UIe;gy.prototype.delete=VIe;gy.prototype.get=WIe;gy.prototype.has=qIe;gy.prototype.set=QIe;var a2=gy,KIe="Expected a function";function Ok(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(KIe);var i=function(){var n=arguments,r=e?e.apply(this,n):n[0],s=i.cache;if(s.has(r))return s.get(r);var o=t.apply(this,n);return i.cache=s.set(r,o)||s,o};return i.cache=new(Ok.Cache||a2),i}Ok.Cache=a2;var JIe=Ok,ZIe=500;function $Ie(t){var e=JIe(t,function(n){return i.size===ZIe&&i.clear(),n}),i=e.cache;return e}var eLe=$Ie,tLe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,iLe=/\\(\\)?/g,nLe=eLe(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(tLe,function(i,n,r,s){e.push(r?s.replace(iLe,"$1"):n||i)}),e}),rLe=nLe;function sLe(t){return t==null?"":PDe(t)}var oLe=sLe;function aLe(t,e){return Kc(t)?t:sIe(t,e)?[t]:rLe(oLe(t))}var vy=aLe,lLe=1/0;function cLe(t){if(typeof t=="string"||n2(t))return t;var e=t+"";return e=="0"&&1/t==-lLe?"-0":e}var l2=cLe;function uLe(t,e){e=vy(e,t);for(var i=0,n=e.length;t!=null&&i<n;)t=t[l2(e[i++])];return i&&i==n?t:void 0}var wte=uLe;function hLe(t,e){for(var i=-1,n=e.length,r=t.length;++i<n;)t[r+i]=e[i];return t}var Fk=hLe,u8=el?el.isConcatSpreadable:void 0;function dLe(t){return Kc(t)||Rk(t)||!!(u8&&t&&t[u8])}var fLe=dLe;function bte(t,e,i,n,r){var s=-1,o=t.length;for(i||(i=fLe),r||(r=[]);++s<o;){var a=t[s];e>0&&i(a)?e>1?bte(a,e-1,i,n,r):Fk(r,a):n||(r[r.length]=a)}return r}var pLe=bte;function mLe(t){var e=t==null?0:t.length;return e?pLe(t,1):[]}var gLe=mLe;function vLe(t){return RRe(jRe(t,void 0,gLe),t+"")}var Ste=vLe,yLe=_te(Object.getPrototypeOf,Object),Nk=yLe,xLe="[object Object]",_Le=Function.prototype,wLe=Object.prototype,Ate=_Le.toString,bLe=wLe.hasOwnProperty,SLe=Ate.call(Object);function ALe(t){if(!fh(t)||wm(t)!=xLe)return!1;var e=Nk(t);if(e===null)return!0;var i=bLe.call(e,"constructor")&&e.constructor;return typeof i=="function"&&i instanceof i&&Ate.call(i)==SLe}var MLe=ALe;function ELe(t,e,i){var n=-1,r=t.length;e<0&&(e=-e>r?0:r+e),i=i>r?r:i,i<0&&(i+=r),r=e>i?0:i-e>>>0,e>>>=0;for(var s=Array(r);++n<r;)s[n]=t[n+e];return s}var TLe=ELe;function CLe(){this.__data__=new s2,this.size=0}var PLe=CLe;function DLe(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i}var RLe=DLe;function ILe(t){return this.__data__.get(t)}var LLe=ILe;function BLe(t){return this.__data__.has(t)}var OLe=BLe,FLe=200;function NLe(t,e){var i=this.__data__;if(i instanceof s2){var n=i.__data__;if(!X_||n.length<FLe-1)return n.push([t,e]),this.size=++i.size,this;i=this.__data__=new a2(n)}return i.set(t,e),this.size=i.size,this}var ULe=NLe;function yy(t){var e=this.__data__=new s2(t);this.size=e.size}yy.prototype.clear=PLe;yy.prototype.delete=RLe;yy.prototype.get=LLe;yy.prototype.has=OLe;yy.prototype.set=ULe;var jM=yy;function kLe(t,e){return t&&Nw(e,Lk(e),t)}var zLe=kLe;function GLe(t,e){return t&&Nw(e,Bk(e),t)}var HLe=GLe,Mte=typeof Qo=="object"&&Qo&&!Qo.nodeType&&Qo,h8=Mte&&typeof Ko=="object"&&Ko&&!Ko.nodeType&&Ko,VLe=h8&&h8.exports===Mte,d8=VLe?Yl.Buffer:void 0,f8=d8?d8.allocUnsafe:void 0;function jLe(t,e){if(e)return t.slice();var i=t.length,n=f8?f8(i):new t.constructor(i);return t.copy(n),n}var WLe=jLe;function XLe(t,e){for(var i=-1,n=t==null?0:t.length,r=0,s=[];++i<n;){var o=t[i];e(o,i,t)&&(s[r++]=o)}return s}var qLe=XLe;function YLe(){return[]}var Ete=YLe,QLe=Object.prototype,KLe=QLe.propertyIsEnumerable,p8=Object.getOwnPropertySymbols,JLe=p8?function(t){return t==null?[]:(t=Object(t),qLe(p8(t),function(e){return KLe.call(t,e)}))}:Ete,Uk=JLe;function ZLe(t,e){return Nw(t,Uk(t),e)}var $Le=ZLe,eBe=Object.getOwnPropertySymbols,tBe=eBe?function(t){for(var e=[];t;)Fk(e,Uk(t)),t=Nk(t);return e}:Ete,Tte=tBe;function iBe(t,e){return Nw(t,Tte(t),e)}var nBe=iBe;function rBe(t,e,i){var n=e(t);return Kc(t)?n:Fk(n,i(t))}var Cte=rBe;function sBe(t){return Cte(t,Lk,Uk)}var KB=sBe;function oBe(t){return Cte(t,Bk,Tte)}var Pte=oBe,aBe=Sm(Yl,"DataView"),JB=aBe,lBe=Sm(Yl,"Promise"),ZB=lBe,cBe=Sm(Yl,"Set"),$B=cBe,m8="[object Map]",uBe="[object Object]",g8="[object Promise]",v8="[object Set]",y8="[object WeakMap]",x8="[object DataView]",hBe=bm(JB),dBe=bm(X_),fBe=bm(ZB),pBe=bm($B),mBe=bm(QB),ip=wm;(JB&&ip(new JB(new ArrayBuffer(1)))!=x8||X_&&ip(new X_)!=m8||ZB&&ip(ZB.resolve())!=g8||$B&&ip(new $B)!=v8||QB&&ip(new QB)!=y8)&&(ip=function(t){var e=wm(t),i=e==uBe?t.constructor:void 0,n=i?bm(i):"";if(n)switch(n){case hBe:return x8;case dBe:return m8;case fBe:return g8;case pBe:return v8;case mBe:return y8}return e});var q_=ip,gBe=Object.prototype,vBe=gBe.hasOwnProperty;function yBe(t){var e=t.length,i=new t.constructor(e);return e&&typeof t[0]=="string"&&vBe.call(t,"index")&&(i.index=t.index,i.input=t.input),i}var xBe=yBe,_Be=Yl.Uint8Array,hT=_Be;function wBe(t){var e=new t.constructor(t.byteLength);return new hT(e).set(new hT(t)),e}var kk=wBe;function bBe(t,e){var i=e?kk(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}var SBe=bBe,ABe=/\w*$/;function MBe(t){var e=new t.constructor(t.source,ABe.exec(t));return e.lastIndex=t.lastIndex,e}var EBe=MBe,_8=el?el.prototype:void 0,w8=_8?_8.valueOf:void 0;function TBe(t){return w8?Object(w8.call(t)):{}}var CBe=TBe;function PBe(t,e){var i=e?kk(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}var DBe=PBe,RBe="[object Boolean]",IBe="[object Date]",LBe="[object Map]",BBe="[object Number]",OBe="[object RegExp]",FBe="[object Set]",NBe="[object String]",UBe="[object Symbol]",kBe="[object ArrayBuffer]",zBe="[object DataView]",GBe="[object Float32Array]",HBe="[object Float64Array]",VBe="[object Int8Array]",jBe="[object Int16Array]",WBe="[object Int32Array]",XBe="[object Uint8Array]",qBe="[object Uint8ClampedArray]",YBe="[object Uint16Array]",QBe="[object Uint32Array]";function KBe(t,e,i){var n=t.constructor;switch(e){case kBe:return kk(t);case RBe:case IBe:return new n(+t);case zBe:return SBe(t,i);case GBe:case HBe:case VBe:case jBe:case WBe:case XBe:case qBe:case YBe:case QBe:return DBe(t,i);case LBe:return new n;case BBe:case NBe:return new n(t);case OBe:return EBe(t);case FBe:return new n;case UBe:return CBe(t)}}var JBe=KBe;function ZBe(t){return typeof t.constructor=="function"&&!Dk(t)?mRe(Nk(t)):{}}var $Be=ZBe,eOe="[object Map]";function tOe(t){return fh(t)&&q_(t)==eOe}var iOe=tOe,b8=z0&&z0.isMap,nOe=b8?Ik(b8):iOe,rOe=nOe,sOe="[object Set]";function oOe(t){return fh(t)&&q_(t)==sOe}var aOe=oOe,S8=z0&&z0.isSet,lOe=S8?Ik(S8):aOe,cOe=lOe,uOe=1,hOe=2,dOe=4,Dte="[object Arguments]",fOe="[object Array]",pOe="[object Boolean]",mOe="[object Date]",gOe="[object Error]",Rte="[object Function]",vOe="[object GeneratorFunction]",yOe="[object Map]",xOe="[object Number]",Ite="[object Object]",_Oe="[object RegExp]",wOe="[object Set]",bOe="[object String]",SOe="[object Symbol]",AOe="[object WeakMap]",MOe="[object ArrayBuffer]",EOe="[object DataView]",TOe="[object Float32Array]",COe="[object Float64Array]",POe="[object Int8Array]",DOe="[object Int16Array]",ROe="[object Int32Array]",IOe="[object Uint8Array]",LOe="[object Uint8ClampedArray]",BOe="[object Uint16Array]",OOe="[object Uint32Array]",en={};en[Dte]=en[fOe]=en[MOe]=en[EOe]=en[pOe]=en[mOe]=en[TOe]=en[COe]=en[POe]=en[DOe]=en[ROe]=en[yOe]=en[xOe]=en[Ite]=en[_Oe]=en[wOe]=en[bOe]=en[SOe]=en[IOe]=en[LOe]=en[BOe]=en[OOe]=!0;en[gOe]=en[Rte]=en[AOe]=!1;function WM(t,e,i,n,r,s){var o,a=e&uOe,l=e&hOe,c=e&dOe;if(i&&(o=r?i(t,n,r,s):i(t)),o!==void 0)return o;if(!Vl(t))return t;var h=Kc(t);if(h){if(o=xBe(t),!a)return xRe(t,o)}else{var u=q_(t),d=u==Rte||u==vOe;if(uT(t))return WLe(t,a);if(u==Ite||u==Dte||d&&!r){if(o=l||d?{}:$Be(t),!a)return l?nBe(t,HLe(o,t)):$Le(t,zLe(o,t))}else{if(!en[u])return r?t:{};o=JBe(t,u,a)}}s||(s=new jM);var f=s.get(t);if(f)return f;s.set(t,o),cOe(t)?t.forEach(function(v){o.add(WM(v,e,i,v,t,s))}):rOe(t)&&t.forEach(function(v,g){o.set(g,WM(v,e,i,g,t,s))});var p=c?l?Pte:KB:l?Bk:Lk,m=h?void 0:p(t);return LRe(m||t,function(v,g){m&&(g=v,v=t[g]),Ck(o,g,WM(v,e,i,g,t,s))}),o}var Lte=WM,FOe=1,NOe=4;function UOe(t){return Lte(t,FOe|NOe)}var c2=UOe,kOe="__lodash_hash_undefined__";function zOe(t){return this.__data__.set(t,kOe),this}var GOe=zOe;function HOe(t){return this.__data__.has(t)}var VOe=HOe;function dT(t){var e=-1,i=t==null?0:t.length;for(this.__data__=new a2;++e<i;)this.add(t[e])}dT.prototype.add=dT.prototype.push=GOe;dT.prototype.has=VOe;var jOe=dT;function WOe(t,e){for(var i=-1,n=t==null?0:t.length;++i<n;)if(e(t[i],i,t))return!0;return!1}var XOe=WOe;function qOe(t,e){return t.has(e)}var YOe=qOe,QOe=1,KOe=2;function JOe(t,e,i,n,r,s){var o=i&QOe,a=t.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(t),h=s.get(e);if(c&&h)return c==e&&h==t;var u=-1,d=!0,f=i&KOe?new jOe:void 0;for(s.set(t,e),s.set(e,t);++u<a;){var p=t[u],m=e[u];if(n)var v=o?n(m,p,u,e,t,s):n(p,m,u,t,e,s);if(v!==void 0){if(v)continue;d=!1;break}if(f){if(!XOe(e,function(g,y){if(!YOe(f,y)&&(p===g||r(p,g,i,n,s)))return f.push(y)})){d=!1;break}}else if(!(p===m||r(p,m,i,n,s))){d=!1;break}}return s.delete(t),s.delete(e),d}var Bte=JOe;function ZOe(t){var e=-1,i=Array(t.size);return t.forEach(function(n,r){i[++e]=[r,n]}),i}var $Oe=ZOe;function eFe(t){var e=-1,i=Array(t.size);return t.forEach(function(n){i[++e]=n}),i}var tFe=eFe,iFe=1,nFe=2,rFe="[object Boolean]",sFe="[object Date]",oFe="[object Error]",aFe="[object Map]",lFe="[object Number]",cFe="[object RegExp]",uFe="[object Set]",hFe="[object String]",dFe="[object Symbol]",fFe="[object ArrayBuffer]",pFe="[object DataView]",A8=el?el.prototype:void 0,s3=A8?A8.valueOf:void 0;function mFe(t,e,i,n,r,s,o){switch(i){case pFe:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case fFe:return!(t.byteLength!=e.byteLength||!s(new hT(t),new hT(e)));case rFe:case sFe:case lFe:return Tk(+t,+e);case oFe:return t.name==e.name&&t.message==e.message;case cFe:case hFe:return t==e+"";case aFe:var a=$Oe;case uFe:var l=n&iFe;if(a||(a=tFe),t.size!=e.size&&!l)return!1;var c=o.get(t);if(c)return c==e;n|=nFe,o.set(t,e);var h=Bte(a(t),a(e),n,r,s,o);return o.delete(t),h;case dFe:if(s3)return s3.call(t)==s3.call(e)}return!1}var gFe=mFe,vFe=1,yFe=Object.prototype,xFe=yFe.hasOwnProperty;function _Fe(t,e,i,n,r,s){var o=i&vFe,a=KB(t),l=a.length,c=KB(e),h=c.length;if(l!=h&&!o)return!1;for(var u=l;u--;){var d=a[u];if(!(o?d in e:xFe.call(e,d)))return!1}var f=s.get(t),p=s.get(e);if(f&&p)return f==e&&p==t;var m=!0;s.set(t,e),s.set(e,t);for(var v=o;++u<l;){d=a[u];var g=t[d],y=e[d];if(n)var x=o?n(y,g,d,e,t,s):n(g,y,d,t,e,s);if(!(x===void 0?g===y||r(g,y,i,n,s):x)){m=!1;break}v||(v=d=="constructor")}if(m&&!v){var b=t.constructor,S=e.constructor;b!=S&&"constructor"in t&&"constructor"in e&&!(typeof b=="function"&&b instanceof b&&typeof S=="function"&&S instanceof S)&&(m=!1)}return s.delete(t),s.delete(e),m}var wFe=_Fe,bFe=1,M8="[object Arguments]",E8="[object Array]",EA="[object Object]",SFe=Object.prototype,T8=SFe.hasOwnProperty;function AFe(t,e,i,n,r,s){var o=Kc(t),a=Kc(e),l=o?E8:q_(t),c=a?E8:q_(e);l=l==M8?EA:l,c=c==M8?EA:c;var h=l==EA,u=c==EA,d=l==c;if(d&&uT(t)){if(!uT(e))return!1;o=!0,h=!1}if(d&&!h)return s||(s=new jM),o||yte(t)?Bte(t,e,i,n,r,s):gFe(t,e,l,i,n,r,s);if(!(i&bFe)){var f=h&&T8.call(t,"__wrapped__"),p=u&&T8.call(e,"__wrapped__");if(f||p){var m=f?t.value():t,v=p?e.value():e;return s||(s=new jM),r(m,v,i,n,s)}}return d?(s||(s=new jM),wFe(t,e,i,n,r,s)):!1}var MFe=AFe;function Ote(t,e,i,n,r){return t===e?!0:t==null||e==null||!fh(t)&&!fh(e)?t!==t&&e!==e:MFe(t,e,i,n,Ote,r)}var EFe=Ote;function TFe(t,e){return t!=null&&e in Object(t)}var CFe=TFe;function PFe(t,e,i){e=vy(e,t);for(var n=-1,r=e.length,s=!1;++n<r;){var o=l2(e[n]);if(!(s=t!=null&&i(t,o)))break;t=t[o]}return s||++n!=r?s:(r=t==null?0:t.length,!!r&&Pk(r)&&Ek(o,r)&&(Kc(t)||Rk(t)))}var DFe=PFe;function RFe(t,e){return t!=null&&DFe(t,e,CFe)}var IFe=RFe,LFe=function(){return Yl.Date.now()},o3=LFe,BFe="Expected a function",OFe=Math.max,FFe=Math.min;function NFe(t,e,i){var n,r,s,o,a,l,c=0,h=!1,u=!1,d=!0;if(typeof t!="function")throw new TypeError(BFe);e=t8(e)||0,Vl(i)&&(h=!!i.leading,u="maxWait"in i,s=u?OFe(t8(i.maxWait)||0,e):s,d="trailing"in i?!!i.trailing:d);function f(A){var E=n,M=r;return n=r=void 0,c=A,o=t.apply(M,E),o}function p(A){return c=A,a=setTimeout(g,e),h?f(A):o}function m(A){var E=A-l,M=A-c,T=e-E;return u?FFe(T,s-M):T}function v(A){var E=A-l,M=A-c;return l===void 0||E>=e||E<0||u&&M>=s}function g(){var A=o3();if(v(A))return y(A);a=setTimeout(g,m(A))}function y(A){return a=void 0,d&&n?f(A):(n=r=void 0,o)}function x(){a!==void 0&&clearTimeout(a),c=0,n=l=r=a=void 0}function b(){return a===void 0?o:y(o3())}function S(){var A=o3(),E=v(A);if(n=arguments,r=this,l=A,E){if(a===void 0)return p(l);if(u)return clearTimeout(a),a=setTimeout(g,e),f(l)}return a===void 0&&(a=setTimeout(g,e)),o}return S.cancel=x,S.flush=b,S}var zk=NFe;function UFe(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var kFe=UFe;function zFe(t,e){return e.length<2?t:wte(t,TLe(e,0,-1))}var GFe=zFe;function HFe(t,e){return EFe(t,e)}var Gk=HFe;function VFe(t,e){return e=vy(e,t),t=GFe(t,e),t==null||delete t[l2(kFe(e))]}var jFe=VFe;function WFe(t){return MLe(t)?void 0:t}var XFe=WFe,qFe=1,YFe=2,QFe=4,KFe=Ste(function(t,e){var i={};if(t==null)return i;var n=!1;e=ute(e,function(s){return s=vy(s,t),n||(n=s.length>1),s}),Nw(t,Pte(t),i),n&&(i=Lte(i,qFe|YFe|QFe,XFe));for(var r=e.length;r--;)jFe(i,e[r]);return i}),eO=KFe;function JFe(t,e,i,n){if(!Vl(t))return t;e=vy(e,t);for(var r=-1,s=e.length,o=s-1,a=t;a!=null&&++r<s;){var l=l2(e[r]),c=i;if(l==="__proto__"||l==="constructor"||l==="prototype")return t;if(r!=o){var h=a[l];c=n?n(h,l,a):void 0,c===void 0&&(c=Vl(h)?h:Ek(e[r+1])?[]:{})}Ck(a,l,c),a=a[l]}return t}var ZFe=JFe;function $Fe(t,e,i){for(var n=-1,r=e.length,s={};++n<r;){var o=e[n],a=wte(t,o);i(a,o)&&ZFe(s,vy(o,t),a)}return s}var eNe=$Fe;function tNe(t,e){return eNe(t,e,function(i,n){return IFe(t,n)})}var iNe=tNe,nNe=Ste(function(t,e){return t==null?{}:iNe(t,e)}),Ud=nNe,rNe="Expected a function";function sNe(t,e,i){var n=!0,r=!0;if(typeof t!="function")throw new TypeError(rNe);return Vl(i)&&(n="leading"in i?!!i.leading:n,r="trailing"in i?!!i.trailing:r),zk(t,e,{leading:n,maxWait:e,trailing:r})}var oNe=sNe;function aNe(t){for(let e of Object.keys(t))t[e]===void 0&&delete t[e];return t}function cm(t,e){return Object.setPrototypeOf(t,e),t}var lNe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes(" electron/"),cNe=()=>typeof window>"u"?!1:window.navigator.platform.toUpperCase().includes("MAC"),uNe=()=>typeof window>"u"?!1:/iPad|iPhone|iPod/.test(window.navigator.userAgent)||u2&&"ontouchend"in document,hNe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,dNe=()=>typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0,fNe=()=>{if(typeof window>"u")return!1;let t=navigator.userAgent,e=navigator.vendor;return/Safari/i.test(t)&&/Apple Computer/.test(e)},pNe=()=>{if(typeof window>"u")return null;let t=navigator.userAgent.match(/Version\/(\d+\.\d)/);return t&&t[1]};lNe();var u2=cNe(),Fte=uNe(),mNe=hNe(),qo=dNe(),C8=fNe(),P8=Number(pNe());function Nte(t){return Array.isArray(t)?t:[t]}function gNe(t,e){let i=0;for(;i<t.length&&i<e.length;){if(t[i]<e[i])return-1;if(t[i]>e[i])return 1;i+=1}return i!==e.length?-1:i!==t.length?1:0}function TA(t){return u2?t.metaKey:t.ctrlKey}var Ot=[],fT={},a1={},XM={};function Ute(t){Ot.includes(t)||Ot.push(t)}function Xv(t){delete fT[t.pointerId];for(let e=0;e<Ot.length;e++)if(Ot[e].pointerId===t.pointerId){Ot.splice(e,1);break}}function vNe(){Ot.splice(0,Ot.length)}function pT(t){if(t.pointerType!=="touch")return;let e=fT[t.pointerId];e===void 0&&(e={x:0,y:0},fT[t.pointerId]=e),e.x=t.pageX,e.y=t.pageY}function a3(t){let e=t.pointerId===Ot[0].pointerId?Ot[1]:Ot[0];return fT[e.pointerId]}function kte(t){a1[t.key]=!0,XM[t.key]=XM[t.key]===void 0?1:XM[t.key]+1}function zte(t){if(u2&&a1.Meta)for(let e in a1)a1[e]=!1;else a1[t.key]=!1;XM={}}function yNe(t){t.addEventListener("pointerdown",Ute,!0),t.addEventListener("pointerdown",pT,!0),t.addEventListener("pointermove",pT,!0),t.addEventListener("pointerup",Xv,!0),t.addEventListener("pointercancel",Xv,!0),t.addEventListener("pointerleave",Xv,!0),window.addEventListener("keydown",kte,!0),window.addEventListener("keyup",zte,!0)}function xNe(t){t.removeEventListener("pointerdown",Ute,!0),t.removeEventListener("pointerdown",pT,!0),t.removeEventListener("pointermove",pT,!0),t.removeEventListener("pointerup",Xv,!0),t.removeEventListener("pointercancel",Xv,!0),t.removeEventListener("pointerleave",Xv,!0),window.removeEventListener("keydown",kte,!0),window.removeEventListener("keyup",zte,!0)}var Gte,_Ne=new Promise(t=>{Gte=t}),CA;function wNe(){if(CA)return CA;async function t(){let e="https://unpkg.com/@splinetool/navmesh-wasm@0.9.405/build",[i,n]=await Promise.all([Dw(()=>import("./navmesh-0b92f809.js"),[]),fetch(`${e}/navmesh.wasm`).then(o=>o.arrayBuffer())]),r=i.default,s=await r({wasmBinary:n});Gte(s)}return CA=t(),CA}var Hte,bNe=new Promise(t=>{Hte=t}),PA;function SNe(){if(PA)return PA;async function t(){let e=await Dw(()=>import("./physics-dee4de67.js"),[]);await e.init(),Hte(e)}return PA=t(),PA}var ar=class{modifyById(t,e){let i=this;if(i[t]===void 0)throw new Error("not expected");{let n={...i,[t]:e};return Object.setPrototypeOf(n,ar.prototype),n}}add(t,e){var i;return((i=this.runOp({type:1,id:t,data:e}))==null?void 0:i.data)??this}runOp(t){let e=this;if(t.type===1){let i=e[t.id],n;i===void 0?n={type:2,id:t.id}:n={type:1,id:t.id,data:i};let{id:r,data:s}=t,o={...e,[r]:s};return Object.setPrototypeOf(o,ar.prototype),{data:o,actual:t,reverse:n}}else if(t.type===2){let{id:i}=t,n=e[i];if(n===void 0)return null;{let r={...e};return Object.setPrototypeOf(r,ar.prototype),delete r[i],{data:r,actual:t,reverse:{type:1,id:i,data:n}}}}return null}};function Hk(t){if(t.deepFreeze!==void 0){t.deepFreeze(t);return}let e=Object.getOwnPropertyNames(t);for(let i of e){let n=t[i];n&&typeof n=="object"&&Hk(n)}return Object.freeze(t)}function ANe(t,e){let i=0;for(;i<t.length&&i<e.length;){if(t[i]<e[i])return-1;if(t[i]>e[i])return 1;i+=1}return i!==e.length?-1:i!==t.length?1:0}var Vte=class extends Error{};function l3(t){let e={...t};return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),e}function md(t,e,i){if(t===void 0?e===void 0?(t=0,e=10):t=e-10:e===void 0&&(e=t+10),t>e){let s=t;t=e,e=s}let n=[],r=1/(i+1);for(let s=0;s<i;s++){let o=t+(e-t)*(s+.75+Math.random()*.5)*r;n.push(o)}return n}function Vk(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array}function MNe(){return typeof process<"u"}function jte(t,e){for(let i of t)e(i.id,i.data)!==!0&&jte(i.children,e)}function Wte(t,e){if(e(t.id,t.data)!==!0)for(let i of t.children)Wte(i,e)}var xo=class extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,xo.prototype)}deepFreeze(){let t=0;for(;t<this.length;)Hk(this[t]),t++}fillCaches0(t,e){this.objCaches.set(t.id,t),this.parentCaches.set(t.id,e);for(let i of t.children)this.fillCaches0(i,t.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let t of this)this.fillCaches0(t,null)}}randomId(){this.fillCaches();let t=Array.from(this.objCaches.keys());if(t.length!==0)return t[Math.max(0,Math.floor(Math.random()*t.length)-1)]}nonExistOrDescendantOf(t,e){if(!this.has(t))return!0;for(;t;){let i=this.parent(t);if(i===e)return!0;t=i}return!1}rootAcestor(t){for(;t;){let e=this.parent(t);if(e)t=e;else return t}return t}isDescendantOf(t,e){for(;t;){let i=this.parent(t);if(i===e)return!0;t=i}return!1}data(t){var e;return(e=this.get(t))==null?void 0:e.data}has(t){return this.childrenOf(t)!==void 0}get(t){return this.fillCaches(),this.objCaches.get(t)}childrenOf(t){var e;return t===null?this:(e=this.get(t))==null?void 0:e.children}traverseFrom(t,e){if(t===null)this.traverse(e);else{let i=this.get(t);i&&Wte(i,e)}}traverse(t){jte(this,t)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(t){return this.fillCaches(),this.parentCaches.get(t)}childrenArray(t){return t===null?this:this.get(t).children}modifyById(t,e){if(this.get(t)===void 0)throw new Error("not expected");{let i=this.parent(t),n=this.childrenArray(i),r=n.findIndex(o=>o.id===t);if(r<0)throw new Error("not expected");let s=n[r];return n=[...n],n[r]={...s,data:e},this.modifyArrayBy(i,n)}}modifyArrayBy(t,e){let i=t,n=e;for(;i!==null;){let s=n,o=i;if(i=this.parent(i),i===void 0)throw new Error;n=this.childrenArray(i);let a=n.findIndex(l=>l.id===o);if(a<0)throw new Error;n=[...n],n[a]={...n[a],children:s}}Object.setPrototypeOf(n,xo.prototype);let r=n;return r.fillCaches(),r}runOp(t){switch(t.type){case 7:return this.addOp(t);case 8:return this.deleteOp(t);case 9:return this.moveOp(t)}return null}checkDuplicatedIdRec({id:t,children:e}){if(this.get(t)!==void 0)return!0;for(let i of e)if(this.checkDuplicatedIdRec(i))return!0;return!1}addOp(t){let{parent:e,fi:i,id:n,data:r,children:s}=t;if(e!==null&&this.get(e)===void 0||this.checkDuplicatedIdRec(t))return null;{let o=e,a=this.childrenArray(o),l={fi:i,id:n,data:r,children:s};return a=[...a,l],a.sort((c,h)=>c.fi-h.fi),t.localIndex=a.indexOf(l),{data:this.modifyArrayBy(o,a),actual:t,reverse:{type:8,id:n}}}}deleteOp(t){let{id:e}=t;if(this.get(e)===null)return null;{let i=this.parent(e);if(i===void 0)return null;let n=this.childrenArray(i),r=n.findIndex(o=>o.id===e);t.localIndex=r,n=[...n];let s=n.splice(r,1)[0];return{data:this.modifyArrayBy(i,n),actual:t,reverse:{type:7,...s,parent:i}}}}moveOp(t){let{parent:e,fi:i,id:n}=t;if(e!==null&&this.get(e)===void 0)return this.deleteOp({type:8,id:n});if(e!==null){let u=e;for(;u!==null;){if(u===void 0)throw new Error;if(u===n)throw new Vte("cyclic tree");u=this.parent(u)}}let r=this.parent(n);if(r===void 0)return null;let s=r,o=this.childrenArray(r),a=o.findIndex(u=>u.id===n);o=[...o];let l=o.splice(a,1)[0],c=this.modifyArrayBy(r,o);r=e,o=c.childrenArray(r);let h=l.fi;return l={...l,fi:i},o=[...o,l],o.sort((u,d)=>u.fi-d.fi),t.localIndex=o.indexOf(l),c=c.modifyArrayBy(r,o),{data:c,actual:t,reverse:{type:9,parent:s,fi:h,id:n}}}previous(t,e){if(e===null){let n=this.childrenArray(t);return n.length===0?null:n[n.length-1].id}let i=null;for(let n of this.childrenArray(t)){if(n.id===e)return i;i=n.id}return null}traverseSortNext(t){let e=this.parent(t);if(e!==void 0){let i=this.childrenArray(e),n=i.findIndex(r=>r.id===t)+1;if(n<i.length)return i[n].id;if(e)return this.traverseSortNext(e)}}sortNext(t){let e=this.childrenArray(t);return e.length>0?e[0].id:this.traverseSortNext(t)}traverseSortPrevious(t){let e=this.childrenArray(t);return e.length>0?this.traverseSortPrevious(e[e.length-1].id):t}sortPrevious(t){let e=this.parent(t);if(e!==void 0){let i=this.childrenArray(e),n=i.findIndex(r=>r.id===t)-1;return n>=0?this.traverseSortPrevious(i[n].id):e}}getAllSorted(t){let e=[];for(let i of t){let n=this.getWithSortKey(i.id);n!==void 0&&e.push({...i,...n})}e.sort((i,n)=>ANe(i.sortKey,n.sortKey));for(let i of e)delete i.sortKey;return e}getWithSortKey(t){var e=t;let i=[],n=this.get(e),r=n;if(n!==void 0){for(;e;)i.splice(0,0,n.fi),e=this.parent(e),e!==null&&(n=this.get(e));return{...r,sortKey:i}}}insertBeforeHelper(t,e,i){return this.insertAfterHelper(t,this.previous(t,e),i)}insertAfterHelper(t,e,i){let n=this.childrenArray(t);if(e===null){if(n.length===0)return md(0,i,i);{let r=n[0].fi;return md(r-i,r,i)}}else{let r=this.get(e);if(r===void 0||this.parent(e)!==t)throw new Error("illegal args");let s=n.find(o=>o.fi>r.fi);if(s===void 0){let o=n[n.length-1].fi;return md(o,o+i,i)}else return md(r.fi,s.fi,i)}}},mT;(t=>{function e(i,n){if(n.type!==0)return null;if(Array.isArray(i)){let r=n.props,s={},o=[...i],a=!1;if(r)for(let l of Object.keys(r)){let c=parseInt(l);if(isNaN(c))throw new Error("wrong index");s[l]=o[c],o[c]=r[l],a=!0}return a?{data:o,actual:n,reverse:{type:0,props:s}}:null}else{let r=n.props,s={},o={...i},a=!1;if(r)for(let l of Object.keys(r)){s[l]=o[l];let c=r[l];c===void 0?delete o[l]:o[l]=c,a=!0}return a?{data:o,actual:n,reverse:{type:0,props:s}}:null}}t.runOp=e})(mT||(mT={}));var $t=class extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,$t.prototype)}deepFreeze(){let t=0;for(;t<this.length;)Hk(this[t]),t++}fillCaches0(t){this.objCaches.set(t.id,t)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let t of this)this.fillCaches0(t)}}randomId(){this.fillCaches();let t=Array.from(this.objCaches.keys());if(t.length!==0)return t[Math.max(0,Math.floor(Math.random()*t.length)-1)]}data(t){var e;return(e=this.get(t))==null?void 0:e.data}get(t){return this.fillCaches(),this.objCaches.get(t)}modifyById(t,e){if(this.get(t)===void 0)throw new Error("not expected");{let i=this,n=i.findIndex(s=>s.id===t);if(n<0)throw new Error("not expected");let r=i[n];return i=[...i],i[n]={...r,data:e},this.modifyArrayBy(i)}}modifyArrayBy(t){Object.setPrototypeOf(t,$t.prototype);let e=t;return MNe()||e.fillCaches(),e}runOp(t){switch(t.type){case 4:return this.addOp(t);case 5:return this.deleteOp(t);case 6:return this.moveOp(t)}return null}addOp(t){let{fi:e,id:i,data:n}=t,r=this,s={fi:e,id:i,data:n};return r=[...r,s],r.sort((o,a)=>o.fi-a.fi),t.localIndex=r.indexOf(s),{data:this.modifyArrayBy(r),actual:t,reverse:{type:5,id:i}}}deleteOp(t){let{id:e}=t,i=this,n=i.findIndex(s=>s.id===e);if(n===-1)return null;t.localIndex=n,i=[...i];let r=i.splice(n,1)[0];return{data:this.modifyArrayBy(i),actual:t,reverse:{type:4,...r}}}moveOp(t){let{fi:e,id:i}=t,n=this;n=[...n];let r=n.findIndex(a=>a.id===i);if(r===-1)return null;let s=n[r].fi,o={...n[r],fi:e};return n[r]=o,n.sort((a,l)=>a.fi-l.fi),t.localIndex=n.indexOf(o),{data:this.modifyArrayBy(n),actual:t,reverse:{type:6,fi:s,id:i}}}previous(t){if(t===null)return this.length===0?null:this[this.length-1].id;let e=null;for(let i of this){if(i.id===t)return e;e=i.id}return null}insertBeforeHelper(t,e){return this.insertAfterHelper(this.previous(t),e)}insertAfterHelper(t,e){let i=this;if(t===null){if(i.length===0)return md(0,e,e);{let n=i[0].fi;return md(n-e,n,e)}}else{let n=this.get(t);if(n===void 0)throw new Error("illegal args");let r=i.find(s=>s.fi>n.fi);if(r===void 0){let s=i[i.length-1].fi;return md(s,s+e,e)}else return md(n.fi,r.fi,e)}}};function G0(t){return t&&typeof t=="object"&&t instanceof es}var es=class{unusedFunOverridesTable(t){}runOp(t){let e=[],i=this,n=0,r={};for(;n<t.path.length;){if(e.push(i),i=i===void 0?void 0:i[t.path[n]],i!==void 0&&!G0(i))return null;n+=1}i=i?l3(i):new es;for(let[a,l]of Object.entries(t.props)){let c=i[a];r[a]=c,l===void 0?delete i[a]:i[a]=l}for(;n>0;){if(Object.keys(i).length===0){let a=e[n-1];a&&(i=l3(a),delete i[t.path[n-1]])}else{let a=e[n-1];if(a){let l=l3(a);l[t.path[n-1]]=i,i=l}else{let l=new es;l[t.path[n-1]]=i,i=l}}n-=1}let s=Object.setPrototypeOf(i,es.prototype),o={...t,props:r};return{data:s,actual:t,reverse:o}}},kd;(t=>{function e(r,s){return Y_(r,s)??r}t.apply=e;function i(r,s){return Wk(r,s)}t.merge=i;function n(r,s){let o=0,a=s.path,l=r;for(;o<a.length&&l!==void 0;){if(l=Hc.zoomOnce(l,a[o]),l===void 0)return s;if(!G0(l))return;o+=1}if(l===void 0)return s;if(G0(l))if(s.type===0){let c={...s.props};for(let h of Object.keys(l))delete c[h];return{...s,props:c}}else if(s.type===1||s.type===4||s.type===7){let c=jk([s],l);return c?(console.log(c),c):s}else return s}t.filterOp=n})(kd||(kd={}));function jk(t,e){if(e===void 0)return;let i=!1,n=t.map(r=>{let s=r.id,o=Y_(r.data,e[s]);if(i=i||o!==void 0,o===void 0&&(o=r.data),r.children){let a=jk(r.children,e);return a!==void 0?i=!0:a=r.children,{...r,id:s,data:o,children:a}}else return{...r,id:s,data:o}});if(i)return n}function ENe(t,e){if(e===void 0)return;let i=!1,n=t.map(r=>{let s=r.id,o=Y_(r.data,e[s]);return i=i||o!==void 0,o===void 0&&(o=r.data),{...r,id:s,data:o}});if(i)return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n}function Y_(t,e){if(!G0(e))return e;if(t instanceof xo){let i=jk(t,e);return i!==void 0&&Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i}else{if(t instanceof $t)return ENe(t,e);if(Array.isArray(t)){let i=!1,n=t.map((r,s)=>{let o=Y_(r,e[s]);return i=i||o!==void 0,o===void 0&&(o=r),o});return i?(Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n):void 0}else{if(t instanceof es)return Wk(t,e);if(t&&typeof t=="object"){let i={},n=!1;for(let[r,s]of Object.entries(t)){let o=Y_(s,e[r]);n=n||o!==void 0,o===void 0&&(o=s),i[r]=o}return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i):void 0}}}}function Wk(t,e){if(t===void 0)return e;if(e===void 0)return t;if(!G0(e))return e;if(!G0(t))return kd.apply(t,e);let i=new Set;for(let r of Object.keys(t))i.add(r);for(let r of Object.keys(e))i.add(r);let n=new es;for(let r of i){let s=Wk(t===void 0?void 0:t[r],e===void 0?void 0:e[r]);n[r]=s}return n}function TNe(t,e){let i={cur:[],result:[],len:0};return t=Q_(t,e,i)??t,[t,i.result]}function gT(t,e){return t===null?null:(t.cur[t.len]=e,t.len+=1,t)}function vT(t){t&&(t.len-=1)}function CNe(t){if(t===null)return null;t.result.push(t.cur.slice(0,t.len))}function Xte(t,e,i){let n=!1,r=t.map(s=>{let o=s.id,a=e[o];if(a!==void 0&&typeof a=="string"&&(n=!0,o=a,i!==null))throw new Error("not supported");let l=Q_(s.data,e,gT(i,o));vT(i),n=n||l!==void 0,l===void 0&&(l=s.data);let c=Xte(s.children,e,i);return c!==void 0?n=!0:c=s.children,{...s,id:o,data:l,children:c}});if(n)return r}function PNe(t,e,i){let n=!1,r=t.map(s=>{let o=s.id,a=e[o];if(a!==void 0&&typeof a=="string"&&(n=!0,o=a,i!==null))throw new Error("not supported");let l=Q_(s.data,e,gT(i,o));return vT(i),n=n||l!==void 0,l===void 0&&(l=s.data),{...s,id:o,data:l}});if(n)return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r}function Q_(t,e,i){if(t instanceof xo){let n=Xte(t,e,i);return n!==void 0&&Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n}else{if(t instanceof $t)return PNe(t,e,i);if(Array.isArray(t)){let n=!1,r=t.map((s,o)=>{let a=Q_(s,e,gT(i,o));return vT(i),n=n||a!==void 0,a===void 0&&(a=s),a});return n?(Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r):void 0}else if(t&&typeof t=="object"&&!Vk(t)){let n={},r=!1;for(let[s,o]of Object.entries(t))if(s!=="name"&&s!=="text"){let a=e[s];if(typeof a=="string"){if(i!==null)throw new Error("not supported");r=!0,s=a}let l=Q_(o,e,gT(i,s));vT(i),r=r||l!==void 0,l===void 0&&(l=o),n[s]=l}else n[s]=o;return r?(Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n):void 0}else if(typeof t=="string"){let n=e[t];if(n!==void 0){if(t.length!==36)throw new Error("for now you should only call this method when the key is a uuid");CNe(i)}return n}else return}}var tO;(t=>{function e(i,n){let r=Hc.zoom(n,i.path);if(typeof r=="object"){let s={};for(let o of Object.keys(i.props))s[o]=r[o];return{...i,props:s}}else return{...i,props:{}}}t.replaceProps=e})(tO||(tO={}));var Yo;(t=>{function e(l,c){return{...l,path:l.path.slice(c)}}t.drop=e;function i(l,c){var h;return((h=n(l,c))==null?void 0:h.data)??l}t.applySimple=i;function n(l,c){var d,f;let h=c.path;for(var u=[];;){let p;if(l instanceof es&&c.type===0&&(p=l.runOp({...c,path:h.slice(u.length)}),p===null&&(p=void 0)),p===void 0&&u.length===h.length&&(l instanceof xo||l instanceof $t||l instanceof ar?p=l.runOp(c):p=mT.runOp(l,c)),p!==void 0)if(p!==null){let g=p.data;for(let y=u.length-1;y>=0;y--){let x=h[y],b=u[y];if(b instanceof xo){if(typeof x=="number")throw new Error("illegal arg");g=b.modifyById(x,g)}else if(b instanceof $t){if(typeof x=="number")throw new Error("illegal arg");g=b.modifyById(x,g)}else if(b instanceof ar){if(typeof x=="number")throw new Error("illegal arg");g=b.modifyById(x,g)}else if(b instanceof es){let S={...b,[x]:g};g=Object.setPrototypeOf(S,es.prototype)}else if(typeof b=="object")if(Array.isArray(b)){if(typeof x=="string"&&(x=parseInt(x),isNaN(x)))throw new Error("Invalid path");let S=g;g=[...b],g[x]=S}else g={...b,[x]:g};else return null}return{data:g,actual:{...p.actual,path:h},reverse:{...p.reverse,path:h}}}else return null;let m=h[u.length],v;if(l instanceof xo){if(typeof m=="number")throw new Error("");v=(d=l.get(m))==null?void 0:d.data}else if(l instanceof $t){if(typeof m=="number")throw new Error("");v=(f=l.get(m))==null?void 0:f.data}else l!==null&&(v=l[m]);if(v!==void 0)u.push(l),l=v;else return null}}t.apply=n;function r(l,c){for(let h=0;h<l.length&&h<c.length;h++)if(l[h]!==c[h])return!0;return!1}t.pathDisjoint=r;function s(l,c){if(l.length!==c.length)return!1;for(let h=0;h<l.length;h++)if(l[h]!==c[h])return!1;return!0}t.pathEq=s;function o(l,c){return r(l.path,c.path)}t.commutative=o;function a(l,c){return l.type===0&&c.type===0&&s(l.path,c.path)?Object.keys(l.props).every(h=>c.props[h]!==void 0):!1}t.subsumed=a})(Yo||(Yo={}));var D8;(t=>{function e(){return[]}t.empty=e;function i(c,h){let u=[];for(let d of c){let[f,...p]=d.path;f===h&&u.push({...d,path:p})}return u}t.removePrefix=i;function n(c,h){return c.map(u=>({...u,path:[h,...u.path]}))}t.addPrefix=n;function r(c,h){return[...c,...h]}t.concat=r;function s(c,h){return[...c.filter(u=>!h.some(d=>Yo.subsumed(u,d))),...h]}t.compress=s;function o(c,h){return c.every(u=>h.every(d=>Yo.commutative(u,d)))}t.commutative=o;function a(c,h){for(let u of h){let d=l(c,u);d!==null&&(c=d.data)}return c}t.applyAll=a;function l(c,h){var u=c;let d=[],f=[];for(let p of h)try{if(p.type===3){let m=Hc.zoom(u,[...p.path,p.id]),v=Yo.apply(u,{...p,type:2});if(v!==null){u=v.data;let[g,y]=TNe(u,{[p.id]:m});u=g;for(let x of y){let b=x[x.length-1];x.splice(x.length-1,1),d.push({type:0,path:x,props:{[b]:m}}),f.push({type:0,path:x,props:{[b]:p.id}})}f.push(v.reverse),d.push(v.actual)}}else{let m=Yo.apply(u,p);m!==null&&(d.push(m.actual),u=m.data,f.push(m.reverse))}}catch(m){if(m instanceof Vte)return null;throw m}return{data:u,actual:d,reverse:f.reverse()}}t.apply=l})(D8||(D8={}));var qte=Symbol(),DNe=Symbol(),h2=Symbol(),Uw=class{reportOp(t,e,i=[]){let n=this;if(e===null)return;n._current=e.data;let r=i;for(;!(n instanceof Qte);){let s=n._path,o=n._current;if(s!==""&&r.splice(0,0,s),n=n._parent,n===null)return;n.update(s,o)}n.push(r,t,e.actual,e.reverse)}deleteChildren(t){if(this._children){let e=this._children[t];if(e){let i=e[h2];i&&i(),delete this._children[t]}}}},RNe=class extends Uw{constructor(t,e,i){super(),this._parent=t,this._path=e,this._current=i}update(t,e){if(Array.isArray(this._current)){if(typeof t=="string"&&(t=parseInt(t),isNaN(t)))throw new Error("Invalid path");this._current=[...this._current],this._current[t]=e}else this._current={...this._current,[t]:e}}runOp(t){this.reportOp(t,mT.runOp(this._current,t),t.path)}},INe=class extends Uw{constructor(t,e,i){super(),this._parent=t,this._path=e,this._current=i}update(t,e){this._current={...this._current,[t]:e},Object.setPrototypeOf(this._current,ar.prototype)}runOp(t){this.reportOp(t,this._current.runOp(t))}},Yte={get(t,e){if(e===h2)return()=>{t._parent=null};if(e===qte)return t._current;if(e===DNe)return t;let{_current:i,_children:n}=t;if(e==="push"&&Array.isArray(i))throw new Error("not supported to expand array");let r=n===void 0?void 0:n[e];if(r!==void 0)return r;let s=i[e],o=d2(t,e,s);return o!==s?(n===void 0&&(n={},t._children=n),n[e]=o,o):s},has(t,e){return e in t._current},ownKeys(t){return Reflect.ownKeys(t._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(t){return Object.getPrototypeOf(t._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(t,e){let i=t._current,n=Reflect.getOwnPropertyDescriptor(i,e);return n&&{writable:!0,configurable:!0,enumerable:n.enumerable,value:i[e]}}},LNe={...Yte,set(t,e,i){let n={type:0,props:{[e]:Hr(i)??i}};return t.deleteChildren(e),t.runOp(n),!0},deleteProperty(t,e){let i={type:0,props:{[e]:void 0}};return t.deleteChildren(e),t.runOp(i),!0}},BNe={...Yte,set(t,e,i){return i===void 0?this.deleteProperty(t,e):(t.deleteChildren(e),t.runOp({type:1,id:e,data:i})),!0},deleteProperty(t,e){return t.runOp({type:2,id:e}),!0}},Xk=class extends Uw{constructor(t,e,i){super(),this._children={},this._parent=t,this._path=e,this._current=i,this[h2]=()=>{this._parent=null}}unproxy(){return this._current}update(t,e){this._current=this._current.modifyById(t,e)}runOp(t){this.reportOp(t,this._current.runOp(t))}randomId(){return this._current.randomId()}isDescendantOf(t,e){return this._current.isDescendantOf(t,e)}childrenOf(t){return this._current.childrenOf(t)}traverse(t){return this._current.traverse(t)}get(t){return this._current.get(t)}parent(t){return this._current.parent(t)}traverse(t){this._current.traverse((e,i)=>{t(e,this.data(e))})}data(t){var o;let{_current:e,_children:i}=this,n=i===void 0?void 0:i[t];if(n!==void 0)return n;let r=(o=e.get(t))==null?void 0:o.data,s=d2(this,t,r);return s!==r?(i===void 0&&(i={},this._children=i),i[t]=s,s):r}add(t,e,i,n,r){this.runOp({type:7,parent:t,fi:e,id:i,data:n,children:r})}move(t,e,i){this.runOp({type:9,parent:t,fi:e,id:i})}insertAfter(t,e,i){let n=this._current.insertAfterHelper(t,e,i.length);for(let r=0;r<i.length;r++){let s=i[r];this.add(t,n[r],s.id,s.data,s.children)}}insertBefore(t,e,i){let n=this._current.insertBeforeHelper(t,e,i.length);for(let r=0;r<i.length;r++){let s=i[r];this.add(t,n[r],s.id,s.data,s.children)}}moveAfter(t,e,i){let n=this._current.insertAfterHelper(t,e,i.length);for(let r=0;r<i.length;r++){let s=i[r];this.move(t,n[r],s)}}moveBefore(t,e,i){let n=this._current.insertBeforeHelper(t,e,i.length);for(let r=0;r<i.length;r++){let s=i[r];this.move(t,n[r],s)}}delete(t){this.deleteChildren(t),this.runOp({type:8,id:t})}sortNext(t){return this._current.sortNext(t)}sortPrevious(t){return this._current.sortPrevious(t)}getAllSorted(t){return this._current.getAllSorted(t)}},qk=class extends Uw{constructor(t,e,i){super(),this._children={},this._parent=t,this._path=e,this._current=i,this[h2]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(t){let e=this.length;for(let i=0;i<e;i++){let n=this._current[i].id,r=this._current[i].fi;t(this.data(this._current[i].id),n,r)}}find(t){let e=this.length;for(let i=0;i<e;i++){let n=this._current[i].id;if(t(this.data(n),n))return this.get(n)}}update(t,e){this._current=this._current.modifyById(t,e)}randomId(){return this._current.randomId()}get(t){return{...this._current.get(t),data:this.data(t)}}data(t){var o;let{_current:e,_children:i}=this,n=i===void 0?void 0:i[t];if(n!==void 0)return n;let r=(o=e.get(t))==null?void 0:o.data,s=d2(this,t,r);return s!==r?(i===void 0&&(i={},this._children=i),i[t]=s,s):r}runOp(t){this.reportOp(t,this._current.runOp(t))}add(t,e,i){this.runOp({type:4,fi:t,id:e,data:i})}move(t,e){this.runOp({type:6,fi:t,id:e})}insertAfter(t,e){let i=this._current.insertAfterHelper(t,e.length);for(let n=0;n<e.length;n++){let r=e[n];this.add(i[n],r.id,r.data)}}insertBefore(t,e){let i=this._current.insertBeforeHelper(t,e.length);for(let n=0;n<e.length;n++){let r=e[n];this.add(i[n],r.id,r.data)}}moveAfter(t,e){let i=this._current.insertAfterHelper(t,e.length);for(let n=0;n<e.length;n++){let r=e[n];this.move(i[n],r)}}moveBefore(t,e){let i=this._current.insertBeforeHelper(t,e.length);for(let n=0;n<e.length;n++){let r=e[n];this.move(i[n],r)}}delete(t){this.deleteChildren(t),this.runOp({type:5,id:t})}};function c3(t,e,i){if(t.length>0){let n=t[t.length-1];if(n.type===0&&e.type===0&&Hc.equal(n.path,i)){Object.assign(n.props,e.props);return}}t.push({...e,path:i})}var Qte=class extends Uw{constructor(t){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=t}update(t,e){if(t!=="")throw new Error("");this._current=e}push(t,e,i,n){c3(this.ts,e,t),c3(this.actual,i,t),c3(this.reverse,n,t)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function d2(t,e,i){return i instanceof xo?new Xk(t,e,i):i instanceof $t?new qk(t,e,i):i instanceof ar?new Proxy(new INe(t,e,i),BNe):i!==null&&typeof i=="object"?Vk(i)?i:new Proxy(new RNe(t,e,i),LNe):i}function Kte(t){let e=new Qte(t);return[d2(e,"",t),e]}function yT(t,e){let[i,n]=Kte(t);return e(i),n.result()}function Hr(t){return t instanceof Xk||t instanceof qk?t._current:t!==null&&typeof t=="object"?t[qte]:t}var Hc;(t=>{function e(s,o){if(o.length===s.length)for(var a=0;a<s.length;){if(s[a]!==o[a])return!1;a+=1}else return!1;return!0}t.equal=e;function i(s,o,a){let l=r(a,s);if(l!==void 0&&typeof l=="object"&&l!==null){let c={...o};return Object.keys(l).forEach(h=>{delete c[h]}),c}else return o}t.removeOverridden=i;function n(s,o){if((s instanceof xo||s instanceof Xk)&&typeof o=="string"||(s instanceof $t||s instanceof qk)&&typeof o=="string")return s.data(o);if(typeof o=="number"&&Array.isArray(s)||typeof o=="string"&&typeof s=="object"&&s!==null)return s[o]}t.zoomOnce=n;function r(s,o,a=0){for(;a<o.length&&s!==void 0;)s=n(s,o[a]),a+=1;return s}t.zoom=r})(Hc||(Hc={}));function ONe(t,e){let i=[];if(e.length===t.length)for(var n=0;n<t.length;){if(e[n]==="*")i.push(t[n]);else if(t[n]!==e[n])return null;n+=1}else return null;return i}function Ga(t,e){let i=[];if(e.length<=t.length)for(var n=0;n<e.length;){if(e[n]==="*")i.push(t[n]);else if(t[n]!==e[n])return null;n+=1}else return null;return i}var Jte=class{},R8=class extends Jte{constructor(t){super(),this.id=t}},I8=class extends Jte{constructor(t){super(),this.data=t}},iO;try{iO=new TextDecoder}catch{}var gt,zd,Pe=0,so={},Di,gd,Ba=0,Cc=0,ko,nh,Ws=[],Fi,L8={useRecords:!1,mapsAsObjects:!0},Zte=class{},$te=new Zte;$te.name="MessagePack 0xC1";var H0=!1,xT=class{constructor(t){t&&(t.useRecords===!1&&t.mapsAsObjects===void 0&&(t.mapsAsObjects=!0),t.structures?t.structures.sharedLength=t.structures.length:t.getStructures&&((t.structures=[]).uninitialized=!0,t.structures.sharedLength=0)),Object.assign(this,t)}unpack(t,e){if(gt)return sie(()=>(rO(),this?this.unpack(t,e):xT.prototype.unpack.call(L8,t,e)));zd=e>-1?e:t.length,Pe=0,Cc=0,gd=null,ko=null,gt=t;try{Fi=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch(i){throw gt=null,t instanceof Uint8Array?i:new Error("Source must be a Uint8Array or Buffer but was a "+(t&&typeof t=="object"?t.constructor.name:typeof t))}if(this instanceof xT){if(so=this,this.structures)return Di=this.structures,DA();(!Di||Di.length>0)&&(Di=[])}else so=L8,(!Di||Di.length>0)&&(Di=[]);return DA()}unpackMultiple(t,e){let i,n=0;try{H0=!0;let r=t.length,s=this?this.unpack(t,r):p2.unpack(t,r);if(e){for(e(s);Pe<r;)if(n=Pe,e(DA())===!1)return}else{for(i=[s];Pe<r;)n=Pe,i.push(DA());return i}}catch(r){throw r.lastPosition=n,r.values=i,r}finally{H0=!1,rO()}}_mergeStructures(t,e){t=t||[];for(let i=0,n=t.length;i<n;i++){let r=t[i];r&&(r.isShared=!0,i>=32&&(r.highByte=i-32>>5))}t.sharedLength=t.length;for(let i in e||[])if(i>=0){let n=t[i],r=e[i];r&&(n&&((t.restoreStructures||(t.restoreStructures=[]))[i]=n),t[i]=r)}return this.structures=t}decode(t,e){return this.unpack(t,e)}};function DA(){try{if(!so.trusted&&!H0){let e=Di.sharedLength||0;e<Di.length&&(Di.length=e)}let t=Fn();if(Pe==zd)Di.restoreStructures&&B8(),Di=null,gt=null,nh&&(nh=null);else if(Pe>zd){let e=new Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}else if(!H0)throw new Error("Data read, but end of buffer not reached");return t}catch(t){throw Di.restoreStructures&&B8(),rO(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer"))&&(t.incomplete=!0),t}}function B8(){for(let t in Di.restoreStructures)Di[t]=Di.restoreStructures[t];Di.restoreStructures=null}function Fn(){let t=gt[Pe++];if(t<160)if(t<128){if(t<64)return t;{let e=Di[t&63]||so.getStructures&&eie()[t&63];return e?(e.read||(e.read=Yk(e,t&63)),e.read()):t}}else if(t<144)if(t-=128,so.mapsAsObjects){let e={};for(let i=0;i<t;i++)e[iie()]=Fn();return e}else{let e=new Map;for(let i=0;i<t;i++)e.set(Fn(),Fn());return e}else{t-=144;let e=new Array(t);for(let i=0;i<t;i++)e[i]=Fn();return e}else if(t<192){let e=t-160;if(Cc>=Pe)return gd.slice(Pe-Ba,(Pe+=e)-Ba);if(Cc==0&&zd<140){let i=e<16?Qk(e):tie(e);if(i!=null)return i}return nO(e)}else{let e;switch(t){case 192:return null;case 193:return ko?(e=Fn(),e>0?ko[1].slice(ko.position1,ko.position1+=e):ko[0].slice(ko.position0,ko.position0-=e)):$te;case 194:return!1;case 195:return!0;case 196:return u3(gt[Pe++]);case 197:return e=Fi.getUint16(Pe),Pe+=2,u3(e);case 198:return e=Fi.getUint32(Pe),Pe+=4,u3(e);case 199:return Hf(gt[Pe++]);case 200:return e=Fi.getUint16(Pe),Pe+=2,Hf(e);case 201:return e=Fi.getUint32(Pe),Pe+=4,Hf(e);case 202:if(e=Fi.getFloat32(Pe),so.useFloat32>2){let i=Kk[(gt[Pe]&127)<<1|gt[Pe+1]>>7];return Pe+=4,(i*e+(e>0?.5:-.5)>>0)/i}return Pe+=4,e;case 203:return e=Fi.getFloat64(Pe),Pe+=8,e;case 204:return gt[Pe++];case 205:return e=Fi.getUint16(Pe),Pe+=2,e;case 206:return e=Fi.getUint32(Pe),Pe+=4,e;case 207:return so.int64AsNumber?(e=Fi.getUint32(Pe)*4294967296,e+=Fi.getUint32(Pe+4)):e=Fi.getBigUint64(Pe),Pe+=8,e;case 208:return Fi.getInt8(Pe++);case 209:return e=Fi.getInt16(Pe),Pe+=2,e;case 210:return e=Fi.getInt32(Pe),Pe+=4,e;case 211:return so.int64AsNumber?(e=Fi.getInt32(Pe)*4294967296,e+=Fi.getUint32(Pe+4)):e=Fi.getBigInt64(Pe),Pe+=8,e;case 212:if(e=gt[Pe++],e==114)return k8(gt[Pe++]&63);{let i=Ws[e];if(i)return i.read?(Pe++,i.read(Fn())):i.noBuffer?(Pe++,i()):i(gt.subarray(Pe,++Pe));throw new Error("Unknown extension "+e)}case 213:return e=gt[Pe],e==114?(Pe++,k8(gt[Pe++]&63,gt[Pe++])):Hf(2);case 214:return Hf(4);case 215:return Hf(8);case 216:return Hf(16);case 217:return e=gt[Pe++],Cc>=Pe?gd.slice(Pe-Ba,(Pe+=e)-Ba):NNe(e);case 218:return e=Fi.getUint16(Pe),Pe+=2,Cc>=Pe?gd.slice(Pe-Ba,(Pe+=e)-Ba):UNe(e);case 219:return e=Fi.getUint32(Pe),Pe+=4,Cc>=Pe?gd.slice(Pe-Ba,(Pe+=e)-Ba):kNe(e);case 220:return e=Fi.getUint16(Pe),Pe+=2,F8(e);case 221:return e=Fi.getUint32(Pe),Pe+=4,F8(e);case 222:return e=Fi.getUint16(Pe),Pe+=2,N8(e);case 223:return e=Fi.getUint32(Pe),Pe+=4,N8(e);default:if(t>=224)return t-256;if(t===void 0){let i=new Error("Unexpected end of MessagePack data");throw i.incomplete=!0,i}throw new Error("Unknown MessagePack token "+t)}}}var FNe=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function Yk(t,e){function i(){if(i.count++>2){let r=t.read=new Function("r","return function(){return {"+t.map(s=>FNe.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"}}")(Fn);return t.highByte===0&&(t.read=O8(e,t.read)),r()}let n={};for(let r=0,s=t.length;r<s;r++){let o=t[r];n[o]=Fn()}return n}return i.count=0,t.highByte===0?O8(e,i):i}var O8=(t,e)=>function(){let i=gt[Pe++];if(i===0)return e();let n=t<32?-(t+(i<<5)):t+(i<<5),r=Di[n]||eie()[n];if(!r)throw new Error("Record id is not defined for "+n);return r.read||(r.read=Yk(r,t)),r.read()};function eie(){let t=sie(()=>(gt=null,so.getStructures()));return Di=so._mergeStructures(t,Di)}var nO=f2,NNe=f2,UNe=f2,kNe=f2;function f2(t){let e;if(t<16&&(e=Qk(t)))return e;if(t>64&&iO)return iO.decode(gt.subarray(Pe,Pe+=t));let i=Pe+t,n=[];for(e="";Pe<i;){let r=gt[Pe++];if(!(r&128))n.push(r);else if((r&224)===192){let s=gt[Pe++]&63;n.push((r&31)<<6|s)}else if((r&240)===224){let s=gt[Pe++]&63,o=gt[Pe++]&63;n.push((r&31)<<12|s<<6|o)}else if((r&248)===240){let s=gt[Pe++]&63,o=gt[Pe++]&63,a=gt[Pe++]&63,l=(r&7)<<18|s<<12|o<<6|a;l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|l&1023),n.push(l)}else n.push(r);n.length>=4096&&(e+=Br.apply(String,n),n.length=0)}return n.length>0&&(e+=Br.apply(String,n)),e}function F8(t){let e=new Array(t);for(let i=0;i<t;i++)e[i]=Fn();return e}function N8(t){if(so.mapsAsObjects){let e={};for(let i=0;i<t;i++)e[iie()]=Fn();return e}else{let e=new Map;for(let i=0;i<t;i++)e.set(Fn(),Fn());return e}}var Br=String.fromCharCode;function tie(t){let e=Pe,i=new Array(t);for(let n=0;n<t;n++){let r=gt[Pe++];if((r&128)>0){Pe=e;return}i[n]=r}return Br.apply(String,i)}function Qk(t){if(t<4)if(t<2){if(t===0)return"";{let e=gt[Pe++];if((e&128)>1){Pe-=1;return}return Br(e)}}else{let e=gt[Pe++],i=gt[Pe++];if((e&128)>0||(i&128)>0){Pe-=2;return}if(t<3)return Br(e,i);let n=gt[Pe++];if((n&128)>0){Pe-=3;return}return Br(e,i,n)}else{let e=gt[Pe++],i=gt[Pe++],n=gt[Pe++],r=gt[Pe++];if((e&128)>0||(i&128)>0||(n&128)>0||(r&128)>0){Pe-=4;return}if(t<6){if(t===4)return Br(e,i,n,r);{let s=gt[Pe++];if((s&128)>0){Pe-=5;return}return Br(e,i,n,r,s)}}else if(t<8){let s=gt[Pe++],o=gt[Pe++];if((s&128)>0||(o&128)>0){Pe-=6;return}if(t<7)return Br(e,i,n,r,s,o);let a=gt[Pe++];if((a&128)>0){Pe-=7;return}return Br(e,i,n,r,s,o,a)}else{let s=gt[Pe++],o=gt[Pe++],a=gt[Pe++],l=gt[Pe++];if((s&128)>0||(o&128)>0||(a&128)>0||(l&128)>0){Pe-=8;return}if(t<10){if(t===8)return Br(e,i,n,r,s,o,a,l);{let c=gt[Pe++];if((c&128)>0){Pe-=9;return}return Br(e,i,n,r,s,o,a,l,c)}}else if(t<12){let c=gt[Pe++],h=gt[Pe++];if((c&128)>0||(h&128)>0){Pe-=10;return}if(t<11)return Br(e,i,n,r,s,o,a,l,c,h);let u=gt[Pe++];if((u&128)>0){Pe-=11;return}return Br(e,i,n,r,s,o,a,l,c,h,u)}else{let c=gt[Pe++],h=gt[Pe++],u=gt[Pe++],d=gt[Pe++];if((c&128)>0||(h&128)>0||(u&128)>0||(d&128)>0){Pe-=12;return}if(t<14){if(t===12)return Br(e,i,n,r,s,o,a,l,c,h,u,d);{let f=gt[Pe++];if((f&128)>0){Pe-=13;return}return Br(e,i,n,r,s,o,a,l,c,h,u,d,f)}}else{let f=gt[Pe++],p=gt[Pe++];if((f&128)>0||(p&128)>0){Pe-=14;return}if(t<15)return Br(e,i,n,r,s,o,a,l,c,h,u,d,f,p);let m=gt[Pe++];if((m&128)>0){Pe-=15;return}return Br(e,i,n,r,s,o,a,l,c,h,u,d,f,p,m)}}}}}function u3(t){return so.copyBuffers?Uint8Array.prototype.slice.call(gt,Pe,Pe+=t):gt.subarray(Pe,Pe+=t)}function Hf(t){let e=gt[Pe++];if(Ws[e])return Ws[e](gt.subarray(Pe,Pe+=t));throw new Error("Unknown extension type "+e)}var U8=new Array(4096);function iie(){let t=gt[Pe++];if(t>=160&&t<192){if(t=t-160,Cc>=Pe)return gd.slice(Pe-Ba,(Pe+=t)-Ba);if(!(Cc==0&&zd<180))return nO(t)}else return Pe--,Fn();let e=(t<<5^(t>1?Fi.getUint16(Pe):t>0?gt[Pe]:0))&4095,i=U8[e],n=Pe,r=Pe+t-3,s,o=0;if(i&&i.bytes==t){for(;n<r;){if(s=Fi.getUint32(n),s!=i[o++]){n=1879048192;break}n+=4}for(r+=3;n<r;)if(s=gt[n++],s!=i[o++]){n=1879048192;break}if(n===r)return Pe=n,i.string;r-=3,n=Pe}for(i=[],U8[e]=i,i.bytes=t;n<r;)s=Fi.getUint32(n),i.push(s),n+=4;for(r+=3;n<r;)s=gt[n++],i.push(s);let a=t<16?Qk(t):tie(t);return a!=null?i.string=a:i.string=nO(t)}var k8=(t,e)=>{var i=Fn();let n=t;e!==void 0&&(t=t<32?-((e<<5)+t):(e<<5)+t,i.highByte=e);let r=Di[t];return r&&r.isShared&&((Di.restoreStructures||(Di.restoreStructures=[]))[t]=r),Di[t]=i,i.read=Yk(i,n),i.read()},nie=typeof self=="object"?self:global;Ws[0]=()=>{};Ws[0].noBuffer=!0;Ws[101]=()=>{let t=Fn();return(nie[t[0]]||Error)(t[1])};Ws[105]=t=>{let e=Fi.getUint32(Pe-4);nh||(nh=new Map);let i=gt[Pe],n;i>=144&&i<160||i==220||i==221?n=[]:n={};let r={target:n};nh.set(e,r);let s=Fn();return r.used?Object.assign(n,s):(r.target=s,s)};Ws[112]=t=>{let e=Fi.getUint32(Pe-4),i=nh.get(e);return i.used=!0,i.target};Ws[115]=()=>new Set(Fn());var rie=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(t=>t+"Array");Ws[116]=t=>{let e=t[0],i=rie[e];if(!i)throw new Error("Could not find typed array for code "+e);return new nie[i](Uint8Array.prototype.slice.call(t,1).buffer)};Ws[120]=()=>{let t=Fn();return new RegExp(t[0],t[1])};Ws[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],i=Pe;Pe+=e-4,ko=[Fn(),Fn()],ko.position0=0,ko.position1=0;let n=Pe;Pe=i;try{return Fn()}finally{Pe=n}};Ws[255]=t=>t.length==4?new Date((t[0]*16777216+(t[1]<<16)+(t[2]<<8)+t[3])*1e3):t.length==8?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+((t[3]&3)*4294967296+t[4]*16777216+(t[5]<<16)+(t[6]<<8)+t[7])*1e3):t.length==12?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+((t[4]&128?-281474976710656:0)+t[6]*1099511627776+t[7]*4294967296+t[8]*16777216+(t[9]<<16)+(t[10]<<8)+t[11])*1e3):new Date("invalid");function sie(t){let e=zd,i=Pe,n=Ba,r=Cc,s=gd,o=nh,a=ko,l=new Uint8Array(gt.slice(0,zd)),c=Di,h=Di.slice(0,Di.length),u=so,d=H0,f=t();return zd=e,Pe=i,Ba=n,Cc=r,gd=s,nh=o,ko=a,gt=l,H0=d,Di=c,Di.splice(0,Di.length,...h),so=u,Fi=new DataView(gt.buffer,gt.byteOffset,gt.byteLength),f}function rO(){gt=null,nh=null,Di=null}function zNe(t){t.unpack?Ws[t.type]=t.unpack:Ws[t.type]=t}var Kk=new Array(147);for(let t=0;t<256;t++)Kk[t]=+("1e"+Math.floor(45.15-t*.30103));var p2=new xT({useRecords:!1});p2.unpack;p2.unpackMultiple;p2.unpack;var GNe=new Float32Array(1);new Uint8Array(GNe.buffer,0,4);var qM;try{qM=new TextEncoder}catch{}var _T,Jk,m2=typeof Buffer<"u",h3=m2?Buffer.allocUnsafeSlow:Uint8Array,oie=m2?Buffer:Uint8Array,z8=m2?4294967296:2144337920,Ke,Wn,ze=0,sc,oc=null,HNe=/[\u0080-\uFFFF]/,Tx=Symbol("record-id"),aie=class extends xT{constructor(t){super(t),this.offset=0;let e,i,n,r,s,o=0,a=oie.prototype.utf8Write?function(A,E,M){return Ke.utf8Write(A,E,M)}:qM&&qM.encodeInto?function(A,E){return qM.encodeInto(A,Ke.subarray(E)).written}:!1,l=this;t||(t={});let c=t&&t.sequential,h=t.structures||t.saveStructures,u=t.maxSharedStructures;if(u==null&&(u=h?32:0),u>8160)throw new Error("Maximum maxSharedStructure is 8160");let d=t.maxOwnStructures;d==null&&(d=h?32:64),c&&!t.saveStructures&&(this.structures=[]);let f=u>32||d+u>64,p=u+64,m=u+d+64;if(m>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let v=[],g=0,y=0;this.pack=this.encode=function(A,E){if(Ke||(Ke=new h3(8192),Wn=new DataView(Ke.buffer,0,8192),ze=0),sc=Ke.length-10,sc-ze<2048?(Ke=new h3(Ke.length),Wn=new DataView(Ke.buffer,0,Ke.length),sc=Ke.length-10,ze=0):ze=ze+7&2147483640,e=ze,s=l.structuredClone?new Map:null,l.bundleStrings?(oc=["",""],Ke[ze++]=214,Ke[ze++]=98,oc.position=ze-e,ze+=4):oc=null,i=l.structures,i){i.uninitialized&&(i=l._mergeStructures(l.getStructures()));let M=i.sharedLength||0;if(M>u)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+i.sharedLength);if(!i.transitions){i.transitions=Object.create(null);for(let T=0;T<M;T++){let P=i[T];if(!P)continue;let R,U=i.transitions;for(let F=0,N=P.length;F<N;F++){let W=P[F];R=U[W],R||(R=U[W]=Object.create(null)),U=R}U[Tx]=T+64}o=M}c||(i.nextId=M+64)}n&&(n=!1),r=i||[];try{if(x(A),oc){Wn.setUint32(oc.position+e,ze-oc.position-e);let M=oc;oc=null,x(M[0]),x(M[1])}if(l.offset=ze,s&&s.idsToInsert){ze+=s.idsToInsert.length*6,ze>sc&&S(ze),l.offset=ze;let M=jNe(Ke.subarray(e,ze),s.idsToInsert);return s=null,M}return E&WNe?(Ke.start=e,Ke.end=ze,Ke):Ke.subarray(e,ze)}finally{if(i){if(y<10&&y++,g>1e4)i.transitions=null,y=0,g=0,v.length>0&&(v=[]);else if(v.length>0&&!c){for(let M=0,T=v.length;M<T;M++)v[M][Tx]=0;v=[]}if(n&&l.saveStructures){let M=i.sharedLength||u;i.length>M&&(i=i.slice(0,M));let T=Ke.subarray(e,ze);return l.saveStructures(i,o)===!1?(l._mergeStructures(l.getStructures()),l.pack(A)):(o=M,T)}}E&XNe&&(ze=e)}};let x=A=>{ze>sc&&(Ke=S(ze));var E=typeof A,M;if(E==="string"){let T=A.length;if(oc&&T>=8&&T<4096){let U=HNe.test(A);oc[U?0:1]+=A,Ke[ze++]=193,x(U?-T:T);return}let P;T<32?P=1:T<256?P=2:T<65536?P=3:P=5;let R=T*3;if(ze+R>sc&&(Ke=S(ze+R)),T<64||!a){let U,F,N,W=ze+P;for(U=0;U<T;U++)F=A.charCodeAt(U),F<128?Ke[W++]=F:F<2048?(Ke[W++]=F>>6|192,Ke[W++]=F&63|128):(F&64512)===55296&&((N=A.charCodeAt(U+1))&64512)===56320?(F=65536+((F&1023)<<10)+(N&1023),U++,Ke[W++]=F>>18|240,Ke[W++]=F>>12&63|128,Ke[W++]=F>>6&63|128,Ke[W++]=F&63|128):(Ke[W++]=F>>12|224,Ke[W++]=F>>6&63|128,Ke[W++]=F&63|128);M=W-ze-P}else M=a(A,ze+P,R);M<32?Ke[ze++]=160|M:M<256?(P<2&&Ke.copyWithin(ze+2,ze+1,ze+1+M),Ke[ze++]=217,Ke[ze++]=M):M<65536?(P<3&&Ke.copyWithin(ze+3,ze+2,ze+2+M),Ke[ze++]=218,Ke[ze++]=M>>8,Ke[ze++]=M&255):(P<5&&Ke.copyWithin(ze+5,ze+3,ze+3+M),Ke[ze++]=219,Wn.setUint32(ze,M),ze+=4),ze+=M}else if(E==="number")if(A>>>0===A)A<64?Ke[ze++]=A:A<256?(Ke[ze++]=204,Ke[ze++]=A):A<65536?(Ke[ze++]=205,Ke[ze++]=A>>8,Ke[ze++]=A&255):(Ke[ze++]=206,Wn.setUint32(ze,A),ze+=4);else if(A>>0===A)A>=-32?Ke[ze++]=256+A:A>=-128?(Ke[ze++]=208,Ke[ze++]=A+256):A>=-32768?(Ke[ze++]=209,Wn.setInt16(ze,A),ze+=2):(Ke[ze++]=210,Wn.setInt32(ze,A),ze+=4);else{let T;if((T=this.useFloat32)>0&&A<4294967296&&A>=-2147483648){Ke[ze++]=202,Wn.setFloat32(ze,A);let P;if(T<4||(P=A*Kk[(Ke[ze]&127)<<1|Ke[ze+1]>>7])>>0===P){ze+=4;return}else ze--}Ke[ze++]=203,Wn.setFloat64(ze,A),ze+=8}else if(E==="object")if(!A)Ke[ze++]=192;else{if(s){let P=s.get(A);if(P){if(!P.id){let R=s.idsToInsert||(s.idsToInsert=[]);P.id=R.push(P)}Ke[ze++]=214,Ke[ze++]=112,Wn.setUint32(ze,P.id),ze+=4;return}else s.set(A,{offset:ze-e})}let T=A.constructor;if(T===Object)b(A,!0);else if(T===Array){M=A.length,M<16?Ke[ze++]=144|M:M<65536?(Ke[ze++]=220,Ke[ze++]=M>>8,Ke[ze++]=M&255):(Ke[ze++]=221,Wn.setUint32(ze,M),ze+=4);for(let P=0;P<M;P++)x(A[P])}else if(T===Map){M=A.size,M<16?Ke[ze++]=128|M:M<65536?(Ke[ze++]=222,Ke[ze++]=M>>8,Ke[ze++]=M&255):(Ke[ze++]=223,Wn.setUint32(ze,M),ze+=4);for(let[P,R]of A)x(P),x(R)}else{for(let P=0,R=_T.length;P<R;P++){let U=Jk[P];if(A instanceof U){let F=_T[P];if(F.write){F.type&&(Ke[ze++]=212,Ke[ze++]=F.type,Ke[ze++]=0),x(F.write.call(this,A));return}let N=Ke,W=Wn,Q=ze;Ke=null;let X;try{X=F.pack.call(this,A,B=>(Ke=N,N=null,ze+=B,ze>sc&&S(ze),{target:Ke,targetView:Wn,position:ze-B}),x)}finally{N&&(Ke=N,Wn=W,ze=Q,sc=Ke.length-10)}X&&(X.length+ze>sc&&S(X.length+ze),ze=VNe(X,Ke,ze,F.type));return}}b(A,!A.hasOwnProperty)}}else if(E==="boolean")Ke[ze++]=A?195:194;else if(E==="bigint"){if(A<BigInt(1)<<BigInt(63)&&A>=-(BigInt(1)<<BigInt(63)))Ke[ze++]=211,Wn.setBigInt64(ze,A);else if(A<BigInt(1)<<BigInt(64)&&A>0)Ke[ze++]=207,Wn.setBigUint64(ze,A);else if(this.largeBigIntToFloat)Ke[ze++]=203,Wn.setFloat64(ze,Number(A));else throw new RangeError(A+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");ze+=8}else if(E==="undefined")this.encodeUndefinedAsNil?Ke[ze++]=192:(Ke[ze++]=212,Ke[ze++]=0,Ke[ze++]=0);else if(E==="function")x(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+E)},b=this.useRecords===!1?this.variableMapSize?A=>{let E=Object.keys(A),M=E.length;M<16?Ke[ze++]=128|M:M<65536?(Ke[ze++]=222,Ke[ze++]=M>>8,Ke[ze++]=M&255):(Ke[ze++]=223,Wn.setUint32(ze,M),ze+=4);let T;for(let P=0;P<M;P++)x(T=E[P]),x(A[T])}:(A,E)=>{Ke[ze++]=222;let M=ze-e;ze+=2;let T=0;for(let P in A)(E||A.hasOwnProperty(P))&&(x(P),x(A[P]),T++);Ke[M+++e]=T>>8,Ke[M+e]=T&255}:A=>{let E=Object.keys(A),M,T=r.transitions||(r.transitions=Object.create(null)),P=0;for(let U=0,F=E.length;U<F;U++){let N=E[U];M=T[N],M||(M=T[N]=Object.create(null),P++),T=M}let R=T[Tx];if(R)R>=96&&f?(Ke[ze++]=((R-=96)&31)+96,Ke[ze++]=R>>5):Ke[ze++]=R;else{R=r.nextId,R||(R=64),R<p&&this.shouldShareStructure&&!this.shouldShareStructure(E)?(R=r.nextOwnId,R<m||(R=p),r.nextOwnId=R+1):(R>=m&&(R=p),r.nextId=R+1);let U=E.highByte=R>=96&&f?R-96>>5:-1;T[Tx]=R,r[R-64]=E,R<p?(E.isShared=!0,r.sharedLength=R-63,n=!0,U>=0?(Ke[ze++]=(R&31)+96,Ke[ze++]=U):Ke[ze++]=R):(U>=0?(Ke[ze++]=213,Ke[ze++]=114,Ke[ze++]=(R&31)+96,Ke[ze++]=U):(Ke[ze++]=212,Ke[ze++]=114,Ke[ze++]=R),P&&(g+=y*P),v.length>=d&&(v.shift()[Tx]=0),v.push(T),x(E))}for(let U=0,F=E.length;U<F;U++)x(A[E[U]])},S=A=>{let E;if(A>16777216){if(A-e>z8)throw new Error("Packed buffer would be larger than maximum buffer size");E=Math.min(z8,Math.round(Math.max((A-e)*(A>67108864?1.25:2),4194304)/4096)*4096)}else E=(Math.max(A-e<<2,Ke.length-1)>>12)+1<<12;let M=new h3(E);return Wn=new DataView(M.buffer,0,E),Ke.copy?Ke.copy(M,0,e,A):M.set(Ke.slice(e,A)),ze-=e,e=0,sc=M.length-10,Ke=M}}useBuffer(t){Ke=t,Wn=new DataView(Ke.buffer,Ke.byteOffset,Ke.byteLength),ze=0}};Jk=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,Zte];_T=[{pack(t,e,i){let n=t.getTime()/1e3;if((this.useTimestamp32||t.getMilliseconds()===0)&&n>=0&&n<4294967296){let{target:r,targetView:s,position:o}=e(6);r[o++]=214,r[o++]=255,s.setUint32(o,n)}else if(n>0&&n<17179869184){let{target:r,targetView:s,position:o}=e(10);r[o++]=215,r[o++]=255,s.setUint32(o,t.getMilliseconds()*4e6+(n/1e3/4294967296>>0)),s.setUint32(o+4,n)}else if(isNaN(n)){if(this.onInvalidDate)return e(0),i(this.onInvalidDate());let{target:r,targetView:s,position:o}=e(3);r[o++]=212,r[o++]=255,r[o++]=255}else{let{target:r,targetView:s,position:o}=e(15);r[o++]=199,r[o++]=12,r[o++]=255,s.setUint32(o,t.getMilliseconds()*1e6),s.setBigInt64(o+4,BigInt(Math.floor(n)))}}},{pack(t,e,i){let n=Array.from(t),{target:r,position:s}=e(this.structuredClone?3:0);this.structuredClone&&(r[s++]=212,r[s++]=115,r[s++]=0),i(n)}},{pack(t,e,i){let{target:n,position:r}=e(this.structuredClone?3:0);this.structuredClone&&(n[r++]=212,n[r++]=101,n[r++]=0),i([t.name,t.message])}},{pack(t,e,i){let{target:n,position:r}=e(this.structuredClone?3:0);this.structuredClone&&(n[r++]=212,n[r++]=120,n[r++]=0),i([t.source,t.flags])}},{pack(t,e){this.structuredClone?G8(t,16,e):H8(m2?Buffer.from(t):new Uint8Array(t),e)}},{pack(t,e){let i=t.constructor;i!==oie&&this.structuredClone?G8(t,rie.indexOf(i.name),e):H8(t,e)}},{pack(t,e){let{target:i,position:n}=e(1);i[n]=193}}];function G8(t,e,i,n){let r=t.byteLength;if(r+1<256){var{target:s,position:o}=i(4+r);s[o++]=199,s[o++]=r+1}else if(r+1<65536){var{target:s,position:o}=i(5+r);s[o++]=200,s[o++]=r+1>>8,s[o++]=r+1&255}else{var{target:s,position:o,targetView:a}=i(7+r);s[o++]=201,a.setUint32(o,r+1),o+=4}s[o++]=116,s[o++]=e,s.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),o)}function H8(t,e){let i=t.byteLength;var n,r;if(i<256){var{target:n,position:r}=e(i+2);n[r++]=196,n[r++]=i}else if(i<65536){var{target:n,position:r}=e(i+3);n[r++]=197,n[r++]=i>>8,n[r++]=i&255}else{var{target:n,position:r,targetView:s}=e(i+5);n[r++]=198,s.setUint32(r,i),r+=4}n.set(t,r)}function VNe(t,e,i,n){let r=t.length;switch(r){case 1:e[i++]=212;break;case 2:e[i++]=213;break;case 4:e[i++]=214;break;case 8:e[i++]=215;break;case 16:e[i++]=216;break;default:r<256?(e[i++]=199,e[i++]=r):r<65536?(e[i++]=200,e[i++]=r>>8,e[i++]=r&255):(e[i++]=201,e[i++]=r>>24,e[i++]=r>>16&255,e[i++]=r>>8&255,e[i++]=r&255)}return e[i++]=n,e.set(t,i),i+=r,i}function jNe(t,e){let i,n=e.length*6,r=t.length-n;for(e.sort((s,o)=>s.offset>o.offset?1:-1);i=e.pop();){let s=i.offset,o=i.id;t.copyWithin(s+n,s,r),n-=6;let a=s+n;t[a++]=214,t[a++]=105,t[a++]=o>>24,t[a++]=o>>16&255,t[a++]=o>>8&255,t[a++]=o&255,r=s}return t}function xy(t){if(t.Class){if(!t.pack&&!t.write)throw new Error("Extension has no pack or write function");if(t.pack&&!t.type)throw new Error("Extension has no type (numeric code to identify the extension)");Jk.unshift(t.Class),_T.unshift(t)}zNe(t)}var lie=new aie({useRecords:!1});lie.pack;lie.pack;var WNe=512,XNe=1024,V8=new aie({structuredClone:!0});xy({Class:ar.prototype.constructor,type:1,write(t){return{...t}},read(t){return Object.setPrototypeOf(t,ar.prototype),t}});xy({Class:$t.prototype.constructor,type:2,write(t){return[...t]},read(t){return Object.setPrototypeOf(t,$t.prototype),t}});xy({Class:xo.prototype.constructor,type:3,write(t){return[...t]},read(t){return Object.setPrototypeOf(t,xo.prototype),t}});xy({Class:R8.prototype.constructor,type:4,write(t){return t.id},read(t){return new R8(t)}});xy({Class:I8.prototype.constructor,type:5,write(t){return t.data},read(t){return new I8(t)}});xy({Class:es.prototype.constructor,type:6,write(t){return{...t}},read(t){return Object.setPrototypeOf(t,es.prototype),t}});function qNe(t){var e=0;if(t.length===0)return e;for(let i=0;i<t.length;i++){let n=t[i];e=(e<<5)-e+n,e=e&e}return e}function sO(t){if(Vk(t))return t;if(Array.isArray(t))return t.map(sO);if(typeof t=="object"&&t!==null){let e={};for(let i of Object.keys(t).sort())e[i]=sO(t[i]);return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),e}else return t}var oO;(t=>{function e(r){return V8.pack(r)}t.serialize=e;function i(r){return V8.unpack(r)}t.deserialize=i;function n(r){return qNe(e(sO(r))).toString()}t.checksum=n})(oO||(oO={}));var ac={LookAt:[],Follow:["Create"],DragDrop:["Transition","Animation","Audio","Create"],MouseHover:["Transition","Animation","Create","Destroy","SwitchCamera","SceneTransition"],Scroll:["Transition","Animation","Create"],Start:["Transition","Animation","Audio","Video","Create","Destroy","SwitchCamera","SceneTransition"],Conditional:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],MouseDown:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],MouseUp:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],MousePress:["Transition","Animation","Audio","Video","Link","Create","SwitchCamera","SceneTransition","Reset"],KeyDown:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],KeyUp:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],KeyPress:["Transition","Animation","Audio","Video","Link","Create","SwitchCamera","Reset"],GameControl:["Transition","Animation","Audio","Video","Create"],Collision:["Transition","Animation","Audio","Video","Create","Destroy","Reset"],Trigger:["Transition","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"]},j8;(t=>{function e(n){return n.type==="MouseDown"||n.type==="MouseUp"||n.type==="MousePress"||n.type==="KeyDown"||n.type==="KeyUp"||n.type==="KeyPress"}t.is=e;function i(n){return n==="MouseDown"||n==="MouseUp"||n==="MousePress"?{type:n,mode:"Object",disabled:!1,toggle:!1,actions:new $t}:{type:n,disabled:!1,key:void 0,toggle:!1,actions:new $t}}t.defaultData=i})(j8||(j8={}));var wT;(t=>{function e(i){return{type:"Property",value:[i??null,"position","x"]}}t.propertyDefaultData=e,t.valueDefaultData={type:"Literal",value:0}})(wT||(wT={}));var aO;(t=>{function e(r){return{type:"Comparison",operator:"==",lOperand:wT.propertyDefaultData(r),rOperand:{...wT.valueDefaultData}}}t.comparisonDefaultData=e;function i(r){return{type:"Distance",toObject:r??null,fromObject:r??null,distance:200}}t.distanceDefaultData=i;function n(r,s){return{type:"State",object:r??null,state:s??null}}t.stateDefaultData=n})(aO||(aO={}));var W8;(t=>{function e(n){return n.type==="Conditional"}t.is=e;function i(n){return{type:"Conditional",disabled:!1,inActions:new $t,outActions:new $t,condition:aO.distanceDefaultData(n)}}t.defaultData=i})(W8||(W8={}));var X8;(t=>t.defaultData={type:"DragDrop",cursor:"hand",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",limits:[-1/0,1/0,-1/0,1/0,-1/0,1/0],drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new $t,drop:new $t}})(X8||(X8={}));var lO;(t=>t.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new $t})(lO||(lO={}));var cO;(t=>t.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5})(cO||(cO={}));var q8;(t=>{function e(n){return n.type==="MouseHover"}t.is=e;function i(){return{type:"MouseHover",disabled:!1,actions:new $t}}t.defaultData=i})(q8||(q8={}));var Y8;(t=>{function e(n){return n.type==="Scroll"}t.is=e;function i(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new $t}}t.defaultData=i})(Y8||(Y8={}));var Q8;(t=>{function e(n){return n.type==="Start"}t.is=e;function i(){return{type:"Start",disabled:!1,actions:new $t}}t.defaultData=i})(Q8||(Q8={}));var K8;(t=>{function e(n){return n.type==="Collision"}t.is=e;function i(){return{type:"Collision",disabled:!1,toggle:!1,target:"character",actions:new $t}}t.defaultData=i})(K8||(K8={}));var J8;(t=>{function e(n){return n.type==="Trigger"}t.is=e;function i(n,r){return{type:"Trigger",disabled:!1,toggle:!1,target:"all",triggeringObjects:[],actions:new $t,triggerZone:"box",position:r.toArray(),rotation:[0,0,0],size:n.toArray(),radius:n.length()/2,helperVisible:!0}}t.defaultData=i})(J8||(J8={}));var _y="personal camera",H1="a218fcc3-276b-49b9-b485-49037fd14f5f",YNe=2960946,tl=5526619,Cv;(t=>{function e(n,r){return n[0]===r[0]&&n[1]===r[1]}t.isEqual=e;function i(n,r,s){return[n[0]+(r[0]-n[0])*s,n[1]+(r[1]-n[1])*s]}t.lerp=i})(Cv||(Cv={}));var jp;(t=>{function e(l,c){return l[0]===c[0]&&l[1]===c[1]&&l[2]===c[2]}t.isEqual=e;function i(l,c){return[l[0]+c[0],l[1]+c[1],l[2]+c[2]]}t.add=i;function n(l,c){return[l[0]-c[0],l[1]-c[1],l[2]-c[2]]}t.sub=n;function r(l,c){return[l[0]/c[0],l[1]/c[1],l[2]/c[2]]}t.div=r;function s(l,c){return[l[0]*c[0],l[1]*c[1],l[2]*c[2]]}t.mul=s;function o(l,c){return Math.hypot(l[0]-c[0],l[1]-c[1],l[2]-c[2])}t.dist=o;function a(l,c,h){return[l[0]+(c[0]-l[0])*h,l[1]+(c[1]-l[1])*h,l[2]+(c[2]-l[2])*h]}t.lerp=a})(jp||(jp={}));var bT;(t=>{function e(n,r){return n[0]===r[0]&&n[1]===r[1]&&n[2]===r[2]&&n[3]===r[3]}t.isEqual=e;function i(n,r,s){return[n[0]+(r[0]-n[0])*s,n[1]+(r[1]-n[1])*s,n[2]+(r[2]-n[2])*s,n[3]+(r[3]-n[3])*s]}t.lerp=i})(bT||(bT={}));var V0;(t=>{t.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function e(r,s){for(let o=0;o<16;o++)if(r[o]!==s[o])return!1;return!0}t.isEqual=e;function i(r){return r??t.identity}t.simplify=i;function n(r,s){let o=s.slice(0);for(var a=0,l=s.length;a<l;a+=3){let c=r[3]*s[a]+r[7]*s[a+1]+r[11]*s[a+2]+r[15];o[a]=(r[0]*s[a]+r[4]*s[a+1]+r[8]*s[a+2]+r[12])/c,o[a+1]=(r[1]*s[a]+r[5]*s[a+1]+r[9]*s[a+2]+r[13])/c,o[a+2]=(r[2]*s[a]+r[6]*s[a+1]+r[10]*s[a+2]+r[14])/c}return o}t.applyMatrix4=n})(V0||(V0={}));var ms;(t=>{function e(l){return typeof l=="object"&&typeof l.r=="number"&&typeof l.g=="number"&&typeof l.b=="number"}t.isRGB=e,t.white={r:1,g:1,b:1},t.red={r:1,g:0,b:0},t.black={r:0,g:0,b:0};function i(l){return{r:Math.round(l.r*255),g:Math.round(l.g*255),b:Math.round(l.b*255),a:1}}t.toRgb255a1=i;function n(l){return{r:l.r,g:l.g,b:l.b}}t.clone=n;function r(l){return l=Math.floor(l),{r:(l>>16&255)/255,g:(l>>8&255)/255,b:(l&255)/255}}t.fromHex=r;function s(l){return Math.round(l.r*255)*65536+Math.round(l.g*255)*256+Math.round(l.b*255)}t.toHex=s;function o(l,c){return l.r===c.r&&l.g===c.g&&l.b===c.b}t.equals=o;function a(l,c,h){return{r:l.r+(c.r-l.r)*h,g:l.g+(c.g-l.g)*h,b:l.b+(c.b-l.b)*h}}t.lerp=a})(ms||(ms={}));var Tl;(t=>{t.white={...ms.white,a:1},t.transparent={...ms.white,a:0};function e(o){return{r:o[0],g:o[1],b:o[2],a:o[3]}}t.from0to1=e;function i(o,a){return{...ms.fromHex(o),a}}t.fromHexAndA=i;function n(o){return{r:Math.round(o.r*255),g:Math.round(o.g*255),b:Math.round(o.b*255),a:o.a}}t.toRgb255a1=n;function r(o,a){return ms.equals(o,a)&&o.a===a.a}t.equals=r;function s(o,a,l){return{r:o.r+(a.r-o.r)*l,g:o.g+(a.g-o.g)*l,b:o.b+(a.b-o.b)*l,a:o.a+(a.a-o.a)*l}}t.lerp=s})(Tl||(Tl={}));var uO;(t=>t.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})(uO||(uO={}));var Z8;(t=>t.defaultData={mass:1,stiffness:80,damping:10,velocity:0})(Z8||(Z8={}));var $8;(t=>t.defaultData={control1:[.5,0],control2:[.5,1]})($8||($8={}));var nd;(t=>(t.linear=[0,0,1,1],t.ease=[.25,.1,.25,1],t.easeIn=[.42,0,1,1],t.easeOut=[0,0,.58,1],t.easeInOut=[.42,0,.58,1]))(nd||(nd={}));var um;(t=>{t.all=["PerspectiveCamera","OrthographicCamera"];function e(i){return t.all.includes(i)}t.is=e})(um||(um={}));var j0;(t=>{t.DefaultUp=[0,1,0],t.DefaultTargetOffset=1e3,t.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:t.DefaultUp,isUpVectorFlipped:!1,targetOffset:t.DefaultTargetOffset};function e(i){return i.type==="PerspectiveCamera"?i.perspective.zoom:i.orthographic.zoom}t.getZoom=e})(j0||(j0={}));var vd;(t=>{function e(n,r=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:Math.max(n[0],n[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[n[0]+n[0]*r,0,0]},grid:{count:[2,2,2],size:n.map(s=>s*(1+r)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}}t.defaultData=e;function i(n,r){let s={...n};if(cie.forEach(o=>{Object.assign(s,{[o]:r[o]??n[o]})}),s.radial={...n.radial},r.radial){let o=n.radial,a=r.radial;uie.forEach(l=>{Object.assign(s.radial,{[l]:a[l]??o[l]})})}if(s.linear={...n.linear},r.linear){let o=n.linear,a=r.linear;hie.forEach(l=>{Object.assign(s.linear,{[l]:a[l]??o[l]})})}if(s.grid={...n.grid},r.grid){let o=n.grid,a=r.grid;die.forEach(l=>{Object.assign(s.grid,{[l]:a[l]??o[l]})})}if(s.toObject={...n.toObject},r.toObject){let o=n.toObject,a=r.toObject;fie.forEach(l=>{Object.assign(s.toObject,{[l]:a[l]??o[l]})})}if(s.randomnessObject={...n.randomnessObject},r.randomnessObject){let o=n.randomnessObject,a=r.randomnessObject;pie.forEach(l=>{Object.assign(s.randomnessObject,{[l]:a[l]??o[l]})})}return s}t.merge=i})(vd||(vd={}));var hO;(t=>{t.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let e=["radial","linear","grid","toObject","randomnessObject"];function i(n,r){let s=[];n.count!==void 0&&s.push({type:0,path:r,props:{count:n.count}});for(let o of e){let a=n[o];a&&Object.keys(a).length>0&&s.push({type:0,path:[...r,o],props:a})}return s}t.toOps=i})(hO||(hO={}));var cie=["count"],uie=["radius","start","end","position","scale","rotation"],hie=["position","scale","rotation"],die=["count","size"],fie=["count","position","scale","rotation"],pie=["strength","scale","rotation","position","movement","seed","freqScale"],dO;(t=>{t.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function e(i){return t.all.includes(i)}t.is=e})(dO||(dO={}));var fO;(t=>{function e(n){return i(n)}t.defaultData=e;function i(n){if(n==="PointLight")return{type:n,color:Tl.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if(n==="SpotLight")return{type:n,color:Tl.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if(n==="DirectionalLight")return{type:n,color:Tl.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}})(fO||(fO={}));var W0;(t=>t.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]})(W0||(W0={}));var pO;(t=>{t.defaultData={castShadow:!0,receiveShadow:!0};function e(i,n){return i.castShadow===n.castShadow&&i.receiveShadow===n.receiveShadow}t.equals=e})(pO||(pO={}));var mO;(t=>{t.defaultData={flatShading:!1,wireframe:!1,side:0};function e(i,n){return i.flatShading===n.flatShading&&i.side===n.side&&i.wireframe===n.wireframe}t.equals=e})(mO||(mO={}));var gO;(t=>t.defaultData={...mO.defaultData,...pO.defaultData})(gO||(gO={}));var ST;(t=>(t.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},t.maxSize=3e7))(ST||(ST={}));var e9;(t=>{function e(i){return i==="texture"||i==="video"||i==="color"||i==="depth"||i==="normal"||i==="gradient"||i==="noise"||i==="fresnel"||i==="rainbow"||i==="toon"||i==="outline"||i==="transmission"||i==="matcap"||i==="displace"||i==="pattern"||i==="light"}t.is=e})(e9||(e9={}));function QNe(t){return t.type!=="displace"}var t9;(t=>{function e(i){return i==="phong"||i==="toon"||i==="lambert"||i==="physical"}t.is=e})(t9||(t9={}));var mie=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],KNe=["wrapping","image","video","name"],Na;(t=>{function e(s,o){let{texture:a,...l}=o;if(Object.assign(s,l),a){let c=s.texture;c&&Object.assign(c,a)}}t.patch=e;function i(s,o){return s==="light"&&o?n(o):r(s)}t.defaultData=i;function n(s){let o={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(s){case"phong":return{...o,category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6};case"toon":return{...o,category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1};case"lambert":return{...o,category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0};case"physical":return{...o,category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0}}}function r(s){let o={alpha:1,mode:0,isMask:!1,visible:!0};switch(s){case"texture":return{...o,type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0]},crop:!1};case"video":return{...o,type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:ST.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0]},crop:!1};case"color":return{...o,type:"color",color:ms.fromHex(tl)};case"depth":return{...o,type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{...o,type:"normal",cnormal:[1,1,1]};case"gradient":return{...o,type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{...o,type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...ms.fromHex(6710886),a:1},colorB:{...ms.fromHex(6710886),a:1},colorC:{...ms.fromHex(16777215),a:1},colorD:{...ms.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1};case"fresnel":return{...o,type:"fresnel",color:Tl.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{...o,type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{...o,type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:Tl.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{...o,type:"outline",outlineColor:Tl.fromHexAndA(0,1),contourColor:Tl.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{...o,type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0]}};case"transmission":return{...o,type:"transmission",thickness:10,ior:1.5,roughness:1};case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return{...o,type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:{...ms.fromHex(0),a:1},colorB:{...ms.fromHex(16777215),a:1},frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6}}}})(Na||(Na={}));var ea;(t=>{function e(c){return!c.layers.some(h=>h.data.type==="texture"&&h.data.projection!==0||h.data.type==="depth"&&!h.data.isWorldSpace||h.data.type==="noise"||h.data.type==="displace")}t.isMergable=e;function i(c){let h="";return c.layers.forEach(u=>{Object.entries(u.data).forEach(([d,f])=>{h+=`${d}${f}`,Array.isArray(f)?f.forEach(p=>h+=`${p}`):typeof f=="object"?Object.values(f).forEach(p=>{typeof p=="number"?h+=`${p.toFixed(4)}`:h+=`${p}`}):h+=`${f}`})}),h}t.getHash=i;function n(){return{layers:new $t}}t.defaultEmptyData=n;function r(c="layer1",h="layer2"){return o("phong",c,h)}t.defaultData=r;function s(c,h){return{...c,name:h}}t.withName=s;function o(c,h="layer1",u="layer2"){let d=new $t;return d.push({fi:0,data:Na.defaultData("light",c),id:h}),d.push({fi:1,data:Na.defaultData("color"),id:u}),{layers:d}}t.defaultTwoLayerData=o;function a(c,h="phong",u="layer1",d="layer2"){let f=Na.defaultData("texture");Object.assign(f.texture,{image:c});let p=new $t;return p.push({fi:0,data:f,id:u}),p.push({fi:1,data:Na.defaultData("light",h),id:d}),{layers:p}}t.defaultTwoLayerTextureData=a;function l(c,h="phong",u="layer1",d="layer2"){let f=Na.defaultData("video");Object.assign(f.texture,{video:c});let p=new $t;return p.push({fi:0,data:f,id:u}),p.push({fi:1,data:Na.defaultData("light",h),id:d}),{layers:p}}t.defaultTwoLayerVideoTextureData=l})(ea||(ea={}));var AT;(t=>{function e(){return{points:new $t,roundness:0,shapeHoles:[],isClosed:!1}}t.defaultData=e})(AT||(AT={}));var MT;(t=>{function e(){return{points:new $t,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}t.defaultData=e})(MT||(MT={}));var gie={type:"Ellipse",width:100,height:100,spikes:64,angle:360,innerRadius:0},vO;(t=>{function e(i,n){let r={...i};return yie.forEach(s=>{Object.assign(r,{[s]:n[s]??i[s]})}),r}t.merge=e})(vO||(vO={}));var vie={shape:gie,depth:1,offset:0,bevel:0,bevelSides:1,angle:0,twist:0,startScale:1,endScale:1},yie=["depth","offset","angle","twist","startScale","endScale"],ET;(t=>{function e(n){return n==="PolygonGeometry"||n==="RectangleGeometry"||n==="StarGeometry"||n==="TriangleGeometry"||n==="EllipseGeometry"}t.is2DParametricMesh=e;function i(n){return n==="PolygonGeometry"||n==="PolygonGeometry"||n==="RectangleGeometry"||n==="StarGeometry"||n==="TriangleGeometry"||n==="EllipseGeometry"||n==="PathGeometry"||n==="VectorGeometry"||n==="ConeGeometry"||n==="CubeGeometry"||n==="CylinderGeometry"||n==="DodecahedronGeometry"||n==="HelixGeometry"||n==="IcosahedronGeometry"||n==="LatheGeometry"||n==="PyramidGeometry"||n==="SphereGeometry"||n==="PlaneGeometry"||n==="BackdropGeometry"||n==="TorusGeometry"||n==="TorusKnotGeometry"||n==="BooleanGeometry"||n==="TextGeometry"}t.isParametricMesh=i})(ET||(ET={}));var yO;(t=>{function e(i,n){let r={...i};return Object.assign(r,n),r.type==="PathGeometry"&&"extrusion"in n&&n.extrusion&&(r.extrusion={...i.extrusion},Object.assign(r.extrusion,vO.merge(r.extrusion,n.extrusion))),r}t.merge=e})(yO||(yO={}));var qv;(t=>{function e(i){if(i==="RectangleGeometry")return{width:320,height:320,type:i,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(i==="PathGeometry")return{type:i,width:1,height:1,depth:1,path:MT.defaultData(),extrusion:vie};if(i==="VectorGeometry")return{width:1,height:1,type:i,subdivisions:12,shape:AT.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(i==="BooleanGeometry")return{type:i,operation:2,width:0,height:0,depth:0,phongAngle:35};if(i==="TextGeometry")return{type:i,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:"",textTransform:1,font:"Roboto_regular",extrudeBevelSize:0,extrudeBevelSegments:1};if(i==="SphereGeometry")return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI};throw new Error("not implemented")}t.defaultData=e})(qv||(qv={}));var i9=["width","height","depth"],xO;(t=>t.defaultData={enabled:!1,useBackgroundColor:!1,color:ms.white,near:.1,far:2e3})(xO||(xO={}));var TT;(t=>{let e={opacity:1,blendFunction:13,enabled:!1};t.defaultData={enabled:!1,pixelation:{...e,blendFunction:16,granularity:15},bloom:{...e,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{...e,offset:[2,2]},vignette:{...e,darkness:1,offset:0},hueSaturation:{...e,hue:3,saturation:0},brightnessContrast:{...e,brightness:.25,contrast:0},depthOfField:{...e,focalLength:2,focusDistance:2,bokehScale:2},noise:{...e,blendFunction:16}}})(TT||(TT={}));var _O;(t=>t.defaultData={softShadowQuality:"low"})(_O||(_O={}));var wO;(t=>t.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75})(wO||(wO={}));var bO;(t=>t.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}})(bO||(bO={}));var X0;(t=>t.defaultData={usePhysics:!1,gravity:-10})(X0||(X0={}));var SO;(t=>t.defaultData={playCamera:_y,gameControlObject:null})(SO||(SO={}));var AO;(t=>t.defaultData={backgroundColor:Tl.fromHexAndA(YNe,1),postprocessing:TT.defaultData,fog:xO.defaultData,globalPhysics:X0.defaultData,ambient:wO.defaultData,ao:bO.defaultData,shadow:_O.defaultData,publish:SO.defaultData})(AO||(AO={}));var n9;(t=>{function e(n){return n==="Component"||n==="Instance"}t.isComponentRelated=e;function i(n){return n==="Empty"||n==="Instance"}t.isEmptyOrComponent=i})(n9||(n9={}));var q0;(t=>{t.identity={...uO.identity,hiddenMatrix:V0.identity};function e(r){return{position:r.position,rotation:r.rotation,scale:r.scale,hiddenMatrix:r.hiddenMatrix}}t.fromObject=e;function i(r,s){return{position:(s==null?void 0:s.position)||r.position,rotation:(s==null?void 0:s.rotation)||r.rotation,scale:(s==null?void 0:s.scale)||r.scale,hiddenMatrix:(s==null?void 0:s.hiddenMatrix)||r.hiddenMatrix}}t.merge=i;function n(r,s){return aNe({position:jp.isEqual(r.position,s.position)?void 0:s.position,rotation:jp.isEqual(r.rotation,s.rotation)?void 0:s.rotation,scale:jp.isEqual(r.scale,s.scale)?null:s.scale,hiddenMatrix:V0.isEqual(r.hiddenMatrix,s.hiddenMatrix)?void 0:s.hiddenMatrix})}t.diff=n})(q0||(q0={}));var _o;(t=>t.defaultData={states:new $t,events:new $t,visible:!0,raycastLock:!1,physics:W0.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...q0.identity,cloner:null})(_o||(_o={}));var r9;(t=>t.defaultData={type:"Empty",..._o.defaultData})(r9||(r9={}));var s9;(t=>t.defaultData={type:"Component",..._o.defaultData})(s9||(s9={}));var Yv;(t=>t.defaultData={type:"Mesh",..._o.defaultData,...gO.defaultData})(Yv||(Yv={}));var K_;(t=>t.defaultData={..._o.defaultData,...q0.identity,position:[0,0,j0.DefaultTargetOffset],...j0.defaultData})(K_||(K_={}));var MO;(t=>{function e(i){return{..._o.defaultData,...fO.defaultData(i)}}t.defaultData=e,t.defaultDirectionalLightData={...t.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7}})(MO||(MO={}));var CT;(t=>{function e(n,r,s=0){for(;s<r.length;){let o=n?n[r[s]]:void 0;if(r.length===s+1)return o;if(o)n=o.descendants,s+=1;else return}}t.resolveWithDes=e;function i(n,r,s=0){let o=e(n,r,s);if(o){let a=Object.keys(o);if(a.length===1&&a[0]==="descendants")return}return o}t.resolve=i})(CT||(CT={}));var Wp;(t=>{t.rootOverrideProps=["physics","events"],t.compositeNonOptionalOverrideProps=["geometry"],t.compositeEntireOverrideOverrideProps=["material"];function e(n,r){return{..._o.defaultData,...r,component:n,overrides:new es,physics:void 0,events:void 0,type:"Instance"}}t.ofComponent=e;function i(n){let r=q0.fromObject(n.data);return e(n.id,r)}t.fromComponentData=i})(Wp||(Wp={}));var Y0;(t=>t.defaultData={type:"Page",..._o.defaultData,physics:{...W0.defaultData,fusedBody:!1},...AO.defaultData,camera:K_.defaultData})(Y0||(Y0={}));var EO;(t=>(t.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:V0.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:W0.defaultData,states:new $t,events:new $t,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...j0.defaultData},t.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},t.defaultMeshObject={name:"Rectangle",..._o.defaultData,...Yv.defaultData,geometry:qv.defaultData("RectangleGeometry"),material:ea.defaultTwoLayerData("phong","layer1","layer2")},t.defaultBooleanObject={name:"Boolean",..._o.defaultData,...Yv.defaultData,geometry:qv.defaultData("BooleanGeometry"),material:ea.defaultTwoLayerData("phong","layer1","layer2")},t.defaultTextObject={name:"Text",..._o.defaultData,...Yv.defaultData,geometry:qv.defaultData("TextGeometry"),material:ea.defaultTwoLayerData("phong","layer1","layer2")}))(EO||(EO={}));var Ap;(t=>{function e(s,o){let a={name:o};return s.type==="Mesh"?(a.geometry={},"material"in s&&(a.material={layers:new es}),"materials"in s&&(a.materials=s.materials.map(l=>({layers:new es})))):um.is(s.type)&&(a.perspective={},a.orthographic={}),a}t.newEmpty=e;function i(s,o){if(o===void 0)return s;let a={...s};return"material"in a&&"material"in o&&o.material&&(a.material=yT(a.material,l=>{if(typeof l!="string")for(let[c,h]of Object.entries(o.material.layers)){let u=l.layers.data(c);u&&Na.patch(u,h)}}).data),a.materials&&o.materials&&(a.materials=yT(a.materials,l=>{var c,h;for(let u=0;u<a.materials.length;u++){let d=o.materials[u];if(typeof d!="string")for(let[f,p]of Object.entries(d.layers)){let m=(h=(c=l[u])==null?void 0:c.layers)==null?void 0:h.data(f);m&&Na.patch(m,p)}}}).data),a}function n(s,o){let a,l=[],c={orthographic:0,perspective:0,geometry:0};function h(u,d){for(let[f,p]of Object.entries(d.layers)){let{texture:m,...v}=p;if(m!==void 0&&Object.keys(m).length>0){let g={path:[...u,"layers",f,"texture"],props:m,type:0};l.push(g)}if(Object.keys(v).length>0){let g={path:[...u,"layers",f],props:v,type:0};l.push(g)}}}for(let[u,d]of Object.entries(o))if(u!=="name")if(u==="cloner")l.push(...hO.toOps(d,["cloner"]));else if(u==="pathSnapping")l.push({path:[u],props:{slide:d.slide,offset:d.offset},type:0});else if(u==="material")h(["material"],d);else if(u==="materials")for(let[f,p]of Object.entries(d))h(["materials",f],p);else if(c[u]===0){if(u==="geometry"&&d.extrusion!==void 0){let f={path:[u,"extrusion"],props:d.extrusion,type:0};l.push(f),d={...d},delete d.extrusion}if(Object.keys(d).length>0){let f={path:[u],props:d,type:0};l.push(f)}}else a===void 0&&(a={path:[],props:{},type:0},l.push(a)),a.props[u]=d;return l}t.toOps=n;function r(s,o){var l,c,h,u,d,f;if(o===void 0)return s;let a={...s};if(Object.assign(a,q0.merge(a,o)),Object.assign(a,{pathSnapping:Object.assign({},a.pathSnapping,{slide:((l=o.pathSnapping)==null?void 0:l.slide)??((c=a.pathSnapping)==null?void 0:c.slide)??0,offset:((h=o.pathSnapping)==null?void 0:h.offset)??((u=a.pathSnapping)==null?void 0:u.offset)??0})}),um.is(s.type)){a.orthographic={...a.orthographic},a.perspective={...a.perspective};let p=o;((d=p.orthographic)==null?void 0:d.zoom)!==void 0&&(a.orthographic.zoom=p.orthographic.zoom),((f=p.perspective)==null?void 0:f.zoom)!==void 0&&(a.perspective.zoom=p.perspective.zoom),p.isUpVectorFlipped!==void 0&&(a.isUpVectorFlipped=p.isUpVectorFlipped),p.targetOffset!==void 0&&(a.targetOffset=p.targetOffset)}else if(s.type==="Mesh")"geometry"in o&&Object.assign(a,{geometry:yO.merge(a.geometry,o.geometry)}),(o.material||o.materials)&&(a=i(a,o)),a.cloner&&"cloner"in o&&Object.assign(a,{cloner:vd.merge(a.cloner,o.cloner)});else if(s.type==="Empty")a.cloner&&"cloner"in o&&Object.assign(a,{cloner:vd.merge(a.cloner,o.cloner)});else if(dO.is(s.type)){let p=o;p.intensity!==void 0&&(a.intensity=p.intensity),p.color!==void 0&&(typeof p.color=="string"?a.color=p.color:a.color=ms.clone(p.color))}return a}t.patch=r})(Ap||(Ap={}));var PT;(t=>t.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0})(PT||(PT={}));var Xp;(t=>t.defaultData={orbitControls:PT.defaultData,playPage:H1,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map((e,i)=>{let n=0,r=0;return i<5?r=-30:i<10&&(r=30),i===0||i===10||i===5?n=30:(i===4||i===11||i===9)&&(n=-30),[120,[n,r],"show"]}),settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1}},stopRaycast:!0,hdTransmission:!1})(Xp||(Xp={}));var TO;(t=>t.defaultData={id:"basic",label:"Basic",style:"None",prompt:""})(TO||(TO={}));var CO;(t=>t.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0})(CO||(CO={}));var Qv;(t=>(t.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:{...TO.defaultData},isRandomSeed:!0,seed:t.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:CO.defaultData}),t.generateSeed=()=>Math.round(Math.random()*1e5)))(Qv||(Qv={}));var J_;(t=>{function e(n){return n.find(r=>r.data.type==="Page"&&r.data.globalPhysics.usePhysics)!==void 0}t.physicsEnabled=e;function i(n,r,s){n.traverseFrom(r,(o,a)=>{if(a.type==="Instance"){let l=n.data(a.component);l&&s(o,a,l.events)}else s(o,a,a.events)})}t.traverseModuleInstances=i})(J_||(J_={}));var PO;(t=>{t.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222";function e(r={withLight:!0,withSquare:!0}){let s=[],o=EO.defaultMeshObject;r.withLight===!0&&s.push({fi:-1,data:MO.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]}),r.withSquare===!0&&s.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:o,children:[]});let a=new xo;return a.push({fi:1,id:H1,data:{...Y0.defaultData,name:"Scene 1"},children:s}),a}t.defaultData={objects:e(),publish:Xp.defaultData,styles:Qv.defaultData()},t.emptyDataWithoutPage=function(){return{objects:new xo,publish:Xp.defaultData,styles:Qv.defaultData()}},t.emptyDataWithPage=function(r){return{objects:e(r),publish:Xp.defaultData,styles:Qv.defaultData()}};function i(r){return{...t.defaultData,objects:cm(r,xo.prototype)}}t.withObjs=i;function n(r,s){return i([{id:r,data:s,children:[],fi:0}])}t.withObj=n})(PO||(PO={}));var DT;(t=>t.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"})(DT||(DT={}));var DO;(t=>{function e(){let r={};return r["89b10010-844c-11ec-a8a3-0242ac120002"]={r:.5,g:.5,b:.5,a:1,name:"Default Color"},cm(r,ar.prototype)}t.defaultColors=e;function i(r){let s={};return r!=null&&r.withAITexture&&(s["a1b10010-844c-a8a3-11ec-0242ac2011ec"]={...DT.emptyImage,name:"AI generated image"}),cm(s,ar.prototype)}t.defaultImages=i;function n(){return{materials:new ar,images:new ar,videos:new ar,colors:new ar,audios:new ar,fonts:new ar}}t.emptyData=n})(DO||(DO={}));var RO;(t=>t.list=["idle","move","jump","run"])(RO||(RO={}));var RT;(t=>(t.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},t.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","▲"],["rotPosY","◀"],["rotNegX","▼"],["rotNegY","▶"],["jump","Space"],["run","⇧"],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:t.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new $t,move:new $t,jump:new $t,run:new $t},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:Tl.fromHexAndA(3728051,1)}}))(RT||(RT={}));function o9(t){t.layers.forEach(e=>{if(e.type==="depth"&&e.colorA!==void 0){let i=e.colorA,n=e.colorB,r=[[i.r,i.g,i.b,i.a],[n.r,n.g,n.b,n.a]],s=[0,1];for(let a=2;a<10;a++)r.push(r[1]),s.push(1);let o={...Ud(Hr(e),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,e.near),far:Math.max(0,e.far),colors:r,steps:s,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(e,o)}else if(e.type==="depth"&&e.gradientType===1&&(e.near<0||e.far<0)){let i={...Hr(e),near:Math.max(e.near,0),far:Math.max(e.far,0)};Object.assign(e,i)}})}function od(t,e){Object.values(t.shared.materials).forEach(i=>e(i))}function ad(t,e){t.scene.objects.traverse((i,n)=>{"materials"in n?n.materials.forEach(r=>{typeof r!="string"&&e(r)}):"material"in n&&typeof n.material!="string"&&e(n.material),"overrides"in n&&Object.values(n.overrides).forEach(r=>{r.material&&typeof r.material!="string"&&e(r.material)})})}function JNe(t){Object.assign(t.scene.publish,{orbitControls:{...PT.defaultData,...Hr(t.scene.publish.orbitControls)}})}function ZNe(t){Object.assign(t.scene.publish.settings,{video:{...Xp.defaultData.settings.video,...Hr(t.scene.publish.settings.video)}})}function $Ne(t){function e(i){if(i.layers){for(let n of Object.values(i.layers))if(n){for(let[r,s]of Object.entries(n))if((mie.includes(r)||typeof s=="boolean")&&delete n[r],r==="texture")for(let[o,a]of Object.entries(s))(KNe.includes(o)||typeof a=="boolean")&&delete s[o]}}}t.scene.objects.traverse((i,n)=>{n.states.forEach(r=>{let s=r;s.material?e(s.material):s.materials&&s.materials.forEach(o=>{e(o)})})})}function eUe(t){t.scene.publish.withBackground=!0}function tUe(t){t.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}function iUe(t){t.scene.objects.traverse((e,i)=>{let n=i.cloner;n&&(n.radial.scale=n.radial.scale.map(r=>r+1),n.linear.scale=n.linear.scale.map(r=>r+1))})}function nUe(t){t.scene.objects.traverse((e,i)=>{let n=i.geometry;n&&(n.type==="DodecahedronGeometry"||n.type==="IcosahedronGeometry")&&(n.detail=Math.round(n.detail))})}function rUe(t){t.scene.objects.traverse((e,i)=>{let n=t.scene.objects.unproxy().parent(e);if(n){let r=Hr(t.scene.objects.data(n));r&&r.type==="Mesh"&&r.geometry.type==="BooleanGeometry"&&i.type==="Mesh"&&(i.visible=Hr(i).booleanExclude!==!0)}})}function sUe(t){t.scene.objects.traverse((e,i)=>{if(i.type==="Mesh"){let n=i;i.geometry.type==="NonParametricGeometry"?n.material!==void 0&&delete n.material:n.materials!==void 0&&delete n.materials}})}function oUe(t){function e(n){Object.setPrototypeOf(n,es.prototype),n.texture&&Object.setPrototypeOf(n.texture,es.prototype)}function i(n){Object.setPrototypeOf(n,es.prototype);for(let r in n)e(n[r])}t.scene.objects.traverse((n,r)=>{r.states.forEach(s=>{let o=s;if(o.material){let a=Hr(o.material).layers;i(a),o.material.layers=a}if(o.materials)for(let a=0;a<o.materials.length;a++){let l=o.materials[a],c=Hr(l).layers;i(c),l.layers=c}})})}function a9(t){t.layers===void 0&&Object.assign(t,ea.defaultTwoLayerData("lambert"))}function d3(t){!t.layers||t.layers.forEach(e=>{if(e.type==="depth"&&e.colors.length===10){let i=[...e.colors];i.push(e.colors[9]);let n=[...e.steps];n.push(e.steps[9]);let r={...Hr(e),colors:i,steps:n};Object.assign(e,r)}})}function aUe(t){t.scene.objects.traverse((e,i)=>{i.type==="Mesh"&&(i.geometry.type==="BooleanGeometry"||i.geometry.type==="SubdivGeometry")&&(i.geometry.phongAngle=35)})}function l9(t){t.scene.objects.traverse((e,i)=>{"materials"in i?i.materials.forEach(n=>{typeof n!="string"&&d3(n)}):"material"in i&&typeof i.material!="string"&&d3(i.material)}),Object.values(t.shared.materials).forEach(e=>d3(e))}function lUe(t){t.scene.environment.ambientLight.softShadows=!1,t.scene.environment.ambientLight.softShadowQuality="low",t.scene.objects.traverse((e,i)=>{(i.type==="DirectionalLight"||i.type==="SpotLight")&&(i.shadowResolution=1024,i.shadowRadius=1,i.depth=1e5)}),t.shared.penumbraSize=new Array(5).fill(.5)}function cUe(t){t.shared.audios=cm({},ar.prototype)}function uUe(t){t.shared.videos=cm({},ar.prototype)}function hUe(t){let e=t.shared.materials;Object.entries(e).forEach(([i,n])=>{if(!n.layers){let r={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(e,{[i]:r})}})}function dUe(t){Object.entries(Hr(t.shared.images)).filter(e=>e[1].asset===!1).map(e=>e[0]).forEach(e=>{delete t.shared.images[e]}),Object.entries(Hr(t.shared.audios)).filter(e=>e[1].asset===!1).map(e=>e[0]).forEach(e=>{delete t.shared.audios[e]})}function fUe(t){t.scene.publish.settings.web.preload=!1}function c9(t){t.layers&&t.layers.forEach(e=>{e.type==="depth"&&e.num!==void 0&&(e.colors=e.colors.slice(0,e.num),e.steps=e.steps.slice(0,e.num),delete e.num)})}function u9(t){t.layers&&t.layers.forEach(e=>{QNe(e)&&e.isMask===void 0&&(e.isMask=!1),(e.type==="texture"||e.type==="video")&&e.blending===void 0&&(e.blending=0),(e.type==="noise"||e.type==="displace"&&e.displacementType==="noise")&&(e.voronoiStyle===void 0&&(e.voronoiStyle=0),e.highCut===void 0&&(e.highCut=1),e.lowCut===void 0&&(e.lowCut=0),e.smoothness===void 0&&(e.smoothness=.3),e.seed===void 0&&(e.seed=0),e.quality===void 0&&(e.quality=1))})}function pUe(t){t.shared.fonts=cm({},ar.prototype)}function mUe(t){return t.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function gUe(t){let e=[];t.scene.objects.traverse((i,n)=>{let r=n;if(r.type==="TextFrame"){let s=ea.defaultTwoLayerData("phong"),o=typeof r.color=="string"?t.shared.colors[r.color]:r.color;s.layers[1].data.color={r:o.r,g:o.g,b:o.b},s.layers[1].data.alpha=r.alpha;let a=mUe(r.font);t.shared.fonts[a]===void 0&&(t.shared.fonts[a]={name:a});let l={name:r.name,..._o.defaultData,...Yv.defaultData,flatShading:!1,wireframe:!1,geometry:{...qv.defaultData("TextGeometry"),width:r.width,height:r.height,font:a,depth:0,horizontalAlign:r.horizontalAlign,verticalAlign:r.verticalAlign,fontSize:r.fontSize*1.40625,lineHeight:r.lineHeight/1.40625,letterSpacing:r.letterSpacing-1,text:r.text,textTransform:r.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:s,states:Hr(r.states),events:Hr(r.events),visible:r.visible,raycastLock:r.raycastLock,position:r.position,rotation:r.rotation,scale:r.scale,hiddenMatrix:r.hiddenMatrix},c=Hr(t.scene.objects).parent(i);t.scene.objects.insertAfter(c??null,i,[{id:i+"new",data:l,children:[]}]),e.push(i)}}),e.forEach(i=>{t.scene.objects.delete(i)})}function vUe(t){let e={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};t.scene.objects.traverse((i,n)=>{n.events.forEach(r=>{if(e[Number(r.type)])if(Object.assign(r,{type:e[Number(r.type)]}),r.type==="Audio"&&"audioEvent"in r&&(Object.assign(r,{playAudio:r.audioEvent}),delete r.audioEvent),r.type==="GameControl")Object.assign(r,{gameActions:{idle:new $t,move:new $t,jump:new $t}});else{let s=new $t;Object.assign(r,{actions:s}),(r.type==="MouseDown"||r.type==="MouseUp"||r.type==="KeyDown"||r.type==="KeyUp")&&"url"in r&&s.push({fi:0,id:hi.generateUUID(),data:{type:"Link",url:r.url,delay:0}}),"targets"in r&&(r.targets.forEach((o,a,l)=>{let c={state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4},h={easing:o.easing,duration:o.duration};o.easing===6?Object.assign(h,Ud(o,"mass","stiffness","damping","velocity")):o.easing===5&&Object.assign(h,{control1:{...o.control1},control2:{...o.control2}});let u={repeat:o.repeat?-1:0,delay:o.delay,delayDirection:o.delayDirection,direction:o.cycle&&o.rewind?"pingpong-rewind":o.cycle?"pingpong":"normal"},d={state:o.state,...u,...h},f={allowSlerp:!0,type:"Transition",object:o.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new $t({fi:0,id:hi.generateUUID(),data:c},{fi:1,id:hi.generateUUID(),data:d})};s.push({fi:l,id:a,data:f})}),delete r.targets)}})})}function yUe(t){t.scene.objects.traverse((e,i)=>{function n(r,s){var l;let o=new $t,a=[];if(i.events.forEach((c,h,u)=>{if(c.type==="Audio"&&c.trigger===s){let d;a.push(h),c.interaction==="play"?d={...Ud(c,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in c?c.after:void 0,toggle:"after"in c?c.toggle:void 0,type:"Audio"}:(c.interaction==="pause"||c.interaction==="stop")&&(d={...Ud(c,"interaction","delay","object","playAudio"),type:"Audio"}),d&&o.push({fi:u,id:h,data:d})}}),a.forEach(c=>i.events.delete(c)),o.length){let c=(l=i.events.find(h=>h.type===r))==null?void 0:l.data;c?"actions"in c&&c.actions.insertBefore(null,o):i.events.insertBefore(null,[{id:hi.generateUUID(),data:{type:r,actions:o}}])}}n("Start","start"),n("MouseDown","mouseDown"),n("MouseUp","mouseUp"),n("KeyDown","keyDown"),n("KeyUp","keyUp")})}function h9(t){var i;let e=(i=t.layers.find(n=>n.type==="light"))==null?void 0:i.data;if((e==null?void 0:e.category)==="basic"){let n=Na.defaultData("light","phong"),r=e;Object.assign(r,n),r.visible=!1}}function d9(t){od(t,h9),ad(t,h9)}function xUe(t){t.scene.objects.traverse((e,i)=>{i.type==="Mesh"&&i.geometry.type==="SubdivGeometry"&&(i.geometry.scaleBaked||(i.geometry.scaleBaked=[1,1,1]))})}function _Ue(t){t.scene.objects.traverse((e,i)=>{(i.type==="Empty"||i.type==="Mesh")&&i.cloner&&!i.cloner.randomnessObject&&!i.cloner.toObject&&!i.cloner.randomness&&(i.cloner={...i.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})})}function wUe(t){t.scene.objects.traverse((e,i)=>{i.type==="Mesh"&&i.geometry.type==="NonParametricGeometry"&&!("material"in i)&&!("materials"in i)&&(i.material=ea.defaultTwoLayerData("phong"))})}function bUe(t){t.scene.publish.orbitControls.autoZoom===void 0&&(t.scene.publish.orbitControls.autoZoom=!1),t.scene.objects.traverse((e,i)=>{(i.type==="OrthographicCamera"||i.type==="PerspectiveCamera")&&(i.orthographic.autoZoom===void 0&&(i.orthographic.autoZoom=!1),i.orthographic.autoZoomFrustumSize===void 0&&(i.orthographic.autoZoomFrustumSize=790))})}function SUe(t){t.scene.objects.traverse((e,i)=>{i.pathSnapping===void 0&&(i.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),i.pathSnapping.offset===void 0&&(i.pathSnapping.offset=0)})}function AUe(t){t.scene.publish.mouseEventTarget===void 0&&(t.scene.publish.mouseEventTarget="canvas"),t.scene.publish.settings.web.hint===void 0&&(t.scene.publish.settings.web.hint=!1)}function MUe(t){let{video:e}=t.scene.publish.settings;e.format==="gif"&&e.fps>48&&(e.fps=15)}function EUe(t){t.scene.objects.traverse((e,i)=>{i.events.forEach(n=>{n.type==="GameControl"&&(n.resetYPosition=Math.abs(n.resetYPosition-i.position[1]))})})}function TUe(t){let e=t.scene.environment.usePhysics;t.scene.objects.traverse((i,n)=>{e&&n.physics===null?n.collision=!1:n.collision="visibility"})}function CUe(t){t.scene.objects.traverse((e,i)=>{i.events.forEach(n=>{n.type==="GameControl"&&(n.navmesh=RT.defaultDataThirdPerson.navmesh)})})}function PUe(t){t.scene.styles||(t.scene.styles=Qv.defaultData())}function f9(t){t.layers.forEach(e=>{e.type==="light"&&e.category!=="toon"&&e.occlusion===void 0&&(e.occlusion=!0)})}function DUe(t){t.scene.environment.ambientLight.occlusion===void 0&&(t.scene.environment.ambientLight.occlusion=!1),t.scene.environment.ambientLight.aoFullRes===void 0&&(t.scene.environment.ambientLight.aoFullRes=!1),t.scene.environment.ambientLight.radius===void 0&&(t.scene.environment.ambientLight.radius=256),t.scene.environment.ambientLight.bias===void 0&&(t.scene.environment.ambientLight.bias=.5),t.scene.environment.ambientLight.aoColor===void 0&&(t.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),ad(t,f9),od(t,f9)}function RUe(t){t.scene.objects.traverse((e,i)=>{i.events.forEach(n=>{n.type==="GameControl"&&Object.assign(n.gameActions,{run:new $t})})})}function IUe(t){t.scene.objects.traverse((e,i)=>{i.events.forEach(n=>{n.type==="GameControl"&&(n.keyAssignments=[...n.keyAssignments,["run","⇧"],["none","Ctrl"]])})})}function p9(t){t.layers&&t.layers.forEach(e=>{e.type==="light"&&e.bumpMapIntensity===void 0&&(e.bumpMapIntensity=5)})}function LUe(t,e){if(e<1&&(ad(t,o9),od(t,o9),t.schema=1),e<2&&(JNe(t),t.schema=2),e<3&&($Ne(t),t.schema=3),e<4&&(eUe(t),t.schema=4),e<5&&(tUe(t),t.schema=5),e<6&&(iUe(t),t.schema=6),e<7&&(nUe(t),t.schema=7),e<8&&(t.schema=8),e<9&&(l9(t),t.schema=9),e<10&&(aUe(t),t.schema=10),e<11&&(lUe(t),t.schema=11),e<12&&(l9(t),t.schema=12),e<13&&(cUe(t),t.schema=13),e<14&&(hUe(t),t.schema=14),e<15&&(dUe(t),t.schema=15),e<16&&(fUe(t),t.schema=16),e<17&&(ad(t,c9),od(t,c9),t.schema=17),e<18&&(ad(t,a9),od(t,a9),t.schema=18),e<19&&(ZNe(t),t.schema=19),e<20&&(pUe(t),gUe(t),t.schema=20),e<21&&(vUe(t),yUe(t),t.schema=21),e<22&&(d9(t),t.schema=22),e<23&&(xUe(t),t.schema=23),e<24&&(_Ue(t),t.schema=24),(e<25||t.shared.videos===void 0)&&(uUe(t),e<25&&(t.schema=25)),e<26&&(rUe(t),t.schema=26),e<27&&(sUe(t),t.schema=27),e<28&&(d9(t),t.schema=28),e<29&&(oUe(t),t.schema=29),e<30&&(wUe(t),t.schema=30),e<31&&(bUe(t),t.schema=31),e<33&&(SUe(t),t.schema=33),e<34&&(AUe(t),t.schema=34),e<35&&(MUe(t),t.schema=35),e<36&&(EUe(t),t.schema=36),e<37&&(TUe(t),t.schema=37),e<38&&(ad(t,u9),od(t,u9),t.schema=38),e<39&&(CUe(t),t.schema=39),e<40&&(PUe(t),t.schema=40),e<41&&(DUe(t),t.schema=41),e<42&&(RUe(t),t.schema=42),e<43&&(IUe(t),t.schema=43),e<99){ad(t,p9),od(t,p9),t.scene.publish.playCamera===null&&(t.scene.publish.playCamera=_y);let i=Hr(t.scene.objects),n=t.scene.objects;t.scene.publish.playPage=H1,n.insertBefore(null,null,[{id:H1,data:{...Y0.defaultData,backgroundColor:t.scene.backgroundColor,fog:t.scene.fog,postprocessing:t.scene.postprocessing,ao:Ud(t.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:t.scene.publish.playCamera,gameControlObject:t.scene.publish.gameControlObject},shadow:Ud(t.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:{...X0.defaultData,...Ud(t.scene.environment,"usePhysics","gravity")},camera:Hr(t.scene.ownerCamera)??Y0.defaultData.camera,name:"Scene"},children:[]}]);for(let o of i)o.id!==PO.TRASH_CAN_ID&&n.move(H1,o.fi,o.id);let r=0,s=0;t.shared.penumbraSize&&t.scene.objects.traverse((o,a)=>{a.type==="DirectionalLight"?(a.penumbraSize=t.shared.penumbraSize[Math.min(r,2)],r+=1):a.type==="SpotLight"&&(a.penumbraSize=t.shared.penumbraSize[3+Math.min(s,1)],s+=1),(a.physics===void 0||a.physics===null)&&a.type!=="Instance"&&(a.physics={},Object.assign(a.physics,W0.defaultData)),a.physics!==void 0&&(a.physics.enabled=a.collision??"visibility",delete a.collision)}),t.schema=99}}function m9(t){t.layers&&t.layers.forEach(e=>{e.type==="light"&&e.alphaOverride===void 0&&(e.alphaOverride=1)})}var g9=101;function BUe(t){let e=t.schema??0;e!==g9&&(console.warn("updating from ",e,"to ",g9),LUe(t,e),e<100&&(t.scene.publish.joystickSizeAndXYOffset===void 0&&(t.scene.publish.joystickSizeAndXYOffset=Xp.defaultData.joystickSizeAndXYOffset),t.schema=100),e<101&&(ad(t,m9),od(t,m9),t.schema=101))}function Mp(t,e=!1){let i=t[0].index!==null,n=new Set(Object.keys(t[0].attributes)),r=new Set(Object.keys(t[0].morphAttributes)),s={},o={},a=t[0].morphTargetsRelative,l=new Ut,c=0;for(let h=0;h<t.length;++h){let u=t[h],d=0;if(i!==(u.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let f in u.attributes){if(!n.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+'. All geometries must have compatible attributes; make sure "'+f+'" attribute exists among all geometries, or in none of them.'),null;s[f]===void 0&&(s[f]=[]),s[f].push(u.attributes[f]),d++}if(d!==n.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". Make sure all geometries have the same number of attributes."),null;if(a!==u.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let f in u.morphAttributes){if(!r.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+".  .morphAttributes must be consistent throughout all geometries."),null;o[f]===void 0&&(o[f]=[]),o[f].push(u.morphAttributes[f])}if(e){let f;if(i)f=u.index.count;else if(u.attributes.position!==void 0)f=u.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". The geometry must have either an index or a position attribute"),null;l.addGroup(c,f,h),c+=f}}if(i){let h=0,u=[];for(let d=0;d<t.length;++d){let f=t[d].index;for(let p=0;p<f.count;++p)u.push(f.getX(p)+h);h+=t[d].attributes.position.count}l.setIndex(u)}for(let h in s){let u=v9(s[h]);if(!u)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" attribute."),null;l.setAttribute(h,u)}for(let h in o){let u=o[h][0].length;if(u===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[h]=[];for(let d=0;d<u;++d){let f=[];for(let m=0;m<o[h].length;++m)f.push(o[h][m][d]);let p=v9(f);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" morphAttribute."),null;l.morphAttributes[h].push(p)}}return l}function v9(t){let e,i,n,r=0;for(let a=0;a<t.length;++a){let l=t[a];if(l.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(e===void 0&&(e=l.array.constructor),e!==l.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(i===void 0&&(i=l.itemSize),i!==l.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(n===void 0&&(n=l.normalized),n!==l.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;r+=l.array.length}let s=new e(r),o=0;for(let a=0;a<t.length;++a)s.set(t[a].array,o),o+=t[a].array.length;return new Gt(s,i,n)}var OUe=Math.pow(2,-24),RA=class{constructor(){}};function Pc(t,e,i){return i.min.x=e[t],i.min.y=e[t+1],i.min.z=e[t+2],i.max.x=e[t+3],i.max.y=e[t+4],i.max.z=e[t+5],i}function y9(t){let e=-1,i=-1/0;for(let n=0;n<3;n++){let r=t[n+3]-t[n];r>i&&(i=r,e=n)}return e}function x9(t,e){e.set(t)}function _9(t,e,i){let n,r;for(let s=0;s<3;s++){let o=s+3;n=t[s],r=e[s],i[s]=n<r?n:r,n=t[o],r=e[o],i[o]=n>r?n:r}}function IA(t,e,i){for(let n=0;n<3;n++){let r=e[t+2*n],s=e[t+2*n+1],o=r-s,a=r+s;o<i[n]&&(i[n]=o),a>i[n+3]&&(i[n+3]=a)}}function Cx(t){let e=t[3]-t[0],i=t[4]-t[1],n=t[5]-t[2];return 2*(e*i+i*n+n*e)}function FUe(t,e){if(!t.index){let i=t.attributes.position.count,n=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,r;i>65535?r=new Uint32Array(new n(4*i)):r=new Uint16Array(new n(2*i)),t.setIndex(new Gt(r,1));for(let s=0;s<i;s++)r[s]=s}}function NUe(t){if(!t.groups||!t.groups.length)return[{offset:0,count:t.index.count/3}];let e=[],i=new Set;for(let r of t.groups)i.add(r.start),i.add(r.start+r.count);let n=Array.from(i.values()).sort((r,s)=>r-s);for(let r=0;r<n.length-1;r++){let s=n[r],o=n[r+1];e.push({offset:s/3,count:(o-s)/3})}return e}function f3(t,e,i,n,r=null){let s=1/0,o=1/0,a=1/0,l=-1/0,c=-1/0,h=-1/0,u=1/0,d=1/0,f=1/0,p=-1/0,m=-1/0,v=-1/0,g=r!==null;for(let y=e*6,x=(e+i)*6;y<x;y+=6){let b=t[y+0],S=t[y+1],A=b-S,E=b+S;A<s&&(s=A),E>l&&(l=E),g&&b<u&&(u=b),g&&b>p&&(p=b);let M=t[y+2],T=t[y+3],P=M-T,R=M+T;P<o&&(o=P),R>c&&(c=R),g&&M<d&&(d=M),g&&M>m&&(m=M);let U=t[y+4],F=t[y+5],N=U-F,W=U+F;N<a&&(a=N),W>h&&(h=W),g&&U<f&&(f=U),g&&U>v&&(v=U)}n[0]=s,n[1]=o,n[2]=a,n[3]=l,n[4]=c,n[5]=h,g&&(r[0]=u,r[1]=d,r[2]=f,r[3]=p,r[4]=m,r[5]=v)}function UUe(t,e,i,n){let r=1/0,s=1/0,o=1/0,a=-1/0,l=-1/0,c=-1/0;for(let h=e*6,u=(e+i)*6;h<u;h+=6){let d=t[h+0];d<r&&(r=d),d>a&&(a=d);let f=t[h+2];f<s&&(s=f),f>l&&(l=f);let p=t[h+4];p<o&&(o=p),p>c&&(c=p)}n[0]=r,n[1]=s,n[2]=o,n[3]=a,n[4]=l,n[5]=c}function kUe(t,e,i,n,r){let s=i,o=i+n-1,a=r.pos,l=r.axis*2;for(;;){for(;s<=o&&e[s*6+l]<a;)s++;for(;s<=o&&e[o*6+l]>=a;)o--;if(s<o){for(let c=0;c<3;c++){let h=t[s*3+c];t[s*3+c]=t[o*3+c],t[o*3+c]=h;let u=e[s*6+c*2+0];e[s*6+c*2+0]=e[o*6+c*2+0],e[o*6+c*2+0]=u;let d=e[s*6+c*2+1];e[s*6+c*2+1]=e[o*6+c*2+1],e[o*6+c*2+1]=d}s++,o--}else return s}}var Pu=32,zUe=(t,e)=>t.candidate-e.candidate,Gh=new Array(Pu).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),LA=new Float32Array(6);function GUe(t,e,i,n,r,s){let o=-1,a=0;if(s===0)o=y9(e),o!==-1&&(a=(e[o]+e[o+3])/2);else if(s===1)o=y9(t),o!==-1&&(a=HUe(i,n,r,o));else if(s===2){let l=Cx(t),c=1.25*r,h=n*6,u=(n+r)*6;for(let d=0;d<3;d++){let f=e[d],p=(e[d+3]-f)/Pu;if(r<Pu/4){let m=[...Gh];m.length=r;let v=0;for(let y=h;y<u;y+=6,v++){let x=m[v];x.candidate=i[y+2*d],x.count=0;let{bounds:b,leftCacheBounds:S,rightCacheBounds:A}=x;for(let E=0;E<3;E++)A[E]=1/0,A[E+3]=-1/0,S[E]=1/0,S[E+3]=-1/0,b[E]=1/0,b[E+3]=-1/0;IA(y,i,b)}m.sort(zUe);let g=r;for(let y=0;y<g;y++){let x=m[y];for(;y+1<g&&m[y+1].candidate===x.candidate;)m.splice(y+1,1),g--}for(let y=h;y<u;y+=6){let x=i[y+2*d];for(let b=0;b<g;b++){let S=m[b];x>=S.candidate?IA(y,i,S.rightCacheBounds):(IA(y,i,S.leftCacheBounds),S.count++)}}for(let y=0;y<g;y++){let x=m[y],b=x.count,S=r-x.count,A=x.leftCacheBounds,E=x.rightCacheBounds,M=0;b!==0&&(M=Cx(A)/l);let T=0;S!==0&&(T=Cx(E)/l);let P=1+1.25*(M*b+T*S);P<c&&(o=d,c=P,a=x.candidate)}}else{for(let g=0;g<Pu;g++){let y=Gh[g];y.count=0,y.candidate=f+p+g*p;let x=y.bounds;for(let b=0;b<3;b++)x[b]=1/0,x[b+3]=-1/0}for(let g=h;g<u;g+=6){let y=~~((i[g+2*d]-f)/p);y>=Pu&&(y=Pu-1);let x=Gh[y];x.count++,IA(g,i,x.bounds)}let m=Gh[Pu-1];x9(m.bounds,m.rightCacheBounds);for(let g=Pu-2;g>=0;g--){let y=Gh[g],x=Gh[g+1];_9(y.bounds,x.rightCacheBounds,y.rightCacheBounds)}let v=0;for(let g=0;g<Pu-1;g++){let y=Gh[g],x=y.count,b=y.bounds,S=Gh[g+1].rightCacheBounds;x!==0&&(v===0?x9(b,LA):_9(b,LA,LA)),v+=x;let A=0,E=0;v!==0&&(A=Cx(LA)/l);let M=r-v;M!==0&&(E=Cx(S)/l);let T=1+1.25*(A*v+E*M);T<c&&(o=d,c=T,a=y.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${s} used.`);return{axis:o,pos:a}}function HUe(t,e,i,n){let r=0;for(let s=e,o=e+i;s<o;s++)r+=t[s*6+n*2];return r/i}function VUe(t,e){let i=t.attributes.position,n=t.index.array,r=n.length/3,s=new Float32Array(r*6),o=i.normalized,a=i.array,l=i.offset||0,c=3;i.isInterleavedBufferAttribute&&(c=i.data.stride);let h=["getX","getY","getZ"];for(let u=0;u<r;u++){let d=u*3,f=u*6,p,m,v;o?(p=n[d+0],m=n[d+1],v=n[d+2]):(p=n[d+0]*c+l,m=n[d+1]*c+l,v=n[d+2]*c+l);for(let g=0;g<3;g++){let y,x,b;o?(y=i[h[g]](p),x=i[h[g]](m),b=i[h[g]](v)):(y=a[p+g],x=a[m+g],b=a[v+g]);let S=y;x<S&&(S=x),b<S&&(S=b);let A=y;x>A&&(A=x),b>A&&(A=b);let E=(A-S)/2,M=g*2;s[f+M+0]=S+E,s[f+M+1]=E+(Math.abs(S)+E)*OUe,S<e[g]&&(e[g]=S),A>e[g+3]&&(e[g+3]=A)}}return s}function jUe(t,e){function i(g){d&&d(g/f)}function n(g,y,x,b=null,S=0){if(!p&&S>=l&&(p=!0,c&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(t))),x<=h||S>=l)return i(y+x),g.offset=y,g.count=x,g;let A=GUe(g.boundingData,b,o,y,x,u);if(A.axis===-1)return i(y+x),g.offset=y,g.count=x,g;let E=kUe(a,o,y,x,A);if(E===y||E===y+x)i(y+x),g.offset=y,g.count=x;else{g.splitAxis=A.axis;let M=new RA,T=y,P=E-y;g.left=M,M.boundingData=new Float32Array(6),f3(o,T,P,M.boundingData,s),n(M,T,P,s,S+1);let R=new RA,U=E,F=x-P;g.right=R,R.boundingData=new Float32Array(6),f3(o,U,F,R.boundingData,s),n(R,U,F,s,S+1)}return g}FUe(t,e);let r=new Float32Array(6),s=new Float32Array(6),o=VUe(t,r),a=t.index.array,l=e.maxDepth,c=e.verbose,h=e.maxLeafTris,u=e.strategy,d=e.onProgress,f=t.index.count/3,p=!1,m=[],v=NUe(t);if(v.length===1){let g=v[0],y=new RA;y.boundingData=r,UUe(o,g.offset,g.count,s),n(y,g.offset,g.count,s),m.push(y)}else for(let g of v){let y=new RA;y.boundingData=new Float32Array(6),f3(o,g.offset,g.count,y.boundingData,s),n(y,g.offset,g.count,s),m.push(y)}return m}function WUe(t,e){let i=jUe(t,e),n,r,s,o=[],a=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let h=0;h<i.length;h++){let u=i[h],d=l(u),f=new a(32*d);n=new Float32Array(f),r=new Uint32Array(f),s=new Uint16Array(f),c(0,u),o.push(f)}return o;function l(h){return h.count?1:1+l(h.left)+l(h.right)}function c(h,u){let d=h/4,f=h/2,p=!!u.count,m=u.boundingData;for(let v=0;v<6;v++)n[d+v]=m[v];if(p){let v=u.offset,g=u.count;return r[d+6]=v,s[f+14]=g,s[f+15]=65535,h+32}else{let v=u.left,g=u.right,y=u.splitAxis,x;if(x=c(h+32,v),x/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return r[d+6]=x/4,x=c(x,g),r[d+7]=y,x}}}var ph=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,i){let n=1/0,r=-1/0;for(let s=0,o=e.length;s<o;s++){let a=e[s][i];n=a<n?a:n,r=a>r?a:r}this.min=n,this.max=r}setFromPoints(e,i){let n=1/0,r=-1/0;for(let s=0,o=i.length;s<o;s++){let a=i[s],l=e.dot(a);n=l<n?l:n,r=l>r?l:r}this.min=n,this.max=r}isSeparated(e){return this.min>e.max||e.min>this.max}};ph.prototype.setFromBox=function(){let t=new L;return function(e,i){let n=i.min,r=i.max,s=1/0,o=-1/0;for(let a=0;a<=1;a++)for(let l=0;l<=1;l++)for(let c=0;c<=1;c++){t.x=n.x*a+r.x*(1-a),t.y=n.y*l+r.y*(1-l),t.z=n.z*c+r.z*(1-c);let h=e.dot(t);s=Math.min(h,s),o=Math.max(h,o)}this.min=s,this.max=o}}();var XUe=function(){let t=new L,e=new L,i=new L;return function(n,r,s){let o=n.start,a=t,l=r.start,c=e;i.subVectors(o,l),t.subVectors(n.end,n.start),e.subVectors(r.end,r.start);let h=i.dot(c),u=c.dot(a),d=c.dot(c),f=i.dot(a),p=a.dot(a)*d-u*u,m,v;p!==0?m=(h*u-f*d)/p:m=0,v=(h+m*u)/d,s.x=m,s.y=v}}(),Zk=function(){let t=new he,e=new L,i=new L;return function(n,r,s,o){XUe(n,r,t);let a=t.x,l=t.y;if(a>=0&&a<=1&&l>=0&&l<=1){n.at(a,s),r.at(l,o);return}else if(a>=0&&a<=1){l<0?r.at(0,o):r.at(1,o),n.closestPointToPoint(o,!0,s);return}else if(l>=0&&l<=1){a<0?n.at(0,s):n.at(1,s),r.closestPointToPoint(s,!0,o);return}else{let c;a<0?c=n.start:c=n.end;let h;l<0?h=r.start:h=r.end;let u=e,d=i;if(n.closestPointToPoint(h,!0,e),r.closestPointToPoint(c,!0,i),u.distanceToSquared(h)<=d.distanceToSquared(c)){s.copy(u),o.copy(h);return}else{s.copy(c),o.copy(d);return}}}}(),qUe=function(){let t=new L,e=new L,i=new zo,n=new Ya;return function(r,s){let{radius:o,center:a}=r,{a:l,b:c,c:h}=s;if(n.start=l,n.end=c,n.closestPointToPoint(a,!0,t).distanceTo(a)<=o||(n.start=l,n.end=h,n.closestPointToPoint(a,!0,t).distanceTo(a)<=o)||(n.start=c,n.end=h,n.closestPointToPoint(a,!0,t).distanceTo(a)<=o))return!0;let u=s.getPlane(i);if(Math.abs(u.distanceToPoint(a))<=o){let d=u.projectPoint(a,e);if(s.containsPoint(d))return!0}return!1}}(),YUe=1e-15;function Dg(t){return Math.abs(t)<YUe}var mh=class extends xs{constructor(...t){super(...t),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new L),this.satBounds=new Array(4).fill().map(()=>new ph),this.points=[this.a,this.b,this.c],this.sphere=new sa,this.plane=new zo,this.needsUpdate=!0}intersectsSphere(t){return qUe(t,this)}update(){let t=this.a,e=this.b,i=this.c,n=this.points,r=this.satAxes,s=this.satBounds,o=r[0],a=s[0];this.getNormal(o),a.setFromPoints(o,n);let l=r[1],c=s[1];l.subVectors(t,e),c.setFromPoints(l,n);let h=r[2],u=s[2];h.subVectors(e,i),u.setFromPoints(h,n);let d=r[3],f=s[3];d.subVectors(i,t),f.setFromPoints(d,n),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(o,t),this.needsUpdate=!1}};mh.prototype.closestPointToSegment=function(){let t=new L,e=new L,i=new Ya;return function(n,r=null,s=null){let{start:o,end:a}=n,l=this.points,c,h=1/0;for(let u=0;u<3;u++){let d=(u+1)%3;i.start.copy(l[u]),i.end.copy(l[d]),Zk(i,n,t,e),c=t.distanceToSquared(e),c<h&&(h=c,r&&r.copy(t),s&&s.copy(e))}return this.closestPointToPoint(o,t),c=o.distanceToSquared(t),c<h&&(h=c,r&&r.copy(t),s&&s.copy(o)),this.closestPointToPoint(a,t),c=a.distanceToSquared(t),c<h&&(h=c,r&&r.copy(t),s&&s.copy(a)),Math.sqrt(h)}}();mh.prototype.intersectsTriangle=function(){let t=new mh,e=new Array(3),i=new Array(3),n=new ph,r=new ph,s=new L,o=new L,a=new L,l=new L,c=new Ya,h=new Ya,u=new Ya;return function(d,f=null,p=!1){this.needsUpdate&&this.update(),d.isExtendedTriangle?d.needsUpdate&&d.update():(t.copy(d),t.update(),d=t);let m=this.plane,v=d.plane;if(Math.abs(m.normal.dot(v.normal))>1-1e-10){let g=this.satBounds,y=this.satAxes;i[0]=d.a,i[1]=d.b,i[2]=d.c;for(let S=0;S<4;S++){let A=g[S],E=y[S];if(n.setFromPoints(E,i),A.isSeparated(n))return!1}let x=d.satBounds,b=d.satAxes;e[0]=this.a,e[1]=this.b,e[2]=this.c;for(let S=0;S<4;S++){let A=x[S],E=b[S];if(n.setFromPoints(E,e),A.isSeparated(n))return!1}for(let S=0;S<4;S++){let A=y[S];for(let E=0;E<4;E++){let M=b[E];if(s.crossVectors(A,M),n.setFromPoints(s,e),r.setFromPoints(s,i),n.isSeparated(r))return!1}}return f&&(p||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),f.start.set(0,0,0),f.end.set(0,0,0)),!0}else{let g=this.points,y=!1,x=0;for(let F=0;F<3;F++){let N=g[F],W=g[(F+1)%3];c.start.copy(N),c.end.copy(W),c.delta(o);let Q=y?h.start:h.end,X=Dg(v.distanceToPoint(N));if(Dg(v.normal.dot(o))&&X){h.copy(c),x=2;break}if((v.intersectLine(c,Q)||X)&&!Dg(Q.distanceTo(W))){if(x++,y)break;y=!0}}if(x===1&&d.containsPoint(h.end))return f&&(f.start.copy(h.end),f.end.copy(h.end)),!0;if(x!==2)return!1;let b=d.points,S=!1,A=0;for(let F=0;F<3;F++){let N=b[F],W=b[(F+1)%3];c.start.copy(N),c.end.copy(W),c.delta(a);let Q=S?u.start:u.end,X=Dg(m.distanceToPoint(N));if(Dg(m.normal.dot(a))&&X){u.copy(c),A=2;break}if((m.intersectLine(c,Q)||X)&&!Dg(Q.distanceTo(W))){if(A++,S)break;S=!0}}if(A===1&&this.containsPoint(u.end))return f&&(f.start.copy(u.end),f.end.copy(u.end)),!0;if(A!==2)return!1;if(h.delta(o),u.delta(a),o.dot(a)<0){let F=u.start;u.start=u.end,u.end=F}let E=h.start.dot(o),M=h.end.dot(o),T=u.start.dot(o),P=u.end.dot(o),R=M<T,U=E<P;return E!==P&&T!==M&&R===U?!1:(f&&(l.subVectors(h.start,u.start),l.dot(o)>0?f.start.copy(h.start):f.start.copy(u.start),l.subVectors(h.end,u.end),l.dot(o)<0?f.end.copy(h.end):f.end.copy(u.end)),!0)}}}();mh.prototype.distanceToPoint=function(){let t=new L;return function(e){return this.closestPointToPoint(e,t),e.distanceTo(t)}}();mh.prototype.distanceToTriangle=function(){let t=new L,e=new L,i=["a","b","c"],n=new Ya,r=new Ya;return function(s,o=null,a=null){let l=o||a?n:null;if(this.intersectsTriangle(s,l))return(o||a)&&(o&&l.getCenter(o),a&&l.getCenter(a)),0;let c=1/0;for(let h=0;h<3;h++){let u,d=i[h],f=s[d];this.closestPointToPoint(f,t),u=f.distanceToSquared(t),u<c&&(c=u,o&&o.copy(t),a&&a.copy(f));let p=this[d];s.closestPointToPoint(p,t),u=p.distanceToSquared(t),u<c&&(c=u,o&&o.copy(p),a&&a.copy(t))}for(let h=0;h<3;h++){let u=i[h],d=i[(h+1)%3];n.set(this[u],this[d]);for(let f=0;f<3;f++){let p=i[f],m=i[(f+1)%3];r.set(s[p],s[m]),Zk(n,r,t,e);let v=t.distanceToSquared(e);v<c&&(c=v,o&&o.copy(t),a&&a.copy(e))}}return Math.sqrt(c)}}();var Jc=class{constructor(t,e,i){this.isOrientedBox=!0,this.min=new L,this.max=new L,this.matrix=new $e,this.invMatrix=new $e,this.points=new Array(8).fill().map(()=>new L),this.satAxes=new Array(3).fill().map(()=>new L),this.satBounds=new Array(3).fill().map(()=>new ph),this.alignedSatBounds=new Array(3).fill().map(()=>new ph),this.needsUpdate=!1,t&&this.min.copy(t),e&&this.max.copy(e),i&&this.matrix.copy(i)}set(t,e,i){this.min.copy(t),this.max.copy(e),this.matrix.copy(i),this.needsUpdate=!0}copy(t){this.min.copy(t.min),this.max.copy(t.max),this.matrix.copy(t.matrix),this.needsUpdate=!0}};Jc.prototype.update=function(){return function(){let t=this.matrix,e=this.min,i=this.max,n=this.points;for(let l=0;l<=1;l++)for(let c=0;c<=1;c++)for(let h=0;h<=1;h++){let u=1*l|2*c|4*h,d=n[u];d.x=l?i.x:e.x,d.y=c?i.y:e.y,d.z=h?i.z:e.z,d.applyMatrix4(t)}let r=this.satBounds,s=this.satAxes,o=n[0];for(let l=0;l<3;l++){let c=s[l],h=r[l],u=1<<l,d=n[u];c.subVectors(o,d),h.setFromPoints(c,n)}let a=this.alignedSatBounds;a[0].setFromPointsField(n,"x"),a[1].setFromPointsField(n,"y"),a[2].setFromPointsField(n,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();Jc.prototype.intersectsBox=function(){let t=new ph;return function(e){this.needsUpdate&&this.update();let i=e.min,n=e.max,r=this.satBounds,s=this.satAxes,o=this.alignedSatBounds;if(t.min=i.x,t.max=n.x,o[0].isSeparated(t)||(t.min=i.y,t.max=n.y,o[1].isSeparated(t))||(t.min=i.z,t.max=n.z,o[2].isSeparated(t)))return!1;for(let a=0;a<3;a++){let l=s[a],c=r[a];if(t.setFromBox(l,e),c.isSeparated(t))return!1}return!0}}();Jc.prototype.intersectsTriangle=function(){let t=new mh,e=new Array(3),i=new ph,n=new ph,r=new L;return function(s){this.needsUpdate&&this.update(),s.isExtendedTriangle?s.needsUpdate&&s.update():(t.copy(s),t.update(),s=t);let o=this.satBounds,a=this.satAxes;e[0]=s.a,e[1]=s.b,e[2]=s.c;for(let u=0;u<3;u++){let d=o[u],f=a[u];if(i.setFromPoints(f,e),d.isSeparated(i))return!1}let l=s.satBounds,c=s.satAxes,h=this.points;for(let u=0;u<3;u++){let d=l[u],f=c[u];if(i.setFromPoints(f,h),d.isSeparated(i))return!1}for(let u=0;u<3;u++){let d=a[u];for(let f=0;f<4;f++){let p=c[f];if(r.crossVectors(d,p),i.setFromPoints(r,e),n.setFromPoints(r,h),i.isSeparated(n))return!1}}return!0}}();Jc.prototype.closestPointToPoint=function(){return function(t,e){return this.needsUpdate&&this.update(),e.copy(t).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),e}}();Jc.prototype.distanceToPoint=function(){let t=new L;return function(e){return this.closestPointToPoint(e,t),e.distanceTo(t)}}();Jc.prototype.distanceToBox=function(){let t=["x","y","z"],e=new Array(12).fill().map(()=>new Ya),i=new Array(12).fill().map(()=>new Ya),n=new L,r=new L;return function(s,o=0,a=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(s))return(a||l)&&(s.getCenter(r),this.closestPointToPoint(r,n),s.closestPointToPoint(n,r),a&&a.copy(n),l&&l.copy(r)),0;let c=o*o,h=s.min,u=s.max,d=this.points,f=1/0;for(let m=0;m<8;m++){let v=d[m];r.copy(v).clamp(h,u);let g=v.distanceToSquared(r);if(g<f&&(f=g,a&&a.copy(v),l&&l.copy(r),g<c))return Math.sqrt(g)}let p=0;for(let m=0;m<3;m++)for(let v=0;v<=1;v++)for(let g=0;g<=1;g++){let y=(m+1)%3,x=(m+2)%3,b=v<<y|g<<x,S=1<<m|v<<y|g<<x,A=d[b],E=d[S];e[p].set(A,E);let M=t[m],T=t[y],P=t[x],R=i[p],U=R.start,F=R.end;U[M]=h[M],U[T]=v?h[T]:u[T],U[P]=g?h[P]:u[T],F[M]=u[M],F[T]=v?h[T]:u[T],F[P]=g?h[P]:u[T],p++}for(let m=0;m<=1;m++)for(let v=0;v<=1;v++)for(let g=0;g<=1;g++){r.x=m?u.x:h.x,r.y=v?u.y:h.y,r.z=g?u.z:h.z,this.closestPointToPoint(r,n);let y=r.distanceToSquared(n);if(y<f&&(f=y,a&&a.copy(n),l&&l.copy(r),y<c))return Math.sqrt(y)}for(let m=0;m<12;m++){let v=e[m];for(let g=0;g<12;g++){let y=i[g];Zk(v,y,n,r);let x=n.distanceToSquared(r);if(x<f&&(f=x,a&&a.copy(n),l&&l.copy(r),x<c))return Math.sqrt(x)}}return Math.sqrt(f)}}();var Rg=new L,Ig=new L,Lg=new L,BA=new he,OA=new he,FA=new he,w9=new L,b9=new L,S9=new L,NA=new L;function QUe(t,e,i,n,r,s){let o;return s===kr?o=t.intersectTriangle(n,i,e,!0,r):o=t.intersectTriangle(e,i,n,s!==Wo,r),o===null?null:{distance:t.origin.distanceTo(r),point:r.clone()}}function KUe(t,e,i,n,r,s,o,a,l){Rg.fromBufferAttribute(e,s),Ig.fromBufferAttribute(e,o),Lg.fromBufferAttribute(e,a);let c=QUe(t,Rg,Ig,Lg,NA,l);if(c){n&&(BA.fromBufferAttribute(n,s),OA.fromBufferAttribute(n,o),FA.fromBufferAttribute(n,a),c.uv=xs.getInterpolation(NA,Rg,Ig,Lg,BA,OA,FA,new he)),r&&(BA.fromBufferAttribute(r,s),OA.fromBufferAttribute(r,o),FA.fromBufferAttribute(r,a),c.uv1=xs.getInterpolation(NA,Rg,Ig,Lg,BA,OA,FA,new he)),i&&(w9.fromBufferAttribute(i,s),b9.fromBufferAttribute(i,o),S9.fromBufferAttribute(i,a),c.normal=xs.getInterpolation(NA,Rg,Ig,Lg,w9,b9,S9,new L),c.normal.dot(t.direction)>0&&c.normal.multiplyScalar(-1));let h={a:s,b:o,c:a,normal:new L,materialIndex:0};xs.getNormal(Rg,Ig,Lg,h.normal),c.face=h,c.faceIndex=s}return c}function xie(t,e,i,n,r){let s=n*3,o=t.index.getX(s),a=t.index.getX(s+1),l=t.index.getX(s+2),{position:c,normal:h,uv:u,uv1:d}=t.attributes,f=KUe(i,c,h,u,d,o,a,l,e);return f?(f.faceIndex=n,r&&r.push(f),f):null}function JUe(t,e,i,n,r,s){for(let o=n,a=n+r;o<a;o++)xie(t,e,i,o,s)}function ZUe(t,e,i,n,r){let s=1/0,o=null;for(let a=n,l=n+r;a<l;a++){let c=xie(t,e,i,a);c&&c.distance<s&&(o=c,s=c.distance)}return o}function Sc(t,e,i,n){let r=t.a,s=t.b,o=t.c,a=e,l=e+1,c=e+2;i&&(a=i.getX(e),l=i.getX(e+1),c=i.getX(e+2)),r.x=n.getX(a),r.y=n.getY(a),r.z=n.getZ(a),s.x=n.getX(l),s.y=n.getY(l),s.z=n.getZ(l),o.x=n.getX(c),o.y=n.getY(c),o.z=n.getZ(c)}function A9(t,e,i,n,r,s,o){let a=i.index,l=i.attributes.position;for(let c=t,h=e+t;c<h;c++)if(Sc(o,c*3,a,l),o.needsUpdate=!0,n(o,c,r,s))return!0;return!1}var _ie=class{constructor(t){this._getNewPrimitive=t,this._primitives=[]}getPrimitive(){let t=this._primitives;return t.length===0?this._getNewPrimitive():t.pop()}releasePrimitive(t){this._primitives.push(t)}};function ld(t,e){return e[t+15]===65535}function Kv(t,e){return e[t+6]}function Z_(t,e){return e[t+14]}function $_(t){return t+8}function ew(t,e){return e[t+6]}function $Ue(t,e){return e[t+7]}var Pv=new Zn,IT=new L,eke=["x","y","z"];function IO(t,e,i,n,r){let s=t*2,o=wy,a=Gd,l=Hd;if(ld(s,a)){let c=Kv(t,l),h=Z_(s,a);JUe(e,i,n,c,h,r)}else{let c=$_(t);LT(c,o,n,IT)&&IO(c,e,i,n,r);let h=ew(t,l);LT(h,o,n,IT)&&IO(h,e,i,n,r)}}function LO(t,e,i,n){let r=t*2,s=wy,o=Gd,a=Hd;if(ld(r,o)){let l=Kv(t,a),c=Z_(r,o);return ZUe(e,i,n,l,c)}else{let l=$Ue(t,a),c=eke[l],h=n.direction[c]>=0,u,d;h?(u=$_(t),d=ew(t,a)):(u=ew(t,a),d=$_(t));let f=LT(u,s,n,IT)?LO(u,e,i,n):null;if(f){let m=f.point[c];if(h?m<=s[d+l]:m>=s[d+l+3])return f}let p=LT(d,s,n,IT)?LO(d,e,i,n):null;return f&&p?f.distance<=p.distance?f:p:f||p||null}}var tke=function(){let t,e,i=[],n=new _ie(()=>new Zn);return function(...s){t=n.getPrimitive(),e=n.getPrimitive(),i.push(t,e);let o=r(...s);n.releasePrimitive(t),n.releasePrimitive(e),i.pop(),i.pop();let a=i.length;return a>0&&(e=i[a-1],t=i[a-2]),o};function r(s,o,a,l,c=null,h=0,u=0){function d(y){let x=y*2,b=Gd,S=Hd;for(;!ld(x,b);)y=$_(y),x=y*2;return Kv(y,S)}function f(y){let x=y*2,b=Gd,S=Hd;for(;!ld(x,b);)y=ew(y,S),x=y*2;return Kv(y,S)+Z_(x,b)}let p=s*2,m=wy,v=Gd,g=Hd;if(ld(p,v)){let y=Kv(s,g),x=Z_(p,v);return Pc(s,m,t),l(y,x,!1,u,h+s,t)}else{let y=$_(s),x=ew(s,g),b=y,S=x,A,E,M,T;if(c&&(M=t,T=e,Pc(b,m,M),Pc(S,m,T),A=c(M),E=c(T),E<A)){b=x,S=y;let Q=A;A=E,E=Q,M=T}M||(M=t,Pc(b,m,M));let P=ld(b*2,v),R=a(M,P,A,u+1,h+b),U;if(R===2){let Q=d(b),X=f(b)-Q;U=l(Q,X,!0,u+1,h+b,M)}else U=R&&r(b,o,a,l,c,h,u+1);if(U)return!0;T=e,Pc(S,m,T);let F=ld(S*2,v),N=a(T,F,E,u+1,h+S),W;if(N===2){let Q=d(S),X=f(S)-Q;W=l(Q,X,!0,u+1,h+S,T)}else W=N&&r(S,o,a,l,c,h,u+1);return!!W}}}(),ike=function(){let t=new mh,e=new mh,i=new $e,n=new Jc,r=new Jc;return function s(o,a,l,c,h=null){let u=o*2,d=wy,f=Gd,p=Hd;if(h===null&&(l.boundingBox||l.computeBoundingBox(),n.set(l.boundingBox.min,l.boundingBox.max,c),h=n),ld(u,f)){let m=a,v=m.index,g=m.attributes.position,y=l.index,x=l.attributes.position,b=Kv(o,p),S=Z_(u,f);if(i.copy(c).invert(),l.boundsTree)return Pc(o,d,r),r.matrix.copy(i),r.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:A=>r.intersectsBox(A),intersectsTriangle:A=>{A.a.applyMatrix4(c),A.b.applyMatrix4(c),A.c.applyMatrix4(c),A.needsUpdate=!0;for(let E=b*3,M=(S+b)*3;E<M;E+=3)if(Sc(e,E,v,g),e.needsUpdate=!0,A.intersectsTriangle(e))return!0;return!1}});for(let A=b*3,E=S+b*3;A<E;A+=3){Sc(t,A,v,g),t.a.applyMatrix4(i),t.b.applyMatrix4(i),t.c.applyMatrix4(i),t.needsUpdate=!0;for(let M=0,T=y.count;M<T;M+=3)if(Sc(e,M,y,x),e.needsUpdate=!0,t.intersectsTriangle(e))return!0}}else{let m=o+8,v=p[o+6];return Pc(m,d,Pv),!!(h.intersectsBox(Pv)&&s(m,a,l,c,h)||(Pc(v,d,Pv),h.intersectsBox(Pv)&&s(v,a,l,c,h)))}}}();function LT(t,e,i,n){return Pc(t,e,Pv),i.intersectBox(Pv,n)}var BO=[],YM,wy,Gd,Hd;function l1(t){YM&&BO.push(YM),YM=t,wy=new Float32Array(t),Gd=new Uint16Array(t),Hd=new Uint32Array(t)}function UA(){YM=null,wy=null,Gd=null,Hd=null,BO.length&&l1(BO.pop())}var p3=Symbol("skip tree generation"),m3=new Zn,g3=new Zn,Bg=new $e,Vf=new Jc,Px=new Jc,Dx=new L,kA=new L,nke=new L,rke=new L,ske=new L,M9=new Zn,lc=new _ie(()=>new mh),V1=class{static serialize(t,e={}){if(e.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),V1.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0?!0:arguments[2]});e={cloneBuffers:!0,...e};let i=t.geometry,n=t._roots,r=i.getIndex(),s;return e.cloneBuffers?s={roots:n.map(o=>o.slice()),index:r.array.slice()}:s={roots:n,index:r.array},s}static deserialize(t,e,i={}){if(typeof i=="boolean")return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),V1.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0?!0:arguments[2]});i={setIndex:!0,...i};let{index:n,roots:r}=t,s=new V1(e,{...i,[p3]:!0});if(s._roots=r,i.setIndex){let o=e.getIndex();if(o===null){let a=new Gt(t.index,1,!1);e.setIndex(a)}else o.array!==n&&(o.array.set(n),o.needsUpdate=!0)}return s}constructor(t,e={}){if(t.isBufferGeometry){if(t.index&&t.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[p3]:!1},e),e.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,e[p3]||(this._roots=WUe(t,e),!t.boundingBox&&e.setBoundingBox&&(t.boundingBox=this.getBoundingBox(new Zn))),this.geometry=t}refit(t=null){t&&Array.isArray(t)&&(t=new Set(t));let e=this.geometry,i=e.index.array,n=e.attributes.position,r,s,o,a,l=0,c=this._roots;for(let u=0,d=c.length;u<d;u++)r=c[u],s=new Uint32Array(r),o=new Uint16Array(r),a=new Float32Array(r),h(0,l),l+=r.byteLength;function h(u,d,f=!1){let p=u*2;if(o[p+15]===65535){let m=s[u+6],v=o[p+14],g=1/0,y=1/0,x=1/0,b=-1/0,S=-1/0,A=-1/0;for(let E=3*m,M=3*(m+v);E<M;E++){let T=i[E],P=n.getX(T),R=n.getY(T),U=n.getZ(T);P<g&&(g=P),P>b&&(b=P),R<y&&(y=R),R>S&&(S=R),U<x&&(x=U),U>A&&(A=U)}return a[u+0]!==g||a[u+1]!==y||a[u+2]!==x||a[u+3]!==b||a[u+4]!==S||a[u+5]!==A?(a[u+0]=g,a[u+1]=y,a[u+2]=x,a[u+3]=b,a[u+4]=S,a[u+5]=A,!0):!1}else{let m=u+8,v=s[u+6],g=m+d,y=v+d,x=f,b=!1,S=!1;t?x||(b=t.has(g),S=t.has(y),x=!b&&!S):(b=!0,S=!0);let A=x||b,E=x||S,M=!1;A&&(M=h(m,d,x));let T=!1;E&&(T=h(v,d,x));let P=M||T;if(P)for(let R=0;R<3;R++){let U=m+R,F=v+R,N=a[U],W=a[U+3],Q=a[F],X=a[F+3];a[u+R]=N<Q?N:Q,a[u+R+3]=W>X?W:X}return P}}}traverse(t,e=0){let i=this._roots[e],n=new Uint32Array(i),r=new Uint16Array(i);s(0);function s(o,a=0){let l=o*2,c=r[l+15]===65535;if(c){let h=n[o+6],u=r[l+14];t(a,c,new Float32Array(i,o*4,6),h,u)}else{let h=o+8,u=n[o+6],d=n[o+7];t(a,c,new Float32Array(i,o*4,6),d)||(s(h,a+1),s(u,a+1))}}}raycast(t,e=Hl){let i=this._roots,n=this.geometry,r=[],s=e.isMaterial,o=Array.isArray(e),a=n.groups,l=s?e.side:e;for(let c=0,h=i.length;c<h;c++){let u=o?e[a[c].materialIndex].side:l,d=r.length;if(l1(i[c]),IO(0,n,u,t,r),UA(),o){let f=a[c].materialIndex;for(let p=d,m=r.length;p<m;p++)r[p].face.materialIndex=f}}return r}raycastFirst(t,e=Hl){let i=this._roots,n=this.geometry,r=e.isMaterial,s=Array.isArray(e),o=null,a=n.groups,l=r?e.side:e;for(let c=0,h=i.length;c<h;c++){let u=s?e[a[c].materialIndex].side:l;l1(i[c]);let d=LO(0,n,u,t);UA(),d!=null&&(o==null||d.distance<o.distance)&&(o=d,s&&(d.face.materialIndex=a[c].materialIndex))}return o}intersectsGeometry(t,e){let i=this.geometry,n=!1;for(let r of this._roots)if(l1(r),n=ike(0,i,t,e),UA(),n)break;return n}shapecast(t,e,i){let n=this.geometry;if(t instanceof Function){if(e){let u=e;e=(d,f,p,m)=>{let v=f*3;return u(d,v,v+1,v+2,p,m)}}t={boundsTraverseOrder:i,intersectsBounds:t,intersectsTriangle:e,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let r=lc.getPrimitive(),{boundsTraverseOrder:s,intersectsBounds:o,intersectsRange:a,intersectsTriangle:l}=t;if(a&&l){let u=a;a=(d,f,p,m,v)=>u(d,f,p,m,v)?!0:A9(d,f,n,l,p,m,r)}else a||(l?a=(u,d,f,p)=>A9(u,d,n,l,f,p,r):a=(u,d,f)=>f);let c=!1,h=0;for(let u of this._roots){if(l1(u),c=tke(0,n,o,a,s,h),UA(),c)break;h+=u.byteLength}return lc.releasePrimitive(r),c}bvhcast(t,e,i){let{intersectsRanges:n,intersectsTriangles:r}=i,s=this.geometry.index,o=this.geometry.attributes.position,a=t.geometry.index,l=t.geometry.attributes.position;Bg.copy(e).invert();let c=lc.getPrimitive(),h=lc.getPrimitive();if(r){let d=function(f,p,m,v,g,y,x,b){for(let S=m,A=m+v;S<A;S++){Sc(h,S*3,a,l),h.a.applyMatrix4(e),h.b.applyMatrix4(e),h.c.applyMatrix4(e),h.needsUpdate=!0;for(let E=f,M=f+p;E<M;E++)if(Sc(c,E*3,s,o),c.needsUpdate=!0,r(c,h,E,S,g,y,x,b))return!0}return!1};if(n){let f=n;n=function(p,m,v,g,y,x,b,S){return f(p,m,v,g,y,x,b,S)?!0:d(p,m,v,g,y,x,b,S)}}else n=d}t.getBoundingBox(g3),g3.applyMatrix4(e);let u=this.shapecast({intersectsBounds:d=>g3.intersectsBox(d),intersectsRange:(d,f,p,m,v,g)=>(m3.copy(g),m3.applyMatrix4(Bg),t.shapecast({intersectsBounds:y=>m3.intersectsBox(y),intersectsRange:(y,x,b,S,A)=>n(d,f,y,x,m,v,S,A)}))});return lc.releasePrimitive(c),lc.releasePrimitive(h),u}intersectsBox(t,e){return Vf.set(t.min,t.max,e),Vf.needsUpdate=!0,this.shapecast({intersectsBounds:i=>Vf.intersectsBox(i),intersectsTriangle:i=>Vf.intersectsTriangle(i)})}intersectsSphere(t){return this.shapecast({intersectsBounds:e=>t.intersectsBox(e),intersectsTriangle:e=>e.intersectsSphere(t)})}closestPointToGeometry(t,e,i={},n={},r=0,s=1/0){t.boundingBox||t.computeBoundingBox(),Vf.set(t.boundingBox.min,t.boundingBox.max,e),Vf.needsUpdate=!0;let o=this.geometry,a=o.attributes.position,l=o.index,c=t.attributes.position,h=t.index,u=lc.getPrimitive(),d=lc.getPrimitive(),f=kA,p=nke,m=null,v=null;n&&(m=rke,v=ske);let g=1/0,y=null,x=null;return Bg.copy(e).invert(),Px.matrix.copy(Bg),this.shapecast({boundsTraverseOrder:b=>Vf.distanceToBox(b),intersectsBounds:(b,S,A)=>A<g&&A<s?(S&&(Px.min.copy(b.min),Px.max.copy(b.max),Px.needsUpdate=!0),!0):!1,intersectsRange:(b,S)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:A=>Px.distanceToBox(A),intersectsBounds:(A,E,M)=>M<g&&M<s,intersectsRange:(A,E)=>{for(let M=A*3,T=(A+E)*3;M<T;M+=3){Sc(d,M,h,c),d.a.applyMatrix4(e),d.b.applyMatrix4(e),d.c.applyMatrix4(e),d.needsUpdate=!0;for(let P=b*3,R=(b+S)*3;P<R;P+=3){Sc(u,P,l,a),u.needsUpdate=!0;let U=u.distanceToTriangle(d,f,m);if(U<g&&(p.copy(f),v&&v.copy(m),g=U,y=P/3,x=M/3),U<r)return!0}}}});{let A=h?h.count:c.count;for(let E=0,M=A;E<M;E+=3){Sc(d,E,h,c),d.a.applyMatrix4(e),d.b.applyMatrix4(e),d.c.applyMatrix4(e),d.needsUpdate=!0;for(let T=b*3,P=(b+S)*3;T<P;T+=3){Sc(u,T,l,a),u.needsUpdate=!0;let R=u.distanceToTriangle(d,f,m);if(R<g&&(p.copy(f),v&&v.copy(m),g=R,y=T/3,x=E/3),R<r)return!0}}}}}),lc.releasePrimitive(u),lc.releasePrimitive(d),g===1/0?null:(i.point?i.point.copy(p):i.point=p.clone(),i.distance=g,i.faceIndex=y,n&&(n.point?n.point.copy(v):n.point=v.clone(),n.point.applyMatrix4(Bg),p.applyMatrix4(Bg),n.distance=p.sub(n.point).length(),n.faceIndex=x),i)}closestPointToPoint(t,e={},i=0,n=1/0){let r=i*i,s=n*n,o=1/0,a=null;if(this.shapecast({boundsTraverseOrder:c=>(Dx.copy(t).clamp(c.min,c.max),Dx.distanceToSquared(t)),intersectsBounds:(c,h,u)=>u<o&&u<s,intersectsTriangle:(c,h)=>{c.closestPointToPoint(t,Dx);let u=t.distanceToSquared(Dx);return u<o&&(kA.copy(Dx),o=u,a=h),u<r}}),o===1/0)return null;let l=Math.sqrt(o);return e.point?e.point.copy(kA):e.point=kA.clone(),e.distance=l,e.faceIndex=a,e}getBoundingBox(t){return t.makeEmpty(),this._roots.forEach(e=>{Pc(0,new Float32Array(e),M9),t.union(M9)}),t}},Rx=Rw(TSe()),oke=.5*(Math.sqrt(3)-1),Ix=(3-Math.sqrt(3))/6,ake=1/3,cc=1/6,j1=t=>Math.floor(t)|0,E9=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),v3=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function y3(t=Math.random){let e=wie(t),i=new Float64Array(e).map(r=>E9[r%12*2]),n=new Float64Array(e).map(r=>E9[r%12*2+1]);return function(r,s){let o=0,a=0,l=0,c=(r+s)*oke,h=j1(r+c),u=j1(s+c),d=(h+u)*Ix,f=h-d,p=u-d,m=r-f,v=s-p,g,y;m>v?(g=1,y=0):(g=0,y=1);let x=m-g+Ix,b=v-y+Ix,S=m-1+2*Ix,A=v-1+2*Ix,E=h&255,M=u&255,T=.5-m*m-v*v;if(T>=0){let U=E+e[M],F=i[U],N=n[U];T*=T,o=T*T*(F*m+N*v)}let P=.5-x*x-b*b;if(P>=0){let U=E+g+e[M+y],F=i[U],N=n[U];P*=P,a=P*P*(F*x+N*b)}let R=.5-S*S-A*A;if(R>=0){let U=E+1+e[M+1],F=i[U],N=n[U];R*=R,l=R*R*(F*S+N*A)}return 70*(o+a+l)}}function lke(t=Math.random){let e=wie(t),i=new Float64Array(e).map(s=>v3[s%12*3]),n=new Float64Array(e).map(s=>v3[s%12*3+1]),r=new Float64Array(e).map(s=>v3[s%12*3+2]);return function(s,o,a){let l,c,h,u,d=(s+o+a)*ake,f=j1(s+d),p=j1(o+d),m=j1(a+d),v=(f+p+m)*cc,g=f-v,y=p-v,x=m-v,b=s-g,S=o-y,A=a-x,E,M,T,P,R,U;b>=S?S>=A?(E=1,M=0,T=0,P=1,R=1,U=0):b>=A?(E=1,M=0,T=0,P=1,R=0,U=1):(E=0,M=0,T=1,P=1,R=0,U=1):S<A?(E=0,M=0,T=1,P=0,R=1,U=1):b<A?(E=0,M=1,T=0,P=0,R=1,U=1):(E=0,M=1,T=0,P=1,R=1,U=0);let F=b-E+cc,N=S-M+cc,W=A-T+cc,Q=b-P+2*cc,X=S-R+2*cc,B=A-U+2*cc,j=b-1+3*cc,z=S-1+3*cc,k=A-1+3*cc,G=f&255,Z=p&255,K=m&255,re=.6-b*b-S*S-A*A;if(re<0)l=0;else{let fe=G+e[Z+e[K]];re*=re,l=re*re*(i[fe]*b+n[fe]*S+r[fe]*A)}let J=.6-F*F-N*N-W*W;if(J<0)c=0;else{let fe=G+E+e[Z+M+e[K+T]];J*=J,c=J*J*(i[fe]*F+n[fe]*N+r[fe]*W)}let le=.6-Q*Q-X*X-B*B;if(le<0)h=0;else{let fe=G+P+e[Z+R+e[K+U]];le*=le,h=le*le*(i[fe]*Q+n[fe]*X+r[fe]*B)}let ae=.6-j*j-z*z-k*k;if(ae<0)u=0;else{let fe=G+1+e[Z+1+e[K+1]];ae*=ae,u=ae*ae*(i[fe]*j+n[fe]*z+r[fe]*k)}return 32*(l+c+h+u)}}function wie(t){let e=new Uint8Array(512);for(let i=0;i<512/2;i++)e[i]=i;for(let i=0;i<512/2-1;i++){let n=i+~~(t()*(256-i)),r=e[i];e[i]=e[n],e[n]=r}for(let i=256;i<512;i++)e[i]=e[i-256];return e}var ml=new xs,cke=class{constructor(t){this.weightAttribute=null;let e=t.geometry;if(!e.isBufferGeometry||e.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");e.index&&(e=e.toNonIndexed()),this.geometry=e,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let t=this.positionAttribute,e=new Float32Array(t.count/3);for(let n=0;n<t.count;n+=3){let r=1;ml.a.fromBufferAttribute(t,n),ml.b.fromBufferAttribute(t,n+1),ml.c.fromBufferAttribute(t,n+2),r*=ml.getArea(),e[n/3]=r}this.distribution=new Float32Array(t.count/3);let i=0;for(let n=0;n<e.length;n++)i+=e[n],this.distribution[n]=i;return this}setRandomGenerator(t){return this.randomFunction=t,this}sample(t,e){if(this.distribution){let i=this.distribution[this.distribution.length-1],n=this.binarySearch(this.randomFunction()*i);return this.sampleFace(n,t,e)}}binarySearch(t){if(!this.distribution)return 0;let e=this.distribution,i=0,n=e.length-1,r=-1;for(;i<=n;){let s=Math.ceil((i+n)/2);if(s===0||e[s-1]<=t&&e[s]>t){r=s;break}else t<e[s]?n=s-1:i=s+1}return r}sampleFace(t,e,i){let n=this.randomFunction(),r=this.randomFunction();return n+r>1&&(n=1-n,r=1-r),ml.a.fromBufferAttribute(this.positionAttribute,t*3),ml.b.fromBufferAttribute(this.positionAttribute,t*3+1),ml.c.fromBufferAttribute(this.positionAttribute,t*3+2),e.set(0,0,0).addScaledVector(ml.a,n).addScaledVector(ml.b,r).addScaledVector(ml.c,1-(n+r)),ml.getNormal(i),this}},uke=Rw(uee()),hke=new $e,dke=new $e,fke=new $e,tw;(t=>{function e(i){return i&&i.__isSPEObject}t.is=e})(tw||(tw={}));var $k=t=>class extends t{constructor(){super(...arguments),this.previousModelViewMatrix=new $e,this.copyPreviousMatrix=!0,this.hiddenMatrix=new $e,this.matrixWorldRigid=new $e,this.shearScale=new $e,this.shearScaleInv=new $e}get __isSPEObject(){return!0}isDescendantOf(e){e instanceof ji&&(e=e.uuid);let i=this;for(;i.parent;){if(i.parent.uuid===e)return!0;i=i.parent}return!1}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);for(let i of this.children)i.updateMatrixWorld(e)}updateWorldMatrix(e,i){let n=this.parent;if(e&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),i)for(let r of this.children)r.updateWorldMatrix(!1,!0)}traverseChildren(e,i=0){for(let n of this.children)tw.is(n)&&n.traverseObject(e,i+1)}traverseObject(e,i=0){if(e(this,i)!==!0)for(let n of this.children)tw.is(n)&&n.traverseObject(e,i+1)}updateMatrixWorldSVD(){let e=this.matrixWorld.elements,i=[[e[0],e[4],e[8]],[e[1],e[5],e[9]],[e[2],e[6],e[10]]],{u:n,v:r,q:s}=(0,uke.SVD)(i),o=hke.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),a=dke.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),l=fke.copy(a).transpose();this.shearScale.makeScale(s[0],s[1],s[2]).multiply(l).premultiply(a),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(o,l).copyPosition(this.matrixWorld),s.every(c=>Math.abs(s[0]-c)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(e,i){this.updateWorldMatrix(!0,!1);let n=new $e().copy(this.matrixWorld).invert();return e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),n.multiply(e.parent.matrixWorld)),"hiddenMatrix"in e&&e.hiddenMatrix instanceof $e?e.hiddenMatrix.premultiply(n):e.applyMatrix4(n),e.updateWorldMatrix(!1,!1),this.add(e),i!==void 0&&(this.children.pop(),this.children.splice(i,0,e)),this}copy(e,i=!1){return super.copy(e,i),this.hasNonUniformScale=e.hasNonUniformScale,this}onAfterRender(e,i,n,r,s,o){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},pke=class extends $k(ji){},mke=t=>t.type==="Mesh",_s=class extends pke{constructor(t){super(),this.object=t,this.matrixAutoUpdate=!1,this.hasNonUniformScale=t.hasNonUniformScale}raycast(t,e){}expand(){let t=0,e=this.object.entityChildren(t);for(;e;){let i=this.children[t];(i==null?void 0:i.object)!==e&&(i&&this.remove(i),i=new _s(e),this.add(i),this.children.splice(t,0,this.children.pop()),i.matrixWorldNeedsUpdate=!0,i.matrixAutoUpdate=!1,i.matrix=e.matrix,i.hiddenMatrix=e.hiddenMatrix),i.expand(),t+=1,e=this.object.entityChildren(t)}for(;this.children.length>t;)this.remove(this.children[t])}get visible(){var t;return this.playModeVisible!==void 0?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&((t=this.object.dataPatched.cloner)==null?void 0:t.hideBase)===!0}set visible(t){}get castShadow(){return this.object.castShadow}set castShadow(t){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(t){}get isMesh(){return mke(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(t){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},lp=new L,cp=new L,Jv=new $e,bie=[new L(-1,1,1),new L(-1,-1,1),new L(1,-1,1),new L(1,1,1),new L(-1,1,-1),new L(-1,-1,-1),new L(1,-1,-1),new L(1,1,-1)],gke=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],vke=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],T9=(t,e,i)=>{t.updateEntityBoxSize(lp,cp),Jv.copy(e).multiply(t.matrixWorld),cp.x===0&&cp.y===0&&cp.z===0?i.push(new L(lp.x,lp.y,lp.z).applyMatrix4(Jv)):bie.forEach(n=>{i.push(n.clone().multiply(cp).add(lp).applyMatrix4(Jv))})},C9=class extends Zn{constructor(){super(...arguments),this.matrix=new $e,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(t){return super.copy(t),this.matrix.copy(t.matrix),this.vertices=t.vertices.map(e=>e.clone()),this.faces=t.faces.map(e=>e.clone()),this.edges=t.edges.map(e=>e.clone()),this.centerEdges=t.centerEdges.map(e=>e.clone()),this}setFromObjectSize(t,e=!1){t.updateWorldMatrix(!1,e),this.makeEmpty(),this.matrix.copy(t.matrixWorld);let i=new $e().copy(t.matrixWorld).invert();return this.expandByObjectSize(t,i,e)}expandByObjectSize(t,e,i=!1){let n=[];return i===!0?t.traverseEntity(r=>{if(r.visible||r.cloner&&r.data.visible){if(!("geometry"in r)){n.push(new L);return}T9(r,e,n)}}):T9(t,e,n),this.setFromPoints(n)}getCenter(t){return t=super.getCenter(t),t.applyMatrix4(this.matrix),t}getPositionToCenter(t){return t=super.getCenter(t),t.applyMatrix4(Jv.copy(this.matrix).setPosition(0,0,0)),t}computeVertices(){this.getSize(cp).multiplyScalar(.5),this.getCenter(lp),Jv.copy(this.matrix).setPosition(lp),this.vertices=bie.map(t=>t.clone().multiply(cp).applyMatrix4(Jv))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=gke.map(([t,e])=>new Ya(this.vertices[t],this.vertices[e])),this.centerEdges=this.edges.map(t=>t.getCenter(new L))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=vke.map(([t,e])=>this.vertices[t].clone().add(this.vertices[e]).multiplyScalar(.5))}},yd={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},yke=class extends Uee{constructor(){super()}getPoints(t=12){let e=[],i,n=this.getCurveLengths(),r=n[n.length-1]/n.length;for(let s=0,o=this.curves;s<o.length;s++){let a=o[s],l=s===0?n[s]:n[s]-n[s-1],c=Math.ceil(t*l/r),h=a.getPoints(c);for(let u=0;u<h.length;u++){let d=h[u];i&&i.equals(d)||(e.push(d),i=d)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}},OO=.001;function FO(t,e,i){return e.clone().sub(t).cross(e.clone().sub(i)).length()<=OO}function x3(t,e){let i=new L(...t.position),n=new L(...t.controlNext.position),r=new L(...e.controlPrevious.position),s=new L(...e.position);return FO(i,n,s)&&FO(i,r,s)}function Sie(t){let e=t.points.map(h=>new L(...h.data.position)),i=[t.points[0]],n=new L(...i[0].data.position);for(let h=0;h<t.points.length-1;h++)FO(n,e[h],e[h+1])||(i.push(t.points[h]),n=e[h]);i.push(t.points[t.points.length-1]);let r=t.isClosed,s=i.length-(r?0:1),o=i.length,a=[];for(let h=0;h<o;h++){let u=i[h].data,d=new L(...u.position),f=new L(...u.controlPrevious.position),p=new L(...u.controlNext.position),m={position:d,baseRoundness:u.roundness,controlPrevious:f,controlNext:p};if(u.roundness===0||!t.isClosed&&(h===0||h===o-1)){a[h]={...m,removedLength:0};continue}let v=r&&h==0?o-1:h-1,g=r&&h==o-1?0:h+1,y=i[v].data,x=i[g].data,b=new L(...y.position),S=new L(...x.position),A=b.clone().sub(d).normalize(),E=S.clone().sub(d).normalize();Object.assign(m,{prevDir:A,nextDir:E});let M=x3(y,u),T=x3(u,x);if(!M||!T)a[h]={...m,removedLength:0};else{let P=A.clone().add(E).normalize(),R=P.clone().cross(A).length()/A.dot(P);a[h]={...m,tan:R,removedLength:u.roundness/R}}}for(let h=0;h<s;h++){let u=h,d=r&&h===o-1?0:h+1,f=a[u],p=a[d];if(f.removedLength!==0||p.removedLength!==0){let m=f.position.distanceTo(p.position);f.removedLength=Math.min(f.removedLength,m/2),p.removedLength=Math.min(p.removedLength,m/2)}}let l=[];for(let h=0;h<s;h++){let u=h,d=r&&h===o-1?0:h+1,f=a[u],p=a[d],m=null;if(!x3(i[u].data,i[d].data))f.position.distanceTo(p.position)>OO&&(m=new VM(f.position,f.controlNext,p.controlPrevious,p.position));else{let v=f.position.clone(),g=p.position.clone();(f.removedLength!==0||p.removedLength!==0)&&(f.nextDir&&v.add(f.nextDir.clone().setLength(f.removedLength)),p.prevDir&&g.add(p.prevDir.clone().setLength(p.removedLength))),v.distanceTo(g)>OO&&(m=new VM(v,v.clone().lerp(g,.3),g.clone().lerp(v,.3),g))}l[2*h+1]=m}for(let h=0;h<o;h++){let u=a[h];if(u.removedLength===0){l[2*h]=null;continue}let d=u.position,f=u.prevDir.clone().multiplyScalar(u.removedLength).add(d),p=u.nextDir.clone().multiplyScalar(u.removedLength).add(d),m=u.tan*u.removedLength,v=u.prevDir.clone().add(u.nextDir).normalize(),g=f.clone().lerp(p,.5),y=f.distanceTo(p)/2,x=v.clone().multiplyScalar(Math.sqrt(Math.pow(m,2)-Math.pow(y,2))).add(g),b=v.clone().multiplyScalar(-m).add(x),S=d.distanceTo(b)/d.distanceTo(g),A=u.prevDir.clone().multiplyScalar(S*d.distanceTo(f)).add(d),E=A.clone().lerp(b,2),M=f.clone().lerp(A,4/3),T=p.clone().lerp(E,4/3);l[2*h]=new VM(f,M,T,p)}let c=new yke;return l.forEach(h=>{h&&c.add(h)}),c}var xi;(t=>{function e(i){return i&&i.__isEntity}t.is=e})(xi||(xi={}));var zu=t=>xi.is(t),xke={type:"completeState",isfromEntity:!0},ez=t=>class extends $k(t){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new C9,this._recursiveBBox=new C9,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(e){let i=this.children[e];if(xi.is(i))return i}entityChildrenCount(){let e=this.children.length;for(;e--;)if(xi.is(this.children[e]))return e+1;return 0}get isConcreteEntity(){return typeof this.identity=="string"}get isVirtualEntity(){return typeof this.identity!="string"}get isInstanceRoot(){return this.isConcreteEntity&&this.data.type==="Instance"}nearestInstanceSelfOrParent(){let e=this;for(;e.data.type!=="Instance";){let i=e.parent;if(xi.is(i))e=i;else return}return e}forInstancesRec(e){this.instances.forEach(i=>{i.disposed||e(i),i.forInstancesRec(e)})}super_Entity(e,i){typeof e=="string"&&(this.uuid=e),this.identity=e,this.data=i,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(e,i,n=!1){if(!(this.data.states.length===0&&!n)){for(let r of this.data.states)Ap.toOps(this.data,r.data).forEach(s=>{let o=tO.replaceProps(s,this.data);this.dataPatched=this.data,this.updateByPatchedOp(o,this.data,i)});if(e!==null){let r=this.data.states.data(e);r&&(this.dataPatched=Ap.patch(this.data,r),Ap.toOps(this.data,r).forEach(s=>{this.updateByPatchedOp(s,this.dataPatched,i)}))}n&&this.updateTransformState(this.dataPatched),this.stateSelection=e,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(e,i){e.setScalar(0),i.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(e=>{zu(e)&&e.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(e=>{e.resetBBoxNeedsUpdateSelf()})}find(e){let i;return this.traverseEntity(n=>{n.uuid===e&&(i=n)}),i}traverseSortNextHelper(){let e=this.parent;if(e){let i=e.children,n=i.indexOf(this)+1;if(xi.is(i[n]))return i[n];if(xi.is(e))return e.traverseSortNextHelper()}}sortNext(){let e=this.children;return this.children.length>0&&xi.is(this.children[0])?e[0]:this.traverseSortNextHelper()}goUp(e){let i=this;for(;e>0&&i!==null;)i=i.parent,e-=1;return i}hasAnccestorOrSelf(e){return this===e||this.hasAnccestor(e)}hasAnccestor(e){let i=this.parent;for(;i;){if(e===i)return!0;i=i.parent}return!1}countToAccestor(e){let i=0,n=this;for(;n!==e;){if(n===null)return-1;n=n.parent,i+=1}return i}forEachEntity(e){for(let i of this.children)zu(i)&&e(i)}traverseEntityAncestors(e){this.traverseAncestors(i=>{xi.is(i)&&e(i)})}traverseConcreteEntity(e,i=0){if(e(this,i)!==!0)for(let n of this.children)zu(n)&&n.isConcreteEntity&&n.traverseEntity(e,i+1)}traverseEntity(e,i=0){if(e(this,i)!==!0)for(let n of this.children)zu(n)&&n.traverseEntity(e,i+1)}traverseVisibleEntity(e){e(this);for(let i of this.children)zu(i)&&i.visible&&i.traverseVisibleEntity(e)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}copy(e,i=!1){return super.copy(e,i),this.dataPatched=e.dataPatched,this.raycastLock=e.raycastLock,this.scaleLock=e.scaleLock,this.hiddenMatrix.copy(e.hiddenMatrix),this}hasEntityChild(){return this.children.some(e=>zu(e))}isAncestorOf(e){if(this.uuid===e)return!1;let i=!1;return this.traverseEntity(n=>{n.uuid===e&&(i=!0)}),i}toObjectTransformState(e=[]){this.updateWorldMatrix(!0,!1);let i={position:this.position.toArray(),rotation:[this.rotation.x,this.rotation.y,this.rotation.z],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return eO(i,e)}updateTransformState(e){let i=!1;return e.position&&(this.position.fromArray(e.position),i=!0),e.rotation&&(this.rotation.fromArray(e.rotation),i=!0),e.scale&&(i=!0,this.scale.fromArray(e.scale)),e.hiddenMatrix!==void 0&&(i=!0,this.hiddenMatrix.fromArray(e.hiddenMatrix??V0.identity)),i&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(n=>{n.invalidateClonerTransform(this)})),e.position&&e.rotation&&e.scale&&e.hiddenMatrix!==void 0&&this.updateWorldMatrix(!1,!0),i}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let e of this.children)xi.is(e)&&e.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(e=>{xi.is(e)&&e.disposeRecursively()})}toState(e=[]){let i={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(e)};return eO(i,e)}updateByObjUpdateOp(e,i){this.updateByOp({type:0,props:e,path:[]},{...this.data,...e},i,!1)}updateByOp(e,i,n,r){let s=this.data;this.data=i;let o=e,a=Ga(e.path,["states","*"]);if(a!==null){if(e.type===0){let[l]=a;if((this==null?void 0:this.stateSelection)===l){let c={...e.props};if(Object.values(e.props).some(h=>h===void 0)){let h=this.data;if(h!==void 0){let u=Hc.zoom(h,e.path.slice(2));if(u)for(let d in e.props)e.props[d]===void 0&&d in u&&(c[d]=u[d])}}o={...e,props:c,path:e.path.slice(2)}}}}else if(e.type===0){let l=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(l!==void 0){if(e.props.name!==void 0&&l.name){let{name:h,...u}=l;l=u}if(e.props.material!==void 0&&"material"in l){let{material:h,...u}=l;l=u}let c=Hc.removeOverridden(e.path,e.props,l);o={...e,props:c}}}if(this.updateByPatchedOpBase(o,Ap.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),n),Ga(e.path,["overrides"])){let l=[],c=[...e.path];for(l.push(c[1]),c.splice(0,2);c.length>0&&c[0]==="descendants";)l.push(c[1]),c.splice(0,2);if(l[l.length-1]===void 0){if(e.type===0)for(let h of Object.keys(e.props)){l[l.length-1]=h;let u=n.scene.findInstance([this.uuid,...l]);u&&(u.overrideData=e.props[h],u.updateState(kd.apply(u.component.data,u.overrideData),n))}}else{let h=n.scene.findInstance([this.uuid,...l]);if(h){let u=Hc.zoom(h.component.data,c);if(e={...e,path:c},e.type===0){let d=e.props;if(u)for(let[f,p]of Object.entries(e.props))p===void 0&&(d===e.props&&(d={...e.props}),d[f]=u[f]);e={...e,props:d}}h.overrideData=CT.resolve(i.overrides,l),h.updateByOp(e,Yo.applySimple(h.data,e),n,!1)}}}else if(this.instances.length>0){let l;if(e.path.length===0&&e.type===0){let c;for(let h of Wp.rootOverrideProps)h in e.props&&(c===void 0&&(c={}),c[h]=e.props[h]);c&&(l={...e,props:c})}else for(let c of Wp.rootOverrideProps)if(Ga(e.path,[c])){l=e;break}l!==void 0&&this.instances.forEach(c=>{if(c.isInstanceRoot){let h=kd.filterOp(c.overrideData,l);h&&c.updateByOp(h,Yo.applySimple(c.data,h),n,!0)}}),this.instances.forEach(c=>{if(!c.isInstanceRoot){let h=kd.filterOp(c.overrideData,e);if(h){let u;s===c.data&&e===h?u=i:u=Yo.applySimple(c.data,h),c.updateByOp(h,u,n,!0)}}})}}updateByPatchedOpBase(e,i,n){if(this.dataPatched=i,e.path.length===0&&e.type===0)e.props.type!==void 0&&!um.is(e.props.type)&&yd.changeEntityProptotype(this,i,n);else if(e.path.length===1&&e.path[0]==="geometry"&&e.type===0&&"type"in e.props){yd.changeEntityProptotype(this,i,n);for(let r of this.children)xi.is(r)&&r.updateVisible()}this.updateByPatchedOp(e,i,n)}updateByPatchedOp(e,i,n){if(e.path.length===0&&e.type===0&&this.updateState(e.props,n),Ga(e.path,["pathSnapping"])!==null&&this.updatePathSnapping(i.pathSnapping),Ga(e.path,["cloner"])!==null){let r=Yo.drop(e,1);r.path.length===0&&r.type===0&&r.props.disabled===!0?this.setFromClonerState(null,n):this.cloner?this.cloner.updateState(i.cloner,n.scene):(this.setFromClonerState(i.cloner,n),this.expandCloner(n.scene)),this.updateVisible()}}updatePathSnapping(e){this._updatedPathSnapping=e,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(e){var p,m,v,g,y;let i=((p=this._updatedPathSnapping)==null?void 0:p.pathId)??this.dataPatched.pathSnapping.pathId,n=((m=this._updatedPathSnapping)==null?void 0:m.slide)??this.dataPatched.pathSnapping.slide??0,r=((v=this._updatedPathSnapping)==null?void 0:v.offset)??this.dataPatched.pathSnapping.offset,s=((g=this._updatedPathSnapping)==null?void 0:g.orientation)??this.dataPatched.pathSnapping.orientation;if(i===null)return;let o=e.find(i);if(!o||this._needApplyPathSnapping===!1)return;this._needApplyPathSnapping=!1;let a=o.data;if(a.geometry.path.points.length<=1)return;let l=Sie(a.geometry.path),c=(n+r)%1;n+r===1&&c===0&&(c=1);let h=l.getPointAt(c),u=this.parent?(y=this.parent)==null?void 0:y.matrixWorld:new $e;o.updateMatrixWorld();let d=new $e().multiplyMatrices(u.clone().invert(),o.matrixWorld);h.applyMatrix4(d);let f={position:h.toArray(),rotation:a.rotation};if(s==="tangential"){let x=new $e().extractRotation(o.matrixWorld),b=l.getTangentAt(c).applyMatrix4(x).add(h),S=new $e().lookAt(h,b,new L(0,1,0)),A=new Nr().setFromRotationMatrix(S);f={...f,rotation:[A.x,A.y,A.z]}}this.updateTransformState(f),this.traverseEntity(x=>{x._cameraType&&x.dispatchEvent(xke)})}updateVisible(){var e;this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||((e=this.dataPatched.cloner)==null?void 0:e.hideBase)!==!0)}updateState_Entity(e,i){e.name!==void 0&&(this.name=e.name),e.raycastLock!==void 0&&(this.raycastLock=e.raycastLock),e.visible!==void 0&&(this.updateVisible(),this.resetBBoxNeedsUpdate()),i&&"cloner"in e&&e.cloner!==void 0&&(this.setFromClonerState(e.cloner,i),this.updateVisible()),this.updateTransformState(e)}get attachedSurfaceCloners(){return this.children.filter(e=>e instanceof yd.Cloner&&e.parameters.type==="toObject")}setFromClonerState(e,i){this.disposed||(e===null||e.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):this.cloner===void 0?(this.cloner=new yd.Cloner(this,e),i.scene.addPendingExpandCloner(this)):this.cloner.updateState(e,i.scene))}expandCloner(e){!this.disposed&&this.cloner&&this.cloner.expandClones(e)}invalidateClonerTransform(e){this.cloner&&this.cloner.invalidateTransform(e)}},Aie=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},t.parameters),n=i.width/2,r=i.radiusTop??n,s=i.radiusBottom??n;return r===s?(r=n,s=n):r>s?(r=n,s=s*n/r):(r=r*n/s,s=n),{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width),radiusTop:r,radiusBottom:s})}}static build(t){let{width:e,depth:i,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l,radiusTop:c,radiusBottom:h,cornerRadius:u,cornerSegments:d,hollow:f}=t.parameters,p;return u||f?p=new Mie(c,h,n,r,s,o,a,l*Math.PI/180,u,u,d,f):p=new gk(c,h,n,r,s,o,a,l*Math.PI/180),p.scale(1,1,i/e),Object.assign(p,{userData:{...t,type:"CylinderGeometry"}})}};function Hh(t,e,i){i.x=t.x*e.x,i.y=t.y,i.z=t.x*e.y}function P9(t){return new he(t.y,-t.x)}var Mie=class extends Ut{constructor(t,e,i,n,r,s,o,a,l,c,h,u,d=!1){super(),this.type="RoundedCylinderBufferGeometry",t=t!==void 0?t:1,e=e!==void 0?e:1,i=i||1,n=Math.floor(n)||8,r=Math.floor(r)||1,s=s!==void 0?s:!1,o=o!==void 0?o:0,a=a!==void 0?a:Math.PI*2,s&&(l=0,c=0);let f=[],p=[],m=[],v=[],g=0,y=i/2,x=new L,b=new L;d&&t==0&&(t=l),d&&e==0&&(e=c);let S=new he(t,y),A=new he(e,-y),E=null,M=null,T=null,P=null,R=S.clone().sub(A),U=0,F=0,N=0;u>0&&(U=Math.min(t,e)*(1-u),F=t-U,N=e-U);let W=S.clone();W.x-=U;let Q=Math.PI-R.angle(),X=R.angle(),B=Math.tan(X/2),j=Math.tan(Q/2),z=B+j,k=u?z:j,G=u?z:B;if(l=Math.min(l,(t-F)/k,R.length()/z),c=Math.min(c,(e-N)/G,R.length()/z),l>0){let ae=l/B;E=S.clone().sub(new he(ae,l)),u&&(T=E.clone(),T.x-=U-z*l),S.sub(R.clone().setLength(ae))}if(c>0){let ae=c/j;M=A.clone().sub(new he(ae,-c)),A.add(R.clone().setLength(ae)),u&&(P=M.clone(),P.x-=U-z*c,W.sub(R.clone().setLength(ae)))}R=S.clone().sub(A);let Z=R.length()<.5,K=[];for(let ae=0;ae<=n;ae++){let fe=[],ge=ae/n,ve=ge*a+o,Y=new he(Math.sin(ve),Math.cos(ve));P&&M?(re(fe,ge,Y,Q,c,P,-1,!0),re(fe,ge,Y,X,c,M,-1,!1)):M?(J(fe,Y,M.x,0,-1),re(fe,ge,Y,X,c,M,-1,!1)):s||J(fe,Y,e,N,-1);let ce=P9(R).normalize();if(Hh(ce,Y,x),!Z)for(let de=0;de<=r;de++){let xe=de/r,Ce=R.clone().multiplyScalar(xe).add(A);Hh(Ce,Y,b),p.push(b.x,b.y,b.z),m.push(x.x,x.y,x.z),v.push(ge,.5+b.y/i),fe.push(g++)}if(T&&E?(re(fe,ge,Y,Q,l,E,1,!1),re(fe,ge,Y,X,l,T,1,!0)):E?(re(fe,ge,Y,Q,l,E,1,!1),J(fe,Y,E.x,0,1)):s||J(fe,Y,t,F,1),u&&!Z){let de=P9(R).multiplyScalar(-1).normalize();Hh(de,Y,x);for(let xe=0;xe<=r;xe++){let Ce=xe/r,Ne=R.clone().multiplyScalar(-Ce).add(W);Hh(Ne,Y,b),p.push(b.x,b.y,b.z),m.push(x.x,x.y,x.z),v.push(ge,.5+b.y/i),fe.push(g++)}}u&&!s&&fe.push(fe[0]),K.push(fe)}for(let ae=0;ae<K.length-1;ae++)for(let fe=0;fe<K[0].length-1;fe++){if(s&&u&&fe==r)continue;let ge=K[ae][fe],ve=K[ae+1][fe],Y=K[ae+1][fe+1],ce=K[ae][fe+1],de=p[Y*3+0],xe=p[Y*3+2];f.push(ge,ve,ce),(de!=0||xe!=0)&&f.push(ve,Y,ce)}a<Math.PI*2&&(le(-1,K[0],o),le(1,K[K.length-1],o+a)),this.setIndex(f),this.setAttribute("position",new yt(p,3)),this.setAttribute("normal",new yt(m,3)),this.setAttribute("uv",new yt(v,2));function re(ae,fe,ge,ve,Y,ce,de,xe){for(let Ce=0;Ce<h+1;Ce++){let Ne=Ce/h,Ie=de<0?Ne:1-Ne;xe&&(Ie-=1),Ie*=ve;let Ge=new he(Math.sin(Ie),Math.cos(Ie)*de),tt=Ge.clone().multiplyScalar(Y).add(ce);Hh(tt,ge,b),p.push(b.x,b.y,b.z),Hh(Ge,ge,x),m.push(x.x,x.y,x.z),v.push(fe,.5+b.y/i),ae.push(g++)}}function J(ae,fe,ge,ve,Y){let ce=new L,de=new he,xe=[ge,ve];Y<0&&xe.reverse();for(let Ce of xe)de.set(Ce,y*Y),Hh(de,fe,ce),p.push(ce.x,ce.y,ce.z),m.push(0,Y,0),v.push(.5,.5),ae.push(g++)}function le(ae,fe,ge){let ve=new he(Math.sin(ge),Math.cos(ge)),Y=new he(-Math.cos(ge),Math.sin(ge)),ce=new L,de=ae<0?(Ne,Ie,Ge)=>f.push(Ne,Ie,Ge):(Ne,Ie,Ge)=>f.push(Ne,Ge,Ie),xe=new he((t+e+F+N)/4,0);Hh(xe,ve,ce),p.push(ce.x,ce.y,ce.z),m.push(Y.x,0,Y.y),v.push(.5,.5);let Ce=g++;for(let Ne of fe){let Ie=p.slice(Ne*3,Ne*3+3);p.push(...Ie),m.push(Y.x,0,Y.y);let Ge=v.slice(Ne*2,Ne*2+2);v.push(...Ge),g++}for(let Ne=Ce+1;Ne<g-1;Ne++)de(Ce,Ne,Ne+1);de(Ce,g-1,Ce+1)}}},_ke=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{width:e,depth:i,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l,cornerRadiusTop:c,cornerRadiusBottom:h,cornerSegments:u}=t.parameters,d;return c>0||h>0||l<360?d=new Mie(0,e/2,n,r,s,o,a,l*Math.PI/180,c,h,u,0,!0):d=new zee(e/2,n,r,s,o),d.scale(1,1,i/e),Object.assign(d,{userData:{...t,type:"ConeGeometry"}})}},wke=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{width:e,height:i,depth:n,widthSegments:r,heightSegments:s,depthSegments:o,cornerRadius:a,cornerSegments:l}=t.parameters,c;return a==0?c=new Qc(e,i,n,r,s,o):c=new bke(e,i,n,r,s,o,a,l),Object.assign(c,{userData:{...t,type:"CubeGeometry"}})}},_3=Math.PI/2,bke=class extends Ut{constructor(t=1,e=1,i=1,n=1,r=1,s=1,o=0,a=4){super(),this.type="BoxGeometry";let l=this;n=Math.floor(n),r=Math.floor(r),s=Math.floor(s),a=Math.floor(a),o=Math.min(o,t/2,e/2,i/2);let c=[],h=[],u=[],d=[],f=0,p=0;m("z","y","x",-1,-1,i,e,t,s,r,0),m("z","y","x",1,-1,i,e,-t,s,r,1),m("x","z","y",1,1,t,i,e,n,s,2),m("x","z","y",1,-1,t,i,-e,n,s,3),m("x","y","z",1,-1,t,e,i,n,r,4),m("x","y","z",-1,-1,t,e,-i,n,r,5),o>0&&(v("z","y","x",-1,-1,1,i,e,t,s,0),v("z","y","x",1,-1,-1,i,e,t,s,1),v("z","y","x",-1,1,-1,i,e,t,s,1),v("z","y","x",1,1,1,i,e,t,s,0),v("x","y","z",-1,-1,-1,t,e,i,n,0),v("x","y","z",1,-1,1,t,e,i,n,1),v("x","y","z",-1,1,1,t,e,i,n,0),v("x","y","z",1,1,-1,t,e,i,n,1),v("y","x","z",-1,-1,1,e,t,i,r,0),v("y","x","z",1,-1,-1,e,t,i,r,1),v("y","x","z",1,1,1,e,t,i,r,1),v("y","x","z",-1,1,-1,e,t,i,r,0),g(1,1,1),g(-1,1,1),g(1,-1,1),g(-1,-1,1),g(1,1,-1),g(-1,1,-1),g(1,-1,-1),g(-1,-1,-1)),this.setIndex(c),this.setAttribute("position",new yt(h,3)),this.setAttribute("normal",new yt(u,3)),this.setAttribute("uv",new yt(d,2));function m(y,x,b,S,A,E,M,T,P,R,U){let F=(E-2*o)/P,N=(M-2*o)/R,W=E/2-o,Q=M/2-o,X=T/2,B=P+1,j=R+1,z=0,k=0,G=new L;for(let Z=0;Z<j;Z++){let K=Z*N-Q;for(let re=0;re<B;re++){let J=re*F-W;G[y]=J*S,G[x]=K*A,G[b]=X,h.push(G.x,G.y,G.z),G[y]=0,G[x]=0,G[b]=T>0?1:-1,u.push(G.x,G.y,G.z),d.push(re/P),d.push(1-Z/R),z+=1}}for(let Z=0;Z<R;Z++)for(let K=0;K<P;K++){let re=f+K+B*Z,J=f+K+B*(Z+1),le=f+(K+1)+B*(Z+1),ae=f+(K+1)+B*Z;c.push(re,J,ae),c.push(J,le,ae),k+=6}l.addGroup(p,k,U),p+=k,f+=z}function v(y,x,b,S,A,E,M,T,P,R,U){let F=(M-2*o)/R,N=M/2-o,W=T/2-o,Q=P/2,X=R+1,B=0,j=0,z=new L,k=new L;for(let G=0;G<a+1;G++){let Z=G/a*_3,K=Math.sin(Z)*o,re=(1-Math.cos(Z))*o,J=Math.sin(Z),le=Math.cos(Z);z[x]=(W+K)*A,z[b]=(Q-re)*E,k[y]=0,k[x]=J*Math.sign(z[x]),k[b]=le*Math.sign(z[b]);for(let ae=0;ae<X;ae++){let fe=ae*F-N;z[y]=fe*S,h.push(z.x,z.y,z.z),u.push(k.x,k.y,k.z),d.push(ae/R),d.push(0),B+=1}}for(let G=0;G<a;G++)for(let Z=0;Z<R;Z++){let K=f+Z+X*G,re=f+Z+X*(G+1),J=f+(Z+1)+X*(G+1),le=f+(Z+1)+X*G;c.push(K,re,le),c.push(re,J,le),j+=6}l.addGroup(p,j,U),p+=j,f+=B}function g(y,x,b){let S=new L,A=new L(t/2,e/2,i/2);A.subScalar(o);let E=[],M=y*x*b>0?(P,R,U)=>c.push(P,R,U):(P,R,U)=>c.push(P,U,R);for(let P=0;P<=a;P++){let R=[],U=_3*(1-P/a),F=Math.cos(U),N=Math.sin(U),W=0;for(let Q=0;Q<=P;Q++){let X=Math.cos(W),B=Math.sin(W);S.x=F*X,S.y=N,S.z=F*B;let j=A.clone().addScaledVector(S,o);h.push(y*j.x,x*j.y,b*j.z),u.push(y*S.x,x*S.y,b*S.z),d.push(0,0),R.push(f++),W+=_3/P}E.push(R)}let T=E.length-1;for(let P=0;P<T;P++){let R=E[P],U=E[P+1],F=R.length-1;M(R[0],U[1],U[0]);for(let N=1;N<=F;N++)M(R[N-1],R[N],U[N]),M(R[N],U[N+1],U[N])}}}},tz=class extends Ut{constructor(t=[],e=[],i="",n=1,r=.2,s=4){super(),this.type="PolyhedronGeometryRound";let o=[],a=[],l=[];c(),h(),this.setAttribute("position",new yt(o,3)),this.setAttribute("normal",new yt(l,3)),this.setAttribute("uv",new yt(a,2));return;function c(){var X;r=Math.min(1-1e-5,r),r==0&&(s=0);let u={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[i],d=new L,f=d.clone(),p=new xs,m=r*n,v=n-m,g=s+1,y=new L,x=(B,j)=>y.subVectors(B,j).normalize(),b=(B,j)=>Array(B).fill(void 0).map(j),S=b(t.length/3,(B,j)=>new L().fromArray(t,j*3).setLength(n)),A=[],E=1e6;for(let B=0;B<S.length;B++){let j=S[B],z=[],k,G,Z,K=1e10,re=-1;for(;(re=e.indexOf(B,re+1))!=-1;){let fe=re-re%3;k=e[fe+(re+1)%3],G=e[fe+(re+2)%3],Z=j.distanceToSquared(S[k]),K=Math.min(K,Z),z.push([k,G,Z])}K+=1e-6;let J=[],le=0,ae=z.length;for(let fe=0;fe<ae;fe++){[k,G,Z]=z[le];let ge=((X=A[k])==null?void 0:X.includes(B))==!0;Z<=K&&J.push(k+ +ge*E),le=z.findIndex(ve=>ve[0]==G)}A.push(J)}let M=[];{let B=0,j=0,z,k,G=u==3;for(let Z=0;Z<=s;Z++){z=Z*(Z+1)/2,k=(Z+1)*(Z+2)/2;for(let K=0;K<s-Z;K++)[B,j]=[z+K+Z+2,k+K+Z+3],M.push(z,k,...G?[j,z]:[B,k],j,B),[z,k]=[B,j];M.push(z,k,z+s+2)}}let T=d.clone(),P=d.clone(),R=d.clone(),U=d.clone(),F=d.clone(),N=[],W=b(S.length,()=>b(u,()=>d.clone()));for(let B=0;B<S.length;B++){d.copy(S[B]).normalize(),T.copy(d).multiplyScalar(v);let j=A[B];for(let J=0;J<j.length;J++){let le=j[J],ae=j[(J+1)%u];p.setFromPointsAndIndices(S,B,le%E,ae%E),p.b.sub(p.a).setLength(1e10).add(p.a),p.c.sub(p.a).setLength(1e10).add(p.a),p.closestPointToPoint(T,W[B][J])}let z=[],k=[],G=[],Z=new L;s==0&&[...W[B]].reduce((J,le)=>J.add(le),Z).multiplyScalar(1/u);for(let J=0;J<u;J++){let le=[],ae=(J-1+u)%u,fe=W[B][ae],ge=W[B][J];d.copy(fe).sub(T),f.copy(ge).sub(T);let ve=T.angleTo(d),Y=d.angleTo(f),ce=Math.cos(ve)*m;s==0?P.copy(Z):P.copy(T).setLength(v+ce),k.push(ce);let de=[P,fe,ge];for(let xe=0;xe<2;xe++){let Ce=de[xe],Ne=de[xe+1];U.subVectors(Ce,T),F.subVectors(Ne,T),R.crossVectors(U,F).normalize();for(let Ie=0;Ie<g;Ie++){let Ge=[ve,Y][xe]*Ie/g;d.copy(U).applyAxisAngle(R,Ge).add(T),z.push(d.clone()),xe&&(x(d,T),le.push([Ie==0?Ce:d.clone(),y.clone()]))}xe&&(x(Ne,T),le.push([Ne,y.clone()]))}G.push(le)}N.push(G);let K=2*g,re=2;for(let J=0;J<u;J++){let le=K*J,ae=K*((J+1)%u),fe=[z[le]];for(let ve=1;ve<g;ve++){U=z[le+ve],F=z[ae+ve],fe.push(U);for(let Y=1,ce=ve-re+1;Y<=ce;Y++)d.lerpVectors(U,F,Y/(ce+1)),d.sub(T).setLength(k[J]).add(T),fe.push(d.clone());fe.push(F)}for(let ve=0;ve<g;ve++)fe.push(z[ve+g+le]);fe.push(z[ae+g]);let ge=M.map(ve=>fe[ve]);o.push(...ge.map(ve=>[ve.x,ve.y,ve.z]).flat()),l.push(...ge.map(ve=>(x(ve,T),[y.x,y.y,y.z])).flat())}}let Q=[];for(let B=0;B<A.length;B++)for(let j=0;j<u;j++){let z=A[B][j];if(z<E){let k=A[z].findIndex(K=>K%E==B),G=N[B][j],Z=N[z][k];for(let K=0;K<g;K++){let re=G[K],J=Z[g-K],le=G[K+1],ae=Z[g-(K+1)];[re,J,le,le,J,ae].forEach(fe=>{o.push(fe[0].x,fe[0].y,fe[0].z),l.push(fe[1].x,fe[1].y,fe[1].z)})}Q.push(G[0][0],Z[g][0],G[g][0],Z[0][0])}}for(;Q.length;){let B,j,z,k;[B,j]=Q.splice(0,2);let G=[B];for(;B!=j;)G.push(j),z=Q.indexOf(j),k=z%2,j=Q.splice(z-k,2)[1-k];y.subVectors(G[0],G[1]).cross(d.subVectors(G[0],G[2])).normalize();let Z=y.dot(G[0])<0;Z&&y.negate();for(let K=1;K<=G.length-2;K++)[G[K+ +Z],G[K+1-+Z],G[0]].forEach(re=>{o.push(re.x,re.y,re.z),l.push(y.x,y.y,y.z)})}}function h(){let u=new L;for(let A=0;A<o.length;A+=3){u.x=o[A+0],u.y=o[A+1],u.z=o[A+2];let E=b(u)/2/Math.PI+.5,M=S(u)/Math.PI+.5;a.push(E,1-M)}let d=new L,f=new L,p=new L,m=new L,v=new he,g=new he,y=new he,x=(A,E,M,T)=>{T<0&&A.x===1&&(a[E]=A.x-1),M.x===0&&M.z===0&&(a[E]=T/2/Math.PI+.5)};for(let A=0,E=0;A<o.length;A+=9,E+=6){d.set(o[A+0],o[A+1],o[A+2]),f.set(o[A+3],o[A+4],o[A+5]),p.set(o[A+6],o[A+7],o[A+8]),v.set(a[E+0],a[E+1]),g.set(a[E+2],a[E+3]),y.set(a[E+4],a[E+5]),m.copy(d).add(f).add(p).divideScalar(3);let M=b(m);x(v,E+0,d,M),x(g,E+2,f,M),x(y,E+4,p,M)}for(let A=0;A<a.length;A+=6){let E=a[A+0],M=a[A+2],T=a[A+4],P=Math.max(E,M,T),R=Math.min(E,M,T);P>.9&&R<.1&&(E<.2&&(a[A+0]+=1),M<.2&&(a[A+2]+=1),T<.2&&(a[A+4]+=1))}function b(A){return Math.atan2(A.z,-A.x)}function S(A){return Math.atan2(-A.y,Math.sqrt(A.x*A.x+A.z*A.z))}}}static fromJSON(t){return new tz(t.vertices,t.indices,t.radius,t.corner,t.cornerSides)}},Ske=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,detail:0,corner:0,cornerSides:4},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{width:e,height:i,depth:n,detail:r,corner:s,cornerSides:o}=t.parameters,a=r===0&&s!==0?new Eie(e*.5,s,o):new Gee(e*.5,r);return a.scale(1,i/e,n/e),Object.assign(a,{userData:{...t,type:"DodecahedronGeometry"}})}},Eie=class extends tz{constructor(t=1,e=.2,i=4){let n=(1+Math.sqrt(5))/2,r=1/n,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a="DodecahedronGeometry";super(s,o,a,t,e,i),this.type=a}static fromJSON(t){return new Eie(t.radius,t.corner,t.cornerSides)}},Lx=1e-12,iz=class{constructor(t){this.position=new he,this.startPosition=new he,this.uuid=hi.generateUUID(),this.position=t.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(t){this.position.copy(this.startPosition).add(t)}copy(t){return this.position.copy(t.position),this.startPosition.copy(t.startPosition),this}clone(){return new iz(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},NO=class extends iz{constructor(t){super(t.position),this.parent=t}copy(t){return super.copy(t),this}clone(){return new NO(this.parent).copy(this)}},Zv=class extends iz{constructor(t,e){super(e),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=t,this.controls.push(new NO(this),new NO(this))}static create(t,e){let i=new Zv(t,new he(...e.position));return i.controls[0].position.set(...e.controlPrevious.position),i.controls[1].position.set(...e.controlNext.position),i.roundness=e.roundness,i.areControlsDirectionsMirrored=e.areControlsDirectionsMirrored,i}getOppositeControl(t){let e=this.controls.indexOf(t);return e===0?this.controls[1]:e===1?this.controls[0]:null}applyOffsetToControls(t,e=1){for(let i=0,n=this.controls.length;i<n;i++){let r=this.controls[i];this.position.distanceTo(r.position)<=e?r.position.copy(this.position):r.applyOffset(t)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(t){return super.copy(t),this.controls[0].copy(t.controls[0]),this.controls[1].copy(t.controls[1]),this.roundness=t.roundness,this.uuid=t.uuid,this}clone(){return new Zv(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var i,n;let t=(i=this.curveBefore)==null?void 0:i.getTangentAt(1),e=(n=this.curveAfter)==null?void 0:n.getTangentAt(0);return[t,e]}computeNormals(t=new he,e=new he){let[i,n]=this.computeTangents();return i&&n&&(D9(i,t),D9(n,e)),[t,e]}computeTangent(t=new he){let[e,i]=this.computeTangents();return e&&i&&t.copy(e).add(i).normalize(),t}computeNormal(t=new he){let[e,i]=this.computeNormals();return t.copy(e).add(i).normalize(),t}};function D9(t,e=new he){let i=t.length();return e.set(-t.y/i,t.x/i)}var nz=t=>t,by=new he,g2=new he,Ake=new he,Mke=new he,Eke=new he,Tke=new he,Tie=new L,Cie=new L;function Cke(t){let e=new he;e.addVectors(t.v0,by.subVectors(t.v1,t.v0).multiplyScalar(2/3));let i=new he;return i.addVectors(t.v2,g2.subVectors(t.v1,t.v2).multiplyScalar(2/3)),new El(t.v0,e,i,t.v2)}function c1(t,e,i=Number.EPSILON){return Math.abs(t-e)<i}function Pke(t,e,i=Number.EPSILON){return t.distanceTo(e)<i}function Dke(t,e,i=Number.EPSILON){return t.distanceTo(e)<i}function Pie(t,e,i){let n=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),r=Math.sqrt(Math.pow(e.x-i.x,2)+Math.pow(e.y-i.y,2)),s=Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2));return Math.acos((r*r+n*n-s*s)/(2*r*n))}function Rke(t,e,i){return I9(t,e)&&I9(e,i)&&UO(t.position,e.position,i.position)}function UO(t,e,i){return by.copy(e).sub(t).cross(g2.copy(i).sub(t))===0}function Ike(t,e,i,n,r){let s=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),o=(t.y+e.y)/2,a=(t.x+e.x)/2,l=Math.sqrt(Math.pow(i,2)-Math.pow(s/2,2))*(t.y-e.y)/s,c=Math.sqrt(Math.pow(i,2)-Math.pow(s/2,2))*(e.x-t.x)/s;return n.set(a+l,o+c),r.set(a-l,o-c),[n,r]}function Lke(t,e,i){let n=t.distanceTo(i),r=e.distanceTo(i);return n<r?e:t}function Bke(t,e,i,n,r,s){let o=e.x-t.x,a=e.y-t.y,l=i.x-t.x,c=i.y-t.y,h=Math.sqrt((o+l)*(o+l)+(a+c)*(a+c)),u;return Pie(e,t,i)>Math.PI&&(h*=-1),c1(c,a)?u=(a+c)*(n/h-.5)*8/3/(o-l):u=(o+l)*(n/h-.5)*8/3/(c-a),r.set(e.x-u*a,e.y+u*o),s.set(i.x+u*c,i.y-u*l),[r,s]}function R9(t,e){return t.position.equals(t.controls[1].position)&&e.position.equals(e.controls[0].position)}function I9(t,e){return UO(t.position,t.controls[1].position,e.position)&&UO(t.position,e.controls[0].position,e.position)}function Oke(t,e,i,n,r=.5){let s=by.subVectors(e,t).multiplyScalar(r).add(t),o=g2.subVectors(i,e).multiplyScalar(r).add(e),a=Ake.subVectors(n,i).multiplyScalar(r).add(i),l=s,c=Mke.subVectors(o,s).multiplyScalar(r).add(s),h=Eke.subVectors(a,o).multiplyScalar(r).add(o),u=a,d=Tke.subVectors(h,c).multiplyScalar(r).add(c);return[t.x,t.y,l.x,l.y,c.x,c.y,d.x,d.y,h.x,h.y,u.x,u.y,n.x,n.y]}function Fke(t,e,i=12,n=!0){let r=Cie.set(0,0,0),s,o=0;for(let a=0;a<e.length;a++){let l=nz(e[a]),c=by,h=qp(l,i);for(let u=0;u<=h;u++)if(l instanceof El||l instanceof tf||l instanceof Nl){if(l.getPoint(u/h,c),r.set(c.x,c.y,0),s!==void 0&&Dke(s,r))continue;s===void 0&&(s=Tie),s.copy(r),t.setXYZ(o,r.x,r.y,r.z),o++}}return n&&o>1&&!(t.getX(o-1)===t.getX(0)&&t.getY(o-1)===t.getY(0)&&t.getZ(o-1)===t.getZ(0))&&(t.setXYZ(o,t.getX(0),t.getY(0),t.getZ(0)),o++),t}function Nke(t,e,i,n=12,r=!0){let s=Cie.set(0,0,0),o=0,a=[];for(let l=0;l<e.length;l++){if(i[l]===!1)continue;let c,h=nz(e[l]),u=by,d=qp(h,n);a.push(d);for(let f=0;f<=d;f++)if(h instanceof El||h instanceof tf||h instanceof Nl){if(h.getPoint(f/d,u),s.set(u.x,u.y,0),c==null?void 0:c.equals(s))continue;c===void 0?c=Tie:(t.setXYZ(o,c.x,c.y,c.z),o++,t.setXYZ(o,s.x,s.y,s.z),o++),c.copy(s)}}return r&&o>1&&!(t.getX(o-1)===t.getX(0)&&t.getY(o-1)===t.getY(0)&&t.getZ(o-1)===t.getZ(0))&&(t.setXYZ(o,t.getX(0),t.getY(0),t.getZ(0)),o++),a}function L9(t,e=12,i=!1){let n=[];for(let r=0,s=t.length;r<s;r++){let o=t[r],a=0;if(i&&o.roundedCurveCorner!==void 0){let l=qp(o.roundedCurveCorner,e)*.5;r>0&&(n[r-1]+=l),a+=l}o.curveAfter!==void 0&&(a+=qp(o.curveAfter,e)),n.push(a)}return t.length>0&&i&&t[0].roundedCurveCorner!==void 0&&(n[t.length-1]+=qp(t[0].roundedCurveCorner,e)*.5),n}function qp(t,e=12){return t&&t instanceof e2?e*2:t&&(t instanceof Nl||t instanceof Nee)?1:t&&t instanceof mk?e*t.points.length:e}function Uke(t,e,i=12,n=!0){let r,s=0;for(let o=0;o<e.length;o++){let a=nz(e[o]),l=qp(a,i),c=by;for(let h=0;h<=l;h++)if(a instanceof El||a instanceof tf||a instanceof Nl){if(a.getPoint(h/l,c),r!==void 0&&Pke(r,c,Lx))continue;r===void 0&&(r=g2),r.copy(c),t.push(c.x,c.y),s++}}return c1(t[0],t[t.length-2],Lx)&&c1(t[1],t[t.length-1],Lx)&&(t.pop(),t.pop()),n&&s>1&&!(c1(t[s-1],t[1],Lx)&&c1(t[s-2],t[0],Lx))&&(t.push(t[0],t[1]),s++),t}var w3=new he,kke=new he,zke=new he,Gke=new he,Hke=new he,Vke=new he,Nn=class extends rT{constructor(t=100,e=100){super(),this.points=[],this.shapeHoles=[],this.plane=new zo(new L(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=hi.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=t,this._height=e}static createFromState(t,e,i){let n=new Nn;return n.isClosed=t.isClosed,n.points=t.points.map(r=>Zv.create(r.id,r.data)),typeof t.roundness=="number"&&(n.roundness=t.roundness),n.shapeHoles=t.shapeHoles.map(r=>Nn.createFromState(r)),e!==void 0&&i!==void 0&&n.applySize(e,i),n.update(),n}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(t){if(this._roundness!==t){this._roundness=t;for(let e=0,i=this.points.length;e<i;e++)this.points[e].roundness=t;this.needsUpdate=!0}}getPointsIndexesByIds(t){return t.map(e=>this.getPointIndexById(e)).filter(e=>e>=0)}getPointIndexById(t){let e=this.points.length,i=this.points.findIndex(n=>n.uuid===t);if(i<0){let n=e;for(let r=0,s=this.shapeHoles.length;r<s;r++){let o=this.shapeHoles[r],a=o.points.length,l=o.getPointIndexById(t);if(l<0)n+=a;else return l+n}}return i}getLineIndexById(t){return this.getPointIndexById(t)}getBezierPoint(t){if(t<=this.points.length-1)return this.points[t];if(this.shapeHoles.length>0){let e=this.points.length;for(let i=0,n=this.shapeHoles.length;i<n;i++){let r=this.shapeHoles[i],s=t-e;if(s<=r.points.length-1)return r.points[s];e+=r.points.length}}throw new Error("This shape does not have a point for this index: "+t)}getBezierPointIndex(t){let e=this.points.indexOf(t);if(e>=0)return e;if(e=this.points.length,this.shapeHoles.length>0)for(let i=0,n=this.shapeHoles.length;i<n;i++){let r=this.shapeHoles[i],s=r.points.indexOf(t);if(s>=0)return e+s;e+=r.points.length}return-1}getAllPoints(){let t=[].concat(...this.shapeHoles.map(e=>e.points));return[...this.points,...t]}applySize(t,e){t===0&&(t=.001),e===0&&(e=.001),this._width=t,this._height=e}applyScale(t,e){let i=w3.set(t,e);for(let n=0,r=this.points.length;n<r;n++){let s=this.points[n];s.position.multiply(i),s.controls[0].position.multiply(i),s.controls[1].position.multiply(i)}for(let n=0,r=this.shapeHoles.length;n<r;n++)this.shapeHoles[n].applyScale(t,e);this._update()}createPoint(t,e=0,i=hi.generateUUID()){let n;t instanceof he?n=t:n=new he(t,e);let r=new Zv(i,n);return r.roundness=this.roundness,r}addPoint(t){this.points.push(t),this.needsUpdate=!0}addPointAt(t,e){this.points.splice(e,0,t),this.needsUpdate=!0}getPointByUuid(t){for(let e=0,i=this.points.length;e<i;e++){let n=this.points[e];if(n.uuid===t)return n}for(let e=0,i=this.shapeHoles.length;e<i;e++){let n=this.shapeHoles[e].getPointByUuid(t);if(n)return n}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(t){let e=this.points.indexOf(t);e>=0&&this.points.splice(e,1),this.needsUpdate=!0}removePointById(t){let e=this.points.find(i=>i.uuid===t);e&&this.removePoint(e)}update(){for(let t=0,e=this.shapeHoles.length;t<e;t++)this.shapeHoles[t].update();this._update()}extractShapePointsToBuffer(t,e=12,i=!1){this.subdivision=e,this.curveDivisions===void 0&&this.computeCurveDivisions(e);let n=i?this.roundedCurveDivisions:this.curveDivisions;return Fke(t,i?this.roundedCurves:this.curves,e,this.autoClose),n.reduce((r,s)=>r+s,0)+1}computeCurveDivisions(t=12){return this.curveDivisions=L9(this.points,t,!1),this.roundedCurveDivisions=L9(this.points,t,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(t,e,i=12){return Nke(t,this.curves,e,i,this.autoClose).reduce((n,r)=>n+r,0)*2}extractShapePointsToFlatArray(t,e=12){return this.subdivision=e,this.curveDivisions===void 0&&this.computeCurveDivisions(e),Uke(t,this.roundedCurves,e,this.autoClose)}getCurveIndexFromVertexId(t,e=!1){let i=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let n=e?this.roundedCurveDivisions:this.curveDivisions,r=0;e&&this.points[0].roundedCurveCorner!==void 0&&(r=qp(this.points[0].roundedCurveCorner,this.subdivision)*.5);let s=t-r;s<0&&(s+=n.reduce((o,a)=>o+a,0));for(let o=0,a=n.length;o<a;o++){let l=n[o];if(s<i+l)return[o,(s-i+1)/l];i+=l}return[0,1]}getCurveT(t,e,i){let n=this.points[t],r=this.points[t>=this.points.length-1?0:t+1],s=this.curveDivisions,o=s[t];if(R9(n,r)){let l=n.position.distanceTo(r.position);return n.position.distanceTo(w3.set(i.x,i.y))/l}let a=0;for(let l=0;l<t;l++)a+=s[l];return(e-a)/o}dispose(){}_applyCurveForPoint(t,e){R9(e,t)?this.lineTo(t.position.x,t.position.y):this.bezierCurveTo(e.controls[1].position.x,e.controls[1].position.y,t.controls[0].position.x,t.controls[0].position.y,t.position.x,t.position.y);let i=this.curves[this.curves.length-1];t.curveBefore=i,e.curveAfter=i;let n=i.clone();t.roundedCurveBefore=n,e.roundedCurveAfter=n,t.roundedCurveCorner=void 0,this.roundedCurves.push(n)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let e=0,i=this.points.length;e<i;e++){let n=this.points[e];if(e===0)this.moveTo(n.position.x,n.position.y);else{let r=this.points[e-1];this._applyCurveForPoint(n,r)}}let t=this.getLastPoint();if(t!=null&&t.curveAfter&&(t.curveAfter=void 0),this.isClosed){let e=this.points[0],i=this.points[this.points.length-1];this._applyCurveForPoint(e,i)}if(this.points.length>2){let e=0;for(let i=0,n=this.points.length;i<n;i++){let r=this.points[i],s=this.points[i-1]??this.points[this.points.length-1],o=this.points[i+1]??this.points[0],a=r.roundness,l=s&&o&&Rke(s,r,o);if(!r.controlsMoved()&&a>0&&!l){let c=r.curveBefore,h=r.curveAfter;if(c===void 0||h===void 0)continue;let u=r.roundedCurveBefore,d=r.roundedCurveAfter,f=c.getLength(),p=h.getLength(),m=Math.min(a,f*.499),v=Math.min(a,p*.499),g=Math.min(m,v),y=1-g/f,x=g/p,b=c.getPointAt(y,w3),S=h.getPointAt(x,kke);this._subSplitCurve(c,u,y,b,void 0),this._subSplitCurve(h,d,x,void 0,S);let A;if(this.useCubicForRoundedCorners){let E=Pie(b,r.position,S)/2,M=Math.tan(E)*b.distanceTo(r.position),[T,P]=Ike(b,S,M,zke,Gke),R=Lke(T,P,r.position),[U,F]=Bke(R,b,S,M,Hke,Vke);A=new El(b.clone(),U.clone(),F.clone(),S.clone())}else A=new tf(b.clone(),r.position.clone(),S.clone());r.roundedCurveCorner=A,this.roundedCurves.splice(i+e,0,A),e++}}}}_subSplitCurve(t,e,i,n,r){if(t instanceof Nl)n!==void 0&&e.v2.copy(n),r!==void 0&&e.v1.copy(r);else{let s=t,o=e,a=s.getUtoTmapping(i,0),l=Oke(s.v0,s.v1,s.v2,s.v3,a);return n!==void 0&&(o.v0.set(l[0],l[1]),o.v1.set(l[2],l[3]),o.v2.set(l[4],l[5]),o.v3.set(l[6],l[7])),r!==void 0&&(o.v0.set(l[6],l[7]),o.v1.set(l[8],l[9]),o.v2.set(l[10],l[11]),o.v3.set(l[12],l[13])),o}return e}clone(){let t=new Nn(this._width,this._height);return t.points=this.points.map(e=>e.clone()),t.isClosed=this.isClosed,t.roundness=this.roundness,t.isMesh2D=this.isMesh2D,t.shapeHoles=this.shapeHoles.map(e=>e.clone()),t}toJSON(){return{points:this.points.reduce((t,e)=>t.concat(e.toJSON()),[]),shapeHoles:this.shapeHoles.map(t=>t.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(t){var i;this.points=[],this.pointIDs=0;let e=t.points.length/7;for(let n=0;n<e;n++){let r=n*7,s=t.points[r+0],o=t.points[r+1],a=t.points[r+2],l=t.points[r+3],c=t.points[r+4],h=t.points[r+5],u=t.points[r+6],d=new Zv(hi.generateUUID(),new he(s,o));d.controls[0].position.set(a,l),d.controls[1].position.set(c,h),d.roundness=u,this.points.push(d)}return this.shapeHoles=(i=t.shapeHoles)!=null&&i.length?t.shapeHoles.map(n=>{let r=new Nn;return r.fromJSON(n),r}):[],this.isClosed=t.isClosed,this._roundness=t.roundness,this._update(),this}fromShape(t){let e=(n,r)=>{r instanceof El&&r.v3.equals(n.position)&&n.controls[0].position.copy(r.v2)},i=n=>{let r=[],s,o;for(s=0,o=n.length;s<o;s++)n[s]instanceof tf&&(n[s]=Cke(n[s]));for(s=0,o=n.length;s<o;s++){let c=n[s],h=s>0?n[s-1]:null,u;c instanceof El?(u=this.createPoint(c.v0),u.controls[1].position.copy(c.v1)):c instanceof Nl&&(u=this.createPoint(c.v1)),u!==void 0&&(h!==null&&e(u,h),r.push(u))}let a=n[n.length-1],l=!1;return a instanceof El?a.v3.equals(r[0].position)&&(r[0].controls[0].position.copy(a.v2),l=!0):a instanceof Nl&&a.v2.equals(r[0].position)&&(l=!0),this.isClosed=l,r};return this.points=i(t.curves),t instanceof rT&&(this.shapeHoles=t.holes.map(n=>{let r=new Nn;return r.fromShape(n),r})),this.update(),this}updatePoint(t,e){let i=this.getPointByUuid(t);i&&(e.position!==void 0&&i.position.fromArray(e.position),e.roundness!==void 0&&(i.roundness=e.roundness),e.areControlsDirectionsMirrored!==void 0&&(i.areControlsDirectionsMirrored=e.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(t,e){var n;let i=(n=this.getPointByUuid(t))==null?void 0:n.controls[0];i&&(e.position&&i.position.fromArray(e.position),this.needsUpdate=!0)}updateNextControl(t,e){var n;let i=(n=this.getPointByUuid(t))==null?void 0:n.controls[1];i&&(e.position&&i.position.fromArray(e.position),this.needsUpdate=!0)}},kO=Math.PI*2;function b3({x:t,y:e},i,n,r,s){return{x:t*i+r,y:e*n+s}}function jke(t,e){let i=e===1.5707963267948966?.551915024494:e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),n=Math.cos(t),r=Math.sin(t),s=Math.cos(t+e),o=Math.sin(t+e);return[{x:n-r*i,y:r+n*i},{x:s+o*i,y:o-s*i},{x:s,y:o}]}function B9(t,e,i,n){let r=t*n-e*i<0?-1:1,s=Math.min(1,Math.max(-1,t*i+e*n));return r*Math.acos(s)}function Wke(t,e,i,n,r,s,o,a,l,c){let h=Math.pow(r,2),u=Math.pow(s,2),d=Math.pow(o,2),f=Math.pow(a,2),p=h*u-h*f-u*d;p<0&&(p=0),p/=h*f+u*d,p=Math.sqrt(p)*(l===c?-1:1);let m=p*r/s*a,v=p*-s/r*o,g=m+(t+i)/2,y=v+(e+n)/2,x=(o-m)/r,b=(a-v)/s,S=(-o-m)/r,A=(-a-v)/s,E=B9(1,0,x,b),M=B9(x,b,S,A);return!c&&M>0&&(M-=kO),c&&M<0&&(M+=kO),{centerx:g,centery:y,ang1:E,ang2:M}}function Xke({px:t,py:e,cx:i,cy:n,rx:r,ry:s,largeArcFlag:o,sweepFlag:a}){let l=[];if(r===0||s===0)return[];let c=(t-i)/2,h=(e-n)/2;if(c===0&&h===0)return[];r=Math.abs(r),s=Math.abs(s);let u=Math.pow(c,2)/Math.pow(r,2)+Math.pow(h,2)/Math.pow(s,2);u>1&&(r*=Math.sqrt(u),s*=Math.sqrt(u));let d=Wke(t,e,i,n,r,s,c,h,o,a),{ang1:f,ang2:p}=d,{centerx:m,centery:v}=d,g=Math.abs(p)/(kO/4);Math.abs(1-g)<1e-7&&(g=1);let y=Math.max(Math.ceil(g),1);p/=y;for(let x=0;x<y;x++)l.push(jke(f,p)),f+=p;return l.map(x=>{let{x:b,y:S}=b3(x[0],r,s,m,v),{x:A,y:E}=b3(x[1],r,s,m,v),{x:M,y:T}=b3(x[2],r,s,m,v);return{x1:b,y1:S,x2:A,y2:E,x:M,y:T}})}var Gi;(function(t){t[t.ODD=0]="ODD",t[t.NONZERO=1]="NONZERO",t[t.POSITIVE=2]="POSITIVE",t[t.NEGATIVE=3]="NEGATIVE",t[t.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(Gi||(Gi={}));var hr;(function(t){t[t.POLYGONS=0]="POLYGONS",t[t.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",t[t.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(hr||(hr={}));function Ft(t,e){if(!t)throw e||"Assertion Failed!"}var Ct=function(){function t(){}return t.vertEq=function(e,i){return e.s===i.s&&e.t===i.t},t.vertLeq=function(e,i){return e.s<i.s||e.s===i.s&&e.t<=i.t},t.transLeq=function(e,i){return e.t<i.t||e.t===i.t&&e.s<=i.s},t.edgeGoesLeft=function(e){return t.vertLeq(e.Dst,e.Org)},t.edgeGoesRight=function(e){return t.vertLeq(e.Org,e.Dst)},t.vertL1dist=function(e,i){return Math.abs(e.s-i.s)+Math.abs(e.t-i.t)},t.edgeEval=function(e,i,n){Ft(t.vertLeq(e,i)&&t.vertLeq(i,n));var r=i.s-e.s,s=n.s-i.s;return r+s>0?r<s?i.t-e.t+(e.t-n.t)*(r/(r+s)):i.t-n.t+(n.t-e.t)*(s/(r+s)):0},t.edgeSign=function(e,i,n){Ft(t.vertLeq(e,i)&&t.vertLeq(i,n));var r=i.s-e.s,s=n.s-i.s;return r+s>0?(i.t-n.t)*r+(i.t-e.t)*s:0},t.transEval=function(e,i,n){Ft(t.transLeq(e,i)&&t.transLeq(i,n));var r=i.t-e.t,s=n.t-i.t;return r+s>0?r<s?i.s-e.s+(e.s-n.s)*(r/(r+s)):i.s-n.s+(n.s-e.s)*(s/(r+s)):0},t.transSign=function(e,i,n){Ft(t.transLeq(e,i)&&t.transLeq(i,n));var r=i.t-e.t,s=n.t-i.t;return r+s>0?(i.s-n.s)*r+(i.s-e.s)*s:0},t.vertCCW=function(e,i,n){return e.s*(i.t-n.t)+i.s*(n.t-e.t)+n.s*(e.t-i.t)>=0},t.interpolate=function(e,i,n,r){return e=e<0?0:e,n=n<0?0:n,e<=n?n===0?(i+r)/2:i+(r-i)*(e/(e+n)):r+(i-r)*(n/(e+n))},t.intersect=function(e,i,n,r,s){var o,a,l;t.vertLeq(e,i)||(l=e,e=i,i=l),t.vertLeq(n,r)||(l=n,n=r,r=l),t.vertLeq(e,n)||(l=e,e=n,n=l,l=i,i=r,r=l),t.vertLeq(n,i)?t.vertLeq(i,r)?(o=t.edgeEval(e,n,i),a=t.edgeEval(n,i,r),o+a<0&&(o=-o,a=-a),s.s=t.interpolate(o,n.s,a,i.s)):(o=t.edgeSign(e,n,i),a=-t.edgeSign(e,r,i),o+a<0&&(o=-o,a=-a),s.s=t.interpolate(o,n.s,a,r.s)):s.s=(n.s+i.s)/2,t.transLeq(e,i)||(l=e,e=i,i=l),t.transLeq(n,r)||(l=n,n=r,r=l),t.transLeq(e,n)||(l=e,e=n,n=l,l=i,i=r,r=l),t.transLeq(n,i)?t.transLeq(i,r)?(o=t.transEval(e,n,i),a=t.transEval(n,i,r),o+a<0&&(o=-o,a=-a),s.t=t.interpolate(o,n.t,a,i.t)):(o=t.transSign(e,n,i),a=-t.transSign(e,r,i),o+a<0&&(o=-o,a=-a),s.t=t.interpolate(o,n.t,a,r.t)):s.t=(n.t+i.t)/2},t}(),Bx=function(){function t(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return t}(),zA=function(){function t(e){this.side=e,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(t.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(e){this.Sym.Lface=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(e){this.Sym.Org=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(e){this.Sym.Lnext=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(e){this.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(e){this.Lnext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(e){this.Sym.Onext=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(e){this.Sym.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(e){this.Sym.Lnext.Sym=e},enumerable:!0,configurable:!0}),t}(),Kg=function(){function t(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return t}(),O9=function(){function t(){var e=new Kg,i=new Bx,n=new zA(0),r=new zA(1);e.next=e.prev=e,e.anEdge=null,i.next=i.prev=i,n.next=n,n.Sym=r,r.next=r,r.Sym=n,this.vHead=e,this.fHead=i,this.eHead=n,this.eHeadSym=r}return t.prototype.makeEdge_=function(e){var i=new zA(0),n=new zA(1);e.Sym.side<e.side&&(e=e.Sym);var r=e.Sym.next;return n.next=r,r.Sym.next=i,i.next=e,e.Sym.next=n,i.Sym=n,i.Onext=i,i.Lnext=n,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,n.Sym=i,n.Onext=n,n.Lnext=i,n.Org=null,n.Lface=null,n.winding=0,n.activeRegion=null,i},t.prototype.splice_=function(e,i){var n=e.Onext,r=i.Onext;n.Sym.Lnext=i,r.Sym.Lnext=e,e.Onext=r,i.Onext=n},t.prototype.makeVertex_=function(e,i,n){var r=e;Ft(r,"Vertex can't be null!");var s=n.prev;r.prev=s,s.next=r,r.next=n,n.prev=r,r.anEdge=i;var o=i;do o.Org=r,o=o.Onext;while(o!==i)},t.prototype.makeFace_=function(e,i,n){var r=e;Ft(r,"Face can't be null");var s=n.prev;r.prev=s,s.next=r,r.next=n,n.prev=r,r.anEdge=i,r.trail=null,r.marked=!1,r.inside=n.inside;var o=i;do o.Lface=r,o=o.Lnext;while(o!==i)},t.prototype.killEdge_=function(e){e.Sym.side<e.side&&(e=e.Sym);var i=e.next,n=e.Sym.next;i.Sym.next=n,n.Sym.next=i},t.prototype.killVertex_=function(e,i){var n=e.anEdge,r=n;do r.Org=i,r=r.Onext;while(r!==n);var s=e.prev,o=e.next;o.prev=s,s.next=o},t.prototype.killFace_=function(e,i){var n=e.anEdge,r=n;do r.Lface=i,r=r.Lnext;while(r!==n);var s=e.prev,o=e.next;o.prev=s,s.next=o},t.prototype.makeEdge=function(){var e=new Kg,i=new Kg,n=new Bx,r=this.makeEdge_(this.eHead);return this.makeVertex_(e,r,this.vHead),this.makeVertex_(i,r.Sym,this.vHead),this.makeFace_(n,r,this.fHead),r},t.prototype.splice=function(e,i){var n=!1,r=!1;if(e!==i){if(i.Org!==e.Org&&(r=!0,this.killVertex_(i.Org,e.Org)),i.Lface!==e.Lface&&(n=!0,this.killFace_(i.Lface,e.Lface)),this.splice_(i,e),!r){var s=new Kg;this.makeVertex_(s,i,e.Org),e.Org.anEdge=e}if(!n){var o=new Bx;this.makeFace_(o,i,e.Lface),e.Lface.anEdge=e}}},t.prototype.delete=function(e){var i=e.Sym,n=!1;if(e.Lface!==e.Rface&&(n=!0,this.killFace_(e.Lface,e.Rface)),e.Onext===e)this.killVertex_(e.Org,null);else if(e.Rface.anEdge=e.Oprev,e.Org.anEdge=e.Onext,this.splice_(e,e.Oprev),!n){var r=new Bx;this.makeFace_(r,e,e.Lface)}i.Onext===i?(this.killVertex_(i.Org,null),this.killFace_(i.Lface,null)):(e.Lface.anEdge=i.Oprev,i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),this.killEdge_(e)},t.prototype.addEdgeVertex=function(e){var i=this.makeEdge_(e),n=i.Sym;this.splice_(i,e.Lnext),i.Org=e.Dst;var r=new Kg;return this.makeVertex_(r,n,i.Org),i.Lface=n.Lface=e.Lface,i},t.prototype.splitEdge=function(e){var i=this.addEdgeVertex(e),n=i.Sym;return this.splice_(e.Sym,e.Sym.Oprev),this.splice_(e.Sym,n),e.Dst=n.Org,n.Dst.anEdge=n.Sym,n.Rface=e.Rface,n.winding=e.winding,n.Sym.winding=e.Sym.winding,n.idx=e.idx,n.Sym.idx=e.Sym.idx,n},t.prototype.connect=function(e,i){var n=!1,r=this.makeEdge_(e),s=r.Sym;if(i.Lface!==e.Lface&&(n=!0,this.killFace_(i.Lface,e.Lface)),this.splice_(r,e.Lnext),this.splice_(s,i),r.Org=e.Dst,s.Org=i.Org,r.Lface=s.Lface=e.Lface,e.Lface.anEdge=s,!n){var o=new Bx;this.makeFace_(o,r,e.Lface)}return r},t.prototype.zapFace=function(e){var i=e.anEdge,n,r,s,o,a;r=i.Lnext;do n=r,r=n.Lnext,n.Lface=null,n.Rface===null&&(n.Onext===n?this.killVertex_(n.Org,null):(n.Org.anEdge=n.Onext,this.splice_(n,n.Oprev)),s=n.Sym,s.Onext===s?this.killVertex_(s.Org,null):(s.Org.anEdge=s.Onext,this.splice_(s,s.Oprev)),this.killEdge_(n));while(n!=i);o=e.prev,a=e.next,a.prev=o,o.next=a},t.prototype.countFaceVerts_=function(e){var i=e.anEdge,n=0;do n++,i=i.Lnext;while(i!==e.anEdge);return n},t.prototype.mergeConvexFaces=function(e){var i,n,r,s,o,a,l;for(i=this.fHead.next;i!==this.fHead;i=i.next)if(i.inside)for(n=i.anEdge,o=n.Org;r=n.Lnext,s=n.Sym,s&&s.Lface&&s.Lface.inside&&(a=this.countFaceVerts_(i),l=this.countFaceVerts_(s.Lface),a+l-2<=e&&Ct.vertCCW(n.Lprev.Org,n.Org,s.Lnext.Lnext.Org)&&Ct.vertCCW(s.Lprev.Org,s.Org,n.Lnext.Lnext.Org)&&(r=s.Lnext,this.delete(s),n=null,s=null)),!(n&&n.Lnext.Org===o);)n=r;return!0},t.prototype.check=function(){var e=this.fHead,i=this.vHead,n=this.eHead,r,s,o,a,l,c;for(s=e,s=e;(r=s.next)!==e;s=r){Ft(r.prev===s),l=r.anEdge;do Ft(l.Sym!==l),Ft(l.Sym.Sym===l),Ft(l.Lnext.Onext.Sym===l),Ft(l.Onext.Sym.Lnext===l),Ft(l.Lface===r),l=l.Lnext;while(l!==r.anEdge)}for(Ft(r.prev===s&&r.anEdge===null),a=i,a=i;(o=a.next)!==i;a=o){Ft(o.prev===a),l=o.anEdge;do Ft(l.Sym!==l),Ft(l.Sym.Sym===l),Ft(l.Lnext.Onext.Sym===l),Ft(l.Onext.Sym.Lnext===l),Ft(l.Org===o),l=l.Onext;while(l!==o.anEdge)}for(Ft(o.prev===a&&o.anEdge===null),c=n,c=n;(l=c.next)!==n;c=l)Ft(l.Sym.next===c.Sym),Ft(l.Sym!==l),Ft(l.Sym.Sym===l),Ft(l.Org!==null),Ft(l.Dst!==null),Ft(l.Lnext.Onext.Sym===l),Ft(l.Onext.Sym.Lnext===l);Ft(l.Sym.next===c.Sym&&l.Sym===this.eHeadSym&&l.Sym.Sym===l&&l.Org===null&&l.Dst===null&&l.Lface===null&&l.Rface===null)},t}(),F9=function(){function t(){this.handle=null}return t}(),N9=function(){function t(){this.key=null,this.node=0}return t}(),qke=function(){function t(e,i){this.leq=i,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=e,this.nodes=[],this.handles=[];for(var n=0;n<e+1;n++)this.nodes[n]=new F9,this.handles[n]=new N9;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return t.prototype.floatDown_=function(e){var i=this.nodes,n=this.handles,r,s,o;for(r=i[e].handle;;){if(o=e<<1,o<this.size&&this.leq(n[i[o+1].handle].key,n[i[o].handle].key)&&++o,Ft(o<=this.max),s=i[o].handle,o>this.size||this.leq(n[r].key,n[s].key)){i[e].handle=r,n[r].node=e;break}i[e].handle=s,n[s].node=e,e=o}},t.prototype.floatUp_=function(e){var i=this.nodes,n=this.handles,r,s,o;for(r=i[e].handle;;){if(o=e>>1,s=i[o].handle,o===0||this.leq(n[s].key,n[r].key)){i[e].handle=r,n[r].node=e;break}i[e].handle=s,n[s].node=e,e=o}},t.prototype.init=function(){for(var e=this.size;e>=1;--e)this.floatDown_(e);this.initialized=!0},t.prototype.min=function(){return this.handles[this.nodes[1].handle].key},t.prototype.insert=function(e){var i,n;if(i=++this.size,i*2>this.max){this.max*=2;var r,s;for(s=this.nodes.length,this.nodes.length=this.max+1,r=s;r<this.nodes.length;r++)this.nodes[r]=new F9;for(s=this.handles.length,this.handles.length=this.max+1,r=s;r<this.handles.length;r++)this.handles[r]=new N9}return this.freeList===0?n=i:(n=this.freeList,this.freeList=this.handles[n].node),this.nodes[i].handle=n,this.handles[n].node=i,this.handles[n].key=e,this.initialized&&this.floatUp_(i),n},t.prototype.extractMin=function(){var e=this.nodes,i=this.handles,n=e[1].handle,r=i[n].key;return this.size>0&&(e[1].handle=e[this.size].handle,i[e[1].handle].node=1,i[n].key=null,i[n].node=this.freeList,this.freeList=n,--this.size,this.size>0&&this.floatDown_(1)),r},t.prototype.delete=function(e){var i=this.nodes,n=this.handles,r;Ft(e>=1&&e<=this.max&&n[e].key!==null),r=n[e].node,i[r].handle=i[this.size].handle,n[i[r].handle].node=r,--this.size,r<=this.size&&(r<=1||this.leq(n[i[r>>1].handle].key,n[i[r].handle].key)?this.floatDown_(r):this.floatUp_(r)),n[e].key=null,n[e].node=this.freeList,this.freeList=e},t}(),S3=function(){function t(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return t}(),U9=function(){function t(){this.key=null,this.next=null,this.prev=null}return t}(),Yke=function(){function t(e,i){this.frame=e,this.leq=i,this.head=new U9,this.head.next=this.head,this.head.prev=this.head}return t.prototype.min=function(){return this.head.next},t.prototype.max=function(){return this.head.prev},t.prototype.insert=function(e){return this.insertBefore(this.head,e)},t.prototype.search=function(e){var i=this.head;do i=i.next;while(i.key!==null&&!this.leq(this.frame,e,i.key));return i},t.prototype.insertBefore=function(e,i){do e=e.prev;while(e.key!==null&&!this.leq(this.frame,e.key,i));var n=new U9;return n.key=i,n.next=e.next,e.next.prev=n,n.prev=e,e.next=n,n},t.prototype.delete=function(e){e.next.prev=e.prev,e.prev.next=e.next},t}(),Qke=function(){function t(){}return t.regionBelow=function(e){return e.nodeUp.prev.key},t.regionAbove=function(e){return e.nodeUp.next.key},t.debugEvent=function(e){},t.addWinding=function(e,i){e.winding+=i.winding,e.Sym.winding+=i.Sym.winding},t.edgeLeq=function(e,i,n){var r=e.event,s=i.eUp,o=n.eUp;if(s.Dst===r)return o.Dst===r?Ct.vertLeq(s.Org,o.Org)?Ct.edgeSign(o.Dst,s.Org,o.Org)<=0:Ct.edgeSign(s.Dst,o.Org,s.Org)>=0:Ct.edgeSign(o.Dst,r,o.Org)<=0;if(o.Dst===r)return Ct.edgeSign(s.Dst,r,s.Org)>=0;var a=Ct.edgeEval(s.Dst,r,s.Org),l=Ct.edgeEval(o.Dst,r,o.Org);return a>=l},t.deleteRegion=function(e,i){i.fixUpperEdge&&Ft(i.eUp.winding===0),i.eUp.activeRegion=null,e.dict.delete(i.nodeUp)},t.fixUpperEdge=function(e,i,n){Ft(i.fixUpperEdge),e.mesh.delete(i.eUp),i.fixUpperEdge=!1,i.eUp=n,n.activeRegion=i},t.topLeftRegion=function(e,i){var n=i.eUp.Org,r;do i=t.regionAbove(i);while(i.eUp.Org===n);if(i.fixUpperEdge){if(r=e.mesh.connect(t.regionBelow(i).eUp.Sym,i.eUp.Lnext),r===null)return null;t.fixUpperEdge(e,i,r),i=t.regionAbove(i)}return i},t.topRightRegion=function(e){var i=e.eUp.Dst;do e=t.regionAbove(e);while(e.eUp.Dst===i);return e},t.addRegionBelow=function(e,i,n){var r=new S3;return r.eUp=n,r.nodeUp=e.dict.insertBefore(i.nodeUp,r),r.fixUpperEdge=!1,r.sentinel=!1,r.dirty=!1,n.activeRegion=r,r},t.isWindingInside=function(e,i){switch(e.windingRule){case Gi.ODD:return(i&1)!==0;case Gi.NONZERO:return i!==0;case Gi.POSITIVE:return i>0;case Gi.NEGATIVE:return i<0;case Gi.ABS_GEQ_TWO:return i>=2||i<=-2}throw new Error("Invalid winding rulle")},t.computeWinding=function(e,i){i.windingNumber=t.regionAbove(i).windingNumber+i.eUp.winding,i.inside=t.isWindingInside(e,i.windingNumber)},t.finishRegion=function(e,i){var n=i.eUp,r=n.Lface;r.inside=i.inside,r.anEdge=n,t.deleteRegion(e,i)},t.finishLeftRegions=function(e,i,n){for(var r,s=null,o=i,a=i.eUp;o!==n;){if(o.fixUpperEdge=!1,s=t.regionBelow(o),r=s.eUp,r.Org!=a.Org){if(!s.fixUpperEdge){t.finishRegion(e,o);break}r=e.mesh.connect(a.Lprev,r.Sym),t.fixUpperEdge(e,s,r)}a.Onext!==r&&(e.mesh.splice(r.Oprev,r),e.mesh.splice(a,r)),t.finishRegion(e,o),a=s.eUp,o=s}return a},t.addRightEdges=function(e,i,n,r,s,o){var a,l,c,h,u=!0;c=n;do Ft(Ct.vertLeq(c.Org,c.Dst)),t.addRegionBelow(e,i,c.Sym),c=c.Onext;while(c!==r);for(s===null&&(s=t.regionBelow(i).eUp.Rprev),l=i,h=s;a=t.regionBelow(l),c=a.eUp.Sym,c.Org===h.Org;)c.Onext!==h&&(e.mesh.splice(c.Oprev,c),e.mesh.splice(h.Oprev,c)),a.windingNumber=l.windingNumber-c.winding,a.inside=t.isWindingInside(e,a.windingNumber),l.dirty=!0,!u&&t.checkForRightSplice(e,l)&&(t.addWinding(c,h),t.deleteRegion(e,l),e.mesh.delete(h)),u=!1,l=a,h=c;l.dirty=!0,Ft(l.windingNumber-c.winding===a.windingNumber),o&&t.walkDirtyRegions(e,l)},t.spliceMergeVertices=function(e,i,n){e.mesh.splice(i,n)},t.vertexWeights=function(e,i,n){var r=Ct.vertL1dist(i,e),s=Ct.vertL1dist(n,e),o=.5*s/(r+s),a=.5*r/(r+s);e.coords[0]+=o*i.coords[0]+a*n.coords[0],e.coords[1]+=o*i.coords[1]+a*n.coords[1],e.coords[2]+=o*i.coords[2]+a*n.coords[2]},t.getIntersectData=function(e,i,n,r,s,o){i.coords[0]=i.coords[1]=i.coords[2]=0,i.idx=-1,t.vertexWeights(i,n,r),t.vertexWeights(i,s,o)},t.checkForRightSplice=function(e,i){var n=t.regionBelow(i),r=i.eUp,s=n.eUp;if(Ct.vertLeq(r.Org,s.Org)){if(Ct.edgeSign(s.Dst,r.Org,s.Org)>0)return!1;Ct.vertEq(r.Org,s.Org)?r.Org!==s.Org&&(e.pq.delete(r.Org.pqHandle),t.spliceMergeVertices(e,s.Oprev,r)):(e.mesh.splitEdge(s.Sym),e.mesh.splice(r,s.Oprev),i.dirty=n.dirty=!0)}else{if(Ct.edgeSign(r.Dst,s.Org,r.Org)<0)return!1;t.regionAbove(i).dirty=i.dirty=!0,e.mesh.splitEdge(r.Sym),e.mesh.splice(s.Oprev,r)}return!0},t.checkForLeftSplice=function(e,i){var n=t.regionBelow(i),r=i.eUp,s=n.eUp,o;if(Ft(!Ct.vertEq(r.Dst,s.Dst)),Ct.vertLeq(r.Dst,s.Dst)){if(Ct.edgeSign(r.Dst,s.Dst,r.Org)<0)return!1;t.regionAbove(i).dirty=i.dirty=!0,o=e.mesh.splitEdge(r),e.mesh.splice(s.Sym,o),o.Lface.inside=i.inside}else{if(Ct.edgeSign(s.Dst,r.Dst,s.Org)>0)return!1;i.dirty=n.dirty=!0,o=e.mesh.splitEdge(s),e.mesh.splice(r.Lnext,s.Sym),o.Rface.inside=i.inside}return!0},t.checkForIntersect=function(e,i){var n=t.regionBelow(i),r=i.eUp,s=n.eUp,o=r.Org,a=s.Org,l=r.Dst,c=s.Dst,h,u,d=new Kg,f,p;if(Ft(!Ct.vertEq(c,l)),Ft(Ct.edgeSign(l,e.event,o)<=0),Ft(Ct.edgeSign(c,e.event,a)>=0),Ft(o!==e.event&&a!==e.event),Ft(!i.fixUpperEdge&&!n.fixUpperEdge),o===a||(h=Math.min(o.t,l.t),u=Math.max(a.t,c.t),h>u))return!1;if(Ct.vertLeq(o,a)){if(Ct.edgeSign(c,o,a)>0)return!1}else if(Ct.edgeSign(l,a,o)<0)return!1;return t.debugEvent(e),Ct.intersect(l,o,c,a,d),Ft(Math.min(o.t,l.t)<=d.t),Ft(d.t<=Math.max(a.t,c.t)),Ft(Math.min(c.s,l.s)<=d.s),Ft(d.s<=Math.max(a.s,o.s)),Ct.vertLeq(d,e.event)&&(d.s=e.event.s,d.t=e.event.t),f=Ct.vertLeq(o,a)?o:a,Ct.vertLeq(f,d)&&(d.s=f.s,d.t=f.t),Ct.vertEq(d,o)||Ct.vertEq(d,a)?(t.checkForRightSplice(e,i),!1):!Ct.vertEq(l,e.event)&&Ct.edgeSign(l,e.event,d)>=0||!Ct.vertEq(c,e.event)&&Ct.edgeSign(c,e.event,d)<=0?c===e.event?(e.mesh.splitEdge(r.Sym),e.mesh.splice(s.Sym,r),i=t.topLeftRegion(e,i),r=t.regionBelow(i).eUp,t.finishLeftRegions(e,t.regionBelow(i),n),t.addRightEdges(e,i,r.Oprev,r,r,!0),!0):l===e.event?(e.mesh.splitEdge(s.Sym),e.mesh.splice(r.Lnext,s.Oprev),n=i,i=t.topRightRegion(i),p=t.regionBelow(i).eUp.Rprev,n.eUp=s.Oprev,s=t.finishLeftRegions(e,n,null),t.addRightEdges(e,i,s.Onext,r.Rprev,p,!0),!0):(Ct.edgeSign(l,e.event,d)>=0&&(t.regionAbove(i).dirty=i.dirty=!0,e.mesh.splitEdge(r.Sym),r.Org.s=e.event.s,r.Org.t=e.event.t),Ct.edgeSign(c,e.event,d)<=0&&(i.dirty=n.dirty=!0,e.mesh.splitEdge(s.Sym),s.Org.s=e.event.s,s.Org.t=e.event.t),!1):(e.mesh.splitEdge(r.Sym),e.mesh.splitEdge(s.Sym),e.mesh.splice(s.Oprev,r),r.Org.s=d.s,r.Org.t=d.t,r.Org.pqHandle=e.pq.insert(r.Org),t.getIntersectData(e,r.Org,o,l,a,c),t.regionAbove(i).dirty=i.dirty=n.dirty=!0,!1)},t.walkDirtyRegions=function(e,i){for(var n=t.regionBelow(i),r,s;;){for(;n.dirty;)i=n,n=t.regionBelow(n);if(!i.dirty&&(n=i,i=t.regionAbove(i),i===null||!i.dirty))return;if(i.dirty=!1,r=i.eUp,s=n.eUp,r.Dst!==s.Dst&&t.checkForLeftSplice(e,i)&&(n.fixUpperEdge?(t.deleteRegion(e,n),e.mesh.delete(s),n=t.regionBelow(i),s=n.eUp):i.fixUpperEdge&&(t.deleteRegion(e,i),e.mesh.delete(r),i=t.regionAbove(n),r=i.eUp)),r.Org!==s.Org)if(r.Dst!==s.Dst&&!i.fixUpperEdge&&!n.fixUpperEdge&&(r.Dst===e.event||s.Dst===e.event)){if(t.checkForIntersect(e,i))return}else t.checkForRightSplice(e,i);r.Org===s.Org&&r.Dst===s.Dst&&(t.addWinding(s,r),t.deleteRegion(e,i),e.mesh.delete(r),i=t.regionAbove(n))}},t.connectRightVertex=function(e,i,n){var r,s=n.Onext,o=t.regionBelow(i),a=i.eUp,l=o.eUp,c=!1;if(a.Dst!==l.Dst&&t.checkForIntersect(e,i),Ct.vertEq(a.Org,e.event)&&(e.mesh.splice(s.Oprev,a),i=t.topLeftRegion(e,i),s=t.regionBelow(i).eUp,t.finishLeftRegions(e,t.regionBelow(i),o),c=!0),Ct.vertEq(l.Org,e.event)&&(e.mesh.splice(n,l.Oprev),n=t.finishLeftRegions(e,o,null),c=!0),c){t.addRightEdges(e,i,n.Onext,s,s,!0);return}Ct.vertLeq(l.Org,a.Org)?r=l.Oprev:r=a,r=e.mesh.connect(n.Lprev,r),t.addRightEdges(e,i,r,r.Onext,r.Onext,!1),r.Sym.activeRegion.fixUpperEdge=!0,t.walkDirtyRegions(e,i)},t.connectLeftDegenerate=function(e,i,n){var r,s,o,a,l;if(r=i.eUp,Ct.vertEq(r.Org,n)){Ft(!1),t.spliceMergeVertices(e,r,n.anEdge);return}if(!Ct.vertEq(r.Dst,n)){e.mesh.splitEdge(r.Sym),i.fixUpperEdge&&(e.mesh.delete(r.Onext),i.fixUpperEdge=!1),e.mesh.splice(n.anEdge,r),t.sweepEvent(e,n);return}Ft(!1),i=t.topRightRegion(i),l=t.regionBelow(i),o=l.eUp.Sym,s=a=o.Onext,l.fixUpperEdge&&(Ft(s!==o),t.deleteRegion(e,l),e.mesh.delete(o),o=s.Oprev),e.mesh.splice(n.anEdge,o),Ct.edgeGoesLeft(s)||(s=null),t.addRightEdges(e,i,o.Onext,a,s,!0)},t.connectLeftVertex=function(e,i){var n,r,s,o,a,l,c=new S3;if(c.eUp=i.anEdge.Sym,n=e.dict.search(c).key,r=t.regionBelow(n),!!r){if(o=n.eUp,a=r.eUp,Ct.edgeSign(o.Dst,i,o.Org)===0){t.connectLeftDegenerate(e,n,i);return}if(s=Ct.vertLeq(a.Dst,o.Dst)?n:r,n.inside||s.fixUpperEdge){if(s===n)l=e.mesh.connect(i.anEdge.Sym,o.Lnext);else{var h=e.mesh.connect(a.Dnext,i.anEdge);l=h.Sym}s.fixUpperEdge?t.fixUpperEdge(e,s,l):t.computeWinding(e,t.addRegionBelow(e,n,l)),t.sweepEvent(e,i)}else t.addRightEdges(e,n,i.anEdge,i.anEdge,null,!0)}},t.sweepEvent=function(e,i){e.event=i,t.debugEvent(e);for(var n=i.anEdge;n.activeRegion===null;)if(n=n.Onext,n===i.anEdge){t.connectLeftVertex(e,i);return}var r=t.topLeftRegion(e,n.activeRegion);Ft(r!==null);var s=t.regionBelow(r),o=s.eUp,a=t.finishLeftRegions(e,s,null);a.Onext===o?t.connectRightVertex(e,r,a):t.addRightEdges(e,r,a.Onext,o,o,!0)},t.addSentinel=function(e,i,n,r){var s=new S3,o=e.mesh.makeEdge();o.Org.s=n,o.Org.t=r,o.Dst.s=i,o.Dst.t=r,e.event=o.Dst,s.eUp=o,s.windingNumber=0,s.inside=!1,s.fixUpperEdge=!1,s.sentinel=!0,s.dirty=!1,s.nodeUp=e.dict.insert(s)},t.initEdgeDict=function(e){e.dict=new Yke(e,t.edgeLeq);var i=e.bmax[0]-e.bmin[0],n=e.bmax[1]-e.bmin[1],r=e.bmin[0]-i,s=e.bmax[0]+i,o=e.bmin[1]-n,a=e.bmax[1]+n;t.addSentinel(e,r,s,o),t.addSentinel(e,r,s,a)},t.doneEdgeDict=function(e){for(var i,n=0;(i=e.dict.min().key)!==null;)i.sentinel||(Ft(i.fixUpperEdge),Ft(++n===1)),Ft(i.windingNumber===0),t.deleteRegion(e,i)},t.removeDegenerateEdges=function(e){var i,n,r,s=e.mesh.eHead;for(i=s.next;i!==s;i=n)n=i.next,r=i.Lnext,Ct.vertEq(i.Org,i.Dst)&&i.Lnext.Lnext!==i&&(t.spliceMergeVertices(e,r,i),e.mesh.delete(i),i=r,r=i.Lnext),r.Lnext===i&&(r!==i&&((r===n||r===n.Sym)&&(n=n.next),e.mesh.delete(r)),(i===n||i===n.Sym)&&(n=n.next),e.mesh.delete(i))},t.initPriorityQ=function(e){var i,n,r,s=0;for(r=e.mesh.vHead,n=r.next;n!==r;n=n.next)s++;for(s+=8,i=e.pq=new qke(s,Ct.vertLeq),r=e.mesh.vHead,n=r.next;n!==r;n=n.next)n.pqHandle=i.insert(n);return n!==r?!1:(i.init(),!0)},t.donePriorityQ=function(e){e.pq=null},t.removeDegenerateFaces=function(e,i){var n,r,s;for(n=i.fHead.next;n!==i.fHead;n=r)r=n.next,s=n.anEdge,Ft(s.Lnext!==s),s.Lnext.Lnext===s&&(t.addWinding(s.Onext,s),e.mesh.delete(s));return!0},t.computeInterior=function(e,i){i===void 0&&(i=!0);var n,r;if(t.removeDegenerateEdges(e),!t.initPriorityQ(e))return!1;for(t.initEdgeDict(e);(n=e.pq.extractMin())!==null;){for(;r=e.pq.min(),!(r===null||!Ct.vertEq(r,n));)r=e.pq.extractMin(),t.spliceMergeVertices(e,n.anEdge,r.anEdge);t.sweepEvent(e,n)}return e.event=e.dict.min().key.eUp.Org,t.debugEvent(e),t.doneEdgeDict(e),t.donePriorityQ(e),t.removeDegenerateFaces(e,e.mesh)?(i&&e.mesh.check(),!0):!1},t}(),Kke=function(){function t(){this.mesh=new O9,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=Gi.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return t.prototype.dot_=function(e,i){return e[0]*i[0]+e[1]*i[1]+e[2]*i[2]},t.prototype.normalize_=function(e){var i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(!i)throw"Zero-size vector!";i=Math.sqrt(i),e[0]/=i,e[1]/=i,e[2]/=i},t.prototype.longAxis_=function(e){var i=0;return Math.abs(e[1])>Math.abs(e[0])&&(i=1),Math.abs(e[2])>Math.abs(e[i])&&(i=2),i},t.prototype.computeNormal_=function(e){var i,n,r,s,o,a,l=[0,0,0],c=[0,0,0],h=[0,0,0],u=[0,0,0],d=[0,0,0],f=[null,null,null],p=[null,null,null],m=this.mesh.vHead;i=m.next;for(var v=0;v<3;++v)s=i.coords[v],c[v]=s,p[v]=i,l[v]=s,f[v]=i;for(i=m.next;i!==m;i=i.next)for(var g=0;g<3;++g)s=i.coords[g],s<c[g]&&(c[g]=s,p[g]=i),s>l[g]&&(l[g]=s,f[g]=i);var y=0;if(l[1]-c[1]>l[0]-c[0]&&(y=1),l[2]-c[2]>l[y]-c[y]&&(y=2),c[y]>=l[y]){e[0]=0,e[1]=0,e[2]=1;return}for(a=0,n=p[y],r=f[y],h[0]=n.coords[0]-r.coords[0],h[1]=n.coords[1]-r.coords[1],h[2]=n.coords[2]-r.coords[2],i=m.next;i!==m;i=i.next)u[0]=i.coords[0]-r.coords[0],u[1]=i.coords[1]-r.coords[1],u[2]=i.coords[2]-r.coords[2],d[0]=h[1]*u[2]-h[2]*u[1],d[1]=h[2]*u[0]-h[0]*u[2],d[2]=h[0]*u[1]-h[1]*u[0],o=d[0]*d[0]+d[1]*d[1]+d[2]*d[2],o>a&&(a=o,e[0]=d[0],e[1]=d[1],e[2]=d[2]);a<=0&&(e[0]=e[1]=e[2]=0,e[this.longAxis_(h)]=1)},t.prototype.checkOrientation_=function(){for(var e=this.mesh.fHead,i,n=this.mesh.vHead,r,s=0,o=e.next;o!==e;o=o.next)if(r=o.anEdge,!(r.winding<=0))do s+=(r.Org.s-r.Dst.s)*(r.Org.t+r.Dst.t),r=r.Lnext;while(r!==o.anEdge);if(s<0){for(i=n.next;i!==n;i=i.next)i.t=-i.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},t.prototype.projectPolygon_=function(){var e=this.mesh.vHead,i=[0,0,0],n,r,s=!1;i[0]=this.normal[0],i[1]=this.normal[1],i[2]=this.normal[2],!i[0]&&!i[1]&&!i[2]&&(this.computeNormal_(i),s=!0),n=this.sUnit,r=this.tUnit;var o=this.longAxis_(i);n[o]=0,n[(o+1)%3]=1,n[(o+2)%3]=0,r[o]=0,r[(o+1)%3]=0,r[(o+2)%3]=i[o]>0?1:-1;for(var a=e.next;a!==e;a=a.next)a.s=this.dot_(a.coords,n),a.t=this.dot_(a.coords,r);s&&this.checkOrientation_();for(var l=!0,c=e.next;c!==e;c=c.next)l?(this.bmin[0]=this.bmax[0]=c.s,this.bmin[1]=this.bmax[1]=c.t,l=!1):(c.s<this.bmin[0]&&(this.bmin[0]=c.s),c.s>this.bmax[0]&&(this.bmax[0]=c.s),c.t<this.bmin[1]&&(this.bmin[1]=c.t),c.t>this.bmax[1]&&(this.bmax[1]=c.t))},t.prototype.addWinding_=function(e,i){e.winding+=i.winding,e.Sym.winding+=i.Sym.winding},t.prototype.tessellateMonoRegion_=function(e,i){var n,r;if(n=i.anEdge,!(n.Lnext!==n&&n.Lnext.Lnext!==n))throw"Mono region invalid";for(;Ct.vertLeq(n.Dst,n.Org);n=n.Lprev);for(;Ct.vertLeq(n.Org,n.Dst);n=n.Lnext);r=n.Lprev;for(var s=void 0;n.Lnext!==r;)if(Ct.vertLeq(n.Dst,r.Org)){for(;r.Lnext!==n&&(Ct.edgeGoesLeft(r.Lnext)||Ct.edgeSign(r.Org,r.Dst,r.Lnext.Dst)<=0);)s=e.connect(r.Lnext,r),r=s.Sym;r=r.Lprev}else{for(;r.Lnext!==n&&(Ct.edgeGoesRight(n.Lprev)||Ct.edgeSign(n.Dst,n.Org,n.Lprev.Org)>=0);)s=e.connect(n,n.Lprev),n=s.Sym;n=n.Lnext}if(r.Lnext===n)throw"Mono region invalid";for(;r.Lnext.Lnext!==n;)s=e.connect(r.Lnext,r),r=s.Sym;return!0},t.prototype.tessellateInterior_=function(e){for(var i,n=e.fHead.next;n!==e.fHead;n=i)if(i=n.next,n.inside&&!this.tessellateMonoRegion_(e,n))return!1;return!0},t.prototype.discardExterior_=function(e){for(var i,n=e.fHead.next;n!==e.fHead;n=i)i=n.next,n.inside||e.zapFace(n)},t.prototype.setWindingNumber_=function(e,i,n){for(var r,s=e.eHead.next;s!==e.eHead;s=r)r=s.next,s.Rface.inside!==s.Lface.inside?s.winding=s.Lface.inside?i:-i:n?e.delete(s):s.winding=0},t.prototype.getNeighbourFace_=function(e){return!e.Rface||!e.Rface.inside?-1:e.Rface.n},t.prototype.outputPolymesh_=function(e,i,n,r){var s,o=0,a=0,l;n>3&&e.mergeConvexFaces(n);for(var c=e.vHead.next;c!==e.vHead;c=c.next)c.n=-1;for(var h=e.fHead.next;h!==e.fHead;h=h.next)if(h.n=-1,!!h.inside){s=h.anEdge,l=0;do{var c=s.Org;c.n===-1&&(c.n=a,a++),l++,s=s.Lnext}while(s!==h.anEdge);if(l>n)throw"Face vertex greater that support polygon";h.n=o,++o}this.elementCount=o,i===hr.CONNECTED_POLYGONS&&(o*=2),this.elements=[],this.elements.length=o*n,this.vertexCount=a,this.vertices=[],this.vertices.length=a*r,this.vertexIndices=[],this.vertexIndices.length=a;for(var c=e.vHead.next;c!==e.vHead;c=c.next)if(c.n!==-1){var u=c.n*r;this.vertices[u+0]=c.coords[0],this.vertices[u+1]=c.coords[1],r>2&&(this.vertices[u+2]=c.coords[2]),this.vertexIndices[c.n]=c.idx}for(var d=0,h=e.fHead.next;h!==e.fHead;h=h.next)if(h.inside){s=h.anEdge,l=0;do{var c=s.Org;this.elements[d++]=c.n,l++,s=s.Lnext}while(s!==h.anEdge);for(var f=l;f<n;++f)this.elements[d++]=-1;if(i===hr.CONNECTED_POLYGONS){s=h.anEdge;do this.elements[d++]=this.getNeighbourFace_(s),s=s.Lnext;while(s!==h.anEdge);for(var p=l;p<n;++p)this.elements[d++]=-1}}},t.prototype.outputContours_=function(e,i){var n,r,s=0,o=0;this.vertexCount=0,this.elementCount=0;for(var a=e.fHead.next;a!==e.fHead;a=a.next)if(a.inside){r=n=a.anEdge;do this.vertexCount++,n=n.Lnext;while(n!==r);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*i,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var l=0,c=0,h=0;s=0;for(var a=e.fHead.next;a!==e.fHead;a=a.next)if(a.inside){o=0,r=n=a.anEdge;do this.vertices[l++]=n.Org.coords[0],this.vertices[l++]=n.Org.coords[1],i>2&&(this.vertices[l++]=n.Org.coords[2]),this.vertexIndices[c++]=this.vertexIdCallback?this.vertexIdCallback(n):n.Org.idx,o++,n=n.Lnext;while(n!==r);this.elements[h++]=s,this.elements[h++]=o,s+=o}},t.prototype.addContour=function(e,i){this.mesh===null&&(this.mesh=new O9),e<2&&(e=2),e>3&&(e=3);for(var n=null,r=0;r<i.length;r+=e)n===null?(n=this.mesh.makeEdge(),this.mesh.splice(n,n.Sym)):(this.mesh.splitEdge(n),n=n.Lnext),n.Org.coords[0]=i[r+0],n.Org.coords[1]=i[r+1],e>2?n.Org.coords[2]=i[r+2]:n.Org.coords[2]=0,n.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(n),n.winding=1,n.Sym.winding=-1},t.prototype.tesselate=function(e,i,n,r,s,o){if(e===void 0&&(e=Gi.ODD),i===void 0&&(i=hr.POLYGONS),o===void 0&&(o=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,s&&(this.normal[0]=s[0],this.normal[1]=s[1],this.normal[2]=s[2]),this.windingRule=e,r<2&&(r=2),r>3&&(r=3),!this.mesh)return!1;this.projectPolygon_(),Qke.computeInterior(this,o);var a=this.mesh;return i===hr.BOUNDARY_CONTOURS?this.setWindingNumber_(a,1,!0):this.tessellateInterior_(a),o&&a.check(),i===hr.BOUNDARY_CONTOURS?this.outputContours_(a,r):this.outputPolymesh_(a,i,n,r),!0},t}();function xd(t){var e=t.windingRule,i=e===void 0?Gi.ODD:e,n=t.elementType,r=n===void 0?hr.POLYGONS:n,s=t.polySize,o=s===void 0?3:s,a=t.vertexSize,l=a===void 0?2:a,c=t.normal,h=c===void 0?[0,0,1]:c,u=t.contours,d=u===void 0?[]:u,f=t.strict,p=f===void 0?!0:f,m=t.debug,v=m===void 0?!1:m;if(!d&&p)throw new Error("Contours can't be empty");if(d){var g=new Kke;t.edgeCreateCallback&&(g.edgeCreateCallback=t.edgeCreateCallback),t.vertexIdCallback&&(g.vertexIdCallback=t.vertexIdCallback);for(var y=0;y<d.length;y++)g.addContour(l||2,d[y]);return g.tesselate(i,r,o,l,h,p),{vertices:g.vertices,vertexIndices:g.vertexIndices,vertexCount:g.vertexCount,elements:g.elements,elementCount:g.elementCount,mesh:v?g.mesh:void 0}}}Gi.ODD;Gi.NONZERO;Gi.POSITIVE;Gi.NEGATIVE;Gi.ABS_GEQ_TWO;hr.POLYGONS;hr.CONNECTED_POLYGONS;hr.BOUNDARY_CONTOURS;var zO=class{constructor(t=256,e=!1){this.capacity=t,this.size=0,this.debug=e,this.debug&&console.log(`allocating with cap ${t}`);let i=t*zO.eSize;this.buffer=new ArrayBuffer(i);let n=Float32Array.BYTES_PER_ELEMENT,r=0;this.positions=new Float32Array(this.buffer,r*n,3*t),r+=3*t,this.normals=new Float32Array(this.buffer,r*n,3*t),r+=3*t,this.uvs=new Float32Array(this.buffer,r*n,2*t)}realloc(t,e=!1){if(t<this.size)throw Error("cannot shrink buffer");if(t<=this.capacity&&!e)return;this.debug&&console.log(`resizing from ${this.capacity} → ${t}`);let i=t*zO.eSize,n=new ArrayBuffer(i),r=Float32Array.BYTES_PER_ELEMENT,s=0,o=new Float32Array(n,s*r,3*t);s+=3*t;let a=new Float32Array(n,s*r,3*t);s+=3*t;let l=new Float32Array(n,s*r,2*t);o.set(this.positions.slice(0,this.size*3)),a.set(this.normals.slice(0,this.size*3)),l.set(this.uvs.slice(0,this.size*2)),this.buffer=n,this.positions=o,this.normals=a,this.uvs=l,this.capacity=t}get(t=1){let e=this.size+t;if(e>this.capacity){let n=this.capacity;for(;e>n;)n*=2;this.realloc(n)}let i=this.size;return this.size=e,i}reserve(t){let e=this.size+t;e>this.capacity&&this.realloc(e)}shrink(){this.debug&&console.log(`shrinking ${this.capacity} → ${this.size}`),this.realloc(this.size,!0)}},Die=zO;Die.eSize=(3+3+2)*Float32Array.BYTES_PER_ELEMENT;var rz={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},Rie={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},Iie={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},A3=(t,e)=>([i,n])=>(n<i&&(n+=e),(t>=i?t:t+e)<=n),Lie=class extends Ut{constructor(t,e,i=0,n=12,r=3,s=Gi.ODD){super(),this.type="ShapeGeometry",this.vertexCache={},this._shape=t,this._depth=e,this._bevel=i,this._curveSegments=n,this._bevelSegmentsInput=r,i<=0?(this._bevelSize=0,this._bevelSegments=0):(this._bevelSize=Math.min(i,e/2-1e-12),this._bevelSegments=Math.floor(r));let o=this._shape.extractShapePointsToFlatArray([],n),a=this._shape.shapeHoles.map(S=>{let A=S.extractShapePointsToFlatArray([],n),E=[];for(let M=A.length-1;M>=1;M-=2){let T=A[M-1],P=A[M-0];E.push(T,P)}return E}),l;try{l=xd({windingRule:s,elementType:hr.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[o]})}catch{l=rz}let c;try{c=xd({windingRule:Gi.ODD,elementType:hr.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...a]})}catch{c=Rie}if(!l)throw new Error("error generating geometry");let h=l.elementCount;if(c){l.elementCount+=c.elementCount;for(let S=0;S<c.elements.length;S++){let A=c.elements[S],E=S%2===0?l.vertexCount:0;l.elements.push(A+E)}for(let S=0;S<c.vertexIndices.length;S++){let A=c.vertexIndices[S],E=l.vertexCount;l.vertexIndices.push(A+E)}for(let S=0;S<c.vertices.length;S++){let A=c.vertices[S];l.vertices.push(A)}}let u=1/0,d=-1/0,f=1/0,p=-1/0;for(let S=0,A=l.vertexCount;S<A;S++){let E=S*2,M=l.vertices[E+0],T=l.vertices[E+1];M<u&&(u=M),M>d&&(d=M),T<f&&(f=T),T>p&&(p=T)}this._minX=u,this._minY=f,this._width=d-u,this._height=p-f,this._buffer=new Die(this._computeBufferEstimatedSize(l));let m=[],v=[];for(let S=l.elementCount-1;S>=0;S--){let A=S>=h,E=S*2,M=l.elements[E+0],T=l.elements[E+1],P=M+T,R={start:M,count:T,normals:[],continuous:[],concave:[]},U=M,F=P-1,N=M+1,W=this._shape.roundedCurves.length;do{let j=U-M,z=l.vertices[F*2+0],k=l.vertices[F*2+1],G=l.vertices[U*2+0],Z=l.vertices[U*2+1],K=l.vertices[N*2+0],re=l.vertices[N*2+1],J=G-z,le=Z-k,ae=Math.sqrt(J*J+le*le);J/=ae,le/=ae;let fe=G-K,ge=Z-re,ve=Math.sqrt(fe*fe+ge*ge);fe/=ve,ge/=ve,R.normals[j*2+0]=-ge,R.normals[j*2+1]=fe,R.concave[j]=J*ge-le*fe>0;let Y=l.vertexIndices[U];if(Array.isArray(Y))R.continuous[j]=!1;else{let[ce,de]=this._shape.getCurveIndexFromVertexId(Y-1,!0);if(de>0&&de<1)R.continuous[j]=!0;else{let xe=de===1?ce+1:ce-1;xe=(xe+W)%W;let Ce=de===1?0:1,Ne=this._shape.roundedCurves[ce].getTangent(de),Ie=this._shape.roundedCurves[xe].getTangent(Ce);R.continuous[j]=Ne.dot(Ie)>.95}}A&&(R.normals[j*2+0]*=-1,R.normals[j*2+1]*=-1),[F,U,N]=[U,N,N+1],N>=P&&(N-=T)}while(N!==M+1);let Q=[];Q.push({bevelI:0,angle:0,size:0,boundary:{vertices:l.vertices.slice(M*2,P*2),vertexCount:T,vertexIndices:new Array(T).fill(!0).map((j,z)=>[z,z]),elements:[0,T],elementCount:1,mesh:null},reverseMap:[],insetPoints:l.vertices.slice(M*2,P*2)});for(let j=1;j<=this._bevelSegments;j++){let z=j/this._bevelSegments*Math.PI/2,k=(1-Math.cos(z))*this._bevelSize,G=[],Z=[],K=0;for(let J=0;J<T;J++){let le=J*2,ae=(J-1+T)%T*2,fe=l.vertices[R.start*2+le+0],ge=l.vertices[R.start*2+le+1],ve=-R.normals[ae+0]*k,Y=-R.normals[ae+1]*k,ce=-R.normals[le+0]*k,de=-R.normals[le+1]*k;if(R.concave[J]||!R.concave[J]&&A){let xe=Math.atan2(Y,ve),Ce=Math.atan2(de,ce);Ce>xe&&(Ce-=Math.PI*2);let Ne=Ce-xe;if(R.continuous[J]||A){let Ie=xe+Ne/2,Ge=Math.cos(Ie)*k,tt=Math.sin(Ie)*k;G[2*K+0]=fe+Ge*(A?-1:1),G[2*K+1]=ge+tt*(A?-1:1),Z[K]=J,K++}else{let Ie=Math.max(1,Math.floor(n/4*Math.abs(Ne)/Math.PI));for(let Ge=0;Ge<=Ie;Ge++){let tt=xe+Ne*(Ge/Ie),at=Math.cos(tt)*k,ee=Math.sin(tt)*k;G[2*K+0]=fe+at,G[2*K+1]=ge+ee,Z[K]=J,K++}}}else G[2*K+0]=fe+ve,G[2*K+1]=ge+Y,Z[K]=J,K++,G[2*K+0]=fe,G[2*K+1]=ge,Z[K]=J,K++,G[2*K+0]=fe+ce,G[2*K+1]=ge+de,Z[K]=J,K++}let re=xd({windingRule:Gi.POSITIVE,elementType:hr.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[G],edgeCreateCallback:J=>{let le=J.Org.idx,ae=Z[le],fe=Z[(le+1)%Z.length];J.idx=[ae,fe],J.Sym.idx=[fe,ae]},vertexIdCallback:J=>{let le=J.Lprev.idx;return[le?le[1]:0,J.idx?J.idx[0]:0]}});if(!re)throw console.log("Error"),new Error(`error generating bevel geometry for ${j}'th loop`);if(!re.vertexCount)break;for(let J=0;J<re.vertexIndices.length;J++){let[le,ae]=re.vertexIndices[J];if(le===ae)continue;let fe=ae;ae<le&&(fe+=T);for(let ge=le;ge<fe;ge++){let ve=ge%T,Y=(ge+1)%T;if(!R.continuous[ve]||!R.continuous[Y]){re.vertexIndices[J]=[le,ve],re.vertexIndices.splice(J+1,0,[Y,ae]),re.vertices.splice((J+1)*2,0,re.vertices[J*2],re.vertices[J*2+1]);break}}}Q.push({bevelI:j,angle:z,size:k,boundary:re,reverseMap:Z,insetPoints:G})}let X=(j,z,k)=>{let G=0,Z=j.boundary.vertexIndices.length;for(;G<Z&&k(j.boundary.vertexIndices[z]);)z=(z+1)%Z,G++;return G},B=m.length;for(let j=1;j<Q.length;j++){let z=Q[j-1],k=Q[j],G=z.boundary.vertexIndices.length,Z=k.boundary.vertexIndices.length;if(!G||!Z)break;let K=R.concave.length,re=0,J=A3(re,T);for(;!z.boundary.vertexIndices.filter(J).length||!k.boundary.vertexIndices.filter(J).length;)re++,J=A3(re,T);let le=z.boundary.vertexIndices.findIndex(J),ae=k.boundary.vertexIndices.findIndex(J);do le=(le+1)%G;while(J(z.boundary.vertexIndices[le]));do ae=(ae+1)%Z;while(J(k.boundary.vertexIndices[ae]));re=(re+1)%T;let fe=re,ge=this._buildBevelVert(R,z,(le-1+G)%G),ve=this._buildBevelVert(R,k,(ae-1+Z)%Z),Y=ge,ce=ve,de,xe,Ce=!1;do{J=A3(re,T);let Ne=X(z,le,J),Ie=X(k,ae,J),Ge=Ce;if(Ce=!1,Ne&&!Ie){for(let tt=0;tt<Ne;tt++)de=this._buildBevelVert(R,z,(le+tt)%G,tt/(Ne-1)),m.push(Y.topN,de.topP,ce.topN),m.push(de.bottomP,Y.bottomN,ce.bottomN),Y=de;Ce=!0}else if(!Ne&&Ie)for(let tt=0;tt<Ie;tt++)xe=this._buildBevelVert(R,k,(ae+tt)%Z,tt/(Ie-1)),m.push(ce.topN,Y.topP,xe.topP),m.push(Y.bottomP,ce.bottomN,xe.bottomP),ce=xe;else if(Ne&&Ie)if(de=this._buildBevelVert(R,z,le,0),xe=this._buildBevelVert(R,k,ae,0),Ge?(m.push(Y.topN,xe.topP,ce.topN),m.push(Y.topN,de.topP,xe.topP),m.push(xe.bottomP,Y.bottomN,ce.bottomN),m.push(xe.bottomP,de.bottomP,Y.bottomN)):(m.push(ce.topN,Y.topN,de.topP),m.push(ce.topN,de.topP,xe.topP),m.push(de.bottomP,Y.bottomN,ce.bottomN),m.push(de.bottomP,ce.bottomN,xe.bottomP)),Y=de,ce=xe,Ne===Ie)for(let tt=1;tt<Ne;tt++)de=this._buildBevelVert(R,z,(le+tt)%G,tt/(Ne-1)),xe=this._buildBevelVert(R,k,(ae+tt)%Z,tt/(Ie-1)),m.push(Y.topN,de.topP,ce.topN),m.push(ce.topN,de.topP,xe.topP),m.push(de.bottomP,Y.bottomN,ce.bottomN),m.push(de.bottomP,ce.bottomN,xe.bottomP),Y=de,ce=xe;else if(Ne>Ie){let tt=Ne/Ie,at=0;for(let ee=1;ee<Ne;ee++)de=this._buildBevelVert(R,z,(le+ee)%G,ee/(Ne-1)),m.push(Y.topN,de.topP,ce.topN),m.push(de.bottomP,Y.bottomN,ce.bottomN),Y=de,ee>(at+1)*tt&&(at++,xe=this._buildBevelVert(R,k,(ae+at)%Z,at/(Ie-1)),m.push(ce.topN,de.topP,xe.topP),m.push(de.bottomP,ce.bottomN,xe.bottomP),ce=xe)}else{let tt=Ie/Ne,at=0;for(let ee=1;ee<Ie;ee++)xe=this._buildBevelVert(R,k,(ae+ee)%Z,ee/(Ie-1)),m.push(ce.topN,de.topP,xe.topP),m.push(de.bottomP,ce.bottomN,xe.bottomP),ce=xe,ee>(at+1)*tt&&(at++,de=this._buildBevelVert(R,z,(le+at)%G,at/(Ne-1)),m.push(Y.topN,de.topP,ce.topN),m.push(de.bottomP,Y.bottomN,ce.bottomN),Y=de)}le=(le+Ne)%G,ae=(ae+Ie)%Z,re=(re+1)%K}while(re!==fe)}if(this._depth>this._bevel*2&&this._buildWall(Q,R,m),A){let j=[];for(let z=m.length-1;z>=B+2;z-=3){let k=m[z-2],G=m[z-1],Z=m[z-0];j.push(Z,G,k)}m.splice(B,m.length-B,...j)}if(A){let j=[];for(let z=Q[Q.length-1].boundary.vertices.length-1;z>=1;z-=2){let k=Q[Q.length-1].boundary.vertices[z-1],G=Q[Q.length-1].boundary.vertices[z-0];j.push(k,G)}v.push(j)}if(!A){let j=Q[Q.length-1],z;try{z=xd({windingRule:Q.length>1?Gi.POSITIVE:Gi.ODD,elementType:hr.POLYGONS,vertexSize:2,strict:!0,contours:[j.insetPoints,...v]})}catch{z=Iie}if(!z)throw new Error("Error generating geometry for surface");a.length===0&&Object.assign(this,{capStartIndex:m.length});for(let k=0;k<z.elementCount*3;k+=3){let G=this._buildSurfaceVert(z,z.elements[k+0]),Z=this._buildSurfaceVert(z,z.elements[k+1]),K=this._buildSurfaceVert(z,z.elements[k+2]);m.push(G.top,Z.top,K.top),m.push(K.bottom,Z.bottom,G.bottom)}}this.vertexCache={}}this._buffer.shrink();let g=new Gt(Uint32Array.from(m),1),y=new Gt(this._buffer.positions,3),x=new Gt(this._buffer.normals,3),b=new Gt(this._buffer.uvs,2);y.needsUpdate=!0,x.needsUpdate=!0,b.needsUpdate=!0,g.needsUpdate=!0,this.setAttribute("position",y),this.setAttribute("normal",x),this.setAttribute("uv",b),this.setIndex(g)}_computeBufferEstimatedSize(t){return t.vertexCount*2*(2+this._bevelSegments)}_buildWall(t,e,i){let n=t[0];for(let r=0,s=n.boundary.vertexCount;r<s;r++){let o=this._buildBevelVert(e,n,r),a=this._buildBevelVert(e,n,(r+1)%s);i.push(a.topP,o.topN,o.bottomN),i.push(a.topP,o.bottomN,a.bottomP)}}_buildSurfaceVert(t,e){let i=e.toString();if(i in this.vertexCache)return this.vertexCache[i];let n=t.vertices[e*2+0],r=t.vertices[e*2+1],s=(n-this._minX)/this._width,o=(r-this._minY)/this._height,a=this._buffer.get(2),l=a*3,c=a*2,h={top:a+0,bottom:a+1};return this._buffer.positions[l+0]=n,this._buffer.positions[l+1]=r,this._buffer.positions[l+2]=this._depth,this._buffer.normals[l+0]=0,this._buffer.normals[l+1]=0,this._buffer.normals[l+2]=1,this._buffer.uvs[c+0]=s,this._buffer.uvs[c+1]=o,this._buffer.positions[l+3]=n,this._buffer.positions[l+4]=r,this._buffer.positions[l+5]=0,this._buffer.normals[l+3]=0,this._buffer.normals[l+4]=0,this._buffer.normals[l+5]=-1,this._buffer.uvs[c+2]=s,this._buffer.uvs[c+3]=o,this.vertexCache[i]=h,h}_buildBevelVert(t,e,i,n=1){let r=`${e.bevelI}:${i}`;if(r in this.vertexCache)return this.vertexCache[r];let[s,o]=e.boundary.vertexIndices[i],a,l,c,h;s!==o?(l=s,a=o,h=!1,c=t.continuous[l]&&t.continuous[a]):(a=s,l=(a-1+t.count)%t.count,h=t.concave[a]&&e.bevelI>0,c=t.continuous[a]||h);let u=Math.cos(e.angle),d=Math.sin(e.angle),f=i*2,p=a*2,m=l*2,v=e.boundary.vertices[f+0],g=e.boundary.vertices[f+1],y=(1-d)*this._bevelSize,x=(v-this._minX)/this._width,b=(g-this._minY)/this._height,S=t.normals[p+0],A=t.normals[p+1],E=t.normals[m+0],M=t.normals[m+1];if(h){let F=E-S,N=M-A;S=S+F*(1-n),A=A+N*(1-n);let W=Math.sqrt(S*S+A*A);S/=W,A/=W}let T=this._buffer.get(c?2:4),P=T*3,R=T*2,U={i,fi:a,topP:T+0,topN:T+0,bottomP:T+1,bottomN:T+1};return this._buffer.positions[P+0]=v,this._buffer.positions[P+1]=g,this._buffer.positions[P+2]=this._depth-y,this._buffer.normals[P+0]=S*u,this._buffer.normals[P+1]=A*u,this._buffer.normals[P+2]=d,this._buffer.uvs[R+0]=x,this._buffer.uvs[R+1]=b,this._buffer.positions[P+3]=v,this._buffer.positions[P+4]=g,this._buffer.positions[P+5]=y,this._buffer.normals[P+3]=S*u,this._buffer.normals[P+4]=A*u,this._buffer.normals[P+5]=-d,this._buffer.uvs[R+2]=b,this._buffer.uvs[R+3]=x,c||(T+=2,P+=6,R+=4,U.topP=T+0,U.bottomP=T+1,this._buffer.positions[P+0]=v,this._buffer.positions[P+1]=g,this._buffer.positions[P+2]=this._depth-y,this._buffer.normals[P+0]=E*u,this._buffer.normals[P+1]=M*u,this._buffer.normals[P+2]=d,this._buffer.uvs[R+0]=x,this._buffer.uvs[R+1]=b,this._buffer.positions[P+3]=v,this._buffer.positions[P+4]=g,this._buffer.positions[P+5]=y,this._buffer.normals[P+3]=E*u,this._buffer.normals[P+4]=M*u,this._buffer.normals[P+5]=-d,this._buffer.uvs[R+2]=b,this._buffer.uvs[R+3]=x),this.vertexCache[r]=U,U}clone(){let t=new Lie(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return t.userData=c2(this.userData),t}},Bie=class extends Ut{constructor(t,e=12,i={}){super(),this.type="ShapeGeometry",this.windingRule=Gi.ODD,this.elementType=hr.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=t,this._curveSegments=e,this._triangulationOptions=Object.assign({windingRule:Gi.ODD,elementType:hr.POLYGONS,polySize:3,vertexSize:2,strict:!0},i);let n=this._shape.extractShapePointsToFlatArray([],this._curveSegments),r=this._shape.shapeHoles.map(d=>d.extractShapePointsToFlatArray([],this._curveSegments)),s,o=!0,a=!0,l,c;for(let d=0,f=n.length/2;d<f;d++){let p=d*2,m=n[p+0],v=n[p+1];if(l!==void 0&&m!==l&&(o=!1),c!==void 0&&v!==c&&(a=!1),l=m,c=v,!o&&!a)break}if(!o&&!a)try{s=xd({contours:[n,...r],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{s=rz}let h=(s==null?void 0:s.vertexCount)??1,u=(s==null?void 0:s.elementCount)??1;if(this._positionAttribute=new Gt(new Float32Array(h*3),3),this._normalAttribute=new Gt(new Float32Array(h*3),3),this._uvAttribute=new Gt(new Float32Array(h*2),2),this._indexAttribute=new Gt(new Uint32Array(u*3),1),s){let d=1/0,f=-1/0,p=1/0,m=-1/0;for(let y=0,x=h;y<x;y++){let b=y*2,S=s.vertices[b+0],A=s.vertices[b+1];S<d&&(d=S),S>f&&(f=S),A<p&&(p=A),A>m&&(m=A)}let v=f-d,g=m-p;for(let y=0,x=h;y<x;y++){let b=y*2,S=s.vertices[b+0],A=s.vertices[b+1],E=(S-d)/v,M=(A-p)/g;this._positionAttribute.setXYZ(y,S,A,0),this._normalAttribute.setXYZ(y,0,0,1),this._uvAttribute.setXY(y,E,M)}for(let y=0,x=u;y<x;y++){let b=y*3,S=s.elements[b+0],A=s.elements[b+1],E=s.elements[b+2];this._indexAttribute.setX(b+0,S),this._indexAttribute.setX(b+1,A),this._indexAttribute.setX(b+2,E)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,((s==null?void 0:s.elementCount)??1)*3)}clone(){let t=new Bie(this._shape,this._curveSegments);return t.userData=c2(this.userData),t}},Oie=class extends Lie{constructor(t,e,i=0,n=12,r=3,s=Gi.ODD){super(t,e,i,n,r,s),this.type="ShapeGeometry"}_computeBufferEstimatedSize(t){return t.vertexCount*2*(2+this._bevelSegments)}_buildWall(t,e,i){let n=t[0];for(let r=0,s=n.boundary.vertexCount;r<s;r++){let o=this._buildBevelVert(e,n,r),a=this._buildBevelVert(e,n,(r+1)%s);i.push(a.topP,o.topN,o.bottomN),i.push(a.topP,o.bottomN,a.bottomP)}}clone(){let t=new Oie(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return t.userData=c2(this.userData),t}},Am=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){var c,h;let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:Gi.ODD},t.parameters),n=Math.abs(i.width),r=Math.abs(i.height??i.width),s=Math.abs(i.depth??0),o=t.shape??(e==null?void 0:e.shape),a=(o==null?void 0:o.roundness)??i.roundness;o!==void 0&&(o instanceof Nn?(o.width!==n||o.height!==r)&&o.applySize(n,r):o=new Nn(n,r).fromJSON(o),((c=t.parameters)==null?void 0:c.roundness)!==void 0&&((h=t.parameters)==null?void 0:h.roundness)>0&&o.update());let l=o??new Nn(n,r);return{parameters:Object.assign(i,{width:n,height:r,depth:s,roundness:a}),shape:l}}static build(t){let{depth:e,extrudeBevelSize:i,extrudeBevelSegments:n,subdivisions:r,roundness:s,windingRule:o}=t.parameters;t.shape.roundness=s;let a;return e<=0?a=new Bie(t.shape,r,{windingRule:o}):a=new Oie(t.shape,e,i,r,n,o),Object.assign(a,{userData:{...t,type:"VectorGeometry"}})}},Fie=Math.PI*2,sz=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters);return{shape:t.shape&&t.shape instanceof Nn?t.shape:new Nn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(t){let{width:e,height:i,spikes:n,angle:r,innerRadius:s,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}=t.parameters,c=t.shape,h=e*.5,u=i*.5,d=Jke(c,h,u,r*Math.PI/180,n,s);c.isClosed=!0,c.update();let f=Am.create({shape:c,parameters:{subdivisions:d,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}});return Object.assign(f,{userData:{...t,type:"EllipseGeometry"}})}};function Jke(t,e,i,n,r,s){if(n>=Fie)return r>30||r%4===0?($ke(t,e,i,s),Math.round(r/4)):k9(t,n,r,e,i,s);n=Math.max(n,.001);let o={x:0,y:i},a=n+Math.PI*.5,l={x:Math.cos(a)*e,y:Math.sin(a)*i},c=Xke({px:o.x,py:o.y,cx:l.x,cy:l.y,rx:e,ry:i,largeArcFlag:n>Math.PI,sweepFlag:!0});return r>30||r%c.length===0?Zke(t,o.x,o.y,c,r,e,i,s):k9(t,n,r,e,i,s)}function Zke(t,e,i,n,r,s,o,a){let l=Math.round(r/n.length);t.addPoint($v(e,i));for(let c=0,h=n.length;c<h;c++){let u=n[c],d=t.points[c],f=$v(u.x,u.y);d.controls[1].position.set(u.x1,u.y1),f.controls[0].position.set(u.x2,u.y2),t.addPoint(f)}return a>0?Nie(t,s,o,a):t.addPoint($v(0,0)),l}function k9(t,e,i,n,r,s){let o=-e/i;for(let a=0;a<=i;a++){let l=o*a,c=Math.sin(l)*n,h=Math.cos(l)*r;t.addPoint($v(c,h))}return e<Fie?s>0?Nie(t,n,r,s):t.addPoint($v(0,0)):(t.removePoint(t.points[t.points.length-1]),s>0&&Uie(t,n,r,s)),1}function $ke(t,e,i,n=0,r=0,s=0){let o=.5522847498,a=e*o,l=i*o;t.addPoint(GA(r-e,s,r-e,s-l,r-e,s+l)),t.addPoint(GA(r,s+i,r-a,s+i,r+a,s+i)),t.addPoint(GA(r+e,s,r+e,s+l,r+e,s-l)),t.addPoint(GA(r,s-i,r+a,s-i,r-a,s-i)),n>0&&Uie(t,e,i,n)}function $v(t,e){return new Zv(hi.generateUUID(),new he(t,e))}function GA(t,e,i,n,r,s){let o=$v(t,e);return o.controls[0].position.set(i,n),o.controls[1].position.set(r,s),o}function Nie(t,e,i,n){kie(t,e,i,n).forEach(r=>t.addPoint(r))}function Uie(t,e,i,n){let r=kie(t,e,i,n),s=new Nn;r.forEach(o=>s.addPoint(o)),s.isClosed=!0,t.shapeHoles.push(s)}function kie(t,e,i,n){let r=n*e/100,s=r*(Math.abs(i)/Math.abs(e)),o=new he(r/e,s/i),a=t.points.map(l=>{let c=l.clone();return c.uuid=hi.generateUUID(),c}).reverse();return a.forEach(l=>{l.position.multiply(o);let c=l.controls[0].position.clone().multiply(o),h=l.controls[1].position.clone().multiply(o);l.controls[0].position.copy(h),l.controls[1].position.copy(c)}),a}var eze=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},t.parameters),n=Math.abs(i.width),r=Math.abs(i.height??n),s=Math.abs(i.depth??n),o=Math.abs(Math.min(n,s))/2;return{parameters:Object.assign(i,{width:n,height:r,depth:s,radius:o,segments:Math.round(i.segments),pathSegments:Math.round(i.pathSegments),cornerSegments:Math.round(i.cornerSegments)})}}static build(t){let{width:e,height:i,depth:n,radius:r,revolutions:s,segments:o,pathRadius:a,pathType:l,pathSegments:c,cornerRadius:h,cornerSegments:u}=t.parameters,d=new zie(!1,e,i,n,r,s,o,a,l,c,h,u);return Object.assign(d,{userData:{...t,type:"HelixGeometry"}})}},M3=new Wv([0,0,0],1),zie=class extends Ut{constructor(t=!0,e=1,i=1,n=1,r=1,s=1,o=1,a=1,l=1,c=1,h=1,u=1){if(super(),s===0)return;let d=t&&s===1;d&&(u=0),h>100&&(h=100),h===0&&(u=0);let f=()=>new L,p=new L,m=f(),v=f(),g=f(),y,x,b,S,A,E,M,T,P=f(),R=f(),U=f(),F=f(),N=f(),W=f(),Q=f(),X=f(),B=i-2*a+.001,j=B/s,z=Math.ceil(o*s),k=z+1,G=B/z,Z=-B/2,K=c+1,re=2*Math.PI/c,J=Math.PI/2/u,le=.01,ae=Math.min((1-h/100)*a,a-le),fe=a-ae,ge=0,ve=2,Y=u*ve+ve,ce=K*Y/ve,de=ce+K*k,xe=K*(k+Y),[Ce,Ne,Ie]=[3,3,2].map(me=>Array(xe*me).fill(0)),Ge=[],tt=r-a;function at(me,be){let ne=Math.PI/2;E=be*G,T=2*Math.PI*(E%j)/j+ne,E+=Z,M=Math.sin(T)*tt,A=Math.cos(T)*tt,t?me.set(A,M,E):me.set(A,E,M)}at(p,-1e-10),at(m,0),P.copy(p),at(p,1);let ee=p.distanceTo(m),O=d?0:fe+ae,V=ee*z+2*O,ue=ae,Ee=V-O;for(let me=0;me<=z;me++){at(v,me),X.subVectors(v,P).normalize(),P.copy(v),W.copy(v).setComponent(+t+1,0).normalize(),Q.crossVectors(X,W).normalize();let be=me===0,ne=me===z,Ae=be?3*Math.PI/2:J,ke=be?ue:Ee,Ue=be?K:de,Je=be?0:xe-K,ut=X.clone().multiplyScalar(be?-fe:fe).add(v),Pt=X.clone().multiplyScalar(be?-1:1).normalize();for(let q=0;q<K;q++){let pe=q*re;if(R.addVectors(p.copy(W).multiplyScalar(a*Math.cos(pe)),m.copy(Q).multiplyScalar(a*Math.sin(pe))),U.copy(R).normalize(),be||ne){d||(ge=Je+q,[0,1,2].forEach(oe=>{Ce[ge*3+oe]=ut.getComponent(oe),Ne[ge*3+oe]=Pt.getComponent(oe)}),Ie[ge*2]=+ne,Ie[ge*2+1]=q/c),m.copy(U).multiplyScalar(ae),g.addVectors(v,m);for(let oe=0;oe<u;oe++){let Be=oe*J+Ae;F.addVectors(p.copy(X).multiplyScalar(fe*Math.sin(Be)),m.copy(U).multiplyScalar(fe*Math.cos(Be))),N.copy(F).normalize(),m.addVectors(g,F),F.normalize(),ge=Ue+oe*K+q,[0,1,2].forEach(mt=>{Ce[ge*3+mt]=m.getComponent(mt),Ne[ge*3+mt]=N.getComponent(mt)});let qe=+be+Math.sin(Be);Ie[ge*2]=(ke+fe*qe)/V,Ie[ge*2+1]=q/c}}m.addVectors(v,R),ge=ce+me*K+q,[0,1,2].forEach(oe=>{Ce[ge*3+oe]=m.getComponent(oe),Ne[ge*3+oe]=U.getComponent(oe)}),Ie[ge*2]=(O+me*ee)/V,Ie[ge*2+1]=q/c}}let Te=k+2*u+ve,[We,Ve]=[+d,Te-1];for(let me=We;me<=Ve-1;me++){let be=d&&me===Ve-1;for(let ne=0;ne<K-1;ne++)y=me*K+ne,x=y+1,b=(be?ne:y)+K,S=(be?ne+1:x)+K,me===0?Ge.push(x,S,b):me===Te-2?Ge.push(y,x,b):Ge.push(y,x,b,x,S,b)}this.setIndex(Ge),this.setAttribute("position",new yt(Ce,3)),this.setAttribute("normal",new yt(Ne,3)),this.setAttribute("uv",new yt(Ie,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let t=this.userData.parameters,e=Math.ceil(t.tubularSegments),i=t.radialSegments+1,n=Array.from(this.getIndex().array),r,s,o,a,l=6*(e-1)*t.radialSegments,c=e,h=c===e;for(let u=0;u<t.radialSegments;u++)r=c*i+u,s=r+1,o=(h?u:r)+i,a=(h?u+1:s)+i,n[l++]=r,n[l++]=s,n[l++]=o,n[l++]=s,n[l++]=a,n[l++]=o;return n.length=l,M3.array=n,M3.count=n.length,M3}},tze=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,detail:0,corner:0,cornerSides:4},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{width:e,height:i,depth:n,detail:r,corner:s,cornerSides:o}=t.parameters,a=r===0&&s!==0?new Gie(e*.5,s,o):new Xee(e*.5,r);return a.scale(1,i/e,n/e),Object.assign(a,{userData:{...t,type:"IcosahedronGeometry"}})}},Gie=class extends tz{constructor(t=1,e=.2,i=4){let n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],o="IcosahedronGeometry";super(r,s,o,t,e,i),this.type=o}static fromJSON(t){return new Gie(t.radius,t.corner,t.cornerSides)}},ize=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){var n;(((n=t.parameters)==null?void 0:n.points)??[]).forEach(r=>{Array.isArray(r)&&(r.x=r[0],r.y=r[1])});let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{points:e,segments:i,verticalSegments:n}=t.parameters,r=new rT;r.moveTo(e[0].x,e[0].y),r.bezierCurveTo(e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y);let s=new kee(r.extractPoints(n).shape,i);return s.rotateZ(Math.PI),Object.assign(s,{userData:{...t,type:"LatheGeometry"}})}},uc=new $e,E3=new ji,HA=new L,BT=class extends is{constructor(){super(),this.uuid=hi.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(t){let e=new Zr().getNormalMatrix(t);for(let i=0,n=this.vertices.length;i<n;i++)this.vertices[i].applyMatrix4(t);for(let i=0,n=this.faces.length;i<n;i++){let r=this.faces[i];r.normal.applyMatrix3(e).normalize();for(let s=0,o=r.vertexNormals.length;s<o;s++)r.vertexNormals[s].applyMatrix3(e).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(t){return uc.makeRotationX(t),this.applyMatrix4(uc),this}rotateY(t){return uc.makeRotationY(t),this.applyMatrix4(uc),this}rotateZ(t){return uc.makeRotationZ(t),this.applyMatrix4(uc),this}translate(t,e,i){return uc.makeTranslation(t,e,i),this.applyMatrix4(uc),this}scale(t,e,i){return uc.makeScale(t,e,i),this.applyMatrix4(uc),this}lookAt(t){return E3.lookAt(t),E3.updateMatrix(),this.applyMatrix4(E3.matrix),this}fromBufferGeometry(t){let e=this,i=t.index!==null?t.index:void 0,n=t.attributes;if(n.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let r=n.position,s=n.normal,o=n.color,a=n.uv,l=n.uv2;l!==void 0&&(this.faceVertexUvs[1]=[]);for(let u=0;u<r.count;u++)e.vertices.push(new L().fromBufferAttribute(r,u)),o!==void 0&&e.colors.push(new It().fromBufferAttribute(o,u));function c(u,d,f,p){let m=o===void 0?[]:[e.colors[u].clone(),e.colors[d].clone(),e.colors[f].clone()],v=s===void 0?[]:[new L().fromBufferAttribute(s,u),new L().fromBufferAttribute(s,d),new L().fromBufferAttribute(s,f)],g=new GO(u,d,f,v,m,p);e.faces.push(g),a!==void 0&&e.faceVertexUvs[0].push([new he().fromBufferAttribute(a,u),new he().fromBufferAttribute(a,d),new he().fromBufferAttribute(a,f)]),l!==void 0&&e.faceVertexUvs[1].push([new he().fromBufferAttribute(l,u),new he().fromBufferAttribute(l,d),new he().fromBufferAttribute(l,f)])}let h=t.groups;if(h.length>0)for(let u=0;u<h.length;u++){let d=h[u],f=d.start,p=d.count;for(let m=f,v=f+p;m<v;m+=3)i!==void 0?c(i.getX(m),i.getX(m+1),i.getX(m+2),d.materialIndex):c(m,m+1,m+2,d.materialIndex)}else if(i!==void 0)for(let u=0;u<i.count;u+=3)c(i.getX(u),i.getX(u+1),i.getX(u+2));else for(let u=0;u<r.count;u+=3)c(u,u+1,u+2);return this.computeFaceNormals(),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(HA).negate(),this.translate(HA.x,HA.y,HA.z),this}normalize(){this.computeBoundingSphere();let t=this.boundingSphere.center,e=this.boundingSphere.radius,i=e===0?1:1/e,n=new $e;return n.set(i,0,0,-i*t.x,0,i,0,-i*t.y,0,0,i,-i*t.z,0,0,0,1),this.applyMatrix4(n),this}computeFaceNormals(){let t=new L,e=new L;for(let i=0,n=this.faces.length;i<n;i++){let r=this.faces[i],s=this.vertices[r.a],o=this.vertices[r.b],a=this.vertices[r.c];t.subVectors(a,o),e.subVectors(s,o),t.cross(e),t.normalize(),r.normal.copy(t)}}computeVertexNormals(t=!0){let e=new Array(this.vertices.length);for(let i=0,n=this.vertices.length;i<n;i++)e[i]=new L;if(t){let i=new L,n=new L;for(let r=0,s=this.faces.length;r<s;r++){let o=this.faces[r],a=this.vertices[o.a],l=this.vertices[o.b],c=this.vertices[o.c];i.subVectors(c,l),n.subVectors(a,l),i.cross(n),e[o.a].add(i),e[o.b].add(i),e[o.c].add(i)}}else{this.computeFaceNormals();for(let i=0,n=this.faces.length;i<n;i++){let r=this.faces[i];e[r.a].add(r.normal),e[r.b].add(r.normal),e[r.c].add(r.normal)}}for(let i=0,n=this.vertices.length;i<n;i++)e[i].normalize();for(let i=0,n=this.faces.length;i<n;i++){let r=this.faces[i],s=r.vertexNormals;s.length===3?(s[0].copy(e[r.a]),s[1].copy(e[r.b]),s[2].copy(e[r.c])):(s[0]=e[r.a].clone(),s[1]=e[r.b].clone(),s[2]=e[r.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let t=0,e=this.faces.length;t<e;t++){let i=this.faces[t],n=i.vertexNormals;n.length===3?(n[0].copy(i.normal),n[1].copy(i.normal),n[2].copy(i.normal)):(n[0]=i.normal.clone(),n[1]=i.normal.clone(),n[2]=i.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let e=0,i=this.faces.length;e<i;e++){let n=this.faces[e];n.__originalFaceNormal?n.__originalFaceNormal.copy(n.normal):n.__originalFaceNormal=n.normal.clone(),n.__originalVertexNormals||(n.__originalVertexNormals=[]);for(let r=0,s=n.vertexNormals.length;r<s;r++)n.__originalVertexNormals[r]?n.__originalVertexNormals[r].copy(n.vertexNormals[r]):n.__originalVertexNormals[r]=n.vertexNormals[r].clone()}let t=new BT;t.faces=this.faces;for(let e=0,i=this.morphTargets.length;e<i;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];let r=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(let o=0,a=this.faces.length;o<a;o++){let l=new L,c={a:new L,b:new L,c:new L};r.push(l),s.push(c)}}let n=this.morphNormals[e];t.vertices=this.morphTargets[e].vertices,t.computeFaceNormals(),t.computeVertexNormals();for(let r=0,s=this.faces.length;r<s;r++){let o=this.faces[r],a=n.faceNormals[r],l=n.vertexNormals[r];a.copy(o.normal),l.a.copy(o.vertexNormals[0]),l.b.copy(o.vertexNormals[1]),l.c.copy(o.vertexNormals[2])}}for(let e=0,i=this.faces.length;e<i;e++){let n=this.faces[e];n.normal=n.__originalFaceNormal,n.vertexNormals=n.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Zn),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new sa),this.boundingSphere.setFromPoints(this.vertices)}merge(t,e,i=0){if(!(t&&t.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);return}let n,r=this.vertices.length,s=this.vertices,o=t.vertices,a=this.faces,l=t.faces,c=this.colors,h=t.colors;e!==void 0&&(n=new Zr().getNormalMatrix(e));for(let u=0,d=o.length;u<d;u++){let f=o[u].clone();e!==void 0&&f.applyMatrix4(e),s.push(f)}for(let u=0,d=h.length;u<d;u++)c.push(h[u].clone());for(let u=0,d=l.length;u<d;u++){let f=l[u],p,m,v=f.vertexNormals,g=f.vertexColors,y=new GO(f.a+r,f.b+r,f.c+r);y.normal.copy(f.normal),n!==void 0&&y.normal.applyMatrix3(n).normalize();for(let x=0,b=v.length;x<b;x++)p=v[x].clone(),n!==void 0&&p.applyMatrix3(n).normalize(),y.vertexNormals.push(p);y.color.copy(f.color);for(let x=0,b=g.length;x<b;x++)m=g[x],y.vertexColors.push(m.clone());y.materialIndex=f.materialIndex+i,a.push(y)}for(let u=0,d=t.faceVertexUvs.length;u<d;u++){let f=t.faceVertexUvs[u];this.faceVertexUvs[u]===void 0&&(this.faceVertexUvs[u]=[]);for(let p=0,m=f.length;p<m;p++){let v=f[p],g=[];for(let y=0,x=v.length;y<x;y++)g.push(v[y].clone());this.faceVertexUvs[u].push(g)}}}mergeMesh(t){if(!(t&&t.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t);return}t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)}mergeVertices(t=4){let e={},i=[],n=[],r=Math.pow(10,t);for(let a=0,l=this.vertices.length;a<l;a++){let c=this.vertices[a],h=Math.round(c.x*r)+"_"+Math.round(c.y*r)+"_"+Math.round(c.z*r);e[h]===void 0?(e[h]=a,i.push(this.vertices[a]),n[a]=i.length-1):n[a]=n[e[h]]}let s=[];for(let a=0,l=this.faces.length;a<l;a++){let c=this.faces[a];c.a=n[c.a],c.b=n[c.b],c.c=n[c.c];let h=[c.a,c.b,c.c];for(let u=0;u<3;u++)if(h[u]===h[(u+1)%3]){s.push(a);break}}for(let a=s.length-1;a>=0;a--){let l=s[a];this.faces.splice(l,1);for(let c=0,h=this.faceVertexUvs.length;c<h;c++)this.faceVertexUvs[c].splice(l,1)}let o=this.vertices.length-i.length;return this.vertices=i,o}setFromPoints(t){this.vertices=[];for(let e=0,i=t.length;e<i;e++){let n=t[e];this.vertices.push(new L(n.x,n.y,n.z||0))}return this}sortFacesByMaterialIndex(){let t=this.faces,e=t.length;for(let a=0;a<e;a++)t[a]._id=a;function i(a,l){return a.materialIndex-l.materialIndex}t.sort(i);let n=this.faceVertexUvs[0],r=this.faceVertexUvs[1],s,o;n&&n.length===e&&(s=[]),r&&r.length===e&&(o=[]);for(let a=0;a<e;a++){let l=t[a]._id;s&&s.push(n[l]),o&&o.push(r[l])}s&&(this.faceVertexUvs[0]=s),o&&(this.faceVertexUvs[1]=o)}toJSON(){let t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),this.parameters!==void 0){let f=this.parameters;for(let p in f)f[p]!==void 0&&(t[p]=f[p]);return t}let e=[];for(let f=0;f<this.vertices.length;f++){let p=this.vertices[f];e.push(p.x,p.y,p.z)}let i=[],n=[],r={},s=[],o={},a=[],l={};for(let f=0;f<this.faces.length;f++){let p=this.faces[f],m=!0,v=!1,g=this.faceVertexUvs[0][f]!==void 0,y=p.normal.length()>0,x=p.vertexNormals.length>0,b=p.color.r!==1||p.color.g!==1||p.color.b!==1,S=p.vertexColors.length>0,A=0;if(A=c(A,0,0),A=c(A,1,m),A=c(A,2,v),A=c(A,3,g),A=c(A,4,y),A=c(A,5,x),A=c(A,6,b),A=c(A,7,S),i.push(A),i.push(p.a,p.b,p.c),i.push(p.materialIndex),g){let E=this.faceVertexUvs[0][f];i.push(d(E[0]),d(E[1]),d(E[2]))}if(y&&i.push(h(p.normal)),x){let E=p.vertexNormals;i.push(h(E[0]),h(E[1]),h(E[2]))}if(b&&i.push(u(p.color)),S){let E=p.vertexColors;i.push(u(E[0]),u(E[1]),u(E[2]))}}function c(f,p,m){return m?f|1<<p:f&~(1<<p)}function h(f){let p=f.x.toString()+f.y.toString()+f.z.toString();return r[p]!==void 0||(r[p]=n.length/3,n.push(f.x,f.y,f.z)),r[p]}function u(f){let p=f.r.toString()+f.g.toString()+f.b.toString();return o[p]!==void 0||(o[p]=s.length,s.push(f.getHex())),o[p]}function d(f){let p=f.x.toString()+f.y.toString();return l[p]!==void 0||(l[p]=a.length/2,a.push(f.x,f.y)),l[p]}return t.data={},t.data.vertices=e,t.data.normals=n,s.length>0&&(t.data.colors=s),a.length>0&&(t.data.uvs=[a]),t.data.faces=i,t}clone(){return new BT().copy(this)}copy(t){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;let e=t.vertices;for(let u=0,d=e.length;u<d;u++)this.vertices.push(e[u].clone());let i=t.colors;for(let u=0,d=i.length;u<d;u++)this.colors.push(i[u].clone());let n=t.faces;for(let u=0,d=n.length;u<d;u++)this.faces.push(n[u].clone());for(let u=0,d=t.faceVertexUvs.length;u<d;u++){let f=t.faceVertexUvs[u];this.faceVertexUvs[u]===void 0&&(this.faceVertexUvs[u]=[]);for(let p=0,m=f.length;p<m;p++){let v=f[p],g=[];for(let y=0,x=v.length;y<x;y++){let b=v[y];g.push(b.clone())}this.faceVertexUvs[u].push(g)}}let r=t.morphTargets;for(let u=0,d=r.length;u<d;u++){let f={};if(f.name=r[u].name,r[u].vertices!==void 0){f.vertices=[];for(let p=0,m=r[u].vertices.length;p<m;p++)f.vertices.push(r[u].vertices[p].clone())}if(r[u].normals!==void 0){f.normals=[];for(let p=0,m=r[u].normals.length;p<m;p++)f.normals.push(r[u].normals[p].clone())}this.morphTargets.push(f)}let s=t.morphNormals;for(let u=0,d=s.length;u<d;u++){let f={};if(s[u].vertexNormals!==void 0){f.vertexNormals=[];for(let p=0,m=s[u].vertexNormals.length;p<m;p++){let v=s[u].vertexNormals[p],g={};g.a=v.a.clone(),g.b=v.b.clone(),g.c=v.c.clone(),f.vertexNormals.push(g)}}if(s[u].faceNormals!==void 0){f.faceNormals=[];for(let p=0,m=s[u].faceNormals.length;p<m;p++)f.faceNormals.push(s[u].faceNormals[p].clone())}this.morphNormals.push(f)}let o=t.skinWeights;for(let u=0,d=o.length;u<d;u++)this.skinWeights.push(o[u].clone());let a=t.skinIndices;for(let u=0,d=a.length;u<d;u++)this.skinIndices.push(a[u].clone());let l=t.lineDistances;for(let u=0,d=l.length;u<d;u++)this.lineDistances.push(l[u]);let c=t.boundingBox;c!==null&&(this.boundingBox=c.clone());let h=t.boundingSphere;return h!==null&&(this.boundingSphere=h.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}toBufferGeometry(){let t=new nze().fromGeometry(this),e=new Ut,i=new Float32Array(t.vertices.length*3);if(e.setAttribute("position",VA.call(new Gt(i,3),t.vertices)),t.normals.length>0){let n=new Float32Array(t.normals.length*3);e.setAttribute("normal",VA.call(new Gt(n,3),t.normals))}if(t.colors.length>0){let n=new Float32Array(t.colors.length*3);e.setAttribute("color",z9.call(new Gt(n,3),t.colors))}if(t.uvs.length>0){let n=new Float32Array(t.uvs.length*2);e.setAttribute("uv",G9.call(new Gt(n,2),t.uvs))}if(t.uvs2.length>0){let n=new Float32Array(t.uvs2.length*2);e.setAttribute("uv2",G9.call(new Gt(n,2),t.uvs2))}e.groups=t.groups;for(let n in t.morphTargets){let r=[],s=t.morphTargets[n];for(let o=0,a=s.length;o<a;o++){let l=s[o],c=new yt(l.data.length*3,3);c.name=l.name,r.push(VA.call(c,l.data))}e.morphAttributes[n]=r}if(t.skinIndices.length>0){let n=new yt(t.skinIndices.length*4,4);e.setAttribute("skinIndex",H9.call(n,t.skinIndices))}if(t.skinWeights.length>0){let n=new yt(t.skinWeights.length*4,4);e.setAttribute("skinWeight",H9.call(n,t.skinWeights))}return t.boundingSphere!==null&&(e.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(e.boundingBox=t.boundingBox.clone()),e}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(t){let e=new Ut,i=t.geometry;if(t.isPoints||t.isLine){let n=new yt(i.vertices.length*3,3),r=new yt(i.colors.length*3,3);if(e.setAttribute("position",VA.call(n,i.vertices)),e.setAttribute("color",z9.call(r,i.colors)),i.lineDistances&&i.lineDistances.length===i.vertices.length){let s=new yt(i.lineDistances.length,1);e.setAttribute("lineDistance",rze.call(s,i.lineDistances))}i.boundingSphere!==null&&(e.boundingSphere=i.boundingSphere.clone()),i.boundingBox!==null&&(e.boundingBox=i.boundingBox.clone())}else t.isMesh&&(e=i.toBufferGeometry());return e}};BT.prototype.isGeometry=!0;var nze=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(t){let e=[],i,n,r,s=t.faces;for(n=0;n<s.length;n++){let o=s[n];o.materialIndex!==r&&(r=o.materialIndex,i!==void 0&&(i.count=n*3-i.start,e.push(i)),i={start:n*3,materialIndex:r})}i!==void 0&&(i.count=n*3-i.start,e.push(i)),this.groups=e}fromGeometry(t){let e=t.faces,i=t.vertices,n=t.faceVertexUvs,r=n[0]&&n[0].length>0,s=n[1]&&n[1].length>0,o=t.morphTargets,a=o.length,l;if(a>0){l=[];for(let v=0;v<a;v++)l[v]={name:o[v].name,data:[]};this.morphTargets.position=l}let c=t.morphNormals,h=c.length,u;if(h>0){u=[];for(let v=0;v<h;v++)u[v]={name:c[v].name,data:[]};this.morphTargets.normal=u}let d=t.skinIndices,f=t.skinWeights,p=d.length===i.length,m=f.length===i.length;i.length>0&&e.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let v=0;v<e.length;v++){let g=e[v];this.vertices.push(i[g.a],i[g.b],i[g.c]);let y=g.vertexNormals;if(y.length===3)this.normals.push(y[0],y[1],y[2]);else{let b=g.normal;this.normals.push(b,b,b)}let x=g.vertexColors;if(x.length===3)this.colors.push(x[0],x[1],x[2]);else{let b=g.color;this.colors.push(b,b,b)}if(r===!0){let b=n[0][v];b!==void 0?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",v),this.uvs.push(new he,new he,new he))}if(s===!0){let b=n[1][v];b!==void 0?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",v),this.uvs2.push(new he,new he,new he))}for(let b=0;b<a;b++){let S=o[b].vertices;l[b].data.push(S[g.a],S[g.b],S[g.c])}for(let b=0;b<h;b++){let S=c[b].vertexNormals[v];u[b].data.push(S.a,S.b,S.c)}p&&this.skinIndices.push(d[g.a],d[g.b],d[g.c]),m&&this.skinWeights.push(f[g.a],f[g.b],f[g.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),this}},GO=class{constructor(t,e,i,n,r,s=0){this.a=t,this.b=e,this.c=i,this.normal=n&&n.isVector3?n:new L,this.vertexNormals=Array.isArray(n)?n:[],this.color=r&&r.isColor?r:new It,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=s}clone(){return new this.constructor().copy(this)}copy(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(let e=0,i=t.vertexNormals.length;e<i;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(let e=0,i=t.vertexColors.length;e<i;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}};function rze(t){return this.array.set(t),this}function z9(t){let e=this.array,i=0;for(let n=0,r=t.length;n<r;n++){let s=t[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),s=new It),e[i++]=s.r,e[i++]=s.g,e[i++]=s.b}return this}function G9(t){let e=this.array,i=0;for(let n=0,r=t.length;n<r;n++){let s=t[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),s=new he),e[i++]=s.x,e[i++]=s.y}return this}function VA(t){let e=this.array,i=0;for(let n=0,r=t.length;n<r;n++){let s=t[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),s=new L),e[i++]=s.x,e[i++]=s.y,e[i++]=s.z}return this}function H9(t){let e=this.array,i=0;for(let n=0,r=t.length;n<r;n++){let s=t[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),s=new Kt),e[i++]=s.x,e[i++]=s.y,e[i++]=s.z,e[i++]=s.w}return this}var sze=["a","b","c"];function oze(t,e){switch(e){case"c":return t.c;case"b":return t.b;case"a":default:return t.a}}function T3(t,e,i){let n=Math.min(t,e),r=Math.max(t,e),s=n+"_"+r;return i.get(s)}function C3(t,e,i,n,r,s){let o=Math.min(t,e),a=Math.max(t,e),l=o+"_"+a,c;if(n.has(l))c=n.get(l);else{let h=i[o],u=i[a];c={a:h,b:u,newEdge:null,faces:[]},n.set(l,c)}c.faces.push(r),s[t].edges.push(c),s[e].edges.push(c)}function aze(t,e,i,n){let r,s,o;for(r=0,s=t.length;r<s;r++)i[r]={edges:[]};for(r=0,s=e.length;r<s;r++)o=e[r],C3(o.a,o.b,t,n,o,i),C3(o.b,o.c,t,n,o,i),C3(o.c,o.a,t,n,o,i)}function jA(t,e,i,n,r){t.push(new GO(e,i,n,void 0,void 0,r))}function Og(t,e){return Math.abs(e-t)/2+Math.min(t,e)}function WA(t,e,i,n){t.push([e.clone(),i.clone(),n.clone()])}var lze=class{constructor(t=1){this.subdivisions=t}modify(t){t instanceof Ut?t=new BT().fromBufferGeometry(t):t=t.clone(),t.mergeVertices();let e=this.subdivisions;for(;e-- >0;)this._smooth(t);return t.computeFaceNormals(),t.computeVertexNormals(),t}_smooth(t){let e=new L,i,n,r,s,o,a=t.vertices,l=t.faces,c=t.faceVertexUvs[0],h=c!==void 0&&c.length>0,u=[],d=new Map;aze(a,l,u,d);let f=[],p,m,v,g,y,x,b;for(let le of Array.from(d.keys())){for(m=d.get(le),v=new L,y=3/8,x=1/8,b=m.faces.length,b!=2&&(y=.5,x=0,b!=1),v.addVectors(m.a,m.b).multiplyScalar(y),e.set(0,0,0),s=0;s<b;s++){for(g=m.faces[s],o=0;o<3&&(p=a[oze(g,sze[o])],!(p!==m.a&&p!==m.b));o++);p&&e.add(p)}e.multiplyScalar(x),v.add(e),m.newEdge=f.length,f.push(v)}let S,A,E,M,T,P,R,U=[];for(n=0,r=a.length;n<r;n++){for(P=a[n],T=u[n].edges,i=T.length,i==3?S=3/16:i>3&&(S=3/(8*i)),A=1-i*Number(S),E=S,i<=2&&(i==2?(A=3/4,E=1/8):i==1||i==0),R=P.clone().multiplyScalar(A),e.set(0,0,0),s=0;s<i;s++)M=T[s],p=M.a!==P?M.a:M.b,e.add(p);e.multiplyScalar(Number(E)),R.add(e),U.push(R)}let F=U.concat(f),N=U.length,W,Q,X,B=[],j=[],z,k,G,Z,K=new he,re=new he,J=new he;for(n=0,r=l.length;n<r;n++)g=l[n],W=Number(T3(g.a,g.b,d).newEdge)+N,Q=Number(T3(g.b,g.c,d).newEdge)+N,X=Number(T3(g.c,g.a,d).newEdge)+N,jA(B,W,Q,X,g.materialIndex),jA(B,g.a,W,X,g.materialIndex),jA(B,g.b,Q,W,g.materialIndex),jA(B,g.c,X,Q,g.materialIndex),h&&(z=c[n],k=z[0],G=z[1],Z=z[2],K.set(Og(k.x,G.x),Og(k.y,G.y)),re.set(Og(G.x,Z.x),Og(G.y,Z.y)),J.set(Og(k.x,Z.x),Og(k.y,Z.y)),WA(j,K,re,J),WA(j,k,K,J),WA(j,G,re,K),WA(j,Z,J,re));t.vertices=F,t.faces=B,h&&(t.faceVertexUvs[0]=j)}},gr=new L,cze=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=t.geometry??(e==null?void 0:e.geometry)??new Ut().copy(new Qc(100,100,100)),n;e===void 0?(i.computeBoundingBox(),i.boundingBox.getSize(gr),n={width:gr.x,height:gr.y,depth:gr.z,subdivisions:0}):n=e.parameters;let r={...n,...t.parameters};return{parameters:{width:Math.abs(r.width),height:Math.abs(r.height),depth:Math.abs(r.depth),subdivisions:Math.abs(r.subdivisions)},geometry:i}}static build(t){let{width:e,height:i,depth:n,subdivisions:r}=t.parameters,s=t.geometry??new Ut().copy(new Qc(100,100,100)),o=s.userData.parameters;o===void 0?(s.computeBoundingBox(),s.boundingBox.getSize(gr)):gr.set(o.width,o.height,o.depth),(e!==gr.x||i!==gr.y||n!==gr.z)&&s.scale(gr.x===0?1:e/gr.x,gr.y===0?1:i/gr.y,gr.z===0?1:n/gr.z);let a=s.originalGeometry;try{r>0?(a===void 0||(o==null?void 0:o.subdivisions)!==r)&&(a===void 0&&(a=s),s=new lze(r).modify(a).toBufferGeometry()):(a!==void 0&&(s=a),a=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals())}catch{a!==void 0&&(s=a),a=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals()}return a!==void 0&&Object.assign(s,{originalGeometry:a}),delete t.geometry,Object.assign(s,{userData:{...t,type:"NonParametricGeometry"}})}static loadFromUrl(t,e,i){new $ee(i).load(t,n=>{let r=this.normalizeInputs({geometry:n});n.boundingBox.getSize(gr);let s=100/gr.x;Object.assign(r.parameters,{width:100,height:gr.y*s,depth:gr.z*s}),e(this.build(r))})}},Hie=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},t.parameters);return{shape:t.shape&&t.shape instanceof Nn?t.shape:new Nn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(t){let{width:e,height:i,spikes:n,cornerRadius:r,depth:s,extrudeBevelSize:o,extrudeBevelSegments:a}=t.parameters,l=t.shape,c=e*.5,h=i*.5,u=0,d=0,f=2*Math.PI/n;for(let m=0;m<n;m++){let v=f*m,g=u+Math.sin(v)*c,y=d+Math.cos(v)*h;l.addPoint(l.createPoint(g,y))}l.isClosed=!0;for(let m=0,v=l.points.length;m<v;m++)l.points[m].roundness=r;l.roundness=r,l.update();let p=Am.create({shape:l,parameters:{roundness:r,depth:s,extrudeBevelSize:o,extrudeBevelSegments:a}});return Object.assign(p,{userData:{...t,type:"PolygonGeometry"}})}},uze=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{width:e,height:i,depth:n,radialSegments:r,heightSegments:s,openEnded:o,cornerRadius:a,cornerSegments:l}=t.parameters,c=new dze(e*.5,i,r,s,o,a,l);return c.scale(1,1,n/e),Object.assign(c,{userData:{...t,type:"PyramidGeometry"}})}};function Ox(t,e,i){i.x=t.x*e.x,i.y=t.y,i.z=t.x*e.y}function P3(t,e,i,n,r,s){let o=e.clone().sub(t),a=i.clone().sub(t),l=o.angleTo(a);if(o.normalize(),a.normalize(),n===r){let c=o.add(a).normalize();s.copy(t).addScaledVector(c,n/Math.sin(l/2))}else{let c=o.angleTo(a);s.copy(t),s.addScaledVector(o,r/Math.sin(c)),s.addScaledVector(a,n/Math.sin(c))}}function hze(t,e,i){let n=t.clone().sub(e),r=i.clone().sub(e);return n.projectOnVector(r),n.add(e)}var dze=class extends Ut{constructor(t=.5,e=1,i=4,n=1,r=!1,s=0,o=4){super(),i=Math.floor(Math.max(3,i)),n=Math.floor(n),o=Math.floor(o);let a=[],l=[],c=[],h=[],u=0,d=e/2,f=Math.PI/i,p=t*Math.cos(Math.PI/i),m=2*Math.PI/i,v=(i-2)*Math.PI/i,g=Math.PI-v,y=new L(0,-d,0),x=new L(0,d,0),b=new he(t,-d),S=new he(p,-d),A=new he(0,x.y).sub(S),E=new he(0,x.y).sub(b),M=new he(A.y,-A.x).normalize(),T=new he(E.y,-E.x).normalize(),P=t*Math.cos(Math.PI/i)*Math.tan((Math.PI-A.angle())/2)-1e-8;s=Math.min(s,P);let R;{let X=new L(M.x,M.y,0),B=new L(Math.cos(m)*X.x,X.y,Math.sin(m)*X.x);R=X.angleTo(B)}let U=s/Math.tan((Math.PI-A.angle())/2),F=s/Math.tan((Math.PI-R)/2),N=new L;if(!r){l.push(y.x,y.y,y.z),c.push(0,-1,0),h.push(0,0);let X=u++,B=[],j=b.clone(),z=U/Math.cos(Math.PI/i);j.x-=z;for(let k=0;k<i;k++){let G=k/i*Math.PI*2+f,Z=new he(Math.sin(G),Math.cos(G));Ox(j,Z,N),l.push(N.x,N.y,N.z),c.push(0,-1,0),h.push(0,0),B.push(u++)}for(let k=0;k<B.length;k++)a.push(B[k],X,B[(k+1)%B.length])}{let X=new L,B=new L,j=new L,z=new L,k=new L,G=new L;for(let Z=0;Z<i;Z++){let K=Z/i*Math.PI*2+f,re=(Z+.5)/i*Math.PI*2+f,J=(Z+1)/i*Math.PI*2+f,le=new he(Math.sin(K),Math.cos(K)),ae=new he(Math.sin(re),Math.cos(re)),fe=new he(Math.sin(J),Math.cos(J));Ox(b,le,B),Ox(b,fe,j),Ox(M,ae,X),P3(x,B,j,F,F,z),l.push(z.x,z.y,z.z),P3(B,x,j,F,U,k),l.push(k.x,k.y,k.z),P3(j,B,x,U,F,G),l.push(G.x,G.y,G.z),c.push(X.x,X.y,X.z),c.push(X.x,X.y,X.z),c.push(X.x,X.y,X.z),h.push(0,0),h.push(0,0),h.push(0,0);let ge=u++,ve=u++,Y=u++;if(a.push(ge,ve,Y),s>0){{let xe=B.clone().add(j).multiplyScalar(.5),Ce=x.clone().sub(xe).normalize(),Ne=y.clone().sub(xe).normalize().add(Ce).normalize().multiplyScalar(-1),Ie=G.clone().sub(k);W(xe,Ie,Ne,A.angle())}let ce,de;{let xe=new L;Ox(T,fe,xe);let Ce=G.clone().add(z).multiplyScalar(.5);Ce=hze(Ce,j,x);let Ne=G.clone().sub(z);[ce,de]=W(Ce,Ne,xe,R,z.y)}{let xe=ce,Ce=xe.clone().setY(0).normalize(),Ne=new L(0,-1,0),Ie=Ce.clone().cross(Ne);Q(xe,Ce,Ne,Ie)}{let xe=A.angle(),Ce=Math.PI-xe,Ne=x.clone();Ne.y-=s/Math.sin(xe-Math.PI/2);let Ie=new L,Ge=[];for(let at=0;at<o;at++){let ee=[],O=Math.PI/2-Ce*at/o,V=Math.cos(O),ue=Math.sin(O),Ee=re;for(let Te=0;Te<=at;Te++){let We=Math.cos(Ee),Ve=Math.sin(Ee);X.x=V*Ve,X.y=ue,X.z=V*We,Ie.copy(Ne).addScaledVector(X,s),l.push(Ie.x,Ie.y,Ie.z),c.push(X.x,X.y,X.z),h.push(0,0),ee.push(u++),Ee+=Math.PI*2/at/i}Ge.push(ee)}de.reverse(),Ge.push(de);let tt=Ge.length-1;for(let at=0;at<tt;at++){let ee=Ge[at],O=Ge[at+1],V=ee.length-1;a.push(O[1],ee[0],O[0]);for(let ue=1;ue<=V;ue++)a.push(ee[ue],ee[ue-1],O[ue]),a.push(O[ue+1],ee[ue],O[ue])}}}}}this.setIndex(a),this.setAttribute("position",new yt(l,3)),this.setAttribute("normal",new yt(c,3)),this.setAttribute("uv",new yt(h,2));function W(X,B,j,z,k){let G=-z/2,Z=(Math.PI-z)/2,K=B.clone().normalize().cross(j);X.addScaledVector(j,-s/Math.sin(Z));let re=new L,J=new L,le=1,ae=u,fe=[];for(let ge=0;ge<=o;ge++){let ve=G+ge/o*z;J.set(0,0,0),J.addScaledVector(K,Math.sin(ve)),J.addScaledVector(j,Math.cos(ve));for(let Y=0;Y<=le;Y++){let ce=Y/le-.5;if(re.copy(X),re.addScaledVector(B,ce),re.addScaledVector(J,s),k!=null){let de=Math.max(0,re.y-k);re.addScaledVector(B,-de/B.y)}l.push(re.x,re.y,re.z),c.push(J.x,J.y,J.z),h.push(0,0),Y===0&&fe.push(u),u++}}for(let ge=0;ge<o;ge++)for(let ve=0;ve<le;ve++){let Y=ae+ve+(le+1)*ge,ce=Y+(le+1),de=ce+1,xe=Y+1;a.push(Y,ce,xe),a.push(ce,de,xe)}return[X.clone().addScaledVector(B,.5),fe]}function Q(X,B,j,z){let k=Math.PI/2,G=E.angle()-k,Z=[],K=new L,re=new L;for(let le=0;le<=o;le++){let ae=[],fe=le/o;for(let ge=0;ge<=le;ge++){let ve=((le?ge/le:0)-.5)*g,Y=Math.cos(ve),ce=Math.sin(ve),de=Math.atan(Math.tan(G)*Y),xe=(k+de)*fe,Ce=Math.cos(xe),Ne=Math.sin(xe);K.set(0,0,0),K.addScaledVector(B,Ne*Y),K.addScaledVector(j,Ce),K.addScaledVector(z,Ne*ce),re.copy(X).addScaledVector(K,s),l.push(re.x,re.y,re.z),c.push(K.x,K.y,K.z),h.push(0,0),ae.push(u++)}Z.push(ae)}let J=Z.length-1;for(let le=0;le<J;le++){let ae=Z[le],fe=Z[le+1],ge=ae.length-1;a.push(ae[0],fe[1],fe[0]);for(let ve=1;ve<=ge;ve++)a.push(ae[ve-1],ae[ve],fe[ve]),a.push(ae[ve],fe[ve+1],fe[ve])}}}},Vie=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters),n=Object.assign((e==null?void 0:e.ui)??{enabledIndieCorners:!1},t.ui);return{shape:t.shape&&t.shape instanceof Nn?t.shape:new Nn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)}),ui:n}}static build(t){let e=t.shape,{width:i,height:n,cornerRadius:r,cornerType:s,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}=t.parameters,c={x:i*.5,y:n*.5},h={x:-c.x,y:-c.y},u={x:c.x,y:c.y};function d(b,S,A){return S>i&&A>n?Math.min(b*i/S,b*n/A):S>i?b*i/S:A>n?b*n/A:b}let f=[];f[0]=r[0]===0?0:d(r[0],r[0]+r[3],r[0]+r[1]),f[1]=r[1]===0?0:d(r[1],r[1]+r[2],r[1]+r[0]),f[2]=r[2]===0?0:d(r[2],r[2]+r[1],r[2]+r[3]),f[3]=r[3]===0?0:d(r[3],r[3]+r[0],r[3]+r[2]);let p=h.x,m=u.x,v=u.y,g=h.y;e.addPoint(e.createPoint(p,v)),e.addPoint(e.createPoint(m,v)),e.addPoint(e.createPoint(m,g)),e.addPoint(e.createPoint(p,g)),e.isClosed=!0;let y=!0;for(let b=0,S=e.points.length;b<S;b++)e.points[b].roundness=f[b],b>0&&f[b]!==f[b-1]&&(y=!1);y&&(e.roundness=f[0]),e.useCubicForRoundedCorners=s!==1,e.update();let x=Am.create({shape:e,parameters:{depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}});return Object.assign(x,{userData:{...t,type:"RectangleGeometry"}})}},fze=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{width:e=100,height:i=e,depth:n=e,widthSegments:r=64,heightSegments:s=64,phiStart:o,phiLength:a,thetaStart:l,thetaLength:c}=t.parameters,h=new yk(.5*e,r,s,o,a,l,c);return h.scale(1,i/e,n/e),Object.assign(h,{userData:{...t,type:"SphereGeometry"}})}},pze=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,widthSegments:8,heightSegments:8},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:0})}}static build(t){let{width:e=100,height:i=e,widthSegments:n=8,heightSegments:r=8}=t.parameters,s=new ZC(e,i,n,r);return s.scale(1,1,1),Object.assign(s,{userData:{...t,type:"PlaneGeometry"}})}},mze=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,angle:90,cornerRadius:24,cornerSegments:8},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{width:e,height:i,depth:n,angle:r,cornerRadius:s,cornerSegments:o}=t.parameters,a=new gze(e,i,n,r,s,o);return Object.assign(a,{userData:{...t,type:"BackdropGeometry"}})}},gze=class extends Ut{constructor(t=1,e=1,i=1,n=90,r=10,s=24){super(),this.type="BackdropGeometry";let o=[],a=[],l=[],c=.001;r==0&&(s=1),s=Math.max(1,Math.floor(s)),r=Math.min(r,100),n=Math.min(180-c,n),n*=Math.PI/180;let h=[],u=Math.PI/2,d=(le=0,ae=0,fe=0)=>new L(le,ae,fe),f=d(),p=d(),[m,v,g]=[e/2,t/2,i/2],y=-v,x=+v,[b,S,A]=[d(y,-m,+g),d(y,-m,-g),d(y,+m,-g)],E=(le,ae=!1)=>Math.sin(le-Math.PI/(1+ +ae)),M=(le,ae=!1)=>Math.cos(le-Math.PI/(1+ +ae));A.y=Math.sin(n)*e-m;let T=Math.cos(n)*e-g,P=b.z-c;n<=u?(A.z=Math.min(T,P),A.z==P&&(A.y-=(T-P)/Math.tan(u-n))):S.z=Math.min(S.z-T-g,b.z-c),f.subVectors(b,S),p.subVectors(A,S);let R=Math.min(f.length(),p.length())*r/100,U=R*Math.tan(n/2),F=R/Math.cos(n/2),N=f.clone().normalize().add(p.normalize()).setLength(F).add(S);f.set(0,E(n,!0),M(n,!0)),h.push([A,f.clone()]);let W=(Math.PI-n)/s;for(let le=0;le<=s;le++){let ae=u+n+le*W;f.set(0,Math.sin(ae)*U,Math.cos(ae)*U),f.add(N),p.set(0,E(ae),M(ae)),h.push([f.clone(),p.clone()])}h.push([b,d(0,1,0)]);let Q=Math.sin(W/2)*U*2,X=h.length-1,B=h[0][0].distanceTo(h[1][0]),j=h[X-1][0].distanceTo(h[X][0]),z=B+Q*s+j;h[0].push(1);for(let le=0;le<=s;le++)h[le+1].push(1-(B+le*Q)/z);h[X].push(0);let[k,G,Z]=h[0],K,re,J;for(let le=1;le<h.length;le++)[K,re,J]=h[le],o.push(y,k.y,k.z,y,K.y,K.z,x,k.y,k.z,x,k.y,k.z,y,K.y,K.z,x,K.y,K.z),a.push(0,G.y,G.z,0,re.y,re.z,0,G.y,G.z,0,G.y,G.z,0,re.y,re.z,0,re.y,re.z),l.push(0,Z,0,J,1,Z,1,Z,0,J,1,J),[k,G,Z]=[K,re,J];this.setAttribute("position",new yt(o,3)),this.setAttribute("normal",new yt(a,3)),this.setAttribute("uv",new yt(l,2))}},jie=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters);return{shape:t.shape&&t.shape instanceof Nn?t.shape:new Nn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(t){let{width:e,height:i,innerRadiusPercent:n,spikes:r,cornerRadius:s,angle:o,depth:a,extrudeBevelSize:l,extrudeBevelSegments:c}=t.parameters,h=t.shape,u=e*.5,d=i*.5,f=0,p=0,m=o*Math.PI/360/r,v=Math.PI/2*3*-1,g=u*n/100,y=d*n/100;if(r===3&&n===50){m=2*Math.PI/r;for(let b=0;b<r;b++){let S=m*b,A=f+Math.sin(S)*u,E=p+Math.cos(S)*d;h.addPoint(h.createPoint(A,E))}}else for(let b=0;b<r;b++){let S=f+Math.cos(v)*u,A=p+Math.sin(v)*d;h.addPoint(h.createPoint(S,A)),v+=m,S=f+Math.cos(v)*g,A=p+Math.sin(v)*y,h.addPoint(h.createPoint(S,A)),v+=m}h.isClosed=!0;for(let b=0,S=h.points.length;b<S;b++)h.points[b].roundness=s;h.roundness=s,h.update();let x=Am.create({shape:h,parameters:{roundness:s,depth:a,extrudeBevelSize:l,extrudeBevelSegments:c}});return Object.assign(x,{userData:{...t,type:"StarGeometry"}})}},vze=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(t){let{width:e,height:i}=t.parameters,n=new ZC(e,i);return Object.assign(n,{userData:{...t,type:"TextFrameGeometry"}})}},yze=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:32,tubularSegments:64,arc:Math.PI*2,cornerRadius:30,cornerSegments:8},t.parameters),n=Math.abs(i.width),r=Math.abs(i.height??i.width),s=Math.round(Math.abs(i.depth??i.width*.25));return{parameters:Object.assign(i,{width:n,height:r,depth:s})}}static build(t){let{width:e,height:i,depth:n,radialSegments:r,tubularSegments:s,arc:o,cornerRadius:a,cornerSegments:l}=t.parameters,c=xze(e,i,n,e*.5,o,s,0,0,r,a,l);return c.scale(1,i/e,1),Object.assign(c,{userData:{...t,type:"TorusGeometry"}})}};function xze(t,e,i,n,r,s,o,a,l,c,h){return[e,i]=[i,e],o=e/2,r/=2*Math.PI,r==1&&(c=0),new zie(!0,t,e,i,n,r,s,o,a,l,c,h)}var _ze=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width),tube:i.tube??i.width*.125})}}static build(t){let{width:e,tube:i,tubularSegments:n,radialSegments:r,p:s,q:o}=t.parameters,a=e*.5;a!==i&&(a-=i);let l=new qee(a,i,n,r,s,o);return Object.assign(l,{userData:{...t,type:"TorusKnotGeometry"}})}},wze=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},t.parameters);return{shape:t.shape&&t.shape instanceof Nn?t.shape:new Nn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width*(i.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(i.depth??0)})}}static build(t){let{width:e=100,height:i,cornerRadius:n,depth:r,extrudeBevelSize:s,extrudeBevelSegments:o,isRect:a}=t.parameters,l=t.shape,c=e*.5,h=i*.5;a?(l.addPoint(l.createPoint(-c,h)),l.addPoint(l.createPoint(c,-h)),l.addPoint(l.createPoint(-c,-h))):(l.addPoint(l.createPoint(0,h)),l.addPoint(l.createPoint(c,-h)),l.addPoint(l.createPoint(-c,-h))),l.isClosed=!0;for(let d=0,f=l.points.length;d<f;d++)l.points[d].roundness=n;l.roundness=n,l.update();let u=Am.create({shape:l,parameters:{roundness:n,depth:r,extrudeBevelSize:s,extrudeBevelSegments:o}});return Object.assign(u,{userData:{...t,type:"TriangleGeometry"}})}};function bze(t,e){let i=2*Math.PI;return(t%i+i)%i===(e%i+i)%i}function Sze(t,e,i){let n=[new L,new L,new L],r=[new L,new L,new L];return t.extractBasis(n[0],n[1],n[2]),e.extractBasis(r[0],r[1],r[2]),n.forEach((s,o)=>{let a=r[o],l=hi.lerp(s.length(),a.length(),i);s.lerp(a,i).setLength(l)}),new $e().makeBasis(n[0],n[1],n[2])}var Aze=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},t.parameters),n=Math.abs(i.width),r=Math.abs(i.height??i.width),s=Math.abs(i.depth??0),o=(e==null?void 0:e.shapeData)??sz.create({parameters:gie}).userData.shape;return{path:t.path??MT.defaultData(),parameters:Object.assign(i,{width:n,height:r,depth:s,extrusion:{...vie,...i.extrusion}}),shapeData:o}}static build(t){if(t.path.points.length>=2){let e=new Mze(t);return Object.assign(e,{userData:{...t,type:"PathGeometry"}})}else return Object.assign(new Ut,{userData:{...t,type:"PathGeometry"}})}},Mze=class extends Ut{constructor(t){super(),this.type="PathExtrusionGeometry",this.inputs=t,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&this.inputs.parameters.extrusion.depth===1}_isOpenEnded(){let t=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&t.depth===1)||!bze(t.twist,0)||t.startScale!==t.endScale}build(){let t=this._extractPathPoints();if(t.length<2)return;let e=this._computeBasisMatrices(t),{depth:i,offset:n}=this.inputs.parameters.extrusion,r=this.inputs.path.isClosed?t.length:t.length-1,s=Math.floor(n*r),o=this.inputs.path.isClosed?Math.ceil((i+n)*r):Math.ceil(Math.min(1,i+n)*r),a=Math.min(Math.max(2,o-s+1),r+2),l=[],c=[];for(let P=0;P<a;P++){let R=this.inputs.path.isClosed?(P+s)%t.length:Math.min(P+s,t.length-1);l.push(t[R].clone()),c.push(e[R].clone())}let h=(P,R,U)=>{l[P]=l[P].clone().lerp(l[R],U),c[P]=Sze(c[P],c[R],U)},u=0,d=n*r%1;(!this.inputs.path.isClosed||i<=1)&&(d||n===0)&&(u=d,h(0,1,u));let f=0,p=(n+i)*r%1;if((this.inputs.path.isClosed&&i<=1||!this.inputs.path.isClosed&&n+i<1)&&p&&(f=p,h(l.length-1,l.length-2,1-f)),i===0){let P=l.length-1;l[P].copy(l[0]),c[P].copy(c[0])}this._applyPathModifiers(c,u,f);let{regions:m,infos:v,vertices:g}=this._computeShapePoints(5),y=0,x=0;v.sort((P,R)=>P.start-R.start),v.forEach(P=>{P.verticesStart=y,P.verticesCount=P.continuous.reduce((R,U,F)=>R+(F===0||!U?2:1),0),x+=P.verticesCount,y=x});let b=x*a,S,A=0;if(this._isOpenEnded()){try{S=xd({windingRule:Gi.ODD,elementType:hr.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:m})}catch{S=Iie}A=S.vertexCount}let E=b+2*A,M={positions:new Float32Array(E*3),normals:new Float32Array(E*3),uvs:new Float32Array(E*2)},T=[];v.forEach(P=>{this._extrudeRegion(P,g,c,l,M,T,this._isGeometryClosed()&&!this._isOpenEnded())}),S&&(this._closeEnd(S,b,T,M,c[0],l[0],!1),this._closeEnd(S,b+A,T,M,c[c.length-1],l[l.length-1],!0)),this.setAttribute("position",new Gt(M.positions,3)),this.setAttribute("normal",new Gt(M.normals,3)),this.setAttribute("uv",new Gt(M.uvs,2)),this.setIndex(T)}_extractPathPoints(){let t=Sie(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(t.length<2)return[];let e=[t[0]];return t.forEach(i=>{e[e.length-1].distanceToSquared(i)>.001&&e.push(i)}),this.inputs.path.isClosed&&e[e.length-1].distanceTo(e[0])<.001&&e.pop(),e}_computeBasisMatrices(t){let e=[],i=t.length,n=this.inputs.path.isClosed,r=new L,s=new L,o=new L,a=new L,l=new L(0,1,0);for(let p=0;p<i;p++){let m=t[p],v;p===0?v=n?t[t.length-2]:m.clone().multiplyScalar(2).sub(t[1]):v=t[p-1];let g;p===i-1?g=n?t[1]:m.clone().multiplyScalar(2).sub(t[p-1]):g=t[p+1];let y=m.clone().sub(v).normalize(),x=g.clone().sub(m).normalize(),b=y.clone().add(x).normalize();o.copy(b),p===0&&(b.equals(l)||b.clone().negate().equals(l))&&l.set(0,0,1);let S=l.clone().cross(b).normalize(),A=b.clone().cross(S).normalize();l.copy(A),a.copy(S),p===0&&(r.copy(A),s.copy(b));let E=new $e().makeBasis(S,A,b);e.push(E)}let c=n?s:o,h=n?r:new L(0,1,0),u=c.clone().cross(a).normalize(),d=Math.acos(h.dot(u));if(isNaN(d))return e;let f=h.clone().cross(u);c.dot(f)>0&&(d*=-1);for(let p=1;p<e.length;p++){let m=new $e().makeRotationZ(d*p/e.length);e[p].multiply(m)}return e}_applyPathModifiers(t,e,i){let n=t.length,{angle:r,twist:s,startScale:o,endScale:a}=this.inputs.parameters.extrusion,l=new $e,c=new $e;return t.forEach((h,u)=>{let d=u===0?0:u===n-1?1:(u-e)/(n-(i===0?0:1)-(e+(1-i)));l.makeRotationZ(hi.lerp(r,r+s,d));let f=hi.lerp(o,a,d);c.makeScale(f,f,f),h.multiply(l).multiply(c)}),t}_computeShapePoints(t=12,e=Gi.ODD){let i=this.inputs.shapeData,n=i.extractShapePointsToFlatArray([],t),r=i.shapeHoles.map(c=>{let h=c.extractShapePointsToFlatArray([],t),u=[];for(let d=h.length-1;d>=1;d-=2){let f=h[d-1],p=h[d-0];u.push(f,p)}return u}),s;try{s=xd({windingRule:e,elementType:hr.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[n]})}catch{s=rz}let o;try{o=xd({windingRule:Gi.ODD,elementType:hr.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...r]})}catch{o=Rie}if(!s)throw new Error("error generating geometry");let a=s.elementCount;if(o){s.elementCount+=o.elementCount;for(let c=0;c<o.elements.length;c++){let h=o.elements[c],u=c%2===0?s.vertexCount:0;s.elements.push(h+u)}for(let c=0;c<o.vertexIndices.length;c++){let h=o.vertexIndices[c],u=s.vertexCount;s.vertexIndices.push(h+u)}for(let c=0;c<o.vertices.length;c++){let h=o.vertices[c];s.vertices.push(h)}}for(let c=0,h=s.vertexCount;c<h;c++){let u=c*2;s.vertices[u+0],s.vertices[u+1]}let l=[];for(let c=s.elementCount-1;c>=0;c--){let h=c>=a,u=c*2,d=s.elements[u+0],f=s.elements[u+1],p=d+f,m={start:d,count:f,normals:[],isHole:h,continuous:[],verticesStart:0,verticesCount:0};l.push(m);let v=d,g=p-1,y=d+1,x=i.roundedCurves.length;do{let b=v-d;s.vertices[g*2+0],s.vertices[g*2+1];let S=s.vertices[v*2+0],A=s.vertices[v*2+1],E=s.vertices[y*2+0],M=s.vertices[y*2+1],T=S-E,P=A-M,R=Math.sqrt(T*T+P*P);T/=R,P/=R,m.normals[b*2+0]=-P,m.normals[b*2+1]=T;let U=s.vertexIndices[v];if(Array.isArray(U))m.continuous[b]=!1;else{let[F,N]=i.getCurveIndexFromVertexId(U-1,!0);if(N>0&&N<1)m.continuous[b]=!0;else{let W=N===1?F+1:F-1;W=(W+x)%x;let Q=N===1?0:1,X=i.roundedCurves[F].getTangent(N),B=i.roundedCurves[W].getTangent(Q);m.continuous[b]=X.dot(B)>.95}}h&&(m.normals[b*2+0]*=-1,m.normals[b*2+1]*=-1),[g,v,y]=[v,y,y+1],y>=p&&(y-=f)}while(y!==d+1)}return{regions:[n,...r],infos:l,vertices:s.vertices}}_insertVertex(t,e,i,n,r){let s=e*2,o=e*3;t.positions[o+0]=i.x,t.positions[o+1]=i.y,t.positions[o+2]=i.z,t.normals[o+0]=n.x,t.normals[o+1]=n.y,t.normals[o+2]=n.z,t.uvs[s+0]=r.x,t.uvs[s+1]=r.y}_extrudeRegion(t,e,i,n,r,s,o){let a=new L,l=new L,c=new L,h=new L,u=new he;i.forEach((f,p)=>{let m=n[p],v=t.verticesStart*i.length+t.verticesCount*p;for(let g=0;g<t.count;g++){let y=(t.start+g)*2;if(a.set(e[y+0],e[y+1],0),c.copy(a).applyMatrix4(f).add(m),t.continuous[g])h.set(t.normals[g*2+0],t.normals[g*2+1],0);else{let x=g==0?(t.start+t.count-1)*2:y-2;l.set(e[x+0],e[x+1],0),h.copy(a).sub(l),h.set(-h.y,h.x,0),t.isHole||h.negate()}if(h.applyMatrix4(f).normalize(),u.set(g===0?1:g/t.count,p/(i.length-1)),this._insertVertex(r,v,c,h,u),v++,!t.continuous[g]||g===0){if(g===0)h.set(t.normals[g*2+0],t.normals[g*2+1],0),u.set(0,p/(i.length-1));else{let x=g===t.count-1?t.start*2:y+2;l.set(e[x+0],e[x+1],0),h.copy(l).sub(a),h.set(-h.y,h.x,0),t.isHole||h.negate()}h.applyMatrix4(f).normalize(),this._insertVertex(r,v,c,h,u),v++}}});let d=i.length-1;for(let f=0;f<d;f++){let p=t.verticesStart*i.length+t.verticesCount*f,m=t.verticesStart*i.length+t.verticesCount*(f+1),v=0;for(let g=0;g<t.count;g++){(!t.continuous[g]||g===0)&&v++;let y=g===t.count-1?0:v+1,x=p+v,b=p+y,S=m+y,A=m+v;t.isHole?s.push(x,S,b,x,A,S):s.push(x,b,S,x,S,A),v++}}}_closeEnd(t,e,i,n,r,s,o){let a=t.vertexCount,l=new L(0,0,o?-1:1).applyMatrix4(r),c=new L,h=new he;for(let d=0;d<a;d++){let f=2*d;c.set(t.vertices[f+0],t.vertices[f+1],0).applyMatrix4(r).add(s),this._insertVertex(n,e+d,c,l,h)}let u=t.elements;for(let d=0;d<t.elementCount;d++){let f=3*d,p=u[f+0]+e,m=u[f+(o?1:2)]+e,v=u[f+(o?2:1)]+e;i.push(p,m,v)}}};function Wie(){let t=new Ut;return t.setAttribute("position",new Gt(new Float32Array([]),3)),t.setIndex(new Gt(new Uint16Array([]),1)),t}var Eze=Wie().attributes,Tze=12,Cze=1,Xie=class extends Ut{constructor(t,e){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,Eze),this.userData={parameters:t,type:"TextGeometry"};let i=e.getFont(t.font);i!=null&&i.isLoaded?(this.font=i,this.update(t)):this.updateFont(t.font,e).then(()=>{this.update(t),e==null||e.requestRender()})}async updateFont(t,e){let i=e.getFont(t);i&&(this.font=i,await i.loadingPromise)}update(t){let e=this.font;if(this.userData={parameters:t,type:"TextGeometry"},!(e!=null&&e.isLoaded)){console.warn("Cannot update text because its font is not loaded");return}let{width:i,height:n,depth:r,extrudeBevelSize:s,extrudeBevelSegments:o,text:a,textTransform:l}=t,c=l===2?a.toUpperCase():l===3?a.toLowerCase():a,h=Pze(t,e,c),{shapes:u,charWidths:d,charCoords:f}=e.generateShapes(h,t),p=i*.5,m=n*.5,v=u.map(x=>new Nn().fromShape(x));this.vectorShapes=v;let g=v.map(x=>Am.create({shape:x,parameters:{depth:r,extrudeBevelSegments:o,extrudeBevelSize:s,windingRule:r<=0?Gi.NONZERO:Gi.ODD,subdivisions:this.isLowResolution&&r>0?Cze:Tze}})),y=g.length?Mp(g):Wie();y.translate(-p,m,0),this.dispose(),this.wrappedText=h,this.charCoords=f,this.charWidths=d,this.deleteAttribute("extrudeNormal"),Object.entries(y.attributes).forEach(([x,b])=>{this.setAttribute(x,b)}),this.setIndex(y.index),this.computeBoundingSphere()}clone(){let t=cm(new Ut,Xie.prototype);return t.copy(this),console.log("CloneGeometry",this,t),t}copy(t){return Object.entries(t.attributes).forEach(([e,i])=>{this.setAttribute(e,i)}),this.setIndex(t.index),this.userData={parameters:{...t.userData.parameters},type:"TextGeometry"},this}async setText(t){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:t})}get text(){return this.userData.parameters.text??""}};function Pze(t,e,i){i=i??t.text;let n=[""],r="";for(let s of i)r+=s,s===" "||s===`
`?(n[n.length-1]+=r,r="",s===`
`&&n.push("")):e.getTextWidth(n[n.length-1]+r,t)>t.width&&(n[n.length-1].length&&n.push(""),e.getTextWidth(n[n.length-1]+r,t)>t.width&&(r.length===1?(n[n.length-1]+=r,r=""):(n[n.length-1]+=r.slice(0,-1),r=r[r.length-1],n.push(""))));return n[n.length-1]+=r,n}var qie,oz=new Promise(t=>{qie=t}),V9=!1,XA;function Dze(){if(V9)return;if(XA)return XA;async function t(){let e="https://unpkg.com/@splinetool/modelling-wasm@0.9.405/build",[i,n]=await Promise.all([Dw(()=>import("./process-10f79362.js"),[]),fetch(`${e}/process.wasm`).then(o=>o.arrayBuffer())]),r=i.default,s=await r({wasmBinary:n});qie(s),V9=!0}return XA=t(),XA}function OT(t,e,i){let n={parameters:t,type:t.type};if(t.type==="PathGeometry")n.path=t.path;else if(t.type==="VectorGeometry"){let s=Nn.createFromState(t.shape,t.width,t.height);n.shape=s}else if(t.type==="NonParametricGeometry")t.data.groups&&t.data.groups.forEach(s=>s.materialIndex=Math.max(s.materialIndex??0,0)),n.geometry=new $ee().parse(t);else{if(t.type==="SubdivGeometry")return new ks(t,i);if(t.type==="TextGeometry")return new Xie(t,e)}let r;try{r=Y9(n)}catch(s){console.error(s)}if(!r){let s=Nn.createFromState(AT.defaultData(),100,100);n.shape=s,r=Y9(n)}return r}var Rze=new $e;function HO(t,e,i,n){let r=t.position.array,s=t.normal.array,o=Rze.makeScale(e,i,n).invert().elements,a,l,c;for(var h=0,u=r.length;h<u;h+=3)r[h]*=e,r[h+1]*=i,r[h+2]*=n,a=s[h],l=s[h+1],c=s[h+2],s[h]=o[0]*a+o[4]*l+o[8]*c,s[h+1]=o[1]*a+o[5]*l+o[9]*c,s[h+2]=o[2]*a+o[6]*l+o[10]*c;t.position.needsUpdate=!0,t.normal.needsUpdate=!0}var qA=new Zn,Fg=new L,Dt;oz.then(t=>{Dt=t});var j9=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),W9=new Uint32Array([0,1,2,3]),X9=new Uint8Array([4]),ks=class extends Ut{constructor(t,e){super(),this.data=t,this.flatShading=e,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(t,e){this.freeSubdivPointer();let i=this.data.scaleBaked,n=jp.div(e,i);this.subdividedGeometry&&HO(this.subdividedGeometry.attributes,...n),this.originalGeometry&&HO(this.originalGeometry.attributes,...n),this.data=t;let r=this.userData.parameters;this.userData.parameters={width:r.width*n[0],height:r.height*n[1],depth:r.depth*n[2]},this.originalGeometry.boundingSphere.center.multiply(Fg.fromArray(n));let s=Fg.set(r.width,r.height,r.depth).length();this.originalGeometry.boundingSphere.radius=s/2}ensureSubdivPointer(){return this.subdivPointer===0&&this.rebuild(),this.subdivPointer}rebuild(){let t,e,i;try{({originalGeometry:t,subdividedGeometry:e,subdivPointer:i}=ks.build(this.data,void 0,!this.flatShading,void 0))}catch{t=new Qc(100,100,100),i=0}this.subdivPointer=i,this.originalGeometry=t,this.subdividedGeometry=e??void 0;let n=this.subdividedGeometry??this.originalGeometry;Object.assign(this,n),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(ks.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let t=this.originalGeometry;t.boundingSphere===null&&(t.boundingSphere=new sa,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=t.boundingSphere));let e=t.attributes.position,i=t.boundingSphere.center;qA.setFromBufferAttribute(e),qA.getCenter(i),t.boundingSphere.radius=i.distanceTo(qA.max),isNaN(t.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),qA.getSize(Fg);let n={width:Fg.x,height:Fg.y,depth:Fg.z};return this.userData.parameters=n,n}static build(t,e,i,n){let r,s,o,a=(t==null?void 0:t.phongAngle)??35;i===!1&&(a=-1),e&&(Dt.free_bvh(e),Dt.free_subdivision_surface(e));try{r=ks.allocate(t,n)}catch(l){console.error(l,t),r=ks.allocate({positionWASM:j9,indexWASM:W9,verticesPerFaceWASM:X9},n)}if(Dt.set_destination_refinement_level(r,0),s=ks.buildLevel(r,!0,a),t.subdivisions>0)try{Dt.set_destination_refinement_level(r,t.subdivisions),o=ks.buildLevel(r,!1,a)}catch{try{Dt.set_destination_refinement_level(r,t.subdivisions-1),o=ks.buildLevel(r,!1,a)}catch{o=null}}else o=null;return{subdivPointer:r,originalGeometry:s,subdividedGeometry:o}}static primitiveToQuads(t,e,i){t.widthSegments>16&&(t.widthSegments=16),t.heightSegments>16&&(t.heightSegments=16),t.depthSegments>16&&(t.depthSegments=16),t.radialSegments>16&&(t.radialSegments=16),t.type==="DodecahedronGeometry"&&(t.detail=0);let n=t.shape!==void 0||t.path!==void 0?e.geometry:OT(t,i,!1),r;t.type==="TorusGeometry"&&t.arc===Math.PI*2?r=n.getClosedTorusIndicesForBooleanOrSubdiv():r=n.getIndex();let s,o,a,l;({positions:s,triIndices:l}=v2(n.getAttribute("position"),r));let c;if(t.type==="CylinderGeometry"&&t.cornerRadius===0&&t.hollow===0&&t.openEnded===!1){let h=t.radialSegments*t.heightSegments*3*2,u=h+t.radialSegments*3;c=[h,u]}return{indices:o,verticesPerFace:a}=Yie(s,l,n,c),{positions:s,indices:o,verticesPerFace:a}}static allocate(t,e){var x;let i,n,r,s=[],o=[];t.positionWASM&&t.positionWASM.length>0?(i=t.positionWASM,n=t.indexWASM,r=t.verticesPerFaceWASM):(i=j9,n=W9,r=X9);let a=i.length,l=n.length,c=r.length,h=i.length+s.length+o.length,u=n.length+r.length,d=h*Float32Array.BYTES_PER_ELEMENT+u*Uint32Array.BYTES_PER_ELEMENT,f=h*Float32Array.BYTES_PER_ELEMENT,p=Dt._malloc(d),m=new Float32Array(Dt.HEAPF32.buffer,p,h),v=new Uint32Array(Dt.HEAPU32.buffer,p+f,u);m.set(i,0),m.set(s,i.length),m.set(o,i.length+s.length),v.set(n,0),v.set(r,n.length);let g;(x=t==null?void 0:t.scaleBaked)!=null&&x.some(b=>b!==1)&&(g=new $e().makeScale(...t.scaleBaked)),e&&(g?g.premultiply(e):g=e);let y=g?Dt.alloc_subdivision_surface2(p,a,p+f,l,p+f+n.length*Uint32Array.BYTES_PER_ELEMENT,c,g.elements):Dt.alloc_subdivision_surface(p,a,p+f,l,p+f+n.length*Uint32Array.BYTES_PER_ELEMENT,c);return Dt._free(p),y}static buildLevel(t,e,i,n,r){let s=r?Dt.get_mesh_data2(t,e?Dt.Level.CONTROL:Dt.Level.REFINED,i,r.elements):Dt.get_mesh_data(t,e?Dt.Level.CONTROL:Dt.Level.REFINED,i),o=8,a=Dt.HEAPU32.subarray(s>>2,(s>>2)+o),l=a.subarray(4,4+4),c=0,h=Dt.HEAPU32[a[c]>>2],u=Dt.HEAPF32.subarray(h>>2,(h>>2)+l[c]);c++;let d=Dt.HEAPU32[a[c]>>2],f=Dt.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let p=Dt.HEAPU32[a[c]>>2],m=Dt.HEAPU32.subarray(p>>2,(p>>2)+l[c]);c++;let v=Dt.HEAPU32[a[c]>>2],g=Dt.HEAPU32.subarray(v>>2,(v>>2)+l[c]);if(c++,n===void 0){let y=new Ut;if(y.setIndex(new Wv(g,1)),y.setAttribute("position",new yt(u,3)),y.setAttribute("normal",new yt(f,3)),e){y.setAttribute("faceMap",new Wv(m,1));let x=new Float32Array(f.length/3*4).fill(0);y.setAttribute("color",new Gt(x,4))}return Dt.free_mesh_data(s),y.userData.type="SubdivGeometry",y}n.getAttribute("position").copyArray(u),n.getAttribute("normal").copyArray(f),n.attributes.position.needsUpdate=!0,n.attributes.normal.needsUpdate=!0,Dt.free_mesh_data(s)}static freeSubdivPointer(t){Dt.free_bvh(t),Dt.free_subdivision_surface(t)}static buildControlCageWireframe(t,e,i){let n=Dt.get_wireframe_data_for_base_level(t),r=4,s=Dt.HEAPU32.subarray(n>>2,(n>>2)+r),o=s.subarray(2,2+2),a=0,l=Dt.HEAPU32[s[a]>>2],c=Dt.HEAPF32.subarray(l>>2,(l>>2)+o[a]);a++;let h=Dt.HEAPU32[s[a]>>2],u=Dt.HEAPU32.subarray(h>>2,(h>>2)+o[a]);if(e===void 0){let d=new Ut;d.setAttribute("position",new yt(c,3));let f=new Float32Array(c.length);for(let p=0,m=c.length;p<m;)f[p++]=i.r,f[p++]=i.g,f[p++]=i.b;return d.setAttribute("color",new Gt(f,3)),d.setIndex(new Wv(u,1)),Dt.free_wireframe_data_for_base_level(n),d}e.getAttribute("position").copyArray(c),e.attributes.position.needsUpdate=!0,Dt.free_wireframe_data_for_base_level(n)}static updateCollabMesh(t,e,i){let n=e===0;n||Dt.set_destination_refinement_level(t,e);let r=i?Dt.get_topological_data2(t,n?Dt.Level.CONTROL:Dt.Level.REFINED,i.elements):Dt.get_topological_data(t,n?Dt.Level.CONTROL:Dt.Level.REFINED),s=6,o=Dt.HEAPU32.subarray(r>>2,(r>>2)+s),a=o.subarray(3,3+3),l=0,c=Dt.HEAPU32[o[l]>>2],h=new Float32Array(Dt.HEAPF32.subarray(c>>2,(c>>2)+a[l]));l++;let u=Dt.HEAPU32[o[l]>>2],d=new Uint32Array(Dt.HEAPU32.subarray(u>>2,(u>>2)+a[l]));l++;let f=Dt.HEAPU32[o[l]>>2],p=new Uint8Array(Dt.HEAPU32.subarray(f>>2,(f>>2)+a[l]));return Dt.free_topological_data(r),{positions:h,indices:d,verticesPerFace:p}}},q9=["getX","getY","getZ"];function v2(t,e){let i={},n=e?e.count:t.count,r=0,s=[],o=[],a=1e4;for(let c=0;c<n;c++){let h=e?e.getX(c):c,u="";for(let d=0;d<3;d++)u+=`${~~(t[q9[d]](h)*a)},`;if(u in i)s.push(i[u]);else{for(let d=0;d<3;d++)o.push(t[q9[d]](h));i[u]=r,s.push(r),r++}}let l=[];for(let c=0;c<s.length;c+=3)s[c]===s[c+1]||s[c]===s[c+2]||s[c+1]===s[c+2]||l.push(s[c],s[c+1],s[c+2]);return{positions:o,triIndices:l}}var YA=new L,D3=new L,R3=new L,I3=new L;function Yie(t,e,i,n){let r=[],s=[];if(i.userData.shape!==void 0&&i.userData.parameters.depth===0&&i.userData.shape.shapeHoles.length===0){let o=i.userData.shape.extractShapePointsToFlatArray([]),a=i.userData.parameters.spikes;if(i.userData.type==="EllipseGeometry"&&a<=24&&a%4===0&&i.userData.parameters.angle>=360){let h=o.length/2/a;o=o.filter((u,d)=>Math.floor(d/2)%h===0)}let l=0;for(let h=0;h<o.length;h+=2)l+=(o[h]-o[(h===0?o.length:h)-2])*(o[h+1]+o[(h===0?o.length:h)-1]);t.length=0;let c=0;if(l<0)for(let h=0;h<o.length;h+=2)t.push(o[h],o[h+1],0),r.push(c++);else for(let h=o.length-2;h>=0;h-=2)t.push(o[h],o[h+1],0),r.push(c++);return s.push(c),{indices:r,verticesPerFace:s}}for(let o=0,a=i.capStartIndex??e.length;o<a;)if(e[o+1]===e[o+3]&&e[o+2]===e[o+5]||e[o+0]===e[o+3]&&e[o+2]===e[o+4]){YA.set(t[e[o]*3],t[e[o]*3+1],t[e[o]*3+2]),D3.set(t[e[o+1]*3],t[e[o+1]*3+1],t[e[o+1]*3+2]),R3.set(t[e[o+4]*3],t[e[o+4]*3+1],t[e[o+4]*3+2]),I3.set(t[e[o+5]*3],t[e[o+5]*3+1],t[e[o+5]*3+2]),D3.sub(YA).normalize(),R3.sub(YA).normalize(),I3.sub(YA).normalize();let l=D3.cross(R3).dot(I3);Math.abs(l)>.005||n&&n.some((c,h)=>h%2===1?!1:o>=n[h]&&o<n[h+1])?(r.push(e[o],e[o+1],e[o+2]),s.push(3),o+=3):(r.push(e[o],e[o+1],e[o+4],e[o+5]),s.push(4),o+=6)}else r.push(e[o],e[o+1],e[o+2]),s.push(3),o+=3;if(i.capStartIndex!==void 0){let o=[],a=[],l=0,c=new Float32Array([i.userData.parameters.depth])[0];for(let h=0,u=0;h<t.length;h+=3,u++)t[h+2]===0&&(o.push(u),l++),t[h+2]===c&&a.push(u);if(i.userData.parameters.extrudeBevelSize===0){let h=a[0];a[0]=a[1],a[1]=h}o.reverse(),r.push(...o,...a),s.push(l,l)}return{indices:r,verticesPerFace:s}}var Ou={};MSe(Ou,{calcBoolean:()=>Fze,calcBooleanTopological:()=>Oze,freeMeshSet:()=>zze,getMeshSet:()=>Nze,hasOpenEdges:()=>Uze,transformMeshSet:()=>kze});var Qie,Ize=new Promise(t=>{Qie=t}),QA;function Lze(){if(QA)return QA;async function t(){let e="https://unpkg.com/@splinetool/boolean-wasm@0.9.405/build",[i,n]=await Promise.all([Dw(()=>import("./boolean-613a7c9c.js"),[]),fetch(`${e}/boolean.wasm`).then(o=>o.arrayBuffer())]),r=i.default,s=await r({wasmBinary:n});Qie(s)}return QA=t(),QA}var fi,e0;Ize.then(t=>fi=t);function Bze(t,e,i){let n,r;t.userData.parameters.type==="TorusGeometry"&&t.userData.parameters.arc===Math.PI*2?r=t.getClosedTorusIndicesForBooleanOrSubdiv():r=t.getIndex();let{positions:s,triIndices:o}=v2(t.getAttribute("position"),r),a;if(e&&i){let{indices:l,verticesPerFace:c}=Yie(s,o,t);a=c.length,n=[];for(let h=0,u=0;h<a;h++){n.push(c[h]);for(let d=0;d<c[h];d++)n.push(l[u++])}}else{let l=o.length;n=Array(l+l/3),a=0;for(let c=0,h=0;h<n.length;)n[h++]=3,a++,n[h++]=o[c++],n[h++]=o[c++],n[h++]=o[c++]}return{positions:s,faceIndices:n,nFaces:a}}function Kie(t){let e=t.length,i=e*Uint32Array.BYTES_PER_ELEMENT,n=e*Float32Array.BYTES_PER_ELEMENT,r=Number.isInteger(t[0])?i:n,s=fi._malloc(r);return(Number.isInteger(t[0])?new Uint32Array(fi.HEAPU32.buffer,s,e):new Float32Array(fi.HEAPF32.buffer,s,e)).set(t,0),s}function Jie(t){switch(t){case 0:return fi.OP.UNION;case 1:return fi.OP.INTERSECTION;case 2:return fi.OP.A_MINUS_B;case 3:return fi.OP.B_MINUS_A;case 4:return fi.OP.SYMMETRIC_DIFFERENCE;case 5:return fi.OP.ALL;default:throw new Error("Unknown boolean operation "+t)}}function Oze(t,e){e0===void 0&&(e0=fi.init_csg());let i=Kie(t),n=fi.csg_calc_topological(e0,i,t.length,Jie(e));fi._free(i);let r=6,s=fi.HEAPU32.subarray(n>>2,(n>>2)+r),o=s.subarray(3,3+3),a=0,l=fi.HEAPU32[s[a]>>2],c=new Float32Array(fi.HEAPF32.subarray(l>>2,(l>>2)+o[a]));a++;let h=fi.HEAPU32[s[a]>>2],u=new Uint32Array(fi.HEAPU32.subarray(h>>2,(h>>2)+o[a]));a++;let d=fi.HEAPU32[s[a]>>2],f=new Uint8Array(fi.HEAPU32.subarray(d>>2,(d>>2)+o[a]));return fi.free_mesh_data(n),{positions:c,indices:u,verticesPerFace:f}}function Fze(t,e,i,n){e0===void 0&&(e0=fi.init_csg());let r=Kie(t),s=fi.csg_calc(e0,r,t.length,n,Jie(e));fi._free(r);let o=5,a=fi.HEAPU32.subarray(s>>2,(s>>2)+o),l=a.subarray(2,2+3),c=0,h=fi.HEAPU32[a[c]>>2],u=fi.HEAPF32.subarray(h>>2,(h>>2)+l[c]);c++;let d=fi.HEAPU32[a[c]>>2],f=fi.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let p=l[c];i.setAttribute("position",new yt(u,3)),i.setAttribute("normal",new yt(f,3));let m=fi.HEAPF32.subarray((s>>2)+5,(s>>2)+5+6);return i.boundingSphere===null&&(i.boundingSphere=new sa),i.boundingSphere.center.set(m[0],m[1],m[2]),i.boundingSphere.radius=(m[3]**2+m[4]**2+m[5]**2)**.5,i.userData.parameters={width:m[3]*2,height:m[4]*2,depth:m[5]*2},fi.free_mesh_data(s),p}function Nze(t,e,i){if(fi===void 0)return-1;let n,r,s;if(e&&t.userData.positions!==void 0){let m=t.userData;s=m.verticesPerFace.length,n=m.positions,r=Array(m.verticesPerFace.reduce((v,g)=>v+g,0)+s);for(let v=0,g=0,y=0;v<m.verticesPerFace.length;v++){r[y++]=m.verticesPerFace[v];for(let x=0;x<m.verticesPerFace[v];x++)r[y++]=m.indices[g++]}}else({positions:n,faceIndices:r,nFaces:s}=Bze(t,e,i));let o=n.length,a=r.length,l=n.length,c=r.length,h=l*Float32Array.BYTES_PER_ELEMENT+c*Uint32Array.BYTES_PER_ELEMENT,u=l*Float32Array.BYTES_PER_ELEMENT,d=fi._malloc(h),f=new Float32Array(fi.HEAPF32.buffer,d,l),p=new Uint32Array(fi.HEAPU32.buffer,d+u,c);return f.set(n,0),p.set(r,0),fi.get_csg_mesh(d,o,d+u,a,s)}function Uze(t){return fi.has_open_edges(t)}function kze(t,e){fi.transform_csg_mesh(t,e.elements)}function zze(t){fi.free_csg_mesh(t)}var Gze={ConeGeometry:_ke,CubeGeometry:wke,CylinderGeometry:Aie,DodecahedronGeometry:Ske,EllipseGeometry:sz,HelixGeometry:eze,IcosahedronGeometry:tze,LatheGeometry:ize,NonParametricGeometry:cze,PolygonGeometry:Hie,PyramidGeometry:uze,RectangleGeometry:Vie,SphereGeometry:fze,PlaneGeometry:pze,BackdropGeometry:mze,StarGeometry:jie,TextFrameGeometry:vze,TorusGeometry:yze,TorusKnotGeometry:_ze,TriangleGeometry:wze,PathGeometry:Aze,VectorGeometry:Am},Y9=t=>Gze[t.type].create(t);function Fx(t){return t!==null&&"booleanOp"in t}var Zie=class extends ez(co){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new $e}updateVisible(){super.updateVisible(),this.visible=!Fx(this.parent)&&this.visible,Fx(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&(Ou.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(t=!1){return t?this.booleanWasTransformed=!0:this.freeBooleanPointer(),Fx(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let t of this.children)t instanceof Zie&&(t.freeBooleanPointer(),Fx(t)&&t.invalidateUpstreamBooleanData())}updateTransformState(t){let e=super.updateTransformState(t);return e&&Fx(this.parent)&&this.invalidateDownstreamBooleanData(!0),e}},KA=new Zn;function az(t,e=0,i=t.count,n,r){let s=1/0,o=1/0,a=1/0,l=-1/0,c=-1/0,h=-1/0;for(let u=e;u<i;u++){let d=t.getX(u),f=t.getY(u),p=t.getZ(u);d<s&&(s=d),f<o&&(o=f),p<a&&(a=p),d>l&&(l=d),f>c&&(c=f),p>h&&(h=p)}KA.min.set(s,o,a),KA.max.set(l,c,h),KA.getCenter(n),KA.getSize(r).multiplyScalar(.5)}var Hze=new Ut,Vze=new ly,Mo=class extends Zie{constructor(t,e){super(Hze,Vze),this.super_Entity(t,e)}updateState(t,e){this.updateState_Entity(t,e)}updateEntityBoxSize(t,e){let i=this.geometry.getAttribute("position");i!==void 0?az(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,t,e):super.updateEntityBoxSize(t,e)}},Q9=class{constructor(t){t=t??{},this.name=t.name,this.type=t.type,this.node=t.node,this.size=t.size,this.needsUpdate=t.needsUpdate}get value(){return this.node.value}set value(t){this.node.value=t}},pf=class{constructor(t){this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},this.uuid=hi.generateUUID(),this.type=t,this.name=""}analyze(t,e){e=e??{},t.analyzing=!0,this.build(t.addFlow(e.slot,e.cache,e.context),"v4"),t.clearVertexNodeCode(),t.clearFragmentNodeCode(),t.removeFlow(),t.analyzing=!1}analyzeAndFlow(t,e,i){return i=i??{},this.analyze(t,i),this.flow(t,e,i)}flow(t,e,i){i=i??{},t.addFlow(i.slot,i.cache,i.context);let n={result:this.build(t,e),code:t.clearNodeCode(),extra:t.context.extra};return t.removeFlow(),n}build(t,e,i){e=e??this.getType(t,e);let n=t.getNodeData(i??this);return t.analyzing&&this.appendDepsNode(t,n,e),t.nodes.indexOf(this)===-1&&t.nodes.push(this),this.updateFrame!==void 0&&t.updaters.indexOf(this)===-1&&t.updaters.push(this),this.generate(t,e,i)}updateFrame(t){}generateReadonly(t,e,i,n,r,s){return""}generate(t,e,i,n,r){return""}parse(t,e,i,n){}appendDepsNode(t,e,i){e.deps=(e.deps||0)+1;let n=t.getTypeLength(i);(n>(e.outputMax||0)||this.getType(t,i))&&(e.outputMax=n,e.output=i)}setName(t){this.name=t}getName(){return this.name}getType(t,e){return e==="sampler2D"||e==="samplerCube"?e:this.type}getHash(){let t="{",e,i;for(e in this)i=this[e],i instanceof pf&&(t+='"'+e+'":'+i.getHash()+",");if(this.hashProperties)for(let n=0;n<this.hashProperties.length;n++)e=this.hashProperties[n],i=this[e],t+='"'+e+'":"'+String(i)+'",';return t+='"id":"'+this.uuid+'"}',t}},jze=class{constructor(){this.nodes={},this.keywords={}}add(t){this.nodes[t.name]=t}addKeyword(t,e,i){i=i!==void 0?i:!0,this.keywords[t]={callback:e,cache:i}}remove(t){delete this.nodes[t.name]}removeKeyword(t){delete this.keywords[t]}get(t){return this.nodes[t]}getKeyword(t,e){return this.keywords[t].callback(e)}getKeywordData(t){return this.keywords[t]}contains(t){return this.nodes[t]!==void 0}containsKeyword(t){return this.keywords[t]!==void 0}},oo=new jze,Wi=class extends pf{constructor(t,e){super(t),this.scope="",e=e??{},this.shared=e.shared!==void 0?e.shared:!0,this.unique=e.unique!==void 0?e.unique:!1}build(t,e,i,n){if(e=e??this.getType(t),this.getShared(t,e)){let r=this.getUnique(t,e);r&&this.uuid===void 0&&(this.uuid=hi.generateUUID()),i=t.getUUID(i??this.getUUID(),!r);let s=t.getNodeData(i),o=s.output||this.getType(t);if(t.analyzing)return(s.deps||0)>0||this.getLabel()?(this.appendDepsNode(t,s,e),this.generate(t,e,i)):super.build(t,e,i);if(r)return s.name=s.name||super.build(t,e,i),s.name;if(!this.getLabel()&&(!this.getShared(t,o)||t.context.ignoreCache||s.deps===1))return super.build(t,e,i);i=this.getUUID(!1);let a=this.getTemp(t,i);if(a)return t.format(a,o,e);{a=super.generate(t,e,i,s.output,n);let l=this.generate(t,o,i);return t.addNodeCode(a+" = "+l+";"),t.format(a,o,e)}}return super.build(t,e,i)}getShared(t,e){return e!=="sampler2D"&&e!=="samplerCube"&&this.shared}getUnique(t,e){return this.unique}setLabel(t){return this.label=t,this}getLabel(){return this.label}getUUID(t){let e=this.uuid;return typeof this.scope=="string"&&(e=this.scope+"-"+e),e}getTemp(t,e){e=e||this.uuid;let i=t.getVars()[e];return i?i.name:void 0}generate(t,e,i,n,r){return this.getShared(t,e)||console.error("TempNode is not shared"),i=i??this.uuid,t.getTempVar(i,n??this.getType(t),r,this.getLabel()).name}},Eo=class extends Wi{constructor(t,e){e=e??{},e.shared=e.shared!==void 0?e.shared:!1,super(t,e),this.readonly=!1}setReadonly(t){return this.readonly=t,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(t,e,i,n,r,s){i=t.getUUID(i??this.getUUID()),n=n??this.getType(t);let o=t.getNodeData(i);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(t,e,i,n,r,s):t.isShader("vertex")?(o.vertex||(o.vertex=t.createVertexUniform(n,this,r,s,this.getLabel())),t.format(o.vertex.name,n,e)):(o.fragment||(o.fragment=t.createFragmentUniform(n,this,r,s,this.getLabel())),t.format(o.fragment.name,n,e))}},Qr=class extends Eo{constructor(t=0,e){super("v2"),this.nodeType="Vector2",this.value=t instanceof he?t:new he(t,e)}get x(){return this.value.x}set x(t){this.value.x=t}get y(){return this.value.y}set y(t){this.value.y=t}generateReadonly(t,e,i,n,r,s){return t.format("vec2("+this.value.x+", "+this.value.y+")",n,e)}},Da=class extends Eo{constructor(t=0,e,i){super("v3"),this.nodeType="Vector3",this.value=t instanceof L?t:new L(t,e,i)}get x(){return this.value.x}set x(t){this.value.x=t}get y(){return this.value.y}set y(t){this.value.y=t}get z(){return this.value.z}set z(t){this.value.z=t}generateReadonly(t,e,i,n,r,s){return t.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",n,e)}},wo=class extends It{constructor(t,e,i,n){super(t,e,i),this.isColorA=!0,this.a=n}setRGBA(t,e,i,n){super.setRGB(t,e,i),this.a=n}copy(t){return super.copy(t),this.a="a"in t?t.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}setStyle(t,e="srgb"){let i;if(t==="transparent")return this.setRGBA(0,0,0,0),this;if(i=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(t)){let n,r=i[1],s=i[2];switch(r){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=r==="rgba"?parseFloat(n[4]):1,super.setStyle(t,e);break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=r==="hsla"?parseFloat(n[4]):1,super.setStyle(t,e);break}}return super.setStyle(t,e)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(t){this.r=t}set y(t){this.g=t}set z(t){this.b=t}set w(t){this.a=t}},Fu=class extends Eo{constructor(t){super("v4"),this.nodeType="Vector4",this.value=t instanceof wo?t:new wo(t.r,t.g,t.b,t.a)}generateReadonly(t,e,i,n,r,s){return t.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",n,e)}},Wze=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,K9=/[a-z_0-9]+/gi,ot=class extends Wi{constructor(t,e,i,n,r){super(r),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=r===void 0,this.isInterface=!1,this.parse(t,e,i,n)}getShared(t,e){return!this.isMethod}getType(t){return t.getTypeByFormat(this.type)}getInputByName(t){if(this.inputs){let e=this.inputs.length;for(;e--;)if(this.inputs[e].name===t)return this.inputs[e]}}getIncludeByName(t){if(this.includes){let e=this.includes.length;for(;e--;)if(this.includes[e].name===t)return this.includes[e]}}generate(t,e,i,n,r){let s,o=0,a=this.src;if(this.includes)for(let c=0;c<this.includes.length;c++)t.include(this.includes[c],this);for(let c in this.extensions)t.extensions[c]=!0;let l=[];for(;s=K9.exec(this.src);)l.push(s);for(let c=0;c<l.length;c++){let h=l[c],u=h[0],d=this.isMethod?!this.getInputByName(u):!0,f=u;if(this.keywords[u]||this.useKeywords&&d&&oo.containsKeyword(u)){let p=this.keywords[u];if(!p){let m=oo.getKeywordData(u);m.cache&&(p=t.keywords[u]),p=p||oo.getKeyword(u,t),m.cache&&(t.keywords[u]=p)}f=p.build(t)}u!==f&&a[h.index+o-1]!=="."&&(a=a.substring(0,h.index+o)+f+a.substring(h.index+u.length+o),o+=f.length-u.length),this.getIncludeByName(f)===void 0&&oo.contains(f)&&t.include(oo.get(f))}return e==="source"?a:this.isMethod?(this.isInterface||t.include(this,void 0,a),this.name):t.format("( "+a+" )",this.getType(t),e)}parse(t,e,i,n){if(this.src=t||"",this.includes=e??[],this.extensions=i??{},this.keywords=n??{},this.isMethod){let r=Wze.exec(this.src);if(this.inputs=[],r&&r.length==4){this.type=r[1],this.name=r[2];let s=r[3].match(K9);if(s){let o=0;for(;o<s.length;){let a=s[o++],l;a==="in"||a==="out"||a==="inout"?l=s[o++]:(l=a,a="");let c=s[o++];this.inputs.push({name:c,type:l,qualifier:a})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}},Xze=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,$ie=class extends Wi{constructor(t="",e){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(t||$ie.PI,void 0,void 0,void 0,e)}getType(t){return t.getTypeByFormat(this.type)}parse(t,e,i,n,r){this.src=t||"";let s,o,a="",l=Xze.exec(t);this.useDefine=r??this.src.charAt(0)==="#",l&&l.length>1?(o=l[1],s=l[2],a=l[3]):(s=this.src,o="f"),this.name=s,this.type=o,this.value=a}build(t,e){if(e==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return t.include(this),t.format(this.name,this.getType(t),e)}generate(t,e,i,n,r){return t.format(this.name,this.getType(t),e)}},ki=$ie;ki.PI="PI",ki.PI2="PI2",ki.RECIPROCAL_PI="RECIPROCAL_PI",ki.RECIPROCAL_PI2="RECIPROCAL_PI2",ki.LOG2="LOG2",ki.EPSILON="EPSILON";var qze=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),Yze=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),ene=class extends Wi{constructor(t=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(t)}getType(t){return t.getTypeByFormat(this.name)}getInputByName(t){let e=this.inputs.length;for(;e--;)if(this.inputs[e].name===t)return this.inputs[e]}generate(t,e,i,n,r){return e==="source"?this.src+";":t.format("( "+this.src+" )",this.getType(t),e)}parse(t=""){this.src=t,this.inputs=[];let e=qze.exec(t);if(e){let i=e[2],n;for(;n=Yze.exec(i);)this.inputs.push({type:n[1],name:n[2]});this.name=e[1]}else this.name="";this.type=this.name}},lz=class extends Wi{constructor(t){super("v2",{shared:!1}),this.nodeType="UV",this.index=t??0}generate(t,e){t.requires.uv[this.index]=!0;let i=this.index>0?this.index+1:"",n=t.isShader("vertex")?"uv"+i:"vUv"+i;return t.format(n,this.getType(t),e)}};oo.addKeyword("uv",function(){return new lz});oo.addKeyword("uv2",function(){return new lz(1)});var Jg=class extends Wi{constructor(t,e){super("v4"),this.nodeType="ColorSpace",this.input=t,this.method=e??Jg.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(t){switch(t){case Yc:return["Linear"];case Qt:return["sRGB"];default:return[]}}generate(t,e){var o;let i=this.input.build(t,"v4"),n=this.getType(t),r=Jg.Nodes[this.method],s=t.include(r);if(s===Jg.LINEAR_TO_LINEAR)return t.format(i,n,e);if(((o=r.inputs)==null?void 0:o.length)===2){let a=this.factor.build(t,"f");return t.format(s+"( "+i+", "+a+" )",n,e)}else return t.format(s+"( "+i+" )",n,e)}fromEncoding(t){let e=Jg.getEncodingComponents(t);this.method="LinearTo"+e[0],this.factor=e[1]}fromDecoding(t){let e=Jg.getEncodingComponents(t);this.method=e[0]+"ToLinear",this.factor=e[1]}},Lc=Jg;Lc.Nodes={LinearToLinear:new ot(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new ot(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new ot(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},Lc.LINEAR_TO_LINEAR="LinearToLinear",Lc.SRGB_TO_LINEAR="sRGBToLinear",Lc.LINEAR_TO_SRGB="LinearTosRGB";var tn=class extends ot{constructor(t="",e,i,n,r){super(t,r,n,i,e),this.nodeType="Expression"}},Vu=class extends Eo{constructor(t=new br,e,i,n){super("v4",{shared:!0}),this.nodeType="Texture",this.value=t,this.uv=e??new lz,this.bias=i,this.project=n!==void 0?n:!1}getTexture(t,e){return super.generate(t,e,this.value.uuid,"t")}generate(t,e){if(e==="sampler2D")return this.getTexture(t,e);let i=this.getTexture(t,e),n=this.uv.build(t,this.project?"v4":"v2"),r=this.bias?this.bias.build(t,"f"):void 0;r===void 0&&t.context.bias&&(r=t.context.bias.setTexture(this).build(t,"f"));let s,o;this.project?s="texture2DProj":s=r?"tex2DBias":"tex2D",r?o=s+"( "+i+", "+n+", "+r+" )":o=s+"( "+i+", "+n+" )";let a={include:t.isShader("vertex"),ignoreCache:!0},l=this.getType(t);return t.addContext(a),this.colorSpace=this.colorSpace??new Lc(new tn("",l)),this.colorSpace.fromDecoding(t.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(o),o=this.colorSpace.build(t,l),t.removeContext(),t.format(o,l,e)}},pt=class extends Eo{constructor(t){super("f"),this.nodeType="Float",this.value=t??0}generateReadonly(t,e,i,n,r,s){return t.format(this.value+(this.value%1?"":".0"),n,e)}},J9=class extends Wi{constructor(t,e){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=t,this.inputs=e??[]}getFunction(){return this.value}getType(t){return this.value.getType(t)}generate(t,e,i,n,r){n=this.getType(t);let s=this.value,o=s.build(t,e)+"( ",a=[];if(s.inputs){for(let l=0;l<s.inputs.length;l++){let c=s.inputs[l],h=this.inputs[l]||this.inputs[c.name];a.push(h.build(t,t.getTypeByFormat(c.type)))}o+=a.join(", ")+" )"}return t.format(o,n,e)}},tne=class extends Wi{constructor(t,e,i=tne.ADD){super(),this.nodeType="Operator",this.type=t.type,this.a=t,this.b=e,this.op=i}getType(t){let e=this.a.getType(t),i=this.b.getType(t);return t.isTypeMatrix(e)?"v4":t.getTypeLength(i)>t.getTypeLength(e)?i:e}generate(t,e){let i=this.getType(t);this.type=i;let n=this.a.build(t,i),r=this.b.build(t,i);return t.format("( "+n+" "+this.op+" "+r+" )",i,e)}},$s=tne;$s.ADD="+",$s.SUB="-",$s.MUL="*",$s.DIV="/";var Ui=class extends Wi{constructor(t,e=Ui.ABS,i,n){super(),this.nodeType="Math",this.a=t,typeof e!="string"?this.b=e:n=e,typeof i!="string"?this.c=i:n=i,this.method=n,this.hashProperties=["method"]}getNumInputs(t){switch(this.method){case Ui.MIX:case Ui.CLAMP:case Ui.REFRACT:case Ui.SMOOTHSTEP:case Ui.FACEFORWARD:return 3;case Ui.MIN:case Ui.MAX:case Ui.MOD:case Ui.STEP:case Ui.REFLECT:case Ui.DISTANCE:case Ui.DOT:case Ui.CROSS:case Ui.POW:return 2;default:return 1}}getInputType(t){let e=t.getTypeLength(this.a.getType(t)),i=this.b?t.getTypeLength(this.b.getType(t)):0,n=this.c?t.getTypeLength(this.c.getType(t)):0;return e>i&&e>n?this.a.getType(t):i>n?this.b.getType(t):this.c.getType(t)}getType(t){switch(this.method){case Ui.LENGTH:case Ui.DISTANCE:case Ui.DOT:return"f";case Ui.CROSS:return"v3"}return this.getInputType(t)}generate(t,e){let i,n,r,s=this.a?t.getTypeLength(this.a.getType(t)):0,o=this.b?t.getTypeLength(this.b.getType(t)):0,a=this.c?t.getTypeLength(this.c.getType(t)):0,l=this.getInputType(t),c=this.getType(t);switch(this.type=c,this.method){case Ui.NEGATE:return t.format("( -"+this.a.build(t,l)+" )",l,e);case Ui.INVERT:return t.format("( 1.0 - "+this.a.build(t,l)+" )",l,e);case Ui.CROSS:i=this.a.build(t,"v3"),n=this.b.build(t,"v3");break;case Ui.STEP:i=this.a.build(t,s===1?"f":l),n=this.b.build(t,l);break;case Ui.MIN:case Ui.MAX:case Ui.MOD:i=this.a.build(t,l),n=this.b.build(t,o===1?"f":l);break;case Ui.REFRACT:i=this.a.build(t,l),n=this.b.build(t,l),r=this.c.build(t,"f");break;case Ui.MIX:i=this.a.build(t,l),n=this.b.build(t,l),r=this.c.build(t,a===1?"f":l);break;default:i=this.a.build(t,l),this.b&&(n=this.b.build(t,l)),this.c&&(r=this.c.build(t,l));break}let h=[];h.push(i),n&&h.push(n),r&&h.push(r);let u=this.getNumInputs(t);if(h.length!==u)throw Error(`Arguments not match used in "${this.method}". Require ${u}, currently ${h.length}.`);return t.format(this.method+"( "+h.join(", ")+" )",c,e)}},Xt=Ui;Xt.RAD="radians",Xt.DEG="degrees",Xt.EXP="exp",Xt.EXP2="exp2",Xt.LOG="log",Xt.LOG2="log2",Xt.SQRT="sqrt",Xt.INV_SQRT="inversesqrt",Xt.FLOOR="floor",Xt.CEIL="ceil",Xt.NORMALIZE="normalize",Xt.FRACT="fract",Xt.SATURATE="saturate",Xt.SIN="sin",Xt.COS="cos",Xt.TAN="tan",Xt.ASIN="asin",Xt.ACOS="acos",Xt.ARCTAN="atan",Xt.ABS="abs",Xt.SIGN="sign",Xt.LENGTH="length",Xt.NEGATE="negate",Xt.INVERT="invert",Xt.MIN="min",Xt.MAX="max",Xt.MOD="mod",Xt.STEP="step",Xt.REFLECT="reflect",Xt.DISTANCE="distance",Xt.DOT="dot",Xt.CROSS="cross",Xt.POW="pow",Xt.MIX="mix",Xt.CLAMP="clamp",Xt.REFRACT="refract",Xt.SMOOTHSTEP="smoothstep",Xt.FACEFORWARD="faceforward";var u1=class extends Wi{constructor(t,e,i){super("v4"),this.nodeType="TextureCubeUV",this.value=t,this.uv=e,this.bias=i}bilinearCubeUV(t,e,i,n){let r=new J9(u1.Nodes.bilinearCubeUV,[e,i,n]);this.colorSpaceTL=this.colorSpaceTL??new Lc(new tn("","v4")),this.colorSpaceTL.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(r.build(t)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new Lc(new tn("","v4")),this.colorSpaceTR.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(r.build(t)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new Lc(new tn("","v4")),this.colorSpaceBL.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(r.build(t)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new Lc(new tn("","v4")),this.colorSpaceBR.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(r.build(t)+".br");let s={include:t.isShader("vertex"),ignoreCache:!0};t.addContext(s),this.colorSpaceTLExp=new tn(this.colorSpaceTL.build(t,"v4"),"v4"),this.colorSpaceTRExp=new tn(this.colorSpaceTR.build(t,"v4"),"v4"),this.colorSpaceBLExp=new tn(this.colorSpaceBL.build(t,"v4"),"v4"),this.colorSpaceBRExp=new tn(this.colorSpaceBR.build(t,"v4"),"v4"),t.removeContext();let o=new tn("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return o.keywords.cubeUV_TL=this.colorSpaceTLExp,o.keywords.cubeUV_TR=this.colorSpaceTRExp,o.keywords.cubeUV_BL=this.colorSpaceBLExp,o.keywords.cubeUV_BR=this.colorSpaceBRExp,o.keywords.cubeUV=r,o}generate(t,e){if(t.isShader("fragment")){let i=this.uv,n=this.bias||t.context.roughness,r=new J9(u1.Nodes.roughnessToMip,[n]),s=new Xt(r,u1.Nodes.m0,u1.Nodes.cubeUV_maxMipLevel,Xt.CLAMP),o=new Xt(s,Xt.FLOOR),a=new Xt(s,Xt.FRACT),l=this.bilinearCubeUV(t,this.value,i,o),c=this.bilinearCubeUV(t,this.value,i,new $s(o,new pt(1).setReadonly(!0),$s.ADD)),h=new Xt(l,c,a,Xt.MIX);return t.format(h.build(t),"v4",e)}else return console.warn("TextureCubeUVNode is not compatible with "+t.shader+" shader."),t.format("vec4( 0.0 )",this.getType(t),e)}},VO=u1;VO.Nodes=function(){let t=new ene(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),e=new ki("float cubeUV_maxMipLevel 8.0",!0),i=new ki("float cubeUV_minMipLevel 4.0",!0),n=new ki("float cubeUV_maxTileSize 256.0",!0),r=new ki("float cubeUV_minTileSize 16.0",!0),s=new ot(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);s.useKeywords=!1;let o=new ot(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);o.useKeywords=!1;let a=new ot(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[t,s,o,e,i,n,r]);a.useKeywords=!1;let l=new ki("float r0 1.0",!0),c=new ki("float v0 0.339",!0),h=new ki("float m0 -2.0",!0),u=new ki("float r1 0.8",!0),d=new ki("float v1 0.276",!0),f=new ki("float m1 -1.0",!0),p=new ki("float r4 0.4",!0),m=new ki("float v4 0.046",!0),v=new ki("float m4 2.0",!0),g=new ki("float r5 0.305",!0),y=new ki("float v5 0.016",!0),x=new ki("float m5 3.0",!0),b=new ki("float r6 0.21",!0),S=new ki("float v6 0.0038",!0),A=new ki("float m6 4.0",!0),E=[l,c,h,u,d,f,p,m,v,g,y,x,b,S,A],M=new ot(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,E);return{bilinearCubeUV:a,roughnessToMip:M,m0:h,cubeUV_maxMipLevel:e}}();var Zg=class extends Wi{constructor(t){super("v3"),this.nodeType="Normal",this.scope=t??Zg.VIEW}getShared(){return this.scope===Zg.WORLD}build(t,e,i,n){let r=t.context[this.scope+"Normal"];return r?r.build(t,e,i,n):super.build(t,e,i)}generate(t,e,i,n,r){let s;switch(this.scope){case Zg.VIEW:t.isShader("vertex")?s="transformedNormal":s="geometryNormal";break;case Zg.LOCAL:t.isShader("vertex")?s="objectNormal":(t.requires.normal=!0,s="vObjectNormal");break;case Zg.WORLD:t.isShader("vertex")?s="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(t.requires.worldNormal=!0,s="vWNormal");break}return t.format(s,this.getType(t),e)}},uo=Zg;uo.LOCAL="local",uo.WORLD="world",uo.VIEW="view",uo.NORMAL="normal";oo.addKeyword("viewNormal",function(){return new uo(uo.VIEW)});oo.addKeyword("localNormal",function(){return new uo(uo.NORMAL)});oo.addKeyword("worldNormal",function(){return new uo(uo.WORLD)});var Du=class extends Wi{constructor(t){super("v3"),this.nodeType="Position",this.scope=t??Du.LOCAL}getType(){switch(this.scope){case Du.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case Du.LOCAL:case Du.WORLD:return!1}return!0}generate(t,e,i,n,r){let s;switch(this.scope){case Du.LOCAL:t.isShader("vertex")?s="transformed":(t.requires.position=!0,s="vPosition");break;case Du.WORLD:if(t.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";t.requires.worldPosition=!0,s="vWPosition";break;case Du.VIEW:s=t.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case Du.PROJECTION:s=t.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return t.format(s,this.getType(),e)}},Cl=Du;Cl.LOCAL="local",Cl.WORLD="world",Cl.VIEW="view",Cl.PROJECTION="projection";oo.addKeyword("position",function(){return new Cl});oo.addKeyword("worldPosition",function(){return new Cl(Cl.WORLD)});oo.addKeyword("viewPosition",function(){return new Cl(Cl.VIEW)});var vc=class extends Wi{constructor(t){super("v3"),this.nodeType="Reflect",this.scope=t??vc.CUBE}getUnique(t){return!t.context.viewNormal}getType(){switch(this.scope){case vc.SPHERE:return"v2"}return this.type}generate(t,e){let i=this.getUnique(t);if(t.isShader("fragment")){let n;switch(this.scope){case vc.VECTOR:{let r=new uo(uo.VIEW),s=t.context.roughness,o=r.build(t,"v3"),a=new Cl(Cl.VIEW).build(t,"v3"),l=s?s.build(t,"f"):void 0,c=`reflect( -normalize( ${a} ), ${o} )`;l&&(c=`normalize( mix( ${c}, ${o}, ${l} * ${l} ) )`);let h=`inverseTransformDirection( ${c}, viewMatrix )`;i?(t.addNodeCode(`vec3 reflectVec = ${h};`),n="reflectVec"):n=h;break}case vc.CUBE:{let r=new vc(vc.VECTOR).build(t,"v3"),s="vec3( -"+r+".x, "+r+".yz )";i?(t.addNodeCode(`vec3 reflectCubeVec = ${s};`),n="reflectCubeVec"):n=s;break}case vc.SPHERE:{let r="normalize( ( viewMatrix * vec4( "+new vc(vc.VECTOR).build(t,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";i?(t.addNodeCode(`vec2 reflectSphereVec = ${r};`),n="reflectSphereVec"):n=r;break}}return t.format(n,this.getType(),e)}else return console.warn("ReflectNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.type,e)}},t0=vc;t0.CUBE="cube",t0.SPHERE="sphere",t0.VECTOR="vector";var Qze=class extends Wi{constructor(t=new Vu,e,i){super("v4"),this.nodeType="TextureCube",this.value=t,this.radianceNode=new VO(this.value,e??new t0(t0.VECTOR),i),this.irradianceNode=new VO(this.value,new uo(uo.WORLD),new pt(1).setReadonly(!0))}generate(t,e){return t.isShader("fragment")?(t.require("irradiance"),t.context.bias&&t.context.bias.setTexture(this.value),(t.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(t,e)):(console.warn("TextureCubeNode is not compatible with "+t.shader+" shader."),t.format("vec4( 0.0 )",this.getType(t),e))}},Kze=class extends Eo{constructor(t=new ck,e,i){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=t,this.uv=e??new t0,this.bias=i}getTexture(t,e){return super.generate(t,e,this.value.uuid,"tc")}generate(t,e){var l;if(e==="samplerCube")return this.getTexture(t,e);let i=this.getTexture(t,e),n=(l=this.uv)==null?void 0:l.build(t,"v3"),r=this.bias?this.bias.build(t,"f"):void 0;r===void 0&&t.context.bias&&(r=t.context.bias.setTexture(this).build(t,"f"));let s;r?s="texCubeBias( "+i+", "+n+", "+r+" )":s="texCube( "+i+", "+n+" )";let o={include:t.isShader("vertex"),ignoreCache:!0},a=this.getType(t);return t.addContext(o),this.colorSpace=this.colorSpace??new Lc(new tn("",a)),this.colorSpace.fromDecoding(t.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(s),s=this.colorSpace.build(t,a),t.removeContext(),t.format(s,a,e)}},Jze=`
uniform int frameIndex;
uniform vec2 resolution;
uniform mat4 previousModelViewMatrix;
uniform mat4 previousProjectionMatrix;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;
`,Zze=`
layout(location = 1) out vec4 gVelocity;

uniform int frameIndex;
uniform vec2 resolution;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;

const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}

// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso
float getNoiseInterleavedGradient(vec2 screenPos) {
    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);
    return fract(magic.z * fract(dot(screenPos, magic.xy)));
}

`,$ze=`
// TODO: This could be generated CPU side and passed to the shader every frame
const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

// TODO: Pass correct view size
vec2 offset = haltonSequence[frameIndex];
offset.x /= resolution.x;
offset.y /= resolution.y;

vec4 currentPosition = gl_Position;
vec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);

// We want to calculate the velocity with unjittered positions
// so that things that are not moving get a velocity = 0
vCurrentPosition = currentPosition;
vPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);
#ifdef OUTLINE_COMPENSATION
vPreviousPosition.xy += OUTLINE_COMPENSATION;
#endif
gl_Position = currentPositionJittered;

`,e4e=`
vec2 oldPos = vPreviousPosition.xy;
    oldPos /= vPreviousPosition.w;
    oldPos.xy = (oldPos.xy+1.)/2.0;

vec2 newPos = vCurrentPosition.xy;
    newPos /= vCurrentPosition.w;
    newPos.xy = (newPos.xy+1.)/2.0;

vec2 velocity = (newPos - oldPos);

// NOTE: We use the blue channel to avoid temporal reprojection
// with incorrect velocity if the fragment is transparent.
gVelocity = vec4(velocity, gl_FragColor.a < 1.0 ? 0.0 : 1.0, 1.);
`,Z9=["x","y","z","w"],t4e=["float","vec2","vec3","vec4"],i4e={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},n4e={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},r4e=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function t(e,i){return e.deps.length-i.deps.length}return function(e,i){let n=this.getIncludes(e,i);if(!n)return"";let r="";n=n.sort(t);for(let s=0;s<n.length;s++)n[s].src&&(r+=n[s].src+`
`);return r}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(t,e){this.addVertexParsCode(Jze),this.addFragmentParsCode(Zze),this.buildShader("vertex",t),this.buildShader("fragment",e);for(let i=0;i<this.requires.uv.length;i++)if(this.requires.uv[i]){let n=i>0?i+1:"";this.addVaryCode("varying vec2 vUv"+n+";"),i>0&&this.addVertexParsCode("attribute vec2 uv"+n+";"),this.addVertexFinalCode("vUv"+n+" = uv"+n+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode($ze),this.addFragmentFinalCode(e4e)),this}buildShader(t,e){this.resultCode[t]=e.build(this.setShader(t),"v4")}setMaterial(t,e){return this.defines={},this}addFlow(t,e,i){return this.addSlot(t).addCache(e).addContext(i)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(t){return this.cache=t??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(t){return this.context=Object.assign({},this.context,t),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(t){return this.slot=t||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(t,e){this.fragmentVariables[t]===void 0&&(this.addFragmentCode(`${e} ${t};`),this.fragmentVariables[t]="")}addFragmentParsVariable(t,e){this.fragmentParsVariables[t]===void 0&&(this.addFragmentParsCode(`${e} ${t};`),this.fragmentParsVariables[t]="")}addVertexParsVariable(t,e){this.vertexParsVariables[t]===void 0&&(this.addVertexParsCode(`${e} ${t};`),this.vertexParsVariables[t]="")}addVertexCode(t){this.addCode(t,"vertex")}addFragmentCode(t){this.addCode(t,"fragment")}addCode(t,e){this.code[e??this.shader]+=t+`
`}addVertexNodeCode(t){this.addNodeCode(t,"vertex")}addFragmentNodeCode(t){this.addNodeCode(t,"fragment")}addNodeCode(t,e){this.nodeCode[e??this.shader]+=t+`
`}clearNodeCode(t){t=t??this.shader;let e=this.nodeCode[t];return this.nodeCode[t]="",e}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(t){this.addFinalCode(t,"vertex")}addFragmentFinalCode(t){this.addFinalCode(t,"fragment")}addFinalCode(t,e){this.finalCode[e??this.shader]+=t+`
`}addVertexParsCode(t){this.addParsCode(t,"vertex")}addFragmentParsCode(t){this.addParsCode(t,"fragment")}addParsCode(t,e){this.parsCode[e??this.shader]+=t+`
`}addVaryCode(t){this.addVertexParsCode(t),this.addFragmentParsCode(t)}isCache(t){return this.caches.indexOf(t)!==-1}isSlot(t){return this.slots.indexOf(t)!==-1}define(t,e){this.defines[t]=e===void 0?1:e}require(t){this.requires[t]=!0}isDefined(t){return this.defines[t]!==void 0}getVar(t,e,i,n="varying",r="V",s=""){let o=this.getVars(n),a=o[t];if(!a){let l=o.length;a={name:i||"node"+r+l+(s?"_"+s:""),type:e},o.push(a),o[t]=a}return a}getTempVar(t,e,i,n){return this.getVar(t,e,i,this.shader,"T",n)}getAttribute(t,e){if(!this.attributes[t]){let i=this.getVar(t,e);this.addVertexParsCode("attribute "+e+" "+t+";"),this.addVertexFinalCode(i.name+" = "+t+";"),this.attributes[t]={varying:i,name:t,type:e}}return this.attributes[t]}getCode(t){return[this.prefixCode,this.parsCode[t],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[t],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[t],"uniform"),this.getIncludesCode("consts",t),this.getIncludesCode("structs",t),this.getIncludesCode("functions",t),"void main() {",this.getVarListCode(this.getVars(t)),this.code[t],this.resultCode[t],this.finalCode[t],"}"].join(`
`)}getVarListCode(t,e){e=e??"";let i="";for(let n=0,r=t.length;n<r;++n){let s=t[n],o=s.type,a=s.name,l=s.size,c=this.getFormatByType(o);if(c===void 0)throw new Error("Node pars "+c+" not found.");c.includes("[]")?i+=e+" "+c.substring(0,c.length-2)+" "+a+`[${l}];
`:i+=e+" "+c+" "+a+`;
`}return i}getVars(t){return this.inputs.vars[t??this.shader]}getNodeData(t){let e=t instanceof pf?t.uuid:t;return this.nodeData[e]=this.nodeData[e]||{}}createUniform(t,e,i,n,r,s){if(e.includes("[]")){let o=this.inputs.arrayUniforms,a=o.list.length,l=new Q9({type:e,size:i.size,name:n||"nodeUA"+a+(s?"_"+s:""),node:i,needsUpdate:r});return o.list.push(l),o[t].push(l),o[t][l.name]=l,this.uniforms[l.name]=l,l}else{let o=this.inputs.uniforms,a=o.list.length,l=new Q9({type:e,name:n||"nodeU"+a+(s?"_"+s:""),node:i,needsUpdate:r});return o.list.push(l),o[t].push(l),o[t][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(t,e,i,n,r){return this.createUniform("vertex",t,e,i,n,r)}createFragmentUniform(t,e,i,n,r){return this.createUniform("fragment",t,e,i,n,r)}include(t,e,i){var s;let n;if(t=typeof t=="string"?oo.get(t):t,this.context.include===!1)return t.name;t instanceof ot?n=this.includes.functions:t instanceof ki?n=this.includes.consts:t instanceof ene&&(n=this.includes.structs);let r=n[this.shader]=n[this.shader]||[];if(t){let o=r[t.name];if(o||(o=r[t.name]={node:t,deps:[]},r.push(o),o.src=t.build(this,"source")),t instanceof ot&&e&&r[e.name]&&r[e.name].deps.indexOf(t)===-1&&(r[e.name].deps.push(t),(s=t.includes)==null?void 0:s.length)){let a=0;do this.include(t.includes[a++],e);while(a<t.includes.length)}return i&&(o.src=i),t.name}else throw new Error("Include not found.")}colorToVectorProperties(t){return t.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(t){return t.replace(/c/g,"v3")}getIncludes(t,e){return this.includes[t][e||this.shader]}getConstructorFromLength(t){return t4e[t-1]}isTypeMatrix(t){return/^m/.test(t)}getTypeLength(t){return t==="f"?1:parseInt(this.colorToVector(t).substr(1))}getTypeFromLength(t){return t===1?"f":"v"+t}findNode(...t){for(let e=0;e<arguments.length;e++){let i=t[e];if(i!=null&&i.isNode)return i}}resolve(...t){for(let e=0;e<arguments.length;e++){let i=t[e];if(i!==void 0){if(i.isNode)return i;if(i.isTexture)switch(i.mapping){case sm:case om:return new Kze(i);case Iw:return new Qze(new Vu(i));default:return new Vu(i)}else{if(i.isVector2)return new Qr(i);if(i.isVector3)return new Da(i);if(i.isVector4)return new Fu(i)}}}}format(t,e,i){switch(this.colorToVector(i+" <- "+e)){case"f <- v2":return t+".x";case"f <- v3":return t+".x";case"f <- v4":return t+".x";case"f <- i":case"f <- b":return"float( "+t+" )";case"v2 <- f":return"vec2( "+t+" )";case"v2 <- v3":return t+".xy";case"v2 <- v4":return t+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+t+" ) )";case"v3 <- f":return"vec3( "+t+" )";case"v3 <- v2":return"vec3( "+t+", 0.0 )";case"v3 <- v4":return t+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+t+" ) )";case"v4 <- f":return"vec4( "+t+" )";case"v4 <- v2":return"vec4( "+t+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+t+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+t+" ) )";case"i <- f":case"i <- b":return"int( "+t+" )";case"i <- v2":return"int( "+t+".x )";case"i <- v3":return"int( "+t+".x )";case"i <- v4":return"int( "+t+".x )";case"b <- f":return"( "+t+" != 0.0 )";case"b <- v2":return"( "+t+" != vec2( 0.0 ) )";case"b <- v3":return"( "+t+" != vec3( 0.0 ) )";case"b <- v4":return"( "+t+" != vec4( 0.0 ) )";case"b <- i":return"( "+t+" != 0 )"}return t}getTypeByFormat(t){return i4e[t]||t}getFormatByType(t){return n4e[t]||t}getUUID(t,e){return e=e!==void 0?e:!0,e&&this.cache&&(t=this.cache+"-"+t),t}getElementByIndex(t){return Z9[t]}getIndexByElement(t){return Z9.indexOf(t)}isShader(t){return this.shader===t}setShader(t){return this.shader=t,this}mergeDefines(t){for(let e in t)this.defines[e]=t[e];return this.defines}mergeUniform(t){for(let e in t)this.uniforms[e]=t[e];return this.uniforms}getTextureEncodingFromMap(t){let e;return t?t.isTexture&&(e=t.encoding):e=Yc,e===Yc&&this.context.gamma&&(e=Qt),e}},Un=class extends Eo{constructor(t=0,e,i,n){super("c"),this.nodeType="Color",this.value=t instanceof wo?t:new wo(t||0,e,i,n)}setRGBA(t){this.value.setRGBA(t.r,t.g,t.b,t.a)}generate(t,e,i,n,r,s){i=t.getUUID(i??this.getUUID()),n=n??this.getType(t);let o=t.getNodeData(i),a=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let l=this.alpha.build(t,"f");t.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${l};`)}return a?this.generateReadonly(t,e,i,n,r,s):t.isShader("vertex")?(o.vertex||(o.vertex=t.createVertexUniform(n,this,r,s,this.getLabel())),t.format(o.vertex.name,n,e)):(o.fragment||(o.fragment=t.createFragmentUniform(n,this,r,s,this.getLabel())),t.format(o.fragment.name,n,e))}generateReadonly(t,e,i,n,r,s){return t.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",n,e)}},qi=class extends Eo{constructor(t){super("i"),this.nodeType="Int",this.value=Math.floor(t??0)}generateReadonly(t,e,i,n,r,s){return t.format(this.value.toString(),n,e)}},zs=class extends Eo{constructor(t){super("b"),this.nodeType="Bool",this.value=t??!1}generateReadonly(t,e,i,n){return t.format(this.value?"true":"false",n,e)}},np=class extends Eo{constructor(t=1,e){super("f[]"),this.nodeType="FloatArray",this.size=t,this.value=Array.isArray(e)?e:typeof e=="number"?new Array(t).fill(e):new Array(t).fill(0)}},cz=class extends Eo{},s4e=class extends cz{constructor(t){super("v3"),this.image=t,this._value=new L}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},jO=class extends cz{constructor(t,e){super("t"),this.image=t,this.wrap=e}get value(){return this.image.getTexture(this.wrap)}},ine=class extends Eo{constructor(t){super("m3"),this.nodeType="Matrix3",this.value=t??new Zr}generateReadonly(t,e,i,n,r,s){return t.format("mat3("+this.value.elements.join(", ")+")",n,e)}get elements(){return this.value.elements}set elements(t){this.value.fromArray(t)}},Zc=class extends Eo{constructor(e){super("m4"),this.nodeType="Matrix4",this.value=e??new $e}generateReadonly(e,i,n,r,s,o){return e.format("mat4("+this.value.elements.join(", ")+")",r,i)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}};function $9(t,e,i){t.setUvTransform(i[0],i[1],e[0],e[1],0,0,0)}var o4e=class extends ine{constructor(t,e){super(new Zr),this.repeat=t,this.offset=e,$9(this.value,t,e)}updateMatrix(){$9(this.value,this.repeat,this.offset)}},rp=class extends Eo{constructor(t=1,e){super("v4[]"),this.nodeType="Vector4Array",this.size=t,this.value=Array.isArray(e)?e:e instanceof Kt?new Array(t).fill(e):new Array(t).fill(new Kt(0))}},e7=class extends Wi{constructor(t,e,i,n){super("v3"),this.nodeType="Blend",this.a=t,this.b=e,this.alpha=i,this.mode=n}generate(t,e){if(t.isShader("fragment")){let i=[];return i.push(this.a.build(t,"c")),i.push(this.b.build(t,"c")),i.push(this.alpha.build(t,"f")),i.push(this.mode.build(t,"i")),t.format("spe_blend("+i.join(",")+")",this.getType(t),e)}else return console.warn("BlendNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},nne=class extends Wi{constructor(t,e){super("v3"),this.nodeType="CustomColor",this.color=t,this.alpha=e,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){let i=t.include(nne.Nodes.customColor);t.addFragmentVariable(this.calpha,"float");let n=[];return n.push(this.color.build(t,"v3")),n.push(this.mask?`luminance(${this.mask.build(t,"v3")})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.calpha),t.format(i+"("+n.join(",")+")",this.getType(t),e)}else return console.warn("CustomColorNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},WO=nne;WO.Nodes=function(){return{customColor:new ot(`vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color;
			}`)}}();var rne=class extends Wi{constructor(t,e){super("v3"),this.nodeType="CustomNormal",this.cnormal=t,this.alpha=e,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){let i=t.include(rne.Nodes.customNormal);t.addFragmentVariable(this.calpha,"float");let n=[];return n.push(this.cnormal.build(t,"v3")),n.push("normal"),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.calpha),t.format(i+"("+n.join(",")+")",this.getType(t),e)}else return console.warn("CustomNormalNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},sne=rne;sne.Nodes=function(){return{customNormal:new ot(`vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return normal;
			}`)}}();var h1=class extends Wi{constructor(t,e,i,n,r,s,o,a,l,c,h,u){super("v3"),this.nodeType="CustomTexture",this.texture=t,this.textureSize=e,this.crop=i,this.projection=n,this.axis=r,this.side=s,this.size=o,this.blending=a,this.mat=l,this.isMask=u,this.alpha=c,this.mode=h,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){t.require("position"),t.require("normal"),t.require("uv"),t.requires.uv=[!0],t.extensions.shaderTextureLOD=!0,t.extensions.derivatives=!0;let i=`g${this.uuid.toString().replace(/-/g,"")}`,n;switch(this.projection.value){case 3:n=t.include(h1.Nodes.cylindrical);break;case 2:n=t.include(h1.Nodes.spherical);break;case 1:let s=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],o=["zy","xz","xy"][this.axis.value],a=new ot(`
		vec3 ${i}_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 projected = (1. + (position.${o})) / 2.;
				vec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===2?"":`lalpha *= step(0.0, ${this.side.value===1?"-1.0 * ":""}dot(vObjectNormal, mat * ${s}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`);n=t.include(a);break;case 4:n=t.include(h1.Nodes.triplanar);break;default:n=t.include(h1.Nodes.uv);break}t.addFragmentVariable(this.calpha,"float");let r=[];if(r.push("normal"),r.push(this.texture.generate(t,"t")),r.push(this.textureSize.build(t,"v2")),r.push(this.crop.build(t,"f")),r.push(this.mat.build(t,"mat3")),r.push(this.size.build(t,"v2")),r.push(this.blending.build(t,"f")),r.push(this.isMask.build(t,"b")),r.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),r.push(this.alpha.build(t,"f")),r.push(this.mode.build(t,"i")),r.push(this.calpha),this.projection.value===4){let s=`${i}_writeUvs`,o=s+"0",a=s+"1",l=s+"2",c=`${i}_triplanarWeights`;t.addFragmentVariable(o,"vec2"),t.addFragmentVariable(a,"vec2"),t.addFragmentVariable(l,"vec2"),t.addFragmentVariable(c,"vec3"),r.push(o),r.push(a),r.push(l),r.push(c)}else{let s=`${i}_writeUvs`;t.addFragmentVariable(s,"vec2"),r.push(s)}return t.format(n+"("+r.join(",")+")",this.getType(t),e)}},uz=h1;uz.Nodes=function(){let t=new ot(`
vec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),e=new ot(`
vec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),i=new ot(`vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`),n=new ot(`vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {
				vec3 p = position;
				vec2 uv0 = (1.0 + p.xy) / 2.0;     
				vec2 uv1 = (1.0 + p.zy) / 2.0;		
				vec2 uv2 = (1.0 + p.xz) / 2.0;		
	
				uv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;

				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));

				// Write out all sets of UVs that we generated
				writeUvs0 = uv0;
				writeUvs1 = uv1;
				writeUvs2 = uv2;
				writeWeights = weights;

				// Derivatives for LOD
				vec2 df0 = fwidth(uv0);
				vec2 df1 = fwidth(uv1);
				vec2 df2 = fwidth(uv2);
				if (df0.x > 0.5) df0.x = 0.0;
				if (df1.x > 0.5) df1.x = 0.0;
				if (df2.x > 0.5) df2.x = 0.0;

				#ifdef GL_EXT_shader_texture_lod
                	vec4 tmp = 
						texture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						texture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						texture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#else
                	vec4 tmp = 
						textureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						textureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						textureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;

				// Apply cropping across all 3 planes
				if ( crop > 0.5 ) {
					if ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;//n * 0.5 + 0.5;
			}			
			`);return{cylindrical:t,spherical:e,uv:i,triplanar:n}}();var d1=class extends Wi{constructor(t,e,i,n,r,s,o,a,l,c,h,u){super("v3"),this.nodeType="Depth",this.gradientType=t,this.smooth=e,this.near=i,this.far=n,this.isVector=r,this.isWorldSpace=s,this.origin=o,this.direction=a,this.colors=l,this.steps=c,this.isMask=u,this.alpha=h,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){let i=`g${this.uuid.toString().replace(/-/g,"")}`,n=new ot(`vec3 ${i}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${i}_MAX_COLORS], float steps[${i}_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${i}_IS_VECTOR
                   #ifdef ${i}_LINEAR
                       #ifdef ${i}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${i}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${i}_SMOOTH
				for ( int i = 1; i < ${i}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${i}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a * mask;
               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
			   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
			   
               return color.rgb;
			}`,[d1.Nodes.vectorLinearWorldSpaceDepth,d1.Nodes.vectorLinearObjectSpaceDepth,d1.Nodes.vectorSphericalObjectSpaceDepth,d1.Nodes.vectorSphericalWorldSpaceDepth]);if(t.isShader("fragment")){t.define(`${i}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&t.define(`${i}_SMOOTH`),this.isVector.value>.5&&t.define(`${i}_IS_VECTOR`),this.gradientType.value===0&&t.define(`${i}_LINEAR`),this.isWorldSpace.value>.5&&t.define(`${i}_WORLDSPACE`),t.require("worldPosition"),t.addFragmentVariable(this.calpha,"float");let r=t.include(n),s=[];return s.push(this.near.build(t,"f")),s.push(this.far.build(t,"f")),s.push(this.origin.build(t,"v3")),s.push(this.direction.build(t,"v3")),s.push(this.colors.build(t,"v4[]")),s.push(this.steps.build(t,"f[]")),s.push(this.isMask.build(t,"b")),s.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),s.push(this.alpha.build(t,"f")),s.push(this.calpha),t.format(r+"("+s.join(",")+")",this.getType(t),e)}else return console.warn("DepthNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},one=d1;one.Nodes=function(){let t=new ot(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),e=new ot(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),i=new ot(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),n=new ot(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:t,vectorLinearObjectSpaceDepth:e,vectorSphericalWorldSpaceDepth:i,vectorSphericalObjectSpaceDepth:n}}();var a4e=class extends Wi{constructor(t,e,i,n,r,s,o,a){super("v3"),this.nodeType="Fresnel",this.color=t,this.bias=e,this.scale=i,this.intensity=n,this.factor=r,this.isMask=a,this.alpha=s,this.mode=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("vWorldViewDir"),t.require("worldNormal"),t.isShader("fragment")){t.addFragmentVariable(this.calpha,"float");let i=new ot(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {
					float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

					float lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return color;
				}`),n=t.include(i),r=[];return r.push(this.color.build(t,"c")),r.push(this.bias.build(t,"f")),r.push(this.scale.build(t,"f")),r.push(this.intensity.build(t,"f")),r.push(this.factor.build(t,"f")),r.push(this.isMask.build(t,"b")),r.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),r.push(this.alpha.build(t,"f")),r.push(this.mode.build(t,"i")),r.push(this.calpha),t.format(n+"("+r.join(",")+")",this.getType(t),e)}else return console.warn("FresnelNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},ane=class extends Wi{constructor(t,e,i,n,r,s,o,a,l){super("v3"),this.nodeType="Gradient",this.gradientType=t,this.smooth=e,this.colors=i,this.steps=n,this.offset=r,this.morph=s,this.angle=o,this.isMask=l,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){t.define("GRAD_MAX",10),t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let i=t.include(ane.Nodes.gradient),n=[];return n.push(this.gradientType.build(t,"i")),n.push(this.smooth.build(t,"b")),n.push(this.colors.build(t,"v4[]")),n.push(this.steps.build(t,"f[]")),n.push(this.offset.build(t,"v2")),n.push(this.morph.build(t,"v2")),n.push(this.angle.build(t,"f")),n.push(this.isMask.build(t,"b")),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.calpha),t.format(i+"("+n.join(",")+")",this.getType(t),e)}else return console.warn("GradientNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},lne=ane;lne.Nodes=function(){return{gradient:new ot(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
				
				return color.xyz;
			}`)}}();var cne=class extends Wi{constructor(t,e,i,n){super("v3"),this.nodeType="Matcap",this.texture=t,this.isMask=n,this.alpha=e,this.mode=i,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){t.addFragmentVariable(this.calpha,"float");let i=t.include(cne.Nodes.matcap);t.require("normal"),t.requires.normal=!0;let n=[];return n.push(this.texture.generate(t,"t")),n.push("normal"),n.push(this.isMask.build(t,"b")),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.mode.build(t,"i")),n.push(this.calpha),t.format(i+"("+n.join(",")+")",this.getType(t),e)}else return console.warn("MatcapNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},une=cne;une.Nodes=function(){return{matcap:new ot(`vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha) {
					vec3 viewDir = normalize( vViewPosition );
					vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
					vec3 y = cross( viewDir, x );
					vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks
					vec4 matcapColor = texture2D( matcapTex, uv );

					float lalpha = alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
					
					return matcapColor.rgb;
            	}`)}}();var hz=(t=>(t.SIMPLEX="simplex3d",t.SIMPLEX_FRACTAL="simplex3dFractal",t.ASHIMA="simplexAshima",t.FBM="fbm",t.PERLIN="perlin",t.VORONOI="voronoi",t))(hz||{}),io=function(){let t=new ot(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),e=new ot(`float simplex3d(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[t]);e.keywords.F3=new ki("float F3 0.3333333"),e.keywords.G3=new ki("float G3 0.1666667");let i=new ot(`float simplex3dFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplex3d(m * rot1)
				 + 0.2666667 * simplex3d(2.0 * m * rot2)
				 + 0.1333333 * simplex3d(4.0 * m * rot3)
				 + 0.0666667 * simplex3d(8.0 * m);
		}`,[e]),n=new ot("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),r=new ot("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),s=new ot(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[n,r]),o=new ot("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),a=new ot("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[o]),l=new ot(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[a]),c=new ot(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[l]);c.keywords.NUM_OCTAVES=new ki("int NUM_OCTAVES 5");let h=new ot("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),u=new ot(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[n,r,h]),d=new ot(`float hashwithoutsine13(vec3 p3)
		{
			p3  = fract(p3 * .1031);
			p3 += dot(p3, p3.yzx + 33.33);
			return fract((p3.x + p3.y) * p3.z);
		}`),f=new ot(`vec3 hashwithoutsine33(vec3 p3)
		{
			p3 = fract(p3 * vec3(.1031, .1030, .0973));
			p3 += dot(p3, p3.yxz+33.33);
			return fract((p3.xxy + p3.yxx)*p3.zyx);
		}`),p=new ot(`float metric(in vec3 p)
		{
			// L2 
			return length(p);

			// Chebyshev 
			// vec3 a = abs(p);
			// return max(a.x, max(a.y, a.z));
		}`),m=new ot(`float smin( float a, float b, float k )
		{
			float h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);
			float correction = k * h * (1.0 - h);
			return mix(b, a, h) - correction;
		}`),v=new ot(`float smax( float a, float b, float k )
		{
			float h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);
			float correction = k * h * (1.0 - h);
			return mix(a, b, h) + correction;
		}`),g=new ot(`float remap(float value, float input_min, float input_max, float output_min, float output_max) {
			// Compute width of each interval
			float input_width = input_max - input_min;
			float output_width = output_max - output_min;
		
			// Convert input range into a 0-1 range 
			float scaled = (value - input_min) / input_width;
		
			// Convert the 0-1 range into a value in output range
			return output_min + (scaled * output_width);
		}`),y=new ot(`float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) 
		{
			// Integer and fractional parts of this point's coordinates
			ivec3 p = ivec3(floor(x));
			vec3 f = fract(x);

			// Different variables that we will use to construct noise:
			//
			// f1: distance to the closest feature point
			// f2: distance to the second closest feature point
			// e: distance to the closest edge (cell boundary)
			//
			// We also compute "smooth" versions of all of the above quantites, essentially
			// replacing "hard" minimums with "smooth" minimums (described by IQ)
			float f1_smooth = 8.0;
			float f1 = 8.0;
			float f2_smooth = 8.0;
			float f2 = 8.0;
			float e_smooth = 8.0;
			float e = 8.0;

			// Variables stored from closest cell
			ivec3 mb;
			vec3 mr; 

			int steps = quality;
			
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				ivec3 b = ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d = length(r);
				
				f1_smooth = smin(d, f1_smooth, smoothness);

				// Store un-smoothed distances too 
				if (d < f1) 
				{
					f2 = f1;
					f1 = d;

					mb = ivec3(x, y, z);
					mr = r;
				} 
				else if (d < f2) 
				{
					f2 = d;
				}
			}	
			
			float id = hashwithoutsine13(vec3(p + mb) + seed);

			// Second pass for edge distance  
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				// Start search at the cell that contains the closest point to "x" (found in 1st pass)
				ivec3 b = mb + ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d1 = dot(0.5 * (mr + r), (r - mr)); 				// IQ normalizes "r - mr" but that breaks things for the smooth version?
				float d2 = dot(0.5 * (mr + r), normalize(r - mr));

				e_smooth = smin(d1, e_smooth, smoothness);

				e = min(e, d2);

				// Also compute a smooth version of F2 in this pass
				{
					ivec3 b = ivec3(x, y, z);
					if (b != mb) 
					{
						vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
						float d = length(r);

						f2_smooth = smin(d, f2_smooth, smoothness);
					}
				}
			}

			// Different visualization modes 
			if (style == 0) 
			{
				return f1_smooth;
			}
			if (style == 1) 
			{
				return f2_smooth;
			}
			if (style == 2) 
			{
				return f2_smooth - f1_smooth;
				
				// "Pebbles" also cool
				//return step(0.2, f2_smooth - f1_smooth);
			}
			if (style == 3) 
			{
				// This one is really good for rock / stone effects
				float a = f1; 
				float b = f2;
				float k = 3.0;
				float h = max(k - abs(a - b), 0.0) / k;
				float final = min(a, b) - h * h * k * (1.0 / 4.0);
				return final;
			}
			if (style == 4) 
			{
				// Some random adjustments to make this style stand out more 
				return exp(5.0 * e_smooth);
			}
			if (style == 5) 
			{
				return pow(f1_smooth, 3.0);
			}
			if (style == 6) 
			{				
				const float eps = 0.0125;

				// Thicker lines as the user increases the smoothness slider
				float thickness = smoothness * 0.25 + eps;

				// Blurrier lines as the user increases the smoothness slider
				float blur = pow(smoothness, 3.0) * 0.25 + eps;

				return smoothstep(
					thickness - thickness * blur, 
					thickness + thickness * blur, 
					e
				);
			}
			if (style == 7) 
			{
				return hashwithoutsine13(vec3(p + mb) + seed);
			}
		}
	`,[d,f,p,m,v,g]);return{simplex:e,simplexFractal:i,simplexAshima:s,fbm:c,perlin:u,voronoi:y}}(),hne=class extends Wi{constructor(t,e,i,n,r,s,o,a,l,c,h,u,d,f,p,m,v,g,y){super("v3"),this.nodeType="Noise",this.scale=t,this.size=e,this.move=i,this.fA=n,this.fB=r,this.distortion=s,this.colorA=o,this.colorB=a,this.colorC=l,this.colorD=c,this.noiseType=u,this.voronoiStyle=f,this.highCut=p,this.lowCut=m,this.smoothness=v,this.seed=g,this.quality=y,this.isMask=d,this.alpha=h,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e,i,n,r){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let s=Object.values(hz)[this.noiseType.value],o=s=="voronoi"?`
		float v = ${s}(st + move, voronoiStyle, smoothness, seed, quality);

		// Apply clipping to colors
		v = remap(v, lowCut, highCut, 0.0, 1.0);
		v = smax(v, 0.0, smoothness * 0.25);
		v = smin(v, 1.0, smoothness * 0.25);

		// Note that the voronoi mode only uses colors "A" and "C" from the UI 
		vec4 color = mix(colorA, colorC, v); 
		`:`
		vec3 q = vec3(${s}(st),
					   ${s}(st + vec3(1.0)),
					   ${s}(st + vec3(1.0)));
		vec3 r = vec3(${s}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
					  ${s}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
					  ${s}(st * q));
		float f = ${s}(st + r);
		vec4 color;
		color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
		color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
		color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));
		`,a=new ot(`vec3 ${s}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) 
			{
                // Prevent scale of zero 
				scale = max(abs(scale), 0.001);

				vec3 st = position / size;
				st /= scale;

				${o}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return clamp(color, 0.0, 1.0).rgb;
			}`,[io.simplex,io.simplexFractal,io.simplexAshima,io.fbm,io.perlin,io.voronoi]),l=t.include(a),c=[];return c.push(this.scale.build(t,"f")),c.push(this.size.build(t,"v3")),c.push(this.move.build(t,"f")),c.push(this.fA.build(t,"v2")),c.push(this.fB.build(t,"v2")),c.push(this.distortion.build(t,"v2")),c.push(this.colorA.build(t,"v4")),c.push(this.colorB.build(t,"v4")),c.push(this.colorC.build(t,"v4")),c.push(this.colorD.build(t,"v4")),c.push(this.voronoiStyle.build(t,"i")),c.push(this.highCut.build(t,"f")),c.push(this.lowCut.build(t,"f")),c.push(this.smoothness.build(t,"f")),c.push(this.seed.build(t,"f")),c.push(this.quality.build(t,"i")),c.push(this.isMask.build(t,"b")),c.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),c.push(this.alpha.build(t,"f")),c.push(this.calpha),t.format(l+"("+c.join(",")+")",this.getType(t),e)}};hne.numOctaves=5;var dne=class extends Wi{constructor(t,e,i,n,r,s,o,a,l,c,h,u,d,f,p,m){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=t,this.contourColor=e,this.outlineWidth=i,this.contourWidth=n,this.contourThreshold=r,this.outlineThreshold=s,this.contourFrequency=o,this.outlineSmoothing=a,this.contourDirection=l,this.positionalLines=c,this.compensation=h,this.resolution=u,this.normalMap=d,this.depthMap=f,this.pixelRatio=p,this.alpha=m,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){let i=`g${this.uuid.toString().replace(/-/g,"")}`;if(t.require("vWorldViewDir"),t.require("worldNormal"),t.extensions.derivatives=!0,this.compensation.value&&t.define("OUTLINE_COMPENSATION",`${i}_offset`),this.firstTime){let n=this.outlineWidth.build(t,"f"),r=this.resolution.build(t,"v2"),s=this.compensation.build(t,"b"),o=this.pixelRatio.build(t,"f");t.addVertexParsVariable("randomColor","attribute vec3"),t.addVertexParsVariable("extrudeNormal","attribute vec3"),t.addVertexParsVariable(n,"uniform float"),t.addVertexParsVariable(r,"uniform vec2"),t.addVertexParsVariable(s,"uniform bool"),t.addVertexParsVariable(o,"uniform float"),t.addVertexParsVariable("vID","flat out float"),t.addFragmentParsVariable("vID","flat in float"),t.addVertexFinalCode(`
                vID = randomColor.r;
                vec2 ${i}_offset = vec2(0.0);
                if (${s}) {
                    vec4 ${i}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the
                    // normals face the camera directly. So we hackily fix this by offsetting the normal
                    // by a tiny amount.
                    vec3 ${i}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;
                    ${i}_offset = normalize(${i}_clipNormal.xy) / ${r} * (${n} / 2.0) * ${i}_clipPosition.w * 2.0 * ${o};
                    ${i}_clipPosition.xy += ${i}_offset;
                    // TODO(MAX): To handle multiple outline layers, we only want to extrude
                    // if this offset is the biggest of all the potential offsets
                    gl_Position = ${i}_clipPosition;
                }
            `)}if(t.isShader("fragment")){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let n=t.include(dne.Nodes.outline),r=[];return r.push(this.outlineColor.build(t,"c")),r.push(this.contourColor.build(t,"c")),r.push(this.outlineWidth.build(t,"f")),r.push(this.contourWidth.build(t,"f")),r.push(this.contourThreshold.build(t,"f")),r.push(this.outlineThreshold.build(t,"f")),r.push(this.contourFrequency.build(t,"f")),r.push(this.outlineSmoothing.build(t,"f")),r.push(this.contourDirection.build(t,"v3")),r.push(this.positionalLines.build(t,"b")),r.push(this.resolution.build(t,"v2")),r.push(this.normalMap.getTexture(t,"t")),r.push(this.depthMap.getTexture(t,"t")),r.push(this.pixelRatio.build(t,"f")),r.push(this.compensation.build(t,"b")),r.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),r.push(this.alpha.build(t,"f")),r.push(this.calpha),this.firstTime=!this.firstTime,t.format(n+"("+r.join(",")+")",this.getType(t),e)}else return console.warn("OutlineNode is not compatible with "+t.shader+" shader."),""}},fne=dne;fne.Nodes=function(){let t=new ot(`
float sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)
{
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    vec2 texelSize = (vec2(1.0) / resolution);
    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;

    vec2 uvSamples[9];
    vec4 normalSamples[9];

	uvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);
	uvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);
	uvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);
	uvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);
	uvSamples[4] = uv;
	uvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);
	uvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);
	uvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);
	uvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);


    normalSamples[0] = texture2D(t, uvSamples[0]);
    normalSamples[1] = texture2D(t, uvSamples[1]);
    normalSamples[2] = texture2D(t, uvSamples[2]);
    normalSamples[3] = texture2D(t, uvSamples[3]);
    normalSamples[4] = texture2D(t, uvSamples[4]);
    normalSamples[5] = texture2D(t, uvSamples[5]);
    normalSamples[6] = texture2D(t, uvSamples[6]);
    normalSamples[7] = texture2D(t, uvSamples[7]);
    normalSamples[8] = texture2D(t, uvSamples[8]);

    float depthBias = 0.0001;
    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!
    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }


    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);
  	vec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);

    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));
    return edgeNormal;
}
`);return{outline:new ot(`vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {
                vec3 result = outlineColor;
                float resultAlpha = 0.0;

                vec3 N = normalize(vWNormal);
                vec2 nuv = (gl_FragCoord.xy / resolution);
                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);
                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);

                //resultAlpha = 1.0;
                //result = vec3(sobelSample);

                float t = 1.0 - contourThreshold;
                if(positionalLines) {
                    vec3 NDir = position * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float f  = fract(NT * contourFrequency * 0.01);
                    float df = fwidth(NT * contourFrequency);

                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);
                    if (g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0;
                    }
                 }
                 else {
                    vec3 NDir = N * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float df = fwidth(NT * contourThreshold);
                    float f = sin(NT * 1.0 * contourFrequency);
                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);

                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0 - g;
                    }
                 }

                 float lalpha = alpha * resultAlpha * mask;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				 
                 return result;
             }`,[t])}}();var Ru=class extends Wi{constructor(t,e,i,n,r,s,o,a,l,c,h,u,d,f,p,m,v,g){super("v3"),this.nodeType="Pattern",this.style=t,this.projection=e,this.axis=i,this.blending=n,this.offset=r,this.colorA=s,this.colorB=o,this.frequency=a,this.size=l,this.variation=c,this.smoothness=h,this.zigzag=u,this.rotation=d,this.vertical=f,this.horizontal=p,this.sides=m,this.isMask=g,this.alpha=v,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){t.require("position"),t.require("uv"),t.requires.uv=[!0],t.require("normal"),t.requires.normal=!0,t.addFragmentVariable(this.calpha,"float");let i;switch(this.style.value){case 0:i="circle";break;case 1:i="ring";break;case 2:i="polygon";break;case 3:i="xcross";break;case 4:i="diamond";break;case 5:i="checkerboard";break;case 6:i="line";break;case 7:i="wave";break;default:i="circle";break}let n=`g${this.uuid.toString().replace(/-/g,"")}`,r=new ot(`float hashwithoutsine12(vec2 p)
				{
					vec3 p3 = fract(vec3(p.xyx) * .1031);
					p3 += dot(p3, p3.yzx + 33.33);
					return fract((p3.x + p3.y) * p3.z);
				}`),s=new ot(`vec2 rotate_uv(in vec2 uv, float a, bool repeat) 
				{
					const float mid = 0.5;
					float radians = a * (PI / 180.0);
					vec2 rotated = vec2(
						cos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,
						cos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid
					);
					return repeat ? fract(rotated): rotated;
				}`),o="";if(this.projection.value===4){let h=this.style.value===2?`${i}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,u=this.style.value===2?`${i}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,d=this.style.value===2?`${i}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)`;o=`
				vec3 p = position;
				float factor = 0.0125;
				vec2 uv0 = fract(p.xy * factor);
				vec2 uv1 = fract(p.zy * factor);
				vec2 uv2 = fract(p.xz * factor);
				
				uv0 = rotate_uv(uv0 + offset, rotation, true);
				uv1 = rotate_uv(uv1 + offset, rotation, true);
				uv2 = rotate_uv(uv2 + offset, rotation, true);
	
				float d0 = ${h};
				float d1 = ${u};
				float d2 = ${d};
				
				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));
				d0 *= weights.z;
				d1 *= weights.x;
				d2 *= weights.y;
				float draw = d0 + d1 + d2;
	
				vec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;
				`}else{let h=this.style.value===2?`${i}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,u="";this.axis.value===0?u=`float radius = length(p);
					float theta = atan(p.y, p.z);
					float phi = acos(p.x / radius);`:this.axis.value===1?u=`float radius = length(p);
					float theta = atan(p.x, p.z);
					float phi = acos(p.y / radius);`:(this.axis.value,u=`float radius = length(p);
					float theta = atan(p.y, p.x);
					float phi = acos(p.z / radius);`);let d="";switch(this.projection.value){case 0:d="custom_uv = vUv.st;";break;case 1:break;case 2:d=`
							vec3 p = position;
							${u}
							custom_uv = vec2(theta, phi);
							custom_uv /= PI;
							`;break}o=`
				vec2 custom_uv;
				${d}
	
				custom_uv += offset;
				custom_uv = fract(custom_uv);
				custom_uv = rotate_uv(custom_uv, rotation, true);
	
				float draw = ${h};
				`}let a=new ot(`vec3 ${n}_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {
					const float TWO_PI = PI * 2.0;
					float smoothness_remapped = pow(smoothness, 5.0);	

					${o}

					// Construct final output color
					vec4 color = mix(colorA, colorB, draw);
					color.a = clamp(color.a, 0.0, 1.0);

					// Apply cuts
					color.a *= 
						step(vertical.x, custom_uv.y) * 
						step(custom_uv.y, vertical.y);
					color.a *= 
						step(horizontal.x, abs(custom_uv.x)) * 
						step(abs(custom_uv.x), horizontal.y);

					// Accumulate alpha 
					float lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return clamp(color, 0.0, 1.0).rgb;
				}`,[s,r,Ru.DrawFunctions.circle,Ru.DrawFunctions.ring,Ru.DrawFunctions.polygon,Ru.DrawFunctions.cross,Ru.DrawFunctions.diamond,Ru.DrawFunctions.checkerboard,Ru.DrawFunctions.line,Ru.DrawFunctions.wave]),l=t.include(a),c=[];return c.push("normal"),c.push(this.blending.build(t,"f")),c.push(this.style.build(t,"i")),c.push(this.offset.build(t,"v2")),c.push(this.colorA.build(t,"v4")),c.push(this.colorB.build(t,"v4")),c.push(this.frequency.build(t,"v2")),c.push(this.size.build(t,"f")),c.push(this.variation.build(t,"f")),c.push(this.smoothness.build(t,"f")),c.push(this.zigzag.build(t,"f")),c.push(this.rotation.build(t,"f")),c.push(this.vertical.build(t,"v2")),c.push(this.horizontal.build(t,"v2")),c.push(this.sides.build(t,"i")),c.push(this.isMask.build(t,"b")),c.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),c.push(this.alpha.build(t,"f")),c.push(this.calpha),t.format(l+"("+c.join(",")+")",this.getType(t),e)}else return console.warn("PatterNode is not compatible with "+t.shader+" shader."),t.format("vec3(0.0)",this.getType(t),e)}},pne=Ru;pne.DrawFunctions=function(){let t=new ot(`float hashwithoutsine12(vec2 p) {
				vec3 p3 = fract(vec3(p.xyx) * 0.1031);
				p3 += dot(p3, p3.yzx + 33.33);
				return fract((p3.x + p3.y) * p3.z);
			}`),e=new ot(`vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {
                // Create tiles in UV-space
                uv *= frequency;

                // Integer coords
                vec2 i = floor(uv);

                // Offset every other row based on zigzag param, then compute fractional coords
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = fract(uv);

				// Rotate the tile itself:
				// const float mid = 0.5;
				// f = vec2(
				// 	cos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,
				// 	cos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid
				// );
				// f = fract(f);

                f = f * 2.0 - 1.0;

				// Recompute integer coords after shifting - then, random value per tile 
				i = floor(uv);
				float rand = (hashwithoutsine12(i) * 5.0 + 1.0);
				float jitter = mix(1.0, rand, variation);
				f *= jitter;

                return f;
            }`,[t]),i=new ot(`float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(
                    -smoothness, 
                     smoothness, 
                     length(f) - size
                );
            }`,[e]),n=new ot(`float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);

				float d = length(f);
                const float inner_width = 0.5;

                float outer = smoothstep(-smoothness, smoothness, d - size);
                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);
				return outer + (1.0 - inner);   
            }`,[e]),r=new ot(`float sdf_ngon(in vec2 p, in float r, in int n) {
                float an = (PI * 2.0) / float(n);
                float he = r * tan(0.5 * an);
                
                // Rotate to first sector
                p = -p.yx; 
                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);
                vec2  cs = vec2(cos(bn), sin(bn));
                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;
            
                // Side of polygon
                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);
            }
            
            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));
            }`,[e]),s=new ot(`float sdf_cross(in vec2 p, in vec2 b, float r ) {
                p = abs(p); 
				p = (p.y > p.x) ? p.yx : p.xy;
                vec2  q = p - b;
                float k = max(q.y, q.x);
                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);
                return sign(k) * length(max(w, 0.0)) + r;
            }
            
            // Avoid namespace conflicts 
            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));
            }`,[e]),o=new ot(`float ndot(vec2 a, vec2 b) { 
                return a.x*b.x - a.y*b.y; 
            }
            
            float sdf_diamond(in vec2 p, in vec2 b) {
                p = abs(p);
                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);
                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));
                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);
            }

            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
	            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));
            }`,[e]),a=new ot(`float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                uv *= frequency;
                vec2 i = floor(uv);

                float offset = mod(i.y, 2.0);

                uv.x += offset + zigzag * offset;
                float x = floor(uv.x);
                
                return mod(x, 2.0);
            }`),l=new ot(`float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);
				
				// Different approach for variation param here
				float row = floor(uv * frequency).y;
				float rand = hashwithoutsine12(vec2(row));
				float s = mix(size, size * rand, variation);

				return smoothstep(
					s - smoothness, 
					s + smoothness, 
					abs(f.y)
				);
            }`,[e]),c=new ot(`// Uses bisection 
            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {
                // Convert all data to a primitive cosine wave
                p = c * (p - vec2(d, a));
                
                const float TWO_PI = PI * 2.0;

                // Reduce to principal half cycle
                p.x = mod(p.x, TWO_PI); 
                if (p.x > PI) {
                    p.x = TWO_PI - p.x;
                }
            
                // Find zero of derivative (minimize distance)
                float xa = 0.0;
                float xb = TWO_PI;

                // 24 bit precision
                for (int i = 0; i < 24; i++) {
                    float x = 0.5 * (xa + xb);
                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));
                    if (y < 0.0) xa = x; 
                    else xb = x;
                }
                float x = 0.5 * (xa + xb);
                
                // Compute distance    
                vec2 q = vec2(x, b * c * cos(x));
                return length(p - q) / c;
            }

            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                float repeat = frequency.x;
                uv *= repeat;
                vec2 i = floor(uv);
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = vec2(uv.x, fract(uv.y));

                // Generalized cosine: y(x) = a + b * cos(cx + d)
                const float amplitude = 0.125;
                float wave_frequency = frequency.y * 0.1;
                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);

				// Different approach for variation param here
				float rand = hashwithoutsine12(vec2(i.y));
				float s = mix(size, size * rand, variation);

                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);
            }`);return{tileAndCenter:e,circle:i,ring:n,polygon:r,cross:s,diamond:o,checkerboard:a,line:l,wave:c}}();var mne=class extends Wi{constructor(t,e,i,n,r,s,o,a){super("v3"),this.nodeType="Rainbow",this.filmThickness=t,this.movement=e,this.wavelengths=i,this.noiseStrength=n,this.noiseScale=r,this.offset=s,this.isMask=a,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("vWorldViewDir"),t.require("worldNormal"),t.isShader("fragment")){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let i=t.include(mne.Nodes.rainbow),n=[];return n.push(this.filmThickness.build(t,"f")),n.push(this.movement.build(t,"f")),n.push(this.wavelengths.build(t,"v3")),n.push(this.noiseStrength.build(t,"f")),n.push(this.noiseScale.build(t,"f")),n.push(this.offset.build(t,"v3")),n.push(this.isMask.build(t,"b")),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.calpha),t.format(i+"("+n.join(",")+")",this.getType(t),e)}else return console.warn("RainbowNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},gne=mne;gne.Nodes=function(){let t=new ot(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
                 vec3 st = position / noiseScale;
				 vec3 q = vec3(simplex3d(st),
							  simplex3d(st + vec3(1.0)),
							  simplex3d(st + vec3(1.0)));

				 vec3 r = vec3(simplex3d(st + vec3(1.4, 1.3, 1.0) * q + vec3(1.7, 9.2, 1.0)),
							  simplex3d(st + vec3(2.0, 1.2, 1.0) * q + vec3(8.3, 2.8, 1.0)),
							  simplex3d(st * q));

                 float noise = simplex3d(st + r);

                 return .5 + .5 * cos((((filmThickness + (noise * noiseStrength)) / (vec3(wavelengths.r * 1.0, wavelengths.g * 0.8, wavelengths.b * 0.6) + 1.0)) * dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal))) + movement);
             }`,[io.simplex]);return{rainbow:new ot(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {
				vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

				float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);

				float lalpha = alpha * rainbowContribution * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return res;
             }`,[t])}}();var vne=class extends Wi{constructor(t,e,i,n,r,s,o,a,l,c){super("v3"),this.nodeType="Toon",this.positioning=t,this.colors=e,this.steps=i,this.source=n,this.isWorldSpace=r,this.noiseStrength=s,this.noiseScale=o,this.shadowColor=a,this.offset=l,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("worldNormal"),t.require("worldPosition"),t.isShader("fragment")){t.define("COLORS_MAX",10),t.addFragmentVariable(this.calpha,"float");let i=t.include(vne.Nodes.toon),n=[];return n.push(this.positioning.build(t,"i")),n.push(this.colors.build(t,"v4[]")),n.push(this.steps.build(t,"f[]")),n.push(this.source.build(t,"v3")),n.push(this.isWorldSpace.build(t,"b")),n.push(this.noiseStrength.build(t,"f")),n.push(this.noiseScale.build(t,"f")),n.push(this.shadowColor.build(t,"v4")),n.push(this.offset.build(t,"v3")),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.calpha),t.format(i+"("+n.join(",")+")",this.getType(t),e)}else return console.warn("ToonNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},yne=vne;yne.Nodes=function(){let t=new ot(`float rand(float n) {
				return fract(sin(n) * 43758.5453123);
			}`),e=new ot(`float hash1(float p) { 
				p = fract(p * 0.011); 
				p *= p + 7.5; 
				p *= p + p; 
				return fract(p); 
			}`),i=new ot(`float valueNoise(vec3 x) {
				const vec3 step = vec3(110, 241, 171);
			
				vec3 i = floor(x);
				vec3 f = fract(x);
			 
				// For performance, compute the base input to a 1D hash from the integer part of the argument and the 
				// incremental change to the 1D based on the 3D -> 1D wrapping
				float n = dot(i, step);
			
				vec3 u = f * f * (3.0 - 2.0 * f);
				return mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),
						   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);
			}`,[e]),n=new ot(`vec3 hash3(vec3 x) {
				x = vec3(dot(x,vec3(127.1, 311.7, 74.7)),
						 dot(x,vec3(269.5, 183.3, 246.1)),
						 dot(x,vec3(113.5, 271.9, 124.6)));
			
				return fract(sin(x)*43758.5453123);
			}`),r=new ot(`vec3 voronoiNoise(in vec3 x)
			{
				vec3 p = floor(x);
				vec3 f = fract(x);

				float id = 0.0;
				vec2 res = vec2(100.0);

				for(int k=-1; k<=1; k++)
				for(int j=-1; j<=1; j++)
				for(int i=-1; i<=1; i++)
				{
					vec3 b = vec3(float(i), float(j), float(k));

					// Comment out the "+ hash(p + b);" part below to get "square" cells
					vec3 r = vec3(b) - f + hash3(p + b);
					float d = dot(r, r);

					if (d < res.x)
					{
						id = dot(p + b, vec3(1.0, 57.0, 113.0));
						res = vec2(d, res.x);			
					}
					else if (d < res.y)
					{
						res.y = d;
					}
				}

				return vec3(sqrt(res), abs(id));
			}
			`,[n]);return{toon:new ot(`vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {
				float t = 0.0;
				float shadow = 1.0;

				if (positioning == 0) {

					// Can't do this mode if lighting is "none"
					#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))

						// Algorithm from Chapter 10 of Graphics Shaders
						const vec3 weights = vec3(0.2125, 0.7154, 0.0721);
						vec3 lpos;
						vec3 l;
						float dproduct;

						#if (NUM_POINT_LIGHTS > 0)

							#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)
								PointLightShadow pointLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_POINT_LIGHTS; i++) {
								// Light positions are in view-space for some reason?
								lpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								
								// TODO: we want to use "intensity" but it isn't available in the shader code
								//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);

								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)
									pointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getPointShadow( 
											pointShadowMap[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowMapSize, 
											pointLightShadow.shadowBias, 
											pointLightShadow.shadowRadius,
											vPointShadowCoord[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowCameraNear, 
											pointLightShadow.shadowCameraFar);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_DIR_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)
								DirectionalLightShadow directionalLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_DIR_LIGHTS; i++) {
								// Use the direction vector for directional lights instead
								l = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;
		
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)
									directionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow( 
										UNROLLED_LOOP_INDEX,
										directionalShadowMap[UNROLLED_LOOP_INDEX], 
										directionalLightShadow.shadowMapSize, 
										directionalLightShadow.shadowBias, 
										directionalLightShadow.shadowRadius, 
										vDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_SPOT_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)
								SpotLightShadow spotLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_SPOT_LIGHTS; i++) {
								lpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)
									spotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow(
										UNROLLED_LOOP_INDEX,
										spotShadowMap[UNROLLED_LOOP_INDEX], 
										spotLightShadow.shadowMapSize, 
										spotLightShadow.shadowBias, 
										spotLightShadow.shadowRadius, 
										vSpotLightCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						t = clamp(t, 0.0, 1.0);
				
					#endif

				} else if (positioning == 1) {
					
					vec3 origin = mix(position, worldPosition, float(isWorldSpace));
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	

				} else {

					vec3 origin = worldPosition;
					vec3 source = cameraPosition - offset;
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	
					
				}

				if (noiseStrength > 0.0) {
					// Distort with noise
					vec3 st = position / noiseScale;
					
					// Voronoi "smooth" noise
					float noise = 1.0 - voronoiNoise(st).x;

					// Voronoi cellular noise
					//float noise = 1.0 - rand(voronoiNoise(st).z);

					// Position warp noise
					// vec3 offset = vec3(
					// 	simplex3d(st),
					// 	simplex3d(st + vec3(111.1, 143.89, 217.19)),
					// 	simplex3d(st + vec3(171.1, 247.89, 117.23))
					// );
					// st += offset;
					// float noise = valueNoise(st);

					t += noise * noiseStrength;
				}

				t = clamp(t, 0.0, 1.0);

				// Compute ramp color
				float p;
				vec4 color = colors[0];
				for (int i = 1; i < COLORS_MAX; i++) {
					p = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);
					color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
				}

				// Incorporate custom shadow color
				if (positioning == 0) {

					vec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);
					color.rgb = mix(blendedShadow, color.rgb, shadow);
				
				}

				// Accumulate alpha as usual
				float lalpha = alpha * color.a * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color.xyz;

            }`,[io.simplex,t,i,r])}}();var l4e=function(){return{textureBicubic:new ot(`float w0( float a ) {
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
        }
    
        float w1( float a ) {
            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
        }
    
        float w2( float a ){
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
        }
    
        float w3( float a ) {
            return ( 1.0 / 6.0 ) * ( a * a * a );
        }
    
        // g0 and g1 are the two amplitude functions
        float g0( float a ) {
            return w0( a ) + w1( a );
        }
    
        float g1( float a ) {
            return w2( a ) + w3( a );
        }
    
        // h0 and h1 are the two offset functions
        float h0( float a ) {
            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
        }
    
        float h1( float a ) {
            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
        }
    
        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
            uv = uv * texelSize.zw + 0.5;
    
            vec2 iuv = floor( uv );
            vec2 fuv = fract( uv );
    
            float g0x = g0( fuv.x );
            float g1x = g1( fuv.x );
            float h0x = h0( fuv.x );
            float h1x = h1( fuv.x );
            float h0y = h0( fuv.y );
            float h1y = h1( fuv.y );
    
            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    
            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + 
                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
        }

        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
            vec2 fLodSizeInv = 1.0 / fLodSize;
            vec2 cLodSizeInv = 1.0 / cLodSize;
            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
            return mix( fSample, cSample, fract( lod ) );
        }`)}}();function c4e(t,e){return t>=e?new he(e/t,1):new he(1,t/e)}var xne=class extends Wi{constructor(t,e,i,n,r,s,o,a){super("v3"),this.nodeType="Transmission",this.thickness=t,this.ior=e,this.roughness=i,this.transmissionSamplerSize=n,this.transmissionSamplerMap=r,this.transmissionDepthMap=s,this.aspectRatio=o,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.extensions.shaderTextureLOD=!0,t.extensions.derivatives=!0,t.isShader("fragment")){t.define("NUM_SAMPLES",6),t.define("BLUR_SLOD",Math.pow(2,Rt.transmissionLod.value)),t.require("worldPosition"),t.requires.worldNormal=!0,t.requires.modelMatrix=!0,t.requires.projectionMatrix=!0,t.addFragmentVariable(this.calpha,"float");let i=t.include(xne.Nodes.transmission),n=[];return n.push(this.thickness.build(t,"f")),n.push(this.ior.build(t,"f")),n.push(this.roughness.build(t,"f")),n.push(this.transmissionSamplerSize.build(t,"v2")),n.push(this.transmissionSamplerMap.getTexture(t,"t")),n.push(this.transmissionDepthMap.getTexture(t,"t")),n.push(this.aspectRatio.build(t,"v2")),n.push("normal"),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.calpha),t.format(i+"("+n.join(",")+")",this.getType(t),e)}else return console.warn("TransmissionNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},_ne=xne;_ne.Nodes=function(){let t=new ot(`vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

				// Special case for blur == 0.0
				if (lod == 0.0) {
					#ifdef TEXTURE_LOD_EXT
					return texture2DLodEXT( sp, U, 0.0).rgb;
					#else
					return textureLod( sp, U, 0.0).rgb;
					#endif
				}
				
				vec2 texelSize = vec2(1.0) / resolution;
                vec2 halton = haltonSequence[frameIndex];
                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
                float temporalAngle  = temporalOffset * PI2;
				vec3 res = vec3(0.0);
                vec2 uv = vec2(0.0);
                vec2 offset = vec2(0.0);
                vec2 vogelSample = vec2(0.0);
                for (int i = 0; i < NUM_SAMPLES; i++) {
                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;
                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20
                    uv = U + offset;
                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));
                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
                    res += textureLod(sp, uv, lod).rgb;
                }
                return res / float(NUM_SAMPLES);
            }`),e=new ot(`vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        
				// Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		        // The thickness is specified in local space
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),i=new ot(`float applyIorToRoughness( float roughness, float ior ) {
				// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
				// an IOR of 1.5 results in the default amount of microfacet refraction.
				return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
			}`),n=new ot(`vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
				// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see
				// also the code in convertTransmission.ts, which runs during export
				#ifdef IS_THREEJS_EXPORT
					float lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);
					return textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;
				#else
					float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
					float lod = applyIorToRoughness(roughness, ior);
					return blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
				#endif
			}`,[l4e.textureBicubic,i,t]),r=new ot(`vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;

				// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
				vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;

				vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
				vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
				unrefractedCoords += 1.0;
				unrefractedCoords /= 2.0;

				// Sample framebuffer to get pixel the refracted ray hits.
				return getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
    		}`,[n,e]);return{transmission:new ot(`vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return transmission;
            }`,[r])}}();var XO=(t=>(t.NOISE="noise",t.MAP="map",t))(XO||{}),wne=class extends Wi{constructor(t,e,i,n,r,s,o,a,l,c,h){super("v3"),this.displacementTypeIndex=new qi(0),this.nodeType="VertexDisplacement",this.intensity=t,this.movementOrTexture=e,Object.values(XO)[this.displacementTypeIndex.value]==="map"&&(this.mat=new ine(this.movementOrTexture.value.matrix)),this.cropOrOffset=i,this.scale=c,this.noiseFunctionIndex=h,this.voronoiStyle=n,this.smoothness=r,this.seed=s,this.highCut=o,this.lowCut=a,this.quality=l}generate(t,e){if(t.isShader("vertex")){t.define("USE_LAYER_DISPLACE");let i,n=[];switch(n.push("displaced_position"),n.push("displaced_normal"),Object.values(XO)[this.displacementTypeIndex.value]){case"map":{i=t.include(wne.Nodes.map),n.push(this.movementOrTexture.getTexture(t,"t")),n.push("uv"),n.push(this.cropOrOffset.build(t,"f")),this.mat&&n.push(this.mat.build(t,"mat3"));break}case"noise":{let r=Object.values(hz)[this.noiseFunctionIndex.value],s=new ot(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),o=r=="voronoi"?`
					float v = ${r}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);
					v = remap(v, lowCut, highCut, 0.0, 1.0);
					v = smax(v, 0.0, smoothness * 0.25);
					v = smin(v, 1.0, smoothness * 0.25);

					return p + n * v * intensity;
					`:`
					return p + n * ${r}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
					`,a=new ot(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {
							${o}
						}`,[io.simplex,io.simplexFractal,io.simplexAshima,io.fbm,io.perlin,io.voronoi]),l=new ot(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[a,s]);i=t.include(l),n.push(this.scale.build(t,"f")),n.push(this.cropOrOffset.build(t,"v3")),n.push(this.movementOrTexture.build(t,"f")),n.push(this.voronoiStyle.build(t,"i")),n.push(this.smoothness.build(t,"f")),n.push(this.seed.build(t,"f")),n.push(this.highCut.build(t,"f")),n.push(this.lowCut.build(t,"f")),n.push(this.quality.build(t,"i"));break}}return n.push(this.intensity.build(t,"f")),n.push("displaced_normal"),t.format(i+"("+n.join(",")+")",this.getType(t),e)}else return console.warn("VertexDisplacementNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},bne=wne;bne.Nodes=function(){let t=new ot(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),e=new ot(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new ot(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[t,e])}}();var Rt={normalRenderTarget:new Vu,normalRenderTargetDepth:new Vu,transmissionRenderTarget:new Vu,aspectRatio:new Qr,transmissionSize:new Qr(2048,2048),transmissionRenderTargetDepth:new Vu,aoRenderTarget:new Vu,aoEnabled:new zs,pixelRatioNode:new pt(1),resolution:new Qr,penumbraSize:new np(5,.5),frameIndex:new qi(0),transmissionLod:new qi(2)};for(let t of Object.values(Rt))t.isRenderGlobal=!0;var Sne=class extends pf{constructor(){super("basic"),this.nodeType="Basic",this.color=new Un(tl),this.shadingAlpha=new pt(1),this.shadingBlend=new qi(0),this.previousModelViewMatrix=new Zc,this.previouseProjectionMatrix=new Zc}get category(){return"phong"}generate(t){let e;if(t.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:Rt.frameIndex}),t.mergeUniform({resolution:Rt.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(cy.merge([st.fog])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>"].join(`
`));let n=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),n.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=n.join(`
`)}else{this.color===void 0&&(this.color=new Un(tl)),this.color.analyze(t,{slot:"color"}),this.alpha&&this.alpha.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"});let i=this.color.flow(t,"c",{slot:"color"}),n=this.alpha?this.alpha.flow(t,"f"):void 0,r=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0,s=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0;t.requires.transparent=n!==void 0,t.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let o=["#include <normal_fragment_begin>",i.code];n&&o.push(n.code,"#ifdef ALPHATEST"," if ( "+n.result+" <= ALPHATEST ) discard;","#endif"),s?o.push(s.code,`vec3 outgoingLight = ${i.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${s.result}, 1.0, SPE_BLENDING_NORMAL);`):o.push(`vec3 finalColor = ${i.result};`);let a="1.0";this.mask&&(this.mask.analyze(t),a=`luminance(${this.mask.flow(t,"v3").result})`),n?o.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${n.result} * ${a} );`):o.push("gl_FragColor = vec4("+i.result+", 1.0 );"),r&&o.push(`gl_FragColor.a *= ${r.result};`),o.push("#include <fog_fragment>","#include <dithering_fragment>"),e=o.join(`
`)}return e}},u4e=class extends pf{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new Un(tl),this.emissive=new Un(0),this.emissiveIntensity=new pt(1),this.previousModelViewMatrix=new Zc,this.previouseProjectionMatrix=new Zc,this.shadingAlpha=new pt(1),this.shadingBlend=new qi(0),this.occlusion=new zs(!0)}get category(){return"lambert"}build(t){let e;if(t.define("LAMBERT"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:Rt.frameIndex}),t.mergeUniform({resolution:Rt.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(cy.merge([st.fog,st.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let n=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
				`),n.push(`
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=n.join(`
`)}else{t.mergeUniform({penumbraSize:Rt.penumbraSize}),t.mergeUniform({frameIndex:Rt.frameIndex}),t.mergeUniform({aoMap:Rt.aoRenderTarget}),t.mergeUniform({aoEnabled:Rt.aoEnabled}),this.color===void 0&&(this.color=new Un(tl)),this.color.analyze(t,{slot:"color"}),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let i=this.color.flow(t,"c",{slot:"color"}),n=this.emissive.flow(t,"c",{slot:"emissive"}),r=this.emissiveIntensity.flow(t,"f",{slot:"emissive"}),s=this.occlusion.flow(t,"b",{slot:"occlusion"}),o=this.shadingAlpha.flow(t,"f"),a=this.shadingBlend.flow(t,"i"),l=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(t,"f"):void 0,h=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0;t.requires.transparent=c!==void 0,t.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let u=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];u.push(i.code,"vec3 diffuseColor = "+i.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),c&&u.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),u.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),n&&u.push(n.code,"reflectedLight.directDiffuse += "+n.result+" * "+r.result+";"),u.push("vec3 ao = aoEnabled && "+s.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let d="1.0";this.mask&&(this.mask.analyze(t),d=`luminance(${this.mask.flow(t,"v3").result})`),u.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${d} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${d}, ${a.result} );

					outgoingLight *= ao;
				}
				`),l&&u.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result} );`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h&&u.push(`gl_FragColor.a *= ${h.result};`),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=u.join(`
`)}return e}},Q0=function(){let t=new ot(`vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {

            // Gradient of UVs w.r.t. X coordinate (in screen-space)
            vec2 dSTdx = dFdx(bumpMapUv);

            // Gradient of UVs w.r.t. Y coordinate (in screen-space)
            vec2 dSTdy = dFdy(bumpMapUv);
            
            // Forward differencing
            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);
            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;
            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;
            
            return vec2( dBx, dBy );
        }`),e=new ot(`vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
            vec3 vSigmaX = dFdx( surf_pos.xyz );
            vec3 vSigmaY = dFdy( surf_pos.xyz );
            vec3 vN = surf_norm; // normalized
            
            vN = normalize(vN);

            vec3 R1 = cross( vSigmaY, vN );
            vec3 R2 = cross( vN, vSigmaX );

            R1 = normalize(R1);
            R2 = normalize(R2);
    
            float fDet = dot( vSigmaX, R1 ) * faceDirection;
    
            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
            return normalize( abs( fDet ) * vN - vGrad );
        }`);return{dHdxy:t,perturbNormalArb:e}}(),h4e=class extends pf{constructor(){super("phong"),this.nodeType="Phong",this.color=new Un(tl),this.specular=new Un(1118481),this.shininess=new pt(30),this.previousModelViewMatrix=new Zc,this.previouseProjectionMatrix=new Zc,this.shadingAlpha=new pt(1),this.shadingBlend=new qi(0),this.occlusion=new zs(!0)}get category(){return"phong"}build(t){let e;if(t.define("PHONG"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:Rt.frameIndex}),t.mergeUniform({resolution:Rt.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(cy.merge([st.fog,st.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let n=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif


				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=n.join(`
`)}else{t.mergeUniform({penumbraSize:Rt.penumbraSize}),t.mergeUniform({frameIndex:Rt.frameIndex}),t.mergeUniform({aoMap:Rt.aoRenderTarget}),t.mergeUniform({aoEnabled:Rt.aoEnabled}),this.color===void 0&&(this.color=new Un(tl)),this.color.analyze(t,{slot:"color"}),this.specular.analyze(t),this.shininess.analyze(t);let i=this.occlusion.flow(t,"b",{slot:"occlusion"});this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let n=this.color.flow(t,"c",{slot:"color"}),r=this.specular.flow(t,"c"),s=this.shininess.flow(t,"f"),o=this.shadingAlpha.flow(t,"f"),a=this.shadingBlend.flow(t,"i"),l=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(t,"f"):void 0,h=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0;t.requires.transparent=c!==void 0,t.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let u=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];if(this.bumpMap){t.include(Q0.dHdxy),t.include(Q0.perturbNormalArb);let f=this.bumpMap.texture.flow(t,"t"),p=this.bumpMap.flow(t,"v3"),m=this.bumpMapIntensity?this.bumpMapIntensity.flow(t,"f").result:"1.0",v="";this.bumpMap.projection.value===4?v=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${f.result}, uv0, ${m});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${f.result}, uv1, ${m});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${f.result}, uv2, ${m});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:v=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${f.result}, bumpMapCachedUv, ${m});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,u.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${p.result};
					${v}
					`)}u.push(n.code,"	vec3 diffuseColor = "+n.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",r.code,"	vec3 specular = "+r.result+";",s.code,"	float shininess = max( 0.0001, "+s.result+" );","	float specularStrength = 1.0;"),c&&u.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),u.push("material.diffuseColor = diffuseColor;"),u.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),u.push("vec3 ao = aoEnabled && "+i.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let d="1.0";this.mask&&(this.mask.analyze(t),d=`luminance(${this.mask.flow(t,"v3").result})`),u.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${d} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${d}, ${a.result} );
					
					outgoingLight *= ao;
				}
				`),l&&u.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result});`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h&&u.push(`gl_FragColor.a *= ${h.result};`),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=u.join(`
`)}return e}},d4e=class extends pf{constructor(){super("standard"),this.nodeType="Standard",this.color=new Un(tl),this.roughness=new pt(.3),this.metalness=new pt(0),this.reflectivity=new pt(.5),this.previousModelViewMatrix=new Zc,this.previouseProjectionMatrix=new Zc,this.shadingAlpha=new pt(1),this.shadingBlend=new qi(0),this.occlusion=new zs(!0)}get category(){return"physical"}build(t){let e;if(t.define("STANDARD"),t.requires.lights=!0,t.extensions.derivatives=!0,t.extensions.shaderTextureLOD=!0,t.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:Rt.frameIndex}),t.mergeUniform({resolution:Rt.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(cy.merge([st.fog,st.lights])),st.LTC_1&&(t.uniforms.ltc_1={value:void 0},t.uniforms.ltc_2={value:void 0}),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let n=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=n.join(`
`)}else{t.mergeUniform({penumbraSize:Rt.penumbraSize}),t.mergeUniform({frameIndex:Rt.frameIndex}),t.mergeUniform({aoMap:Rt.aoRenderTarget}),t.mergeUniform({aoEnabled:Rt.aoEnabled});let i={gamma:!0};this.color===void 0&&(this.color=new Un(tl)),this.color.analyze(t,{slot:"color",context:i}),this.roughness.analyze(t),this.metalness.analyze(t);let n=this.occlusion.flow(t,"b",{slot:"occlusion"});this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t),this.reflectivity&&this.reflectivity.analyze(t);let r=this.color.flow(t,"c",{slot:"color",context:i}),s=this.roughness.flow(t,"f"),o=this.metalness.flow(t,"f"),a=this.shadingAlpha.flow(t,"f"),l=this.shadingBlend.flow(t,"i"),c=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,h=this.alpha?this.alpha.flow(t,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0,d=this.reflectivity?this.reflectivity.flow(t,"f"):void 0;t.requires.transparent=h!==void 0,t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let f=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){t.include(Q0.dHdxy),t.include(Q0.perturbNormalArb);let m=this.bumpMap.texture.flow(t,"t"),v=this.bumpMap.flow(t,"v3"),g=this.bumpMapIntensity?this.bumpMapIntensity.flow(t,"f").result:"1.0",y="";this.bumpMap.projection.value===4?y=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${m.result}, uv0, ${g});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${m.result}, uv1, ${g});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${m.result}, uv2, ${g});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:y=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${m.result}, bumpMapCachedUv, ${g});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,f.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${v.result};
					${y}
					`)}if(f.push(r.code,"	vec3 diffuseColor = "+r.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",o.code,"	float metalnessFactor = "+o.result+";"),this.roughnessMap){let m=this.roughnessMap.texture.flow(t,"t"),v=this.roughnessMap.flow(t,"v3"),g="";this.roughnessMap.projection.value===4?g=`
					float roughnessChange = 1.0;
					{
						vec2 uv0 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						float r0 = luminance(texture(${m.result}, uv0).rgb) * roughnessScale;
						float r1 = luminance(texture(${m.result}, uv1).rgb) * roughnessScale;
						float r2 = luminance(texture(${m.result}, uv2).rgb) * roughnessScale;

						roughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);
					}
					float roughnessFactor = roughnessChange * ${s.result};
					`:g=`
					vec2 roughnessMapCachedUv = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs;

					vec4 vals = texture(${m.result},  roughnessMapCachedUv);
					float roughnessFactor = luminance(vals.rgb) * ${s.result};
					`,f.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${v.result};

					const float roughnessScale = 1.0;

					${g}
				`)}else f.push(s.code,"	float roughnessFactor = "+s.result+";");h&&f.push(h.code,"#ifdef ALPHATEST","	if ( "+h.result+" <= ALPHATEST ) discard;","#endif"),f.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),f.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),d?f.push(d.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+d.result+" ) ), diffuseColor, metalnessFactor );"):f.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),f.push("#include <lights_fragment_begin>"),f.push("#include <lights_fragment_end>"),f.push("vec3 ao = aoEnabled && "+n.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let p="1.0";this.mask&&(this.mask.analyze(t),p=`luminance(${this.mask.flow(t,"v3").result})`),f.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${p} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${p}, ${l.result} );
					
					outgoingLight *= ao;
				}
				`),c&&f.push(c.code,`outgoingLight = spe_blend(outgoingLight, ${c.result}, 1.0, SPE_BLENDING_NORMAL);`),h?f.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${h.result} );`):f.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&f.push(`gl_FragColor.a *= ${u.result};`),f.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=f.join(`
`)}return e}},f4e=class extends pf{constructor(){super("toon"),this.nodeType="Toon",this.color=new Un(tl),this.specular=new Un(1118481),this.shininess=new pt(30),this.previousModelViewMatrix=new Zc,this.previouseProjectionMatrix=new Zc,this.shadingAlpha=new pt(1),this.shadingBlend=new qi(0)}get category(){return"toon"}build(t){let e;if(t.define("TOON"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:Rt.frameIndex}),t.mergeUniform({resolution:Rt.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(cy.merge([st.fog,st.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let n=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=n.join(`
`)}else{t.mergeUniform({penumbraSize:Rt.penumbraSize}),t.mergeUniform({frameIndex:Rt.frameIndex}),t.mergeUniform({aoMap:Rt.aoRenderTarget}),t.mergeUniform({aoEnabled:Rt.aoEnabled}),this.color===void 0&&(this.color=new Un(tl)),this.color.analyze(t,{slot:"color"}),this.specular.analyze(t),this.shininess.analyze(t),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let i=this.color.flow(t,"c",{slot:"color"}),n=this.specular.flow(t,"c"),r=this.shininess.flow(t,"f"),s=this.shadingAlpha.flow(t,"f"),o=this.shadingBlend.flow(t,"i"),a=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(t,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0;t.requires.transparent=l!==void 0,t.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let h=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];if(this.bumpMap){t.include(Q0.dHdxy),t.include(Q0.perturbNormalArb);let d=this.bumpMap.texture.flow(t,"t"),f=this.bumpMap.flow(t,"v3"),p=this.bumpMapIntensity?this.bumpMapIntensity.flow(t,"f").result:"1.0",m="";this.bumpMap.projection.value===4?m=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${d.result}, uv0, ${p});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${d.result}, uv1, ${p});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${d.result}, uv2, ${p});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:m=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${d.result}, bumpMapCachedUv, ${p});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,h.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${f.result};
					${m}
					`)}h.push(i.code,"	vec3 diffuseColor = "+i.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",n.code,"	vec3 specular = "+n.result+";",r.code,"	float shininess = max( 0.0001, "+r.result+" );","	float specularStrength = 1.0;"),l&&h.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),h.push("material.diffuseColor = diffuseColor;"),h.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),h.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let u="1.0";this.mask&&(this.mask.analyze(t),u=`luminance(${this.mask.flow(t,"v3").result})`),h.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * ${u} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result} * ${u}, ${o.result} );
				}
				`),a&&h.push(a.code,`outgoingLight = spe_blend(outgoingLight, ${a.result}, 1.0, SPE_BLENDING_NORMAL);`),l?h.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&h.push(`gl_FragColor.a *= ${c.result};`),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=h.join(`
`)}return e}},p4e=class{constructor(t=1e3*10){this.timeout=t,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...t){}remove(t){let e=this.cache.get(t);e&&(this.dispose(t,e.data),this.cache.delete(t),e.prev.next=e.next,e.next.prev=e.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let t=Date.now(),e=this.head.next;for(;e.time<t-this.timeout;)this.dispose(e.src,e.data),this.cache.delete(e.src),e=e.next,e.prev=this.head,this.head.next=e;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(t){var e;return(e=this.cache.get(t))==null?void 0:e.data}load(t){let e=Date.now(),i=this.cache.get(t);return i===void 0?(i={data:this.create(t),src:t,time:e,next:null,prev:null},this.cache.set(t,i)):(i.time=e,i.prev.next=i.next,i.next.prev=i.prev),i.prev=this.tail.prev,i.next=this.tail,this.tail.prev.next=i,this.tail.prev=i,this.scheduleCleanup(),i.data}},m4e=class extends p4e{create(t){return URL.createObjectURL(new Blob([t]))}dispose(t,e){URL.revokeObjectURL(e)}},L3;function g4e(t){return typeof t=="string"?t:(L3||(L3=new m4e),L3.load(t))}var v4e=class{constructor(t,e){this.data=t,this.cache=e,this.refCount=0}deref(){this.refCount,this.refCount-=1,this.refCount===0&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount}},y4e=class{constructor(){this.cache=new Map}remove(t){this.cache.delete(t.data)}load(t){let e=this.cache.get(t);return e===void 0&&(e=this.create(t),this.cache.set(t,e)),e.refCount+=1,e}},Ane=class extends v4e{constructor(t,e){super(t,e.imageHolderCache),this.data=t,this.shared=e,this.loaded=!1,this.isVideo=!1,this.isVideo=t.type==="video",this.updateSrc(t.data)}async updateSrc(t){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let e=()=>{this.loaded=!0;let n=[1e3,1001,1002];for(let r of n){let s=this[r];s&&(s.image=this.img,s.needsUpdate=!0)}this.shared.requestRender()};if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,typeof t!="string"){var i=new FileReader;i.readAsDataURL(new Blob([t],{type:"video/mp4"}));let n;await new Promise(r=>{i.onloadend=s=>{var o;n=(o=s.target)==null?void 0:o.result,r(null)}}),this.img.src=n}else this.img.src=t;this.img.onloadeddata=()=>{e()}}else this.img=new Image,this.img.src=g4e(t),this.img.onload=e}getTexture(t){let e=this[t];if(e)return e;{let i;return this.isVideo?i=new U2e(this.img,void 0,t,t):i=new br(this.img,void 0,t,t),this.loaded&&(i.needsUpdate=!0),this[t]=i,i}}disposeTextures(){var t,e,i;(t=this[1e3])==null||t.dispose(),this[1e3]=void 0,(e=this[1001])==null||e.dispose(),this[1001]=void 0,(i=this[1002])==null||i.dispose(),this[1002]=void 0}dispose(){super.dispose(),this.disposeTextures()}},Ep=class extends Ane{};function Gs(t,e){return e.color(t)}function x4e(t,e){switch(t.type){case"fresnel":return b4e(t,e);case"gradient":return S4e(t);case"depth":return A4e(t);case"normal":return M4e(t);case"noise":return E4e(t,e);case"rainbow":return T4e(t);case"toon":return C4e(t,e);case"outline":return P4e(t,e);case"transmission":return D4e(t);case"color":return w4e(t,e);case"pattern":return R4e(t,e)}}function _4e(t){return{type:t.type}}function Ql(t){let{alpha:e,mode:i,isMask:n}=t;return{..._4e(t),alpha:e,mode:i,isMask:n}}function w4e(t,e){return{...Ql(t),color:Gs(t.color,e)}}function b4e(t,e){let{bias:i,scale:n,intensity:r,factor:s,color:o,isMask:a}=t;return{...Ql(t),color:Gs(o,e),bias:i,scale:n,intensity:r,factor:s}}function S4e(t){let{gradientType:e,smooth:i,colors:n,steps:r,angle:s,offset:o,morph:a}=t;return{...Ql(t),gradientType:e,smooth:i,colors:n.map(l=>new Kt(l[0],l[1],l[2],l[3])),num:n.length,steps:r,offset:new he(...o),morph:new he(...a),angle:s}}function A4e(t){let{gradientType:e,near:i,far:n,isVector:r,isWorldSpace:s,origin:o,direction:a,colors:l,steps:c,smooth:h}=t;return{...Ql(t),gradientType:e,near:i,far:n,isVector:r,isWorldSpace:s,origin:new L(...o),direction:a?new L(...a):new L(1,0,0),colors:l.map(u=>u!==void 0?new Kt(u[0],u[1],u[2],u[3]):new Kt(0,0,0,0)),steps:c.slice(0,l.length),smooth:h}}function M4e(t){let{cnormal:e}=t;return{...Ql(t),cnormal:new L(e[0],e[1],e[2])}}function E4e(t,e){return{...Ql(t),scale:t.scale,move:t.move,fA:new he(...t.fA),fB:new he(...t.fB),size:new L(...t.size),distortion:new he(...t.distortion),colorA:Gs(t.colorA,e),colorB:Gs(t.colorB,e),colorC:Gs(t.colorC,e),colorD:Gs(t.colorD,e),noiseType:t.noiseType,voronoiStyle:t.voronoiStyle,highCut:t.highCut,lowCut:t.lowCut,smoothness:t.smoothness,seed:t.seed,quality:t.quality}}function T4e(t){return{...Ql(t),filmThickness:t.filmThickness,movement:t.movement,wavelengths:new L(...t.wavelengths),noiseStrength:t.noiseStrength,noiseScale:t.noiseScale,offset:new L(...t.offset)}}function C4e(t,e){return{...Ql(t),positioning:t.positioning,colors:t.colors.map(i=>new Kt(i[0],i[1],i[2],i[3])),num:t.colors.length,steps:t.steps,source:new L(...t.source),isWorldSpace:t.isWorldSpace,noiseStrength:t.noiseStrength,noiseScale:t.noiseScale,shadowColor:Gs(t.shadowColor,e),offset:new L(...t.offset)}}function P4e(t,e){return{...Ql(t),outlineColor:Gs(t.outlineColor,e),contourColor:Gs(t.contourColor,e),outlineWidth:t.outlineWidth,contourWidth:t.contourWidth,outlineThreshold:t.outlineThreshold,contourThreshold:t.contourThreshold,outlineSmoothing:t.outlineSmoothing,contourFrequency:t.contourFrequency,contourDirection:new L(...t.contourDirection),positionalLines:t.positionalLines,compensation:t.compensation}}function D4e(t,e){return{...Ql(t),thickness:t.thickness,ior:t.ior,roughness:t.roughness}}function R4e(t,e){return{...Ql(t),style:t.style,projection:t.projection,axis:t.axis,blending:t.blending,offset:new he(...t.offset),colorA:Gs(t.colorA,e),colorB:Gs(t.colorB,e),frequency:new he(...t.frequency),size:t.size,variation:t.variation,smoothness:t.smoothness,zigzag:t.zigzag,rotation:t.rotation,vertical:new he(...t.vertical),horizontal:new he(...t.horizontal),sides:t.sides}}var FT=class extends wo{},Mne={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},Ene={depth:["colors"]};function I4e(t,e,i){var s,o;if(e==="isMask")return!0;let n=Mne[t.type],r=Ene[t.type];if(r!==void 0){let a=t.color;if(r.includes(e)){let l=(o=(s=a[e])==null?void 0:s.value)==null?void 0:o.length;if(l!==void 0&&l!==i.length)return!0}}return n!==void 0?n.includes(e):!1}function Tne(t,e,i){let n=i.uniforms[`f${i.id}_texture`];if(!n)return!1;let r=!1,s=t;if("image"in s){let o=s.image,a=e.image(o),l=n;l.image instanceof Ep||l.image.deref(),l.image=a}if("video"in s){let o=s.video,a=e.video(o),l=n;l.image instanceof Ep||l.image.deref(),l.image=a}if("wrapping"in s){let o=n;o.wrap=s.wrapping}if("repeat"in s||"offset"in s){let o="mat",a=i.uniforms[`f${i.id}_${o}`];"repeat"in s&&(a.repeat=s.repeat),"offset"in s&&(a.offset=s.offset),a.updateMatrix()}return r}function L4e(t,e,i,n){let r=!1;for(let[s,o]of Object.entries(t)){if(s==="bumpMap"||s==="roughnessMap"){r=!0;continue}if(!s||o===void 0)continue;if(Pne(s,i,n)){s==="visible"&&i.type==="light"&&(r=!0);continue}i.visible=n.visible;let a=i.uniforms[`f${i.id}_${s}`];if(a&&!(a instanceof cz))switch(r=r||I4e(i,s,o),a.constructor){case Un:if(typeof o=="string"){let l=e.getColor(o);l&&(a.value=l);break}else{let l=o;a.value instanceof FT?a.value=new wo(l.r,l.g,l.b,l.a):a.setRGBA(l);break}case Fu:if(typeof o=="string"){let l=e.getColor(o);l&&(a.value=l);break}else{let l=o;a.value instanceof FT?a.value=new wo(l.r,l.g,l.b,l.a):a.value.setRGBA(l.r,l.g,l.b,l.a);break}case Qr:{let l=o;a.value.setX(l[0]),a.value.setY(l[1]);break}case Da:{let l=o;a.value.setX(l[0]),a.value.setY(l[1]),a.value.setZ(l[2]);break}case Vu:{Tne(o,e,i);break}case rp:{a.value=o.map(l=>new Kt(...l));break}default:{a.value=o;break}}}return r}var Yp=class{constructor(t,e,i,n){this.id=t,this.uuid=e,this.data=i,this.uniforms={};for(let r in n)this.uniforms[`f${this.id}_${r}`]=n[r];for(let r in i)Pne(r,this,i)}get type(){return this.data.type}static create(t,e,i,n){if(i.type==="light")return Nu.createLigherLayer(t,e,i,n);if(i.type==="texture"||i.type==="video"){let r=i.type==="texture"?n.image(i.texture.image):n.video(i.texture.video),s=new jO(r,i.texture.wrapping),o=new s4e(r),a=new o4e(i.texture.repeat,i.texture.offset),l=new pt(i.crop?1:0),c=new qi(i.projection??0),h=new qi(["x","y","z"].indexOf(i.axis)??0),u=new qi(i.side??0),d=new Qr(i.size?new he(i.size[0],i.size[1]):new he(100,100)),f=new pt(i.blending??0),p=new pt(i.alpha??1),m=new qi(i.mode??0),v=new zs(i.isMask??!1),g=new uz(s,o,l,c,h,u,d,f,a,p,m,v),y=new tn(g.calpha,"f");return new Rn(t,e,i,{texture:s,textureSize:o,crop:l,projection:c,axis:h,side:u,size:d,blending:f,mat:a,alpha:p,mode:m,isMask:v},g,m,y,v)}else if(i.type==="matcap"){let r=n.image(i.texture.image),s=new jO(r,i.texture.wrapping),o=new pt(i.alpha??1),a=new qi(i.mode??0),l=new zs(i.isMask??!1),c=new une(s,o,a,l),h=new tn(c.calpha,"f");return new Rn(t,e,i,{texture:s,alpha:o,mode:a,isMask:l},c,a,h,l)}else if(i.type==="displace")if(i.displacementType==="noise"){let r=new Da(new L(...i.offset)),s=new pt(i.scale??10),o=new pt(i.intensity??8),a=new pt(i.movement??1),l=new qi(i.noiseType??0),c=new qi(i.voronoiStyle??0),h=new pt(i.smoothness??.5),u=new pt(i.seed??0),d=new pt(i.highCut??1),f=new pt(i.lowCut??0),p=new qi(i.quality??1),m=new bne(o,a,r,c,h,u,d,f,p,s,l);return new Cne(t,e,i,{offset:r,scale:s,intensity:o,movement:a,noiseType:l,voronoiStyle:c,smoothness:h,seed:u,highCut:d,lowCut:f,quality:p},m)}else throw new Error;else return F4e(t,e,i,n)}updateByOp(t,e,i){let n=t;if(n.path[0]===void 0){if(n.type===0)return"type"in n.props||"category"in n.props||"visible"in n.props?(i.scene.markNeedsUpdateRendererDirty(),!0):L4e(n.props,i.shared,this,e)}else if(n.path[0]==="texture")return"texture"in e||"video"in e?Tne(n.props,i.shared,this):!0;return!1}dispose(){if(B4e(this)){let t=this.uniforms[`f${this.id}_texture`];if(!t)return!1;let e=t;e.image instanceof Ep||e.image.deref()}}hasValueByKey(t){return this.uniforms[t]!==void 0}hasValue(t){return this.hasValueByKey(`f${this.id}_${t}`)}setValue(t,e){let i=`f${this.id}_${t}`;this.hasValueByKey(i)&&e!==void 0&&(this.uniforms[i].value=e)}getNode(t){let e=`f${this.id}_${t}`;if(this.hasValueByKey(e))return this.uniforms[e]}getValue(t){let e=`f${this.id}_${t}`;if(this.hasValueByKey(e))return this.uniforms[e].value}getName(t){let e=/f\d+_(.*)/.exec(t);if(e&&e.length>1)return e[1];console.log(`Layer.getName: error ${t}`)}getNames(){let t=[];for(let e in this.uniforms){let i=this.getName(e);i&&t.push(i)}return t}},Rn=class extends Yp{constructor(t,e,i,n,r,s,o,a){super(t,e,i,n),this.params=n,this.color=r,this.mode=s,this.alpha=o,this.isMask=a}},Cne=class extends Yp{constructor(t,e,i,n,r){super(t,e,i,n),this.position=r}},Nu=class extends Yp{constructor(t,e,i,n,r){super(t,e,i,r),this.node=n}static createLigherLayer(t,e,i,n){let r,s=new pt(i.alpha),o=new qi(i.mode),a=new pt(i.bumpMapIntensity),l=new pt(i.alphaOverride),c;if(!i.visible)r=new Sne,c={};else if(i.category==="lambert"){r=new u4e;let h=new Un(n.color(i.emissive)??0),u=new zs(i.occlusion??!0);c={emissive:h,occlusion:u},r.emissive=h,r.occlusion=u}else if(i.category==="toon"){r=new f4e;let h=new pt(i.shininess??30),u=new Un(n.color(i.specular)??1118481);c={shininess:h,specular:u},r.shininess=h,r.specular=u}else if(i.category==="physical"){r=new d4e;let h=new pt(i.roughness??.3),u=new pt(i.metalness??0),d=new pt(i.reflectivity??.5),f=new zs(i.occlusion??!0);c={roughness:h,metalness:u,reflectivity:d,occlusion:f},r.roughness=h,r.metalness=u,r.reflectivity=d,r.occlusion=f}else{r=new h4e;let h=new pt(i.shininess??30),u=new Un(i.specular!==void 0?n.color(i.specular)??1118481:1118481),d=new zs(i.occlusion??!0);c={shininess:h,specular:u,occlusion:d},r.shininess=h,r.specular=u,r.occlusion=d}return r.alpha=new pt(1),r.shadingAlpha=s,r.shadingBlend=o,r.bumpMapIntensity=a,r.alphaOverride=l,c.alpha=r.shadingAlpha,c.mode=r.shadingBlend,c.bumpMapIntensity=r.bumpMapIntensity,c.alphaOverride=r.alphaOverride,new Nu(t,e,i,r,c)}get category(){return this.node.category}};function B4e(t){let e=t instanceof Yp?t.type:t;return e==="texture"||e==="video"||e==="displace_map"||e==="matcap"}function ba(t){return{alpha:new pt(t.alpha??1),mode:new qi(t.mode??0),isMask:new zs(t.isMask??!1)}}function O4e(t,e,i,n){switch(t.type){case"color":{let r=new Un(n.color??tl),s=ba(n),o=new WO(r,s.alpha),a=new tn(o.calpha,"f");return new Rn(e,i,t,{color:r,...s},o,s.mode,a,s.isMask)}case"fresnel":{let r=new Un(n.color??16777215),s=new pt(n.bias??.1),o=new pt(n.scale??1),a=new pt(n.intensity??2),l=new pt(n.factor??1),c=ba(n),h=new a4e(r,s,o,a,l,c.alpha,c.mode,c.isMask),u=new tn(h.calpha,"f");return new Rn(e,i,t,{color:r,bias:s,scale:o,intensity:a,factor:l,...c},h,c.mode,u,c.isMask)}case"rainbow":{let r=new pt(n.filmThickness??30),s=new pt(n.movement??0),o=new Da(n.wavelengths??new L(0,0,0)),a=new pt(n.noiseStrength??0),l=new pt(n.noiseScale??1),c=new Da(n.offset??new L(0,0,0)),h=ba(n),u=new gne(r,s,o,a,l,c,h.alpha,h.isMask),d=new tn(u.calpha,"f");return new Rn(e,i,t,{filmThickness:r,movement:s,wavelengths:o,noiseStrength:a,noiseScale:l,offset:c,...h},u,h.mode,d,h.isMask)}case"transmission":{let r=new pt(n.thickness??10),s=new pt(n.ior??1.5),o=new pt(n.roughness??.5),a=Rt.transmissionSize,l=Rt.transmissionRenderTarget,c=Rt.transmissionRenderTargetDepth,h=window.innerWidth,u=window.innerHeight,d=h>=u?new Qr(u/h,1):new Qr(1,h/u),f=ba(n),p=new _ne(r,s,o,a,l,c,d,f.alpha),m=new tn(p.calpha,"f");return new Rn(e,i,t,{thickness:r,ior:s,roughness:o,aspectRatio:d,...f},p,f.mode,m,f.isMask)}case"toon":{let r=new qi(n.positioning??0),s;n.colors?s=new rp(n.colors.length,n.colors):(s=new rp(10,new Kt(0,0,0,1)),s.value[1]=new Kt(1,1,1,1));let o;n.steps?o=new np(n.steps.length,n.steps):(o=new np(10,1),o.value[0]=0);let a=new Da(n.source??new L(0,0,0)),l=new zs(n.isWorldSpace??!0),c=new pt(n.noiseStrength??0),h=new pt(n.noiseScale??1),u=new Fu(n.shadowColor),d=new Da(n.offset??new L(0,0,0)),f=ba(n),p=new yne(r,s,o,a,l,c,h,u,d,f.alpha),m=new tn(p.calpha,"f");return new Rn(e,i,t,{positioning:r,colors:s,steps:o,source:a,isWorldSpace:l,noiseStrength:c,noiseScale:h,shadowColor:u,offset:d,...f},p,f.mode,m,f.isMask)}case"outline":{let r=new Un(n.outlineColor??16777215),s=new Un(n.contourColor??16777215),o=new pt(n.outlineWidth??.1),a=new pt(n.contourWidth??.1),l=new pt(n.outlineThreshold??.1),c=new pt(n.contourThreshold??.1),h=new pt(n.outlineSmoothing??.1),u=new pt(n.contourFrequency??.1),d=new Da(n.contourDirection??new L(0,1,0)),f=new zs(n.positionalLines??!1),p=new zs(n.compensation??!0),m=Rt.normalRenderTarget,v=Rt.normalRenderTargetDepth,g=Rt.pixelRatioNode,y=Rt.resolution,x=ba(n),b=new fne(r,s,o,a,l,c,h,u,d,f,p,y,m,v,g,x.alpha),S=new tn(b.calpha,"f");return new Rn(e,i,t,{outlineColor:r,contourColor:s,outlineWidth:o,contourWidth:a,outlineThreshold:l,contourThreshold:c,outlineSmoothing:h,contourFrequency:u,contourDirection:d,positionalLines:f,compensation:p,...x},b,x.mode,S,x.isMask)}case"depth":{let r=new qi(n.gradientType??0),s=new zs(n.smooth??!1),o=new pt(n.near??50),a=new pt(n.far??200),l=new pt(n.isVector??1),c=new pt(n.isWorldSpace??0),h=new Da(n.origin??new L),u=new Da(n.direction??new L),d;n.colors?d=new rp(n.colors.length,n.colors):(d=new rp(2,new Kt(0,0,0,1)),d.value[1]=new Kt(1,1,1,1));let f;n.steps?f=new np(n.steps.length,n.steps):(f=new np(2,1),f.value[0]=0);let p=ba(n),m=new one(r,s,o,a,l,c,h,u,d,f,p.alpha,p.isMask),v=new tn(m.calpha,"f");return new Rn(e,i,t,{gradientType:r,smooth:s,near:o,far:a,isVector:l,isWorldSpace:c,origin:h,direction:u,colors:d,steps:f,...p},m,p.mode,v,p.isMask)}case"noise":{let r=new pt(n.scale??1),s=new Da(n.size??new L(100,100,100)),o=new pt(n.move??1),a=new Qr(n.fA??new he(1.7,9.2)),l=new Qr(n.fB??new he(8.3,2.8)),c=new Qr(n.distortion??new he(1,1)),h=new Fu(n.colorA),u=new Fu(n.colorB),d=new Fu(n.colorC),f=new Fu(n.colorD),p=new qi(n.noiseType??0),m=new qi(n.voronoiStyle??0),v=new pt(n.highCut??1),g=new pt(n.lowCut??0),y=new pt(n.smoothness??.5),x=new pt(n.seed??.5),b=new qi(n.quality??1),S=ba(n),A=new hne(r,s,o,a,l,c,h,u,d,f,S.alpha,p,S.isMask,m,v,g,y,x,b),E=new tn(A.calpha,"f");return new Rn(e,i,t,{scale:r,size:s,move:o,fA:a,fB:l,distortion:c,colorA:h,colorB:u,colorC:d,colorD:f,noiseType:p,...S,voronoiStyle:m,highCut:v,lowCut:g,smoothness:y,seed:x,quality:b},A,S.mode,E,S.isMask)}case"normal":{let r=new Da(n.cnormal??new L(1,1,1)),s=ba(n),o=new sne(r,s.alpha),a=new tn(o.calpha,"f");return new Rn(e,i,t,{cnormal:r,...s},o,s.mode,a,s.isMask)}case"gradient":{let r=new qi(n.gradientType??0),s=new zs(n.smooth??!1),o;n.colors?o=new rp(n.colors.length,n.colors):(o=new rp(10,new Kt(0,0,0,1)),o.value[1]=new Kt(1,1,1,1));let a;n.steps?a=new np(n.steps.length,n.steps):(a=new np(10,1),a.value[0]=0);let l=new Qr(n.offset??new he(0,0)),c=new Qr(n.morph??new he(0,0)),h=new pt(n.angle??0),u=ba(n),d=new lne(r,s,o,a,l,c,h,u.alpha,u.isMask),f=new tn(d.calpha,"f");return new Rn(e,i,t,{gradientType:r,smooth:s,colors:o,steps:a,offset:l,morph:c,angle:h,...u},d,u.mode,f,u.isMask)}case"pattern":{let r=new qi(n.style??0),s=new qi(n.projection??0),o=new qi(["x","y","z"].indexOf(n.axis)??0),a=new pt(n.blending??0),l=new Qr(n.offset??new he(0,0)),c=new Fu(n.colorA),h=new Fu(n.colorB),u=new Qr(n.frequency??new he(10,10)),d=new pt(n.size??.5),f=new pt(n.variation??0),p=new pt(n.smoothness??.5),m=new pt(n.zigzag??0),v=new pt(n.rotation??0),g=new Qr(n.vertical??new he(0,1)),y=new Qr(n.horizontal??new he(0,1)),x=new qi(n.sides??6),b=ba(n),S=new pne(r,s,o,a,l,c,h,u,d,f,p,m,v,g,y,x,b.alpha,b.isMask),A=new tn(S.calpha,"f");return new Rn(e,i,t,{style:r,projection:s,axis:o,blending:a,offset:l,colorA:c,colorB:h,frequency:u,size:d,variation:f,smoothness:p,zigzag:m,rotation:v,vertical:g,horizontal:y,sides:x,...b},S,b.mode,A,b.isMask)}default:{let r=new Un(1,0,0,1),s=ba(n),o=new WO(r,s.alpha),a=new tn(o.calpha,"f");return new Rn(e,i,t,{color:r,...s},o,s.mode,a,s.isMask)}}}function F4e(t,e,i,n){let r=x4e(i,n);return O4e(i,t,e,r)}function Pne(t,e,i){if(i.type==="displace"&&(t==="intensity"||t==="visible")){let n=e.uniforms[`f${e.id}_intensity`];return n?(n.value=i.intensity*(i.visible?1:0),n):void 0}if(i.type!=="displace"&&(t==="alpha"||t==="visible")){let n=e.uniforms[`f${e.id}_alpha`];if(!n)return;if(n.value=i.alpha*(i.visible?1:0),i.type==="outline"&&t==="visible"){let r=e.uniforms[`f${e.id}_compensation`];r&&(r.value=i.compensation&&i.visible)}return n}}function NT(t,e){let i=0,n=t.layers.find(r=>r.data.type==="light");if(n&&n.data.alphaOverride<1)return!0;for(let r of t.layers){if(r.data.type!=="displace"&&r.data.isMask)return!0;if(r.data.type!=="displace"&&"alpha"in r.data&&r.data.type!=="light"&&r.data.type!=="fresnel"&&r.data.type!=="texture"&&r.data.type!=="matcap"&&r.data.type!=="rainbow"&&r.data.type!=="outline"&&r.data.type!=="pattern"){let s=r.data.visible?r.data.alpha:0;if(s===1&&r.data.type==="depth"||r.data.type==="gradient"){for(let o of r.data.colors)if(o[3]<1){s=o[3];break}}else if(s===1&&r.data.type==="noise"){let o=e.color(r.data.colorA).a,a=e.color(r.data.colorB).a,l=e.color(r.data.colorC).a,c=e.color(r.data.colorD).a,h=Math.min(o,Math.min(a,Math.min(l,c)));h<1&&(s=h)}i+=(1-i)*s}}return i<1}var rf=class extends $i{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.cacheKey="",this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return this.cacheKey}},N4e=class extends rf{constructor(t,e,i,n){super(),this.flatShading=t,this.side=e,this.wireframe=i,this.root=n}updateAfterBuild(){let t=this.root;this.lights=t.lights,this.vertexShader=t.vertexShader,this.fragmentShader=t.fragmentShader,this.defines=t.defines,this.uniforms=t.uniforms,this.extensions=t.extensions,this.transparent=t.transparent,this.cacheKey=t.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(t,e){this.root.onBeforeCompile(t)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(t,e,i){return this.root.getFlavor(t,e,i)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(t){return this.root.getLayersOfType(t)}getLayerByUuid(t){return this.root.getLayerByUuid(t)}updateByOp(t,e,i){this.root.updateByOp(t,e,i)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},Dne=class extends rf{constructor(t,e){super(),this.data=t,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.reset0(t,e)}get nodeMaterial(){return this}getFlavor(t,e,i){let n=i?6:(t?3:0)+e;if(n===0)return this;this.flavors===void 0&&(this.flavors=[]),n-=1;let r=this.flavors[n];return r===void 0&&(r=new N4e(t,e,i,this),this.flavors[n]=r,r.flatShading=t,r.side=e,r.updateAfterBuild()),r}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){var t;return((t=this.lightLayer.getNode("occlusion"))==null?void 0:t.value)??!1}reset(t,e){this.data!==t&&this.reset0(t,e)}reset0(t,e){this.data=t;let i=t.layers??ea.defaultTwoLayerData("phong").layers;try{this.layers=i.map(n=>Yp.create(this.layerIdGen++,n.id,n.data,e.shared))}catch{this.layers=[]}this.layers.reverse(),this.name=t.name??"Untitled Material",this.onUpdate(),this.transparent=NT(t,e.shared)}getLayersOfType(t){return this.layers.filter(e=>e.type===t)}getLayerByUuid(t){return this.layers.find(e=>e.uuid===t)}onUpdate(){this.cacheKey=this.computeCacheKey(),this.lightLayer=this.layers.find(t=>t instanceof Nu),this.lightLayer===void 0&&(this.lightLayer=new Nu(0,"",{...Na.defaultData("light","phong"),visible:!1},new Sne,{})),this.dispose();for(let t of this.flavors)t&&t.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions()}applyTextureMaps(){let t=this.layers.find(r=>r instanceof Nu);if(!t)return;let e=t.data,i=e.bumpMap,n=e.roughnessMap;t.node.bumpMap=void 0,t.node.roughnessMap=void 0;for(let r=0;r<this.layers.length;++r){let s=this.layers[r];s instanceof Rn&&s.color instanceof uz&&(s.uuid===i&&(t.node.bumpMap=s.color),s.uuid===n&&(t.node.roughnessMap=s.color))}}updateByOp(t,e,i){if(e!==void 0?this.data=e:e=this.data,this.transparent=NT(e,i.shared),t.path[0]==="layers"){this.data=e;let n=i.shared,r=t.path[1];if(r===void 0){if(this.layers.reverse(),t.type===4){let s=Yp.create(this.layerIdGen++,t.id,t.data,i.shared);this.layers.splice(t.localIndex,0,s),i.scene.markNeedsUpdateRendererDirty()}else if(t.type===5)this.layers.splice(t.localIndex,1)[0].dispose(),i.scene.markNeedsUpdateRendererDirty();else if(t.type===6){let s=this.layers.findIndex(a=>a.uuid===t.id),o=this.layers[s];this.layers.splice(s,1),this.layers.splice(t.localIndex,0,o),i.scene.markNeedsUpdateRendererDirty()}this.layers.reverse(),this.onUpdate()}else{t.type===0&&t.props.occlusion!==void 0&&i.scene.markNeedsUpdateRendererDirty();let s=this.layers.find(o=>o.uuid===r);if(s){let o=e.layers.data(r);if(s.updateByOp({...t,path:t.path.slice(2)},o,i)){let a=Yp.create(this.layerIdGen++,r,o,n);this.layers.splice(this.layers.findIndex(l=>l.uuid===r),1,a),this.onUpdate()}}}}else this.reset(e,i)}applyMasks(){for(let t=0;t<this.layers.length;++t){let e=this.layers[t];e instanceof Rn?e.color.mask=void 0:e instanceof Nu&&(e.node.mask=void 0)}for(let t=0;t<this.layers.length;++t){let e=this.layers[t];if(e instanceof Rn&&e.isMask.value&&e.data.visible&&t>0){let i=t-1,n=this.layers[i];n instanceof Nu?n.node.mask=new $s(e.color,e.alpha,$s.MUL):n instanceof Rn&&(n.isMask.value||(n.color.mask=new $s(e.color,e.alpha,$s.MUL)))}}}blendColors(){let t=this.layers.findIndex(i=>i instanceof Rn),e=this.layers.findIndex(i=>i instanceof Nu);if(t!==-1&&t<e){let i=this.layers[t].color;for(let n=t+1;n<e;++n){let r=this.layers[n];if(r instanceof Rn){if(r.isMask.value)continue;i=new e7(i,r.color,r.alpha,r.mode)}}this.fragment.color=i}else this.fragment.color=void 0}blendAfterColors(){let t=new tn("outgoingLight","f"),e=this.layers.findIndex(i=>i instanceof Nu);if(this.layers.length>e+1){for(let i=e+1;i<this.layers.length;++i){let n=this.layers[i];if(n instanceof Rn){if(n.isMask.value)continue;t=new e7(t,n.color,n.alpha,n.mode)}}this.fragment.afterColor=t}else this.fragment.afterColor=void 0}blendPositions(){let t=this.layers.filter(e=>e instanceof Cne);if(t.length>0){let e=t[0].position;for(let i=1;i<t.length;++i)t[i]&&(e=new $s(e,t[i].position,$s.ADD),e=new $s(e,new pt(.5).setReadonly(!0),$s.MUL));this.fragment.position=e}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(t){this.build(),t.defines=this.defines,t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.extensionDerivatives=this.extensions.derivatives===!0,t.extensionFragDepth=this.extensions.fragDepth===!0,t.extensionDrawBuffers=this.extensions.drawBuffers===!0,t.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}clampUniformsForPreview(t,e){let i=(n,r,s)=>Math.min(Math.max(n,r),s);for(let n of this.layers)if(n.type==="displace"){let r=i(n.uniforms[`f${n.id}_intensity`].value,t,e);n.uniforms[`f${n.id}_intensity`].value=r}}computeCacheKey(){let t="[";for(let{data:e}of this.data.layers)if(e.type==="light")t+=`"${e.visible?e.category.toUpperCase():"Basic"}"`;else{let i=(Mne[e.type]??[]).map(a=>e[a]),n=(Ene[e.type]??[]).map(a=>{var l;return((l=e[a])==null?void 0:l.length)??0}),r=[...i,...n],s="isMask"in e&&e.isMask,o=`"${e.type}-${e.visible}-${s}"`;r.length?t+=`[${o}, "${r.join('","')}"],`:t+=o}return t=t.slice(0,-1)+"]",t}updateFrame(t){for(let e=0;e<this.updaters.length;++e)t.updateNode(this.updaters[e])}build(){let t=new r4e;t.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,t.build(this.fragment,this.fragment),this.vertexShader=t.getCode("vertex"),this.fragmentShader=t.getCode("fragment"),this.defines=t.defines,this.uniforms=t.uniforms,this.extensions=t.extensions,this.updaters=t.updaters;for(let e of this.flavors)e&&e.updateAfterBuild();return this}nodeMaterialDispose(){this.layers.forEach(t=>t.dispose()),super.dispose();for(let t of this.flavors)t&&t.dispose()}assetsLoaded(){for(let t of this.layers)if(t instanceof Rn){let e=t.params.texture;if(e instanceof jO&&!e.image.loaded)return!1}return!0}getHash(){let t="{";return t+='"fragment":'+this.fragment.getHash(),t+="}",t}};Object.defineProperties(rf.prototype,{properties:{get:function(){return this.fragment.properties}}});var qO=class extends Dne{},U4e=Rw(CSe()),t7=new Map;function k4e(t){if(typeof t=="string")return t;let e=t7.get(t);return e||(e={url:URL.createObjectURL(new Blob([t]))},t7.set(t,e)),e.url}var f1=class{constructor({src:t,volume:e,delay:i,loop:n}){this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)};let r;typeof t=="string"?r={src:t}:r={src:k4e(t),format:"wav"},this.sound=new U4e.Howl(r),this.sound.on("end",this.onEnd),this.src=t,e!==void 0&&(this.volume=e),i!==void 0&&(this.delay=i),n!==void 0&&(this.loop=n)}get status(){return this._status}get volume(){return this._volume}set volume(t){this._volume=t,this.sound.volume(t)}get loop(){return this._loop}set loop(t){this._loop=t,this.loopsRemaining=t}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(t,e=1e3){t?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,e),this.clearFade()},t)):this.sound.fade(this._volume,0,e)}on(t,e,i){this.sound.on(t,e,i)}off(t,e,i){this.sound.off(t,e,i)}play(){this._status==="playing"||this.sound.playing()||(this._status==="paused"?(this.sound.seek()===0?this.replay():this.sound.play(),this._status="playing"):this._status==="stopped"&&(this.replay(),this._status="playing"))}pause(){this._status==="playing"&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(t=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},z4e=class{constructor(){this.type="ShapePath",this.color=new It,this.subPaths=[],this.currentPath=null}moveTo(t,e){return this.currentPath=new nT,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this}lineTo(t,e){var i;return(i=this.currentPath)==null||i.lineTo(t,e),this}quadraticCurveTo(t,e,i,n){var r;return(r=this.currentPath)==null||r.quadraticCurveTo(t,e,i,n),this}bezierCurveTo(t,e,i,n,r,s){var o;return(o=this.currentPath)==null||o.bezierCurveTo(t,e,i,n,r,s),this}splineThru(t){var e;return(e=this.currentPath)==null||e.splineThru(t),this}toShapes(){let t={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},e={loc:t.ORIGIN,t:0};function i(f,p,m,v){let g=f.x,y=p.x,x=m.x,b=v.x,S=f.y,A=p.y,E=m.y,M=v.y,T=(b-x)*(S-E)-(M-E)*(g-x),P=(y-g)*(S-E)-(A-S)*(g-x),R=(M-E)*(y-g)-(b-x)*(A-S),U=T/R,F=P/R;if(R===0&&T!==0||U<=0||U>=1||F<0||F>1)return null;if(T===0&&R===0){for(let N=0;N<2;N++)if(n(N===0?m:v,f,p),e.loc===t.ORIGIN){let W=N===0?m:v;return{x:W.x,y:W.y,t:e.t}}else if(e.loc===t.BETWEEN){let W=+(g+e.t*(y-g)).toPrecision(10),Q=+(S+e.t*(A-S)).toPrecision(10);return{x:W,y:Q,t:e.t}}return null}else{for(let Q=0;Q<2;Q++)if(n(Q===0?m:v,f,p),e.loc===t.ORIGIN){let X=Q===0?m:v;return{x:X.x,y:X.y,t:e.t}}let N=+(g+U*(y-g)).toPrecision(10),W=+(S+U*(A-S)).toPrecision(10);return{x:N,y:W,t:U}}}function n(f,p,m){let v=m.x-p.x,g=m.y-p.y,y=f.x-p.x,x=f.y-p.y,b=v*x-y*g;if(f.x===p.x&&f.y===p.y){e.loc=t.ORIGIN,e.t=0;return}if(f.x===m.x&&f.y===m.y){e.loc=t.DESTINATION,e.t=1;return}if(b<-Number.EPSILON){e.loc=t.LEFT;return}if(b>Number.EPSILON){e.loc=t.RIGHT;return}if(v*y<0||g*x<0){e.loc=t.BEHIND;return}if(Math.sqrt(v*v+g*g)<Math.sqrt(y*y+x*x)){e.loc=t.BEYOND;return}let S;v!==0?S=y/v:S=x/g,e.loc=t.BETWEEN,e.t=S}function r(f,p){let m=[],v=[];for(let g=1;g<f.length;g++){let y=f[g-1],x=f[g];for(let b=1;b<p.length;b++){let S=p[b-1],A=p[b],E=i(y,x,S,A);E!==null&&m.find(M=>M.t<=E.t+Number.EPSILON&&M.t>=E.t-Number.EPSILON)===void 0&&(m.push(E),v.push(new he(E.x,E.y)))}}return v}function s(f,p,m){let v=new he;p.getCenter(v);let g=[];return m.forEach(y=>{y.boundingBox.containsPoint(v)&&r(f,y.points).forEach(x=>{g.push({identifier:y.identifier,isCW:y.isCW,point:x})})}),g.sort((y,x)=>y.point.x-x.point.x),g}function o(f,p,m,v,g){(g==null||g==="")&&(g="nonzero");let y=new he;f.boundingBox.getCenter(y);let x=[new he(m,y.y),new he(v,y.y)],b=s(x,f.boundingBox,p);b.sort((P,R)=>P.point.x-R.point.x);let S=[],A=[];b.forEach(P=>{P.identifier===f.identifier?S.push(P):A.push(P)});let E=S[0].point.x,M=[],T=0;for(;T<A.length&&A[T].point.x<E;)M.length>0&&M[M.length-1]===A[T].identifier?M.pop():M.push(A[T].identifier),T++;if(M.push(f.identifier),g==="evenodd"){let P=M.length%2===0,R=M[M.length-2];return{identifier:f.identifier,isHole:P,for:R}}else if(g==="nonzero"){let P=!0,R=null,U=null;for(let F=0;F<M.length;F++){let N=M[F];p[N]&&(P?(U=p[N].isCW,P=!1,R=N):U!==p[N].isCW&&(U=p[N].isCW,P=!0))}return{identifier:f.identifier,isHole:P,for:R}}else console.warn('fill-rule: "'+g+'" is currently not implemented.')}let a=0,l=999999999,c=-999999999,h=[];this.subPaths.forEach(f=>{let p=f.getPoints(),m=-999999999,v=999999999,g=-999999999,y=999999999;for(let x=0;x<p.length;x++){let b=p[x];b.y>m&&(m=b.y),b.y<v&&(v=b.y),b.x>g&&(g=b.x),b.x<y&&(y=b.x)}c<=g&&(c=g+1),l>=y&&(l=y-1),p.length&&h.push({curves:f.curves,points:p,isCW:Wee.isClockWise(p),identifier:a++,boundingBox:new VPe(new he(y,v),new he(g,m))})});let u=h.map(f=>{var p;return o(f,h,l,c,(p=this.userData)==null?void 0:p.style.fillRule)}),d=[];return h.forEach(f=>{let p=u[f.identifier];if(p&&!p.isHole){let m=new rT;m.curves=f.curves,u.filter(v=>(v==null?void 0:v.isHole)&&v.for===f.identifier).forEach(v=>{if(v){let g=h[v.identifier],y=new nT;y.curves=g.curves,m.holes.push(y)}}),d.push(m)}}),d}},Rne,i7=new Promise(t=>{Rne=t}),n7=!1,JA;function G4e(){if(n7)return;if(JA)return JA;async function t(){let e=await Dw(()=>import("./opentype-fc28cde9.js"),[]);Rne(e),n7=!0}return JA=t(),JA}var H4e=class{async load(t,e,i=()=>{}){let{load:n}=await i7;n(t,(r,s)=>{r||!s?i(r??"Something went wrong"):e(s)})}async parse(t){let{parse:e,Bidi:i}=await i7;try{let n=e(t),r=new i,s=o=>n.charToGlyphIndex(o.char);return r.registerModifier("glyphIndex",null,s),r.applyFeatures(n,n.defaultRenderOptions.features),{font:n,bidi:r}}catch(n){console.error(n)}}};async function V4e(t){return await(await fetch(t)).arrayBuffer()}var j4e=new H4e;async function r7(t){let e,i,n=!1;if(t.url?(e=await V4e(t.url),i=t.url,n=t.url.startsWith("/")):t.data&&(e=t.data.buffer),e){let r=await j4e.parse(e);if(r)return{font:r.font,url:i,intercepted:n,arr:e,bidi:r.bidi}}}function W4e(t,e){return e.state.glyphIndex===t||e.state.fina===t||e.state.medi===t||e.state.init===t}var X4e=class{constructor(t){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=t.isUserFont??!1,this._loadingPromise=r7(t).then(e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)})}update(t){this._isLoaded=!1,this._isUserFont=t.isUserFont??!1,this._loadingPromise=r7(t).then(e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(t,e,i){if(!this._bidi)return[];let n=this._bidi;n.getTextGlyphs(e);let r=n.tokenizer.tokens,s=[],o=0,a=i.length===r.length;for(let l=0;l<i.length;l++){let c=i[l].index,h=String.fromCharCode(i[l].unicode),u=r[o];if(W4e(c,u)||a)s.push({char:h,index:c,replacements:[u.state.glyphIndex],replacementChars:[u.char]}),o++;else{let d=u.char,f="",p=[u.state.glyphIndex],m=[],v=!1;for(;!v;)o++,f=e.charAt(o),d+=f,p.push(t.charToGlyphIndex(f)),m=t.stringToGlyphs(d),m.length===1&&m[0].index===c&&(v=!0),o>e.length&&(v=!0);s.push({char:h,index:c,replacements:p,replacementChars:Array.from(d)}),o++}}return s}generateShapes(t,e){if(!this._isLoaded)return;let i=this.font,n=e.fontSize/this.unitsPerEm,r=e.fontSize*e.lineHeight,s=t.map(g=>this.getTextWidth(g,e)),o=e.width,a=this.getCharWidth(`
`,e),l=e.horizontalAlign===1?a:0,c=this.computeSpaceWidthForLine(t,0,e),h=this.getLineInitialOffsetX(s[0],o,e.horizontalAlign,t[0],a),u=this.getLineInitialOffsetY(r,t.length,e.height,n,e.verticalAlign),d=[],f=t.map(g=>[]),p=t.map(g=>[]),m;for(let g=0;g<t.length;g++){let y=t[g],x={features:{liga:!0}},b=[];try{b=i.stringToGlyphs(y,x)}catch(A){console.warn(A)}h=this.getLineInitialOffsetX(s[g],o,e.horizontalAlign,y,a);let S=[];try{S=this.reverseLigaturesTable(i,y,b)}catch(A){console.warn(A)}c=this.computeSpaceWidthForLine(t,g,e);for(let A=0;A<b.length;A++){let E=b[A],M=E.index===0?`
`:E.unicode?String.fromCharCode(E.unicode):void 0,T=S[A],P=0,R=0;A===0&&e.horizontalAlign===2&&E.leftSideBearing!==void 0&&(R=-E.leftSideBearing*n),m&&(P=i.getKerningValue(E,m)*n),h+=R+P;let U=0;if(M===`
`)U=l;else if(M===" ")U=c;else{let F=this.createPath(E,n,h,u,e);F&&(U=F.offsetX-(P+R),d.push(F.path))}if(T.replacements.length===1)p[g].push([h,u]),f[g].push(U);else{let F=T.replacements.map(X=>(i.glyphs.get(X).advanceWidth??0)*n),N=F.reduce((X,B)=>X+=B,0),W=F.map(X=>X/N),Q=h;for(let X=0;X<W.length;X++){let B=U*W[X];p[g].push([Q,u]),f[g].push(B),Q+=B}}h+=U,m=E}u-=r}let v=[];for(let g=0,y=d.length;g<y;g++)v.push(...d[g].toShapes());return{shapes:v,charWidths:f,lineWidths:s,charCoords:p}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var t;return((t=this.font)==null?void 0:t.ascender)??0}get descender(){var t;return((t=this.font)==null?void 0:t.descender)??0}get familyName(){var t;return((t=this.font)==null?void 0:t.names.fontFamily)??""}get subfamilyName(){var t;return((t=this.font)==null?void 0:t.names.fontSubfamily)??""}get unitsPerEm(){var t;return((t=this.font)==null?void 0:t.unitsPerEm)??1}getLineInitialOffsetX(t,e,i,n,r){return(i===3||i===2)&&n.indexOf(`
`)>=0&&(t-=r),i===3?e*.5-t*.5:i===2?e-t:0}getLineInitialOffsetY(t,e,i,n,r){let s=e*t,o=Math.abs(this.ascender-this.descender)*n,a=t-o,l=-this.ascender*n-a/2;return r===3?-(i-s-l):r===2?-(i*.5-s*.5-l):l}createPath(t,e,i,n,r){var l;let s=t.getPath(i,-n,r.fontSize,{kerning:!1,letterSpacing:r.letterSpacing});if(!s){console.error('THREE.Font: character "'+t+'" does not exists in font family '+this.familyName+".");return}let o=new z4e,a=(t.advanceWidth??1)*e;if(t)for(let c of s.commands){let h=(l=o.currentPath)==null?void 0:l.currentPoint;if(!(h&&c.type!=="Z"&&h.x===c.x&&-h.y===c.y))switch(c.type){case"M":o.moveTo(c.x,-c.y);break;case"L":o.lineTo(c.x,-c.y);break;case"Q":o.quadraticCurveTo(c.x1,-c.y1,c.x,-c.y);break;case"C":o.bezierCurveTo(c.x1,-c.y1,c.x2,-c.y2,c.x,-c.y);break}}return o.subPaths.forEach(c=>{let h=q4e(c.curves);h!==void 0&&c.currentPoint.distanceTo(h)>0&&c.lineTo(h.x,h.y)}),{offsetX:a+r.fontSize*r.letterSpacing,path:o}}getCharWidth(t,e){var i;return((i=this.font)==null?void 0:i.getAdvanceWidth(t,e.fontSize,{kerning:!0,letterSpacing:e.letterSpacing}))??0}getTextWidth(t,e){var i;return((i=this.font)==null?void 0:i.getAdvanceWidth(t,e.fontSize,{kerning:!0,letterSpacing:e.letterSpacing}))??0}computeSpaceWidthForLine(t,e,i){let n=this.getCharWidth(" ",i),r=t[e];if(r){let s=this.countSpaces(r.trimEnd());if(i.horizontalAlign===4&&e<t.length-1&&s){let o=i.width,a=this.getTextWidth(r,i);return(o-(a-s*n))/s}}return n}countSpaces(t){return(t.match(/ /g)||[]).length}};function q4e(t){if(t.length){let e=t[0];if(e instanceof Nl)return e.v1;if(e instanceof El||e instanceof tf)return e.v0}}var Y4e=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(t){return this.objects.get(t)}get size(){return this.objects.size}get(t,e){let i=this.objects.get(t);return i===void 0?(i=this.createObject(t,e),this.objects.set(t,i)):i.isShared=!0,i}mutateIfUnique(t,e){let i=this.objects.get(t);if(i&&i.isShared!==!0)return this.objects.delete(t),this.objects.set(e,i),i}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(t,e){let i=this.objects.get(t);e===i&&this.unreachable.delete(t)}endGc(){this.unreachable.forEach(t=>{this.disposeObject(this.objects.get(t)),this.objects.delete(t)}),this.unreachable.clear()}dispose(){this.objects.forEach(t=>{this.disposeObject(t)}),this.objects.clear()}},s7=class extends Y4e{constructor(t){super(),this.flatShading=t}disposeObject(t){t.dispose()}createObject(t,e){let i=OT(t,e,this.flatShading);return i.computeBoundingSphere(),i}},Q4e={markNeedsUpdateRendererDirty:()=>{}},K4e=class extends y4e{constructor(t){super(),this.shared=t}create(t){return new Ane(t,this.shared)}},dz=class{constructor(t,e={}){if(this.geometryCache=new s7(!0),this.geometryCache2=new s7(!1),this.imageHolderCache=new K4e(this),this.thisContext={scene:Q4e,shared:this},this.deletedMaterial=new qO(ea.defaultTwoLayerData("phong"),this.thisContext),this.deletedImage=new Ep(DT.emptyImage,this),this.deletedVideo=new Ep(ST.defaultVideo,this),this.materials={},this.images={},this.videos={},this.colors={},this.audios={},this.fonts={},this.requestRender=()=>{this._requestRender&&this._requestRender()},e.images)for(let[i,n]of Object.entries(e.images))this.addImage(i,n);if(e.videos)for(let[i,n]of Object.entries(e.videos))this.addVideo(i,n);if(e.audios)for(let[i,n]of Object.entries(e.audios))this.addAudio(i,n.data);this.reset(t)}setRequestRender(t){this._requestRender=t}reset(t){for(let[e,i]of Object.entries(t.images))this.addImage(e,i);for(let[e,i]of Object.entries(t.videos))this.addVideo(e,i);for(let[e,i]of Object.entries(t.colors))this.addColor(e,i);for(let[e,i]of Object.entries(t.materials))this.addMaterial(e,new qO(i,this.thisContext));for(let[e,i]of Object.entries(t.audios))this.addAudio(e,i.data);for(let[e,i]of Object.entries(t.fonts))this.addFont(e,i)}addMaterial(t,e){e.uuid=t,this.materials[t]?(this.materials[t].reset(e.data,this.thisContext),e.dispose()):this.materials[t]=e}deleteMaterial(t){this.materials[t]&&(this.materials[t].nodeMaterialDispose(),delete this.materials[t])}getMaterial(t){return this.materials[t]}getMaterialOrDeletedPlaceholder(t){return this.materials[t]??this.deletedMaterial}material(t){return typeof t=="string"?this.getMaterialOrDeletedPlaceholder(t):t==null?(console.error("material is undefined or null"),this.deletedMaterial):new Dne(t,this.thisContext)}getMaterials(){return this.materials}addImage(t,e){return this.images[t]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[t].updateSrc(e.data),!0):(this.images[t]=new Ep(e,this),!1)}deleteImage(t){let e=this.images[t];e&&(e.dispose(),delete this.images[t])}getDefaultImage(){return this.images.image_0}getImage(t){return this.images[t]??this.deletedImage}image(t){return typeof t=="string"?this.getImage(t):this.imageHolderCache.load(t)}addVideo(t,e){return this.videos[t]?(this.videos[t].updateSrc(e.data),!0):(this.videos[t]=new Ep(e,this),!1)}deleteVideo(t){let e=this.videos[t];e&&(e.dispose(),delete this.videos[t])}getVideo(t){return this.videos[t]??this.deletedVideo}video(t){return typeof t=="string"?this.getVideo(t):this.imageHolderCache.load(t)}addColor(t,e){return this.colors[t]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in e?this.colors[t].setRGBA(e.r,e.g,e.b,e.a):this.colors[t].setRGBA(e.r,e.g,e.b,1),!0):("a"in e?this.colors[t]=new FT(e.r,e.g,e.b,e.a):this.colors[t]=new FT(e.r,e.g,e.b,1),!1)}updateColor(t,e){if(this.colors[t]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let i=this.colors[t];return this.colors[t].r=e.r??i.r,this.colors[t].g=e.g??i.g,this.colors[t].b=e.b??i.b,this.colors[t].a=e.a??i.a,!0}return!1}deleteColor(t){this.colors[t]&&delete this.colors[t]}getColor(t){return this.colors[t]}color(t){let e;if(typeof t=="string"){let i=this.getColor(t);i?e=i:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),e=new wo(0,0,0,0))}else return"a"in t?new wo(t.r,t.g,t.b,t.a):new wo(t.r,t.g,t.b,1);return e}addAudio(t,e){this.audios[t]=e}getAudio(t){let e=this.audios[t];if(e instanceof f1)return e;{let i=new f1({src:e});return this.audios[t]=i,i}}deleteAudio(t){let e=this.audios[t];e&&(e instanceof f1&&e.dispose(),delete this.audios[t])}addFont(t,e){this.fonts[t]=new X4e(e),this.fonts[t].loadingPromise.then(()=>this.requestRender())}getFont(t){return this.fonts[t]}deleteFont(t){this.fonts[t]&&delete this.fonts[t]}dispose(){Object.keys(this.materials).forEach(t=>this.deleteMaterial(t)),this._requestRender=void 0,Object.values(this.audios).forEach(t=>{t instanceof f1&&t.dispose()}),this.audios={},this.geometryCache.dispose(),this.geometryCache2.dispose()}};new dz(DO.emptyData());var Sy=class extends Mo{updateByPatchedOp(t,e,i){if(super.updateByPatchedOp(t,e,i),ONe(t.path,["materials"])!==null&&t.type===0&&Array.isArray(this.material))for(let[n,r]of Object.entries(t.props)){let s=i.shared.material(r);this.material[Number(n)]=s}else if(Ga(t.path,["material"])&&this.material instanceof rf)"material"in e&&typeof e.material!="string"&&this.material.updateByOp(Yo.drop(t,1),e.material,i);else if(Ga(t.path,["materials","*"])&&Array.isArray(this.material)){let n=t.path[1];if("materials"in e&&n<this.material.length){let r=e.materials[n];typeof r!="string"&&this.material[n].updateByOp(Yo.drop(t,2),r,i)}}}get needsAO(){return this.material!==void 0?(Array.isArray(this.material)?this.material[0]:this.material).hasAO:!1}updateState(t,e){var n,r;super.updateState(t,e),t.castShadow!==void 0&&(this.castShadow=t.castShadow),t.receiveShadow!==void 0&&(this.receiveShadow=t.receiveShadow);let i=this.dataPatched;if(((n=t.geometry)==null?void 0:n.type)!=="NonParametricGeometry"&&"material"in t&&t.material!==void 0&&(this.disposeMaterial(),this.material=e.shared.material(t.material).getFlavor(i.flatShading,i.side,i.wireframe),e.scene.markNeedsUpdateRendererDirty()),((r=t.geometry)==null?void 0:r.type)==="NonParametricGeometry"&&("materials"in t&&t.materials!==void 0?(this.disposeMaterial(),this.material=t.materials.map(s=>e.shared.material(s).getFlavor(i.flatShading,i.side,i.wireframe)),e.scene.markNeedsUpdateRendererDirty()):"material"in t&&t.material!==void 0&&(this.disposeMaterial(),this.material=[e.shared.material(t.material).getFlavor(i.flatShading,i.side,i.wireframe)],e.scene.markNeedsUpdateRendererDirty())),t.flatShading!==void 0||t.wireframe!==void 0||t.side!==void 0)if(Array.isArray(this.material))for(let s=0;s<this.material.length;s++)this.material[s]=this.material[s].getFlavor(i.flatShading,i.side,i.wireframe);else this.material=this.material.getFlavor(i.flatShading,i.side,i.wireframe)}disposeMaterial(){this.material&&Nte(this.material).forEach(t=>{t instanceof rf&&(t instanceof qO||t.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}},o7=new L,a7=new Kt,l7=new Kt,J4e=new L,c7=new $e,bo=class extends Sy{constructor(t,e,i){super(t,e),this.data=e,this.localGeometry=void 0,e.bindMode&&e.bindMatrix&&(this.isSkinnedMesh=!0,this.bindMode=e.bindMode,this.bindMatrix=new $e().fromArray(e.bindMatrix),this.bindMatrixInverse=new $e)}chooseGeoemtryCache(t){return t.geometryCache}markGeometryAsReachable(t){this.geometryCreateDeleyed instanceof Ut&&this.chooseGeoemtryCache(t).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(this.localGeometry!==void 0)return this.localGeometry;if(this.geometryCreateDeleyed instanceof dz){let t=this.geometryCreateDeleyed,e=this.chooseGeoemtryCache(t);this.geometryCreateDeleyed=e.get(this.dataPatched.geometry,t)}return this.geometryCreateDeleyed}set geometry(t){this.localGeometry=t}get is2DAndNoDepth(){let t=this.dataPatched.geometry;return ET.is2DParametricMesh(t.type)&&t.depth===0}get is2DType(){return ET.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return this.geometry.userData.type==="NonParametricGeometry"}updateByPatchedOp(t,e,i){super.updateByPatchedOp(t,e,i),Ga(t.path,["geometry"])&&this.updateByPatchedOpGeometry(Yo.drop(t,1),e.geometry,i)}removeInteractionGeometry(){var t;(t=this.localGeometry)==null||t.dispose(),this.localGeometry=void 0}updateGeometryInteractions(t,e){var n;this.invalidateDownstreamBooleanData();let i=this.data.geometry.type;if(i==="NonParametricGeometry"||i==="SubdivGeometry"){let r=t;if(this.localGeometry===void 0){let c={...this.data.geometry,...r};this.localGeometry=OT(c,e,this.data.flatShading)}let s,o,a;r.scaleBaked?[s,o,a]=r.scaleBaked:{width:s,height:o,depth:a}=r;let l=this.localGeometry.userData;l.sxPrev!==void 0&&HO(this.localGeometry.attributes,s/l.sxPrev,o/l.syPrev,a/l.szPrev),l.sxPrev=s,l.syPrev=o,l.szPrev=a}else{let r={...this.data.geometry,...t};(n=this.localGeometry)==null||n.dispose(),this.localGeometry=OT(r,e,this.data.flatShading)}}refreshAttachedCloners(t){for(let e of this.attachedSurfaceCloners)t.scene.addPendingUpdateCloner(e.object)}refreshAttachedPaths(t){for(let e of this.attachedPaths)t.scene.addPendingCommand(()=>e.updateShape())}createGeometryDelayed(t){this.geometryCreateDeleyed=t.shared,this.refreshAttachedCloners(t),this.refreshAttachedPaths(t)}updateByPatchedOpGeometry(t,e,i){var r;let n=!1;t.type===0&&t.path.length===0&&Gk(["scaleBaked"],Object.keys(t.props))&&this.geometryCreateDeleyed instanceof ks&&this.chooseGeoemtryCache(i.shared).mutateIfUnique(this.geometryCreateDeleyed.data,e)===this.geometryCreateDeleyed&&(n=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(e,t.props.scaleBaked),this.refreshAttachedCloners(i),this.refreshAttachedPaths(i)),n||((r=i.scene)==null||r.markGeometryCacheDirty(),this.createGeometryDelayed(i)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(t,e){this.createGeometryDelayed(e)}updateState(t,e){t.geometry!==void 0&&this.updateGeometryOnStateUpdate(t.geometry,e),super.updateState(t,e)}updateGeometryGroupsIfNeeded(){var t;Array.isArray(this.material)&&this.geometry.groups.length===0&&this.geometry.addGroup(0,Math.max(((t=this.geometry.getIndex())==null?void 0:t.count)??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(t,e){let i=this.geometry.userData.parameters;this.is2DType?t.set(0,0,i.depth*.5):this.isNonParametric?(t.setScalar(0),this.geometry.boundingSphere&&t.copy(this.geometry.boundingSphere.center),e.set(i.width,i.height,i.depth??0).multiplyScalar(.5)):t.setScalar(0),e.set(i.width,i.height,i.depth??0).multiplyScalar(.5)}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(t,e){this.skeleton=t,e===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(t){let e=new Kt,i=this.geometry.attributes.skinWeight;for(let n=0,r=i.count;n<r;n++){e.fromBufferAttribute(i,n);let s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),i.setXYZW(n,e.x,e.y,e.z,e.w)}}boneTransform(t,e){let i=this.skeleton;if(i===void 0)return;let n=this.geometry;a7.fromBufferAttribute(n.attributes.skinIndex,t),l7.fromBufferAttribute(n.attributes.skinWeight,t),o7.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let r=0;r<4;r++){let s=l7.getComponent(r);if(s!==0){let o=a7.getComponent(r);c7.multiplyMatrices(i.bones[o].matrixWorld,i.boneInverses[o]),e.addScaledVector(J4e.copy(o7).applyMatrix4(c7),s)}}return e.applyMatrix4(this.bindMatrixInverse)}};function Z4e(t){var o,a;if(t.geometry.attributes.extrudeNormal||!t.geometry.attributes.position||!t.geometry.attributes.normal)return;let e=new Map,i=t.geometry.attributes,n=i.position.array,r=i.normal.array,s=new Float32Array(n.length);for(let l=0;l<n.length;l+=3){let c=`${n[l]}_${n[l+1]}_${n[l+2]}`,h=new L(r[l],r[l+1],r[l+2]);e.has(c)?(o=e.get(c))==null||o.normals.push(h):e.set(c,{normals:[h],result:new L})}e.forEach((l,c)=>{for(let h of l.normals)l.result.add(h);l.result.divideScalar(l.normals.length)});for(let l=0;l<n.length;l+=3){let c=`${n[l]}_${n[l+1]}_${n[l+2]}`,h=(a=e.get(c))==null?void 0:a.result;h&&(s[l]=h.x,s[l+1]=h.y,s[l+2]=h.z)}t.geometry.setAttribute("extrudeNormal",new yt(s,3))}function $4e(t){if(t.geometry.attributes.extrudeNormals||!t.geometry.attributes.position)return;let e=t.geometry.attributes.position.array,i=new Float32Array(e.length),n=new L;for(let r=0;r<e.length;r+=3)n.set(e[r],e[r+1],e[r+2]).normalize(),i[r]=n.x,i[r+1]=n.y,i[r+2]=n.z;t.geometry.setAttribute("extrudeNormal",new yt(i,3))}function fz(t){if(Array.isArray(t.material)){for(let e of t.material)if(e.getLayersOfType("outline").length===0)return}else if(!(t.material instanceof rf)||t.material.getLayersOfType("outline").length===0)return;t instanceof bo&&t.is2DAndNoDepth?$4e(t):Z4e(t)}function pz(t){if(!t.geometry.attributes.position)return;let e=t.geometry.attributes.position.array,i=new Float32Array(e.length),n=parseInt(t.uuid.replace(/\D/g,"")),r=[hi.seededRandom(n),hi.seededRandom(n+1e4),hi.seededRandom(n+2e4)];for(let s=0;s<e.length;s++)i[s]=r[s%3];t.geometry.setAttribute("randomColor",new Gt(i,3))}oz.then(t=>{});var hc=new Zn,Nx=new L;function eGe(t){let e=!1;return t.scene.objects.traverse((i,n)=>{n.type==="Mesh"&&n.geometry.type==="SubdivGeometry"&&(e=!0)}),e}var iw=class extends bo{constructor(t,e,i){super(t,e,i),this.data=e,this.hiddenMatrixOld=new $e,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(t){return this.dataPatched.flatShading?t.geometryCache:t.geometryCache2}get subdivPointerNew(){return this.localGeometry!==void 0?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return this.localGeometry!==void 0?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(t,e){let i=this.geometry.userData.parameters;t.copy(this.originalGeometryNew.boundingSphere.center),e.set(i.width,i.height,i.depth??0).multiplyScalar(.5)}createGeometryByControls(t){var s,o,a;if(this.skipReactionUpdate===!0)return;let e=(s=this.localGeometry)==null?void 0:s.uuid,{originalGeometry:i,subdividedGeometry:n,subdivPointer:r}=ks.build(t,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=r,i!==void 0&&((o=this.originalGeometry)==null||o.dispose(),this.originalGeometry=i),n!==void 0&&((a=this.subdividedGeometry)==null||a.dispose(),this.subdividedGeometry=n??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,fz(this),pz(this),this.calcBoundingBox(),e&&(this.localGeometry.uuid=e)}updateState(t,e){if(super.updateState(t,e),t.flatShading!==void 0){let i=this.material;this.material=i.getFlavor(!1,i.side,i.wireframe),this.smoothShading=!t.flatShading,this.createGeometryDelayed(e)}}updateMesh(t=!1){ks.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,t&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&ks.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,t&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=ks.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=ks.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(t,e){let i=this.localGeometry;this.localGeometry=this.originalGeometryNew,Mo.prototype.raycast.call(this,t,e),this.localGeometry=i}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let t=this.originalGeometry;t.boundingSphere===null&&(t.boundingSphere=new sa,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=t.boundingSphere));let e=t.attributes.position,i=t.boundingSphere.center;hc.setFromBufferAttribute(e),hc.getCenter(i),t.boundingSphere.radius=i.distanceTo(hc.max),isNaN(t.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),hc.getSize(Nx),this.hasNonUniformScale&&Nx.divide(this.scale);let n={width:Nx.x,height:Nx.y,depth:Nx.z};return this.geometry.userData.parameters=n,n}updateBoundingSphere(t){let e=this.originalGeometry;hc.min.set(t[0],t[2],t[4]),hc.max.set(t[1],t[3],t[5]),this.hasNonUniformScale&&(hc.min.applyMatrix4(this.shearScaleInv),hc.max.applyMatrix4(this.shearScaleInv)),e.boundingSphere===null&&(e.boundingSphere=new sa);let i=e.boundingSphere.center;hc.getCenter(i),e.boundingSphere.radius=i.distanceTo(hc.max)}freeSubdivPointer(){var t,e;this.subdivPointer&&(ks.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,(t=this.originalGeometry)==null||t.dispose(),(e=this.subdividedGeometry)==null||e.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(t,e,i){super.updateByPatchedOpGeometry(t,e,i),this.localGeometry&&this.createGeometryByControls(e)}},u7=-1,tGe=1,iGe={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},nGe={polygon_center:0,edge:1,vertex:2},ZA=(t,e)=>(i,n)=>!e||i===0||t===0?0:t*n/100,Yt=(t,e)=>{let i=Math.abs(e),n=i*-1;return(t-u7)*(i-n)/(tGe-u7)+n};function rGe(t){let e=[],i={};for(var n=0,r=t.length;n<r;n++){var s=JSON.stringify(t[n].pos.map(o=>Math.round(o*1e4)/1e4));i[s]||(e.push(t[n]),i[s]=!0)}return e}var sGe=new L,$A=new L,oGe=new L,aGe=new L;function i0(t,e){let i=oGe.fromArray(t),n=aGe.fromArray(e);$A.copy(n).sub(i);let r=$A.length();return $A.normalize().multiplyScalar(r*.5),sGe.copy(i).add($A).toArray()}var Ua=new xs,eM=new L,UT=new L,up=new L;function lGe(t){let e=[];for(let i=0;i<=t.index.count;i++)if(eM.fromArray(t.index.array,i*3),Ua.setFromAttributeAndIndices(t.attributes.position,eM.x,eM.y,eM.z),Ua.getNormal(UT),Ua.getMidpoint(up),!(isNaN(up.x)||isNaN(up.y)||isNaN(up.z))){let{a:n,b:r,c:s}=Ua,o=n.toArray(),a=r.toArray(),l=s.toArray(),c=n.distanceTo(r),h=r.distanceTo(s),u=s.distanceTo(n),d=i0(o,a),f=i0(a,l),p=i0(l,o),m=[c,h,u],v=Math.max(...m),g=m.filter(b=>Math.round(b)===Math.round(v)).length>1,y=[],x=Ua.getMidpoint(up).toArray();v===c&&!g&&(y=[f,p,p],x=d),v===h&&!g&&(y=[d,p,p],x=f),v===u&&!g&&(y=[d,f,f],x=p),g&&(y=[d,f,p]),e.push({vertices:[o,a,l],faceCenters:y,midpoint:x,norm:Ua.getNormal(UT).toArray()})}return e}function cGe(t){let e=[],{position:i}=t.attributes;for(let n=0;n<i.count;n++){Ua.setFromAttributeAndIndices(i,n*3,n*3+1,n*3+2),Ua.getNormal(UT),Ua.getMidpoint(up);let r=Ua.a.toArray(),s=Ua.b.toArray(),o=Ua.c.toArray();e.push({vertices:[r,s,o],faceCenters:[i0(r,s),i0(s,o),i0(o,r)],midpoint:up.toArray(),norm:UT.toArray()})}return e}var uGe=4,hGe=.5,B3=t=>.5*(1-Math.cos(t*Math.PI)),dGe=class{constructor(){this.perlin=new Array(4095+1)}noise(t,e=0,i=0){if(this.perlin==null){this.perlin=new Array(4095+1);for(let v=0;v<4095+1;v++)this.perlin[v]=Math.random()}t<0&&(t=-t),e<0&&(e=-e),i<0&&(i=-i);let n=Math.floor(t),r=Math.floor(e),s=Math.floor(i),o=t-n,a=e-r,l=i-s,c,h,u=0,d=.5,f,p,m;for(let v=0;v<uGe;v++){let g=n+(r<<4)+(s<<8);c=B3(o),h=B3(a),f=this.perlin[g&4095],f+=c*(this.perlin[g+1&4095]-f),p=this.perlin[g+16&4095],p+=c*(this.perlin[g+16+1&4095]-p),f+=h*(p-f),g+=256,p=this.perlin[g&4095],p+=c*(this.perlin[g+1&4095]-p),m=this.perlin[g+16&4095],m+=c*(this.perlin[g+16+1&4095]-m),p+=h*(m-p),f+=B3(l)*(p-f),u+=f*d,d*=hGe,n<<=1,o*=2,r<<=1,a*=2,s<<=1,l*=2,o>=1&&(n++,o--),a>=1&&(r++,a--),l>=1&&(s++,l--)}return u}noiseSeed(t){let e=(()=>{let i,n;return{setSeed(r){n=i=(r??Math.random()*4294967296)>>>0},getSeed(){return i},rand(){return n=(1664525*n+1013904223)%4294967296,n/4294967296}}})();e.setSeed(t),this.perlin=new Array(4095+1);for(let i=0;i<4095+1;i++)this.perlin[i]=e.rand()}},fGe=dGe,h7=new L,d7=new $e,f7=new ay;function p7(t){let e=!1;return t.scene.objects.traverse((i,n)=>{n.type==="Mesh"&&n.geometry.type==="TextGeometry"&&(e=!0)}),e}var Ine=class extends bo{constructor(t,e,i){super(t,e,i),this.data=e}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var e;let t=this.dataPatched;return((e=this.font)==null?void 0:e.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,t.geometry.height,this.fontScale,t.geometry.verticalAlign))??0}get fontScale(){let t=this.dataPatched;return this.font?t.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var t;return(((t=this.font)==null?void 0:t.ascender)??1)*this.fontScale}get descender(){var t;return(((t=this.font)==null?void 0:t.descender)??1)*this.fontScale}get lineHeight(){let t=this.dataPatched;return t.geometry.fontSize*t.geometry.lineHeight}raycast(t,e){let{matrixWorld:i}=this;if(!(isNaN(t.ray.origin.x)||this.scale.x===0||this.scale.y===0||this.scale.z===0)&&(d7.copy(i).invert(),f7.copy(t.ray).applyMatrix4(d7),f7.intersectBox(this.singleBBox,h7))){let n=h7.applyMatrix4(i),r=t.ray.origin.distanceTo(n);e.push({distance:r,point:n.clone(),object:this})}}},Ls=1e-4,dc,Lne,Bne,One,m7=new L,g7=new L;oz.then(t=>{dc=t,Lne=[dc.get_face_center,dc.get_edge_midpoint,dc.get_vertex_position],Bne=[dc.get_face_normal,dc.get_edge_normal,dc.get_vertex_normal],One=[dc.face_count,dc.edge_count,dc.vertex_count]});var pGe=new $e,mGe=new $e,Vh=new L,jf=new L,Ux=new L,O3=new L,gGe=new L,vGe=new L,Su=new fGe,Pl=class extends $k(ji){constructor(t,e){super(),this.parameters=e,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.object=t}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(t){if(this.parent===null)this.updateState(this.parameters,t);else for(let e of this.children)e instanceof _s&&e.expand()}invalidateTransform(t){this.matrixWorldNeedsUpdate=!0,this.traverse(e=>{e instanceof _s&&e.object===t&&(e.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){this.parameters.type!=="toObject"&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let t of this.children)t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD())}_updateCount(t){let e;if(t!==void 0?e=t:e=this.parameters.type==="grid"?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,this.parameters.type==="toObject"&&!this.parameters.toObject.object&&(e=0),this.parameters.type==="toObject"&&this.objectForSample){for(let n=0,r=this.children.length;n<r;++n)this.remove(this.children[0]);let i=this.children;if(i.length===e)return;if(i.length<e)for(let n=0,r=e-i.length;n<r;++n){let s=new _s(this.object);s.expand(),this.add(s)}else for(let n=0,r=i.length-e;n<r;++n)this.remove(i[n])}else{if(this.children.length===e)return;if(this.children.length<e)for(let i=0,n=e-this.children.length;i<n;++i){let r=new _s(this.object);r.expand(),this.add(r)}else for(let i=0,n=this.children.length-e;i<n;++i)this.remove(this.children[0])}}_updateRadial(t){let e=t.radial,i=e.start*hi.DEG2RAD,n=e.end*hi.DEG2RAD,r=i-n,s=new Nr(e.rotation[0],e.rotation[1],e.rotation[2]),o;switch(e.axis){case"z":o=new L(0,0,1);break;case"y":o=new L(0,1,0);break;default:case"x":o=new L(1,0,0);break}let a=t.randomnessObject??vd.defaultData([1,1,1]).randomnessObject,l=a.noiseType==="perlin";Su.noiseSeed(a.seed);let c=y3((0,Rx.default)(a.seed)),h=ZA(a.strength,this.parameters.randomness);for(let[u,d]of this.children.entries()){let f=u*(a.freqScale/10)+a.movement,p=l?Su.noise(f):c(f,f),m=u+1;d.scale.x=e.scale[0]+h(m,Yt(p,a.scale[0]))||Ls,d.scale.y=e.scale[1]+h(m,Yt(p,a.scale[1]))||Ls,d.scale.z=e.scale[2]+h(m,Yt(p,a.scale[2]))||Ls,d.position.setScalar(0);let v=r/t.count*u-i;switch(e.axis){case"x":d.rotation.set(0,v,0);break;case"y":d.rotation.set(0,0,v);break;case"z":d.rotation.set(v,0,0);break}d.translateOnAxis(o,e.radius),d.position.x+=e.position[0]+h(m,Yt(p,a.position[0])),d.position.y+=e.position[1]+h(m,Yt(p,a.position[1])),d.position.z+=e.position[2]+h(m,Yt(p,a.position[2]));let g=h(m,Yt(p,a.rotation[0])),y=h(m,Yt(p,a.rotation[1])),x=h(m,Yt(p,a.rotation[2]));e.alignment===!0?(d.rotation.x+=s.x+g,d.rotation.y+=s.y+y,d.rotation.z+=s.z+x):d.rotation.set(s.x+g,s.y+y,s.z+x)}}_updateLinear(t){if(t.type!=="linear")throw new Error;let e=t.linear,i=new Nr(e.rotation[0],e.rotation[1],e.rotation[2]),n=t.randomnessObject??vd.defaultData([1,1,1]).randomnessObject,r=n.noiseType==="perlin";Su.noiseSeed(n.seed);let s=y3((0,Rx.default)(n.seed)),o=ZA(n.strength,this.parameters.randomness);for(let[a,l]of this.children.entries()){let c=a*(n.freqScale/10)+n.movement,h=r?Su.noise(c):s(c,c),u=a+1,d=o(u,Yt(h,n.rotation[0])),f=o(u,Yt(h,n.rotation[1])),p=o(u,Yt(h,n.rotation[2]));l.scale.x=1+(e.scale[0]-1)*a+o(u,Yt(h,n.scale[0]))||Ls,l.scale.y=1+(e.scale[1]-1)*a+o(u,Yt(h,n.scale[1]))||Ls,l.scale.z=1+(e.scale[2]-1)*a+o(u,Yt(h,n.scale[2]))||Ls,l.rotation.x=i.x*a+d,l.rotation.y=i.y*a+f,l.rotation.z=i.z*a+p,l.position.x=e.position[0]*a+o(u,Yt(h,n.position[0])),l.position.y=e.position[1]*a+o(u,Yt(h,n.position[1])),l.position.z=e.position[2]*a+o(u,Yt(h,n.position[2]))}}_updateGrid(t){let e=0,i=t.grid,n=t.randomnessObject??vd.defaultData([1,1,1]).randomnessObject,r=ZA(n.strength,this.parameters.randomness),s=n.noiseType==="perlin";Su.noiseSeed(n.seed);let o=lke((0,Rx.default)(n.seed));if(i.useCenter===!0){let a={x:i.count[0]%2===0?2:1,y:i.count[1]%2===0?2:1,z:i.count[2]%2===0?2:1},l=new L(i.size[0]*(i.count[0]-a.x)*.5,i.size[1]*(i.count[1]-a.y)*.5,i.size[2]*(i.count[2]-a.z)*.5);for(let c=0;c<i.count[0];c++)for(let h=0;h<i.count[1];h++)for(let u=0;u<i.count[2];u++){let d=[(c+1)*(n.freqScale/10)+n.movement,(h+1)*(n.freqScale/10)+n.movement,(u+1)*(n.freqScale/10)+n.movement],f=s?Su.noise(...d):o(...d),p=this.children[e++];p.scale.x=1+r(e,Yt(f,n.scale[0]))||Ls,p.scale.y=1+r(e,Yt(f,n.scale[1]))||Ls,p.scale.z=1+r(e,Yt(f,n.scale[2]))||Ls;let m=r(e,Yt(f,n.rotation[0])),v=r(e,Yt(f,n.rotation[1])),g=r(e,Yt(f,n.rotation[2]));p.rotation.set(m,v,g),p.position.x=i.size[0]*c-l.x+r(e,Yt(f,n.position[0])),p.position.y=i.size[1]*h-l.y+r(e,Yt(f,n.position[1])),p.position.z=i.size[2]*u-l.z+r(e,Yt(f,n.position[2]))}}else for(let a=0;a<i.count[0];a++)for(let l=0;l<i.count[1];l++)for(let c=0;c<i.count[2];c++){let h=[(a+1)*(n.freqScale/10)+n.movement,(l+1)*(n.freqScale/10)+n.movement,(c+1)*(n.freqScale/10)+n.movement],u=s?Su.noise(...h):o(...h),d=this.children[e++];d.scale.x=1+r(e,Yt(u,n.scale[0]))||Ls,d.scale.y=1+r(e,Yt(u,n.scale[1]))||Ls,d.scale.z=1+r(e,Yt(u,n.scale[2]))||Ls;let f=r(e,Yt(u,n.rotation[0])),p=r(e,Yt(u,n.rotation[1])),m=r(e,Yt(u,n.rotation[2]));d.rotation.set(f,p,m),d.position.x=i.size[0]*a+r(e,Yt(u,n.position[0])),d.position.y=-i.size[1]*l+r(e,Yt(u,n.position[1])),d.position.z=-i.size[2]*c+r(e,Yt(u,n.position[2]))}}_updateToObject(t){var m;if(t.type!=="toObject")throw new Error;let{toObject:e}=t,i=new Nr(e.rotation[0],e.rotation[1],e.rotation[2]),n=t.randomnessObject??vd.defaultData([1,1,1]).randomnessObject,r=n.noiseType==="perlin";Su.noiseSeed(n.seed);let s=y3((0,Rx.default)(n.seed)),o=ZA(n.strength,this.parameters.randomness);if(!e.object){for(let[,v]of this.children.entries())v.position.set(0,0,0),v.scale.setScalar(1),v.rotation.set(0,0,0);this.objectForSample=void 0;return}if(!this.objectForSample)return;if(this.objectForSample instanceof Ine)if(!((m=this.objectForSample.font)!=null&&m.isLoaded)||this.objectForSample.geometry.attributes.position===void 0){this._pendingMediaLoad=!0;return}else this._pendingMediaLoad=!1;if(this.objectForSample.geometry===void 0&&this.objectForSample.isAncestorOf(this.object.uuid)){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);return}let a=this.getSubdivData(),l=[],c=v=>{let g=v.length,y=v.map(S=>S[0]).reduce((S,A)=>S+A,0),x=v.map(S=>S[1]).reduce((S,A)=>S+A,0),b=v.map(S=>S[2]).reduce((S,A)=>S+A,0);return[y/g,x/g,b/g]},h=v=>Math.round(v*1e6)/1e6;a.forEach(v=>{let g=a.filter(y=>h(v.pos[0])===h(y.pos[0])&&h(v.pos[1])===h(y.pos[1])&&h(v.pos[2])===h(y.pos[2]));g.length>1?l.push({pos:v.pos,norm:c(g.map(y=>y.norm))}):l.push(v)});let u=rGe(l);if(a.length>0){let v=Math.round(u.length*e.count/100);this._updateCount(v)}this.objectForSample.updateMatrixWorld();let d=new cke(this.objectForSample).build(),f=iGe[e.axis],p=this.children;d.setRandomGenerator((0,Rx.default)(this.object.uuid+e.seed));for(let[v,g]of p.entries()){let y=v*(n.freqScale/10)+n.movement,x=r?Su.noise(y):s(y,y),b=v+1,S=o(b,Yt(x,n.rotation[0])),A=o(b,Yt(x,n.rotation[1])),E=o(b,Yt(x,n.rotation[2]));e.spreadType==="random"?d.sample(Ux,O3):(u.length&&(Ux.fromArray(u[v].pos),O3.fromArray(u[v].norm)),this.objectForSample instanceof iw&&Ux.applyMatrix4(pGe.copy(this.objectForSample.matrixWorld).invert())),Ux.applyMatrix4(this.object.hiddenMatrix.clone().invert()),g.position.copy(Ux),Vh.fromArray(f);let M=e.align==="normal"?O3:this.object.getWorldDirection(vGe),T=jf.fromArray(e.position);jf.x+=jf.x+o(b,Yt(x,n.position[0])),jf.y+=jf.y+o(b,Yt(x,n.position[1])),jf.z+=jf.z+o(b,Yt(x,n.position[2]));let P=Math.acos(M.dot(Vh)),R=gGe.crossVectors(Vh,M).normalize(),U=mGe.makeRotationAxis(R,P),F=M.clone().cross(this.object.up).normalize(),N=F.clone().cross(M).normalize(),W=new $e().makeBasis(F,M,N),Q=new L(Vh.y,Vh.z,Vh.x).normalize(),X=Q.clone().cross(Vh).normalize(),B=new $e().makeBasis(Q,Vh,X).invert(),j=new $e().multiplyMatrices(W,B);g.rotation.setFromRotationMatrix(j),T.applyMatrix4(U),g.position.add(T),g.rotation.x=g.rotation.x+i.x+S,g.rotation.y=g.rotation.y+i.y+A,g.rotation.z=g.rotation.z+i.z+E,g.scale.setScalar(1),g.scale.x=g.scale.x+e.scale[0]+o(b,Yt(x,n.scale[0]))||Ls,g.scale.y=g.scale.y+e.scale[1]+o(b,Yt(x,n.scale[1]))||Ls,g.scale.z=g.scale.z+e.scale[2]+o(b,Yt(x,n.scale[2]))||Ls,g.scale.multiply(this.object.scale),g.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let t=this.parameters.toObject.spreadType;if(t==="random")return[];if(this.objectForSample instanceof iw){let e=this.objectForSample,i=nGe[t],n=One[i],r=Lne[i],s=Bne[i],o=[],a=n(e.subdivPointerNew);for(let l=0;l<=a-1;l++){let c=r(e.subdivPointerNew,l),h=s(e.subdivPointerNew,l);m7.fromArray(c).applyMatrix4(e.matrixWorld),g7.fromArray(h),o.push({pos:m7.toArray(),norm:g7.toArray()})}return o}else return(this.objectForSample.geometry.index?lGe(this.objectForSample.geometry):cGe(this.objectForSample.geometry)).map((e,i)=>t==="polygon_center"?{pos:e.midpoint,norm:e.norm}:t==="vertex"?[{pos:e.vertices[0],norm:e.norm},{pos:e.vertices[1],norm:e.norm},{pos:e.vertices[2],norm:e.norm}]:t==="edge"?[{pos:e.faceCenters[0],norm:e.norm},{pos:e.faceCenters[1],norm:e.norm},{pos:e.faceCenters[2],norm:e.norm}]:[]).flat()}updateState(t,e){var i;if(this.parameters=c2(t),this.parameters.type!=="toObject")(this.parent===null||this.parent!==this.object)&&(this.removeFromParent(),(i=this.object.parent)==null||i.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(this.parent===null||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let n=e.find(this.parameters.toObject.object);n instanceof Mo?this.objectForSample=n:this.objectForSample=void 0,this.matrix=new $e,this.hiddenMatrix=new $e,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,n&&n.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},kw=t=>{var e;return e=class extends t{},e.geometryHelper=new Qc(30,30,30),e},tM=new ay,F3=new sa,v7=new $e,zw=(t,e,i,n,r=!1)=>{let s=e,o=t.matrixWorld;if(s.boundingSphere===null&&s.computeBoundingSphere(),F3.copy(s.boundingSphere),F3.applyMatrix4(o),i.ray.intersectsSphere(F3)===!1||(v7.copy(o).invert(),tM.copy(i.ray).applyMatrix4(v7),s.boundingBox!==null&&tM.intersectsBox(s.boundingBox)===!1))return;let a,l,c,h,u=s.index,d=s.attributes.position,f=s.drawRange,p,m;if(r===!1){let g=Math.max(0,f.start),y=Math.min(u.count,f.start+f.count);for(p=g,m=y;p<m;p+=3)if(l=u.getX(p),c=u.getX(p+1),h=u.getX(p+2),a=v(t,i,tM,d,l,c,h),a){a.faceIndex=Math.floor(p/3),n.push(a);return}}else{let g=s.attributes.position,y=new L,x=new L,b=new L,S=new L,A=2,E=1/((t.scale.x+t.scale.y+t.scale.z)/3),M=E*E,T=Math.max(0,f.start),P=Math.min(g.count,f.start+f.count);for(let R=T,U=P-1;R<U;R+=A){if(y.fromBufferAttribute(g,R),x.fromBufferAttribute(g,R+1),tM.distanceSqToSegment(y,x,S,b)>M)continue;S.applyMatrix4(t.matrixWorld);let F=i.ray.origin.distanceTo(S);F<i.near||F>i.far||n.push({distance:F,point:b.clone().applyMatrix4(t.matrixWorld),object:t})}}function v(g,y,x,b,S,A,E){let M=new L,T=new L,P=new L,R=new L,U=new L;if(M.fromBufferAttribute(b,S),T.fromBufferAttribute(b,A),P.fromBufferAttribute(b,E),x.intersectTriangle(M,T,P,!1,R)===null)return null;U.copy(R),U.applyMatrix4(g.matrixWorld);let F=y.ray.origin.distanceTo(U);return F<y.near||F>y.far?null:{faceIndex:1,distance:F,point:U.clone(),object:g}}},iM=new L,Sa=new uy,yGe=class extends Bw{constructor(t){let e=new Ut,i=new ff({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],r=[],s={},o=new It(15711266),a=new It(15711266),l=new It(2857471);c("n1","n2",o),c("n2","n4",o),c("n4","n3",o),c("n3","n1",o),c("f1","f2",o),c("f2","f4",o),c("f4","f3",o),c("f3","f1",o),c("n1","f1",o),c("n2","f2",o),c("n3","f3",o),c("n4","f4",o),c("p","n1",a),c("p","n2",a),c("p","n3",a),c("p","n4",a),c("u1","u2",l),c("u2","u3",l),c("u3","u1",l);function c(u,d,f){h(u,f),h(d,f)}function h(u,d){n.push(0,0,0),r.push(d.r,d.g,d.b),s[u]===void 0&&(s[u]=[]),s[u].push(n.length/3-1)}e.setAttribute("position",new yt(n,3)),e.setAttribute("color",new yt(r,3)),super(e,i),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let t=this.geometry,e=this.pointMap;Sa.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let i=1,n=1,r=.8;gl("n1",e,t,Sa,-i,-n,r),gl("n2",e,t,Sa,i,-n,r),gl("n3",e,t,Sa,-i,n,r),gl("n4",e,t,Sa,i,n,r);let s=r;gl("f1",e,t,Sa,-i,-n,s),gl("f2",e,t,Sa,i,-n,s),gl("f3",e,t,Sa,-i,n,s),gl("f4",e,t,Sa,i,n,s);let o=s,a=.5;gl("u1",e,t,Sa,i*.7*a,n*1.1,o),gl("u2",e,t,Sa,-i*.7*a,n*1.1,o),gl("u3",e,t,Sa,0,n*(1.1+.9*a),o),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function gl(t,e,i,n,r,s,o){iM.set(r,s,o).unproject(n);let a=e[t];if(a!==void 0){let l=i.getAttribute("position");for(let c=0,h=a.length;c<h;c++)l.setXYZ(a[c],iM.x,iM.y,iM.z)}}var xGe=class extends kw(yGe){constructor(t){super(t),this.object=t,this.object=t,this.name=`CombinedCameraHelper: ${t.uuid}`}updateMatrixWorld(t){super.updateMatrixWorld(t),this.updateTarget()}updateTarget(){let t=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(t)}raycast(t,e){zw(this.object,this.geometry,t,e,!0)}},YO;(t=>t.is=e=>"objectHelper"in e)(YO||(YO={}));var Gw=(t,e)=>class extends ez(t){constructor(){super(...arguments),this.objectHelper=new e(this),this.gizmos={}}get geometryHelper(){return e.geometryHelper}raycast(i,n){this.objectHelper.raycast(i,n)}showGizmos(){for(let i in this.gizmos){let n=this.gizmos[i];n instanceof lT&&(n.visible=!0)}}updateEntityBoxSize(i,n){this.objectHelper.visible&&this.geometryHelper instanceof Qc?(i.setScalar(0),n.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(i,n)}hideGizmos(){for(let i in this.gizmos){let n=this.gizmos[i];n instanceof lT&&(n.visible=!1)}}},nM=790,Ng=new L,N3=new L,U3=new Zt,k3=new L,kx=new L,z3=new L,js=class extends Gw(uy,xGe){constructor(t="",e={...K_.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=j0.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(t,e),this.previousProjectionMatrix=new $e,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let i=this.width,n=this.height;this.orthoCamera=new hk(i*-.5,i*.5,n*.5,n*-.5,-5e4,1e4),this.perspCamera=new vs(45,i/n,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(t){this.perspCamera.fov=t}get fov(){return this.perspCamera.fov}setNear(t,e){t==="PerspectiveCamera"?this.perspCamera.near=e:this.orthoCamera.near=e}setZoom(t,e){e>=0&&(t==="PerspectiveCamera"?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}set cameraType(t){t==="PerspectiveCamera"?this.toPerspective():t==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(t){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=t:this.orthoCamera.near=t}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(t){t>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}lookAt(t,e,i){typeof t=="number"&&(t=new L(t,e,i)),super.lookAt(t),this.getWorldPosition(Ng),this.targetOffset=Ng.distanceTo(t)}getTarget(t=new L){return this.getWorldDirection(N3),this.getWorldPosition(Ng),N3.multiplyScalar(this.targetOffset),t.copy(Ng).add(N3),t}getDistanceToTarget(){let t=this.getTarget();return this.getWorldPosition(Ng),Ng.distanceTo(t)}updateUp(){this.getWorldQuaternion(U3),k3.set(0,0,1).applyQuaternion(U3),kx.copy(ji.DEFAULT_UP),this.isUpVectorFlipped&&kx.negate(),kx.applyQuaternion(U3),z3.copy(ji.DEFAULT_UP).projectOnPlane(k3),this.angleOffsetFromUp=z3.angleTo(kx),this.angleOffsetFromUp*=z3.cross(kx).dot(k3)>=0?1:-1}updateTransformState(t){let e=super.updateTransformState(t);return t.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=t.isUpVectorFlipped),this.updateUp(),e}getViewFrontToObject(t){let e=t.getWorldPosition(new L),i=t.getWorldDirection(new L).multiplyScalar(this.targetOffset);return{position:e.clone().add(i),target:e}}getViewToTarget(t){let e=this.getWorldDirection(new L).multiplyScalar(this.targetOffset);return{position:t.clone().sub(e),target:t}}getViewToObject(t){let e=new L;return t.getWorldPosition(e),this.getViewToTarget(e)}setViewplaneSize(t,e,i=!1){if(this.aspect=t/e,i){let n=t>e?this.aspect:1,r=t>e?1:this.aspect;this.left=-nM*.5*n,this.right=nM*.5*n,this.top=nM*.5*(1/r),this.bottom=-nM*.5*(1/r)}else this.left=-t*.5,this.right=t*.5,this.top=e*.5,this.bottom=-e*.5;this.updateProjectionMatrix()}copyViewPlaneSize(t){this.aspect=t.aspect,this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(t){this.perspCamera.setFocalLength(t),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(t,e,i,n,r,s){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(t,e,i,n,r,s):this.orthoCamera.setViewOffset(t,e,i,n,r,s)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){this._cameraType==="PerspectiveCamera"?this.toPerspective():this._cameraType==="OrthographicCamera"&&this.toOrthographic()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(t,e){return super.copy(t,e),this.parent=t.parent,this.orthoCamera.copy(t.orthoCamera),this.perspCamera.copy(t.perspCamera),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.far=t.far,this.view=t.view===null?null:Object.assign({},t.view),this._cameraType=t._cameraType,this.aspect=t.aspect,this.fov=t.fov,this.focus=t.focus,this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this.targetOffset=t.targetOffset,this.updateProjectionMatrix(),this}toCameraState(t=[]){let e={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return eO(e,t)}updateCameraSubtype(t,e){let i=t==="perspective"?"PerspectiveCamera":"OrthographicCamera";e.zoom!==void 0&&this.setZoom(i,e.zoom),e.near!==void 0&&this.setNear(i,e.near),e.fov!==void 0&&i==="PerspectiveCamera"&&(this.fov=e.fov)}updateState(t,e){this.updateCameraState(t,e)}updateCameraState(t,e){this.updateState_Entity(t,e),t.far!==void 0&&(this.far=t.far),t.orthographic!==void 0&&this.updateCameraSubtype("orthographic",t.orthographic),t.perspective!==void 0&&this.updateCameraSubtype("perspective",t.perspective),t.type!==void 0&&(this.cameraType=t.type),t.up!==void 0&&this.up.fromArray(t.up),t.targetOffset!==void 0&&(this.targetOffset=t.targetOffset),t.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=t.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(t,e,i){super.updateByPatchedOp(t,e,i),t.path.length===1&&t.type===0&&this.updateCameraSubtype(t.path[0],t.props)}toState(t){return{...super.toState(t),...this.toCameraState(t),type:this.cameraType}}},Ug=new $e,_Ge=new $e;function y7(t){let e=!1;return t.scene.objects.traverse((i,n)=>{var r;((r=n.geometry)==null?void 0:r.type)==="BooleanGeometry"&&(e=!0)}),e}var K0=class extends Sy{constructor(t,e,i){super(t,e),this.data=e,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new Ut,this.onAfterRender=(n,r,s,o,a,l)=>{super.onAfterRender(n,r,s,o,a,l),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(t,e,i){super.updateByPatchedOp(t,e,i),t.path.length===1&&t.path[0]==="geometry"&&t.type===0&&t.props.operation!==void 0&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(t,e=!0){var n;if(this.booleanMeshSetAddress!==-1&&!t)return;for(let r=0;r<this.children.length;r++){let s=this.children[r];s instanceof K0&&s.dataPatched.visible===!0&&s.recomputeBoolean(t===!0,e)}this.meshSetAddresses=[];for(let r=0;r<this.children.length;r++){let s=this.children[r];if(s instanceof Mo&&s.dataPatched.visible===!0&&((n=s.geometry.attributes.position)==null?void 0:n.count)>0&&s.geometry.drawRange.count>0){if(Ug.multiplyMatrices(s.hiddenMatrix,s.matrix),s.booleanMeshSetAddress===-1){if((s.geometry.index??s.geometry.getAttribute("position")).count/3<15e5&&(s.booleanMeshSetAddress=Ou.getMeshSet(s.geometry,t===!0,e)),s.booleanMeshSetAddress===-1)return;Ou.transformMeshSet(s.booleanMeshSetAddress,Ug),s.booleanMatrixInvOld.copy(Ug).invert(),s.booleanWasTransformed=!1}else s instanceof K0&&s.needsTransformForDownstream===!0?(Ou.transformMeshSet(s.booleanMeshSetAddress,Ug),s.needsTransformForDownstream=!1):s.booleanWasTransformed===!0&&(Ou.transformMeshSet(s.booleanMeshSetAddress,_Ge.multiplyMatrices(Ug,s.booleanMatrixInvOld)),s.booleanMatrixInvOld.copy(Ug).invert(),s.booleanWasTransformed=!1);Ou.hasOpenEdges(s.booleanMeshSetAddress)===!1||r===this.children.length-1&&this.booleanOp===2?(this.meshSetAddresses.push(s.booleanMeshSetAddress),s.geometry.userData.wasFilteredFromBoolean=!1):s.geometry.userData.wasFilteredFromBoolean=!0}}if(this.meshSetAddresses.length===0){this.geometry.setAttribute("position",new yt([],0)),this.geometry.setDrawRange(0,0);return}if(t===!0)return Ou.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let i=this.geometry;i.dispose(),this.geometry=new Ut,this.geometry.userData=i.userData,this.geometry.boundingSphere=i.boundingSphere;try{this.booleanMeshSetAddress=Ou.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(r){this.booleanMeshSetAddress=0,console.error(r)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,fz(this),pz(this)}dispose(){super.dispose(),this.geometry.dispose()}},QO;(t=>{function e(i){return xi.is(i)&&i instanceof Fw}t.is=e})(QO||(QO={}));var mz=(t,e)=>class extends Gw(t,e){updateState_Light(i,n){this.updateState_Entity(i,n),i.color!==void 0&&(this.color=n.shared.color(i.color)),i.intensity!==void 0&&(this.intensity=i.intensity),i.depth!==void 0&&(this.shadow.camera.far=i.depth,this.shadow.needsUpdate=!0),i.shadows!==void 0&&(this.castShadow=i.shadows)}},Ml=t=>t instanceof Mo,Ju=t=>t!==null&&t instanceof K0,wGe=t=>t instanceof js,bGe=t=>QO.is(t),KO=t=>YO.is(t),y2=class extends kw(qPe){constructor(t,e=15){super(e),this.object=t,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${t.uuid}`,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(t,e){zw(this.object,y2.geometryHelper,t,e)}update(){}},kT=class extends Gw(Ev,y2){constructor(t,e){super(),this.super_Entity(t,e),this.objectHelper.update()}updateState(t,e){this.updateState_Entity(t,e)}},SGe=t=>`

// PCSS implementation based on:
// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/
// NOTE: This number affects how big the shadow blur can
// possibly get. Bigger number == bigger blur, but less precise results

const float  gPenumbraFilterSize = 80.0;
const int   gPenumbraSamples = ${t};
const int gShadowSamples = ${t};
const float gShadowSamplesRpc = 1.0f / float(gShadowSamples);

#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0

        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

        struct DirectionalLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

    #endif

    #if NUM_SPOT_LIGHT_SHADOWS > 0

        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];

        struct SpotLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

    #endif

    #if NUM_POINT_LIGHT_SHADOWS > 0

        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

        struct PointLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
            float shadowCameraNear;
            float shadowCameraFar;
        };

        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

    #endif

    /*
    #if NUM_RECT_AREA_LIGHTS > 0

        // TODO (abelnation): create uniforms for area light shadows

    #endif
    */

float computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)
{
    float penumbra = 1.0;
    float blockerDepthAvg = 0.0;
    float blockerCount = 0.0;

    #pragma unroll_loop_start
    for(int i = 0; i < gPenumbraSamples; i ++)
    {
        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;
        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );

        if(depth < compare + 0.0001)
        {
            blockerDepthAvg += depth;
            blockerCount++;
        }
    }
    #pragma unroll_loop_end

    if (blockerCount > 0.0)
    {
        blockerDepthAvg /= blockerCount;

        // Compute penumbra
        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);
        penumbra *= penumbra;
        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows

        return clamp(penumbra, 0.00, 1.0);
    }
    return 0.0;
}

float vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)
{
    float shadow         = 0.0f;

    // NOTE: When using TAA, we should use screen space interleaved gradient noise
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);
    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);
    if (penumbra == -1.0) {
        return 1.0;
    }

    #pragma unroll_loop_start
    for (int i = 0; i < gShadowSamples; i++)
    {
        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;
        // Overall blurring offset
        vec2 offset = vogelSample * (shadowRadius * 2.);

        // Penumbra offset
        offset += vogelSample * (penumbra * texelScalar);

        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    }
    #pragma unroll_loop_end

    return shadow * gShadowSamplesRpc;
}


    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

    }

    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

        return unpackRGBATo2Half( texture2D( shadow, uv ) );

    }

    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

        float occlusion = 1.0;

        vec2 distribution = texture2DDistribution( shadow, uv );

        float hard_shadow = step( compare , distribution.x ); // Hard Shadow

        if (hard_shadow != 1.0 ) {

            float distance = compare - distribution.x ;
            float variance = max( 0.00000, distribution.y * distribution.y );
            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

        }
        return occlusion;

    }

    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

        float shadow = 1.0;

        shadowCoord.xyz /= shadowCoord.w;
        shadowCoord.z += shadowBias;

        // if ( something && something ) breaks ATI OpenGL shader compiler
        // if ( all( something, something ) ) using this instead

        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
        bool inFrustum = all( inFrustumVec );

        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

        bool frustumTest = all( frustumTestVec );

        if ( frustumTest ) {

        #if defined( SHADOWMAP_TYPE_PCF )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            float dx = texelSize.x;
            float dy = texelSize.y;

            vec2 uv = shadowCoord.xy;
            vec2 f = fract( uv * shadowMapSize + 0.5 );
            uv -= f * texelSize;

            shadow = (
                texture2DCompare( shadowMap, uv, shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
                          f.x ),
                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
                          f.x ),
                     f.y )
            ) * ( 1.0 / 9.0 );

        #elif defined( SHADOWMAP_TYPE_VSM )

            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

        #else // no percentage-closer filtering:

            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

        #endif

        }

        return shadow;

    }

    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
    // vector suitable for 2D texture mapping. This code uses the following layout for the
    // 2D texture:
    //
    // xzXZ
    //  y Y
    //
    // Y - Positive y direction
    // y - Negative y direction
    // X - Positive x direction
    // x - Negative x direction
    // Z - Positive z direction
    // z - Negative z direction
    //
    // Source and test bed:
    // https://gist.github.com/tschw/da10c43c467ce8afd0c4

    vec2 cubeToUV( vec3 v, float texelSizeY ) {

        // Number of texels to avoid at the edge of each square

        vec3 absV = abs( v );

        // Intersect unit cube

        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
        absV *= scaleToCube;

        // Apply scale to avoid seams

        // two texels less per square (one texel will do for NEAREST)
        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

        // Unwrap

        // space: -1 ... 1 range for each square
        //
        // #X##         dim    := ( 4 , 2 )
        //  # #         center := ( 1 , 1 )

        vec2 planar = v.xy;

        float almostATexel = 1.5 * texelSizeY;
        float almostOne = 1.0 - almostATexel;

        if ( absV.z >= almostOne ) {

            if ( v.z > 0.0 )
                planar.x = 4.0 - v.x;

        } else if ( absV.x >= almostOne ) {

            float signX = sign( v.x );
            planar.x = v.z * signX + 2.0 * signX;

        } else if ( absV.y >= almostOne ) {

            float signY = sign( v.y );
            planar.x = v.x + 2.0 * signY + 2.0;
            planar.y = v.z * signY - 2.0;

        }

        // Transform to UV space

        // scale := 0.5 / dim
        // translate := ( center + 0.5 ) / dim
        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

    }

    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

        float shadow = 1.0;
        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

        // for point lights, the uniform @vShadowCoord is re-purposed to hold
        // the vector from the light to the world-space position of the fragment.
        vec3 lightToPosition = shadowCoord.xyz;

        // dp = normalized distance from light to fragment position
        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
        compare += shadowBias;

        // bd3D = base direction 3D
        vec3 bd3D = normalize( lightToPosition );

        vec2 halton = haltonSequence[frameIndex];
        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
        float temporalAngle  = temporalOffset * PI2;

        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )
            for (int i = 0; i < gShadowSamples; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                // NOTE: Removed for now
                // Penumbra offset
                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * gShadowSamplesRpc;

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )
            for (int i = 0; i < 16; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * (1.0 / 16.0);
        #else // no percentage-closer filtering

            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );

        #endif

    }

#endif
`,AGe=Jt.lights_fragment_begin,MGe=Jt.shadowmask_pars_fragment,x7=null,EGe=t=>{switch(t){case"low":return 8;case"medium":return 16;case"high":return 32;default:return 16}},TGe=(t="medium")=>{if(x7===t)return!1;x7=t;let e=EGe(t);Jt.shadowmap_pars_fragment=SGe(e);let i=AGe.slice();i=i.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),i=i.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),Jt.lights_fragment_begin=i;let n=MGe.slice();return n=n.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),Jt.shadowmask_pars_fragment=n,!0},CGe=`
attribute vec3 randomColor;
varying vec3 vNormal;
flat out vec3 vColor;

void main()
{
vNormal = normal;
vColor = randomColor;
gl_Position = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
}
`,PGe=`
uniform float depthContrast;
varying vec3 vNormal;
flat in vec3 vColor;
void main()
{
vec3 normal = (normalize(vNormal)).rgb;

float contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;

vec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);
gl_FragColor = vec4(resultColor, vColor.r);
}
`,G3=new $i({vertexShader:CGe,fragmentShader:PGe,uniforms:{depthContrast:{value:1}}}),Fne={RED:0,GREEN:1,BLUE:2,ALPHA:3},Hw="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",DGe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;
#if PASS == 1
uniform vec4 kernel64[32];
#else
uniform vec4 kernel16[8];
#endif
varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;
#else
float CoC=texture2D(cocBuffer,vUv).g*scale;
#endif
if(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(CoC,CoCNearFar.g*scale);
#else
vec2 step=texelSize*CoC;
#endif
#if PASS == 1
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;
#else
vec4 maxValue=texture2D(inputBuffer,vUv);for(int i=0;i<8;++i){vec4 kernel=kernel16[i];vec2 uv=step*kernel.xy+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);uv=step*kernel.zw+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);}gl_FragColor=maxValue;
#endif
}}`,rM=class extends $i{constructor(t=!1,e=!1){super({name:"BokehMaterial",defines:{PASS:t?"2":"1"},uniforms:{kernel64:new Ze(null),kernel16:new Ze(null),inputBuffer:new Ze(null),cocBuffer:new Ze(null),texelSize:new Ze(new he),scale:new Ze(1)},blending:fr,depthWrite:!1,depthTest:!1,fragmentShader:DGe,vertexShader:Hw}),this.toneMapped=!1,e&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}set cocBuffer(t){this.uniforms.cocBuffer.value=t}setCoCBuffer(t){this.uniforms.cocBuffer.value=t}get scale(){return this.uniforms.scale.value}set scale(t){this.uniforms.scale.value=t}getScale(t){return this.uniforms.scale.value=t}setScale(t){this.uniforms.scale.value=t}generateKernel(){let t=2.39996323,e=new Float32Array(128),i=new Float32Array(32),n=0,r=0;for(let a=0;a<80;++a){let l=a*t,c=Math.sqrt(a)/Math.sqrt(80),h=c*Math.cos(l),u=c*Math.sin(l);a%5===0?(i[r++]=h,i[r++]=u):(e[n++]=h,e[n++]=u)}let s=[],o=[];for(let a=0;a<128;)s.push(new Kt(e[a++],e[a++],e[a++],e[a++]));for(let a=0;a<32;)o.push(new Kt(i[a++],i[a++],i[a++],i[a++]));this.uniforms.kernel64.value=s,this.uniforms.kernel16.value=o}setTexelSize(t,e){this.uniforms.texelSize.value.set(t,e)}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}};function _7(t,e,i){return t*(e-i)-e}function JO(t,e,i){return Math.min(Math.max((t+e)/(e-i),0),1)}var RGe=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,IGe=class extends $i{constructor(t){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new Ze(null),focusDistance:new Ze(0),focusRange:new Ze(0),cameraNear:new Ze(.3),cameraFar:new Ze(1e3)},blending:fr,depthWrite:!1,depthTest:!1,fragmentShader:RGe,vertexShader:Hw}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(t)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(t){this.uniforms.depthBuffer.value=t}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=vh){this.depthBuffer=t,this.depthPacking=e}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(t){this.uniforms.focusDistance.value=t}get worldFocusDistance(){return-_7(this.focusDistance,this.near,this.far)}set worldFocusDistance(t){this.focusDistance=JO(-t,this.near,this.far)}getFocusDistance(t){this.uniforms.focusDistance.value=t}setFocusDistance(t){this.uniforms.focusDistance.value=t}get focalLength(){return this.focusRange}set focalLength(t){this.focusRange=t}get focusRange(){return this.uniforms.focusRange.value}set focusRange(t){this.uniforms.focusRange.value=t}get worldFocusRange(){return-_7(this.focusRange,this.near,this.far)}set worldFocusRange(t){this.focusRange=JO(-t,this.near,this.far)}getFocalLength(t){return this.focusRange}setFocalLength(t){this.focusRange=t}adoptCameraSettings(t){t&&(this.uniforms.cameraNear.value=t.near,this.uniforms.cameraFar.value=t.far,t instanceof vs?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},LGe=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <encodings_fragment>
#include <dithering_fragment>
}`,BGe="uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",w7=class extends $i{constructor(t=new he){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new Ze(null),texelSize:new Ze(new he),halfTexelSize:new Ze(new he),kernel:new Ze(0),scale:new Ze(1)},blending:fr,depthWrite:!1,depthTest:!1,fragmentShader:LGe,vertexShader:BGe}),this.toneMapped=!1,this.setTexelSize(t.x,t.y)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.inputBuffer=t}get scale(){return this.uniforms.scale.value}set scale(t){this.uniforms.scale.value=t}getScale(){return this.uniforms.scale.value}setScale(t){this.uniforms.scale.value=t}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(t){this.uniforms.kernel.value=t}setKernel(t){this.kernel=t}setTexelSize(t,e){this.uniforms.texelSize.value.set(t,e),this.uniforms.halfTexelSize.value.set(t,e).multiplyScalar(.5)}setSize(t,e){let i=this.uniforms;i.texelSize.value.set(1/t,1/e),i.halfTexelSize.value.copy(i.texelSize.value).multiplyScalar(.5)}},OGe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <encodings_fragment>
}`,FGe=class extends $i{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new Ze(null),opacity:new Ze(1)},blending:fr,depthWrite:!1,depthTest:!1,fragmentShader:OGe,vertexShader:Hw}),this.toneMapped=!1}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}getOpacity(t){return this.uniforms.opacity.value}setOpacity(t){this.uniforms.opacity.value=t}},NGe=`varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
#if EDGE_DETECTION_MODE == 1
#include <common>
#endif
#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}
#elif PREDICATION_MODE == 2
uniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}
#endif
#if PREDICATION_MODE != 0
vec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}
#endif
#if EDGE_DETECTION_MODE != 0
uniform sampler2D inputBuffer;
#endif
void main(){
#if EDGE_DETECTION_MODE == 0
const vec2 threshold=vec2(DEPTH_THRESHOLD);
#elif PREDICATION_MODE != 0
vec2 threshold=calculatePredicatedThreshold();
#else
const vec2 threshold=vec2(EDGE_THRESHOLD);
#endif
#if EDGE_DETECTION_MODE == 0
vec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 1
float l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 2
vec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#endif
}`,UGe=`uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);
#if EDGE_DETECTION_MODE != 0
vUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);
#endif
gl_Position=vec4(position.xy,1.0,1.0);}`,x2={DEPTH:0,LUMA:1,COLOR:2},kGe={DISABLED:0,DEPTH:1,CUSTOM:2},zGe=class extends $i{constructor(t=new he,e=x2.COLOR){super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:oy.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new Ze(null),depthBuffer:new Ze(null),predicationBuffer:new Ze(null),texelSize:new Ze(t)},blending:fr,depthWrite:!1,depthTest:!1,fragmentShader:NGe,vertexShader:UGe}),this.toneMapped=!1,this.edgeDetectionMode=e}set depthBuffer(t){this.uniforms.depthBuffer.value=t}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=vh){this.depthBuffer=t,this.depthPacking=e}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(t){this.defines.EDGE_DETECTION_MODE=t.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(t){this.edgeDetectionMode=t}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(t){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=t.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(t){this.localContrastAdaptationFactor=t}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(t){this.defines.EDGE_THRESHOLD=t.toFixed("6"),this.defines.DEPTH_THRESHOLD=(t*.1).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(t){this.edgeDetectionThreshold=t}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(t){this.defines.PREDICATION_MODE=t.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(t){this.predicationMode=t}set predicationBuffer(t){this.uniforms.predicationBuffer.value=t}setPredicationBuffer(t){this.uniforms.predicationBuffer.value=t}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(t){this.defines.PREDICATION_THRESHOLD=t.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(t){this.predicationThreshold=t}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(t){this.defines.PREDICATION_SCALE=t.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(t){this.predicationScale=t}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(t){this.defines.PREDICATION_STRENGTH=t.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(t){this.predicationStrength=t}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}},GGe=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <encodings_fragment>
#endif
#include <dithering_fragment>
}`,HGe="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}",vl={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},ZO=class extends $i{constructor(t,e,i,n,r=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:oy.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new Ze(null),depthBuffer:new Ze(null),resolution:new Ze(new he),texelSize:new Ze(new he),cameraNear:new Ze(.3),cameraFar:new Ze(1e3),aspect:new Ze(1),time:new Ze(0)},blending:fr,depthWrite:!1,depthTest:!1,dithering:r}),this.toneMapped=!1,t&&this.setShaderParts(t),e&&this.setDefines(e),i&&this.setUniforms(i),this.adoptCameraSettings(n)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(t){this.uniforms.depthBuffer.value=t}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=vh){this.depthBuffer=t,this.depthPacking=e}setShaderParts(t){return this.fragmentShader=GGe.replace(vl.FRAGMENT_HEAD,t.get(vl.FRAGMENT_HEAD)).replace(vl.FRAGMENT_MAIN_UV,t.get(vl.FRAGMENT_MAIN_UV)).replace(vl.FRAGMENT_MAIN_IMAGE,t.get(vl.FRAGMENT_MAIN_IMAGE)),this.vertexShader=HGe.replace(vl.VERTEX_HEAD,t.get(vl.VERTEX_HEAD)).replace(vl.VERTEX_MAIN_SUPPORT,t.get(vl.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(t){for(let e of t.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(t){for(let e of t.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(t){this.extensions={};for(let e of t)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(t){this.encodeOutput!==t&&(t?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(t){return this.encodeOutput}setOutputEncodingEnabled(t){this.encodeOutput=t}get time(){return this.uniforms.time.value}set time(t){this.uniforms.time.value=t}setDeltaTime(t){this.uniforms.time.value+=t}adoptCameraSettings(t){t&&(this.uniforms.cameraNear.value=t.near,this.uniforms.cameraFar.value=t.far,t instanceof vs?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(t,e){let i=this.uniforms;i.resolution.value.set(t,e),i.texelSize.value.set(1/t,1/e),i.aspect.value=t/e}static get Section(){return vl}},VGe=`#include <common>
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,jGe=class extends $i{constructor(t=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:oy.replace(/\D+/g,"")},uniforms:{inputBuffer:new Ze(null),threshold:new Ze(0),smoothing:new Ze(1),range:new Ze(null)},blending:fr,depthWrite:!1,depthTest:!1,fragmentShader:VGe,vertexShader:Hw}),this.toneMapped=!1,this.colorOutput=t,this.luminanceRange=e}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get threshold(){return this.uniforms.threshold.value}set threshold(t){this.smoothing>0||t>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=t}getThreshold(){return this.threshold}setThreshold(t){this.threshold=t}get smoothing(){return this.uniforms.smoothing.value}set smoothing(t){this.threshold>0||t>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=t}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(t){this.smoothing=t}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(t){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(t){t?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(t){return this.colorOutput}setColorOutputEnabled(t){this.colorOutput=t}get useRange(){return this.luminanceRange!==null}set useRange(t){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(t){t!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=t,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(t){this.luminanceRange=t}},WGe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,Nne={DISCARD:0,MULTIPLY:1,MULTIPLY_RGB_SET_ALPHA:2},XGe=class extends $i{constructor(t=null){super({name:"MaskMaterial",uniforms:{maskTexture:new Ze(t),inputBuffer:new Ze(null),strength:new Ze(1)},blending:fr,depthWrite:!1,depthTest:!1,fragmentShader:WGe,vertexShader:Hw}),this.toneMapped=!1,this.setColorChannel(Fne.RED),this.setMaskFunction(Nne.DISCARD)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}set maskTexture(t){this.uniforms.maskTexture.value=t,delete this.defines.MASK_PRECISION_HIGH,t.type!==As&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(t){this.maskTexture=t}set colorChannel(t){this.defines.COLOR_CHANNEL=t.toFixed(0),this.needsUpdate=!0}setColorChannel(t){this.colorChannel=t}set maskFunction(t){this.defines.MASK_FUNCTION=t.toFixed(0),this.needsUpdate=!0}setMaskFunction(t){this.maskFunction=t}get inverted(){return this.defines.INVERTED!==void 0}set inverted(t){this.inverted&&!t?delete this.defines.INVERTED:t&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(t){this.inverted=t}get strength(){return this.uniforms.strength.value}set strength(t){this.uniforms.strength.value=t}getStrength(){return this.strength}setStrength(t){this.strength=t}},qGe=`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)
#if __VERSION__ < 300
#define round(v) floor(v + 0.5)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);
#endif
}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);
#endif
}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){
#if !defined(DISABLE_DIAG_DETECTION)
weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){
#endif
vec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);
#if !defined(DISABLE_DIAG_DETECTION)
}else{e.r=0.0;}
#endif
}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}`,YGe="uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",QGe=class extends $i{constructor(t=new he,e=new he){super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new Ze(null),searchTexture:new Ze(null),areaTexture:new Ze(null),resolution:new Ze(e),texelSize:new Ze(t)},blending:fr,depthWrite:!1,depthTest:!1,fragmentShader:qGe,vertexShader:YGe}),this.toneMapped=!1}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(t){this.uniforms.searchTexture.value=t}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(t){this.uniforms.areaTexture.value=t}setLookupTextures(t,e){this.searchTexture=t,this.areaTexture=e}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(t){let e=Math.min(Math.max(t,0),112);this.defines.MAX_SEARCH_STEPS_INT=e.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=e.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(t){this.orthogonalSearchSteps=t}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(t){let e=Math.min(Math.max(t,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=e.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=e.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(t){this.diagonalSearchSteps=t}get diagonalDetection(){return this.defines.DISABLE_DIAG_DETECTION===void 0}set diagonalDetection(t){t?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(t){this.diagonalDetection=t}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(t){let e=Math.min(Math.max(t,0),100);this.defines.CORNER_ROUNDING=e.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(e/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(t){this.cornerRounding=t}get cornerDetection(){return this.defines.DISABLE_CORNER_DETECTION===void 0}set cornerDetection(t){t?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(t){this.cornerDetection=t}setSize(t,e){let i=this.uniforms;i.texelSize.value.set(1/t,1/e),i.resolution.value.set(t,e)}},KGe=new uy,jh=null;function JGe(){if(jh===null){let t=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]);jh=new Ut,jh.setAttribute!==void 0?(jh.setAttribute("position",new Gt(t,3)),jh.setAttribute("uv",new Gt(e,2))):(jh.addAttribute("position",new Gt(t,3)),jh.addAttribute("uv",new Gt(e,2)))}return jh}var Ys=class{constructor(t="Pass",e=new Nd,i=KGe){this.name=t,this.renderer=null,this.scene=e,this.camera=i,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(t){if(this.rtt===t){let e=this.getFullscreenMaterial();e!==null&&(e.needsUpdate=!0),this.rtt=!t}}setRenderer(t){this.renderer=t}isEnabled(){return this.enabled}setEnabled(t){this.enabled=t}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(t){let e=this.screen;e!==null?e.material=t:(e=new co(JGe(),t),e.frustumCulled=!1,this.scene===null&&(this.scene=new Nd),this.scene.add(e),this.screen=e)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(t){this.fullscreenMaterial=t}getDepthTexture(){return null}setDepthTexture(t,e=vh){}render(t,e,i,n,r){throw new Error("Render method not implemented!")}setSize(t,e){}initialize(t,e,i){}dispose(){for(let t of Object.keys(this)){let e=this[t];if(e!==null&&typeof e.dispose=="function"){if(e instanceof Nd||e===this.renderer)continue;this[t].dispose()}}}},$O=class extends Ys{constructor(t,e=!0){super("CopyPass"),this.fullscreenMaterial=new FGe,this.needsSwap=!1,this.renderTarget=t,t===void 0&&(this.renderTarget=new Hi(1,1,{minFilter:ri,magFilter:ri,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(t){this.autoResize=t}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(t){this.autoResize=t}render(t,e,i,n,r){this.fullscreenMaterial.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){this.autoResize&&this.renderTarget.setSize(t,e)}initialize(t,e,i){i!==void 0&&(this.renderTarget.texture.type=i,i!==As?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":t.outputEncoding===Qt&&(this.renderTarget.texture.encoding=Qt))}},ZGe=class extends Ys{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(t,e,i,n,r){let s=t.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},H3=new It,gz=class extends Ys{constructor(t=!0,e=!0,i=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=t,this.depth=e,this.stencil=i,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(t,e,i){this.color=t,this.depth=e,this.stencil=i}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(t){this.overrideClearColor=t}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(t){this.overrideClearAlpha=t}render(t,e,i,n,r){let s=this.overrideClearColor,o=this.overrideClearAlpha,a=t.getClearAlpha(),l=s!==null,c=o>=0;l?(H3.copy(t.getClearColor(H3)),t.setClearColor(s,c?o:a)):c&&t.setClearAlpha(o),t.setRenderTarget(this.renderToScreen?null:e),t.clear(this.color,this.depth,this.stencil),l?t.setClearColor(H3,a):c&&t.setClearAlpha(a)}},Wh=-1,ho=class extends is{constructor(t,e=Wh,i=Wh,n=1){super(),this.resizable=t,this.base=new he(1,1),this.preferred=new he(e,i),this.target=this.preferred,this.s=n}get width(){let{base:t,preferred:e,scale:i}=this,n;return e.width!==Wh?n=e.width:e.height!==Wh?n=Math.round(e.height*(t.width/Math.max(t.height,1))):n=Math.round(t.width*i),n}set width(t){this.preferredWidth=t}get height(){let{base:t,preferred:e,scale:i}=this,n;return e.height!==Wh?n=e.height:e.width!==Wh?n=Math.round(e.width/Math.max(t.width/Math.max(t.height,1),1)):n=Math.round(t.height*i),n}set height(t){this.preferredHeight=t}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(t){this.s!==t&&(this.s=t,this.preferred.setScalar(Wh),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(t){this.scale=t}get baseWidth(){return this.base.width}set baseWidth(t){this.base.width!==t&&(this.base.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(t){this.base.width!==t&&(this.base.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(t){this.base.height!==t&&(this.base.height=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(t){this.baseHeight=t}setBaseSize(t,e){(this.base.width!==t||this.base.height!==e)&&(this.base.set(t,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(t){this.preferred.width!==t&&(this.preferred.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(t){this.preferredWidth=t}get preferredHeight(){return this.preferred.height}set preferredHeight(t){this.preferred.height!==t&&(this.preferred.height=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(t){this.preferredHeight=t}setPreferredSize(t,e){(this.preferred.width!==t||this.preferred.height!==e)&&(this.preferred.set(t,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(t){this.base.set(t.getBaseWidth(),t.getBaseHeight()),this.preferred.set(t.getPreferredWidth(),t.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return Wh}},V3=!1,b7=class{constructor(t=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(t),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let i;if(e.material.flatShading)switch(e.material.side){case Wo:i=this.materialsFlatShadedDoubleSide;break;case kr:i=this.materialsFlatShadedBackSide;break;default:i=this.materialsFlatShaded;break}else switch(e.material.side){case Wo:i=this.materialsDoubleSide;break;case kr:i=this.materialsBackSide;break;default:i=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=i[2]:e.isInstancedMesh?e.material=i[1]:e.material=i[0],++this.meshCount}}}setMaterial(t){if(this.disposeMaterials(),this.material=t,t!==null){let e=this.materials=[t.clone(),t.clone(),t.clone()];for(let i of e)i.uniforms=Object.assign({},t.uniforms),i.side=Hl;e[2].skinning=!0,this.materialsBackSide=e.map(i=>{let n=i.clone();return n.uniforms=Object.assign({},t.uniforms),n.side=kr,n}),this.materialsDoubleSide=e.map(i=>{let n=i.clone();return n.uniforms=Object.assign({},t.uniforms),n.side=Wo,n}),this.materialsFlatShaded=e.map(i=>{let n=i.clone();return n.uniforms=Object.assign({},t.uniforms),n.flatShading=!0,n}),this.materialsFlatShadedBackSide=e.map(i=>{let n=i.clone();return n.uniforms=Object.assign({},t.uniforms),n.flatShading=!0,n.side=kr,n}),this.materialsFlatShadedDoubleSide=e.map(i=>{let n=i.clone();return n.uniforms=Object.assign({},t.uniforms),n.flatShading=!0,n.side=Wo,n})}}render(t,e,i){let n=t.shadowMap.enabled;if(t.shadowMap.enabled=!1,V3){let r=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),t.render(e,i);for(let s of r)s[0].material=s[1];this.meshCount!==r.size&&r.clear()}else{let r=e.overrideMaterial;e.overrideMaterial=this.material,t.render(e,i),e.overrideMaterial=r}t.shadowMap.enabled=n}disposeMaterials(){if(this.material!==null){let t=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let e of t)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return V3}static set workaroundEnabled(t){V3=t}},$Ge=class extends Ys{constructor(t,e,i=null){super("RenderPass",t,e),this.needsSwap=!1,this.clearPass=new gz,this.overrideMaterialManager=i===null?null:new b7(i),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(t){super.renderToScreen=t,this.clearPass.renderToScreen=t}get overrideMaterial(){let t=this.overrideMaterialManager;return t!==null?t.material:null}set overrideMaterial(t){let e=this.overrideMaterialManager;t!==null?e!==null?e.setMaterial(t):this.overrideMaterialManager=new b7(t):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(t){this.overrideMaterial=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getSelection(){return this.selection}setSelection(t){this.selection=t}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(t){this.ignoreBackground=t}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(t){this.skipShadowMapUpdate=t}getClearPass(){return this.clearPass}render(t,e,i,n,r){let s=this.scene,o=this.camera,a=this.selection,l=o.layers.mask,c=s.background,h=t.shadowMap.autoUpdate,u=this.renderToScreen?null:e;a!==null&&o.layers.set(a.getLayer()),this.skipShadowMapUpdate&&(t.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(t,e),t.setRenderTarget(u),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(t,s,o):t.render(s,o),o.layers.mask=l,s.background=c,t.shadowMap.autoUpdate=h}},S7=class extends Ys{constructor(t,e,{resolutionScale:i=1,width:n=ho.AUTO_SIZE,height:r=ho.AUTO_SIZE,renderTarget:s}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new $Ge(t,e,new Lee({depthPacking:xee}));let o=this.renderPass;o.skipShadowMapUpdate=!0,o.ignoreBackground=!0;let a=o.getClearPass();a.overrideClearColor=new It(16777215),a.overrideClearAlpha=1,this.renderTarget=s,this.renderTarget===void 0&&(this.renderTarget=new Hi(1,1,{minFilter:Zi,magFilter:Zi,stencilBuffer:!1}),this.renderTarget.texture.name="DepthPass.Target");let l=this.resolution=new ho(this,n,r,i);l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}render(t,e,i,n,r){let s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(t,s)}setSize(t,e){let i=this.resolution;i.setBaseSize(t,e),this.renderTarget.setSize(i.width,i.height)}},yi={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},eHe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}",tHe="vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}",iHe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}",nHe="float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",rHe="float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",sHe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}",oHe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}",aHe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}",lHe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}",cHe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}",uHe="float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",hHe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}",dHe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}",fHe="float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",pHe="float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",mHe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}",gHe="float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",vHe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}",yHe=new Map([[yi.SKIP,null],[yi.ADD,eHe],[yi.ALPHA,tHe],[yi.AVERAGE,iHe],[yi.COLOR_BURN,nHe],[yi.COLOR_DODGE,rHe],[yi.DARKEN,sHe],[yi.DIFFERENCE,oHe],[yi.EXCLUSION,aHe],[yi.LIGHTEN,lHe],[yi.MULTIPLY,cHe],[yi.DIVIDE,uHe],[yi.NEGATION,hHe],[yi.NORMAL,dHe],[yi.OVERLAY,fHe],[yi.REFLECT,pHe],[yi.SCREEN,mHe],[yi.SOFT_LIGHT,gHe],[yi.SUBTRACT,vHe]]),xHe=class extends is{constructor(t,e=1){super(),this.f=t,this.opacity=new Ze(e)}getOpacity(){return this.opacity.value}setOpacity(t){this.opacity.value=t}get blendFunction(){return this.f}set blendFunction(t){this.f=t,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(t){this.blendFunction=t}getShaderCode(){return yHe.get(this.blendFunction)}},Vc={NONE:0,DEPTH:1,CONVOLUTION:2},nu=class extends is{constructor(t,e,{attributes:i=Vc.NONE,blendFunction:n=yi.SCREEN,defines:r=new Map,uniforms:s=new Map,extensions:o=null,vertexShader:a=null}={}){super(),this.name=t,this.renderer=null,this.attributes=i,this.fragmentShader=e,this.vertexShader=a,this.defines=r,this.uniforms=s,this.extensions=o,this.blendMode=new xHe(n),this.blendMode.addEventListener("change",l=>this.setChanged())}getName(){return this.name}setRenderer(t){this.renderer=t}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(t){this.attributes=t,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(t){this.fragmentShader=t,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(t){this.vertexShader=t,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(t,e=vh){}update(t,e,i){}setSize(t,e){}initialize(t,e,i){}dispose(){for(let t of Object.keys(this)){let e=this[t];if(e!==null&&typeof e.dispose=="function"){if(e instanceof Nd||e===this.renderer)continue;this[t].dispose()}}}};function A7(t,e,i){for(let n of e){let r="$1"+t+n.charAt(0).toUpperCase()+n.slice(1),s=new RegExp("([^\\.])(\\b"+n+"\\b)","g");for(let o of i.entries())o[1]!==null&&i.set(o[0],o[1].replace(s,r))}}function _He(t,e,i,n,r,s,o){let a=new Map([["fragment",e.getFragmentShader()],["vertex",e.getVertexShader()]]),l=a.get("fragment")!==void 0&&/mainImage/.test(a.get("fragment")),c=a.get("fragment")!==void 0&&/mainUv/.test(a.get("fragment")),h=[],u=[],d=!1,f=!1;if(a.get("fragment")===void 0)console.error("Missing fragment shader",e);else if(c&&o&Vc.CONVOLUTION)console.error("Effects that transform UV coordinates are incompatible with convolution effects",e);else if(!l&&!c)console.error("The fragment shader contains neither a mainImage nor a mainUv function",e);else{let p=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,m=ZO.Section;if(c){let g=`	${t}MainUv(UV);
`;i.set(m.FRAGMENT_MAIN_UV,i.get(m.FRAGMENT_MAIN_UV)+g),d=!0}if(a.get("vertex")!==null&&/mainSupport/.test(a.get("vertex"))){let g=`	${t}MainSupport(`;g+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(a.get("vertex"))?`vUv);
`:`);
`,i.set(m.VERTEX_MAIN_SUPPORT,i.get(m.VERTEX_MAIN_SUPPORT)+g),h=h.concat([...a.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map(y=>y[1])),u=u.concat(h).concat([...a.get("vertex").matchAll(p)].map(y=>y[1]))}u=u.concat([...a.get("fragment").matchAll(p)].map(g=>g[1])),u=u.concat([...e.defines.keys()].map(g=>g.replace(/\([\w\s,]*\)/g,""))),u=u.concat([...e.uniforms.keys()]),e.uniforms.forEach((g,y)=>s.set(t+y.charAt(0).toUpperCase()+y.slice(1),g)),e.defines.forEach((g,y)=>r.set(t+y.charAt(0).toUpperCase()+y.slice(1),g)),A7(t,u,r),A7(t,u,a);let v=e.blendMode;if(n.set(v.blendFunction,v),l){let g=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,y=`${t}MainImage(color0, UV, `;o&Vc.DEPTH&&g.test(a.get("fragment"))&&(y+="depth, ",f=!0),y+=`color1);
	`;let x=t+"BlendOpacity";s.set(x,v.opacity),y+=`color0 = blend${v.blendFunction}(color0, color1, ${x});

	`,i.set(m.FRAGMENT_MAIN_IMAGE,i.get(m.FRAGMENT_MAIN_IMAGE)+y),y=`uniform float ${x};

`,i.set(m.FRAGMENT_HEAD,i.get(m.FRAGMENT_HEAD)+y)}i.set(m.FRAGMENT_HEAD,i.get(m.FRAGMENT_HEAD)+a.get("fragment")+`
`),a.get("vertex")!==null&&i.set(m.VERTEX_HEAD,i.get(m.VERTEX_HEAD)+a.get("vertex")+`
`)}return{varyings:h,transformedUv:d,readDepth:f}}var zT=class extends Ys{constructor(t,...e){super("EffectPass"),this.fullscreenMaterial=new ZO(null,null,null,t),this.effects=e.sort((i,n)=>n.attributes-i.attributes),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(t){this.fullscreenMaterial.encodeOutput=t}get dithering(){return this.fullscreenMaterial.dithering}set dithering(t){let e=this.fullscreenMaterial;e.dithering=t,e.needsUpdate=!0}verifyResources(){let t=this.renderer.capabilities,e=Math.min(t.maxFragmentUniforms,t.maxVertexUniforms);this.uniformCount>e&&console.warn("The current rendering context doesn't support more than "+e+" uniforms, but "+this.uniformCount+" were defined"),e=t.maxVaryings,this.varyingCount>e&&console.warn("The current rendering context doesn't support more than "+e+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){let t=ZO.Section,e=new Map([[t.FRAGMENT_HEAD,""],[t.FRAGMENT_MAIN_UV,""],[t.FRAGMENT_MAIN_IMAGE,""],[t.VERTEX_HEAD,""],[t.VERTEX_MAIN_SUPPORT,""]]),i=new Map,n=new Map,r=new Map,s=new Set,o=0,a=0,l=0,c=!1,h=!1;for(let d of this.effects)if(d.blendMode.blendFunction===yi.SKIP)l|=d.getAttributes()&Vc.DEPTH;else if(l&d.getAttributes()&Vc.CONVOLUTION)console.error("Convolution effects cannot be merged",d);else{l|=d.getAttributes();let f="e"+o++,p=_He(f,d,e,i,n,r,l);if(a+=p.varyings.length,c=c||p.transformedUv,h=h||p.readDepth,d.extensions!==null)for(let m of d.extensions)s.add(m)}let u=/\bblend\b/g;for(let d of i.values()){let f=d.getShaderCode().replace(u,`blend${d.blendFunction}`);e.set(t.FRAGMENT_HEAD,e.get(t.FRAGMENT_HEAD)+f+`
`)}if(l&Vc.DEPTH){if(h){let d=`float depth = readDepth(UV);

	`;e.set(t.FRAGMENT_MAIN_IMAGE,d+e.get(t.FRAGMENT_MAIN_IMAGE))}this.needsDepthTexture=this.getDepthTexture()===null}else this.needsDepthTexture=!1;if(c){let d=`vec2 transformedUv = vUv;
`;e.set(t.FRAGMENT_MAIN_UV,d+e.get(t.FRAGMENT_MAIN_UV)),n.set("UV","transformedUv")}else n.set("UV","vUv");e.forEach((d,f,p)=>p.set(f,d.trim().replace(/^#/,`
#`))),this.uniformCount=r.size,this.varyingCount=a,this.skipRendering=o===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(e).setExtensions(s).setUniforms(r).setDefines(n)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(t,e=vh){this.fullscreenMaterial.depthBuffer=t,this.fullscreenMaterial.depthPacking=e;for(let i of this.effects)i.setDepthTexture(t,e)}render(t,e,i,n,r){for(let s of this.effects)s.update(t,e,n);if(!this.skipRendering||this.renderToScreen){let s=this.fullscreenMaterial;s.inputBuffer=e.texture,s.time+=n,t.setRenderTarget(this.renderToScreen?null:i),t.render(this.scene,this.camera)}}setSize(t,e){this.fullscreenMaterial.setSize(t,e);for(let i of this.effects)i.setSize(t,e)}initialize(t,e,i){this.renderer=t;for(let n of this.effects)n.initialize(t,e,i),n.addEventListener("change",r=>this.handleEvent(r));this.updateMaterial(),this.verifyResources(),i!==void 0&&i!==As&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let t of this.effects)t.dispose()}handleEvent(t){switch(t.type){case"change":this.recompile();break}}},wHe=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],Une=class extends Ys{constructor({resolutionScale:t=.5,width:e=ho.AUTO_SIZE,height:i=ho.AUTO_SIZE,kernelSize:n=vz.LARGE}={}){super("KawaseBlurPass"),this.renderTargetA=new Hi(1,1,{minFilter:ri,magFilter:ri,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let r=this.resolution=new ho(this,e,i,t);r.addEventListener("change",s=>this.setSize(r.baseWidth,r.baseHeight)),this.blurMaterial=new w7,this.ditheredBlurMaterial=new w7,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=n}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(t){this.resolution.preferredWidth=t}get height(){return this.resolution.height}set height(t){this.resolution.preferredHeight=t}get scale(){return this.blurMaterial.scale}set scale(t){this.blurMaterial.scale=t}getScale(){return this.blurMaterial.scale}setScale(t){this.blurMaterial.scale=t}getKernelSize(){return this.kernelSize}setKernelSize(t){this.kernelSize=t}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}render(t,e,i,n,r){let s=this.scene,o=this.camera,a=this.renderTargetA,l=this.renderTargetB,c=wHe[this.kernelSize],h=this.blurMaterial,u=e,d,f;for(this.fullscreenMaterial=h,d=0,f=c.length-1;d<f;++d){let p=d&1?l:a;h.kernel=c[d],h.inputBuffer=u.texture,t.setRenderTarget(p),t.render(s,o),u=p}this.dithering&&(h=this.ditheredBlurMaterial,this.fullscreenMaterial=h),h.kernel=c[d],h.inputBuffer=u.texture,t.setRenderTarget(this.renderToScreen?null:i),t.render(s,o)}setSize(t,e){let i=this.resolution;i.setBaseSize(t,e);let n=i.width,r=i.height;this.renderTargetA.setSize(n,r),this.renderTargetB.setSize(n,r),this.blurMaterial.setSize(n,r),this.ditheredBlurMaterial.setSize(n,r)}initialize(t,e,i){i!==void 0&&(this.renderTargetA.texture.type=i,this.renderTargetB.texture.type=i,i!==As?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):t.outputEncoding===Qt&&(this.renderTargetA.texture.encoding=Qt,this.renderTargetB.texture.encoding=Qt))}static get AUTO_SIZE(){return ho.AUTO_SIZE}},bHe=class extends Ys{constructor({width:t=ho.AUTO_SIZE,height:e=ho.AUTO_SIZE,renderTarget:i,luminanceRange:n,colorOutput:r}={}){super("LuminancePass"),this.fullscreenMaterial=new jGe(r,n),this.needsSwap=!1,this.renderTarget=i,this.renderTarget===void 0&&(this.renderTarget=new Hi(1,1,{minFilter:ri,magFilter:ri,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let s=this.resolution=new ho(this,t,e);s.addEventListener("change",o=>this.setSize(s.baseWidth,s.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(t,e,i,n,r){let s=this.fullscreenMaterial;s.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){let i=this.resolution;i.setBaseSize(t,e),this.renderTarget.setSize(i.width,i.height)}initialize(t,e,i){i!==void 0&&i!==As&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},SHe=class extends Ys{constructor(t,e){super("MaskPass",t,e),this.needsSwap=!1,this.clearPass=new gz(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(t){this.inverse=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(t){this.inverted=t}render(t,e,i,n,r){let s=t.getContext(),o=t.state.buffers,a=this.scene,l=this.camera,c=this.clearPass,h=this.inverted?0:1,u=1-h;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),o.stencil.setFunc(s.ALWAYS,h,4294967295),o.stencil.setClear(u),o.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(t,null):(c.render(t,e),c.render(t,i))),this.renderToScreen?(t.setRenderTarget(null),t.render(a,l)):(t.setRenderTarget(e),t.render(a,l),t.setRenderTarget(i),t.render(a,l)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(s.EQUAL,1,4294967295),o.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),o.stencil.setLocked(!0)}},Ac=class extends Ys{constructor(t,e="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=t,this.inputBufferUniform=null,this.setInput(e)}setInput(t){if(this.inputBufferUniform=null,this.fullscreenMaterial!==null){let e=this.fullscreenMaterial.uniforms;e!==void 0&&e[t]!==void 0&&(this.inputBufferUniform=e[t])}}render(t,e,i,n,r){this.inputBufferUniform!==null&&e!==null&&(this.inputBufferUniform.value=e.texture),t.setRenderTarget(this.renderToScreen?null:i),t.render(this.scene,this.camera)}initialize(t,e,i){i!==void 0&&i!==As&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},j3=1/1e3,AHe=1e3,MHe=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(t){return this.fixedDeltaEnabled=t,this}isAutoResetEnabled(t){return this.autoReset}setAutoResetEnabled(t){return typeof document<"u"&&document.hidden!==void 0&&(t?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=t),this}getDelta(){return this.delta*j3}getFixedDelta(){return this.fixedDelta*j3}setFixedDelta(t){return this.fixedDelta=t*AHe,this}getElapsed(){return this.elapsed*j3}getTimescale(){return this.timescale}setTimescale(t){return this.timescale=t,this}update(t){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=t!==void 0?t:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(t){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},vz={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},EHe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}`,THe=class extends nu{constructor({blendFunction:t=yi.SCREEN,luminanceThreshold:e=.9,luminanceSmoothing:i=.025,resolutionScale:n=.5,intensity:r=1,width:s=ho.AUTO_SIZE,height:o=ho.AUTO_SIZE,kernelSize:a=vz.LARGE}={}){super("BloomEffect",EHe,{blendFunction:t,uniforms:new Map([["map",new Ze(null)],["intensity",new Ze(r)]])}),this.renderTarget=new Hi(1,1,{minFilter:ri,magFilter:ri,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new bHe({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothingFactor=i,this.blurPass=new Une({resolutionScale:n,width:s,height:o,kernelSize:a});let l=this.blurPass.getResolution();l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(t){this.resolution.preferredWidth=t}get height(){return this.resolution.height}set height(t){this.resolution.preferredHeight=t}get dithering(){return this.blurPass.dithering}set dithering(t){this.blurPass.dithering=t}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(t){this.blurPass.kernelSize=t}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(t){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(t){this.uniforms.get("intensity").value=t}getIntensity(){return this.intensity}setIntensity(t){this.intensity=t}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}update(t,e,i){let n=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(t,e,n),this.blurPass.render(t,n,n)):this.blurPass.render(t,e,n)}setSize(t,e){let i=this.resolution;i.setBaseSize(t,e),this.renderTarget.setSize(i.width,i.height),this.luminancePass.resolution.copy(i)}initialize(t,e,i){this.blurPass.initialize(t,e,i),i!==void 0&&(this.renderTarget.texture.type=i,t.outputEncoding===Qt&&(this.renderTarget.texture.encoding=Qt))}},CHe="uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",PHe=class extends nu{constructor({blendFunction:t=yi.NORMAL,brightness:e=0,contrast:i=0}={}){super("BrightnessContrastEffect",CHe,{blendFunction:t,uniforms:new Map([["brightness",new Ze(e)],["contrast",new Ze(i)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(t){this.uniforms.get("brightness").value=t}getBrightness(t){return this.brightness}setBrightness(t){this.brightness=t}get contrast(){return this.uniforms.get("contrast").value}set contrast(t){this.uniforms.get("contrast").value=t}getContrast(t){return this.contrast}setContrast(t){this.contrast=t}},DHe="void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",RHe=class extends nu{constructor(t=yi.NORMAL){super("ColorAverageEffect",DHe,{blendFunction:t})}},IHe="varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",LHe="uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",BHe=class extends nu{constructor({blendFunction:t=yi.NORMAL,offset:e=new he(.001,5e-4)}={}){super("ChromaticAberrationEffect",IHe,{vertexShader:LHe,blendFunction:t,attributes:Vc.CONVOLUTION,uniforms:new Map([["offset",new Ze(e)]])})}get offset(){return this.uniforms.get("offset").value}set offset(t){this.uniforms.get("offset").value=t}getOffset(){return this.offset}setOffset(t){this.offset=t}},OHe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}`,FHe=class extends nu{constructor(t,{blendFunction:e=yi.NORMAL,worldFocusDistance:i,worldFocusRange:n,focusDistance:r=0,focalLength:s=.1,focusRange:o=s,bokehScale:a=1,width:l=ho.AUTO_SIZE,height:c=ho.AUTO_SIZE}={}){super("DepthOfFieldEffect",OHe,{blendFunction:e,attributes:Vc.DEPTH,uniforms:new Map([["nearColorBuffer",new Ze(null)],["farColorBuffer",new Ze(null)],["nearCoCBuffer",new Ze(null)],["scale",new Ze(1)]])}),this.camera=t,this.renderTarget=new Hi(1,1,{minFilter:ri,magFilter:ri,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new Ac(new IGe(t));let h=this.cocMaterial;h.focusDistance=r,h.focusRange=o,i!==void 0&&(h.worldFocusDistance=i),n!==void 0&&(h.worldFocusRange=n),this.blurPass=new Une({kernelSize:vz.MEDIUM,width:l,height:c});let u=this.blurPass.getResolution();u.addEventListener("change",f=>this.setSize(u.getBaseWidth(),u.getBaseHeight())),this.maskPass=new Ac(new XGe(this.renderTargetCoC.texture));let d=this.maskPass.fullscreenMaterial;d.maskFunction=Nne.MULTIPLY,d.colorChannel=Fne.GREEN,this.bokehNearBasePass=new Ac(new rM(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new Ac(new rM(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new Ac(new rM(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new Ac(new rM(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=a}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(t){let e=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let i of e)i.fullscreenMaterial.setScale(t);this.maskPass.fullscreenMaterial.setStrength(t),this.uniforms.get("scale").value=t}getBokehScale(){return this.bokehScale}setBokehScale(t){this.bokehScale=t}getTarget(){return this.target}setTarget(t){this.target=t}calculateFocusDistance(t){let e=this.camera,i=e.position.distanceTo(t);return JO(-i,e.near,e.far)}setDepthTexture(t,e=vh){this.circleOfConfusionMaterial.depthBuffer=t,this.circleOfConfusionMaterial.depthPacking=e}update(t,e,i){let n=this.renderTarget,r=this.renderTargetCoC,s=this.renderTargetCoCBlurred,o=this.renderTargetMasked;if(this.target!==null){let a=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=a}this.cocPass.render(t,null,r),this.blurPass.render(t,r,s),this.maskPass.render(t,e,o),this.bokehFarBasePass.render(t,o,n),this.bokehFarFillPass.render(t,n,this.renderTargetFar),this.bokehNearBasePass.render(t,e,n),this.bokehNearFillPass.render(t,n,this.renderTargetNear)}setSize(t,e){let i=this.resolution;i.setBaseSize(t,e);let n=i.width,r=i.height,s=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];s.push(this.renderTargetCoC,this.renderTargetMasked),s.forEach(o=>o.setSize(t,e)),s=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],s.forEach(o=>o.setSize(n,r)),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(o=>o.fullscreenMaterial.setSize(n,r))}initialize(t,e,i){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(n=>n.initialize(t,e,i)),this.blurPass.initialize(t,e,As),i!==void 0&&(this.renderTarget.texture.type=i,this.renderTargetNear.texture.type=i,this.renderTargetFar.texture.type=i,this.renderTargetMasked.texture.type=i,t.outputEncoding===Qt&&(this.renderTarget.texture.encoding=Qt,this.renderTargetNear.texture.encoding=Qt,this.renderTargetFar.texture.encoding=Qt,this.renderTargetMasked.texture.encoding=Qt))}};new L;new $e;var NHe="uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",UHe=class extends nu{constructor({blendFunction:t=yi.NORMAL,hue:e=0,saturation:i=0}={}){super("HueSaturationEffect",NHe,{blendFunction:t,uniforms:new Map([["hue",new Ze(new L)],["saturation",new Ze(i)]])}),this.hue=e}get saturation(){return this.uniforms.get("saturation").value}set saturation(t){this.uniforms.get("saturation").value=t}getSaturation(){return this.saturation}setSaturation(t){this.saturation=t}get hue(){let t=this.uniforms.get("hue").value;return Math.acos((t.x*3-1)/2)}set hue(t){let e=Math.sin(t),i=Math.cos(t);this.uniforms.get("hue").value.set((2*i+1)/3,(-Math.sqrt(3)*e-i+1)/3,(Math.sqrt(3)*e-i+1)/3)}getHue(){return this.hue}setHue(t){this.hue=t}};new It;var kHe=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,zHe=class extends nu{constructor({blendFunction:t=yi.SCREEN,premultiply:e=!1}={}){super("NoiseEffect",kHe,{blendFunction:t}),this.premultiply=e}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(t){this.premultiply!==t&&(t?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(t){this.premultiply=t}},GHe="uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",HHe=class extends nu{constructor(t=30){super("PixelationEffect",GHe,{uniforms:new Map([["active",new Ze(!1)],["d",new Ze(new he)]])}),this.resolution=new he,this.d=0,this.granularity=t}get granularity(){return this.d}set granularity(t){let e=Math.floor(t);e%2>0&&(e+=1),this.d=e,this.uniforms.get("active").value=e>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(t){this.granularity=t}setSize(t,e){this.resolution.set(t,e),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}};new L;new L;var M7="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC",E7="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAYAAAABNmBHAAAgAElEQVR4Xuy9CbhlV1ktOvbpq09DkiIkUBI6kxASIH0DlAQiIK1wRfSJTx+i4JX7vKIigs8HXpXvqVcvrcC9agQ7IDTSSWgqCQQliDRBJKkkhDSkqVPNqVOnP+8b//rH3P+eZ+199tlznVTlvVrft7+1T7OaueZY42/m37QALKNk2wHg1pITlB17mC+Pp11W3X/LHyT32vhg48/5SOv+PnwpsHA70JoGlueB1iKApeqzvOzn44GatTB76Xzhd7suBR7+WWADgDEAwwCG/L54b/poDLrHuvvm70Z2Avhsc+PVcxscBU8F8C8ADg5+ipIjD/PlGwfgju8B924E5seARUfLsiNmqQW0IjL8+7L2NYD/7COBzfcCm+aB8SVgdAkYIRCXKyDax4EdAanL5PuNPllNvXDlAHwFgP8AcC2AhRIoDXbsYb48dl5WkVFTE3LGDcC9m4CZCWBuFFgeAZaGAYJQQCRqDHT+McJrVb8zwATUXH02MHYfMHEIGFsAxgjApQqACYQORjtd/B7Axt/z79sC0+cMPgjjlwPwVwHcA+DfAHzTxcVgWBroqMN8+cYBeM71wH0TwKExYHYUWCIAHYRLTlkCYgcIBcAgU/n3qy8GRu4HRgnAOWBkERhddPAJhGJDBxkvw7cqimr+zFM/ZLnZF64cgL8BYD+AWwB8x/dlWuWagHiYL984AJ/0RWBy1AE4AizyM1yxYAcTigW55xMbAkxEiwEdkJ/ZCQxPAiOHgBECcKEC4TBZcKkSv+mTieNcNPNC26mLNsj45QD8LQDTAO4GcJt/7iw2bfoG4WG+vAGwm9ExiEg69zpg/wgwPQLMjgALzn4E4aIzoJjQ9g4024uygkj+pyuAoX0VAIfngOH5NgCHMhAm8Sv2y3XDZeBhNIp8OzJE8OsBzAKYBHAXgDt8/4O+MVT0j4f58o0D8Pxrgf3DwMwIMEPQEYRkNwfgsuuDZLskip0No0gWMD/9HGDoADAkAC4Aw/wsAgZAgs2Z0ABI0GU6IVmKv+f28KDnHxkA/G0A8y6G73N9kOCjXnh/Ebb6OvgwX75xAF5wLTA1VIHPADgMLDj4yIA5AAm6aCUnv4oz46eeDwxNAUMzwJAz4BABSNDFTwSfg7DDKHE23MG5PqIY8A1u/dINs9dBdy8AgnGPM2NfUBrsnw7z5RsH4IXXAAcJviFgluAbygBINnSLWOAjGxJ4pgOKDV0v/OSLKp8iGXBovhLBBOCQM2ACoTOhnYrAdItYbCij5JFzRyIAqRccAnDAQUjg6UNQ7hsMXP0cRQAexss3DsCLCECCLwCQzMcPwUi2MwAScAKbfnY/YRLFQ8DHX+IAJAMSfDkAF13kLvleIjhjQQHxUVS3jjgGpKeeNzYVQEjgUS8k+PghONdhIwAP4+XXBYCHKIJbwJyDTgaIAdCBJx3Q2M8tYAHP9m4df/ylQOsQ0JqtRLCx30K1wtLBggScQOgsKBGcWHAJeOwRC0BSM1mQIKRbhh+Bj98JQP6t4U0APEyXXxcAEnxkQAFwoVUxID9kvQg+c1C7vidRbIDkc24B//hTQGumDcCWA5DgMxASdNIFBUI5pCML8v8API5zfEQx4BudgqiczviSnJhQwCP4BMCGl+wO8+U7AJi/W4O4YS6+pmK/2ciADsAOBhTIIiAJnPB7AvNjP+0AnANaYkAHX2JBAc+tYaJXOqBZv24Vc386XW5dtkHGW+4HFAJonpOe+YYQZAShgKjv3PNvPQaxVoI8zJdfFwASfPzMUwS3Kt1v0UFIlos6oDFdAGFcliMAP/ryAEAGNwQRnDOgLbdlIEwrIs6AZ/QgkMMHQF6ZAKQcJAsSYPwIeAIk9wJgoPK1gi7+PwF4GC/fOAAvIQPSs0URTPBJ/Pp3GSEGRHfBCIQ0xowBtUbcAj7ys5X4Jfu1HIAGQrIgQRXEsAFQIORDFhiDY/rMHmrU4QUgR08AkgUjCAW6CD6CkwBsAIQC4GG6fPMA3OXiNzCg2I9gNCMksmAAoemDzoimFwL48M85AKkiuQVMAAp8CYRRDAt8GQiJ67N6GJODAXAHlsGguscA2AJg1IPGYmxOpBxFWkRN9LsATgIwXnNs/v/5z/9XCf8BO3YAtxbc/46/KDt+5+ea1Yku2VUxHz/z0v24FwMGK1gWsK2OUUxHHdCBeRUB6OxHABr4ZICIBd0QWSF+XRdMTAjgCdTrG9cBNwE4F8CpDkICyYLGsuhFt6zs+gISwUen8zEAjgMw4cfx2H6O/90yAFo84Cbg4ID3/9TfLTt+5+ebnRABkODjx0SwPi5ec/FrYpmqSAxM8Dn60CsqAFI6GfhqAMiDE/gokmvEr0C4PgDkBQm40wE8zMFEUDKEVoxIMLl/KS73mE7H9d+vcKHQQcjwW0Yu9nP8m8sAmOIBuWY6wP2/4s0ezjjg8TuvaR6ABJ70vxUApGrm7EbGE+i472BAB+WHfqHS/eoAaEwY2E9+wLSXTqhI7CXgnB6LCoOJ4BiST+hTnG0HcCwAglCx3ARoZEVFXnBPp/O/A/hXACc7CPs9/i1lAOyIB+RDX+P9/+pbQjjjAMfv/PL6AFDs1wFAgs/9fgKfgdE/ZEpuiQlbwAde6QAMBgiRmsSwA9BY0JfjovGRDBMH4TlcXGhcBOc6HkF0gjPhZgchxTLZMAci/04W/B6Ab3t09EPXcPyflgFwRTwgJ2MN9/8bf5qFM67x+B/aW4XQz42FeL0YrRyikztUFw0704mf9kXgxhOAqc3AAsPyRxxQCs/PdXOFY0W1KHy3QIUGtx+6vdnx1vsB+dsTncm2AogglFgVEAlUWrOMB2RyEmMCGQ/Y7/HvKns6tfGAnJQ+r/9b76oJZ1zD8WdyQjYBh8aBhVEHjELouQ8ukQ7VRSCJAALwkr+sALhnGzDD3JAJYJHg9uhoi4bx8ytkWUtvHT/7+Zc4dw1uZ3612fH2dkQf7yxIEEockwkJQn4IQoq8unhAhmPRKKFx0uv4K8ueTs94wD7u//VX9ghn7OP4c+4G7h8HpseB+dF2AKlFLwuAIZ8jD6NPrOhAffmfA9/ZBuzZCkyRWSeqBCWyoYGQ5yQrBpDbum/ME1HoPo0XEkSD2zlfbna8q6+EUJcTCxKEtHL5EQjP6BEPyIgYAZBvYt3xHyx7OqvGA65y/7/9wVXCGVc5/sl7qxD66dEqiYgRzAqhN1A4CBNAAlDyAFI+iZ9/N3DLJuC+jcDUBmCWyUnOrmTYCMIOkNclLg0B8/RsNLg9+UvNjnd1APLmmQpFHyEBROuWACQT8nN+H/GAvY7/VNnT6SsesMf13/CpahGnZzhjj+PPmwX2MYdDIfQexWyBAwEUOQDrRDN/98p3A7dvAO6fAA5sqHJDBEAyoUVGkwEd6HR12XU4kwzfl6fCXTZzjy57vvnR513X7Hj7AyDvggAUi9EyFgiZqNxPQF6345nOWbD1HQ/Y5fpvuLa/2+82/vNHgAPDFQDnhoF5j2C2qBWCI8bw1eRw5CL5l94L3DEOTI4DB8Y9OWmsEu/zBJ3rgsaybqBob/7A4C7jtWcooRrczr+u2fH2D0AOQgAUCxKEP7aGgLy64+m6KdjWFA9Yc/03/Osa4glrjr+AupqHz1sEs0cxG0BC9HIePLoit9eNkVf9L+DuUWByDJgaq4ybGYLPAWgiXmLedUE7dwC7saL7CqfPKXi4NYdaykCD410bAHlDEsNiwZ9wAPYbkJcfz6T2gm3N8YDZ9d/wHxUA+739fPwXPrSKYGb+BuP3jAFDElFH9HIWwbzCIGkBr/or4J4RYO8oMOW6ZVcAuvi1Cgoha04BCwT5gfMKHm7NoRde2+x41w5A3hQZkADk5+cGiAeMx3+/7AENFA8Yrv/G71cAXFM4Yzj+otOAaQLQA0gZxaIIZtMDFTigKJV8H9Iq6aZ59ZXAvSPAvpEKgBTtBODcSCWCZeRYtpzrmLyeGNCAyFl1v+Hei8qeb370Rdc2O97BAMi7EgB/2QG41nhAHU9LuWAbOB7Qr//GPRUA13r7Gv9FZwIMoVcEswEwfDoimEP0shKKtIphaZQAXv1+YM+wA3DEdcvRKkGJADQQEsQuhi1Tjt95vBsh5nx2IO59SsHDrTmUOStNjndwAAqEry0IyCMICkOyiuIBNwBvPFQQT7gBuPjc9oRYAIHyOEL4vIFEYVNaOou5vCGE/tV/A0wOVcnpzI47NOri3QFIBpSeaSDUdYLOSWvYImSGgftpJDa4MWJbAGxivGUA5MAOc0Be6eVLj7/4Mk+hzCOYPYpZDBiNkLh+G/M3yFyv/ltgL3W3YQfgcFUhgRY2PwY+Z7/EhAR1SFyXCOb57r28QfQBsJQBMn5D4y0HYLPje9Cd7RIC0PM3EiMofF4gVCBp1P840ix/gyz56r+vAMjk9Gl375iB4+CzveuZdLkkEPJ8ZEfX/6R73vOjzT5Si9hucLxHAVg4PwJgRwh9CKOXK8YA4ZEqKZXSQWh5P+5AftXfA/uGKvYjCKn72cctbFrZNECka5L5CPwIPtMH3TVz17MLB5gdLgA2Nd6jACycHwLQxFEUSR5ASvARDB0h9AQb9bXIgCGk6lUfAPYTgEPAITKgg1BObk58srTJgG58WMkWMaAbQQT1nc8rHGANAJsc71EAFs4PAagQestgC1lsBJ4BMCSOK6dDUcwqqaFiQr/0QeAAAdjy+jBiQQeeMSBZT3nCPUDIa9z+/MIB1gCwyfEeBWDh/BCAeQSzgkjFfGLBBD5nxQ4DxN0wv3hVxX5TBGDwL5obxvVA5YqYL5BeMLd66YYxJpRB0gK+96LCAdYAsMnxHgVg4fwIgMrhUPKQ2C+Bz0PmBTqBMQehAbDlIjj4F80KJguSVZ0FuXpjoCOgXawLjALhbT9eOMAuAGxqvEcBWDg/l1IE05Ed0ygZnyHdz0VwCqEPIfNyx0QQvvLDFQCp+8nfZk5und8tXwIgWcHSNX0N2CJmnAl3v6RwgNnhl17T7HiPArBwfghAS7mV/hey2JS9FvM3BLpUUi1YwDRMXvkRYJoAlAh2l0dcZ04s6JUTDIjyBcrl4yDc/dLCAdYAsMnxHgVg4fxwKVwJgGEJNmWtxpQMpX9on2eRhVA+O56AjMfnP+e3Xvf3NwG4xIPTleiY55bpGh6UbafNU0l0z0p+5Jh5HqYJ6b51nP6XP8cx12XNHQVgIQB/bFPVg2OC7Q+WgVFWng/FvtWLI06uWh5oguKEcXVS/9sEAF//VGD7t4ETDgJbF4CNi8CGZWBs2fPL/H6Vwp2KEtVk4fJ+v/EIYPN9wKa5qu+IncfPwXHVZe/aOL3EbwS7xv8A1rQvnO0j8PArTgTGZ4BxFv9mIxhOCGsv+0OPYDRghcLfkWkEuq0+G00x4OtfDGz+d2DbHmDLjL8si8AYP/7CGIAiEEMTG92zXqSbH+d9R2aA0XnvO+JjthiIrOVDHHPOkBrzUQAWAPsZp3oPDpa/Xag6EVkLBK+5rAnJC3/nYk/APD704WiEAV8OTHwX2LQH2DgFbJgFNrBhjd8r79deGoEwsllgNBOzy8CdjweG9wBj08AIAci2D6HafmyAk4/Z7SJ72hGYRwFYAMDLTwOGp4FRFgD3HhzqRGQiyeurqOdG6r0Rm8IEZjzRlkiqCWoEgK8Axm4BJu4HJhyAbFhDxmbDGnZO4j0SgLGDkpibgEq66TJw/1nA0F5gdLpq+zDqFfd5LMeWqu5HNST0uJOIllg+qgMWgI+HPv0xwLA3gWHpW2sC441gCECbmKziaGrnUdMO4aHeh6MxAP4SMHI7ML4HGD8AjHvHJGNAgpDgY/ck3stipRemvVhc+uASMPUEYGh/9dIRgGx8Y+MNbR/00uVtH0wEx94j/v0oAxaA8Ed+GBieAYZZg5kADC0QWGOFzGJlcGPzl1BxNLXD8sk4xftwNAbA/wwM3wGMUmxOOQBnHXzetIYvibonmSiuYTNjriVg7glAiwBk0fNZH6+PmX9P6kfNmCXGpftJ7TgKwBIAnln14BAAYxMYm5C6RjCyCoOyr0qkD/c+HI0B8DXA8N3AyCQwesD1VQKH7EcASm1Q+y4CkN9pUKiVF5nLvy+fBbTUd8QBaH1HvNBROiZvfsNnrF4kcvPwpdsBLBeU18Nf7AB23Dp4ecHC8oBgUlJJecLS+7+WOpE3gbE+HKw+yoevCYkMGKqPJrdEKARutaFYRs1fiEZ0wP8CDN8LDO8FRqYq3W10pgKgfYLaYCzootgA6KXaTA90y374TKB1sBozy77xHFZ536utRgAmEaw6g5kUSFZwSXnA330qsOlfgHMPDlZesLA8IOjoLypPWHj/11EnCiVwkz7kAExtsGraYUWdSDX5TmsagL8KDBGA7Bd30JsW0oWivnEOQNP7yGTSBR101AlZSUtGyfgZDkCWY1HnJdcBVe6325hTvelg2CQjZNDygG/2An0j1wKnL6y9vGBheUC8prQ8YeH9X39OVQSc7Mc6fCaKvAeHdCIVf4yMYCynTpX+nb97NJmlSQb8r8DQHm9YOFUZTKOzoXGhs6AxF0HIexcLBvWBuiHN8s2ne98R3qc6L4Vyb2oBVjfm9MIFHbjDCh6kPOBbQoG+oW8CO5bWVl6wsDwgfr20PGHh/X/1iaEIuDcCTIW/1Q4rFv8OnYiW3c+W2iKwUjKbyjQNwL1uuR6sAEgDgq1brXOmV81PxhNB6DUDBSYzQJwFtz623XcktX1Q1VWKaTF/zZhVazBVYA1tX5MazsGvobwe/jQr0Ne6BTh5uf/ygoXlAfG60vKEhff/rSe1i4DnTWDUACY1guFTDqLYdCBvf6DJYSMYATBfOx1kLfj1v1axH10nQ3Sd0GUkBnTfpemtBJgseIKQAHLQcVxa2TnuMW0Aqui5es8xBIegVdVVE8VhzHnLh65WMB9An+X18K6aAn2tO4ETl6vqbKuVFywsDwhevqg8YeH93/Rk70JE90nowxZbIJjvS3WYNSGUwGHJTpPxwwcbBuBrgRYBeKACn7VtpdUu/c0NJxO9BIxcKu4TTODzbkonPLoaL0vyUQRb2y8HsL1ckfWzMeuFi40Qezqi+yiPhyt7FOjr6/gCFwgP7Xb5vssTFt7/nQRg6MGRWmDRoeyTlpgw68GRTwgZgo1gGmXAX6/8dtaylSKY/koyID9BhzML3q1gAos2AcOrZYSoq/pJp1VtODRm9Z3LS/7WjVkvXOzEtOpKyGrlAT+4SoG+VY8vBGCvy/dVnrDw/vee65NBJiAjBIVcAJQjOm+DkCZEeiGAMw6sAwDZsJrAdhFM9rPGhd4904Co5oVuCZPV6kD40Ec6+9W8dBTBsfdc3nkpvnB82fp2RPcs79dHgb51LA9ofsDV6vut5/3PnxcAmLVBiDqgevDaJLkYrpuQxzcNwN8AWgIgRbB8loEBzXDwl4cGiDGft58SCOWGedgjvOJ+bPvgRkiuA+ZjzhnQQOiFNVbloa7l/fos0LdO5QENgEXlCfs8Qbf7HyMA3QVjYihYhLENgjX9y/qwxQmRU/asfd0ZcLU2CHVGyusJQLKfVi98CS12T5f7iECkHpsMkAhCF8+nshWH2I/jXsOYO144GV/9ApAIrS3vt4YCfetQHtAA2G+/4PW4/2PPbzMgmUMi2NoeSCRxIt2/FvuxWURIWCXg357gfTjEDNIHnTRXRCpH5ugKwGl3HpMBXQc0v6WLYVm/5limj04rG762K2uYY9jBkr9+rI03NL5ZbczS/dJ+LQyoga4o77fGAn0NlwdMAOy3vl/T938KAcj121z8Bn+Y9eWQJRz8Y6kNagDh2ey5EvxjxQD8TWdAuneCCO4An1vw5vdzQMmdktwq7pLZQR+dM34+ZumAxvY1Y04uqOAJ6FsExzeto7zfAAX6GiwPaLWR1lrfr8n7f/Rl3QGzmsis+/uO71V9OFgP2gpPhgr7TGRqRUT6dyvr4aIs/pm/2zVUNbBSv6G8e5pEv0Cvec7Po7+bTtjlBRlkvAMBkDeQyvsNWKCvofKACYBrre/X1P0/oWEAnnFD1YdjhtXxR73mX10FfCHHE9pVWcGAI/S0gKsfA2y+twrFZw6Hxf/F0Pk8Ri/kpGSnMuDx5T0iACgQHioo0NdAecBUHW6QdsV2/cL7v/Cyqr5gnc42CCOcfX1VIZ/V8We9IDmTzVXwPDJiXuKXPxtDBma8+lzP4WAgKkPxCUAPE4v5GzEuMX0PYJPLhB6FJsc7MAMmkVxaYC/K9gG+F1++8AQ7Gwbgk78I7GFpXgIwFiRXOwaJZPUbiR0yCUDRk+cHf+YpwMj9HgfI8ClGPyvsSiH0WSKRuYlitLb/zHM/JOSs5C/YIC9cMQDZr/dwxgOW9gtGYUBi0wA8l304vDQvAchilFbpIBQhZ7Ejq6ZQ0/Yhil8y4j89Axie9DAsD6FX9HOK3QtROTFkviN83kG4felIY8DCeLrSeMDSfsEovAECUFsTjHD+tcB+tkFgcXKvBRir7qtFl9owmO4Xy/1G3bAFfPrZHorFNWBFwHjQAFctIghj2kBarw06If/+MM9ZqTN6DgsDojCerjQesLRfMApvoGkAWh8Ob/tgAPSKWCp8ngNQtadjmTdltvNvn3peFYhgQQgh+iUmEaUAUoXM1yRLmWuFLaE9Z+XIAWBhPF1pPGBpv2AU3kDTALzwmqo6qtVh9kJErAudABia38TC5wJgS2xIhAwBn3yhByL4EhzXfRXxYsDTJ4IvrNN2JFMxZcBzVo4cABbG05XGA5b2C0bhDTQNQLZBYH1AVsQSAAU+imI1obHyblnjG/kJk3U8BHz8xVUQAhnQIl5CyNgKAGp5LKSSCoAySh5Jj79vTagcxUaIBeRNe79g9gq+DXig4wGzy+PONfT7RWFA4noAkGXZVAhcBckJQgNgrLiaNb3paIDo1vHHX+oA9LQBi4DxJcOUPJUnTgU2NJUyROs8irGARxQAC+PpCtsFd40H/AEf0gMQkLgeACT41PiGoLOKqyrJq3K/Ya9mNyr5FusN/uPLPIeDa8Bc+w3rtyl4VFHaMZc3i9RWBM9jjzgAFsbTFbYLRmm/YBTeQNMAtD4cBKDXBTQGdAB2MGBo8SCLmEuS1AFVAJ3A/NhPt0PoCcA8bSDG76XI7aySg6JYuGfKwJHFgH0E5B3ueMCe/Y4L+xVHAOZ+9EHcEgQgwbeiEYx6jwTdz4qfu7EhEJqxGqruf/RnHIAEnxgwBM0aC8aUAYWNBRCmoIll4HTqO122QcZbrgMWxtMVtgvuOx6wa7/jwhtoGoDWh4MBJ16WN4lfr8AqI0TVV1O1fa9BbQzovkAy4Ed+NgCQUSxZCFWvCOaOFREXyUwZOPIA2GdA3uGOB6wPaOz+QPv5S+MA3OXiN9aclghW+d3IgupBF2pPqxcxGenDPxfSRh2ASiKKiVP2PaZScvAKoA0VDc6cOlIB2GdA3uGOB1zR77iwX/F6AFB9ONSOQW0frA50sILVcckWJyIDSgwPAVcJgFbYuZ3FJvAlEHbJ3IsgJLGedeBIA+AAAXmHOx6wo99xYb/i9QKg2iAIfDJEJHqj4SExbEty0gkdhB/6P9oZbBZIGiKYVb9GKaN50lRHBLOvhDxh/5EKwDUG5B3ueMB2QGM/grb7/6wHAPNGMAY+GSGUjC52VX2f2CD4+HO0gqkZfegXKgBaHkcWtS0AWii9xG1ImrLlN5XR8L8fmQD05BVrmEENmpYSP9QX+KHiqj2/82+HqqDWwnbBRfGATdzAegGwru2DpRq7Mzq2fpAf0Nq0Rl2wBXzglZ4yUAPAmDSVWDBPHQjLcgTqOZ6zUvdKHh4ruDCerox/Dnu7YqwXAC1NI/QcEQuK6WK/kdgCTGC0PYAP/KIDMBgglq+hIkrOfsaCviLSofcJgJ5AdM7kkSaCj/HqQKVIGvD4swF8bcBjmzjsaQ2H5D/6acBd9wALB4DFWWB5AVherMp4GKIYEOp7+26UF0aSfT/xYuDG7wDjrIpAERytXf2vajj7ueryQXSFl10K/ON3gIWDwCLvjfGB8Z54O+Ee4ve6513uB2R1yzsqC+twbC8HcNVhfAeaBuDP/TvwtS3A/ePAIfYFVlPq2HHTuyulZCTlhbjhETF5yxTQGgPGhoHhIWC4VSXGD3n0tLkMHXHxu+YyB+MlPwDuZs5K6FlsbCzdVO9DuKfkHM8AEkP7B8fOkwDcD+B7np42+JkGOvKdAL4E4K8P0zvQdET0b14D3DgB3D0B7B8HZka9WzrD88N6sFm+YcUjrn7E1ZDvMtF9DBgeAYaHgSGB0PNHCD4BLwLRsByAyX/ij0/dDUxuqlIG5hix7eFhvLcOVUAtyPSydAFmOQNe6EYGV/9ZESiKgIEgtbaD/gHALQC4ovY5r5KwtjOU/XfTAHzzLuCmIeDuMWDvKHBwpMoN0WQzNtAaYSs0K4ZlOSAjGG9kPjCBRwZ0ABKEBJexYAZEAU3A7Oi1BeDym4EDnjQ1TwCGWMW8MXcKks0YOyZNlQOQjcgYIUHllEzYQ0ktm+r6oz8G4F4AXwXwRd8/kO9A0wB8y65KmPxgGJgcqYJTKYpTv2CCzyddQJRDOjKivn+Deh8BF8BnwBtaCUA+YYEyAU8h+c6Az9gNHHRmrgOgmDA3jHQ+iWupCeUAvNSrA9HNwqx+muk9nJVNg/CTfrmbAPwbgK8D+PcHkIibjob5o13A3XypWsAkG1cPA9PDFQDZM1id0i1KxsWfOrKnAFXlifCFFMMRcASigOcs2MGAIfE9iWXplS6On7UbmPaUUTXQrgsVMzcRj5Folg2V5ayUA5BWYKwOxKUafnosWjcJwk+7W5F2EKvlE3xcXaNYfiCYsGkA/smuqug6hcleAnAImPbO6YwRpMgjCAVAm/yQmKTv5hNsAf/i7SyNBSl2a8Qv/4/M1yF+BZSYlNQCnnVrpbC+mToAACAASURBVJcaI7sOSEY2NpaDXLqpR+vE/OVksDgImgGgghHoYJbTWc7oJtFWc65/cg2AYvh2ALsB3AzgVv95nS/f4QdsIkT9T3cBrGtITWZfC5hqtQHInsEGQn3UDDvEDEY/ICf7SxMOrAg8T+c00JGkvHGd2DABUYZIAONzCUDppCFhSukCBsLQrFtZe/IixYQpSyEoJoqnuPWrVRAubQh83HNlZB23z7j1ywmj6CIIqUPxw2Xeu9bx2jx10wz4Z7sqTYZaDD8EIDuoE3hMVEphWg66JIp90k0sBxBcy+iPIIaT1RtEsHS/yIAqw+VSNPWQfe5tlVEk8auXgVa5BUsEJuT5uoliAbE5AGotmIAjCPnR9xDG3TQernYAUupTdBGEFMf83OkApHG+XlvTAPwfuyrgSZOhas3u6cwTsUBVn2gTwyFMi8wjHZAA1M9fYGHDULJD1m8Cpa8fRxDad+l+Ykf/3XNvd11U+qiL39SxXevSsshdDFvgbI1O2AwAtRZMZzTBRuDFjxe1Xg8QEIB8yyj5yYIUxfQIkfkIRnmHCM712JoG4FsdgHHp3ACoMH2G6jM4lWzoQarSvwQ6MSB/vporVaFkh+mCLlpVR8Z+dqDZLoDOpHSiQeAFDkBjPrlgCHgCUaFifg67H/9uYjn4Ai1vpTERTAASBaoQJBAKeNqHlL6mwPDZYAOROag/EYRkPX34MwHIvzW9rQcA+TLpI22G7EcQKlJGsYIJhC6ClUMiXfBTbFUQAej6nPS/OuAl9pOOqIc2BLzg++3VmWgIEUz82cRuCAtLIHQQm0gO52uOAb22sC3JEWgRfPpZf2sQBQIgLydPEIFGwPEj8MlF2bSbsulghLftqsCXq9HGgHysznrGgi5qzTUTFH8FLhAUn3hIJwCN0HLncw37qaF2zoYvuKNivmQIuUNc7GvWt6sHNs26twA6vhyq8NEMAHlyntFrDCcQehyaPTl+FwAbXDcmAKMRThakEk8Q8kPg8SPL0qzLBl+A9QCgR6uZGs3vfHz8TtBZvkgGQrEPBVAUg2Sij50QAOjiVKI3saADJRm7dSLYWfSFDkCem/dhZeMy9pPY5QvSDYQyUJoDIK8qMezh3wY6fSL49PcGgCAA8pScJLIgAUYQEmz8RPA17StvGoBv39W24eREiBoNQSgWNI1HBkdgxJSw1AI+dFIbgOYmkjimQ1r6XXC3rAbCHycAgytohf8vsB/r2KRaRq7zpZ+D37HMX0s3DDcCUGLYaw53MJ4YUODzusqlGCQAOQCejuxA8UULUkxIwAmMAp8Wa3qkN/R9W+sBwOhIEPjk5SLr8HeKFbTQfb77csPIMHGl/4MPbReslPhNe4+MiTpi9AFGV4nI7MfvagNQLh/pfrYnDAS8aJQ42A2w4em2cAyWQUuJVQTGWLs1uL7DG9J1RjhA+jvYk4t3KXeMqijpzrud4At9z3XtP16yGfjKZmCGooYh1tZzvv8xXPFl4PoJYC97k9FlwZWD+Azi/deMZWeP13eQCGEyoERudChIjbb3mJYwH7V0QIKuCwj/gfMj0asn2I0FXRSHXfL/iRkNgLyeVj8ccMY//J1fyxzTAXT2+xoQViKYD/1hDqLxPiYxTgSvQrphphG97tz4Slqafnj7uk1kIQDZrvWTw8B3jwEW+RLxPgSiCERdPwPR7+wCPg/gulFgfruDkOMQkFc5x84e708JAMmCuRNBXi4TIg5CGRzGiBGE/D4E/C2r2vcAYJoify62i0aJSMhB+2IHoNwu0fkcjQ85pu3ack5nIBREqneYFyWLkAXIJHESe00Cyx5QyeL6F/tyEcDcrOW2n7fX8df0mME+/vQ/PQjhoy3gzo3AISYf80MQaQx1peH9wb7v2mrtmCBkIMMejp3jIJD1MsaxaMZ8v5N/67INAsB3BAYU4JL4DSo1J15AFPAEwuQHZJzkKfUAtOHLJSOQRWndBYQvCQA01cfnNopfsaCJaD2baBn79QjSTiOEP1EcawIpkq2kegBTNgHWEpOKF8Uwq2NRFPM4AqCf46/rA2U9/uVDvurB01zvAJpiiwOl3fEeciCGF+Ij11f+QkbSfMPfIzqw57mEFZ9Dl3Ps5HXWAYByHJAJKV7N+s0cCQQhwSlfm4lGZ0KB8C/rABgZUS6ZHITBSEhCowUYAAksF7cStWREyxRwtuPpOlgw+5s9sq6OaIJIIlUgEhA1edoTgHxa9HVw5jibZNF+j/9yGQA/7pbujZ4bwv2+cWB6tFo0NzYnkxFA+cvEAo43VBoEo2e+48EMXEOmD9F6xhCE8RwZEJ80VblKvDlmzwicfqy93/o+8K8TwB2jVSgW138FrJQTXBNlnJgmrjZwanow9CBP/rL9wF0jwAGWDtFyoN9PHutnIHT05mPXz93dMGQAPniJsjiBXiTbxDZFMF9NLUPQxKR5qezz1Y6/YZDH0D6GkdAkYJIvRalAdHAMmPZoYhb6NhDWvEyf/ma737CXN7R1ZC7hUbPgcFgqt/ZZjADnM1xqEVhYBpb4CUk5UsL7jQvj///5buDrLeCOEeD+YQchYwG9VIfyg1NaZszFiCH6DkRGLze5/dgk8IMWcMCjdCiCzR8od1B8OTwvJM8JEShFut1fzMhi+eRJr6LI7hYP2M/xVLwKNoZjUTwRMAQQmYyhWGQxsSADOflZ4kukj7PhZ75bETjBpkAGahMkcrGgwhsXeCyBHBj1wmOBQwvAwqKzoFeRV8ZaerjKYAuirmPY/o9X7q5Cyr7fAvYMAftCPGAEoYlBiVtFwLjtp2U4irj7yOANbi+crHyrfCbTquJV44O0F1FrwQGIMZFqdQDyP/gGSZ8TC0ZRRsOlVzzgasd/u+zpMByLehAfCgMQCDyGZJHFCCgLZ2f8mgI5qauEcVx9e5vACTgCTwEMWr5TdIpWKJb5MvrnoocDswvAPAG4VLGg6UKeqmi4iuDz4er30oX0FP7u5moMvIf7W8B+jwlUNAzFnlZCIhvGFRCeWzrgXSSIBreXTFZSgVLHAp4UHOFuociEEsn2PJwl/XEk0dzfSojeerFg1IOo5BKAveIBex1P67lgUzgWQaJwLAKRH04i14ItgDKEtGsRnWx49b2Vkk9wUefTGrKCF7R0JxZMqxN8cmPAxWcAcxGABKEAKPA5u9lEaAbCmKMI+sDN1X3z+ro24wEZFc0VEE64ABgT180PF9ZdBcDb6JpqcPtPk+1ACbmKjJnllwyuILunEAWjZHkBsrsRUnfD0qEiC5IJfyisgMhzWhcP2O14Ro4WbASgAMQJ48SJwchmBCDFa8qpyBbSP7OvU4PQ0p2W7+LSnSJUFOrI4V7w5IoBTQQTfJ6oTSYk2mQcpGRyH2syGjIF6EM3V/fM++C1CfwUExhCsmzCaQT43lZC3e1hBpEHh36XEqrB7Scmq5dV0XZxmV8WuDFzAF9iwhow9seAGoBcGtKjqAc+1l9rLb/1igesO55ysmCrC8ei6IxRMAKTWNBi6Xw98xNTFUi0jEcmpYgRAPhddpVi9OIEPP5cYD4CcLkCooHPwaW9kV+iwWrQHT8uA1fd3F7DFvgUHUP2k8jTiogAqLoxFpDgbMj9jXSuN7i9dLIdaxzBp5XVBMIMgFEnFAPKT9qPd6A9BIGI7MfPmf4U+40HzI8nWgq2PBxL4FEkjKJixGRRFyQQPzzd1iAUzCAQas1YOmAEoFjwkecDC/PAwhKw6CxIkCXwOdVJLxTobMjBdyIgfvimNvNJ7Evf4jWtdnRYD1YNGVuG93VWuWs4Jf+mlZCCZxwP/cnJ6mXVKk2+tK8lQQVHRTGc64SDAZB3Ey3JcxyACkToJx4wHl+YwqloGDICmYmTFgMQFBET8yyYzyAG/AfWX8mCGQg0BTRoHwt9KVaPE/HQ890AIfgWK+CRAaMRYnVdxHbhdY8Wslw1V93UDsmPIj9GxgiAioRRMIJNvoti+SW/Ikd0gwAU8+XxJcbGITJPDvI6XdCFREFSknTB83xka40H1PGF9dnycCxFwygkK0bASJQSVAbAYeD98xUAe5U3jKIwBosSgNsuABYogl3/IwgFPrOIg1Xc4ZrpAsSrvruykl2ucykapkMMh4CExD5DwJfWAYAxwk4MKPAJgOIjGSEGwuCakRhemw6Yv0UUwRf7L00L9pnsNx6Qx4feY4O8pDEcixOjsoTKKpMYjSFYYjOC8Eq3Wnnr0YYS+0Tmi2HysrPGLqwASNYzBnT2Mz2QD91laxLB0gs12GAh81cf/o/OcHyJ+qj0S/zxnhUZbSyYWaL8+Rq2S29wowiWkJPan4MvgrDDGAlRe7KIywDIgR3meEDWg9HbJgApNTkXo8o0i7oVgxnEgFr8F7jEdnU5GvqfJQKQKyEOPlsNIQvyvupAGHS/Okv4qv9oh+PHxMLk8ggBCRxvAmEN+AiEzz2iQfQBeNmkh4K52hJBKOaNe/FSLobLRXCz43rQnu2yi9oMSMDxs2jo8303ERz1wsCGZECF4kd3DwEYYwJjhoNlQrgIjlYodbBPrwMAZfEmyzcIv27gs6XDzC/IR1DOgA9a6DRz4wZAsZ+LYXvQYsHoD4ziOFklna6YD3+nnU6dZ7bGDAcBUImIAmEUw/zbJ1i/scGNDJiLXmle3RhQ+l/aq57gUQCWzwwBKPeLsZ/LFrGg/ShRXAe64Ajkv30kALAjF8R11Dy3K7KRwJcsUTaqWScARou3w/INVnCH+A36n8RvM3nB5XP4oD6DATBYwGb5ajlOLOh6X8JaBKRG77+7ygGYp1bn+V25/01AzBnwQ1ypanD7KWfA1QDYC3zJIj7KgOUzc9nFbetX/r+O5biwNhyX5uSEDr5o0xsJwLp8/m4A7GaJUv/j3/5+HQFYJ3oFPPkho/hNeqBcMkcB2BAA6XrxmMBkfFAci/m0JpwzXw0TXvXtzrz+PKc/Ml/ugzM9MDqCAbz/keVjjGcQA/YLvjoguo1mRslRI6RwfsiA5nqhL5D6nscF8gfTdfxpS+/hLzvWfzMQCoB1Fq/8b3VWaPIDZqsRV64DALsZHVHs1gEvsqFAeBSApQC8pHK90Oql4UEAyvCwNeGcBXNLOPMLftgZsI75ouUr9ousp2TEyIJ/sU4AzC1e+WIFshyAHPZREVwItrrD3wGAhibTYBhxVpe/xePyrNBuWaoNp3DgFwC81O+RAepK/a5Lfe51jxr7JwA83nPXYgq1asl0yX5N48+f4VEGLATlK1vAo5YB1gBSRmsM+NFE57lcfPD5pPFWCJImtyvGgGfOAacBYO59zFglgHgPefZsXV6/gPXBYeC0RVgyJNOGYuJjPka9eHWgjL9bWzhWk0/n/wPn+k8bgFNmgYcsVflZnBRmIShtJM/m7JGibGBoOIIez9wKPP4AcNpylfbNlGfdI+9NjBjz8JVzppckZuJ+dBw4aQ44drk6j1LIY9JkPD7P4s2lwVEGLHwJnncscNIh4Nh5YMsSsHm5ndOu1BGFThJ8/K6JrZtoslST2+XHA6ftB05ZAE5crgAups5TfaL6EF+UyIif3gAcOwtsXep82eIYY9JkXpMgMp/AeZQBC2b8OduBYw8C2+aALQvARgJwGZhY7swEzbNa88IRvAVO1qkF91J36DNOBE7eD2yfB45fqphLnevzdGeBKBfL8UX5/CZgyyyweRHYsFwxYHzRNK6oetSBMDLjUQAWTPqPngpsnQK2zgKbCMAlYMMSME4ALrcnR6JYQIwsoUnjpDRstOLy7cBJB4CHUGwuAtuW2nUDVH1EFUhycSwWjGD64mZg0xywcaECoI0z5P3X5P6nWlHdgHgUgAUAfOYOYMtBYNMssHEe2LgITBCADkIzSJZXpCOnIg25uPrhgnupO/TyhwLHHwSOmwW2LVSik2pCrDsQskzNIBGIpBdGI+VfNgMb5oENCxX4yPRjPj4xaJ0+WGeEHRXBDUz2Mx4FbDoIbJypADixUAFwzAFI8KUJChMV2SUaAGc1cE/xFJef3FYRti64nkqWDrqqEhbrsm5zvZCdPCd8nHzJOLZuABRz9hTHZwPL7LnLnoNMIY2VyaKcjtZLHOAbNgNPngKe4BacfGF1pnydD+hphQ/8XV5UiEueLGnDN1tWXj/3/4cTwAUzwGPcRcFJiDpPt3FLmf5vjwE2HAQ2zPrEzDv7OQg5OSM+ScYQy5Xbo8465u/ZfLTJ7fKHAdumKxVh8wKwealSE6inEoSy2MWCdbUHIghv3AqMzwHji9VLZuDzD8cXxxWZs5c7apmW0fMBnIHKn5X7d6I5npvRz94O7LgXuGIReJSb+Xl1tzqflybwRwqf9i97BQRWomWJQ7oZVFtJoqDX/b/oGODsvcBTATB9gsfGqmzdjtVz+G+PAyamgYmZCoDjFE2anCVg1CeJwOMnTRB/DmUINVkkgia3y08BtkwDW+YqAFJFMD1VAAw6XG61R31O9/fdrcDYPDDmY0zjc1UjivBuAMx1QdMB+WAYXU8dhEU16dOSkppbcHFSrng8MHwnsGMPcN5ypURHp2xMIa7zDz2z8Gn/kVe0YomO0wEwBYKujL7v/zHA6C3AxfOVh58g5AsZxx4fZM7sf3h6BcDxWWeGBZ+cMEFiwGEHHRnDzun7ONHs/djkRgBunql0VDOSHIDU3cxSD4aEajhFXS4H4S1bgVGN0V8we7E0Fh9jVDG6Obr1LJMRwn+kOCaTEYT0dsfqZHXl/p7PrLi9wIY7gO0H2yAgCAWCWCowKrYE8nMLn/a7PQn9X7zIJPPkCcK+758y7x7guNsB6l98gZjLLYet3Ay5n0sv4R+fCYxPA2MOwLEAQLIDPyP8uBg2cRYmzFweAYilKkn+OC8/Fdh0CNhEA4nGA40kd6FES13WLO8v1qHKAfh9B+DoYjU2Ak/js/8NAIwg7OUb7LCC+WAfB4CpBJoIiTRNRmS1l13kqWh3Adv2A8cdqqp1MB+aIOSxWv6pq5D2kkIAvt8rF7BLJksN/jMqfa7v+7/Ak4B3A6ceqpasKMq5akAmlLWY37t8ZW97PDB2qALg2BxgAFwANEGcnI5JcrDZRPlkaXL4u1KJUAfAjbTQ59x6dSvdLPXAgGYshZWR6JIRaXB/NwFI8C1WwLMXzMeSwLfcXuKrA2G+wrLCDcN/IIg4ERRn0qvyySAQX6mG1XuA4fuAbTOVwktRRr2MLCoQyvEZ/UY/WwjAj3jtFJZkU79g1ghkgEBf98+0Umb/3A2M3lkBl/fOcdMok2EjkZyv8773LAfgHDDKjwNwxEUw9yailpwdxBAEYhBbAuGzG3aKkQEJwAkCkOCjlb7Y6SYyf2UwlAS+vKYnAXjfNmDEX7DEfA5CjUcsnzvbu1nDtUMmCDkRZEEyGdlAk6G6lQTSa6m0MP6HuY73AxNTlcJLZ6WOJYC5/CNxLpHMgdKIKNl69Qvu6/75AjHOiTU87gKOOViJb748BKCWrnK/maTA+58AjM0Ao7PA6Lx/xBAupoYDC9okBRAmPdBZ47lNA/DhwMRsxX7mPgl+SrmK5EaRNRslXFQ9CKB9DkADn79cZtkHFkysJ103eBbqlh97DpmTQTYgk9VNxu+xYbXKU3lhFoJPOgdFGY+lPkgQxokkgF9Xgj4AvfoFs84eX4Ke9x9fIC+tRfDxvvniif358sSir2LCj5wNjBKAc8CIi2AxxLCzIAGY9L7AhGIKgpATw4l8wToB0JjPrfTkp+SLQbHrOqm5jNyajS6VCMIpApDAWwQ4LrGgXqzIfnq5cv0vN0ZXHTInME5GBNLb1DGdOYQsI7AfGKFjlgqve8wJwG4T+fuFAFytXzCLb+VgWnH/fIGYfc46Hs7iHC8ZkPcdXx4VfVXJw8+cA4wIgM6AHSLKWZCTESfLfg7WsIyRF3ckiRQ+HACXkwHptyP4KHrpJvKVGnOhRF9eBF9wE0mUEogz2wC+WGI/vVxiQQIxAs9+rmHA6E1YFYB8DJwQMZl0OrLZ++i7sfT8zroYHLS9df4RACWKxSZvLXzG/fQLZqk2gqn2/vUCUQ9UZaM9wDaPeSPrC4A5C1KV+NITKwCS/SiCR/jRBDlLmP7nHynsxno1IPwJSyRpbiMADXzuPDYfZfBTEoAmcuVQdiaW0zwXwQsCYDYmMaDA1wG8TBSvaoR0G77EcGSET6hjOvVApfRPAUN0zjr45JzVcSqiTxD+VeGzXku/4Nr7JwDJOkxFIwt6j6+RqUrlkO4bXzp1gCAAv04AzgLDDsBhKugLFUvQUhTwCEKbnKCw14HwJ9cDgGQ9WegRgDI8XEcVEDvAl7lVlglAgi+I4CR+Zf1mLGgMmDFhBGFfDCicRJFERviSABjLS7FC0MFKMU+07wOPE0kGvaoQgGvtF9z1/iODkwn3VWoEXxres5ib9xx1wZufBAwLgAQexbAD0JiQwJOuJBA68/H3Zhk6+3CifqqwWNMKN8wjKgbk6gWJgC+FMaBb5vJVmsUbV2vCqo3cRWZcCIACoax53+ulkqNd7iqOcU1WcC9cxEm5kQBUdZ+sTnSL/jEtTWngi21jhJNJBivZBukXvOL+yYBkcOqxKjJ4AGgxzMrBVwdAMmHrZOAYF2l6y/mwV6xD17zmWo6MbRyeWtOHwxJ91IIhr6rqZS70DPPLXDVUrfBwzHKr1EUp6/h0T/6L/GcCqslt4IhoTcwdAqDSs7I60WQH6R329pHuFyuXDJmEjuOSbdB+wSvuP5bGUjmsA5XoUvcvBXKKAQnApUdXwah0b8jXR2YzJTsC0ZHB33FL+2yiX3h/1YeD1fFZGT81g/H6yqkVa9YEpqMhTADle8erHA6t7Mh6j4ZBXdBGjFyO4CSIm9wGBiBvgqxwIAJQlXIyEJLyI/i0SkAG/FbhaEr6BXfcv+5dLKhCg4z1C1HEBJ8+BODQGZXfk/quAZC6ketAZEQCTWAU8PIJt0fgwHzZvVWNaKqi7JLOmtDWFy42g1FxH/XfqGkII0C+a0tnDkfsGxQjn3VPsk7tXmuy+Xp0JhtoJosAaFcUAJUYKiYJxcqHqKAH9rPlG2cMrmCUbMX9guMLpGTcCMKDlZGhMK8IPnPIn1X5PA2AwegwEEYmDGBMjOI5whGQP3NPBT7VJlRNaKvF4t2IWHbDErtDlSk1p4lJ7/zd246tglGZryIfrFhQ7pU8WCAX0ZENG+57U14Z4YrCeLrSxXdev6TfLwrbxT7znMrfKQXfHLQCnyvmRIv0Q3430ezMmL98P393G3wqz6am1NYzzoGn+svqRmTAU2citctqAX/2EI8F9ACEmLHXLZGoFxtSl2xyK2bAYwrj6Xr12+1noL/jUTCD9vvFrn6u0v1/nvGkaoVBAQi0eummMAuXQHMWJAA7gCixG8U0gFfcXdlBKk4Z6zELgAJfZEKrxpC1xOIl/+Sk7jkcdYlSco90y9+gK6vJrRiADD0piad7RuFo3udNCgft94vCdrGXn+tujgV3QAcHLcFnroelivHkchEL8ue0uQ74S3eubAITS3IQhKkMRjBMokgWG3L//2z3VSnP4VDgQWxUEEUxAZFHL0eR3HDfm3IRbDHkBfF0zy4EIKNhSvr9goGEBdvTz/MIYQLQdVsTwRTFDj5jQmdArRDYJQNDSs961R3tPhx5NXoVgoxleHnarjohgLec3D2HI492yQNvIwvqO9fJm9zKGbAwnu6FhaP5pFuMg/b7tTbpBdvTz68cz/zI8azVj8iAHTqgmFHXDUB89R2dtaC7tUGw4kDOgFb0R2wYRDGZ8g9O8aU4XwPOczhiwGlMjqqLWiFYGu570wADFsbTvaxg8nkow7E8nM/atfKzln6/1mS4YHv6BQ4+Z0BbqHcd0NwwYbVD3+1yWhXJxPBrbq8AqE/XApSqAxiBV2MZ/54DMOZwKE00rnDUWcR5KiV/brjtSAMALIyn+/mCyeehjIYp6fdrvVELth8RAClyHXxmhPi6r1m8FM0ucgk8+y4RHC1kAK/5XgW+2hZYofafWcPq1B5AqDqEYsQ3nepR2gqhV2yiol1COkD0C+aOaoGx4aL7DQCwMJ7uVwomn4fm7VrX2u/XAlELth+5sHPtN+l/Ap6sX2dCsZ/phZkIJgv9l++1wbcq+2WFv2NXIjNKAPzuw7MUAV8DTuynFIEsQy83RgTAhiv+NgBABaQOGE/3mwWTLwAqHnaQfr9GnwUbARgDNBUlkpzQboyYCyYDYdILdf0l4NduW9kGoa4geNdazLElKoA3Prx7DofiETtC6XvE7hGEzJlpcis3Qgrj6d5UOJoYDcMglrX2+y0NPtl5UZUjkfx/Hqbecoe0OZzdF1gHQrln9Bhee4s3f3Zxm4MvAk9VSFdUIw0i+Q2PaBtISiBSSFgCYMjMW00MP7pwvvLDmwFgQTzdHxcOSGvBg/b7ZRZByWYAlOERluKM3Ra9CKWc0q73dTBhMFT4ZwIw9l5Lrpes+HjeBiGCUOKXeuBvPcKTiEIOR0f+RhDBMYi0Lhea4GTaa5NbOQAVDzhgPB1La5RssV3rIP1+7yy5OAADoAchEHBkFbKfGRpiweAPtMs5IFNokyOGk/7rAYC9OhBFwNXVY1at5tftCBHaWVS2AJdEcEinrDNC+Lumiyc1B8AB4+muLARAXTDCWvr93lR4/Z0Xt6ODFQkj8WtumEwHTKDLQejAfN3uds/dfjoQdatGLxb8jQBAYz6/boxiFgAVudzNIc2/s3xLk1szAORoB4yn+2DhaATAGJCtbpkCYq9+v4V+aBgAQ4i66XtaC85YkDog/zdZvzUgfN1N7a633Xqv6fe9msDIHfNaB6Ay2JRE1AHAEDIfI5nzZCLeN4Nbm9yaA+CA8XSsul6yqV0rJ2WQfr+splCyCYBR/HJyKX4phs0PKBZ0lqOYTpvniAiUAmAd+HKjo1cvDjHgr+3wPJQsVCymUZrPMuRsRBDG4AQCsunyJtFGHwAAIABJREFUcc0BUJlxQoH62q8ST8cggpKNAFRGwCD9fkuvbwAkyGgJE3C+Nz1P1q9/T3F1EZBxvZh50s6AEYC5yyUHXt5/Q8zI5/KrAmAIkkipkyGPYwXz1aRT8v5ZO6jJrRyAvKOvNXlLazsXs9bo/ztc29Pohgotp5J49Rcj/pzfIwGS//3OM4CNd1dpntQpFUmjEH4LYIgnyn/OLjL8FeDGhwJbNgFjI8DIEDA8BAy1PFK7FSKf43cNKrvHx+8C/vmxwMgmYHgEaA35J0StpvvzL/nP8RbLAfhyT207TChgDRiu/ZL9DsfWNABvYzbhCDBKoBAk/pEobGWTqp819hzQ1/0k0PoaMDEJbJjxVZFgDad0SaUO5LksWVj+XScDmw5UEUDJ6U4d0nVbC91S3ovfVHp5al64cgC+k7mZAP768KCA0WD3A/ieLz090CDceVmlAuhBljLgrfcAw6PAyDAwPFwBkCAbItM4a/FiNtERjBl76W9ffD2AbwJDdwFj+6syImRXrd5Y2FjIYcnzWPLEqnsfC0zsr6qBMQmfIDR/pyJ6xMhKyMrSDiKD2xja6TADTt0/AGAs1KcAUCFrOLF6tbtiRVFavT/wuMCa7MfVTlH098YBeBcwNAIMEYAUlS4uBULOmK3LCnwOPANlEIOSoF9+C4DvVoWXhvdWZVOYqWgi3vOXDUQhgieB0EElViMYJ08HxqeqnG8D4IIDkAzo51DKQQJvBKUmKACzbM4+5hUivwrgiwC4LzvjmgCh6nBcgiMTcv9Abo0D8E6g5eCjfpUA6AxoQIzgi8ALmWwC4z//DxcPPwBak8DQFDB8yJPpPZHeGCyC0KN5DFCByfh9/+OAsekKgEzCTwD047X0SCPM1IYQjCv2E/MJoGVwUUQoPboq0MdqkWVn7RtDDMahB4g+P6qhXFpjVtkDtRGA2nKjos7IyOyHFUbIrXe0FXsTuzIYfNb4O2M3ATGIYQOmPn6hG6gi3eUkQQAeAIYOAUOzALMVh2pAlESqGFBAXAYOMQVjxll03iO/yYKRAT0FQXkwZkjp1pz51LO2XAT3KtD3AIAwj4Wg05kfiuUHYlsXAJLVnP0INLM0OYFx78AzcRySeTsw2AJueI+Dj2Fne4EWKz5MA0MzDkCCkAByUWqsJzarEanzj2zXwjEGFHuGY+pYsMojzZL1G9EBexXou339IRBrC3lJGmNDuSHX+w7WC4Cm6wWxm8DngLTImgC8pBcGBuTXf/1fXnyTugnFwxTQOgi0CECyIFlsvvJfEnh0mhsYI/s5uxFYi1xZof7oOqSAawwYjRGBzYGXbtWXaCIrlvHUagX6SP/ruMVYCEbEqECXAMjfree2HgA0ESur1/0vtnNwGSsG0RsZME20/+/XWH6Mugk/yngPAGy5GDYALjiIHIgRUIrsZjM7Ax+BSx1S4pfffQVIep8dL7dMDsTGjJB+CvQxTHmdtrw4l0CovFruC2NOe975egDQsCXRK/eK634JhBK90q2C7I1i+Gt0jxF40k1cPJAB7UP2m3MGJAAFQrGei9iUTH9yBUDTHfU3B5+BOIKQ43BWtNtPcWIOzEZE8FoK9K0DCGNxLi3FqaKA9gTgeoFwPQAoI0OulWT11oEwiFz7cwbErzNxWtEYBB+VY76Vh4DWrH8IOoGQ7Ocg1CqMRLPltmxvs1/SHaP4dcAJePYyyUCRIzrTB8tE8FoL9DUMwl61kQQ87Rmy2PS2rgB0a1ci18RudEJH57OsY02y/+83/sZdBKr4FXQTApBvprGgQCg9UEAM+h9F6ugJDkC3gJPBEvRGrYoYCBX9IxEcS5K4i6cZAHIw8oXQ4mLBb35YH5d7OekadtTV1UZSjaEIPH4nQzYNwgjAHNwDuWGYpZc7lzPfX1cQur5oBorfzDf+zi0yVTuSkuxBI2Q+PhQDIUEnMLo1TBCZLufGw/ixbQa0KB8CTODjPohdY78IQmfDjmW7Yo/doAX6GqIiAtDHaYswSmeMubV81kp11L6hy2PdAcgblfslOKC1IiKRmyRxZgV/8++DS8BFrxXi5Hd/U6MeSKdqEsEKhpBRsgRMbAtuG4KU/+9ry5brzP/lPVMv1EPOQegharrVcgZUhVHFxNPcp9VFtlOWkL437C0WABWypFRGsV0sb5Hn2zYBwvUGoKl10v1knDgo0y7XA8Pfv0UACnjaK33Co9gJQAOe64FkNvtZAHQdjz9v2Nz2GSa3jYej2W3KGuZ9ixGdIVSoKT13B2s5AHkGheST6qn0erHv5AIgAAU+LVfw/wq3CEAV7clBKDDGZG9/5oVXx/oyYARczcqH5GyH8eFplTawFvAtrtXLGpNrQDGbejupB3omlIHQGc/ErzOcGSRs8zrhAbbuL1Tco/JfbLlNwHOmi2kIcs3owbdwNpYtynDQhsFcgvuG9/YapGFvYX22zZcAU0/GwA2LJ/4AmGF9mwEbBu98Y3cMF+uAGQCj2HVp3BbPuo3IlqxAy5wHAq4OfARmEBXGfNIBa0BIsG0ecwC67merHgRpZLwocrWaovuTxew/V0txJQ2DWeae3WAGbdhb2DB4+wRw7w5g8Qpv88liyGtoWHzMi4C9fAEHbBi8kwUKu2xNAdBxaGBLbJdZux1LwAGECYAEm6wyfpelJrEgFnRDxESwgyUxIUsVMwjVy5AYO0bG89Auu1/5BF38KqjBHlUAYXsteNCGwTeWNuwtk4JMkrlzGNizA1hm69g1Nix+zDOBW0aBeRZZGqBh8M4emfWNADDT+zqMjQyESdQFHfDbZECCLRgdHeCTe8CBaKJY1rDnBRCIAuGW4TYAZeFG8ZuMkGiQ1IEwGCJtHZBmy1obBsvVMnDD3jIAerti3LEBOMjGcOpa3WfD4ic9t6oveDtLfw7QMHjnH6wPAybW6yaG4+8D4HIQfvtDIVtLejpBFsVvUI7NIBHw3DUjRzL3rDVtsYPOkAScuX3coNDynT2VYJCkn+PjqvUD8hVbS8NgjphGxcANe8sAGNoVY/824BCBtIaGxRe8pLKZdpMkTvXiJ2toGHzSNHDPScAyq3er4qPyGaNc7JCRXWLT2TjwGmCOeQashq6+qSpZmp8vojQpheF58ncdZVjLnjWPHr4VWKTKxrHGUqq97qXu3jp0wPy+eEC/DYNZsZAO6IEb9pY9lNCuGPcNV830ZmkM9dmw+OKfbdcXvJMPdY0Ng0/7GnDXKcDMccBS7MwdKz8KCAKQIgY0MWGCtr4TOHAasMwOkTqf6unyuLykfd254nkb7qsw/iVg7jhgmSX31Vpd9yRHeLx+zRhjEGRbB6wDYT8NdymyubzDzCCGfpMJWfSRYfr9HP/aMgBm7YoxNQHMbQHm+ID6aFh8yS93tAvGQb7da2gYfPoXgbtPAqaPA+a3AEubgGU1RM6B060fgkRoCzj+TcD+04CFE4BldZdRc4/YxlxgjJMewSiwN1zWfsOngdljq3EmY08vm5i/7j5yIMqpvupKyGoNg9lngYosl9wY/0dZdrMzYl8Ne8sAWNOu2MA3zw/F2CoNiy99XbvftrcLriz6PhsGn3U9cM9xMODObQYWCMANwPJ49UliuW6SaqqBn/gGYP8pwPyJwNIxwDK76ahDeN6uXYCuYyABkEza4LbpY5WEWdSLxjF26/dQB0SJ6r4ByAN6NQxmkWcqrnQ00x1DEDJFjR8CcNWGvWVPp6ZdMQ6OVOCb3wAscPJ6NCy+7PerkP5Q3tBY1PrT9tEw+JwbgPu2AlNbgVkCcCOwtAFYcgAuiwWlM/XqDjMEbP9t4MB2YO54YJFMo/5gHIcALV1TRZ17FXOhPtvgtvkqf9H4kvHDlyKK4l6VzvVSBF22uwjOb7pbw+CfcwBSkyeFEHAUx/yw9JTyEbo27C17Ol3aFWNuAlgIn9QxO2tYfNlbK6MvaxeMRYquvL9rTcPgJ30TuH8LcHAzMOugX3QALo21WXBZLEHwRF1OgHS2eOgbgIPHA7PHAezNu7QFWFZ7JnXJ5rnqxHEulvlzwyVNN3+wern5Yovl7SXLGwvn4riLWO4fgMRJXcPd/+pmOymELEhRzBxJAo9gVL4kwVnbsLccgHEpWi3epocCAMeBRU5eTcPiy/6qtl0wpvhA+2gYfO7NwOQm4OBGYGaDs+5ExYDGgqP+ccAkINaVpB8GTv4d4OBxwNw2YGFrxYCmV0YxLNYheCXau7EhV3ga3Lb8g4+R45uoGLADgHWqhsBXA8K1AZADyRvuvtkBSArh+i9DsQhCOtf0UUgW/7aiYW/Z0+nRrhizoxXwFhyAi5y4rGHxU66qAFhT3rDSIVdpGHzencDejcDBDcDsBDBP1uX1CMJRwFiQIBzxieL3KIY1YW5MPOxNwLRb8gs0aghAss1GZ1O+SFHsdRPt0i/PLHu++dFb/x4mXfhcbWxhfCtYMFr/uWvKxfDaAcg7ipPCvFOVpuo3HrCjYW/ZA+rRrti6TS6MVQ+L4NPH2nx698GnXF0BsKa8Iab4dFZpGHz+JLBvApieqAA4J8CPOQuOBBAOV0CUYbIskRkAecrvAdNbXc/aDCxSpyT4CEIyTgRgneiLIp3nP6fs+a4A4N8B8/48CUC+ZGJA29fpuLmxJW+5h5kNFg2jiWHSi0r0Uv4pCoZsxw8DUfnhd4Vk0XGdGvaWPaBV2hVjdjgA0BlpkQ/K9bmn/HOVqtClvKEBqlfD4AtmgP3jDsBxB6DA7tdbcvYzJvQJkii2n4NOeMpbgJktbYPGACiF3wFoEx1ZMNe/4jnPLXu+KwD4t/5SO/iMBcXuesHylyACMBPDgzGg7opM8mEHIGdwrfGA1rC37AH10a64Yr4APvvOSdwEPOVbKxu+K2pdKRTmdI3dqkPPVgbSTBGAY8AsATjWniBdx0QxJylOFCcr6HBiw1P/CDgU3EgEIMW52M8YkLolQRddIN1AyKWiBretf9MJQN6HsaCPxe4rvgDdHOcOxDIAcmDFDXvLnk4f7Yqt63gEIB/Yoj+4p9xaAbBHeUPM8qF2aRh84QQwNQYcGgdmx4C50WqCFngNsgSvQ+Dxu4MuiawhwIAXVk1O+e/A7CZgThY1dcno1nHL2oDIyZULpBsAFTBZ9pjT0QQgn2V6ufRicS8QRgbs5ZYpEsENDejBfpoLrwAOjgIzZMBRZ0AHoUC+SOA56xJwNlEyTFw5FxBPeWvlzpnbANCdQ1eSGTRybMuydgMggVBsKmtYoC6Mt8znZxsZMLzAxoAOvsh+ydDqtXx4FIDl8L/omQ7A0QqA82S/ERdTI22mNfaTuBIIxR4BhKe+y61punQC+MytI/Zz/c9EuvyBeetLAfGZ5WOMZ9j2/gqABB1fMLsHAVBqhfTcyH5d9MByEdzs+B50Z7voGZX+NzNSsd8cwUcG5ASRKYbdHRNYwhhDIHRgGmO0gFP+HJh15jOXjnyKblVT5Cbfoq+yJOszF8P8+VnNPlICkMAzds/YLxlYznrJwIpO6egTPMqA5ZNDAB6iCCYAyYBcBqTRQ0e4630SxZyQJQIvMJ8mSeLrYe+p/GzGfnTpEIBy6US/out+K1wg+brs88rHmDOgAVCMnrEfxxMte1Mt6j7u9zzKgIXzczEBOJIB0BnCJoqgIfDEhM58SWzJEPGJe9hfVH42un/Mfxl9bgSiBySIBWnAJBDGEDAB8QWFA8wO3/a+wH4+rg4RLPYLul8tCI8CsJmJMQAOuwFC9qMI9g9Z0CxhZz65K0wfFBPqu7PEyVdWAOTHVlTcpxhXHZLz1w0ZA6EDLhkCskRf0sw4dRYC0PQ/vVSRAYPo7QCdj7GqVOSMeBSAzUzMxZcDMwLgcKX/zbv45SQlHXDIgagJc+bjZBqAWhUoH/Y+B2D0J7rFa6LYDRmzomsAaOeKqxEvbWacHQB08JkRIteSXiSBLYJOLB+X4xrzAzY7vgfd2S4RAKkDDgPzNEAIxMASSWF38WsgkuXLyXTRSRCe/DduSZMBMwe6ObTd8JBj24Aot07uDObPP9XsIzUGFPs5+JJ/M6oT4buxHv9X7BeY8KgOWDg/Z58GTC9Xq5FxTXOw9c3Cm6k5fPcjgbHbgAlvVG2tH1T3Oavoq6BlniZ+12n5u/2sDbOvasqoFg8x2Lnbcd1GdhSAhXN+7qMrAC4sA8sORJ6yHwD28z+Ft4fdv8UyqUDrDmCEBcpZ39kLS6aq9l4D2rLb/KYsFTPWdfbvh86vQu2s1K/K+zIjTsXIVQ9a59Egs4Y6sZfIA/EcSp/jEXv8BWcAhxaA+SVgSQAkGAMICcwVlNLlqTc9Gbv/HAA7MrL4+f1VlXwrUq7SvCoyGcrrWpGhuur2fNGYwM8YT67hT3s1LaZvqn5MLM0bzmHMmIFSgdFNj/mIBct63NhFZwEzDsBFgpDPeanNgATfCtGsX9TIKwNrg9tuVkhlng7TI/YArX1VkXKrEe1l2SynN1RCsFJsqnQv3UIMxhwIRjU5AGN9QUteVz3BUAvahuNgjC3HxLAND7nBp/cgONXF5wCz8xUDGgCjKPbvevlzcKUHH2ag6cnYzepYBB9Zi2FxDJdjoXJv1WDFiLJ6MKqKZUzoQFTfj2HmwTKcTpVWvcxHKm6kKgoORAEvVclPD6NdzLXpMT8IYNPcLV7yJGB2AVhYrAC4SNA5AxKM9ryDPE5fs6eeVKWGZ2M3S3MQfEyJUKV8L1ZpJXpVJ9pLilmlAxWkVJHKwIhjjD9TtVXVm1HdOy/pJiaMFRWM+bo0rWl4yM1N7oPhTJecC8wRgAttBjQWdBBGESwgSiV0Pb9DRgu0TY19N+M1mRKh8niqFx3rRDsLqjgl9yaGXT80vcL1wnE252PAZCzAHQCoiqoW3yYWFIt664fUpKaREr1NPakH6XkuOQ+YDwy4FMSwgU8GSRSz0UJx3Vx/5vFNbrs/EiLRY+v4ACITww6iJEodQKwBIyBRv9vwhKzUW6z66TUGEwhDS3ezqusAyNxnJn8xa1KRPSFts9YfFB/QDZcAm78CnDBT5U8rCqjfc3yh8Gn/hGd/MsKf1+QzYJ4891Jye13iy1cAE9cDJ+6FpYrEkidxDN3OtXR+FwBGMezoMmxJLOumAuD4J4rxJrfdH/XCoLGFVKiUbw+LAPQqWWaMMLrd6/+JycSIm85w9lOpt1j1MwAwFTiqAWEUxeYH5ENn/jInUVHeMXQ/f/jRePvCa4DhTwLHfBc4frGqqaNJzLPw6iZxV+HTplFGvZrXZT45N39+HW3TujlZv8D6fp8HRq8Dts9XIOR5YtakgBgdrrrt5Qsq8Ssd0BhQ4HMwmVitAWHAY/LbLDQNQDaTVJ8Q6W4qVB51OOqDZDPVB3TLOBepW5jmqaLbec3jGgBGMSxvvemDYkQ9GoKF1ShUCSKCqBeQrvmfVZPC1keBjXcCmw911tTJ8q5XgOLaQgA+x/OdWA2EGZ98gbjleTHdQHQN+2iwls3nK3/Zhj3VeQhovYzdxmArSwQgDRA3QiSCJUrTnjfl4KozRCSCCeYmt90EoJJbVCk/1+FiCwFZxLk4dRfLFia6x8LbYkD9v9cXtLG6+O4AYQRfrgPygVIcqyhTXcWFOJH8fh3rz7EKwnUArq8mcGwK2MCC1i7WY7Zenh56feHT/jE3yliE4TZncd636gPFCKWavGhcRx2J+cvs9MlSw0Ty3cCm+c7n0G0MExdW4BMIbTXE9UCynvyCCX+Ovm4gbByA/xisVgJPpXrzLj4EoRJjJIZrWHArS9iprK+KcefgiyB0XVKGjOmCmW9xhRVMUSyRFnNeFGEdI2q+/HFXclkp9WsAbgTG9wGj08CI64WxRk/OTDcUAvBHXSLQxcVCDMQSWbzv+1e7WVbz+k5w2tJtsbcCYV6WJY7hmAsDA7r1Sz3OgOgoM+KTOJbcjSI5yGIaNE1uuwlAAU/MF+tF5/0sIghVLdVdM2S0bSzHx2Mi+FTxXf8X925NC4BycK8QwfmgVX1LlcFiykEMcL2BndJJ7aQfijKfxLGDwAhByM7aC5U4qwPzNwufNnNuOH4VZaCPlPo2AahqFqoPVFc14ga2m+WEEL0cAz9kdPrOmMu8r1o/rTsXz7f9oswFs+jO6LAqkvC3Ggg5Fg6mwW03CUI6X12h8lyfcz3QHqr3DIl64DbqaQKc9mI87QXACD6vpJqY0EVxz2CEyCI5eMSGX2e7VtI5J4yTRyZhscrvt1nQuivOAaNLlYESwcySgiVbr37Bfd0/u31yEgg2FVaiPCeVOguqAfGov0iR0R9JABJ0bnwk9nMxw+fOh55EbgRhzozrBUA1polN9CLwok5HEEUQBjFMQB7D+j656PW+IrJ8O/bBCo4sGFdGejqiyYCx3mKe9/JtTiBvmI5OFiTisg9LtJFF7gZGDrUbHKs79+hyu5hSaUvh1foFr3r/6vZJCiXgCDwVVFJ7MVmRLsrGltuFCc68yFdACMDAflwR4QM3HPoKgIExt4gz42SuaQb8hBOE2oZmlu+KFlKR3QSssMJxDPWbbjpfLoJrxG8CYT8MKGZSVTCxYFTIb84nkCxCIPLDiby30gXFghaF4c2ReR466Uu2fvoFr3r/fKAEFxvpqMcd9yonIrkuK5LLV7MVCM+/uDJCyIC2J8a0z1iwqyESgMl15Sa33QKgmtPEBnp11mwuXgO70Ud4DHWzfgDYC3zBEOk7HlA6XKyHQzb8HgGoCSQLqsxorIy1Bxie7Wx0rFaf+wr9Xv32C+56/7HbJ5VHtRYT+GJrsehHcya57PyKAQk6+vBkBZPpjPEExlwU59awg3C24W6KBsC6tqHR+MidyVG3i3rdAnAsH2T093XT+zLr197MTA80h3SfsZP2UqpCrPQ46oF317VrpeiKXTJ9MhMLkgGdCacKG/mupV9w1/vnwyGgCDCKWzJe3lqsyzLWZWe6/kc/oKzgKH4jC7oolhdC4jiuzM0WPo+cPQ2AsX1obFCTO5Jzn566PwbReiwnfTWjI4KvDoh1juh+aT+WKSYD3i8Aql2rJk+VsVQly5kkddv2FvHT61icqO7Fr71/IkLNXOi0FQjV0046oBy6wZ922Q95ICqDEaL4XWw3COcf9Mw73DFB9AqE6wZAAS8XuzGQIDKf+oVkqxt00ttAc+YT0PJ9qRFSB8xoye5Xu1ZVeCSgCLbYLVNswoncHxoeLwCzBGjBNki/4BX3z9lXgUCyIIGmhova83cRgO5Te9yLgP3MfmsBS8xs8/U67ePQOqy9umBUruDchqo8sHSd3PMfT5ifo+ack8eFHI6QEcnT5GvdOnVdXof+ptJ+BVPWceiaRHA8Us/nkACo8mzqlqmWrbFDppT5A5UIZm7CPA2Vgm3QfsEd909kKIqB1qJAKCBG8ZstZz3xHOAAiwmpDIdng1maZQAkZzsHZ537YfQrwNyxoQ+HakrnS0h1mUA1C96TdJTmORyhC3oeqdwROi+GDhkFI6bYNrcNDEDeAkXwQizPRpmnIs3OdqZPSaRFUcbchHlgie6agq2kX7Dd/+d8lUJVXuUzk8ERmS+2vfd4uvN2VOV5rSwb0y3JhgIh9wJeN3YMQCIgR78Q+nDEVYBYZUrUpbXFnM7COSdf7N4IPvtDnT2BY/h8Chh10MXQeYGS+7GGjaQiABpuNIFiECnzdWJMIUHcazLptC7YivsF8/7FgLFMqpiQL5TuNbKfA/DC46rqqAbAwIKWK+timRUBEiNGsOQsyQm+Gpjd4n046hbT84KPuYjOmHHyp92gcgDS2OoIuVIeh/xyUkaVwyEWdLrewHE3uBUDcKIwnq40HpDXL+n3CzbaKdguel5VnFJl2awaghLQBTzteZ0cjLq2A2n0M6EPh2pC57Wg41poLzZsAZNso0Hw6eVR/J8bF9YjWGmVCpGKwQLBRCcrbiSxNLgVAxCF8XSl8YDHHFPW7xeFBRwv/rGqOKUBkODzqgdWPYAM53vTASMQu4Bx9J+69OHIF+N71F1O1gUB+AsBfFqKC+4Wi4BWX+CYgOTAU36wdMVNVKka3MoBWBhPxyiuko3xkSX9fvGMkqsDlzzHC1N6SQ4DoINOe7KelWWTheziObeKCdARApD1AdVnRH048gKUAmAEYi6Oh4DJV4VoGDWqjq4XLbO5o1jBoimEPhPJmwu9FvnTLgdgYTwd2wyXbMyRKen3i2eXXB245FlVYUpVxUpGiLtmGBlrTEhVUwV8dEkVKAq3MHJ1uzRbRx+OOgDWFX6MsXJU/36lJoEoA2AKvw8+uwTEDIBbStdOs8ddDsDCeDom7ZdszBIs6fcL9ror2C75US9IxJJsEsHdGFBil4yYuUwknofJgF4XcEUfjrz+X7fKo4EJJ//PkMORO6FrVjQMeL5kJhZMMXzLwNZCt1nzDFgYT8cQwpLt4hDON0i/X7ys5OrAJVe0S/ISgFY7j9ZvnQ7I3+lyqpYaL98CWp/N+nDkZdhi6bW8An1kP3fRTLKVWlwF6RZCH2L4zDDR0k1IqeTNb2OQSYNbOQMWxtMxeqtkY6I+ny9VEz6btfb7xc+XXB249AoXv85+tIBVgJJ6n4lf6oV+mfjdDJNMH0wAVFX90GMk1f5TxlS3Fggh92DyN0IORy5665KIfCktsl+K3VsGtpVOWOMiuDCerlSnjQ2rB+n3C+pIBdulz8wqonrNPLKgwKaC5B3s53qhXVq6oDNg6sOhqvqhEr3V2VNLBjmnSSNdrOLJ1zkAu6VPRjFcFz4fXDJ8i45hG94Gt3IGjOFYA8TTlQZ/qGH1oP1+8ZtlT1MAtHK8mQg25zOZUSCLIliWcbw8wfW5Ln04ssqnHX04euiCk6/3de66MPpuAQVZAEFkw2MKFw6a1wEL4+lSBvmAOMhD8vkOkFX77feLNw14YT/ssmc4A6oOdHBEkwXlgjH2k4Nal6wB4fIuX9LzZjAmorNeHMo5Tc0OewHwDTUh9HXxfGJsYkAbAAAgAElEQVS/uvCpoAcew6zBBrdyBlQwwoDxdLZWXLDFkHyF8xGE/fb7xR8XXByAAVC1oB18HQYIT+8uGfP75SCUs1o64he8v4j6cIQ+IqkPhxrBCHjdjBH6AblQkAeY1ondukSiELmsUPpjbyp7XuvDgAXxdNZVvWCLIfmKg6Bbhrjup98v3lVwcQLw8gqA5v9zC9jErutltg8gMxDWWMBaMVkmANWFyEV6R0uH2I1IzW7ypbkQOTP5f2ch9KsFkwp0kQlDAOmxzHpscGuGAQvi6VD4RgmAg/b7xZVlT5MATNXwqQc6KGwf2U2uGV2uzg3D4ua7fDnPwZcKgIdq9GaIBPZb0YdD7hgyIFWMXiH0eQ5vXS5HcMkc++9lz2t9GLAgns7KxxZsCkgdtN8vWD+vYDMAUpcja7lOR9eLVcIP4tcuob/3AOHCdW02VTX62ApB4Mv1v24gnPy9HiH03fJ366KYHYTHsgBBg1s5AxbG0+HLZaOp65i+ln6/YM5EwdYBwGj1cmUkE7+8THLNdAHhwrUOXtcrO/pwhF4cct2oN68BMDCfmsJM/n6PEPoYPp8bH3kCkbtjji2tJJA962YAWBBPZ0WBCrbYsFoOf9pDAiENk179fkuvf9nTXewKcBSjsn7ldonWbgQpx+26otaLIwAlfi2QQSJY3Yjy5i9dmsFM/oEDMM/Z7Uf0RiYUA7J+ToNbOQC3e0WBBm9qLad6HICG1ZK1XB5PoxnuOOIcxSXe/Of8xHV/P+FpwN47gKUpYHmuSve0pKZgCKSq5wqniWE1WZz/xouBm74KTMwBI17lVBXwtWSs+8/vL45Ff3vhpcAnvwos8d48DZX3M2hx9XIAnu0IIO0chu35AOgLL0yuG/jOmwbg028G/mNz1YWdETbm4I5BrFlov+EtD2wIo7l+Atg8D2xY7iw3V5diEqO54mnj6XdMAYcU+6gon7A3NSO2qFjlyZYDkAX6uD5Iam44YaUfVNDNxaJcLIPXcGGpfi6PnZdVD1wPspQBX/wl4OaNwN6Jqg+xwrxslcVFuYJblehkcYYZGPS3L20BxueBcS8nwg5H5kZkx6TQSbXFZcCQKadx5Cz5mPurAFxrRaa17pAR2PFC+ElSHKQ/0QjQcgCyGyM9v3SnsDBRJgL6msWCf6IfWeUJac8UFlpY8500DcCfvgb43hiwZwyYVhd2D/VSrKGAmIDnBkiafEcN9cprHgKMzgNjS1V7rRjRlceyrqif6KAkMgXIM+6tAnDl+zSL36O9+U8p9jGHQo285/2XA/AnXeNnKAorDXH/AILwbSvLEz6Ql2+cAf/3XcCdw8DkKHBwpOpFbE2wadzIdyh3jjNQirYWEwYq+/zJwMh8pf+xKNSwM6DZMmzNRRbM2K+2Ii6TlFrAWfd5V3i/F7IgT2LBF5LbIdkqxLPWvtzlAGQ3RpU3Y7AiixMxLOUB2t7pKQ8M0qCTnp8HkojJgNqaMEJesQv4AR3Iw8DB4QqAs+6SWRiqgJgY0HVDAdBA4Ba4xN7ndlSFAAjAYX4IPO5dBDMAdS2i+Jx7XTf1eEdTDfgAQnR34p/wQkRmjNAoByDT/ugFphXAmjAEn8qaPQAgZCs0lSckCNmVigEbFMsPBBE3DcBX7gLuawH7hoAD7EM8DMw48AhATrjtQwiXoqkTEwWd7LOneXNCbz6Tiq/TInb2M8ZzIFrTQbGiy92oGz7pXl/7jvdAJnb2470IbB3T77Sai+hyAP5voTqW6sKwFAc/TAdc5+3dvcsTrvPVYSK4SQb8xV3+6IaAqSHg0FDVh3iOIFTIFxtit9orL5Z/LD1Q4s+B8OnHVuXwhhdd5DoLGsgCCJ04q66X/Ju/vSaeAxDPvbdtmdtKDV90gVEPIl/xySkviOhmAEjrlzSkwj40SlQZYZ39I+8JBMx8mZryhOsKwqYB+KpdVSDFvhYwPVR9BD7uyX4SwRS59nNI+bRck/DzJ05v12M0nY8fAk8iWL5BB5qASPGRCi8EVjzv3mqpkC9ACrrwhKukB67GhpqRRowQMqCiYbj8oOoHeUWpdYIBAUj8c8WjrjyhNIJ1unzjDPjqXdUjJAAP8TMEzLYq9uOHICQALe/EwWe+QgddAqCzzD8+vgIgg0qp+5nYjaDzCgjmnCYone0klqP4JSgvvK+6LoFPoFMlkPGh+0rPWta4RHTNJJQz4M8EAGoNTPVU8opS64CC9zoAWTFChcq7lCdch6s3L4J/2QFIEBKA1P9mHIBmhPh3Ai354RyAAmWsR/PRs6vOR8Z8FMPS97yxtIlYgVB/I7jC0rIKSfLXF1EEB+BFFjQ3jCLA49OWsRTTEPzvzQEwry7VrZ5KwzAQAPssT9jw1dcHgCrORQCS/bgn+1HsCYQSveaHkzvGv1scgU/6R55Y1YIxhvOm1EZekQWl8wVDxJgwc88QiJc6AKX/meHDawX9z16M/Em7bO8Q08GBP/jEkAEVjMBoAFWXUjRA3KtNwOBXW3EkAZhrALktpC6lKtTV4OU7RHB+3kHWgv/zrnYZl2kCkF4uF8MGQGc+MqEYUCA0n1tkwxbw4ScHAHr71Q7W4++c8czwcBAmHVB/c7Bcek9b3FuwbdD/kjGWgzJjQ3thGmVA3jhfOyU+RxB6FamOFp8NrhsTgLy8Cpzm5QlVptAU+6CiNgXCaIQ0BcDYV8b0P4pi30vfIxD5+w72C9aliegW8MHzqrmh/meuFhYi0pKbs6D9fsh/n1XFMrYMbPgUByCZz6J+uEknDA9AornWFRb01WZEsACoHhOqyC7wdetT0QAK2KqOb5MCUvPyhLE0oQxzqaYNXL5xBvyVXe12vByLADjXAvgxBvSPGFGMIjCmJbEW8HfntxtQmxT0cmxp9UPAdKAZ1upA6EB7qgDo6oCUxXRtPVSpAwJpnUhuxAqWCCYK1MBExZljY5S8SYr+pxAFAuBayhNG26jw8usCQLX0SAAkwwcAEngyQizaXoziIli+Oe7/9kJvNk1LmBMe9ECO3XRB7aPeF0EYHNVPdT8gj016YBcWtBfBVYJuz7mF7VgGY/pO8f5WdQ1/7U67nIKNS7j0wIbDPFZsyNHHY7od/xdlEHj8CcC3TgCWHgGAPSxiSdt4312u/8SPAl8/Dlh4pDeZW2PD4J1c9+uyDaIDkgEJQKnTfG/N8nUAmu5HUnMW5ARbPfEuIHy/ACjRK7FL5pOR4RaxgTHofKl8r/S1ZWBnAGDKefbn3AFIPRPXB7sFiVQimKVgGdl5ooNwLQ1/1U+DQGSXQ9r5Evy1q9rZbP1lGQDZsPpzI8APHgXgod7qUx11YtBbFzC+/C+BL7SAWwhgdoLkONSLqy5oLogYft3ZI1F7EAC+phsAnekokhP4HIzml/PvthQWmPB9LJ7jxkcSr14jWj4/0wFlgJD5eoDw6fe4DzAYPHokWhHJZ3TFSkn4h7YOSOBwEtiMTv1aY0uktFYTmI2/43EMQmCuAJmUE0gmVD8EFdPpdnxhVhqzDr8F4NMtYM9Jfg98EVTeNu9Q2OFZBX7vr9vtgm/lcezczZ61ZNN8DCvilYCdPXqNDQpAlfGTKm0M6AA0PTAyoMSx64cRfPQHXsniOTI+fEWDFGp+Qb9BeySRBV2kpl0QxxGAlHDmkI56X6z+EP7UDYSdRgh/IouwIZ36lHabBE0GJ0r10Rgb/xA/tt/j/6aMAf+7R4CxzuBXWRGULwBfIrY6UNfpvLae7n0I+LO/reoLMqiVMbW38oUhkNkQIzZO7tIweGePcmWlAFTjAYHPVGwXxWoLYblEDkLuTT8MDPhXLJ4jALpaJB+ggU6xfgJknT7IKXIQXh4Y0FZCog+wxiUTwSkXUbSMV1rB/A31OXWuFpPUda/mRHKi1e6U+hA7Zq7l+A+UAfDtHg/LrptkQpZ727cRWOL9542Pa3rOvuOqagUltgtmJM08j4/PILbIDKz6w5PAHsbraTnMGdZWIwIzxIfeK0rn578J3LAVuH8CODRahV/FFQ/1IumIvXP1QudNfyNT8oVqcHviPcBd48A0g2RDuoDqHdb2SalZAdG9dnfDkAE0gXnH5ijWCDbKCq5/MRiV0QD8HgHQ63jG0hdsLGxA3x9Bw1Asli7hO3BwApgng/Gjvq01IHrXJ7q3Cz7E++YziF2rs1ZLZ+8H9jJsSoECWXj6igmR87aLgfbGq4GvbgLu2gjsHwdmCEIPSI1h+SkCRjpfUC3iNWcpoRrcnrYbuGsUOMBo7QBCxSTG/igxVcBIVGPWM1h1JYQPnyKNExGZMDIJ9b66eEBGxPDY1Y5nv+GCjfGAxD+DDpiawphABWZPjwNzNLAEIH4XCH0M7/5c93bBfI8Yk2cgVAdvdT10ifDkBWC/r9lGH51NhIsnsWHOfPmEUKT94WeAG8eAO8aAfWPAwVEHISNQlKQUglJjJExqC+H6Nq93kOpUg9szbwLuHa66QzFWkaFieXxi6hgVHOMCYGRuJ+5V4jYJIDKI9KlsAvFDq8QDrnb8NWVPh9EwdFkQ79TlSMIsN0Mi5s9MoOGno4U6f3YAvefL7Y7rvdoFLxOANSA8f7xSgWmd0kCQbmZ6mTLEnJ0UqWLhUkxlrBn6n3wWuGkYuGukCsufGq2iojnRFpafsU7MDxErJuZhYCsJosHtWTcBe1oeq+hxigJgXBrMmTBPnJKLrr+VED54ibHYvZos8sO+DNcrHrDX8YVVyglAKud0LtMjFPtNMz6QLDY7VomLJd671AEH4Xu+3g7nWq28ISvX58/hguOBg8vtFQvV/hEzxfqOevuTfpjri8vAWz8L3NYCfjBc6ZYHmBcitnFd06pxyb8W4gPlgonBqffTtdTg9pybqiVNBssyUsdUD7eGO9amnf3sXtxQipl7Wg/sD4A8AwHIyZMYky50Tp/xgN2OL8y051qw2hXzwRCEdT2nmck1RxHG+w5jeO9NFQBpR6ldMIMXlFWgVndqF2dVFsJzuOgRwMElB6DcI6rznemD0RnbwQiSRS3g7Z+tVIl7PC9kahiYZm6IizuLigliT/VoUog+p8P9l3wJ7qGEanB77k3VczroUToWLCsABud4ypaLCUoxf9i/9w9ADiICULrQRWuIB6w7nuZrwaZwLBGwClSqSyz3AhHbaRGEFGOmC44D72UVgjW2C2Z4lIF4ArjodODQcqUGqAxfcpG4mJVuVqcL5tbs2z/veV0tYK/nhTAqesYNHdO5PCJZos+WuzxHJIViuXFyJxupNLg976ZK2lizUKodilGUgzyGhokF8yw5Mf+qRkjdjfuDtwkkm7DTkNaBaQ2ox1q3eMD8+B6O3H6em8Kx1Ccx9ptWl9iYIUAAWrI3I3nHgPdOtsO5eOuxXXBdj0V1vOL/so3Cxef60tlSpYwveKf0pAu6ohfdJ8k4CUqgvr5jV6VGTBKALeCAh+VbZLTnh5gu6D44A6H8cVlkNK95O1WkBrfn31R5HSy+JCwPplAxRegE/2T+AloGncNmbQyogUQx/KwB4gHj8YWNTwRAOW0FIIIndoqNkTAxz/bd09XDGLBdMM6/pLKi5whAX60gCK2ujxzEAqGL2pQ1Jis5AJEAFHvTujYAKjRf+SEugm1d2COQLU/DAwQ44caEw8AtZzSIPgAvuKkdrWMM6M7xCMBoiBn4YpCE2NCfxWAA5MEuwvCCEICwlnhAHV+YORfDsWJGgPpMKwg1b9QpFnzHbD2BK2JGul9s8KkYW17vLALQRTCBpzXZpS4gtCXXMAkduuAy8E7PijPWprXJ5CR38ygw1fJDohh2BlRAgq2OeN7uTWc1D0AFNtmL54ESBsCaJcLkDajxj5ZXRiCIGA0waDwgjy8sk5+HY+X9ppUbJSCp6TnFCMXwny1WAFQ8rUAc2wUrRL6mXTAefWnFfnz3FpbagQKLAqAzoZjAKkkpXkNO5GCEvOMLFXOnnC4xIKOjnQGNdWSM+GqHQGd7JSsxUf+JzQLwhTdV4je1nQvr1MkPGtlf9yP2Dy+gAqZ6rQytfvdHSDxgLwBF8AmAYjHWluEDiKGMiqOVvtejXTBOuRSYJwDJAARgZAGWL9Nk+IM3SzgTydE4eec1nZHbtDaNAf1Dpd/SMx2END6kD0oXtFhBXmcY+OY6AFChnKnzl7NfdMR3qCAae2B+VVMYXASvDs3/X/zHJZcB84vuiqABEo0QPnhnwqQLyRURmZBPytnwHde0M1vN2lR6picoKULaxHDIEdHkW2iWg4/7b5zb7DSQAVd0/griV2JYojfpwRGEYsGBrOBmx/OgP5sAKANkcbFzNWTRnX/GSGImMYH/LYlk+gGvdT+bW+SWH+Ig1GqL5QeTtR2EYj5LVHfjw/ZDwL8yJ6TB7UU3VVoTjTYxYDK+Ivv7dzNAZIxpZSiU8jjKgIWTcykZkBawDBBnQdMr5QeTKI5iWCB09AmEb7+ucnOQ/aTPWn6wuzyS4u+R0Ob6CUGqJpIDA97AdqINbgRgBJ69CG4Jp6q/ckjXqB/RKla4WpkO2ODgHoynigA0JiLwaNiEt95YQKJ4FRC+7brKzRH9jZbN6iJYuSHm9I5iOAOhHNJfZkh+gxsBKPbLu3+JgaWDdojhMO5kkDWSlNTg4B6MpyIAjf3IggJgMD4MCARjFMU9QCgAykhSKnUCYHB9JB0wy5aTRUxmup4h+Q1uAmDs+hpXgFLnB6ULONOn5xACNJqxghsc3IPxVBGAiQG9aLeilWUJW1FvVXEN0TKp1C6At19TMSCBpz1dHtT/JH7N9yaxp6QkF73KBxYIr10nAMproB44qQGTj6sjUrtOFPtLeFQHLES9AdDFrq1E6M13MaxVCTNAXNFThIylLcor40zxtgDAPKuVwDMrOKw+SBTbtR2MND7sZwC7Qvm4wqHa4T/uIrhb+7n0EgbQdTijoyg+agWXT8llDsAFWr/B8qP1K7bT0pvtVwHhW6+t2C/m8svvZlawi2CKe37nhFtapkDnILRqBQA+v04AjMyn79EIkXO/DnzyCBwVweX4wxs9B4rRZgyPVFqykgDd+5JSpBU5r0vHyHz+jsc3ub0KABsZMCyQgeExKyFPVIz3lmcM6OfPAGCADYPE67Jfs6h7G0o+xvi7oyK4cLZfOgpsXwC2Lq9MwuuVERonKn4nSJrcXnQKcM7dwMMXgYcsVxkSebJgzOWPqdB1ad2f3gpsnwK2LXWeR9m3danUIV1lBSCPArBwtp+7DThuBti6UDWDmWA/DvXk8LRptfPtNUlihYZTOPCi04GH3wFsnwGOW6iAs5n3GeJJ+KLoE+9VDClQ8R6vOQHYegDYwuY3S6H/iJ8jb11ck0q9Qhoc9QMWgPBZJwFbpoFN88DGRWBiqQIgWyJY3lPozaGJ1KTEPh36zpTkJrcXPRE44S7g+Cng2DlgyyKwaclfFoIwvCwx9Zn3Q1DmIPx/2/sSaMuusszvjfXq1ZRUElJkKsBEGQyYhJCBSkUqAW1tsBdpuxEVaBzowXZqe1g90G2LotjQdmMjKqtBxQERdAWUAkUlZNBGkQRNyIAEMAkxpFKpqjfUG3t9//m/c/+737njPq9uVeqcte66b7jnnn32/s6///3v//++Tz0dmD0KzC4DM6vAFpd/0L3Gh6yTDgnvLwKzAWDGiH/ThcC2OWDrErB1pRgQisIQhAa+AED+HEEY6uNLyrRnZLSl6tSbrgLOeBQ44yiw8ziwfaV4UGbdegmA5QMTLFlqsfn7XecDW+eAmePAltXiXnkuZSBkRcm4UGXtU2uo3xsAZgz6y54JzMwDWzkgBOAqMMVBCSAUObh8QuN/CiTgcWAuyWhL1amvvBbY+VgxbW477paa7gIBqCnUrbUBiQuhAKDUot13IbBlDtiyBEyvtO5VDxvvVfxW/JkWNFrCeK8NAGsY7BsvKQC4hQCkJNaKy2LRIsg6SJ3IQSe1onKKC2CsOYMeN+0Dtj0ObDsGbFsEZmWp5S74g2Ir2uA22BScAJGA+dJFwPQ8ML0ETAUAkgDTPq9zdK/+sMWpPF19NxYwA4g3PtsHxAE4SQC6FdSgmGWRRIJLZJll8EGKjHiX1jwaN10HzD4BbD0GzC4WrsKMW2pNobZoCu6CLCDfCTqzgg6sr+wFphaAKQfgZHKvpRSYg7HN5XCL2AbAZwPrZGaj6ippXhgn0kqmU1woxnHedg5AATuWHig2FE1uVRwoxoX+Wcbg89S3AqCKPONcCi8oPtVP+9++G3j+oSK2xRBFDElUxbTS+3nvc4FpDsjxllXQoJg8FgdCQoGJJTTicLcQ6vPL6wbg9cDM4cJv27oAzFA5ky9/UOSvmg8oP86n0dICBn25JwjARWDSAUgBHN6vfdbv10AbARh8X91vDM2ss+NvAECKPVLCsHoyUgRqrlbnRwB933OBc+4DXrIC0IEmiLnE75di8HsyAcjzWUVGUi6uICMpVwwJVMXdeOk3XAxc+Hng+vV2esAYw+sWoP31r3eLcLwQBeQUrEHh4Jo2h4vDmJPuAyMLGAeEn7uqbgB+I7DlSWBGCwe31Gb9aL20kGDb/EGRxY6WTz8f2wtM8l4pgL1SgM8esHCvsuylME4nn9cfQLtldg6TZ0kUKorAfij23vAPCmqp3fcCl60XFINid1PlZrf41/dnApB6wSQjutUfIDJR8CGIQOwWEH7DywpKrWc8CFzqRLHkVYrB2jS2FQH5vkuBycXCAlIUUAAkCM2iRBA6+ARCe7DjYmQduLYTleiQ/XTTS4DpI+6nLhZW2nzVCEBaMLd+soIGqjD1ampdugiYWCpeBKA9bBJC9ActAk8LES26SqsftInLZ44dQif4Igdhym5WLrPDyuYH/7HTCNwDnPko8LXrBccjQaioe6BiKad3+QY/MGTH6rS3OBvCnQDuAIyqhiDkQ9RX+29yE3on8IwjxQPI8zkTiApGU3oVkD/4fGDieAuAdMw5MFQjEgg1DYsUku+a3uI0TGBfV7PotwHwaOEmbHEATvuDIutni6UAQoFRIFRYhfe/dhEw7tbe9Of0Si1g8HkrwRcevDajz07gIJ7n05rYyWIpb4ya/7vv8PRdFpj/LXDmkQLAnA4jCCOlTBRN/rFMAJKgkkVHpGUjySSBSFeg7/azqk8EgbSEq8UDRACLKDXSyaQ7Br//DcA4LSCtwnKhTEkQcmAIQhtM+Uaajl0uS9NatITXWzpzfcdNB4DpY+6nBgDaCtanYLN6fCj4u1ay0QIqtML/EYC61wSA9tAJeP6eWsAoDysFpg1eB0HIQRCIIkVeCqQf/05P3WCB+UPA+CPAzvmCaFWDKEuYcl1yMN+Y2dckqGTeHPEvvWDSNhOAfbefX0A6rS8CUw8X9066bFIfdqMHJID++DJgLACQumyc3gyAEYRRKFCLD1eu5ODLF6QvXedx0w3A1BwwxdAJLTXjd8seQnGrZ9bPFxLyA7WIKON63tYtCQBN/sv9QPm6BkLp0vl9t/m6ietR6fbyBA4gnXtORwRRpNnTtPpW6gWLH83lKqcOFTEnDiKtoHwy8RNFhrefyeztbnrBfbWfgttsP+kIyO32ELD1cHHvInrlvWs6TsnB7qAUlg/suFtAWkE55zYQ0QpqcALoNCXTEt7A3KoaDwGQfqoAOEUBa7fUbKctltwCajVbxvSiyvoasM0BaBKwwdKb9fN7NfcqBWGiSWykWXER0umeacUEonQgCKRfIgDFjya5yq8Wfsfs8dYgiuMxgpAg/vnMzu6mF0z6Zj5APdvPQec0TEosnvQosGOhaLuIYvnwEYSithE52F1XFAA0p5yigD4otCqygFKnpHUpLYP0OcKURYv6Mj4MNR433QhM0gL6QongawOg+6rl9CswKoSkEIxPyTsuAPigCYBmAXVfYcVf+n0SRYw6dP1YwNgHsgSajiJP429RrpWOM6cxDiJB6NINM4w7LbUGMQUwB/M9mZ3dSy+YVG0EoBiDBST5ddZ+PkCsAiIlQZDa3LVatJ0WXG2PbL98AB+4omB3oP/HgTUhmGgBfRqWf2TTrUSjExDSP/qWzQDgfAFAWyzR8rkFtDAKX75jo6nUguZxZ8NByHbvvqBQ36T1swcsBaBAGGRg40Ir+rt9WUDhQ5ZAU7Es2e9LLzglqHRxNkbeuW+oQRRls5jaMjnK0a9ecNf2R4LAwO829kQB3LTtEYQPUwzQAWgW0AGo8AQH0ljp/V17pm0KRcEifGuNOnocO1rACQbKPXhs8TtNwVr5uh+n6Zf3wDgu29g2FdMtOc8B6PdpFj08ZFrplw+ZA5FTvAQQ0/BT36FPDkRqBT9Jag7xYlQItY0f88j78sZzCcKPZlrAQfSCK9uvB4h577SCotUiEJ8opq8IQFl/PUBPEoBLxbRE62LSqG4dFB8r5bHcOtiOQSqT5T7RKzYDgJx+BUCCTxZQCwhaQc9oKcEnEBKknj5FsJ1LAPo9xoWWPWDy+6IIoqbeaO0VA+zHB0zxIQDKkn1GgtXiRxMIAx0Vn0Db+lkuFjLRCt5WEwD71Qvu2H5OfekD5FaciQay/GIbFgBXriwAyGmJADR1ck3DwTE3TQ4B0LetzBJErTYAr2BBSI3HTS8tLKBZPo/fWQDZp197Z3scjGb5BDp/L3+njMweB6B83Gj9wj3atOsPWin9WgXCFlVO/3ctf4iD8XkBkH5USlAZlNPZAQqARr5vxu1yjmH0givbX0UQKI63o0Wun/xHuR8E4VnPK5JQLd4VNttTBvK2uoiKOUf/f+GjwMNBh0NMV6J0c0NpcRv7mrYv3kh8/uHxYp+bVpwLp3R7sts2YzouSq3KGa+q7+x7Co4nazAerRKsVlV1QitF59dyyFZaYY0HMu9mWL3gtvZXMbymBIFMZ1ov2h0B+LTLisxgW+Eq5uU92iZ72ud9vvR+4JFp4NjkRh2ONi0OB1/UBCkvEYRhfuNs4OmhhiPKnFQlx6aAjMnSXJUAACAASURBVPjmz1w41nnwO4cCIBvBwZgTAOUHRq3gyDExD4zRGVYEnpm5LqmQc0M5esFt7acFl0SlHiBxuTkYxxdaihUC4QVXFu5FCUD5QtJl85sjGA0ziQxqeu/fem+hw0F2fLLQGxFlYMRvo7v1WmIVtpt1DFkXvOR7LwJ2HSkyoZmEypoVVe8p7b6qEMnidGG/Vl/L2aPOIwuA1pAIQE3DAmFa4j9f7CPaFpCHKujr5xzZesGdHqAqKz5X+FLRAl58le+jui+kTBALMcgZ73CDBkpN2/7+bfcWOhwUyCEAjQTcAVhKdjkPc2RajewKyu/n1//qJcA2uhBMRGXQOcn9U6JIOjXHQqSYOsVoQp1HNgAvz8yny80H5PVz9H6RqVd849WtXQ/zA0Ow2ayGLJ474L0G79vvbulwkJi8BGCg4S01SKqofoNvSIC+5zkhFUupV8rUTpJN06KpaBkFQm5M1HlkA3AyM5/u9Zl38zrk6f0iU6/4hmscgK5ISUtCTowyDqb7UxwsqFJW3fo/vbuIBJEZ1YRgyHwQKNi0KEl1OKTCZJdxtPDn//v8ooaDaVgqFyiTD2IKfcjZS4Fo+7g+HXOPv84jG4DIzKfLzQf8KVfI/FNKrQ6h94tfz+vOA9cGAAbrpylY2SDlVTTt+uCnV3/V3a7DQQAysJAwobZJgUXi78Qayhd812WeiOAZzEyUiAkHMeu5BF5FwZQAWLPwknkLQy9CrPMy8+lIHZFzvN3T+YbV+8X7c64OHHix74V6zIxB+RJ0wQ+UU992tYoFy3fcXcTDxQkoPsCUhFIczKVCegSg5B8A/PILN9ZwxBSxtiKiUAOi7JW0dLTustF8AGbm0/1o3vjjnSGdj+lYlGwdRO8XN+c1wABIoHk6k61yuSCJITq3jDY9Vx0BqK++uwAfX6JkI/hME0SC1EGguiQ+isqcQRLrF6/0jO2w+6FMnZhyZYsQ1W50qOHgPX1NXndtODsfgMwHzMin+0+ZN0S9YOllMzWfLwKQSS396P3iY3kNOLDPM1y065H4gOW3p4uTDkB8zWdb7FgbdDhEgJkCUDRvogTmd/vPv3BVAUBuvylNzAAYi4hisVQnEHoIqWblrxqm4Mx8ujfljT+YjsWBYgIOc0oJPsq1slCpH71fKybJOEoAuuVTRSCnYlmU6P/Z4iSJEcbLv+Yu9/1EAh7JKEXDKxq4ChUiKymRbwjgHdcUWTARgLYXHSr2LOU+BV7MVwzxwOfkOWybYAGZD5iRT0edjpxD6VhcOQ6j94tP51wdOHBdMeXa9OqWRcmWXA1XLUIUH6zyCwlAs3z+YBkfs1u+VIejJEF3ckrjI9T0y/aMA2+/tgAg08VURKT8vbKMUgAMIGzzAcOi5HknHQAz8+l+MW/829KxhtH7tTz+jIMAJPCYMULAWd6fvi+EY9ouoZBM/Kx/4LUBgFLgNC5o16FrE8JJVJgkiFhaQQBv3+dVbMrWVsC8UxFRkjjaVsW2DtRdOJ/vAyohVYK7A+bTvTdj8HlqTMcaRu/XxHkzjgNkIOWuDr8jnYYDKDutgpUhra0uAlAyCCUAK8BXcjBXgLCk/h0D/hcByDxFAdAzoFUqUBYRJTUcMWdPP7ONL6i5bLQeALJRQ+bT/W7G4AuAOXq/lsGdcRgAY+glLkYclJVTsa6ptCX3uQjAKINQstFrAZKIwWxQIhIJuovB/Nx+r2LzFCwlj8Y0evl/MYk0kieVtcvrwGUnHQCVjjVkPl3mItQsIPuElx9G79dOzDgMgGkAWlNyBJn8xKprBRC+zgEo4LWRgcdVcOCjjlNvmx84DrzNAahaFZWLygKWxUNibIhTcPD9BMLLa65bzreAMSGVoXvJ/Cgh1WUfO+XTZS5CDYDs9GH1fnOrIDcAkABTTDCCLYK0Cwi/586WcKJUiEpC8CCBYDsiiSplqUIUmOjf+o2tIiKVUJbgU5uSWl4DWwX4+PcXnrQATBNS+8yny1yEopdcay+930y5YhgAg+9n2OoUeI5TdQer+32fdhmGoOBZanBo+g1yEKU4dYgFSvqB//vZBIBt9RshkTbW8ZZZ2hUgvDL3iU3uux4LSBM0ZD7dPRnTH08VAIfV+2XAOucQAMuVcKfFSD/+IAABsEoGwYAoHZIKEEYxRIHwLS8pUuhjFVs6/ZZhIVWyxVKBBIRXnbQATBNS+8ynI4tBzkEACv+chlUVIKE/5cRGsWmlKfIzudc3APLQSlg3E2OCyVRc1kpU3DgBmKoQsWtlBcswjPu+nfTYtBL+GQdgOf16GCZW6pXlBCqWSgqJypoOAFfXXDifbwFJLvi5HAjlnUsiIe6AjOp4iQNQHRlT2PlgJCUbbc2s+v/hFwFb/q7gm6HlYpBbmTV2sscQyy/qFBj2v0/cAdz/HGD7NDA1AUyOOU+1CwWOewNjKj6/O03F1/WuugW4/XJgfBoYmwDGdH7IxB5kLPIB+I8AfNwZgga5ck2fJbEm8V9zNWPfrasbgMuPAcuseJ8Exsb9FdBhA+7gaQNKB6TfcgCYug+YJT+g89aoBDMmIMScP12uTKj13uDv8zsKig/uJ1uQOsnojm3qB5P5ACRBH3OhPuzzRN9DV88HqQLEWPJnvTy5nm/t/1s4BcuSpRZtGAu4fi+wtBVYEyccrYwn6hF8/FkJp9bKxAKVFsn/d8urgbHPA9NPOEOWl4+2cfoFHhfVrJTZPKHSj5daOtup6JyCpPx8rHWRVQ7WOlrYCMx8AHIzlxkALPD9c0VB+x/A3E/+E2fUYHXdF7KTGwdvTd0AHP9r4PgWYG0KWBdfsBdsMPfPrKKsoL9XAVLAvO2fFylCE4cKliyrDVZNcGS1CqEYhWFiAZV+XntaURdTLmpCEbpchTYLqi6NrkMCzLzt5Xc4HwyJmmkJ+Z73jQOh4NWeDUZiK1K08f0EXt7CMHVawIk7gaVpYJUA9LI1Ao8bzKX1cytoFtFfpdCIWz7rgzHgth8u0oPGDwETc8CEMySUzFaikgtlpW1Ta8JqNba7lVljSRgW+Q6ZP/57WQvj6fydBjXfAjKbgEvMLwWCvhNoipgNpnQshlS4IGFWzIk6ylWwAz93ETLxGWB5ClidLABoIOS7pmGfG+33YAG5mND0G8F4678vkiPJczNOAC4UyQm2N8w94kirFlfIAl7i402d6dbPWWAtrsjOFiuCvAJZOQE0pHTFsckHYDeCvhNgipQNxoAz8/8IPr5nbvH2jd+6AThJAE4AqwTdZKEBLDoDgU4+YVkPHIBoPwareOt/BkDexsMFAFnbzNJYm0IDnVwbt4uyur1kwL7Tp+iZM/08WT9Rc7DHUmuYTr/x+6o4ovvu9fjBbgR9JyA+omwwxvZI5ULg6ZW7y9FPf9QNwKm/CgCcKABovh8ByVy/UCtJq2f+X1yYJPGU27lIZLbuEWDsWBHesZeDz4iURLUWa1TE47LqK12fZmd3OXidFctqm92KatVs1jAEsNv6sdymaa2g8+xUL4I+Pn2beCgbLGWHI/h8G3oTr45iK86POlbBU9yKI/AcfLR+ouQwH9BfmmbLlTHboOnZ/T9+5vaf8FUaAThXsFOQ45mUcgZCWTAxe0UQ+urYMO1/37GtxQmoLCBtRSp30LrDp2SFdzYMgk/R+VNwvwR9mwQDsaspGSfJgYDYNTbp8psCQFJxEIBkQjDrxt8dXCUIY+COH5MVFPi8SOn2n/QYLZ9Gp0cxANIP5IvAkzVzxivRydnKNzBa8fddM84b6AFyAriMF2pajk9kYIeoClXmA3AQgr5NQEHMBqMVFMNaIOayNRL/vhlH3RZwmhbQQUcAasrVVGz4EtjCu/3dfb/ID3PbT7uKAZ/MhcIC0vqRTo4W0IBIEAmEtFwCYqjW03bcmdwBYeoWgetUbrR8snrloiR2drpACf+rD4D9EvTVjIJu7HBV+781X752Czj9lwUZkTEgcPoNPp5Nv4oBRhCG6dd+1DkMz1JIhR1BAHJ7zwqO3fIRRM5tmDK5CoQKsSgOeBYBKFZULTqcB9r6Ni5KYmd3WKDUA0BlhNLM8EbT1QBXBU72aI5ZjUcVOxz7WLkQ8d37vsart/uA6RcPsxNSAtAXHDYNC1AEpf9s01kKwuBwGU7HgVt/1jtD1e60fgQigSe/j5bQp+KYpGB+H62jT7P8/ZypBIC8Dhcx8eY9wF015abhmnoAyJ5WSrKeNgKO9SHxnT/LSasJBim5lRjWBEIVeROInKL1qunybRawLgASdEy74qjaNNzJCgqEEYzBGvK0297mAFSHEIB6ebKDgc8J1ksmV8t29f1en6L5v6cxIK5iK6Xne/5jCTiFcTqVn/r/tWDPWwXnEPTVgIKUHU7ljASawKefIwDpMdRxRB+wFgD+RREDJABpwSzz2c0LfxczVjkVKwaYgtBBezu3SvX08d39P5uO3QKahXMQciourZRAGKZWar/YZ1xXRPe8wQr2AUK7TvbOVTZBXx4MBECRnConUBSFEXT6mf/TK+/qmzAF/0UBOPqBZYF52HrTFCw2LH5G8UCzJEko5nZqmRnPh/uCXmpnVpDTsIPPwKApOaSA2QLDLSHf97iPx0tpISLfz7bl4iFfsUsnj+HZWEeOYDCDnDmCvZkEgedcCjxGseIhBYt3vx049HwMLRh8gA9gh2MoH9ABqKJzxf0McO7XlSAU4HzhYYFq+5D7hwBu/98OQLlIBCKnW39SlXNY+nqeiq2dkQg+gnGPb9/ZpT0lq6MV5D96gLCwgDmCwbdnCvZmCgY/dxy47xxg5SWuUjigYPHFbwA+fyGwfr2rXrMvPB+vp3L3GHCgi9JOHQCkRVPppeUBigXLFymyejYTB4YsgfA20ofRAlYB0FfAlvQqP0/TsX5PLOB5DNu471cmIwiBaRww/F01J+mz2pqChxUMZvpJlmBv3iTocsW4dzewfhkGFix+2febXDAeJO/YEILBB7pU1g8LQFo98QASVGYNQ6DZfEG3fnEqrgLhbf/HV15anbkFNCvohWSl9XPQ2XTM/2s3I4DwPIZwBEDfgitH0Ek6N6x+u/iD7T4g/YdBBYPpWHEaHlqwNw+AQa4Yj54JrJO+aQDB4pt+oCAyYvOPEIQDCgYfeF/9U3AbAMX7ItAlVtAspKZdz5SOlvA2pstxjES3wJ+92NgAGK2gwi78QoVfEhBeQACqNNP1RdoA18kKdgDhxkUI/zKIYDCnqyzB3jwAJnLFOEIW7QEEi1/1Y21ywVglCAcQDD5/Efj7M4CVrZ5AKlkhxeQUaxBI4nvFzxf8IfCVC4HV7cC6ZEX5nen3VX1vAGLZq8ysrvHY+QBwbGfI2E6JpLvdX+ksthpUvQrmX/sVDGZVUJZgb17vJHLFeGQcmCdVb5+Cxd/5xjZ6QzzMLOQBBIOfTV2Ps4HFHQ7CLQUQmUrV0rgKJMsCjsxGAqTn/hzw0EXA4tnAyg5gbTYBorKkUyLnkB9YVhTxu+kT13iccwtwdBewPAus+b2ar9xJAafqfgMQO4dh+J9+BHe5gqZZZzYok1JJUcpaR6bp93P+W/N6p0KuGIemgEWKgPQhWPxdP7NBLhiHKYHUp2DwpZ8rLOD8tmJQVplOLxAqmbRKC6EDYC7/CeCRPcCx3cDSrsISrs04CPm9ArZk55UvKAspYLqPaPdR4/H0g8DRHcDyVr/X6VabLHk2PhjpPVZY7d5xwF6CwS9y/4LbbVyQsEKIufGiKe0p2JvXOx3kinF0GjhOQY+oNRtljji9TQPf/fOV9IZY4Gq4D8Hgy/4W+Oo2YG5bUUy04vUcLCqSJVRWszJbNgxSmMau+q/Ao2cBR88EjtOqbgNWWaTkIFz3YiWrF4nAjtN0nBZrJnU+/8PA3CxwfMYB6LUra3oglL0tps6wlVha5rLiqd9AdDfB4Je6U0s/0BXTDYh80Sr2FOzNA2AXuWIszABL1JaKWq1R+nwGeM17OsoFY5XTVw/B4Cv+Djg0C8xvLYqJCECzgsxmZlq9T8e0XGUyaUizavPtxoFr/zvw2BnA0Z3A8e2FVV3x6c4sqwObckeyhiXAowUSADhD1XhceDMwx37lvU4XxVN2n3rJIocygkr/Vbs7fe+EdBLcfaXXQ3IPWIrpBB6XlnwpR76jYG9e7/SQKzarxM7qJFj8mg8UarMV9IZ4gvNDD8HgKx8HDs8A8zMFAFnPYQPDl0Co2g4fpDZLqKCxT0/7fhJ4fCdwbFvhRiwRgJruCOwUgCpeCvUjZmEFxhfk9W969kW/B8xvKQqnVgg+B6CB0MsI7P70AHgmd2n1NQ0rv7FvALIlVYK73MnQCDLThSGZoDpuP7uCeuX5n8zroB5yxThGnQ0CgyBMxY63Aq/5aBHG6EBviDlOLV0Eg1+0AByZLgbl+HRxnZXJoqqttA4ODovlJZVuSjTQFtq+NwNPbHMAzramdVpVs6wEoPtdNg37wJfvsYiJP9NFqvHY+7vAwjSwxAeNxVO8T6aNVRRRlT6hHrJ0Ovaw0WDJCKng7g86APvNB9wg2JvXO33IFWOBgn8EIf2nRLD4tbe1+AU7yAWbZeskGHwVdd2mgAUCcNKnJgLQrZ/V9/Jnn5JUYmnAE3hCmv3+t8AWQfSzyPK/POOgJgDdsgqA5nfJAvLdLV+bz0kK4RqPZ3wQWJxyAPqDVhZQyQr7gyaXI9axWCFVAGLvRUhV46PgLnUWBs0HbBPszeudPuWKsTRZAJDTo8l8ui/42juL5veQC7ZpsEow+OrZQlqVVuH4FLA8WVyDAOTAmHUQCAWQkOlsQAwDt/9/AE8SgPQpNa07+AhAA6HLXbb5Xr4IaAMfv/eGvP5NzyYA7UGjBWTWjh40v9fSyscHLtaxhJWxFVsNNAXH1khw983+DYPmA5aCvXkdNIBccemfceooAfhAAcA+6A2xLuAGucxrzgKOMexDfV9OwbS2BB/BEoqLSrBoYGgJ3E8qLcIEsP/ngCPuUy7S13L3wb6PU56/m/Xj4Ps0TKCXQA6AXuNeZY3HMz5QANAeND1kwcKXlj6wOZQ+b7R+Pi0PD0DeFAfk590CKg8qncfoFzIRVWVqfFfBhgn25vXOAHLFWCDbvPstBsJZ4LUPt+jdesgFg+qVptWq11bg2gtgfuLiRAAgQeg+oEmsOujsXb5SsAoCIN/3vx04OlNM6Yv0tdx1MKvK7/TFjVmeCD4HQQQhf159eV7/pmc/kwCcKABoeYvR0oept7SEoZQ0Tr1lPuPQFlAtO0nyAcWhpzw/FSjFzGjLx+RGvxzoSeC1hwsA9klvaFN5FAy+9mJgnhaQ0qqagglADo4c9AhCDpJPl5ZommQ8738HcGw6AJBW1VecZv0cePwOY0/wl1lAD/WUCx0mMlDLr8bjmb+Dwp3x4nkDYbD0thIO5aNtfmDi/xGEeRawxhs7Vb/q2huABQJwAlhyy2cC0xoggjAAUCWWAkksOiIY978TmOOqeqqwqAx3WGhHK06n7TDwOcAV/iipPAKjwgrZm2o8nkUA0gKmAHTrp+o9MTrEYvq44o9pZIOtgmu8mafCV72YAKT/RwAy5OPOuVlAAk9Oule6xQRTWUKlWtkU/IvAHAHti5oIwDK841ZPFtCmdr0U8PaC9hVultd4CIC8P2Ztt/m5/qC11TJXlJDGGpfGAmYODgFoCxACkLpuWh3KCgqE8gNVZK4KtxgjJAB/2X1Krao1rfN7CWZf3LSBT4uAEIyWBVpipL7GgwA0AW25GbGENBTRx3rm1M2w39mmrFVwjTd1Kn+VAZALEE5LtIDyMWUBvbLNLGHgd5H/V07BDp7r3uU+Jadgn3ptxekA5MBri0/Wp4wzBjDbCnkMWMqVpE8GJwLQqvfc0pqbkVj5aNk7gbCxgJno30cAjntowtXNaZ1suvSKNhsYTcVKmw9F5xGE+94dfEoP+JYhD/8OC8eIPUsUHokVVKB78XszbzAF4Pvd//PCKVGIpOAr78mn4DZOm8YC1jco+w6EFTDDPJqeCEBZBa5GffVbhmQ8DtZW5TYOvPhXip0GTuu22lTMLSw+aAVl9QhEWjurI/aQiLJkTMLsX9R3r/ymZ73fp1+37OU9hunXSkdl7T3QrhKCtlCM59k2i5CMMSIAGdqxEIwrmptzTsCEut5yilKoJLAcxCq3fe8tLCDBFwO+tKjyuxSCMdYEXoeDrHcHvu0tTwLzmwHA4N/Gh6zNCqqeOSxC2lb8tQSiMwbuqXIqAcjFh2JjBKGJyShQG6ygVbfJegULWBYcMR3rvb6oCRaQwFPgl1M5rR7/JtBZOIZWx/0+s4QeY5z/1/X2tFnAxPpFELaVkdLN8MWGVr4pCBsfMHN8bmTKfCjZ0Ncp456/x58zLzfw6Qf3ABd8pUgEYmqk5bGyek06IQl1bkXScnlN/u8L24Gdx1qVq91KQvrpgwaAAw9p+wnXPw1YjyWMGtDo2ASOFGMU7SIEUzdYD34vMPmXwLbHgdkFYAtlGiim6DpxJtvq9LtlVr/aWKEB8pUXAOOPAFPzwBTZ9r04vdQ9Ts4pAZ3cd+yHxgfMAOH+vcA69/9Uxijmz/AerYpdar1lNSMYzV+vWY/34I8DY58Gph8Bpo8A04vAFEFIknIHohGVR62QhFRSYjQE6qFri2z3iaPAhHNNlxKwArI0Q1IAxwfReacbC5gBPp66/5ICgLKCtqnsrKKlrFZUFPKOr7osMTtdsxzqQRZ93Q1MPARMPllohUxRqkEK6gShOP0S+dY2hlRv99y+ovRi7IiTnTvLqmg6xDPYpqAUgRgsoR7MxgJmgHD/c4E1FXu7FRRbvEgd7evXWlbPpp9EgUjiJpwe6zwOMlvpAWCMVusJYPIYMOlSDZRpoGiNxKzbdIQlXONMWJbGtw4svdgz3El47nzTRvPrrKptAJT6ZrzfintvAJgx4vsvdQvIXK5VYF3sUZxmJUvgA1FOvwF8spKyBtM1y6EepI4LqVMedbEaTp0EIKdPKh5FqYYqSxgo2jgFr13j6XXHnOiSZOeBVSvyC8qC2r05FVvVw9cAMAOA178AWPMp2LJaaekiCPXExwHw660n1oB/niGQazwOkkSepbJ/72I1x4CJ+cJ6lYI1riccrVicUuVSmIW82pkwnHHVOKbFsOozQGkFkwewnBES37ABYMaAX39ZAUCCb82nIlo+40p2gNnvsoKunxH1xGwA/LOzdQOQJPIuHzV2GBg7Cow7AI0l33XfjOsv6oVodes6ISbBsAZMX+kJxU56KY7pkmFVhOciuvTzSt05v0+ryuT/9gDrZNe4wPMsI7VJP3GcP7gUOOdvgL1rRYJ0ZI5IV3hV4/wrGYPPU3/AiRhYusy2K7mU999P+z90ObD7LuBZK0Xdkeq9NSX2+o4HLwfWlopFCC0fgciBMtAFC8CGrYXVoVjnU2G7rTXrzh4kfRzLY1kyGwBoeiGcPiXb5eAzdXWnazPCSScb4j3xfmav8Cx2p50lAMW0VXINitCogl2r9H2dcctWwQxQsn6ZTBbMNtcgdKIbiZj51VcBk38CXPxoQcfCUg8pjcYgZScw/momACnXyr4leBhs5QaBTHpf7X8dMPYJYO8XgAv9e8QJlAZZq8D4xSuANYKPJQn0AR2AHKy1MACKe9nfFI6IEqduEWoHIJ9wlsVKLekoMCa9EAegSTYQeM4TXco2SEMkAHEbBZoj4bbYtdyCVrFqGXgTSxgXYTZeHLi9AMjEQRCVUXP/n4KUaaT8vVTi+Rtg7GPAuYcAWlMCgUVkQfJ2Q12yBvPXMwHImhDWwf81imsTiLSEvHZkr+jY/p9CQRD4p8DOBwteItai05qn31FFdfLlFxYWgCDUIkRkj/TxbCEi/89jfPZ3X2VqYSJQbmUNQY3HQT7hbv2sLoerVwKQHNEEoCsm8R4MhPRjXUGzVEIKIoY7yaEYuY4dgGb5RXruoSgtSCLLarkICQ9f6QNykGjFdjsIBaI4kGlt8W+Rg5g0HJ8qAp47nihAzFpuWtPIMBZJlASILvR6fQ0DCVbJCkJOJCqnk4pGpb99tZ8MopyiKDX7WWDiwYKXiEQOehCrgKh+eJQ+EQHo1Lby/zRlyf8TIbf9XS5ftIb8I92YugH4ay2pLusorl7dAoonWtMwQSTdOFuQSLTGHyIC8kxSIQuA4hwU2WUAoO4/grBcDbsfWElSzg+JCoYDoEGM1ixSkHzgF/wG7y8sIa3J7JPAGWuFJSQIaU01iJHUiYP4e33BrPOHmG/JMaOfTZVYRhwGav87vWKPJ9/rSH4IOGO5sITqg/ggxXs4TOaBAECbeoOsgfl+DrQShFqcEIhyyt0MbMusEkx76iAZXKM8BvXiZAGlF+KaIbaadYpem4aDgpJZQz6YJABV5VcHAJZ0v4FxX6KG5UpYs0KnqjhRuagEVgPglYAl9ciHf8mdUrJh0Qx9vkDBzBywfbkYQIGwahA/kglATsHsDzKA0BATiPyZ4NEDwIeoa/uFYKKXL2f24nQoIgd9R3yQCMTFqwIAfdBWI7+yB5ZLECYLETd85YJl+2YAUNosLIel/xYlu4Jsl6bhNhD6it4WJCvA2Zc4Gxo73RcgJeOqFmGR6rcChLYACyGojmEYdj59KnZ+tIQRhH9IvWA2hiREjDeRI9Cly7fMF3EtWRFawhQIf5IJwE56wdTIYdt7tp9ys1K8JnoJvod9Wn682PNkP4hUy1ndWgstAtBDMLYN5/6PAc5DGNoF4SrZfN+4+IhT8jqwg2Cp8ThIJ5vfSWBXAVCrWN9SMxDK+skaOvhoAc8me654pmUB3f0wyt+E8FyRAGmPlOEoiSD2qgvmAKoOm52fAuiTDHSyIRxx+lI0QxxADubfF5vffMmSajrWlP7nmZ3dSy+4r/ZzAUEHnQ8R70HsXlK+PgJsW68G4XYGZj0EY2EYATCAT6tAhmE0DXcC4faapcwMgAIfLb0kuzT9Qmw5uwAAIABJREFUSi+EfeALkSrpBovbrQDnkm8wAo8/E3i+CCsZ98NCpAp8cUekZyBavI4ET/TnaAk/RQCyAXy6uNSPA0i+wMeB6ePA5HFgZq2wpNGK3FUDAHmv3fSCe7afX8CB4UNEEOolVi/3obastNwJ9cO5BOBKEQMsAcifHWzRAigWWAlCn5K2bQYAOe1KMjTIR2kRUhKVS7IrLia0v+3xwHMZMCbYNP0KfG79zAqK5DxOvyEuWu6VD5KSHy2YAEQAfpaRdl5UkuUctIpBnCIIl4psD03FtIIP1ADAlBuJM47EqqUX3LX9kSBQcuuyftK78xUkHyQ+RLqHZ3Fv1KcgLj5kAQ1s0Qo6IA1nHhNLQzA8ZxvBXuNx8DcS5UYpNnoYxsCnUIqvZo0F3wPTMa7Hv53HOJVbS/l+5bumX7d+5WLE44hxIRJB2NMCqj9ixwuE90svWCaIA6bAp959EKeWChAyA0PTOV2unGMQveCO7bfqHbcS4rJR7Ewqnw5AWhLuImg2uFQAXAVs8RGmntW4+g2hB3P79L/EJ9zGvqrxOPibiVihAOgrWQOf/EBfBcsPNBBqW9Hv6zzGqFzmoXz3B9AePgXiq6bgiv4YOB9QHS8AfpkAFMMjrWAcQA0iO9XJiQyAnos2vV7ESHOOQfWCO7Zf7F40mZFQScRKAYBaSU6vAVcTgN7xXHiUFpDTMK2dFh56912BTiDcvpkATIXzCL4g3WXTZ4jpGfjoF/oihL+fx+0yWUABLwIwtYKKIabgCzHQvi2ggBKn0McEQDaKT5cGkIOo6SuyYzEfjQB0EM5nZgAPoxe8of3sgSqCQM3jkdFLvpRvR13+7UVRuhUFSavNO6otwp88ZZ3+t4M6HLtch6OT9AG/q9cmtf//gV1JDYcnQ2zY6/YakfSrU+Pg1M45NqPt3IEtoM7WFHokyrWKkooglCMWLYjiUXMtK3g8Uzd1WL3gDe3vRRCoUEYCwGtYFxxqgA2E/jI20F5hhmQod98BHNnlxOTig1aGiDanO21yV4DygWuB8YeB6fnC9WEtiKVVKeE0ZGiXWczeJoWMIig5a9V5DA1ANoKDeDylZ9NSXxyAsiKawrQqmCv2HVf5e8aRoxfc1n7xs+khItAUvojvyWryxVcWJZksVSyZoQRA3dcAoHzax4Gj2wtu6FVKM7gMgti02jbV476oUJJs1j/AbA1mQ3Pm8eTRsoZDtR+xZKCiEKmMXTIeXHPGdhYArX8FwG4DGMEnAHIK4yvT58nWC2b73cexaZgWWaEKgU1gjNbPP7PvOYGsUSBkv3hBtmRWNzxjTk9RWktvxp6POj0vARjY9sWkFel8RWxegjIF4RjwAOnZWMPBTGjqvHmszxJOBUD3xyznL2bqROvoP3N3q84jG4C7M/PpcvMBef0cvV9k6hXv+2Yno5QfGArRbaCC0mWv2YtF3ecerNDhkNZIIsXQRv5dlTtGADJSz2gEE1EJQM//026HdIEZLC8B6A0tk0g1Ja8DuzJdphS82QBEZj5dbj7gxZN5er/IZI+67pscgE7QaDOUMyC0Wb8+gXjuR4F5J6YsaXnFhBoAGEVvUhb60jISgCQnoh/OLBgvIrL8v7DdFkEYM5dtNg97tvz5zJqzdfIBmJlPl5sP+DJP5xtW7xffnzeh7H+Z+3+RpkyWT1YxuURJYVtx6T0fCTocouQV85VkHRIGegEuEv/YKpkA/JceVmL8kv6t5/9pu62tfiPWcFQVEa0DZ9WcLJEPwMx8uvfnjT9IgZyj94t/ldeA/S9tMaGa9SNdmsIxbvVscVJ1GScoMt4UPwhAsmMZ0aXzQBsvdGRBjQz0FUpEJRAJQOq4KAnBdz+sfiPJ3bOYn8fsykyVWMfiN3BOzckS+QDMzKe7OW/88aqQzsfE5kH1fvGjeQ0wADodmVGwOeiMsUqHrGOnS4UFy9P/wAEojkEnI+IqOIJQNLgpCXhcmLAtD/D+kgQE235L93tj+YBqgTX9BiCeW/NedT4AmQ+YkU/3sbzxBymQuZhm8g1T+QbV+wWFdjKO/Te2mEFNlCb6gPF708VJ1TXHgKd91GnZpDfi1k/gM2vqU3DUnCuBmNQe3P9vw6pe229KOvB0K1k+ZS+rnrfM2AlA3JMZtah/EZKZT3drxuDz1O/yxAwu9JgJxr3lQfR+8aa8Buy/wdWQZAVl+ZzCrG3q9c/YrkmHy3IRYryAAqAkEBIlopJxNNUbER+fA/H+/+AAdP9PmS9dazicJybm7mlB8nR2dI1HvgVkOlZGPt2nM29GCamcGZjAwlQ+vvrV+8X/zGsAAUiLVPp/wd+zaTMFWw+/kAA0GQQnpCw5mDsAMIrcRB5mC/+MAffTwgfwKY2KfmCZ6ZIkUShrxXxBX4yYaV8Hzmcn13jUA8CMfDqWYeQcSkhVOl8U6uxH7xekrsg49h8oiCENgC5TUG5vKxxT8f2aRtOtcAKQ1s8soPuOVUIwpchNlEEIOyNSIrrvv3hwnckWIZPZsnbcDyzTpvg3lU8mpZQqozyfK74aj3wAKh1LgrsD5tMxiz/nkGD1sHq/YNFOxkEAcuW7oqmXlisuQOT7VV2jwi/kTgj1RkoZhBje8Z83SCAEEJZW0C3gff8tADCt4VASaWIBK0HI9q8BF5yUAMzIp8tNx5Jg9bB6v/jdDPSRns0BWIZeUitIo9IhHmhXTvzCPQddccnZ76U1V/IvC4SBCFyg26DFNg7c++Mhhb6qiCikT7WVUmr6lYn2nRKyrdZ51GMBlZIc07GUBdMjny6XCiUmpA6j94vMZbgBMFo552pu27PXAqXTyAUQcitOQjAm9xX0N9pIwIPmSCmH5QuPqER0L4kDYgp9zOUL6fYxkbZcFceyAreAF3GlV+NRDwAz8uksnT3jiILVSmpWNlhMze+k94vMZfgGAPJeHDjpCrgM01Tdry9OzvmYAzAqLVWIwEShwzbRwwSEn+MqP6bQK5tZlWyhjCCCsC19Xv7gOnBRbgp7cu/5AOyVjqVMmA75dJZ9nHF0yohWNlhMxKnS+0XmMtwAmFq4imnYbrEqNJPc+9kfd62RKh0On8qV9hXZ9askEPgAfI56ziocUgVbzGT28lEtRMoKtg7lBHtznfZNA+CQ+XQWM8k4uglWK/NLYKzS+8U9GReXD0g/Tyvh4Ne17Yb4Zbr6g6y7/aNWcoPpjKRTsJIags5IJwkEAv6en05S6GUBfRWsUExZyVZVQCQwrgN7Wfdd41GPBczIp8ODeXfTSbBa6YYxlY8/p3q/udc3C+jTbtvqt2oadnB2m4oNgMn0W0p+hYWHWbwg9yU/0Kb9EIy+5y2hiCit4UgKyTeAkN8Valk4Le/ldlONRz4AWWBRM6fdIPfHstw/G+SE5rMnVQ/kA5AkLHS0ak7V7reXfhgACaBqDtD3e/nmc5k9kA/A80JReq+U38zGVp3ObJo/BvAOD3dtwiWar9zEHsgHIGlFubqSx7+Jja36anLLcDvvgwA+NDpDfILv+qlzuXwAXuSjrkKemlO2e3U1uWUYnL8dwB/5e2apca9LNv+vsQfyAUheX4VguB+mzIsaG9ntqxhF4Xbe3QD+n7/uHLAW9wQ1tblMRQ/UA0CaHC7plXEh+q4T0OWcfhleYTSHBK0EH/mi+fcRuKQn4I6fWpeoB4AevCz3HOOm9yb3F5mBlZBNclYCj1aRfyfrbgPCTR6AzK+vD4CyglX7jpmN7HY66d1E0ctdIrEEE4wEIMlam+Pk7YF6AMj7EwAVbU82vTerCwhAXopJN9zVI+AYrOeULLZgErY2x8nZA/kAJGWr0naUWdFpy2cT+oCWjpdjLFxE5UzYIBBpEUX5nLnlvAktb76SPVAfAOUHpiAMm96bsVtCAMaKALICMyxDq6cXfycA+b/mOLl6oF4AiqBRIEzBp7/X2Af0+fi1XIioMIlAI+AIPIGPmeROWV3j1Zuvyu2B+gHoFfZiDS2lC0LiY52WUADkQoTTMH1BFSYRdHoRfKSu5v9qrizMHYPT+vx6ARhSuDcAzzmDo5ZGHT1PAKYMwQxME2jiSo/gEwBrrq+u41ZOy++oD4BaCcsXTPiSI3ey8s4KGoG8QwCMFM+0ggQhLR0BF19SXuD/ayakz7uR0/TsMcxg3SjfqWNA0hsrga/ojaq/8WPcC+YIk4Ke4CMSuB2XVht1Oj8zIfXlU8BtU8DhmYRXWdfrdF1fgr3+S8At48CD04DVjXQSDO70PTUnaJ5uOCwsIIFHSSFy1pKPWCDsZxCpw8UVgKSPxLXM937OzxxAljzcPAbcswU4Qh4V3UN8mKoeKm/bu78IfKJQa8VD48CylHQiL3O3/qg5Rf30BKACMtJXjXKQcfBSK8Dfqc3KVCwuN2VFGRnm/yKZtq4Re5ifyQQgM2A+BeB3GHaZBo5MAIue0l7Kt3cC4xhw+5eL7TuCkJk1jBtyerbUfYG5ExjZ/pqrxE5fAOrOq5SmowVIrRp1IyT2R6+fg0bgVYG4CsyZe2UsaiOGKXr4Sfp9k8CxCYAFSKyvXeY1o1BxQux91yMtfsHPutgnnyUuUvhc0ZsgUXib+nVkq6+ZKaABIHsgVZnuwD9sVo66rrR4ImdhLGSQ8zPL/JgBQxeU1ouWkO9PTgDzbgmXxrzMkatl3keivfG5x4r4IRcz5BfkO5vEZ0kgpIfBZ8yKjlL17syy0tMNcOn9dl4Fy6dLFabj1Mpvow9Ify+I4Nlo9Xt+ZqU9VdJpqZh4QDDyxUyYOYJwHDg+DhgI/WUVZl7aSEt93+GO9Ia2iuZKOfA7lhp9JpvAVy61w2mOwO5hmCgMHC1H9O24gu6UD9jP+ZmbtLRaSsei9SL4XDPbAEh/kGQ/pSUcc0lbApFWb67lQUhpVnLBsoKqqZclFMmUtrxPcwxl3X7vOCAtYLSCcugFQmqhdssH7HU+RznjiOlYXA8wqkOfkItTAom+oKygca4ES8jY+N3z7fSG4hfUtp3ihUHruVSsFy1iRvNP+1N7A5BdJACmVpAgZPhGOyCigEjlPLudn7kvFtOxuB4g6OjD8UWLRkCZFRwrLCEXJQQhp2K+37lQeBCRX1A7KPQto1prFEmSYn2mB9EAsO+kYfk8KQhZF8yjVz5gp/MztyOUjiW9bCUhEBhKRCCgSis45uQ/PhX/xfFWMgOnWu2gxB0TF/o0kEZ/kCDM1Ts+3RHYnwVUL6XhDFrAswfIB6w6P1MrTulY0sum1VICglKwCEACqvQFCUK3gHcsFQCM/ILayqP1k9JshVqrncMalOYYvgcGAyCvIwuod8YBJQmZpmGJeyRwkGw4n8jJOJQNw3idLFhMRNB0SgASTJyKoy/4ieXCeFfJBUeV2SoAclFyR0bbm1OHTUiN0/DTAwD7zQeM52dqj8VsGEkVE2jKetG7AEhQ0frJAv6RC0trC1skl+IWlNinGLbSaZg7Mc0xfA8MbgF1LQV1z08A2G8+oM7PVF9Ms2GUE0gQyp+Lwu2yagLgR9ZaYpkSypQ6a6Q2DCqzpkvietXIFdoZfuieGmcOD0DeP0HEbBhNwYPmA/L8zJQsATAKnguEqS+XTqkE4YfWWwCUFZTksYAYwZfIBeN9Tw0cjOwu8gDIZqsoSSvhEeQDiiGYFoyWiSDRypWgi69UP5sc5fIcquSCNeXqe2X9ZAHfM7Khe2pcOB+AT41+aO5iRD3QAHBEHd9ctuiBBoANEkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cvAFgg4GR9kADwJF2f3PxBoANBkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cfOxqYJ2au9RdPtdp/khoEOlglDYT39V1PzQFXLsMXAlgt9PCxJKPbufyf8/KHIPfBPAZABf79Xc5XQ0ZQ1Q7360NbxoHrlsDvs5ZRsgo0une06by6X1mZvtP99PNAp4F4LsBXA5gjw8EGTeqaGF4QhzQF80CX7cAvGIdeDYAfhdZ2sTKUcVrpE7nd31N5gj8e2dIo2osk7NZpMdK0Z19tv+bJ4F9K8D1ACj8yfNSikHeg+5Z969m57Y/8/ZP+dPLKZhP/rcA+AYAF7g1oRUhEMUzFMt6eSJfX78b2DkPfM0i8GIAX+uWlAMppreUUErn8p2gzTl+2flg/sDbTkvIOik+CP20//mzwAXzwDcCuNTPJeFXpEpM6QEjIHm/zTF8D7T5gATYNQCe69aAloRTGulfBESBSYNyxR5g/Bhw7hKwZwl4vk9LnM5JmsBzUyDGAX3B8G23Mz/g9BuUa/0IiutfMkj7zwKmngAuXSvOpUvAWYBtF4BTnspIj/O8zPaf7qdvWITw6eZA0JLQEhKEGgxZhUj/dz3NzSKwbR44exnYvVKcy+mM5Km0JhxInUtrGkmzCPicg3W5LMGkQiZZTm9xS9Z3+4m2o8C5c4X15pTKW2Lb+fCx7WLtjYxzqiql29Icw/dA5SqYf6RTTilg+lYCIXmICKQ4IK9wxfSJY8AZK8CuFWDnanEua9ZTAMsaCog3Dt92O/MvnRGBtGwkqKRmMEkqCaa+2k+0LQDTh4rP88UHj74kF1WaATo9QHQ7mmP4HugYhtEKj4PB6ZQ+FS0hQahpldPya1kXTOqNY8DscgG+HavAttUCvBxInitrkgL4lcO33c7spBdM3kAuSnq2nx9gQfAh4JyVwvrxwel2z3p4aMlzH6DM2z/lT+8aB+Q/OT4EEqckWQSBkGD6EQKQnDCLwBSnYgcf32fXioGUFawC4esyu7CXXnDP9tOCsyD4KLB1rmgvX7zfbu2WG/Jtme0/3U/vKxBNAMoi0KcjkATCN3HOEr3UAjDrwOP71rXixYEkeKMFlSX8ocwR6KUXTJ7AaNE2tF8WfA4Ye7Kw1mwvX/yZn+eKnvcrfzC6IK/ObP/pfnpfAGQnySoISBqUXyAASS1AK0JfagWYcRDOrAF66TxZQU7jBOEbM0egH71gcgXSFZAV54NQtj9YcNIpbONCyh8Ygi8CVospApDuB63g92W2/3Q/vW8AsqM4gLIKBBIH8bcJwMCNMX68BTqBb8s6sGWtsIA6jwDk662ZI9CvXjA5A6NVa2t/IAicnC/aGV+8T74IQPm/AmGuBc+8/VP+9IEAyLslAKMV/LgAyIUInfnjwPQqMOOgI/DstQ5Mr7UAqMF8V2YXDqoXXNl+EQQ6N9v29aKdesUpWJZbAPyPme0/3U8fGIDssDid/pUASCvCaXgJmFguAEfgEXT27gDkuwaUg/nbmSMwjF7whvbLhSDL5TwwvdRqo9oqHzACkCB8U2b7T/fThwIgO01T1IMCoAZxGRhbKoAXQUcQTjkI+a4B5e5FzjGsXvCG9gdqrLGFYrpVG/UuHzBOw2/LaXxzbh43DKeoJwlAHqLndSs4udoCoIBHQE45EPk3DuitmYOQoxdctp8+rFwIWsGFYiFFoLGNchcEQC6e+OJC5J2Z7T/dTx/aApYdJ37AyJK/DIwvFxYvWr0IwEn/H1Opco5sveDUhSAAF4HJpQJkWixp6k2n4IYfMGf0amDHev2I8+l4/UbvNw8Eozw72wJePOJ8und7EkKj9ztKGA1/7WwATo44n45pWI3e7/AAGPWZ2QBkYHCU+XTMfGGQmYIxjd7vqOE0+PXzATjifDrKtTZ6v4MP/MlyRj4AR5xPF+VaqZLJF1UzKdPV6P2eLDDr3I58AI44n07ZMARbo/d78gMubWE+AEecT8e9YOn2Uheu0fs9tUCYD8AR59MpG6bR+z21gKfW1gNAz4geRT5dTEZo9H5PPRDmAzBmRM8BJzqfLiYjSKKr0fs9dYBYDwBHmE9XtRfMsIz04aQZ1+j9npygrA+Akqs8wfl0BCCTWRq935MTYL1aVQ8Ao1zlAnAi8+kEQGZTNXq/vYb75Pt/fQAcUT5dBGCj93vyAaxXi+oDoFLyT3A+3Rcavd9eY3xS/z8fgCQX/LPR3SOzkon55jg1eyAfgD8M4NcAPD6aDmBtB1e4NMDNcer1QD4AbwbwxwDe4UvRE9wHZG1gNSXDLlwLNcep1QP5APxzzwj9IIAPnXhT5ORc5EYCA9HNcWr1QD4AmRH6FQBMTSZZH98ZmD5Bh5g1FopiNns1x6nTA/kAvAfAEwDudnI+EvQxPfkEzYfaCXRSBluQMB7YHKdGD+QDsBNBH/9+AkAobqTADGK7Inw1x8nfA/kA7EXQt8kgrGAGMfBxZ5Cv5ji5eyAfgL0I+r68uR0QmUFoBQU8vfNvzXHy9kA9AORoMw7CdGQCjoUZDwL4kv/+8OZ1gJhBIjGDgMh3vTavBc035/RAPgD7JegjODfhiMwgoqeJwNPPTaB6Ezq/hq+sB4AcXeXEP+ZhGVo9vRimIQD5v5oPAZCupgDI9wg8/qz/1Xz55usyeyAfgMMQ9GU2Op4eAchpOIJQQEz/VuPlm6/K7IH6AMjgGzdl6QtyX5jWjpQFevF3lq3xf6yhrOlIAUgQCojR8gmE+l9Nl2++JrMH6gEgR5UA5KYsc+AZmCbQCDi+IvgEQMob1XBEAHIajgBMLV+0kCdws6aGu3zqfkV9AGTwjftg3JRVVRAtHQEXX/wbAcoXP5d5CID8GoJKvqDAloKOoIz/y7x8c3pmD4zhaqwjRzCYyQg5gr2ZgsFTLweWr8XQgsXjbwLWrnNtMlKgNoLBmZAa7PTCAuYIBlMvlWQswwr2UlUw45jdDSx8HbD+Ctd+HVCwePKbgJV9aASDM8Yg59TWFDysYPBtmYK91IbNOHaPA/M7gUXKXA4hWDz79cA8+W0aweCMURj+1HYfcBjBYO54MMY3tGDv8I3nmWSHOzYOLJ0LLPGXAQWLz3oB8MQUsEa16kYwOG8whjh74yJkUMFgbsNlCfYO0epwissVY34bsHw2sEIRkAEEi/dcU0SP5qhF1ggG5w3GEGdXr4L5134Fg4kAjuDQgr1DtDqcUmZETwArZwAru4BVqsv0KVh8/o3F4v0QXZBGMDhvMIY4u3MYhv95Zh+Cu1xBcxuOU/HfeDIq5cv7FuwdotXhlCBXjOXZAnyrO4BV6in0IVh8wStLuWCsUAyvEQzOG5ABz+4eB+R/ewnu/kOP/3G/l4kJTERlljQtIot2e53/IwO2OPl4FLtcnCqAp9cahT56CBZf+LpSLhhz1N5qBIPzBmTAs/sLRHcTDKbiNHdBGGymOC/3hglEvgjAnoK9A7Y4+XgiV4zVWYDAs/etxaubYPFFP1QkLtCIP8neaASD8wZkwLP7AyC/tJNg8L/xLNBu+YBdBXsHbHEFAINcMVamgdWZAoRrfPdXm8KitLdmgYveWAq+2y7iMqfuRjA4b1AGOLt/APJLqwSD3+y5T1yI0AoSbAxMMzGV1o8/My2ro2DvAK2t+GgiV4zj4+3AIwDXtwBrVJeuECze+9aW4Dut4PxkIhYsdetGMDhvoDqcPRgA+SWp4O4veQ5Uv/mAGwR78+6rQq4Yq9PAOi2fA4/vBkKudKVU7VZw77uKvWFuZbtcMNb5v0YwOG9g+jx7cADyi6Pg7gccgIxlcA5TKhaD01yYKBmVFpBZMfx/m2Bvny3t8LGqoqTliZbVI+gMgHwnMAnCIFi897cLAAZ6QyzFzzSCwXkD1OPs4QDIL5XgLmk5JHk/SD5gKdibd38VcsVYGmuBTaAzEHLHgyCcaokB7/1IkUET5IKxwF5pBIPzBqbPs4cHIC/AaeqvPL9pmHxAE+zts6VdLCD/lcgVY3UyWD0Bj1ZwqgCggXA7sPfWAoAJvaEtZBrB4Lyx6efsPADyCtmCvf00s/NnOsgVY3m8BTRZPZuGBUACdArY+5lWDqGmYbIrLHEx0ggG5w1OH2fnA7CPizQfaXqgUw80AGywMdIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0BxoAjrT7m4s3AGwwMNIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0B8ZYNMbkX+ZekpuIiOQrPar+xs889HJg6jZg5jAwvVZ8B+ll9PlO5/Fc/o+ECjnHfi8zYfkvM5ulmp4qJXVqx5deD4zfAkw/CGxdAZgoHfuh131QkaI5hu8Bs4Ds8B0AWLnIRGCBsFfn87JffDMwdjOw5R5g8giwZa34jnQQUwDo99wBfJ4TM7COiNdlaj2rA/jeV/vfDeATAP4UGH8I2Lrc6gc+SHqY4oMZ74VSKM0xfA+UUzB/oBUUCKMl6zSQ/PsXqZD5KQC/A0w/DEwcAcYXgYnVwppwADuBkefnCim90FmBWXwnK87Uen53BI8sbuwqaz9p5UgnQhBS+ZN1zE8Ak0utviCwq8DI8/nx5hi+Bzb4gJzKZE1SEFZZgS9/2pWR/gTAJ4HJQ8DEMWB8ARhfBsaWCwDquwQKvvNgHXvOcYVbPFJPkw+dDxC/W1Y4tWDpw/Rlgo4lo1T4/KxTihDNpJwj3/UiMLXemprjffC7eWpzDN8DlYsQDiKtVxzEqoHkyX9HRizW+nIgaQnvAiaeBCbmC0s4tgSMu2rMePAR9X252jXklaTFU108K0MHav/nvJ6ZxVVk9OI7GR2IZoGQNc/HgbHgIwqILIVujuF7oOMqWFawCoRxkfEIB5CWgkREBCNf9wMTc8A4QciBWyoGz16rwNgaML5eWKpctYZL3N+TWLX0gvtuP0HHk2n16JDyxXmVhfU0qywbJbr5GSuXKxA/sV5Y9UYWdnjwyS3qKKgarWA69Wg6fjQOIK0HadnIjPVFB+AiME4AuiUkCFnESyCSkmAuU7Cjm15wX+2X2ifBRn9A8mKcW2UFjULVQcgVDl80u40SYh763FfvquhLCxitoBYUsoJfjXKttByMq9CKcHn4sPuCbgXNJwyWkECcz5Q376UX3LNncZyQAAADEklEQVT9fFgIJs6lBBwtn3Tt6FpIz4RWnuQxPh2XIGzm4CwQ9hWIFgBTK0gQHiIAJddKq0ELQh+KL1qUR4MvSEsoENIKrgALHNiMox+94K7tl9qnnMio8MSf6SNwGpYVjCDk/Ju7isq496fCqX0BkDeqlWwKwic1gAQSpzGREnFgREz01eALLvvq2Kfi45m6cf3qBXdsfxRbJMho8dimqOhEK8cXQRr9QVpvPoDNMXQP9A3ACELFxPh+jACkP0fLIKFCCRRqKuPUdqjlC9o07JZwKVNHeBC94DQcZO0XAAkmgotAk9QYrR9f/BvByYfMSATDVMzwTXMM3QMDAVAgVHCZ7/MaQK4QZUHiNCbBQlqUw74YCb7gcmYkelC9YFlwvVv7RRAorTuBkECU9asCID9/x9B935zYzyKkqpfiNHxcA0gLQgvBAaPVkCqm3h2AtC5m/RyEqzw/4xhGL3hD++MmslgqCbgUfLKAcRrmTlBzDN0DA1tAXUlWcDm1IOIIJAjlT/Fd05lbFQFwjdtgGcewesFt7Rc/Gx8iWjUCjGCT1YvWT1MwgUqrf3NG45tTbcu0aximWx9xENcEQHGbcYAEwtSXSqY0gnCdgeuMI0cvuGx/FUGgFhwEYrR80QckWN+X0fjm1DwAWv8RgJFilJZBznz0pQg+AZAAlVWh1GvGka0XzB0cCQi30aSGVa9AF62fLOB7MhrfnJoPwPER59Px+o3e76mL5Kwp2G57xPl0kxc3er+nLvyKtLmhfUC78RHn081ONnq/pzcAR5xPR9mRRu/31IVgvgUccT4dNaobvd/TGYAjzqejumqj93s6A3DE+XRUg2VSCjdaGr3fUw+I+VPwiPPpqJjO8J1Nw43e7ymHwHoAKMFd7QErAeEE5NNJMb3R+z3lsGcNzgfgiPPpomJ6o/d76oGwPgCOKJ8uKqY3er+nKwBHmE+noqRG7/fUA199U/AI8+kEwEbv93QHoEhZTnA+nYqSGr3fBoAtaiqBUImdm5hPJwA2er+nKwBHnE+X1gUzSbnR+z11wPj/AeCpPDD3t7rvAAAAAElFTkSuQmCC",VHe="uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",jHe="varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",hp={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},kne=class extends nu{constructor({preset:t=hp.MEDIUM,edgeDetectionMode:e=x2.COLOR,predicationMode:i=kGe.DISABLED}={}){super("SMAAEffect",VHe,{vertexShader:jHe,blendFunction:yi.NORMAL,attributes:Vc.CONVOLUTION|Vc.DEPTH,uniforms:new Map([["weightMap",new Ze(null)]])});let n,r;arguments.length>1&&(n=arguments[0],r=arguments[1],arguments.length>2&&(t=arguments[2]),arguments.length>3&&(e=arguments[3])),this.renderTargetEdges=new Hi(1,1,{minFilter:ri,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new gz(!0,!1,!1),this.clearPass.overrideClearColor=new It(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new Ac(new zGe),this.edgeDetectionMaterial.edgeDetectionMode=e,this.edgeDetectionMaterial.predicationMode=i,this.weightsPass=new Ac(new QGe);let s=new Zee;s.onLoad=()=>{let o=new br(n);o.name="SMAA.Search",o.magFilter=Zi,o.minFilter=Zi,o.generateMipmaps=!1,o.needsUpdate=!0,o.flipY=!0,this.weightsMaterial.searchTexture=o;let a=new br(r);a.name="SMAA.Area",a.magFilter=ri,a.minFilter=ri,a.generateMipmaps=!1,a.needsUpdate=!0,a.flipY=!1,this.weightsMaterial.areaTexture=a,this.dispatchEvent({type:"load"})},s.itemStart("search"),s.itemStart("area"),n!==void 0&&r!==void 0?(s.itemEnd("search"),s.itemEnd("area")):typeof Image<"u"&&(n=new Image,r=new Image,n.addEventListener("load",()=>s.itemEnd("search")),r.addEventListener("load",()=>s.itemEnd("area")),n.src=M7,r.src=E7),this.applyPreset(t)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(t){this.edgeDetectionMaterial.edgeDetectionThreshold=t}setOrthogonalSearchSteps(t){this.weightsMaterial.orthogonalSearchSteps=t}applyPreset(t){let e=this.edgeDetectionMaterial,i=this.weightsMaterial;switch(t){case hp.LOW:e.edgeDetectionThreshold=.15,i.orthogonalSearchSteps=4,i.diagonalDetection=!1,i.cornerDetection=!1;break;case hp.MEDIUM:e.edgeDetectionThreshold=.1,i.orthogonalSearchSteps=8,i.diagonalDetection=!1,i.cornerDetection=!1;break;case hp.HIGH:e.edgeDetectionThreshold=.1,i.orthogonalSearchSteps=16,i.diagonalSearchSteps=8,i.cornerRounding=25,i.diagonalDetection=!0,i.cornerDetection=!0;break;case hp.ULTRA:e.edgeDetectionThreshold=.05,i.orthogonalSearchSteps=32,i.diagonalSearchSteps=16,i.cornerRounding=25,i.diagonalDetection=!0,i.cornerDetection=!0;break}}setDepthTexture(t,e=vh){this.edgeDetectionMaterial.depthBuffer=t,this.edgeDetectionMaterial.depthPacking=e}update(t,e,i){this.clearPass.render(t,this.renderTargetEdges),this.edgeDetectionPass.render(t,e,this.renderTargetEdges),this.weightsPass.render(t,this.renderTargetEdges,this.renderTargetWeights)}setSize(t,e){this.edgeDetectionMaterial.setSize(t,e),this.weightsMaterial.setSize(t,e),this.renderTargetEdges.setSize(t,e),this.renderTargetWeights.setSize(t,e)}dispose(){let{searchTexture:t,areaTexture:e}=this.weightsMaterial;t!==null&&e!==null&&(t.dispose(),e.dispose()),super.dispose()}static get searchImageDataURL(){return M7}static get areaImageDataURL(){return E7}},WHe=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,sM={DEFAULT:0,ESKIL:1},XHe=class extends nu{constructor({blendFunction:t=yi.NORMAL,technique:e=sM.DEFAULT,eskil:i=!1,offset:n=.5,darkness:r=.5}={}){super("VignetteEffect",WHe,{blendFunction:t,defines:new Map([["VIGNETTE_TECHNIQUE",e.toFixed(0)]]),uniforms:new Map([["offset",new Ze(n)],["darkness",new Ze(r)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(t){this.technique!==t&&(this.defines.set("VIGNETTE_TECHNIQUE",t.toFixed(0)),this.setChanged())}get eskil(){return this.technique===sM.ESKIL}set eskil(t){this.technique=t?sM.ESKIL:sM.DEFAULT}getTechnique(){return this.technique}setTechnique(t){this.technique=t}get offset(){return this.uniforms.get("offset").value}set offset(t){this.uniforms.get("offset").value=t}getOffset(){return this.offset}setOffset(t){this.offset=t}get darkness(){return this.uniforms.get("darkness").value}set darkness(t){this.uniforms.get("darkness").value=t}getDarkness(){return this.darkness}setDarkness(t){this.darkness=t}},yh=class{constructor(t,e){this.enabled=!1,this.effect=new t(e),Object.defineProperty(this,"opacity",{enumerable:!0,set(i){this.effect.blendMode.opacity.value=i},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(i){this.effect.blendMode.setBlendFunction(Number(i))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=yi.NORMAL}},qHe=class extends yh{constructor(){super(THe),this.blendFunction=yi.SCREEN}set intensity(t){this.effect.intensity=t}get intensity(){return this.effect.intensity}set luminanceThreshold(t){this.effect.luminanceMaterial.threshold=t}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(t){this.effect.luminanceMaterial.smoothing=t}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(t){this.effect.blurPass.scale=t}get blurScale(){return this.effect.blurPass.scale}set kernelSize(t){this.effect.blurPass.kernelSize=t}get kernelSize(){return this.effect.blurPass.kernelSize}},YHe=class extends yh{constructor(){super(PHe)}set contrast(t){this.effect.uniforms.get("contrast").value=t}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(t){this.effect.uniforms.get("brightness").value=t}get brightness(){return this.effect.uniforms.get("brightness").value}},QHe=class extends yh{constructor(){super(BHe),this.effect.offset=new he(.01,.01)}set offset(t){this.effect.offset.set(t[0]/1e3,t[1]/1e3)}get offset(){return[this.effect.offset.x*1e3,this.effect.offset.y*1e3]}},KHe=class extends yh{constructor(){super(RHe)}},JHe=class extends yh{constructor(){super(UHe),this._hue=0}set hue(t){this._hue=t,this.effect.setHue(t)}get hue(){return this._hue}set saturation(t){this.effect.uniforms.get("saturation").value=t}get saturation(){return this.effect.uniforms.get("saturation").value}},ZHe=class extends yh{constructor(){super(zHe),this.blendFunction=yi.OVERLAY}},$He=class extends yh{constructor(){super(XHe)}get eskil(){return this.effect.eskil}set eskil(t){this.effect.eskil=t}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(t){this.effect.uniforms.get("darkness").value=t}get offset(){return this.effect.uniforms.get("offset").value}set offset(t){this.effect.uniforms.get("offset").value=t}},e5e=class extends yh{constructor(t){super(FHe,t)}set focalLength(t){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=t}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(t){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=t}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(t){this.effect.bokehScale=t}},t5e=class extends yh{constructor(){super(HHe)}get granularity(){return this.effect.getGranularity()}set granularity(t){this.effect.setGranularity(t)}},i5e=`#define GLSLIFY 1
varying vec2 vUv;varying vec2 vTexCoords[9];uniform vec2 resolution;void main(){vUv=position.xy*0.5+0.5;vec2 texelSize=vec2(1.0)/resolution;vTexCoords[0]=vUv+vec2(-texelSize.x,-texelSize.y);vTexCoords[1]=vUv+vec2(0.0,-texelSize.y);vTexCoords[2]=vUv+vec2(texelSize.x,-texelSize.y);vTexCoords[3]=vUv+vec2(-texelSize.x,0.0);vTexCoords[4]=vUv+vec2(0.0,0.0);vTexCoords[5]=vUv+vec2(texelSize.x,0.0);vTexCoords[6]=vUv+vec2(-texelSize.x,texelSize.y);vTexCoords[7]=vUv+vec2(0.0,texelSize.y);vTexCoords[8]=vUv+vec2(texelSize.x,texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}`,n5e=`#define GLSLIFY 1
#include <common>
varying vec2 vUv;varying vec2 vTexCoords[9];uniform sampler2D inputBuffer;uniform sampler2D historyBuffer;uniform sampler2D velocityBuffer;uniform sampler2D depthBuffer;uniform vec2 resolution;
#define USE_YCOCG
#define USE_CATMULL_ROM
const float feedback_min=0.5;const float feedback_max=0.95;vec3 RGB_YCoCg(vec3 c){return vec3(c.x/4.0+c.y/2.0+c.z/4.0,c.x/2.0-c.z/2.0,-c.x/4.0+c.y/2.0-c.z/4.0);}vec3 YCoCg_RGB(vec3 c){return clamp(vec3(c.x+c.y-c.z,c.x+c.z,c.x-c.y-c.z),vec3(0.0),vec3(1.0));}vec4 sample_color(sampler2D tex,vec2 uv){
#ifdef USE_YCOCG
vec4 c=texture(tex,uv);return vec4(RGB_YCoCg(c.rgb),c.a);
#else
return texture(tex,uv);
#endif
}vec4 sample_catmull_rom(sampler2D tex,vec2 uv,vec2 texSize){vec2 samplePos=uv*texSize;vec2 texPos1=floor(samplePos-0.5)+0.5;vec2 f=samplePos-texPos1;vec2 w0=f*(-0.5+f*(1.0-0.5*f));vec2 w1=1.0+f*f*(-2.5+1.5*f);vec2 w2=f*(0.5+f*(2.0-1.5*f));vec2 w3=f*f*(-0.5+0.5*f);vec2 w12=w1+w2;vec2 offset12=w2/(w1+w2);vec2 texPos0=texPos1-1.0;vec2 texPos3=texPos1+2.0;vec2 texPos12=texPos1+offset12;texPos0/=texSize;texPos3/=texSize;texPos12/=texSize;vec4 result=vec4(0.0);result+=texture2D(tex,vec2(texPos12.x,texPos0.y))*w12.x*w0.y;result+=texture2D(tex,vec2(texPos0.x,texPos12.y))*w0.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos12.y))*w12.x*w12.y;result+=texture2D(tex,vec2(texPos3.x,texPos12.y))*w3.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos3.y))*w12.x*w3.y;return result;}vec3 choose_motion_vector(){
#ifdef CHOOSE_LONGEST_MOTION_VECTOR
float longest=-1.0;vec3 v_choose=vec3(-1.0);for(int i=0;i<9;i++){vec3 v=texture2D(velocityBuffer,vTexCoords[i]).rgb;float l=length(v.xy);if(l>longest){longest=l;v_choose=v;}}return v_choose;
#else
float closest_depth=1000.0;vec2 closest_uv_offset=vec2(0.0);for(int i=0;i<9;i++){float neighbor_depth=texture2D(depthBuffer,vTexCoords[i]).r;if(neighbor_depth<closest_depth){closest_uv_offset=vTexCoords[i];closest_depth=neighbor_depth;}}return texture2D(velocityBuffer,closest_uv_offset).rgb;
#endif
}vec4 clipAabb(vec3 aabb_min,vec3 aabb_max,vec4 avg,vec4 input_texel){const float FLT_EPS=0.00000001;vec3 p_clip=0.5*(aabb_max+aabb_min);vec3 e_clip=0.5*(aabb_max-aabb_min)+FLT_EPS;vec4 v_clip=input_texel-vec4(p_clip,avg.w);vec3 v_unit=v_clip.xyz/e_clip;vec3 a_unit=abs(v_unit);float ma_unit=max(a_unit.x,max(a_unit.y,a_unit.z));if(ma_unit>1.0){return vec4(p_clip,avg.w)+v_clip/ma_unit;}else{return input_texel;}}vec3 clip_aabb_variance(in vec3 cOld,in vec3 cNew,in vec3 centre,in vec3 halfSize){if(all(lessThanEqual(abs(cOld-centre),halfSize))){return cOld;}vec3 dir=(cNew-cOld);vec3 near=centre-sign(dir)*halfSize;vec3 tAll=(near-cOld)/dir;float t=0.0001;for(int i=0;i<3;i++){if(tAll[i]>=0.0&&tAll[i]<t){t=tAll[i];}}if(t>=0.0001){return cOld;}return cOld+dir*t;}void main(){vec3 v=choose_motion_vector();vec2 velocity=v.rg;vec2 previousPixelPos=vUv-velocity;vec4 currentColor=sample_color(inputBuffer,vUv);
#ifdef USE_CATMULL_ROM
vec4 previousColor=sample_catmull_rom(historyBuffer,previousPixelPos,resolution);
#else
vec4 previousColor=sample_color(historyBuffer,previousPixelPos);
#endif
#ifdef USE_YCOCG
previousColor=vec4(RGB_YCoCg(previousColor.rgb),previousColor.a);
#endif
vec4 ctl=sample_color(inputBuffer,vTexCoords[0]);vec4 ctc=sample_color(inputBuffer,vTexCoords[1]);vec4 ctr=sample_color(inputBuffer,vTexCoords[2]);vec4 cml=sample_color(inputBuffer,vTexCoords[3]);vec4 cmc=sample_color(inputBuffer,vTexCoords[4]);vec4 cmr=sample_color(inputBuffer,vTexCoords[5]);vec4 cbl=sample_color(inputBuffer,vTexCoords[6]);vec4 cbc=sample_color(inputBuffer,vTexCoords[7]);vec4 cbr=sample_color(inputBuffer,vTexCoords[8]);vec4 cmin=min(ctl,min(ctc,min(ctr,min(cml,min(cmc,min(cmr,min(cbl,min(cbc,cbr))))))));vec4 cmax=max(ctl,max(ctc,max(ctr,max(cml,max(cmc,max(cmr,max(cbl,max(cbc,cbr))))))));vec4 cavg=(ctl+ctc+ctr+cml+cmc+cmr+cbl+cbc+cbr)/9.0;vec4 cmin5=min(ctc,min(cml,min(cmc,min(cmr,cbc))));vec4 cmax5=max(ctc,max(cml,max(cmc,max(cmr,cbc))));vec4 cavg5=(ctc+cml+cmc+cmr+cbc)/5.0;cmin=0.5*(cmin+cmin5);cmax=0.5*(cmax+cmax5);cavg=0.5*(cavg+cavg5);
#ifdef USE_YCOCG
vec2 chroma_extent=vec2(0.25*0.5*(cmax.r-cmin.r));vec2 chroma_center=currentColor.gb;cmin.yz=chroma_center-chroma_extent;cmax.yz=chroma_center+chroma_extent;cavg.yz=chroma_center;
#endif
vec4 previousColorClipped=clamp(previousColor,cmin,cmax);
#ifdef LUMINANCE_DIFFERENCES
#ifdef USE_YCOCG
float lum0=currentColor.r;float lum1=previousColorClipped.r;
#else
float lum0=luminance(currentColor.rgb);float lum1=luminance(previousColorClipped.rgb);
#endif
float unbiased_diff=abs(lum0-lum1)/max(lum0,max(lum1,0.2));float unbiased_weight=1.0-unbiased_diff;float unbiased_weight_sqr=unbiased_weight*unbiased_weight;float k_feedback=mix(feedback_min,feedback_max,unbiased_weight_sqr);vec4 result=mix(currentColor,previousColorClipped,vec4(k_feedback));
#else
const float alpha=0.1;vec4 result=mix(currentColor,previousColorClipped,1.0-alpha);
#endif
#ifdef USE_YCOCG
gl_FragColor=vec4(YCoCg_RGB(result.rgb).rgb,result.a);
#else
gl_FragColor=result;
#endif
}`,r5e=`#define GLSLIFY 1
varying vec2 vUv;void main(){gl_Position=vec4(position.xy,1.0,1.0);vUv=position.xy*0.5+0.5;}`,s5e=`#define GLSLIFY 1
layout(location=1)out vec4 gVelocity;varying vec2 vUv;uniform sampler2D inputBuffer;void main(){gl_FragColor=texture2D(inputBuffer,vUv);gVelocity=vec4(0.0);}`,eF=class extends $i{constructor(){super({name:"PassthroughMaterial",uniforms:{inputBuffer:new Ze(null)},blending:fr,depthWrite:!1,depthTest:!1,vertexShader:r5e,fragmentShader:s5e})}set inputBuffer(t){this.uniforms.inputBuffer.value=t}},o5e=class extends Ys{constructor(){super("TAAResolvePass"),this.MRTCompatible=!0,this.needsSwap=!1,this.passThroughMaterial=new eF,this.resolutionVector=new he,this.resolveMaterial=new $i({name:"TAAResolveMaterial",uniforms:{inputBuffer:new Ze(null),historyBuffer:new Ze(null),velocityBuffer:new Ze(null),depthBuffer:new Ze(null),resolution:new Ze(new he)},blending:fr,depthWrite:!1,depthTest:!1,vertexShader:i5e,fragmentShader:n5e}),this.historyRenderTarget=new Hi(1024,1024,{minFilter:ri,stencilBuffer:!1,depthBuffer:!1}),this.historyRenderTarget.texture.name="TAA.History",this.resultRenderTarget=new Hi(1024,1024,{minFilter:ri,stencilBuffer:!1,depthBuffer:!1}),this.resultRenderTarget.texture.name="TAA.Output"}setSize(t,e){this.historyRenderTarget.setSize(t,e),this.resultRenderTarget.setSize(t,e)}render(t,e){this.fullscreenMaterial=this.resolveMaterial,this.resolveMaterial.uniforms.inputBuffer.value=e.texture[0],this.resolveMaterial.uniforms.velocityBuffer.value=e.texture[1],this.resolveMaterial.uniforms.depthBuffer.value=e.depthTexture,this.resolveMaterial.uniforms.historyBuffer.value=this.historyRenderTarget.texture,this.resolveMaterial.uniforms.resolution.value.set(e.width,e.height),t.setRenderTarget(this.resultRenderTarget),t.render(this.scene,this.camera),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,t.setRenderTarget(this.historyRenderTarget),t.render(this.scene,this.camera);let i=this.renderToScreen?null:e;this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,t.setRenderTarget(i),t.render(this.scene,this.camera)}dispose(){this.resultRenderTarget.dispose(),this.historyRenderTarget.dispose(),this.resolveMaterial.dispose(),this.passThroughMaterial.dispose()}},a5e=class extends Ys{constructor(t,e,i){super("TransmissionPass",void 0,e),this.MRTCompatible=!0,this.depthPass=new S7(t,e,{renderTarget:i.transmissionDepthTarget}),this.passThroughMaterial=new eF,this.splineScene=t,this.needsSwap=!1}updatePasses(t){this.passThroughMaterial=new eF,this.depthPass=new S7(this.splineScene,this.camera,{renderTarget:t.transmissionDepthTarget})}setCamera(t){this.camera=t}setScene(t){this.splineScene=t}render(t,e,i){let n=this.camera.layers.mask,r=t;r.setRenderTarget(r.transmissionRenderTarget),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=e.texture[0],r.clear(),r.render(this.scene,this.camera),this.camera.layers.disable(3),this.depthPass.render(t,e,i),r.shadowMap.needsUpdate=!1,r.shadowMap.autoUpdate=!1;let s=this.renderToScreen?null:e;this.camera.layers.set(3),t.setRenderTarget(s),t.render(this.splineScene,this.camera),this.camera.layers.mask=n}},T7=new Nd,l5e=new $i({transparent:!0,vertexShader:`
        void main() {
            gl_Position = vec4(0.0);
        }
    `,fragmentShader:`
        layout(location = 1) out vec4 gVelocity;

        void main() {
            gl_FragColor = vec4(0.0);
			gVelocity = vec4(0.0);
        }
    `}),tF=class extends Ys{constructor(t,e,i){super("OpaquePass",e??T7,i),this.MRTCompatible=!0,this.hasTransmissionPass=!1,this.clear=!0,this.clearColorOnly=!1,this.clearDepth=!1,this.needsSwap=!1,this.originalMaterials=new Map,this.MRTCompatible=t}setCamera(t){this.camera=t}setScene(t){this.scene=t??T7}getScene(){return this.scene}render(t,e){this.camera.layers.enable(3),this.hasTransmissionPass&&(this.originalMaterials.clear(),this.scene.traverse(n=>{n.layers.isEnabled(3)&&n instanceof Mo&&(this.originalMaterials.set(n.id,n.material),n.material=l5e)}),t.shadowMap.needsUpdate=!0,t.shadowMap.autoUpdate=!0),this.camera.layers.enable(8);let i=this.renderToScreen?null:e;t.setRenderTarget(i),this.clearColorOnly&&t.clear(!0,!1,!0),this.clear&&t.clear(),t.render(this.scene,this.camera),this.clearDepth&&t.clear(!1,!0,!1),this.hasTransmissionPass&&this.originalMaterials.forEach((n,r)=>{let s=this.scene.getObjectById(r);s&&(s.material=n)})}},c5e=class{constructor(t,{depthBuffer:e=!0,stencilBuffer:i=!1,multisampling:n=0,frameBufferType:r=0}={}){this.renderer=t,this.helperStartIndex=0,this.copyPass=new $O,this.depthTexture=null,this.timer=new MHe,this._width=1,this._height=1,this.passes=[],this.helperPasses=[],this.autoRenderToScreen=!0,this.inputBuffer=this.createBuffer(e,i,r,n,!0,"input buffer mrt"),this.inputBufferSingle=this.createBuffer(e,i,r,n,!1," input buffer single"),this.inputBufferSingle.texture.dispose(),this.inputBufferSingle.depthTexture.dispose(),this.inputBufferSingle.texture=this.inputBuffer.texture[0],this.inputBufferSingle.depthTexture=this.inputBuffer.depthTexture,this.outputBuffer=this.inputBuffer.clone(),this.outputBuffer.name="output buffer mrt",this.outputBufferSingle=this.createBuffer(e,i,r,n,!1,"output buffer single"),this.outputBufferSingle.texture.dispose(),this.outputBufferSingle.depthTexture.dispose(),this.outputBufferSingle.texture=this.outputBuffer.texture[0],this.outputBufferSingle.depthTexture=this.outputBuffer.depthTexture,this.setRenderer(t)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(t){let e=this.inputBuffer,i=this.multisampling;i>0&&t>0?(this.inputBuffer.samples=t,this.outputBuffer.samples=t,this.inputBuffer.dispose(),this.outputBuffer.dispose()):i!==t&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("creating new input buffer"),this.inputBuffer=this.createBuffer(e.depthBuffer,e.stencilBuffer,e.texture.type,t,!0,"new input buffer"),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(t){var e;if(this.renderer=t,t!==null){let i=t.getSize(new he),n=((e=t.getContext().getContextAttributes())==null?void 0:e.alpha)??!1,r=this.inputBuffer.texture[0].type;r===As&&t.outputEncoding===Qt&&(this.inputBuffer.texture[0].encoding=Qt,this.outputBuffer.texture[0].encoding=Qt,this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("doing some kinda dispose??")),t.autoClear=!1,this.setSize(i.width,i.height,!1);for(let s of this.passes)s.initialize(t,n,r)}}replaceRenderer(t,e=!0){let i=this.renderer,n=i.domElement.parentNode;return this.setRenderer(t),e&&n!==null&&(n.removeChild(i.domElement),n.appendChild(t.domElement)),i}createDepthTexture(){let t=this.depthTexture=new k0(this._width,this._height);return this.inputBuffer.depthTexture=t,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(t.format=am,t.type=Gp):t.type=pd,t}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let t of this.passes)t.setDepthTexture(null)}}createBuffer(t,e,i,n,r,s){let o=this.renderer,a=o===null?new he:o.getDrawingBufferSize(new he),l={minFilter:ri,magFilter:ri,wrapS:Qn,wrapT:Qn,stencilBuffer:e,depthBuffer:t},c;return n>0?(c=new Hi(a.width,a.height,l),c.samples=n):(r?(c=new zAe(a.width,a.height,2,l),c.texture[1].type=N0):c=new Hi(a.width,a.height,l),c.depthTexture=new k0(2048,2048),c.depthTexture.type=Xo),i===As&&o!==null&&o.outputEncoding===Qt&&(Array.isArray(c.texture)?c.texture.forEach(h=>h.encoding=Qt):c.texture.encoding=Qt),Array.isArray(c.texture)?c.texture.forEach((h,u)=>{h.name=`EffectComposer.Buffer ${r} ${u}`,h.generateMipmaps=!1}):(c.texture.name=`EffectComposer.Buffer ${r}`,c.texture.generateMipmaps=!1),c.name=s,c}addPass(t,e){var a;let i=this.passes,n=this.renderer,r=n.getDrawingBufferSize(new he),s=((a=n.getContext().getContextAttributes())==null?void 0:a.alpha)??!1,o;if(t.MRTCompatible&&(o=this.inputBuffer.texture[0].type),t.MRTCompatible||(o=this.inputBuffer.texture.type),t.setRenderer(n),t.setSize(r.width,r.height),t.initialize(n,s,o),this.autoRenderToScreen&&(i.length>0&&(i[i.length-1].renderToScreen=!1),t.renderToScreen&&(this.autoRenderToScreen=!1)),e!==void 0?i.splice(e,0,t):i.push(t),this.autoRenderToScreen&&(i[i.length-1].renderToScreen=!0),t.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){let l=this.createDepthTexture();for(t of i)t.setDepthTexture(l)}else t.setDepthTexture(this.depthTexture)}setHelperStartIndex(t){this.helperStartIndex=t}removePass(t){let e=this.passes,i=e.indexOf(t);if(i!==-1&&e.splice(i,1).length>0){if(this.depthTexture!==null){let n=(r,s)=>r||s.needsDepthTexture;e.reduce(n,!1)||(t.getDepthTexture()===this.depthTexture&&t.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&i===e.length&&(t.renderToScreen=!1,e.length>0&&(e[e.length-1].renderToScreen=!0))}}removeAllPasses(){let t=this.passes;this.deleteDepthTexture(),t.length>0&&(this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!1),this.passes=[])}render(t){let e=this.renderer,i=this.copyPass,n=this.inputBuffer,r=this.outputBuffer,s=this.inputBufferSingle,o=this.outputBufferSingle,a=!1,l,c,h,u;t===void 0&&(t=this.timer.update().getDelta());for(let d of this.passes)d.enabled&&(d.MRTCompatible?d.render(e,n,r,t,a):d.render(e,s,o,t,a),d.needsSwap&&(a&&(i.renderToScreen=d.renderToScreen,l=e.getContext(),c=e.state.buffers.stencil,c.setFunc(l.NOTEQUAL,1,4294967295),i.render(e,n,r,t,a),c.setFunc(l.EQUAL,1,4294967295)),h=n,u=s,n=r,s=o,r=h,o=u),d instanceof SHe?a=!0:d instanceof ZGe&&(a=!1))}setSize(t,e,i){let n=this.renderer;if(this._width=t,this._height=e,t===void 0||e===void 0){let s=n.getSize(new he);t=s.width,e=s.height}n.setSize(t,e,i);let r=n.getDrawingBufferSize(new he);this.inputBuffer.setSize(r.width,r.height),this.outputBuffer.setSize(r.width,r.height),this.inputBufferSingle.setSize(r.width,r.height),this.outputBufferSingle.setSize(r.width,r.height);for(let s of this.passes)s.setSize(r.width,r.height)}reset(){let t=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(t)}dispose(){for(let t of this.passes)t.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.inputBufferSingle!==null&&this.inputBufferSingle.dispose(),this.outputBufferSingle!==null&&this.outputBufferSingle.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},u5e=new $i({name:"CombineMaterial",uniforms:{inputBufferA:new Ze(null),inputBufferB:new Ze(null)},blending:fr,depthWrite:!1,depthTest:!1,vertexShader:`
varying vec2 vUv;
void main() {
    gl_Position = vec4(position.xy, 1.0, 1.0);
    vUv = position.xy * 0.5 + 0.5;
}
`,fragmentShader:`
    varying vec2 vUv;
    uniform sampler2D inputBufferA;
    uniform sampler2D inputBufferB;

    // TODO: Why do we need these when postpro of framemode is enabled???
    layout(location = 1) out vec4 gVelocity;

    void main() {
	vec4 resA = texture2D(inputBufferA, vUv);
	vec4 resB = texture2D(inputBufferB, vUv);
    float a = resA.a + resB.a * ( 1.0 - resA.a );

	vec4 res;
	res.rgb =  resA.rgb + (resB.rgb * (1.0 - resA.a));
	res.a = resA.a + resB.a * (1.0 - resA.a);
	gl_FragColor = res;
    gVelocity = vec4(0.0);
    }
`}),h5e=class extends Ys{constructor(t){super("HelperPass",void 0,t),this.MRTCompatible=!1,this.fullscreenMaterial=u5e,this.helperPass=new tF(!1,void 0,this.camera),this.helperPass.hasTransmissionPass=!1,this.helperPass.clear=!1,this.helperPass.renderToScreen=!1,this.helperPassOnTop=new tF(!1,void 0,this.camera),this.helperPassOnTop.hasTransmissionPass=!1,this.helperPassOnTop.clear=!1,this.helperPassOnTop.renderToScreen=!1;let e=new kne({preset:hp.LOW,edgeDetectionMode:x2.COLOR});this.effectPass=new zT(this.camera,e),this.rt=new Hi(10,10,{minFilter:ri,magFilter:ri,wrapS:Qn,wrapT:Qn,depthBuffer:!0})}setSize(t,e){this.rt.setSize(t,e),this.effectPass.setSize(t,e)}set sceneHelpers(t){this.helperPass.setScene(t)}get sceneHelpers(){return this.helperPass.getScene()}set sceneHelpersOnTop(t){this.helperPassOnTop.setScene(t)}get sceneHelpersOnTop(){return this.helperPassOnTop.getScene()}setCamera(t){this.helperPass.setCamera(t),this.helperPassOnTop.setCamera(t)}initialize(t,e,i){super.initialize(t,e,i),this.effectPass.initialize(t,e,i)}dispose(){super.dispose(),this.rt.dispose(),this.effectPass.dispose()}render(t,e,i){this.rt.depthTexture=e.depthTexture;let n=t.getClearAlpha();t.setClearAlpha(0),this.helperPass.clearDepth=!0,this.helperPass.clearColorOnly=!0,this.helperPass.render(t,this.rt),this.helperPassOnTop.render(t,this.rt),this.effectPass.renderToScreen=!1,this.effectPass.render(t,this.rt,i),this.fullscreenMaterial.uniforms.inputBufferA.value=i.texture,this.fullscreenMaterial.uniforms.inputBufferB.value=e.texture,t.setClearAlpha(n),t.setRenderTarget(null),t.clear(),t.render(this.scene,this.camera)}},d5e=`#define GLSLIFY 1
#include <skinning_pars_vertex>
out vec3 n;void main(){
#include <beginnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <defaultnormal_vertex>
#include <begin_vertex>
#include <skinning_vertex>
vec4 view_space=viewMatrix*modelMatrix*vec4(transformed,1.0);gl_Position=projectionMatrix*view_space;n=normalize(transformedNormal);}`,f5e=`#define GLSLIFY 1
in vec3 n;void main(){gl_FragColor=vec4(n,1.0);}`,p5e=`#define GLSLIFY 1
out vec2 v_uv;void main(){v_uv=uv;gl_Position=vec4(position.xy,1.0,1.0);}`,m5e=`#define GLSLIFY 1
in vec2 v_uv;const float pi=3.14159265;const float num_steps=4.0;const float num_directions=4.0;uniform float near;uniform float far;uniform float fov;uniform vec4 proj_info;uniform bool is_ortho;uniform vec2 resolution;uniform float radius_of_influence;uniform float radius_in_screen_space;uniform float exponent;uniform vec3 ao_color;uniform float bias;uniform sampler2D texture_depth;uniform sampler2D texture_normals;uniform sampler2D texture_blue_noise;uniform sampler2D texture_blue_noise_in_disk;uniform sampler2D texture_color_pass;uniform int frame_index;uniform bool fog_enabled;uniform float fog_near;uniform float fog_far;vec3 uv_to_view_space(vec2 uv,float eye_z){return vec3((uv*proj_info.xy+proj_info.zw)*(is_ortho ? 1.0 : eye_z),eye_z);}float linearize_depth(float depth_sampled){float z=is_ortho ? depth_sampled : depth_sampled*2.0-1.0;return mix((2.0*near*far)/(far+near-z*(far-near)),near+z*(far-near),float(is_ortho));}vec3 get_view_position(vec2 uv_coords){float linear_depth=linearize_depth(texture(texture_depth,uv_coords).x);return uv_to_view_space(uv_coords,linear_depth);}vec3 min_difference(vec3 p,vec3 right,vec3 left){vec3 v1=right-p;vec3 v2=p-left;return(dot(v1,v1)<dot(v2,v2))? v1 : v2;}vec3 rebuild_normal(in vec2 uv,in vec3 p){vec2 one_over_resolution=1.0/resolution;vec3 r=get_view_position(uv+vec2(one_over_resolution.x,0));vec3 l=get_view_position(uv+vec2(-one_over_resolution.x,0));vec3 t=get_view_position(uv+vec2(0,one_over_resolution.y));vec3 b=get_view_position(uv+vec2(0,-one_over_resolution.y));return normalize(cross(min_difference(p,r,l),min_difference(p,t,b)));}float falloff(float distance_squared){float neg_inv_r2=-1.0/(radius_of_influence*radius_of_influence);return distance_squared*neg_inv_r2+1.0;}float ao_contribution(vec3 P,vec3 N,vec3 S){vec3 to_sample=S-P;float norm_squared=dot(to_sample,to_sample);float norm=sqrt(norm_squared);float cos_theta=dot(N,to_sample)/norm;return clamp(cos_theta-bias,0.0,1.0)*clamp(falloff(norm_squared),0.0,1.0);}float compute_ambient_occlusion(vec2 uv,float radius_in_screen_space,vec3 pc,vec3 view_space_n){vec2 one_over_resolution=1.0/resolution;ivec2 noise_uv=ivec2(int(mod(gl_FragCoord.x,128.0)),int(mod(gl_FragCoord.y,128.0)));float noise=texelFetch(texture_blue_noise,noise_uv,0).r;noise=fract(noise+0.61803398875*float(frame_index));float theta=noise*2.0*3.1415;float ct=cos(theta);float st=sin(theta);float step_size=radius_in_screen_space/(num_steps+1.0);const float angle_step=2.0*pi/num_directions;float contribution=0.0;for(int i=0;i<int(num_directions);++i){float current_pixel=step_size+1.0;for(int j=0;j<int(num_steps);++j){int index=i*int(num_steps)+j;vec2 blue_noise_sample=texelFetch(texture_blue_noise_in_disk,ivec2(index,0),0).rg;vec2 disk_point;disk_point.x=blue_noise_sample.x*ct-blue_noise_sample.y*st;disk_point.y=blue_noise_sample.x*st+blue_noise_sample.y*ct;vec2 sample_direction=disk_point;vec2 snapped_uv=round(current_pixel*sample_direction)*one_over_resolution+uv;vec3 ps=get_view_position(snapped_uv);current_pixel+=step_size;contribution+=ao_contribution(pc,view_space_n,ps);}}float mult=1.0/(1.0-bias);contribution*=mult/(num_directions*num_steps);return clamp(1.0-contribution*2.0,0.0,1.0);}
#define USE_GBUFFER_NORMALS
void main(){vec3 view_space_p=get_view_position(v_uv);
#ifdef USE_GBUFFER_NORMALS
vec3 view_space_n=texture(texture_normals,v_uv).rgb;view_space_n.z*=-1.0;
#else
vec3 view_space_n=-rebuild_normal(v_uv,view_space_p);
#endif
float radius_ss=radius_in_screen_space/(is_ortho ? 1.0 : view_space_p.z);float ao=compute_ambient_occlusion(v_uv,radius_ss,view_space_p,view_space_n);float final=pow(ao,exponent);if(view_space_p.z>=far){final=1.0;}vec3 color=mix(ao_color,vec3(1.0),final);if(fog_enabled){float fog_factor=smoothstep(fog_near,fog_far,view_space_p.z);color=mix(color,vec3(1.0),fog_factor);}gl_FragColor=vec4(color,1.0);}`,g5e=`#define GLSLIFY 1
out vec2 v_uv;void main(){gl_Position=vec4(position.xy,1.0,1.0);v_uv=uv;}`,v5e=`#define GLSLIFY 1
in vec2 v_uv;uniform sampler2D texture_ao_lrez;uniform sampler2D texture_depth_lrez;uniform sampler2D texture_depth_hrez;uniform float near;uniform float far;float linearize_depth(float depth_sampled){float z=depth_sampled*2.0-1.0;return(2.0*near*far)/(far+near-z*(far-near));}vec2 nearest_depth_filter(in vec2 uv){vec2 resolution=vec2(textureSize(texture_depth_lrez,0));vec2 texel_size=1.0/resolution;vec2 offset=uv-0.5*texel_size;float d_hrez=texture(texture_depth_hrez,uv).r;float a=abs(d_hrez-texture(texture_depth_lrez,offset).r);float b=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,0.0)).r);float c=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(0.0,texel_size.y)).r);float d=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,texel_size.y)).r);float min_diff=min(a,min(b,min(c,d)));if(min_diff==a)return offset;if(min_diff==b)return offset+vec2(texel_size.x,0.0);if(min_diff==c)return offset+vec2(0.0,texel_size.y);if(min_diff==d)return offset+vec2(texel_size.x,texel_size.y);}void main(){
#ifdef DEBUG
float d_lrez=texture(texture_depth_lrez,v_uv).r;float d_hrez=texture(texture_depth_hrez,v_uv).r;float output_d=mix(linearize_depth(d_lrez)/far,linearize_depth(d_hrez)/far,step(0.5,v_uv.x));gl_FragColor=vec4(vec3(output_d),1.0);
#else
vec2 filtered_uv=nearest_depth_filter(v_uv);vec4 ao=texture(texture_ao_lrez,filtered_uv);gl_FragColor=vec4(ao.rgb,1.0);gl_FragColor=ao;
#endif
}`,zx=[[.478712,.875764],[-.337956,-.793959],[-.955259,-.028164],[.864527,.325689],[.209342,-.395657],[-.106779,.672585],[.156213,.235113],[-.413644,-.082856],[-.415667,.323909],[.141896,-.93998],[.954932,-.182516],[-.766184,.410799],[-.434912,-.458845],[.415242,-.078724],[.728335,-.491777],[-.058086,-.066401],[.20299,.686837],[-.808362,-.556402],[.507386,-.640839],[-.723494,-.22924],[.48974,.317826],[-.622663,.765301],[-.01064,.929347],[.663146,.647618],[-.096674,-.413835],[.525945,-.321063],[-.122533,.366019],[.195235,-.687983],[-.563203,.098748],[.418563,.561335],[-.378595,.800367],[.826922,.001024],[-.085372,-.766651],[-.92192,.183673],[-.590008,-.721799],[.167751,-.164393],[.032961,-.56253],[.6329,-.107059],[-.46408,.569669],[-.173676,-.958758],[-.242648,-.234303],[-.275362,.157163],[.382295,-.795131],[.562955,.115562],[.190586,.470121],[.770764,-.297576],[.237281,.93105],[-.666642,-.455871],[-.905649,-.298379],[.33952,.157829],[.701438,-.7041],[-.062758,.160346],[-.220674,.957141],[.642692,.432706],[-.77339,-.015272],[-.671467,.24688],[.158051,.062859],[.806009,.527232],[-.05762,-.247071],[.333436,-.51671],[-.550658,-.315773],[-.652078,.589846],[.008818,.530556],[-.210004,.519896]],y5e=new $i({vertexShader:d5e,fragmentShader:f5e}),oM=new $i({vertexShader:g5e,fragmentShader:v5e,uniforms:{texture_ao_lrez:new Ze(null),texture_depth_lrez:new Ze(null),texture_depth_hrez:new Ze(null),near:new Ze(null),far:new Ze(null)}}),x5e=class extends Ys{constructor(t,e){super("AmbientOcclusionPass",void 0,e),this.fogEnabled=!1,this.fogNear=1,this.fogFar=1e3,this.frameIndex=0,this._runHalfRes=!0,this._width=1,this._height=1;let i=1024,n=1024;this.gBuffer=new Hi(i,n,{type:Xo,depthTexture:new k0(i,n),minFilter:ri,magFilter:ri}),this.depthBufferHighRes=new Hi(i,n,{depthTexture:new k0(i,n)}),this.aoBuffer=new Hi(i,n,{minFilter:ri,magFilter:ri}),this.splineScene=t,this.splineCamera=e;let r=new Float32Array(zx.length*2);for(let o=0;o<zx.length;o++){let a=o*2;r[a+0]=zx[o][0],r[a+1]=zx[o][1]}this.blueNoiseInDiskTexture=new tT(r,zx.length,1,gee,Xo),this.blueNoiseInDiskTexture.wrapS=Qu,this.blueNoiseInDiskTexture.wrapT=Qu,this.blueNoiseInDiskTexture.needsUpdate=!0,this.hbaoMaterial=new $i({vertexShader:p5e,fragmentShader:m5e,uniforms:{near:new Ze(null),far:new Ze(null),fov:new Ze(null),proj_info:new Ze(new Kt),is_ortho:new Ze(!1),resolution:new Ze(new he),radius_of_influence:new Ze(8),radius_in_screen_space:new Ze(1),exponent:new Ze(1),ao_color:new Ze(new L),bias:new Ze(.5),texture_depth:new Ze(null),texture_normals:new Ze(null),texture_blue_noise:new Ze(null),texture_blue_noise_in_disk:new Ze(this.blueNoiseInDiskTexture),frame_index:new Ze(0),fog_enabled:new Ze(!1),fog_near:new Ze(1),fog_far:new Ze(1e3)}}),this.radius=128,this.aoColor={r:0,g:0,b:0},this.bias=.5,this.hbaoMaterial.uniforms.texture_depth.value=this.gBuffer.depthTexture,this.hbaoMaterial.uniforms.texture_normals.value=this.gBuffer.texture,this.needsSwap=!0,this.aaBuffer=new Hi(i,n,{minFilter:ri,magFilter:ri,wrapS:Qn,wrapT:Qn,depthBuffer:!1,type:Xo});let s=new kne({preset:hp.ULTRA,edgeDetectionMode:x2.COLOR});this.effectPass=new zT(this.camera,s)}initialize(t,e,i){super.initialize(t,e,i),this.effectPass.initialize(t,e,i)}setBlueNoiseTexture(t){this.hbaoMaterial.uniforms.texture_blue_noise.value=t}setSize(t,e){this._width=t,this._height=e,this.depthBufferHighRes.setSize(t,e);let i=this._runHalfRes?.5:1,n=t*i,r=e*i;this.gBuffer.setSize(n,r),this.aoBuffer.setSize(n,r),this.hbaoMaterial.uniforms.resolution.value.set(n,r),this.aaBuffer.setSize(n,r),this.effectPass.setSize(n,r)}get runHalfRes(){return this._runHalfRes}set runHalfRes(t){this._runHalfRes=t,this.setSize(this._width,this._height)}setCamera(t){this.splineCamera=t}setScene(t){this.splineScene=t}render(t,e,i){this.splineScene.overrideMaterial=y5e;let n=this.splineCamera.layers.mask;if(this.splineCamera.layers.set(5),t.setRenderTarget(this.gBuffer),t.clear(),t.render(this.splineScene,this.splineCamera),t.setRenderTarget(this.depthBufferHighRes),t.clear(),t.render(this.splineScene,this.splineCamera),this.splineScene.overrideMaterial=null,this.splineCamera.layers.mask=n,this.hbaoMaterial.uniforms.radius_of_influence.value=this.radius,this.hbaoMaterial.uniforms.ao_color.value.set(this.aoColor.r,this.aoColor.g,this.aoColor.b),this.hbaoMaterial.uniforms.bias.value=this.bias,this.hbaoMaterial.uniforms.fog_enabled.value=this.fogEnabled,this.hbaoMaterial.uniforms.fog_near.value=this.fogNear,this.hbaoMaterial.uniforms.fog_far.value=this.fogFar,this.hbaoMaterial.uniforms.frame_index.value=this.frameIndex,this.frameIndex++,this.splineCamera.isPerspectiveCamera){this.hbaoMaterial.uniforms.near.value=this.splineCamera.perspCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.perspCamera.far;let r=this.splineCamera.perspCamera.projectionMatrix.elements,s=2/r[0],o=2/r[5],a=-(1-r[8])/r[0],l=-(1+r[9])/r[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,o,a,l);let c=this.splineCamera.perspCamera.fov*(Math.PI/180),h=this.hbaoMaterial.uniforms.resolution.value.y/(Math.tan(c*.5)*2),u=this.hbaoMaterial.uniforms.radius_of_influence.value*.5*h;this.hbaoMaterial.uniforms.radius_in_screen_space.value=u,this.hbaoMaterial.uniforms.is_ortho.value=!1}else{this.hbaoMaterial.uniforms.near.value=this.splineCamera.orthoCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.orthoCamera.far;let r=this.splineCamera.orthoCamera.projectionMatrix.elements,s=2/r[0],o=2/r[5],a=-(1+r[12])/r[0],l=-(1-r[13])/r[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,o,a,l);let c=.5*(this.hbaoMaterial.uniforms.resolution.value.y/o),h=this.hbaoMaterial.uniforms.radius_of_influence.value*c;this.hbaoMaterial.uniforms.radius_in_screen_space.value=h,this.hbaoMaterial.uniforms.is_ortho.value=!0}this.runHalfRes?(this.fullscreenMaterial=this.hbaoMaterial,t.setRenderTarget(this.aoBuffer),t.clear(),t.render(this.scene,this.camera),this.fullscreenMaterial=oM,oM.uniforms.texture_ao_lrez.value=this.aoBuffer.texture,oM.uniforms.texture_depth_lrez.value=this.gBuffer.depthTexture,oM.uniforms.texture_depth_hrez.value=this.depthBufferHighRes.depthTexture,t.setRenderTarget(t.aoRenderTarget),t.clear(),t.render(this.scene,this.camera)):(this.fullscreenMaterial=this.hbaoMaterial,t.setRenderTarget(this.aaBuffer),t.clear(),t.render(this.scene,this.camera),this.effectPass.renderToScreen=!1,this.effectPass.render(t,this.aaBuffer,t.aoRenderTarget))}dispose(){this.gBuffer.dispose(),this.depthBufferHighRes.dispose(),this.aoBuffer.dispose()}},_5e=`
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,w5e=`
uniform sampler2D tInput;
uniform sampler2D tMap;
uniform vec2 resolution;
varying vec2 vUv;

uniform vec2 uResolution;
uniform vec2 uCoords;

// Draws a rectangle at center <st> with size <size>
float rectangle(vec2 st, vec2 size) {
    size = vec2(0.5) - size * 0.5;
    vec2 uv = vec2(step(size.x, st.x), step(size.y, st.y));
    uv *= vec2(step(size.x, 1.0 - st.x), step(size.y, 1.0 - st.y));

    return uv.x * uv.y;
}

uniform vec2 uSize;
uniform float uScale;
uniform float uDPR;
uniform float uCurrent;
uniform vec3 uSceneColor;

void main() {
    vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
    screenUv *= 1.0 / uDPR;

    vec2 center = vec2(0.5, -0.5);
    vec2 outsideUv = screenUv;
    outsideUv += center;
    outsideUv -= uCoords.xy / uResolution.xy;
    outsideUv = (outsideUv - 0.5) + 0.5;
    outsideUv -= center;
    vec2 s = (uSize / uResolution) * uScale;
    float isOutside = 1.0 - rectangle(outsideUv, s);
    
    vec2 mid = vec2(0.5);
    vec2 insideUv = (screenUv - mid + s * mid) / s;
    vec4 background = texture2D(tInput, screenUv);
    vec4 image = texture2D(tMap, insideUv);
    gl_FragColor = mix(image, background, isOutside);
}
`,b5e=class extends Ac{constructor(){super(new $i({vertexShader:_5e,fragmentShader:w5e,uniforms:{tInput:new Ze(null),tMap:new Ze(null),uResolution:new Ze(new he),uSize:new Ze(new he),uCoords:new Ze(new he),uScale:new Ze(1),uSceneColor:new Ze(new It(16711680)),uDPR:new Ze(1),uCurrent:new Ze(0)}}),"tInput"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tMap.value}set texture(t){this.uniforms.tMap.value=t}},S5e=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,A5e=`
uniform sampler2D toScene;
uniform sampler2D fromScene;
uniform vec2 resolution;

uniform vec2 uResolution;
uniform float uDPR;

uniform float mixRatio;
uniform sampler2D tMixTexture;
uniform int useTexture;
uniform float threshold;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( fromScene, screenUv );
	vec4 texel2 = texture2D( toScene, screenUv );

	if (useTexture==1) {
		
		vec4 transitionTexel = texture2D( tMixTexture, screenUv );
		float r = mixRatio * (1.0 + threshold * 2.0) - threshold;
		float mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);
		
		gl_FragColor = mix( texel1, texel2, mixf );
	} else {
		
		gl_FragColor = mix( texel1, texel2, mixRatio );
		
	}
}
`,M5e=[],E5e=class extends Ac{constructor(){super(new $i({vertexShader:S5e,fragmentShader:A5e,uniforms:{toScene:new Ze(null),fromScene:new Ze(null),uResolution:new Ze(new he),uDPR:new Ze(1),mixRatio:new Ze(0),threshold:new Ze(.1),useTexture:new Ze(0),tMixTexture:{value:M5e[0]}}}),"toScene"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.fromScene.value}set texture(t){this.uniforms.fromScene.value=t}};function C7(t,e){return e&&e.enabled&&t.push(e.effect),t}var T5e=t=>Object.values(yi).includes(t)?t:yi.NORMAL,C5e=class extends is{constructor(t){super(),this.postprocessingState=TT.defaultData,this._scene=new Nd,this._camera=new js,this.effects=new Map,this.blueNoiseTexture=new tT,this._renderToScreen=!0,this.clock=new PPe,this.renderer=t,this.debug=!1,this.effects.set("bloom",new qHe),this.effects.set("chromaticAberration",new QHe),this.effects.set("vignette",new $He),this.effects.set("noise",new ZHe),this.effects.set("colorAverage",new KHe),this.effects.set("hueSaturation",new JHe),this.effects.set("brightnessContrast",new YHe),this.effects.set("depthOfField",new e5e),this.effects.set("pixelation",new t5e),this.effectComposer=new c5e(this.renderer),this.effectComposer.autoRenderToScreen=!1,this.opaquePass=new tF(!0,this.scene,this.camera),this.opaquePass.clear=!0,this.transmissionPass=new a5e(this.scene,this.camera,this.renderer),this.aoPass=new x5e(this.scene,this.camera),this.taaPass=new o5e,this.taaPass.renderToScreen=!1,this.helperPass=new h5e(this.camera),this.helperPass.renderToScreen=!1,this.overlayPass=new b5e,this.overlayPass.enabled=!1,this.sceneTransitionPass=new E5e,this.sceneTransitionPass.enabled=!1,this._initCopyPass(),this._initPasses()}set overlayTexture(t){t!==void 0?(this.overlayPass.texture=t,this.overlayPass.enabled=!0):this.overlayPass.enabled=!1}get overlayTexture(){return this.overlayPass.texture}set sceneHelpers(t){this.helperPass.sceneHelpers=t}get sceneHelpers(){return this.helperPass.sceneHelpers}set sceneHelpersOnTop(t){this.helperPass.sceneHelpersOnTop=t}get sceneHelpersOnTop(){return this.helperPass.sceneHelpersOnTop}get scene(){return this._scene}set scene(t){this._scene=t,this.opaquePass.setScene(t),this.transmissionPass.setScene(t),this.aoPass.setScene(t)}get camera(){return this._camera}set camera(t){this._camera=t,this.opaquePass.setCamera(t),this.transmissionPass.setCamera(t),this.aoPass.setCamera(t),this.helperPass.setCamera(t)}updateRenderToScreen(){let t=!1;for(let e=this.effectComposer.passes.length-1;e>=0;e--){let i=this.effectComposer.passes[e];if(i.enabled===!0&&!t&&this._renderToScreen){i.renderToScreen=!0,t=!0;continue}i.renderToScreen=!1}}disableHelpers(){this.helperPass.enabled=!1,this.updateRenderToScreen()}enableHelpers(){this.helperPass.enabled=!0,this.updateRenderToScreen()}updateBlueNoiseTexture(t){this.blueNoiseTexture=new tT(t,128,128),this.blueNoiseTexture.wrapS=Qu,this.blueNoiseTexture.wrapT=Qu,this.blueNoiseTexture.minFilter=Zi,this.blueNoiseTexture.magFilter=Zi,this.blueNoiseTexture.needsUpdate=!0}setAmbientOcclusionParams(t,e,i,n,r,s,o,a){this.aoPass.enabled=t,this.aoPass.radius=e,this.aoPass.bias=i,this.aoPass.aoColor=n,this.aoPass.fogEnabled=r,this.aoPass.fogNear=s,this.aoPass.fogFar=o,this.aoPass.runHalfRes!==!a&&(this.aoPass.runHalfRes=!a)}setTransmissionPassEnabled(t){this.transmissionPass.enabled=t,this.opaquePass.hasTransmissionPass=t}_initPasses(){var t,e;if((t=this.uvEffectPass)==null||t.dispose(),(e=this.effectPass)==null||e.dispose(),this.effectComposer.removeAllPasses(),this.transmissionPass.updatePasses(this.renderer),this.effectComposer.addPass(this.aoPass),this.effectComposer.addPass(this.opaquePass),this.effectComposer.addPass(this.transmissionPass),this.effectComposer.addPass(this.taaPass),this.postprocessingState.enabled){let i=[this.effects.get("pixelation")].reduce(C7,[]);i.length>0&&(this.uvEffectPass=new zT(this.camera,...i),this.uvEffectPass.renderToScreen=!1,this.effectComposer.addPass(this.uvEffectPass));let n=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(C7,[]);n.length>0&&(this.effectPass=new zT(this.camera,...n),this.effectPass.renderToScreen=!1,this.effectComposer.addPass(this.effectPass))}this.effectComposer.addPass(this.overlayPass),this.effectComposer.addPass(this.sceneTransitionPass),this.effectComposer.addPass(this.helperPass)}_initCopyPass(){if(this._savePass)return;let t=new he;this.renderer.getDrawingBufferSize(t),this._rt=new Hi(t.x,t.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:Qu,wrapT:Qu}),this._rt.samples=0,this._savePass=new $O(this._rt,!1),this._savePass.renderToScreen=!1}setCopyPass(t){this._rt=t,this._savePass=new $O(this._rt,!1),this.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(t){if(this._renderToScreen===t)return;let e=this.effectComposer;!e||(t===!0?e.removePass(this._savePass):e.addPass(this._savePass),this._renderToScreen=t,this.updateRenderToScreen())}set sceneTransitionFromTexture(t){t!==this.sceneTransitionPass.texture&&(t!==null?this.sceneTransitionPass.enabled=!0:(this.sceneTransitionPass.enabled=!1,this.updateRenderToScreen()),this.sceneTransitionPass.texture=t)}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}updatePostprocessing(t){let{enabled:e,...i}=t,n=!1;e!==this.postprocessingState.enabled&&(n=!0);for(let r of Object.entries(i)){let s=r[1],o=this.effects.get(r[0]);if(o){o.enabled!==s.enabled&&(n=!0),o.enabled=s.enabled;for(let[a,l]of Object.entries(s))a==="blendFunction"?o.blendFunction=T5e(l):o[a]=l}}this.postprocessingState=t,n&&this._initPasses()}render(){this.effectComposer.render(this.clock.getDelta())}setScissor(t,e,i,n){t instanceof Kt?(this.effectComposer.inputBuffer.scissor.set(t.x,t.y,t.z,t.w),this.effectComposer.outputBuffer.scissor.set(t.x,t.y,t.z,t.w)):(this.effectComposer.inputBuffer.scissor.set(t,e,i,n),this.effectComposer.outputBuffer.scissor.set(t,e,i,n));let r=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(r),this.effectComposer.outputBuffer.scissor.multiplyScalar(r),this.renderer.setScissor(t,e,i,n)}setScissorTest(t){this.effectComposer.inputBuffer.scissorTest=t,this.effectComposer.outputBuffer.scissorTest=t,this.renderer.setScissorTest(t)}setViewport(t,e,i,n){t instanceof Kt?(this.effectComposer.inputBuffer.viewport.copy(t),this.effectComposer.outputBuffer.viewport.copy(t)):(this.effectComposer.inputBuffer.viewport.set(t,e,i,n),this.effectComposer.outputBuffer.viewport.set(t,e,i,n))}resize(t,e,i){if(this.effectComposer.setSize(t,e,i),this._rt){let n=this.renderer.getPixelRatio();this._rt.setSize(t*n,e*n)}}dispose(){var t,e;(t=this.uvEffectPass)==null||t.dispose(),(e=this.effectPass)==null||e.dispose(),this.effectComposer.dispose()}},P7=new br,P5e=class extends Bee{constructor(t){super(t),this._pixelRatio=this.getPixelRatio(),this.viewportWidth=1,this.viewportHeight=1,this.resolution=new he,this.pipeline=new C5e(this),this.dummyCamra=new js,this.sceneTransitionDuration=0,this.sceneTransitionTimeRemaining=-1,this.isXRCopyPassSet=!1,this.clear=(r=!0,s=!0,o=!0)=>{let a=this.getContext(),l=0;r&&(l|=a.COLOR_BUFFER_BIT),s&&(l|=a.DEPTH_BUFFER_BIT),o&&(l|=a.STENCIL_BUFFER_BIT),a.clear(l),a.clearBufferfv(a.COLOR,1,[0,0,0,1])},this.autoClear=!1;let e=this.setPixelRatio.bind(this),i=this.setSize.bind(this);this.shadowMap.enabled=!0,this.shadowMap.type=rk;let n=this.getContext();if(n&&"drawingBufferColorSpace"in n)try{n.drawingBufferColorSpace="display-p3"}catch(r){console.warn(r)}this.setPixelRatio=r=>{this._pixelRatio!==r&&(this._pixelRatio=r,e(r))},this.setSize=(r,s,o=!0)=>{var a,l;(this.viewportWidth!==r||this.viewportHeight!==s)&&(this.viewportWidth=r,this.viewportHeight=s,i(r,s,o),(a=this.normalRenderTarget)==null||a.setSize(r*this._pixelRatio,s*this._pixelRatio),this._resizeTransmission(r,s),(l=this.transmissionDepthTarget)==null||l.setSize(r*this._pixelRatio/2,s*this._pixelRatio/2),this.pipeline.resize(r,s,o))},this._superDispose=this.dispose,this.dispose=this._currentDispose}createAORenderTarget(){this.aoRenderTarget===void 0&&(this.aoRenderTarget=new Hi(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:ri,magFilter:ri,wrapS:Qn,wrapT:Qn,depthBuffer:!1}))}_resizeTransmission(t,e){var i,n;(i=this.transmissionRenderTarget)==null||i.setSize(t*this._pixelRatio/(this.hdTransmission?1:2),e*this._pixelRatio/(this.hdTransmission?1:2)),(n=this.aoRenderTarget)==null||n.setSize(t*this._pixelRatio/1,e*this._pixelRatio/1)}get hdTransmission(){return Rt.transmissionLod.value===1}set hdTransmission(t){Rt.transmissionLod.value=t===!0?1:2,this._resizeTransmission(this.viewportWidth,this.viewportHeight)}createTransmissionRenderTarget(){this.transmissionRenderTarget===void 0&&(this.transmissionRenderTarget=new Hi(this.viewportWidth*this._pixelRatio/(this.hdTransmission?1:2),this.viewportHeight*this._pixelRatio/(this.hdTransmission?1:2),{generateMipmaps:!0,minFilter:F0,magFilter:ri,wrapS:Qn,wrapT:Qn,depthBuffer:!1}),this.transmissionDepthTarget=new Hi(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{minFilter:Zi,magFilter:Zi,depthBuffer:!1}))}createNormalRenderTarget(){this.normalRenderTarget===void 0&&(this.normalRenderTarget=new Hi(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:Zi,magFilter:Zi,type:Xo,depthTexture:new k0(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio)}))}renderNormal(t,e,i){this.normalRenderTarget&&(this.setClearColor(0),i.layers.enable(8),i.layers.disable(0),i.layers.disable(3),e.traverseEntity(n=>{n.layers.isEnabled(8)&&(n.copyPreviousMatrix=!1)}),this.setRenderTarget(this.normalRenderTarget),this.clear(),i instanceof js?G3.uniforms.depthContrast.value=(i.far-i.near)/1e4:G3.uniforms.depthContrast.value=1,e.overrideMaterial=G3,this.render(e,i),this.setClearColor(e.bgColor,e.bgColor.a),this.setRenderTarget(null),e.overrideMaterial=t.wireframeState?rF:null,i.layers.enable(0),i.layers.enable(3),e.traverseEntity(n=>{n.layers.isEnabled(8)&&(n.copyPreviousMatrix=!0)}))}renderSplineSceneWithDummyCamera(t,e,i=1){this.dummyCamra.updateCameraState(e.dataPatched);let n=e.height,r=e.width,s=this.viewportWidth/this.viewportHeight;r<n?r=n*s:n=r/s,this.dummyCamra.setViewplaneSize(r,n);for(let o=0;o<i;o++)this.renderSplineScene(t,this.dummyCamra)}renderSplineScene(t,e,{sceneHelpers:i=void 0,sceneHelpersOnTop:n=void 0,overrideTransmission:r=void 0,overrideNormal:s=void 0}={}){let o=t instanceof wz?t.activePage:t,a=o.visible;o.visible=!0;let l=o.scene;this.xr.enabled&&(this.isXRCopyPassSet===!1&&this.getRenderTarget()!==null&&(this.pipeline.setCopyPass(this.getRenderTarget()),this.isXRCopyPassSet=!0),this.xr.updateCamera(e)),this.setClearColor(o.bgColor,o.bgColor.a),o.penumbraSizeArray.forEach((d,f)=>{Rt.penumbraSize.value[f]=d}),Rt.pixelRatioNode.value=this.getPixelRatio(),this.resolution.x!==0&&this.resolution.y!==0?Rt.resolution.value.set(this.resolution.x,this.resolution.y):Rt.resolution.value.set(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio),s!==void 0?(Rt.normalRenderTarget.value=s,Rt.normalRenderTargetDepth.value=P7):l.needsNormal()&&(this.createNormalRenderTarget(),Rt.normalRenderTarget.value=this.normalRenderTarget.texture,Rt.normalRenderTargetDepth.value=this.normalRenderTarget.depthTexture,this.renderNormal(l,o,e));let c=o.data.ao,h=c.occlusion;h&&(this.createAORenderTarget(),Rt.aoRenderTarget.value=this.aoRenderTarget.texture),Rt.aoEnabled.value=h,this.pipeline.setAmbientOcclusionParams(c.occlusion,c.radius,c.bias,o.aoColor,o.fog!==null,o.backupFog.near,o.backupFog.far,c.aoFullRes),this.pipeline.aoPass.setBlueNoiseTexture(this.pipeline.blueNoiseTexture);let u=!1;if(r!==void 0)Rt.transmissionRenderTarget.value=r,Rt.transmissionRenderTargetDepth.value=P7,this.pipeline.setTransmissionPassEnabled(!1);else{let d=l.needsTransmission();d&&(this.transmissionRenderTarget===void 0&&(u=!0),this.createTransmissionRenderTarget(),Rt.transmissionRenderTarget.value=this.transmissionRenderTarget.texture,Rt.aspectRatio.value=c4e(this.viewportWidth,this.viewportHeight),Rt.transmissionRenderTargetDepth.value=this.transmissionDepthTarget.texture),this.pipeline.setTransmissionPassEnabled(d)}e.layers.enable(3),e.layers.enable(8),this.pipeline.sceneHelpers=i,this.pipeline.sceneHelpersOnTop=n,this.pipeline.scene=o,this.pipeline.camera=e,u&&this.pipeline.transmissionPass.updatePasses(this),this.pipeline.postprocessingState!==o.postprocessing&&(this.pipeline.updatePostprocessing(o.postprocessing),!i&&!n&&this.pipeline.disableHelpers()),this.clearAlphaOverride!==void 0&&this.setClearAlpha(this.clearAlphaOverride),o.overrideMaterial=l.wireframeState?rF:null,this.pipeline.render(),Rt.frameIndex.value=(Rt.frameIndex.value+1)%16,e instanceof js&&e.copyHistory(),o.visible=a}renderFromSceneForSceneTransitionPass(t,e,i){this.pipeline.renderToScreen=!1,this.pipeline.renderTarget,this.renderSplineScene(t,e),this.pipeline.sceneTransitionFromTexture=this.pipeline.renderTarget.texture,this.sceneTransitionDuration=i,this.sceneTransitionTimeRemaining=i,this.pipeline.renderToScreen=!0;let n=this.pipeline.sceneTransitionPass.uniforms;n.uDPR.value=window.devicePixelRatio,n.uResolution.value.set(this.domElement.width,this.domElement.height).divideScalar(window.devicePixelRatio)}_currentDispose(){var t,e,i,n,r,s;this._superDispose(),this.pipeline.dispose(),(t=this.aoRenderTarget)==null||t.dispose(),(e=this.transmissionRenderTarget)==null||e.dispose(),(i=this.transmissionDepthTarget)==null||i.dispose(),(n=this.normalRenderTarget)==null||n.dispose(),(s=(r=this.normalRenderTarget)==null?void 0:r.depthTexture)==null||s.dispose()}},zne=class extends kw(XPe){constructor(t,e=15,i=10066329){super(t,e,i),this.object=t,this.added=!1,this.name=`DirectionalLightHelper: ${t.uuid}`}raycast(t,e){zw(this.object,zne.geometryHelper,t,e)}},Gne=class extends kw(WPe){constructor(t,e=15,i=6710886){super(t,e,i),this.object=t,this.name=`PointLightHelper: ${t.uuid}`}raycast(t,e){zw(this.object,Gne.geometryHelper,t,e)}},iF=class extends kw(jPe){constructor(t,e=6710886){super(t,e),this.object=t,this.name=`SpotLightHelper: ${t.uuid}`}raycast(t,e){zw(this.object,iF.geometryHelper,t,e)}update(){if(this.object!==void 0){let t=iF._vector,e=this.object.distance?this.object.distance:1e3,i=e*Math.tan(this.object.angle);this.cone.scale.set(i,i,e),t.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(t);let n=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let r=0,s=this.cone.material.length;r<s;r++)this.cone.material[r].color.set(n);else this.cone.material.color.set(n)}}},Hne=iF;Hne._vector=new L;function D5e(t,e){t.shadow.camera.right=e/2,t.shadow.camera.left=-e/2,t.shadow.camera.top=e/2,t.shadow.camera.bottom=-e/2,t.shadow.needsUpdate=!0}var Vne=class extends mz(TPe,zne){constructor(t,e,i){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.top=1250,n.bottom=-1250,n.right=1250,n.left=-1250,n.near=-1e4,n.far=2500;let r=new aT(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r}update(){this.shadow.camera.updateProjectionMatrix();for(let t in this.gizmos){let e=this.gizmos[t];e instanceof aT&&e.update()}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e);let i=t.depth!==void 0&&t.depth!==this.shadow.camera.far||t.size!==void 0&&t.size/2!==this.shadow.camera.right;t.size!==void 0&&D5e(this,t.size),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),t.penumbraSize!==void 0&&e.scene.markPenumbraSizeDirty(),i&&this.update()}},D7=new L,R7=new L,I7=new Zt,jne=class extends mz(SPe,Hne){constructor(t,e,i){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.fov=hi.RAD2DEG*2*this.angle,n.aspect=1,n.near=100,n.far=2500;let r=new aT(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let t in this.gizmos){let e=this.gizmos[t];e instanceof aT&&e.update()}}updateMatrixWorld(t){super.updateMatrixWorld(t),R7.setFromMatrixPosition(this.matrixWorld),I7.setFromRotationMatrix(this.matrixWorld),D7.copy(this.up).applyQuaternion(I7).negate().multiplyScalar(this.distance),this.target.position.copy(R7).add(D7),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e),t.distance!==void 0&&(this.distance=t.distance),t.decay!==void 0&&(this.decay=t.decay),t.angle!==void 0&&(this.angle=t.angle),t.penumbra!==void 0&&(this.penumbra=t.penumbra),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.penumbraSize!==void 0&&e.scene.markPenumbraSizeDirty(),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},Vd=class extends ez(Nd){constructor(t,e){super(),this.data=e,this.bgColor=new wo(1,1,1,1),this.fog=null,this.backupFog=new Oee(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new It,this.penumbraSizeArrayCache=null,this.super_Entity(t,e),this.personalCamera=new js(_y,{...K_.defaultData,...e.camera,name:"Personal Camera"}),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new wPe(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}updateVisible(){}setBackgroundColor(t){this.bgColor=t,this.fogUseBGColor===!0&&(this.backupFog.color=t)}updateAmbientLight(t,e){t.color!==void 0&&(this.ambientLight.color=Gs(t.color,e)),t.intensity!==void 0&&(this.ambientLight.intensity=t.intensity),t.enabled!==void 0&&(t.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(t){this.isActive=!0,t.fog=this.fog,this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity(t=>{if(t instanceof Sy)if(Array.isArray(t.material))for(let e of t.material)e.needsUpdate=!0;else t.material.needsUpdate=!0,t.material.dispose()})}updateShadow(t){t.softShadowQuality!==void 0&&this.isActive&&TGe(t.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(t,e){if(t.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){let i=this.scene;i.fog=this.fog}this.fogUseBGColor=t.useBackgroundColor,t.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=Gs(t.color,e),this.backupFog.near=t.near,this.backupFog.far=t.far}updateAo(t,e){t.aoColor!==void 0&&(this.aoColor=Gs(t.aoColor,e))}updateByOp(t,e,i,n){super.updateByOp(t,e,i,n);let r=e;Ga(t.path,["fog"])?this.updateFog(r.fog,i.shared):Ga(t.path,["ao"])?this.updateAo(r.ao,i.shared):Ga(t.path,["ambient"])?this.updateAmbientLight(r.ambient,i.shared):Ga(t.path,["shadow"])&&this.updateShadow(r.shadow)}updateState(t,e){this.updateState_Entity(t,e),t.backgroundColor!==void 0&&this.setBackgroundColor(Gs(t.backgroundColor,e.shared)),t.fog!==void 0&&this.updateFog(t.fog,e.shared),t.ambient!==void 0&&this.updateAmbientLight(t.ambient,e.shared),t.ao!==void 0&&this.updateAo(t.ao,e.shared),t.shadow!==void 0&&this.updateShadow(t.shadow)}raycast(t,e){super.raycast(t,e)}switchActiveCamera(t){t&&t.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=t,t.objectHelper.visible=!1)}get playCamera(){var t;return((t=this.scene)==null?void 0:t.find(this.data.publish.playCamera))??this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return this.penumbraSizeArrayCache===null&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let t=0,e=0;this.traverseEntity(i=>{if(!i.visible)return!0;i instanceof Vne&&i.visible&&t<3&&(this.penumbraSizeArrayCache[t]=i.data.penumbraSize,t+=1),i instanceof jne&&i.visible&&t<5-3&&(this.penumbraSizeArrayCache[3+e]=i.data.penumbraSize,e+=1)})}raycastWithClones(t){let e=[],i=n=>{for(let r of n.children){let s=r.cloner;xi.is(r)&&(r.visible||s!=null&&s.object.data.visible)&&((Ml(r)||KO(r)&&this.scene.enableHelpers&&r.objectHelper.visible)&&(t.intersectObject(r,!1,e),nF(r,t,e,!0)),i(r))}};return i(this),e}},R5e=class extends mz(MPe,Gne){constructor(t,e,i){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.fov=90,n.aspect=1,n.near=100,n.far=2500;let r=new L(-n.far+this.position.x,-n.far+this.position.y,-n.far+this.position.z),s=new L(n.far+this.position.x,n.far+this.position.y,n.far+this.position.z),o=new Zn(r,s),a=new lT(o,new It(16755200));a.visible=!1,this.gizmos.shadowmap=a,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let t in this.gizmos){let e=this.gizmos[t];if(e instanceof lT){let i=this.shadow.camera,n=new L(-i.far+this.position.x,-i.far+this.position.y,-i.far+this.position.z),r=new L(i.far+this.position.x,i.far+this.position.y,i.far+this.position.z);e.box.set(n,r),e.updateMatrixWorld(!0)}}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e),t.distance!==void 0&&(this.distance=t.distance),t.decay!==void 0&&(this.decay=t.decay),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},I5e=class extends bo{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(t,e){let i=this.geometry.getAttribute("position");i!==void 0?az(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,t,e):super.updateEntityBoxSize(t,e)}},yz=class extends bo{constructor(t,e,i){super(t,e,i),this._shapeId=null,this._context=i}updateState(t,e){super.updateState(t,e),this.updateShape()}updateShape(){var n;let t=this.data.geometry.extrusion.shape,e;if(t.type==="Custom"){let r=t.shapeId;if(r!==this._shapeId&&this.detachShape(),r){this._shapeId=r;let s=this._context.scene.find(r);s!=null&&s.data&&(s.attachedPaths.add(this),e=(n=s.geometry.userData)==null?void 0:n.shape),e||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let r;switch(t.type){case"Rectangle":r=Vie;break;case"Ellipse":r=sz;break;case"Polygon":r=Hie;break;case"Star":r=jie;break;default:throw new Error(`Unknown shape type: ${t.type}`)}e=r.create({parameters:t}).userData.shape}let i=this.geometry;e&&i.inputs&&(i.inputs.shapeData=e,i.build(),this.attachedSurfaceCloners.forEach(r=>r.update()))}detachShape(){var t;this._shapeId!==null&&((t=this._context.scene.find(this._shapeId))==null||t.attachedPaths.delete(this))}createGeometryDelayed(t){this.geometryCreateDeleyed=t.shared,this.updateShape(),this.refreshAttachedPaths(t)}updateTransformState(t){return super.updateTransformState(t)}updateGeometryInteractions(t,e){super.updateGeometryInteractions(t,e),this.updateShape()}updateEntityBoxSize(t,e){let i=this.geometry.getAttribute("position");i!==void 0?az(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,t,e):super.updateEntityBoxSize(t,e)}},n0=class extends Gw(Ev,y2){constructor(t,e,i){super(),e.type==="Instance"&&typeof t=="string"&&(e=this.transformAssignData(e,i)),this.super_Entity(t,e),this.objectHelper.update()}get isComponentRoot(){return this.data.type==="Component"&&typeof this.identity=="string"}get isInstanceRoot(){return this.data.type==="Instance"&&typeof this.identity=="string"}transformAssignData(t,e){let i=e.scene.data.objects.get(t.component);if(i){let n,r;for(let s of Wp.rootOverrideProps)t[s]===void 0?(n===void 0&&(n={...t}),n[s]=i.data[s]):(r===void 0&&(r={}),r[s]=t[s],n===void 0&&(n={...t}),n[s]=kd.apply(i.data[s],t[s]));return this.overrideData=r,n}else return{..._o.defaultData,...t}}updateByOp(t,e,i,n){let r;if(this.isInstanceRoot&&!n){if(e=this.transformAssignData(e,i),t.type===0&&t.path.length===0&&this.component)for(let s of Wp.rootOverrideProps)s in t.props&&t.props[s]===void 0&&(r===void 0&&(r={...t,props:{...t.props}}),r.props[s]=this.component.data[s]);else if(t.type===0&&t.path.length>0&&Wp.rootOverrideProps.includes(t.path[0])){let s=t.path[0];r===void 0&&(r={...t,path:[],props:{[s]:e[s]}})}}super.updateByOp(r??t,e,i,n)}updateState(t,e){this.updateState_Entity(t,e)}expandInstanceChildren(t){let e=this.data;if(this.component===void 0){let i=t.scene.find(e.component)??null,n=!1;if(i!==this.oldComponent){if(this.oldComponent){let r=0;for(let s of this.children)if(xi.is(s))t.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(s),xz(s),r+=1;else break;this.children.splice(0,r)}n=!0}if(i){let r={};Wne(t,[this.uuid],e.overrides,this,i,i,0,n,r);for(let s of this.children)if(xi.is(s)){let o=s.data;o.type==="Empty"&&o.animations&&s.traverseEntity(a=>{if(a instanceof bo&&a.isSkinnedMesh){let l=a.dataPatched;if(l.bones&&l.boneInverses){let c=l.bones.map(d=>t.scene.find(r[d])),h=l.boneInverses.map(d=>new $e().fromArray(d)),u=new fk(c,h);a.bind(u,a.bindMatrix)}}else a.matrixAutoUpdate=!0})}}this.oldComponent=this.component}}};function xz(t){if(t.component){let e=t.component.instances.indexOf(t);e>=0&&t.component.instances.splice(e,1);for(let i of t.children)xi.is(i)&&xz(i)}}function L7(t,e,i,n){return t.component===e&&Gk(t.identity,n)?t.overrideData===i?2:1:0}function Wne(t,e,i,n,r,s,o,a,l){if(o>50)return!1;if(n.component!==r){if(n.component){let h=n.component.instances.indexOf(n);h>=0&&n.component.instances.splice(h,1)}r.instances.push(n),n.component=r}r instanceof n0&&r.isInstanceRoot&&r.expandInstanceChildren(t);let c=0;for(let h of r.children)if(xi.is(h)){let u=[...e,...typeof h.identity=="string"?[h.identity]:h.identity],d=CT.resolve(i,u,1),f=null,p;if(!a){let m=n.children[c];if(f=xi.is(m)?m:null,f!==null){let v=L7(f,h,d,u);p=v>=1?f.stateSelection:void 0,v!==2&&(f=null)}if(f===null&&(f=t.scene.findInstance(u)??null,f!==null)){let v=L7(f,h,d,u);if(p=v>=1?f.stateSelection:void 0,v!==2)f=null;else{let g=f.parent.children.indexOf(f);f.parent.children.splice(g,1),n.children.splice(c,0,f),f.parent===n?g<=c&&console.error("not possible"):(f.parent=n,f.matrixWorldNeedsUpdate=!0,f.resetBBoxNeedsUpdate(),f.updateVisible(),t.pendingDeletes.delete(f))}}}if(f===null){let m=d?kd.apply(h.data,d):h.data;um.is(m.type)&&(m={...m,type:"Empty"}),f=yd.createEntity(u,m,t),f.overrideData=d,n.add(f),n.children.splice(n.children.length-1,1),n.children.splice(c,0,f),f.updateState(f.data,t),p&&f.changeSelectedState(p,t),t.scene.registerInstanceAndSetUuid(f)}if(f.isBone){let m=f.identity[f.identity.length-1];l[m]=f.uuid}c+=1,Wne(t,e,i,f,h,s,o+1,a,l)}if(!a){let h=c;for(;;){let u=n.children[c];if(xi.is(u))t.pendingDeletes.add(u);else break;c+=1}n.children.splice(h,c-h)}return!0}var L5e=class extends Gw(Fee,y2){constructor(t,e){super(),this.super_Entity(t,e),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(t,e){this.updateState_Entity(t,e)}};function B5e(t,e,i){let n;return e.geometry.type==="TextGeometry"?new Ine(t,e,i):(e.geometry.type==="SubdivGeometry"?n=new iw(t,e,i):e.geometry.type==="PathGeometry"?n=new yz(t,e,i):e.geometry.type==="VectorGeometry"?n=new I5e(t,e,i):e.geometry.type==="BooleanGeometry"?n=new K0(t,e,i):n=new bo(t,e,i),n)}function _z(t,e,i){return e.type==="Mesh"?B5e(t,e,i):e.type==="Empty"?new kT(t,e):e.type==="Bone"?new L5e(t,e):e.type==="Page"?new Vd(t,e):e.type==="PointLight"?new R5e(t,e,i):e.type==="SpotLight"?new jne(t,e,i):e.type==="DirectionalLight"?new Vne(t,e,i):e.type==="Component"||e.type==="Instance"?new n0(t,e,i):um.is(e.type)?new js(t,e):(console.error(e),new kT(t,e))}yd.createEntity=_z;function O5e(t,e,i){let n=_z(t.identity,e,i),r=t.children,s=t.attachedPaths,o=t.parent,a=t.component,l=t.instances,c=t.overrideData,h=t.uuid,u=t.stateSelection;t.dispose();for(let d of Object.keys(t))delete t[d];Object.setPrototypeOf(t,Object.getPrototypeOf(n));for(let d of Object.keys(n))t[d]=n[d];t.children=[...t.children,...r],t.attachedPaths=s,t.parent=o,t.component=a,t.instances=l,t.uuid=h,t.overrideData=c,t.updateState(t.data,i),u&&t.changeSelectedState(u,i),t.resetBBoxNeedsUpdate()}yd.changeEntityProptotype=O5e;yd.Cloner=Pl;function F5e(t,e,i,n){t.updateByOp(e,i,n,!1)}function B7(t,e){let i=!1,n=e.getLayersOfType("transmission"),r=e.getLayersOfType("outline");return r.length>0&&(t.layers.set(8),n.length>0&&t.layers.enable(3),i=!0,pz(t),fz(t)),n.length===0&&r.length===0&&t.layers.set(0),t instanceof Sy&&t.needsAO&&t.layers.enable(5),i}function O7(t,e){if(!e.layers)return!1;let i=!1,n=e.getLayersOfType("transmission").filter(s=>s.data.visible),r=e.getLayersOfType("outline").filter(s=>s.data.visible);return n.length>0&&(t.layers.set(3),r.length>0&&t.layers.enable(8),i=!0),n.length===0&&r.length===0&&t.layers.set(0),t.needsAO&&t.layers.enable(5),i}function N5e(t){let e=!1;return t.traverseEntity(i=>{if(i instanceof Sy)if(Array.isArray(i.material))for(let n=0;n<i.material.length;n++)B7(i,i.material[n])&&(e=!0);else B7(i,i.material)&&(e=!0)}),e}function U5e(t){let e=!1;return t.traverseEntity(i=>{if(i instanceof Sy)if(Array.isArray(i.material))for(let n=0;n<i.material.length;n++)O7(i,i.material[n])&&(e=!0);else O7(i,i.material)&&(e=!0)}),e}var k5e=new ete,z5e=new $e,G5e=new ay;function nF(t,e,i,n=!1){let r=t.cloner;if(r)for(let s of r.children){let o=z5e.copy(s.matrixWorld).invert(),a=G5e.copy(e.ray).applyMatrix4(o),l=t.matrixWorld;a.applyMatrix4(l);let c=k5e;c.set(a.origin,a.direction),c.near=e.near,c.far=e.far;let h=c.intersectObject(t,!1);h.length>0&&i.push({...h[0],object:n?s:t})}}var H5e=class{constructor(){this._constraints=new Map}setConstraint(t,e){e===null?this._constraints.delete(t):this._constraints.set(t,e)}removeDependencies(t){this._constraints.delete(t)}applyConstraints(t){let e=new Set;this._constraints.forEach((i,n)=>{let r=[n,i],s=i;for(;this._constraints.has(s);)s=this._constraints.get(s),e.has(s)||r.push(s);for(let o=r.length-2;o>=0;o--)if(!e.has(r[o])){let a=t.find(r[o]);a?a.applyPathSnapping(t):console.warn(`missing entity ${r[o]}`),e.add(r[o])}})}findDependency(t,e){let i=t;for(;this._constraints.has(i);)if(i=this._constraints.get(i),i===e)return!0;return!1}},rF=new ly;rF.wireframe=!0;var F7=new L,wz=class extends Nd{constructor(t,e){super(),this.data=t,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new H5e,this.errorPage=new Vd("fdasfa",{...Y0.defaultData,name:""}),this.needsRecomputeInstances=!1,this.init(t,e),this.matrixAutoUpdate=!1}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=U5e(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=N5e(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(t){let e=t.identity.join("-"),i=this.entityIdentityToEntity[e];i&&(t.uuid=i.uuid),this.entityIdentityToEntity[e]=t,this.entityByUuid[t.uuid]=t}markPenumbraSizeDirty(){for(let t of this.children)t instanceof Vd&&(t.penumbraSizeArrayCache=null)}findInstance(t){return this.entityIdentityToEntity[t.join("-")]}get bgColor(){return this.activePage.bgColor}get postprocessing(){return this.activePage.data.postprocessing}getWithSortKey(t){let e=this.find(t);if(e===void 0)return;let i=[],n=e;for(;n!==this;){let r=n;n=n.parent;let s=n.children.indexOf(r);i.splice(0,0,s)}return{entity:e,sortKey:i}}getAllSorted(t){let e=[];for(let i of t){let n=this.getWithSortKey(i.id);n!==void 0&&e.push(n)}return e.sort((i,n)=>gNe(i.sortKey,n.sortKey)),e.map(i=>i.entity)}nonExistOrDescendantOf(t,e){let i=this.find(t);if(i===void 0)return!0;for(;i;){if(i.uuid===e)return!0;i=i.parent}return!1}find(t){if(this.activePage&&this.activePage.personalCamera.parent){if(t==="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera")return this.activePage.personalCamera;if(t===_y)return this.activePage.personalCamera}if(t===""||t===void 0)return;let e=this.entityByUuid[t];return e===void 0?this.getObjectByProperty("uuid",t):e}debugEnsureEntity(t){let e=this.find(t);if(e){if(Array.isArray(e.identity)&&this.findInstance(e.identity)===void 0){console.error("not found instance");debugger}}else{console.error("not found");debugger}}addPendingExpandCloner(t){this.toExpandCloner.add(t)}addPendingUpdateCloner(t){this.toUpdateCloner.add(t)}markToExpandCloner(t){this.toExpandCloner.add(t),t.traverseEntityAncestors(e=>{this.toExpandCloner.add(e)})}doPendingExpandCloner(){this.toExpandCloner.forEach(t=>{t.expandCloner(this)}),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach(t=>{var e;(e=t.cloner)==null||e.update()}),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(t){this.pendingCommands.push(t)}applyPendingCommands(){this.pendingCommands.forEach(t=>t()),this.pendingCommands.length=0}updateTreeByOp(t,e){var i;if(t.path.length===0&&t.type===7){let n=t.parent===null?this:this.find(t.parent);if(n===void 0)throw new Error("unexpected");let r=this.createObject(t.id,t.data,t.children,n,t.localIndex,e);r.updateVisible(),r.resetBBoxNeedsUpdate(),Ml(r)&&Ju(r.parent)&&(r.invalidateUpstreamBooleanData(),r.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(n),this.markNeedsRecomputeInstancesForChildren(r),this.markToExpandCloner(r),this.markPenumbraSizeDirty()}else if(t.path.length===0&&t.type===8){let n=this.find(t.id);if(n===void 0)throw new Error("unexpected");this.markToExpandCloner(n),n.resetBBoxNeedsUpdate(),this.unregisterObject(n);let r=n.parent;this.markNeedsRecomputeInstancesForAncessors(r),this.markNeedsRecomputeInstancesForChildren(n),this.markPenumbraSizeDirty(),n.parent.remove(n),Ju(n.parent)&&(n.parent.invalidateUpstreamBooleanData(),n.parent.invalidateDownstreamBooleanData().recomputeBoolean()),Ml(n)&&(n.freeBooleanPointer(),r instanceof K0&&r.invalidateDownstreamBooleanData().recomputeBoolean()),n instanceof yz&&n.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(n),this.pathConstraints.removeDependencies(n.uuid)}else if(t.path.length===0&&t.type===9){let n=this.find(t.id);if(n===void 0)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(n);let r=n.parent;this.markNeedsRecomputeInstancesForAncessors(r),(i=n.cloner)==null||i.resetOnMove(),this.markToExpandCloner(n);let s=t.parent===null?this:this.find(t.parent);if(s===void 0)throw new Error("unexpected");s.add(n),this.markNeedsRecomputeInstancesForAncessors(s),this.markToExpandCloner(n),n.invalidateClonerTransform(n),n.updateVisible(),n.resetBBoxNeedsUpdate(),this.markPenumbraSizeDirty();let o=t.localIndex;s.children.splice(o,0,s.children.pop()),Ml(n)&&(n.invalidateUpstreamBooleanData(),Ju(n.parent)?n.parent.invalidateDownstreamBooleanData().recomputeBoolean():r instanceof K0&&r.invalidateDownstreamBooleanData().recomputeBoolean())}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}get playPage(){return this.find(this.data.publish.playPage)??this.errorPage}updatePage(t){this.activePage&&this.activePage.onDeactive(),this.activePage=this.errorPage;for(let e of this.children)e instanceof Vd&&(e.visible=e.uuid===t,e.visible&&(this.activePage=e,this.activePage.onActive(this)))}updateEntityByOp(t,e,i,n){if(e.type===0){if(("overrides"in e.props||"component"in e.props)&&this.markNeedsRecomputeInstances(),"visible"in e.props&&this.markPenumbraSizeDirty(),e.path.includes("overrides")&&"states"in e.props){let{rest:s}=e.props;e={...e,props:s},this.markNeedsRecomputeInstances()}e.path[0]==="pathSnapping"&&e.props.pathId!==void 0&&this.pathConstraints.setConstraint(t,e.props.pathId)}let r=this.find(t);if(r)try{F5e(r,e,i,{scene:this,shared:n}),r instanceof bo&&r.updateGeometryGroupsIfNeeded()}catch(s){console.error(s)}}get activeCamera(){return this.activePage.activeCamera}switchActiveCamera(t){this.activePage.switchActiveCamera(t)}init(t,e){this.createChildrenObjects(t.objects,this,e),this.updatePage(t.publish.playPage),this.activePage.switchToPlayCamera(),this.expandInstances(e,!0),this.traverseEntity(i=>{Ju(i)&&i.recomputeBoolean(),i instanceof js&&i.updateUp()}),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(t){t.traverseEntity(e=>{(e.data.type==="Component"||e.data.type==="Instance")&&this.markNeedsRecomputeInstances()})}markNeedsRecomputeInstancesForAncessors(t){xi.is(t)&&(t.data.type==="Component"&&this.markNeedsRecomputeInstances(),t.traverseAncestors(e=>{xi.is(e)&&e.data.type==="Component"&&this.markNeedsRecomputeInstances()}))}relativeizeInner(t,e,i,n,r,s,o){if(t){let a=n.find(t);a&&a!==n&&r.forInstancesRec(l=>{l.data=yT(l.data,c=>{let h=c.events.data(o.id),u=l.goUp(s);if(u){let d=[...Nte(u.identity),t].join("-"),f=this.entityIdentityToEntity[d];if(f){let p=f.uuid,m=Hc.zoom(h,e);m[i]=p}else console.warn("cannot find instance")}}).data})}}rewriteActions(t,e,i,n,r,s){t.forEach(o=>{o.data.type==="Transition"?this.relativeizeInner(o.data.object,[...e,o.id],"object",i,n,r,s):o.data.type==="Animation"&&this.relativeizeInner(o.data.object,[...e,o.id],"object",i,n,r,s)})}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity(t=>{if(t instanceof n0&&typeof t.identity=="string"&&t.data.type==="Component")return t.traverseEntity((e,i)=>{e.data.events.forEach(n=>{if(n.data.type==="GameControl"){let r=!1;if(e.forInstancesRec(s=>{s.data=yT(s.data,o=>{s.isInstanceRoot||(o.events.delete(n.id),r=!0)}).data}),r===!1)for(let s of RO.list)this.rewriteActions(n.data.gameActions[s],["gameActions",s],t,e,i,n)}else n.data.type==="Conditional"?(n.data.condition.type==="Distance"?(this.relativeizeInner(n.data.condition.fromObject,["condition"],"fromObject",t,e,i,n),this.relativeizeInner(n.data.condition.toObject,["condition"],"toObject",t,e,i,n)):n.data.condition.type==="State"?this.relativeizeInner(n.data.condition.object,["condition"],"object",t,e,i,n):n.data.condition.type==="Comparison"&&(n.data.condition.lOperand.type==="Property"&&this.relativeizeInner(n.data.condition.lOperand.value[0],["condition","lOperand","value"],0,t,e,i,n),n.data.condition.rOperand.type==="Property"&&this.relativeizeInner(n.data.condition.rOperand.value[0],["condition","rOperand","value"],0,t,e,i,n)),this.rewriteActions(n.data.inActions,["inActions"],t,e,i,n),this.rewriteActions(n.data.outActions,["outActions"],t,e,i,n)):"actions"in n.data&&this.rewriteActions(n.data.actions,["actions"],t,e,i,n)})}),!0})}expandInstances(t,e,i){let n=new Set;this.traverseEntity(r=>{if(r instanceof n0&&r.isInstanceRoot)return r.expandInstanceChildren({scene:this,shared:t,pendingDeletes:n}),e||r.resetBBoxNeedsUpdate(),i&&r.traverseEntity(s=>{i.addClip(s)}),!0});for(let r of n)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(r),xz(r)}recomputeInstances(t,e){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity(i=>{i instanceof n0&&i.isInstanceRoot&&(i.component=void 0)}),this.expandInstances(t,!1,e))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(t){t.traverseEntity(e=>{let i=typeof e.identity=="string"?e.identity:e.identity.join("-");this.entityIdentityToEntity[i]===e&&(delete this.entityByUuid[e.uuid],delete this.entityIdentityToEntity[i]),e.dispose()})}clearScene(){for(let t of this.children)xi.is(t)&&t.disposeRecursively();this.children.length=0}resetAfterClear(t,e){this.init(t,e)}raycast(t){return this.raycast1(t,!1)}raycast1(t,e){let i=[],n=r=>{for(let s of r.children){let o=s.cloner;if(xi.is(s)&&!s.raycastLock&&(s.visible||o!=null&&o.object.data.visible))if(e===!0&&s.isInstanceRoot){let a=[];if(t.intersectObject(s,!0,a),a.length){let l=a[0];l.object=s,l.point.applyMatrix4(l.object.matrixWorld);let c=s.matrixWorld.clone().invert();l.point.applyMatrix4(c),i.push(l)}}else(Ml(s)||KO(s)&&this.enableHelpers&&s.objectHelper.visible)&&(t.intersectObject(s,!1,i),nF(s,t,i)),n(s)}};return n(this),i}raycastWithClones(t){let e=[],i=n=>{for(let r of n.children){let s=r.cloner;xi.is(r)&&(r.visible||s!=null&&s.object.data.visible)&&((Ml(r)||KO(r)&&this.enableHelpers&&r.objectHelper.visible)&&(t.intersectObject(r,!1,e),nF(r,t,e,!0)),i(r))}};return i(this),e}forEachEntity(t){for(let e of this.children)xi.is(e)&&t(e)}traverseConcreteEntity(t){for(let e of this.children)xi.is(e)&&e.isConcreteEntity&&e.traverseEntity(t)}traverseEntity(t){for(let e of this.children)xi.is(e)&&e.traverseEntity(t)}traverseObject(t){for(let e of this.children)tw.is(e)&&e.traverseObject(t)}traverseVisibleEntity(t){for(let e of this.children)xi.is(e)&&e.visible&&e.traverseVisibleEntity(t)}dispose(){this.clearScene()}createChildrenObjects(t,e,i){let n=0;for(let r of t)this.createObject(r.id,r.data,r.children,e,n,i),n+=1}registerObjectCreatedInLegacy(t){this.entityByUuid[t.uuid]=t}unregisterObject(t){delete this.entityByUuid[t.uuid];for(let e of t.children)this.unregisterObject(e)}createObject(t,e,i,n,r,s){var l;let o={scene:this,shared:s},a=_z(t,e,o);return a&&(this.entityByUuid[t]=a,n.add(a),n.children.splice(r,0,n.children.pop()),i.length>0&&(a.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(i,a,s)),a.updateState(e,o),a instanceof bo&&a.updateGeometryGroupsIfNeeded(),a.updateVisible(),a.cloner&&this.toExpandCloner.add(a),(l=e.pathSnapping)!=null&&l.pathId&&this.pathConstraints.setConstraint(t,e.pathSnapping.pathId)),e.type==="Empty"&&e.animations&&a.traverseEntity(c=>{if(c instanceof bo&&c.isSkinnedMesh){let h=c.dataPatched;if(h.bones&&h.boneInverses){let u=h.bones.map(p=>this.find(p)),d=h.boneInverses.map(p=>new $e().fromArray(p)),f=new fk(u,d);c.bind(f,c.bindMatrix)}}else c.matrixAutoUpdate=!0}),a}getCenter(t){let e=[];for(let n=0,r=t.length;n<r;++n){let{id:s,recursive:o}=t[n],a=this.find(s),l=o?a.recursiveBBox:a.singleBBox;e.push(...l.vertices)}let i=new Zn;return i.setFromPoints(e),i.getCenter(F7),F7}copyMatrixWorld(t,e){if(t===null){e.identity();return}let i=this.find(t);i?e.copy(i.matrixWorld):e.identity()}copyParentMatrixWorld(t,e){var n;if(t===null){e.identity();return}let i=(n=this.find(t))==null?void 0:n.parent;i?e.copy(i.matrixWorld):e.identity()}traverseMaterial(t){this.traverseEntity(e=>{if(e instanceof Mo)if(Array.isArray(e.material))for(let i=0;i<e.material.length;i++)e.material[i]instanceof rf&&t(e.material[i]);else e.material instanceof rf&&t(e.material)})}updateCanvasSize(t,e,i=!1){this.activeCamera.setViewplaneSize(t,e,i)}},QM=(t,e)=>{let i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)},V5e=(t,e)=>{let i=e.x-t.x,n=e.y-t.y;return W5e(Math.atan2(n,i))},j5e=(t,e,i)=>{let n={x:0,y:0};return i=sF(i),n.x=t.x-e*Math.cos(i),n.y=t.y-e*Math.sin(i),n},sF=t=>t*(Math.PI/180),W5e=t=>t*(180/Math.PI),X5e=t=>isNaN(t.buttons)?t.pressure!==0:t.buttons!==0,W3=new Map,N7=t=>{W3.has(t)&&clearTimeout(W3.get(t)),W3.set(t,setTimeout(t,100))},GT=(t,e,i)=>{let n=e.split(/[ ,]+/g),r;for(let s=0;s<n.length;s+=1)r=n[s],t.addEventListener?t.addEventListener(r,i,!1):t.attachEvent&&t.attachEvent(r,i)},U7=(t,e,i)=>{let n=e.split(/[ ,]+/g),r;for(let s=0;s<n.length;s+=1)r=n[s],t.removeEventListener?t.removeEventListener(r,i):t.detachEvent&&t.detachEvent(r,i)},Xne=t=>(t.preventDefault(),t.type.match(/^touch/)?t.changedTouches:t),k7=()=>{if(typeof window>"u")return;let t=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,e=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:t,y:e}},oF=(t,e)=>{e.top||e.right||e.bottom||e.left?(t.style.top=e.top,t.style.right=e.right,t.style.bottom=e.bottom,t.style.left=e.left):(t.style.left=e.x+"px",t.style.top=e.y+"px")},bz=(t,e,i)=>{let n=qne(t);for(let r in n)if(n.hasOwnProperty(r))if(typeof e=="string")n[r]=e+" "+i;else{let s="";for(let o=0,a=e.length;o<a;o+=1)s+=e[o]+" "+i+", ";n[r]=s.slice(0,-2)}return n},q5e=(t,e)=>{let i=qne(t);for(let n in i)i.hasOwnProperty(n)&&(i[n]=e);return i},qne=t=>{let e={};return e[t]="",["webkit","Moz","o"].forEach(function(i){e[i+t.charAt(0).toUpperCase()+t.slice(1)]=""}),e},X3=(t,e)=>{for(let i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},Y5e=(t,e)=>{let i={};for(let n in t)t.hasOwnProperty(n)&&e.hasOwnProperty(n)?i[n]=e[n]:t.hasOwnProperty(n)&&(i[n]=t[n]);return i},aF=(t,e)=>{if(t.length)for(let i=0,n=t.length;i<n;i+=1)e(t[i]);else e(t)},Q5e=(t,e,i)=>({x:Math.min(Math.max(t.x,e.x-i),e.x+i),y:Math.min(Math.max(t.y,e.y-i),e.y+i)});typeof window<"u"&&(Yne="ontouchstart"in window,Qne=!!window.PointerEvent,Kne=!!window.MSPointerEvent);var Yne,Qne,Kne,Gx={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},Dv,nw={};Qne?Dv=Gx.pointer:Kne?Dv=Gx.MSPointer:Yne?(Dv=Gx.touch,nw=Gx.mouse):Dv=Gx.mouse;function Mm(){}Mm.prototype.on=function(t,e){var i=this,n=t.split(/[ ,]+/g),r;i._handlers_=i._handlers_||{};for(var s=0;s<n.length;s+=1)r=n[s],i._handlers_[r]=i._handlers_[r]||[],i._handlers_[r].push(e);return i};Mm.prototype.off=function(t,e){var i=this;return i._handlers_=i._handlers_||{},t===void 0?i._handlers_={}:e===void 0?i._handlers_[t]=null:i._handlers_[t]&&i._handlers_[t].indexOf(e)>=0&&i._handlers_[t].splice(i._handlers_[t].indexOf(e),1),i};Mm.prototype.trigger=function(t,e){var i=this,n=t.split(/[ ,]+/g),r;i._handlers_=i._handlers_||{};for(var s=0;s<n.length;s+=1)r=n[s],i._handlers_[r]&&i._handlers_[r].length&&i._handlers_[r].forEach(function(o){o.call(i,{type:r,target:i},e)})};Mm.prototype.config=function(t){var e=this;e.options=e.defaults||{},t&&(e.options=Y5e(e.options,t))};Mm.prototype.bindEvt=function(t,e){var i=this;return i._domHandlers_=i._domHandlers_||{},i._domHandlers_[e]=function(){typeof i["on"+e]=="function"?i["on"+e].apply(i,arguments):console.warn('[WARNING] : Missing "on'+e+'" handler.')},GT(t,Dv[e],i._domHandlers_[e]),nw[e]&&GT(t,nw[e],i._domHandlers_[e]),i};Mm.prototype.unbindEvt=function(t,e){var i=this;return i._domHandlers_=i._domHandlers_||{},U7(t,Dv[e],i._domHandlers_[e]),nw[e]&&U7(t,nw[e],i._domHandlers_[e]),delete i._domHandlers_[e],this};var Sz=Mm;function Tr(t,e){return this.identifier=e.identifier,this.position=e.position,this.frontPosition=e.frontPosition,this.collection=t,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(e),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=Tr.id,Tr.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}Tr.prototype=new Sz;Tr.constructor=Tr;Tr.id=0;Tr.prototype.buildEl=function(t){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};Tr.prototype.stylize=function(){if(this.options.dataOnly)return this;var t=this.options.fadeTime+"ms",e=q5e("borderRadius","50%"),i=bz("transition","opacity",t),n={};return n.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},n.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},n.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},X3(n.el,i),this.options.shape==="circle"&&X3(n.back,e),X3(n.front,e),this.applyStyles(n),this};Tr.prototype.applyStyles=function(t){for(var e in this.ui)if(this.ui.hasOwnProperty(e))for(var i in t[e])this.ui[e].style[i]=t[e][i];return this};Tr.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};Tr.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};Tr.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};Tr.prototype.show=function(t){var e=this;return e.options.dataOnly||(clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.addToDom(),e.restCallback(),setTimeout(function(){e.ui.el.style.opacity=1},0),e.showTimeout=setTimeout(function(){e.trigger("shown",e.instance),typeof t=="function"&&t.call(this)},e.options.fadeTime)),e};Tr.prototype.hide=function(t){var e=this;if(e.options.dataOnly)return e;if(e.ui.el.style.opacity=e.options.restOpacity,clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.removeTimeout=setTimeout(function(){var i=e.options.mode==="dynamic"?"none":"block";e.ui.el.style.display=i,typeof t=="function"&&t.call(e),e.trigger("hidden",e.instance)},e.options.fadeTime),e.options.restJoystick){let i=e.options.restJoystick,n={};n.x=i===!0||i.x!==!1?0:e.instance.frontPosition.x,n.y=i===!0||i.y!==!1?0:e.instance.frontPosition.y,e.setPosition(t,n)}return e};Tr.prototype.setPosition=function(t,e){var i=this;i.frontPosition={x:e.x,y:e.y};var n=i.options.fadeTime+"ms",r={};r.front=bz("transition",["top","left"],n);var s={front:{}};s.front={left:i.frontPosition.x+"px",top:i.frontPosition.y+"px"},i.applyStyles(r),i.applyStyles(s),i.restTimeout=setTimeout(function(){typeof t=="function"&&t.call(i),i.restCallback()},i.options.fadeTime)};Tr.prototype.restCallback=function(){var t=this,e={};e.front=bz("transition","none",""),t.applyStyles(e),t.trigger("rested",t.instance)};Tr.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};Tr.prototype.computeDirection=function(t){var e=t.angle.radian,i=Math.PI/4,n=Math.PI/2,r,s,o;if(e>i&&e<i*3&&!t.lockX?r="up":e>-i&&e<=i&&!t.lockY?r="left":e>-i*3&&e<=-i&&!t.lockX?r="down":t.lockY||(r="right"),t.lockY||(e>-n&&e<n?s="left":s="right"),t.lockX||(e>0?o="up":o="down"),t.force>this.options.threshold){var a={},l;for(l in this.direction)this.direction.hasOwnProperty(l)&&(a[l]=this.direction[l]);var c={};this.direction={x:s,y:o,angle:r},t.direction=this.direction;for(l in a)a[l]===this.direction[l]&&(c[l]=!0);if(c.x&&c.y&&c.angle)return t;(!c.x||!c.y)&&this.trigger("plain",t),c.x||this.trigger("plain:"+s,t),c.y||this.trigger("plain:"+o,t),c.angle||this.trigger("dir dir:"+r,t)}else this.resetDirection();return t};var K5e=Tr;function Jn(t,e){var i=this;i.nipples=[],i.idles=[],i.actives=[],i.ids=[],i.pressureIntervals={},i.manager=t,i.id=Jn.id,Jn.id+=1,i.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},i.config(e),(i.options.mode==="static"||i.options.mode==="semi")&&(i.options.multitouch=!1),i.options.multitouch||(i.options.maxNumberOfNipples=1);let n=getComputedStyle(i.options.zone.parentElement);return n&&n.display==="flex"&&(i.parentIsFlex=!0),i.updateBox(),i.prepareNipples(),i.bindings(),i.begin(),i.nipples}Jn.prototype=new Sz;Jn.constructor=Jn;Jn.id=0;Jn.prototype.prepareNipples=function(){var t=this,e=t.nipples;e.on=t.on.bind(t),e.off=t.off.bind(t),e.options=t.options,e.destroy=t.destroy.bind(t),e.ids=t.ids,e.id=t.id,e.processOnMove=t.processOnMove.bind(t),e.processOnEnd=t.processOnEnd.bind(t),e.get=function(i){if(i===void 0)return e[0];for(var n=0,r=e.length;n<r;n+=1)if(e[n].identifier===i)return e[n];return!1}};Jn.prototype.bindings=function(){var t=this;t.bindEvt(t.options.zone,"start"),t.options.zone.style.touchAction="none",t.options.zone.style.msTouchAction="none"};Jn.prototype.begin=function(){var t=this,e=t.options;if(e.mode==="static"){var i=t.createNipple(e.position,t.manager.getIdentifier());i.add(),t.idles.push(i)}};Jn.prototype.createNipple=function(t,e){var i=this,n=i.manager.scroll,r={},s=i.options,o={x:i.parentIsFlex?n.x:n.x+i.box.left,y:i.parentIsFlex?n.y:n.y+i.box.top};if(t.x&&t.y)r={x:t.x-o.x,y:t.y-o.y};else if(t.top||t.right||t.bottom||t.left){var a=document.createElement("DIV");a.style.display="hidden",a.style.top=t.top,a.style.right=t.right,a.style.bottom=t.bottom,a.style.left=t.left,a.style.position="absolute",s.zone.appendChild(a);var l=a.getBoundingClientRect();s.zone.removeChild(a),r=t,t={x:l.left+n.x,y:l.top+n.y}}var c=new K5e(i,{color:s.color,size:s.size,threshold:s.threshold,fadeTime:s.fadeTime,dataOnly:s.dataOnly,restJoystick:s.restJoystick,restOpacity:s.restOpacity,mode:s.mode,identifier:e,position:t,zone:s.zone,frontPosition:{x:0,y:0},shape:s.shape});return s.dataOnly||(oF(c.ui.el,r),oF(c.ui.front,c.frontPosition)),i.nipples.push(c),i.trigger("added "+c.identifier+":added",c),i.manager.trigger("added "+c.identifier+":added",c),i.bindNipple(c),c};Jn.prototype.updateBox=function(){var t=this;t.box=t.options.zone.getBoundingClientRect()};Jn.prototype.bindNipple=function(t){var e=this,i,n=function(r,s){i=r.type+" "+s.id+":"+r.type,e.trigger(i,s)};t.on("destroyed",e.onDestroyed.bind(e)),t.on("shown hidden rested dir plain",n),t.on("dir:up dir:right dir:down dir:left",n),t.on("plain:up plain:right plain:down plain:left",n)};Jn.prototype.pressureFn=function(t,e,i){var n=this,r=0;clearInterval(n.pressureIntervals[i]),n.pressureIntervals[i]=setInterval((function(){var s=t.force||t.pressure||t.webkitForce||0;s!==r&&(e.trigger("pressure",s),n.trigger("pressure "+e.identifier+":pressure",s),r=s)}).bind(n),100)};Jn.prototype.onstart=function(t){var e=this,i=e.options,n=t;t=Xne(t),e.updateBox();var r=function(s){e.actives.length<i.maxNumberOfNipples?e.processOnStart(s):n.type.match(/^touch/)&&(Object.keys(e.manager.ids).forEach(function(o){if(Object.values(n.touches).findIndex(function(l){return l.identifier===o})<0){var a=[t[0]];a.identifier=o,e.processOnEnd(a)}}),e.actives.length<i.maxNumberOfNipples&&e.processOnStart(s))};return aF(t,r),e.manager.bindDocument(),!1};Jn.prototype.processOnStart=function(t){var e=this,i=e.options,n,r=e.manager.getIdentifier(t),s=t.force||t.pressure||t.webkitForce||0,o={x:t.pageX,y:t.pageY},a=e.getOrCreate(r,o);a.identifier!==r&&e.manager.removeIdentifier(a.identifier),a.identifier=r;var l=function(h){h.trigger("start",h),e.trigger("start "+h.id+":start",h),h.show(),s>0&&e.pressureFn(t,h,h.identifier),e.processOnMove(t)};if((n=e.idles.indexOf(a))>=0&&e.idles.splice(n,1),e.actives.push(a),e.ids.push(a.identifier),i.mode!=="semi")l(a);else{var c=QM(o,a.position);if(c<=i.catchDistance)l(a);else{a.destroy(),e.processOnStart(t);return}}return a};Jn.prototype.getOrCreate=function(t,e){var i=this,n=i.options,r;return/(semi|static)/.test(n.mode)?(r=i.idles[0],r?(i.idles.splice(0,1),r):n.mode==="semi"?i.createNipple(e,t):(console.warn("Coudln't find the needed nipple."),!1)):(r=i.createNipple(e,t),r)};Jn.prototype.processOnMove=function(t){var e=this,i=e.options,n=e.manager.getIdentifier(t),r=e.nipples.get(n),s=e.manager.scroll;if(!X5e(t)){this.processOnEnd(t);return}if(!r){console.error("Found zombie joystick with ID "+n),e.manager.removeIdentifier(n);return}if(i.dynamicPage){var o=r.el.getBoundingClientRect();r.position={x:s.x+o.left,y:s.y+o.top}}r.identifier=n;var a=r.options.size/2,l={x:t.pageX,y:t.pageY};i.lockX&&(l.y=r.position.y),i.lockY&&(l.x=r.position.x);var c=QM(l,r.position),h=V5e(l,r.position),u=sF(h),d=c/a,f={distance:c,position:l},p,m;if(r.options.shape==="circle"?(p=Math.min(c,a),m=j5e(r.position,p,h)):(m=Q5e(l,r.position,a),p=QM(m,r.position)),i.follow){if(c>a){let x=l.x-m.x,b=l.y-m.y;r.position.x+=x,r.position.y+=b,r.el.style.top=r.position.y-(e.box.top+s.y)+"px",r.el.style.left=r.position.x-(e.box.left+s.x)+"px",c=QM(l,r.position)}}else l=m,c=p;var v=l.x-r.position.x,g=l.y-r.position.y;r.frontPosition={x:v,y:g},i.dataOnly||oF(r.ui.front,r.frontPosition);var y={identifier:r.identifier,position:l,force:d,pressure:t.force||t.pressure||t.webkitForce||0,distance:c,angle:{radian:u,degree:h},vector:{x:v/a,y:-g/a},raw:f,instance:r,lockX:i.lockX,lockY:i.lockY};y=r.computeDirection(y),y.angle={radian:sF(180-h),degree:180-h},r.trigger("move",y),e.trigger("move "+r.id+":move",y)};Jn.prototype.processOnEnd=function(t){var e=this,i=e.options,n=e.manager.getIdentifier(t),r=e.nipples.get(n),s=e.manager.removeIdentifier(r.identifier);!r||(i.dataOnly||r.hide(function(){i.mode==="dynamic"&&(r.trigger("removed",r),e.trigger("removed "+r.id+":removed",r),e.manager.trigger("removed "+r.id+":removed",r),r.destroy())}),clearInterval(e.pressureIntervals[r.identifier]),r.resetDirection(),r.trigger("end",r),e.trigger("end "+r.id+":end",r),e.ids.indexOf(r.identifier)>=0&&e.ids.splice(e.ids.indexOf(r.identifier),1),e.actives.indexOf(r)>=0&&e.actives.splice(e.actives.indexOf(r),1),/(semi|static)/.test(i.mode)?e.idles.push(r):e.nipples.indexOf(r)>=0&&e.nipples.splice(e.nipples.indexOf(r),1),e.manager.unbindDocument(),/(semi|static)/.test(i.mode)&&(e.manager.ids[s.id]=s.identifier))};Jn.prototype.onDestroyed=function(t,e){var i=this;i.nipples.indexOf(e)>=0&&i.nipples.splice(i.nipples.indexOf(e),1),i.actives.indexOf(e)>=0&&i.actives.splice(i.actives.indexOf(e),1),i.idles.indexOf(e)>=0&&i.idles.splice(i.idles.indexOf(e),1),i.ids.indexOf(e.identifier)>=0&&i.ids.splice(i.ids.indexOf(e.identifier),1),i.manager.removeIdentifier(e.identifier),i.manager.unbindDocument()};Jn.prototype.destroy=function(){var t=this;t.unbindEvt(t.options.zone,"start"),t.nipples.forEach(function(i){i.destroy()});for(var e in t.pressureIntervals)t.pressureIntervals.hasOwnProperty(e)&&clearInterval(t.pressureIntervals[e]);t.trigger("destroyed",t.nipples),t.manager.unbindDocument(),t.off()};var J5e=Jn;function jr(t){var e=this;e.ids={},e.index=0,e.collections=[],e.scroll=k7(),e.config(t),e.prepareCollections();var i=function(){var r;e.collections.forEach(function(s){s.forEach(function(o){r=o.el.getBoundingClientRect(),o.position={x:e.scroll.x+r.left,y:e.scroll.y+r.top}})})};if(typeof window>"u")return e.collections;GT(window,"resize",function(){N7(i)});var n=function(){e.scroll=k7()};return GT(window,"scroll",function(){N7(n)}),e.collections}jr.prototype=new Sz;jr.constructor=jr;jr.prototype.prepareCollections=function(){var t=this;t.collections.create=t.create.bind(t),t.collections.on=t.on.bind(t),t.collections.off=t.off.bind(t),t.collections.destroy=t.destroy.bind(t),t.collections.get=function(e){var i;return t.collections.every(function(n){return i=n.get(e),!i}),i}};jr.prototype.create=function(t){return this.createCollection(t)};jr.prototype.createCollection=function(t){var e=this,i=new J5e(e,t);return e.bindCollection(i),e.collections.push(i),i};jr.prototype.bindCollection=function(t){var e=this,i,n=function(r,s){i=r.type+" "+s.id+":"+r.type,e.trigger(i,s)};t.on("destroyed",e.onDestroyed.bind(e)),t.on("shown hidden rested dir plain",n),t.on("dir:up dir:right dir:down dir:left",n),t.on("plain:up plain:right plain:down plain:left",n)};jr.prototype.bindDocument=function(){var t=this;t.binded||(t.bindEvt(document,"move").bindEvt(document,"end"),t.binded=!0)};jr.prototype.unbindDocument=function(t){var e=this;(!Object.keys(e.ids).length||t===!0)&&(e.unbindEvt(document,"move").unbindEvt(document,"end"),e.binded=!1)};jr.prototype.getIdentifier=function(t){var e;return t?(e=t.identifier===void 0?t.pointerId:t.identifier,e===void 0&&(e=this.latest||0)):e=this.index,this.ids[e]===void 0&&(this.ids[e]=this.index,this.index+=1),this.latest=e,this.ids[e]};jr.prototype.removeIdentifier=function(t){var e={};for(var i in this.ids)if(this.ids[i]===t){e.id=i,e.identifier=this.ids[i],delete this.ids[i];break}return e};jr.prototype.onmove=function(t){var e=this;return e.onAny("move",t),!1};jr.prototype.onend=function(t){var e=this;return e.onAny("end",t),!1};jr.prototype.oncancel=function(t){var e=this;return e.onAny("end",t),!1};jr.prototype.onAny=function(t,e){var i=this,n,r="processOn"+t.charAt(0).toUpperCase()+t.slice(1);e=Xne(e);var s=function(a,l,c){c.ids.indexOf(l)>=0&&(c[r](a),a._found_=!0)},o=function(a){n=i.getIdentifier(a),aF(i.collections,s.bind(null,a,n)),a._found_||i.removeIdentifier(n)};return aF(e,o),!1};jr.prototype.destroy=function(){var t=this;t.unbindDocument(!0),t.ids={},t.index=0,t.collections.forEach(function(e){e.destroy()}),t.off()};jr.prototype.onDestroyed=function(t,e){var i=this;if(i.collections.indexOf(e)<0)return!1;i.collections.splice(i.collections.indexOf(e),1)};var Z5e=jr,z7=new Z5e,$5e={create:function(t){return z7.create(t)},factory:z7},Jne=new Map,W1=new Map,Tp=class{constructor(t,e,i,n){this.data=e;let{audio:r,volume:s,delay:o,loop:a}=e;if(!r)throw new Error("Missing property");let l=typeof r=="string"?n.getAudio(r).src:r.data;this.audioPlayer=new f1({src:l,volume:s,delay:o,loop:a}),W1.has(i.uuid)?W1.get(i.uuid).push(this):W1.set(i.uuid,[this]),Jne.set(t,this)}playByToggle(){this.data.toggle==="stop"?this.audioPlayer.status==="playing"?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):this.data.toggle==="pause"?this.audioPlayer.status==="playing"?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},lF=class{constructor(t){this.data=t}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(t){let e=Jne.get(t);!e||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.audioPlayer[this.data.interaction](),this.disposeDelay()},this.data.delay)):e.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(t){let e=W1.get(t);!(e!=null&&e.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(i=>i.audioPlayer[this.data.interaction]()),this.disposeDelay()},this.data.delay)):e.forEach(i=>i.audioPlayer[this.data.interaction]()))}pauseAllAudios(){let t=[...W1.values()];!t.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(e=>{e.forEach(i=>{i.audioPlayer[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):t.forEach(e=>{e.forEach(i=>{i.audioPlayer[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},X1=class{constructor(t,e,i,n){if(this.data=e,e.interaction==="play")this.interaction=new Tp(t,e,i,n);else if(e.interaction==="pause"||e.interaction==="stop")this.interaction=new lF(e);else throw new Error("Missing property")}dispatchBasic(){this.interaction instanceof Tp?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){this.interaction instanceof Tp?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(t){this.interaction instanceof Tp&&(t==="start"?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}},eVe="text/plain",tVe="us-ascii",G7=(t,e)=>e.some(i=>i instanceof RegExp?i.test(t):i===t),iVe=(t,{stripHash:e})=>{let i=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(t);if(!i)throw new Error(`Invalid URL: ${t}`);let{type:n,data:r,hash:s}=i.groups,o=n.split(";");s=e?"":s;let a=!1;o[o.length-1]==="base64"&&(o.pop(),a=!0);let l=(o.shift()||"").toLowerCase(),c=[...o.map(h=>{let[u,d=""]=h.split("=").map(f=>f.trim());return u==="charset"&&(d=d.toLowerCase(),d===tVe)?"":`${u}${d?`=${d}`:""}`}).filter(Boolean)];return a&&c.push("base64"),(c.length>0||l&&l!==eVe)&&c.unshift(l),`data:${c.join(";")},${a?r.trim():r}${s?`#${s}`:""}`};function nVe(t,e){if(e={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...e},t=t.trim(),/^data:/i.test(t))return iVe(t,e);if(/^view-source:/i.test(t))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let i=t.startsWith("//");!i&&/^\.*\//.test(t)||(t=t.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,e.defaultProtocol));let n=new URL(t);if(e.forceHttp&&e.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(e.forceHttp&&n.protocol==="https:"&&(n.protocol="http:"),e.forceHttps&&n.protocol==="http:"&&(n.protocol="https:"),e.stripAuthentication&&(n.username="",n.password=""),e.stripHash?n.hash="":e.stripTextFragment&&(n.hash=n.hash.replace(/#?:~:text.*?$/i,"")),n.pathname){let s=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,o=0,a="";for(;;){let c=s.exec(n.pathname);if(!c)break;let h=c[0],u=c.index,d=n.pathname.slice(o,u);a+=d.replace(/\/{2,}/g,"/"),a+=h,o=u+h.length}let l=n.pathname.slice(o,n.pathname.length);a+=l.replace(/\/{2,}/g,"/"),n.pathname=a}if(n.pathname)try{n.pathname=decodeURI(n.pathname)}catch{}if(e.removeDirectoryIndex===!0&&(e.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(e.removeDirectoryIndex)&&e.removeDirectoryIndex.length>0){let s=n.pathname.split("/"),o=s[s.length-1];G7(o,e.removeDirectoryIndex)&&(s=s.slice(0,-1),n.pathname=s.slice(1).join("/")+"/")}if(n.hostname&&(n.hostname=n.hostname.replace(/\.$/,""),e.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(n.hostname)&&(n.hostname=n.hostname.replace(/^www\./,""))),Array.isArray(e.removeQueryParameters))for(let s of[...n.searchParams.keys()])G7(s,e.removeQueryParameters)&&n.searchParams.delete(s);if(e.removeQueryParameters===!0&&(n.search=""),e.sortQueryParameters){n.searchParams.sort();try{n.search=decodeURIComponent(n.search)}catch{}}e.removeTrailingSlash&&(n.pathname=n.pathname.replace(/\/$/,""));let r=t;return t=n.toString(),!e.removeSingleSlash&&n.pathname==="/"&&!r.endsWith("/")&&n.hash===""&&(t=t.replace(/\/$/,"")),(e.removeTrailingSlash||n.pathname==="/")&&n.hash===""&&e.removeSingleSlash&&(t=t.replace(/\/$/,"")),i&&!e.normalizeProtocol&&(t=t.replace(/^http:\/\//,"//")),e.stripProtocol&&(t=t.replace(/^(?:https?:)?\/\//,"")),t}var rVe=class{constructor({url:t,context:e},i){if(this.eventManager=i,!t)throw new Error("Missing property");this.url=t.startsWith("mailto:")?t:nVe(t,{removeTrailingSlash:!1,removeSingleSlash:!1}),this.context=e??"tab"}dispatch(){var t;Fte?window.location.assign(this.url):(this.context==="tab"?window.open(this.url,"_blank"):this.context==="window"?window.open(this.url,"_blank",`width=${window.innerWidth}, height=${window.innerHeight}`):window.open(this.url,"_parent"),(t=this.eventManager.controlsManager.orbitControls)==null||t.onPointerUp(Ot[0]),vNe())}},Zne=class{constructor(t,e,i){this.data=t,this.page=e,this.eventManager=i,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=n=>{var a,l;this.timeoutIdQueue.shift();let r=this.page.scene.find(n);if(r===void 0)return;let s=this.controlsManager.sharedGameControlGlobals.rapierWorld,o=s?(a=r.dataPatched.physics)==null?void 0:a.fusedBody:!0;if(r.cloner){for(let c of r.cloner.children)o?(c.playModeVisible=!1,c.rigidBody&&((l=r.dataPatched.physics)==null?void 0:l.rigidBody)==="positioned"&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(c.rigidBody.collider(0).handle),s.removeRigidBody(c.rigidBody),c.rigidBody=void 0),c.bvhGeometry&&(c.bvhGeometry=void 0)):this.clone===void 0||this.clone===c?(c.playModeVisible=!1,c.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(c.rigidBody.collider(0).handle),s.removeRigidBody(c.rigidBody),c.rigidBody=void 0)):c.playModeVisible===void 0&&(c.playModeVisible=!0);(o||this.clone===void 0||this.clone===!1)&&(r.visible=!1,r.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(r.rigidBody.collider(0).handle),s.removeRigidBody(r.rigidBody),r.rigidBody=void 0),r.bvhGeometry&&(r.bvhGeometry=void 0))}else r.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(r.rigidBody.collider(0).handle),s.removeRigidBody(r.rigidBody),r.rigidBody=void 0),r.bvhGeometry&&(r.bvhGeometry=void 0),r.visible=!1;s===void 0?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(c=>c.bvhGeometry!==void 0):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(c=>c.rigidBody!==void 0),this.eventManager.requestRender()},this.objects=[...t.objects],this.controlsManager=i.controlsManager}dispatch(t){this.clone=t,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()}dispatchFromStart(){this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))}dispose(){this.timeoutIdQueue.forEach(t=>window.clearTimeout(t))}},sVe=class{constructor(t,e,i){this.page=t,this.eventManager=i,this.sharedAssets=e}dispatch(){var t;Lz(this.page,this.sharedAssets,!0),this.eventManager.reset(),(t=this.eventManager.controlsManager.gameControl)==null||t.reset(!0),this.page.switchToPlayCamera(),this.eventManager.controlsManager.requestRender()}},$ne={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},Az={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},oVe=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],HT={CSS:{},springs:{}};function Dl(t,e,i){return Math.min(Math.max(t,e),i)}function q1(t,e){return t.indexOf(e)>-1}function q3(t,e){return t.apply(null,e)}var Nt={arr:function(t){return Array.isArray(t)},obj:function(t){return q1(Object.prototype.toString.call(t),"Object")},pth:function(t){return Nt.obj(t)&&t.hasOwnProperty("totalLength")},svg:function(t){return t instanceof SVGElement},inp:function(t){return t instanceof HTMLInputElement},dom:function(t){return!("isNode"in t)&&(t.nodeType||Nt.svg(t))},str:function(t){return typeof t=="string"},fnc:function(t){return typeof t=="function"},und:function(t){return typeof t>"u"},hex:function(t){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)},rgb:function(t){return/^rgb/.test(t)},hsl:function(t){return/^hsl/.test(t)},col:function(t){return Nt.hex(t)||Nt.rgb(t)||Nt.hsl(t)},key:function(t){return!$ne.hasOwnProperty(t)&&!Az.hasOwnProperty(t)&&t!=="targets"&&t!=="keyframes"}};function ere(t){var e=/\(([^)]+)\)/.exec(t);return e?e[1].split(",").map(function(i){return parseFloat(i)}):[]}function tre(t,e){var i=ere(t),n=Dl(Nt.und(i[0])?1:i[0],.1,100),r=Dl(Nt.und(i[1])?100:i[1],.1,100),s=Dl(Nt.und(i[2])?10:i[2],.1,100),o=Dl(Nt.und(i[3])?0:i[3],.1,100),a=Math.sqrt(r/n),l=s/(2*Math.sqrt(r*n)),c=l<1?a*Math.sqrt(1-l*l):0,h=1,u=l<1?(l*a+-o)/c:-o+a;function d(p){var m=e?e*p/1e3:p;return l<1?m=Math.exp(-m*l*a)*(h*Math.cos(c*m)+u*Math.sin(c*m)):m=(h+u*m)*Math.exp(-m*a),p===0||p===1?p:1-m}function f(){var p=HT.springs[t];if(p)return p;for(var m=1/6,v=0,g=0;;)if(v+=m,d(v)===1){if(g++,g>=16)break}else g=0;var y=v*m*1e3;return HT.springs[t]=y,y}return e?d:f}function aVe(t){return t===void 0&&(t=10),function(e){return Math.ceil(Dl(e,1e-6,1)*t)*(1/t)}}var lVe=function(){var t=11,e=1/(t-1);function i(h,u){return 1-3*u+3*h}function n(h,u){return 3*u-6*h}function r(h){return 3*h}function s(h,u,d){return((i(u,d)*h+n(u,d))*h+r(u))*h}function o(h,u,d){return 3*i(u,d)*h*h+2*n(u,d)*h+r(u)}function a(h,u,d,f,p){var m,v,g=0;do v=u+(d-u)/2,m=s(v,f,p)-h,m>0?d=v:u=v;while(Math.abs(m)>1e-7&&++g<10);return v}function l(h,u,d,f){for(var p=0;p<4;++p){var m=o(u,d,f);if(m===0)return u;var v=s(u,d,f)-h;u-=v/m}return u}function c(h,u,d,f){if(!(0<=h&&h<=1&&0<=d&&d<=1))return;var p=new Float32Array(t);if(h!==u||d!==f)for(var m=0;m<t;++m)p[m]=s(m*e,h,d);function v(g){for(var y=0,x=1,b=t-1;x!==b&&p[x]<=g;++x)y+=e;--x;var S=(g-p[x])/(p[x+1]-p[x]),A=y+S*e,E=o(A,h,d);return E>=.001?l(g,A,h,d):E===0?A:a(g,y,y+e,h,d)}return function(g){return h===u&&d===f||g===0||g===1?g:s(v(g),u,f)}}return c}(),ire=function(){var t={linear:function(){return function(n){return n}}},e={Sine:function(){return function(n){return 1-Math.cos(n*Math.PI/2)}},Circ:function(){return function(n){return 1-Math.sqrt(1-n*n)}},Back:function(){return function(n){return n*n*(3*n-2)}},Bounce:function(){return function(n){for(var r,s=4;n<((r=Math.pow(2,--s))-1)/11;);return 1/Math.pow(4,3-s)-7.5625*Math.pow((r*3-2)/22-n,2)}},Elastic:function(n,r){n===void 0&&(n=1),r===void 0&&(r=.5);var s=Dl(n,1,10),o=Dl(r,.1,2);return function(a){return a===0||a===1?a:-s*Math.pow(2,10*(a-1))*Math.sin((a-1-o/(Math.PI*2)*Math.asin(1/s))*(Math.PI*2)/o)}}},i=["Quad","Cubic","Quart","Quint","Expo"];return i.forEach(function(n,r){e[n]=function(){return function(s){return Math.pow(s,r+2)}}}),Object.keys(e).forEach(function(n){var r=e[n];t["easeIn"+n]=r,t["easeOut"+n]=function(s,o){return function(a){return 1-r(s,o)(1-a)}},t["easeInOut"+n]=function(s,o){return function(a){return a<.5?r(s,o)(a*2)/2:1-r(s,o)(a*-2+2)/2}}}),t}();function Mz(t,e){if(Nt.fnc(t))return t;var i=t.split("(")[0],n=ire[i],r=ere(t);switch(i){case"spring":return tre(t,e);case"cubicBezier":return q3(lVe,r);case"steps":return q3(aVe,r);default:return q3(n,r)}}function nre(t){try{var e=document.querySelectorAll(t);return e}catch{return}}function _2(t,e){for(var i=t.length,n=arguments.length>=2?arguments[1]:void 0,r=[],s=0;s<i;s++)if(s in t){var o=t[s];e.call(n,o,s,t)&&r.push(o)}return r}function w2(t){return t.reduce(function(e,i){return e.concat(Nt.arr(i)?w2(i):i)},[])}function H7(t){return Nt.arr(t)?t:(Nt.str(t)&&(t=nre(t)||t),t instanceof NodeList||t instanceof HTMLCollection?[].slice.call(t):[t])}function Ez(t,e){return t.some(function(i){return i===e})}function Tz(t){var e={};for(var i in t)e[i]=t[i];return e}function cF(t,e){var i=Tz(t);for(var n in t)i[n]=e.hasOwnProperty(n)?e[n]:t[n];return i}function b2(t,e){var i=Tz(t);for(var n in e)i[n]=Nt.und(t[n])?e[n]:t[n];return i}function cVe(t){var e=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(t);return e?"rgba("+e[1]+",1)":t}function uVe(t){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,i=t.replace(e,function(a,l,c,h){return l+l+c+c+h+h}),n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(i),r=parseInt(n[1],16),s=parseInt(n[2],16),o=parseInt(n[3],16);return"rgba("+r+","+s+","+o+",1)"}function hVe(t){var e=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(t),i=parseInt(e[1],10)/360,n=parseInt(e[2],10)/100,r=parseInt(e[3],10)/100,s=e[4]||1;function o(d,f,p){return p<0&&(p+=1),p>1&&(p-=1),p<1/6?d+(f-d)*6*p:p<1/2?f:p<2/3?d+(f-d)*(2/3-p)*6:d}var a,l,c;if(n==0)a=l=c=r;else{var h=r<.5?r*(1+n):r+n-r*n,u=2*r-h;a=o(u,h,i+1/3),l=o(u,h,i),c=o(u,h,i-1/3)}return"rgba("+a*255+","+l*255+","+c*255+","+s+")"}function dVe(t){if(Nt.rgb(t))return cVe(t);if(Nt.hex(t))return uVe(t);if(Nt.hsl(t))return hVe(t)}function rh(t){var e=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(t);if(e)return e[1]}function fVe(t){if(q1(t,"translate")||t==="perspective")return"px";if(q1(t,"rotate")||q1(t,"skew"))return"deg"}function uF(t,e){return Nt.fnc(t)?t(e.target,e.id,e.total):t}function Bc(t,e){return t.getAttribute(e)}function Cz(t,e,i){var n=rh(e);if(Ez([i,"deg","rad","turn"],n))return e;var r=HT.CSS[e+i];if(!Nt.und(r))return r;var s=100,o=document.createElement(t.tagName),a=t.parentNode&&t.parentNode!==document?t.parentNode:document.body;a.appendChild(o),o.style.position="absolute",o.style.width=s+i;var l=s/o.offsetWidth;a.removeChild(o);var c=l*parseFloat(e);return HT.CSS[e+i]=c,c}function rre(t,e,i){if(e in t.style){var n=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=t.style[e]||getComputedStyle(t).getPropertyValue(n)||"0";return i?Cz(t,r,i):r}}function Pz(t,e){if(Nt.dom(t)&&!Nt.inp(t)&&(Bc(t,e)||Nt.svg(t)&&t[e]))return"attribute";if(Nt.dom(t)&&Ez(oVe,e))return"transform";if(Nt.dom(t)&&e!=="transform"&&rre(t,e))return"css";if(t[e]!=null)return"object"}function sre(t){if(Nt.dom(t)){for(var e=t.style.transform||"",i=/(\w+)\(([^)]*)\)/g,n=new Map,r;r=i.exec(e);)n.set(r[1],r[2]);return n}}function pVe(t,e,i,n){var r=q1(e,"scale")?1:0+fVe(e),s=sre(t).get(e)||r;return i&&(i.transforms.list.set(e,s),i.transforms.last=e),n?Cz(t,s,n):s}function Dz(t,e,i,n){switch(Pz(t,e)){case"transform":return pVe(t,e,n,i);case"css":return rre(t,e,i);case"attribute":return Bc(t,e);default:return t[e]||0}}function Rz(t,e){var i=/^(\*=|\+=|-=)/.exec(t);if(!i)return t;var n=rh(t)||0,r=parseFloat(e),s=parseFloat(t.replace(i[0],""));switch(i[0][0]){case"+":return r+s+n;case"-":return r-s+n;case"*":return r*s+n}}function ore(t,e){if(Nt.col(t))return dVe(t);if(/\s/g.test(t))return t;var i=rh(t),n=i?t.substr(0,t.length-i.length):t;return e?n+e:n}function Iz(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function mVe(t){return Math.PI*2*Bc(t,"r")}function gVe(t){return Bc(t,"width")*2+Bc(t,"height")*2}function vVe(t){return Iz({x:Bc(t,"x1"),y:Bc(t,"y1")},{x:Bc(t,"x2"),y:Bc(t,"y2")})}function are(t){for(var e=t.points,i=0,n,r=0;r<e.numberOfItems;r++){var s=e.getItem(r);r>0&&(i+=Iz(n,s)),n=s}return i}function yVe(t){var e=t.points;return are(t)+Iz(e.getItem(e.numberOfItems-1),e.getItem(0))}function lre(t){if(t.getTotalLength)return t.getTotalLength();switch(t.tagName.toLowerCase()){case"circle":return mVe(t);case"rect":return gVe(t);case"line":return vVe(t);case"polyline":return are(t);case"polygon":return yVe(t)}}function xVe(t){var e=lre(t);return t.setAttribute("stroke-dasharray",e),e}function _Ve(t){for(var e=t.parentNode;Nt.svg(e)&&Nt.svg(e.parentNode);)e=e.parentNode;return e}function cre(t,e){var i=e||{},n=i.el||_Ve(t),r=n.getBoundingClientRect(),s=Bc(n,"viewBox"),o=r.width,a=r.height,l=i.viewBox||(s?s.split(" "):[0,0,o,a]);return{el:n,viewBox:l,x:l[0]/1,y:l[1]/1,w:o/l[2],h:a/l[3]}}function wVe(t,e){var i=Nt.str(t)?nre(t)[0]:t,n=e||100;return function(r){return{property:r,el:i,svg:cre(i),totalLength:lre(i)*(n/100)}}}function bVe(t,e){function i(a){a===void 0&&(a=0);var l=e+a>=1?e+a:0;return t.el.getPointAtLength(l)}var n=cre(t.el,t.svg),r=i(),s=i(-1),o=i(1);switch(t.property){case"x":return(r.x-n.x)*n.w;case"y":return(r.y-n.y)*n.h;case"angle":return Math.atan2(o.y-s.y,o.x-s.x)*180/Math.PI}}function V7(t,e){var i=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,n=ore(Nt.pth(t)?t.totalLength:t,e)+"";return{original:n,numbers:n.match(i)?n.match(i).map(Number):[0],strings:Nt.str(t)||e?n.split(i):[]}}function ure(t){var e=t?w2(Nt.arr(t)?t.map(H7):H7(t)):[];return _2(e,function(i,n,r){return r.indexOf(i)===n})}function hre(t){var e=ure(t);return e.map(function(i,n){return{target:i,id:n,total:e.length,transforms:{list:sre(i)}}})}function SVe(t,e){var i=Tz(e);if(/^spring/.test(i.easing)&&(i.duration=tre(i.easing)),Nt.arr(t)){var n=t.length,r=n===2&&!Nt.obj(t[0]);r?t={value:t}:Nt.fnc(e.duration)||(i.duration=e.duration/n)}var s=Nt.arr(t)?t:[t];return s.map(function(o,a){var l=Nt.obj(o)&&!Nt.pth(o)?o:{value:o};return Nt.und(l.delay)&&(l.delay=a?0:e.delay),Nt.und(l.endDelay)&&(l.endDelay=a===s.length-1?e.endDelay:0),l}).map(function(o){return b2(o,i)})}function AVe(t){for(var e=_2(w2(t.map(function(s){return Object.keys(s)})),function(s){return Nt.key(s)}).reduce(function(s,o){return s.indexOf(o)<0&&s.push(o),s},[]),i={},n=function(s){var o=e[s];i[o]=t.map(function(a){var l={};for(var c in a)Nt.key(c)?c==o&&(l.value=a[c]):l[c]=a[c];return l})},r=0;r<e.length;r++)n(r);return i}function MVe(t,e){var i=[],n=e.keyframes;n&&(e=b2(AVe(n),e));for(var r in e)Nt.key(r)&&i.push({name:r,tweens:SVe(e[r],t)});return i}function EVe(t,e){var i={};for(var n in t){var r=uF(t[n],e);Nt.arr(r)&&(r=r.map(function(s){return uF(s,e)}),r.length===1&&(r=r[0])),i[n]=r}return i.duration=parseFloat(i.duration),i.delay=parseFloat(i.delay),i}function TVe(t,e){var i;return t.tweens.map(function(n){var r=EVe(n,e),s=r.value,o=Nt.arr(s)?s[1]:s,a=rh(o),l=Dz(e.target,t.name,a,e),c=i?i.to.original:l,h=Nt.arr(s)?s[0]:c,u=rh(h)||rh(l),d=a||u;return Nt.und(o)&&(o=c),r.from=V7(h,d),r.to=V7(Rz(o,h),d),r.start=i?i.end:0,r.end=r.start+r.delay+r.duration+r.endDelay,r.easing=Mz(r.easing,r.duration),r.isPath=Nt.pth(s),r.isColor=Nt.col(r.from.original),r.isColor&&(r.round=1),i=r,r})}var dre={css:function(t,e,i){return t.style[e]=i},attribute:function(t,e,i){return t.setAttribute(e,i)},object:function(t,e,i){return t[e]=i},transform:function(t,e,i,n,r){if(n.list.set(e,i),e===n.last||r){var s="";n.list.forEach(function(o,a){s+=a+"("+o+") "}),t.style.transform=s}}};function fre(t,e){var i=hre(t);i.forEach(function(n){for(var r in e){var s=uF(e[r],n),o=n.target,a=rh(s),l=Dz(o,r,a,n),c=a||rh(l),h=Rz(ore(s,c),l),u=Pz(o,r);dre[u](o,r,h,n.transforms,!0)}})}function CVe(t,e){var i=Pz(t.target,e.name);if(i){var n=TVe(e,t),r=n[n.length-1];return{type:i,property:e.name,animatable:t,tweens:n,duration:r.end,delay:n[0].delay,endDelay:r.endDelay}}}function PVe(t,e){return _2(w2(t.map(function(i){return e.map(function(n){return CVe(i,n)})})),function(i){return!Nt.und(i)})}function pre(t,e){var i=t.length,n=function(s){return s.timelineOffset?s.timelineOffset:0},r={};return r.duration=i?Math.max.apply(Math,t.map(function(s){let o=s.startOnceDelay??0,a=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return n(s)+o+a+l+s.duration*(s.loop??1)})):e.duration,r.delay=i?Math.min.apply(Math,t.map(function(s){let o=s.startOnceDelay??0,a=s.pingPongDelayCorrection??0;return n(s)+o+a+s.delay})):e.delay,r.endDelay=i?r.duration-Math.max.apply(Math,t.map(function(s){let o=s.startOnceDelay??0,a=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return n(s)+o+a+s.duration*(s.loop??1)-s.endDelay-l})):e.endDelay,r}var j7=0;function DVe(t){var e=cF($ne,t),i=cF(Az,t),n=MVe(i,t),r=hre(t.targets),s=PVe(r,n),o=pre(s,i),a=j7;return j7++,b2(e,{id:a,children:[],animatables:r,animations:s,duration:o.duration,delay:o.delay,endDelay:o.endDelay,startOnceDelay:i.startOnceDelay,pingPongDelayCorrection:i.pingPongDelayCorrection,pingPongEndDelayCorrection:i.pingPongEndDelayCorrection})}var Qa=[],W7=[],KM,RVe=function(){function t(){KM=requestAnimationFrame(e)}function e(i){var n=Qa.length;if(n){for(var r=0;r<n;){var s=Qa[r];s.paused?(Qa.splice(r,1),n-=1):(s.tick(i),r++)}t()}else KM=cancelAnimationFrame(KM)}return t}();function IVe(t){document.hidden?(Qa.forEach(function(e){return e.pause(t.timeStamp)}),W7=Qa.slice(0),Kn.running=Qa=[]):W7.forEach(function(e){return e.play(t.timeStamp)})}typeof document<"u"&&document.addEventListener("visibilitychange",IVe);function Kn(t){t===void 0&&(t={});var e=0,i=0,n=0,r,s,o=0,a=null;function l(A){var E=window.Promise&&new Promise(function(M){return a=M});return A.finished=E,E}var c=DVe(t);l(c);function h(){var A=c.direction;A!=="alternate"&&(c.direction=A!=="normal"?"normal":"reverse"),c.reversed=!c.reversed,s.forEach(function(E){(E.loop===1||E.loop%2===0)&&(E.reversed=c.reversed)})}function u(){c.direction="normal",c.reversed=!1,s.forEach(function(A){return A.reversed=!1})}function d(A){return c.reversed?c.duration-A:A}function f(){e=0,i=d(c.currentTime)*(1/Kn.speed)}function p(A,E){E&&(c.reversed?E.seek(E.duration*E.loop-(A-E.timelineOffset-E.pingPongDelayCorrection)):E.seek(A-E.timelineOffset-E.startOnceDelay-E.pingPongDelayCorrection))}function m(A){if(c.reversed)for(var E=o;E--;)p(A,s[E]);else for(var M=0;M<o;M++)p(A,s[M])}function v(A){var le,ae,fe,ge,ve,Y,ce,de,xe,Ce;var E=0,M=c.animations,T=M.length;for(c.direction!=="alternate"&&((le=c.parent)==null?void 0:le.direction)==="alternate"?((ae=c.parent)==null?void 0:ae.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1&&((fe=c.parent)!=null&&fe.reversed&&c.direction==="alternate"?A=c.duration-c.delay+c.endDelay-A:A=c.duration+c.delay-c.endDelay-A):b(!1,(ge=c.parent)==null?void 0:ge.rewind,c.rewind,(ve=c.parent)==null?void 0:ve.reversePlayback,c.reversePlayback)&&((Y=c.parent)!=null&&Y.reversed&&c.direction==="alternate"?A=c.duration-c.delay+c.endDelay-A:A=c.duration+c.delay-c.endDelay-A);E<T;){var P=M[E],R=P.animatable,U=P.tweens,F=U.length-1,N=U[F];F&&(N=_2(U,function(Ie){return A<Ie.end})[0]||N);let Ne;(ce=c.parent)!=null&&ce.reversed&&c.direction==="alternate"?Ne=Dl(A-N.start-N.endDelay,0,N.duration)/N.duration:Ne=Dl(A-N.start-N.delay,0,N.duration)/N.duration;for(var W=isNaN(Ne)?1:N.easing(Ne),Q=N.to.strings,X=N.round,B=[],j=N.to.numbers.length,z=void 0,k=0;k<j;k++){var G=void 0;let Ie,Ge;c.direction!=="alternate"?((de=c.parent)==null?void 0:de.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1?(Ie=N.to.numbers[k],Ge=N.from.numbers[k]||0):(Ge=N.to.numbers[k],Ie=N.from.numbers[k]||0):b(!0,(xe=c.parent)==null?void 0:xe.rewind,c.rewind,(Ce=c.parent)==null?void 0:Ce.reversePlayback,c.reversePlayback)?(Ie=N.to.numbers[k],Ge=N.from.numbers[k]||0):(Ge=N.to.numbers[k],Ie=N.from.numbers[k]||0),N.isPath?G=bVe(N.value,W*Ge):G=Ie+W*(Ge-Ie),X&&(N.isColor&&k>2||(G=Math.round(G*X)/X)),B.push(G)}var Z=Q.length;if(!Z)z=B[0];else{z=Q[0];for(var K=0;K<Z;K++){Q[K];var re=Q[K+1],J=B[K];isNaN(J)||(re?z+=J+re:z+=J+" ")}}dre[P.type](R.target,P.property,z,R.transforms),P.currentValue=z,E++}}function g(A){c[A]&&!c.passThrough&&c[A](c)}function y(){c.remaining&&c.remaining!==!0&&c.remaining--}let x={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function b(A,E,M,T,P){return x[A<<4|E<<3|M<<2|T<<1|P]}function S(A){var R;var E=c.duration;let M=c.delay,T=E-c.endDelay;(R=c.parent)!=null&&R.reversed&&c.direction==="alternate"&&(M=c.endDelay,T=E-c.delay);var P=d(A);if(c.progress=Dl(P/E*100,0,100),c.reversePlayback=P<c.currentTime,o&&m(P),!c.began&&c.currentTime>=0&&(c.began=!0,g("begin")),!c.loopBegan&&c.currentTime>0&&(c.loopBegan=!0,g("loopBegin")),(c.reversed||P>=0)&&P<=M&&c.currentTime!==0&&(v(0),g("change")),(P>=T&&c.currentTime!==E+c.pingPongDelayCorrection||!E)&&(v(E),g("change")),P>M&&P<T?(c.changeBegan||(c.changeBegan=!0,c.changeCompleted=!1,g("changeBegin")),v(P),g("change")):c.changeBegan?(c.changeCompleted=!0,c.changeBegan=!1,g("change"),o&&g("timelineChangeComplete")):c.began&&P>T&&g("changeComplete"),c.currentTime=Dl(P,0,E+c.pingPongDelayCorrection),c.began&&g("update"),A>=E)if(y(),!c.remaining)c.paused=!0,c.completed||(c.completed=!0,g("loopComplete"),g("complete"),!c.passThrough&&"Promise"in window&&(a(),l(c)));else{o?e+=c.duration/Kn.speed:e+=c.duration;for(let U of s)U.setStartTime(0),U.remaining=U.loop;g("loopComplete"),c.loopBegan=!1,c.direction==="alternate"?h():o&&u()}}return c.reset=function(){var A=c.direction;c.passThrough=!1,c.currentTime=0,c.progress=0,c.paused=!0,c.began=!1,c.loopBegan=!1,c.changeBegan=!1,c.completed=!1,c.changeCompleted=!1,c.reversePlayback=!1,c.reversed=A==="reverse",c.remaining=c.loop,s=c.children,o=s.length;for(var E=o;E--;)c.children[E].reset();(c.reversed&&c.loop!==!0||A==="alternate"&&c.loop===1)&&c.remaining++,v(c.reversed?c.duration:0)},c.setStartTime=function(A){e=A},c.set=function(A,E){return fre(A,E),c},c.tick=function(A){n=A,e||(e=n),S((n+(i-e))*Kn.speed)},c.seek=function(A){S(A-e)},c.pause=function(A){c.paused=!0,o&&(r=A??performance.now())},c.play=function(A){!c.paused||(c.completed&&c.reset(),c.paused=!1,Qa.push(c),o&&r!==void 0&&(e+=(A??performance.now())-r),KM||RVe())},c.reverse=function(){h(),c.completed=!c.reversed,f()},c.restart=function(){c.reset(),c.play()},c.reset(),c.autoplay&&c.play(),c}function X7(t,e){for(var i=e.length;i--;)Ez(t,e[i].animatable.target)&&e.splice(i,1)}function LVe(t){for(var e=ure(t),i=Qa.length;i--;){var n=Qa[i],r=n.animations,s=n.children;X7(e,r);for(var o=s.length;o--;){var a=s[o],l=a.animations;X7(e,l),!l.length&&!a.children.length&&s.splice(o,1)}!r.length&&!s.length&&n.pause()}}function BVe(t,e){e===void 0&&(e={});var i=e.direction||"normal",n=e.easing?Mz(e.easing):null,r=e.grid,s=e.axis,o=e.from||0,a=o==="first",l=o==="center",c=o==="last",h=Nt.arr(t),u=parseFloat(h?t[0]:t),d=h?parseFloat(t[1]):0,f=rh(h?t[1]:t)||0,p=e.start||0+(h?u:0),m=[],v=0;return function(g,y,x){if(a&&(o=0),l&&(o=(x-1)/2),c&&(o=x-1),!m.length){for(var b=0;b<x;b++){if(!r)m.push(Math.abs(o-b));else{var S=l?(r[0]-1)/2:o%r[0],A=l?(r[1]-1)/2:Math.floor(o/r[0]),E=b%r[0],M=Math.floor(b/r[0]),T=S-E,P=A-M,R=Math.sqrt(T*T+P*P);s==="x"&&(R=-T),s==="y"&&(R=-P),m.push(R)}v=Math.max.apply(Math,m)}n&&(m=m.map(function(F){return n(F/v)*v})),i==="reverse"&&(m=m.map(function(F){return s?F<0?F*-1:-F:Math.abs(v-F)}))}var U=h?(d-u)/v:u;return p+U*(Math.round(m[y]*100)/100)+f}}function OVe(t){t===void 0&&(t={});var e=Kn(t);return e.duration=0,e.add=function(i,n){var r=Qa.indexOf(e),s=e.children;r>-1&&Qa.splice(r,1);function o(d){d.passThrough=!0}for(var a=0;a<s.length;a++)o(s[a]);var l=b2(i,cF(Az,t));l.targets=l.targets||t.targets;var c=e.duration;l.autoplay=!1,l.timelineOffset=Nt.und(n)?c:Rz(n,c),o(e);var h=Kn(l);o(h),s.push(h),h.parent=e;var u=pre(s,t);return e.delay=u.delay,e.endDelay=u.endDelay,e.duration=u.duration,h.loop===!0&&(e.duration=1/0),e.seek(0),e.reset(),e.autoplay&&e.play(),e},e}Kn.version="3.2.0";Kn.speed=1;Kn.running=Qa;Kn.remove=LVe;Kn.get=Dz;Kn.set=fre;Kn.convertPx=Cz;Kn.path=wVe;Kn.setDashoffset=xVe;Kn.stagger=BVe;Kn.timeline=OVe;Kn.easing=Mz;Kn.penner=ire;Kn.random=function(t,e){return Math.floor(Math.random()*(e-t+1))+t};var mre=Kn,q7=new L,Y7=new L,Q7=new Zt;function FVe(t,e,i,n){if(n===0)return i.copy(t);if(n===1)return i.copy(e);let r=t.w*e.w+t.x*e.x+t.y*e.y+t.z*e.z;if(r>=1)return i.copy(t);let s=1-r*r;if(s<=Number.EPSILON){let h=1-n;return i.w=h*t.w+n*e.w,i.x=h*t.x+n*e.x,i.y=h*t.y+n*e.y,i.z=h*t.z+n*e.z,i.normalize(),i}let o=Math.sqrt(s),a=Math.atan2(o,r),l=Math.sin((1-n)*a)/o,c=Math.sin(n*a)/o;return i.w=t.w*l+e.w*c,i.x=t.x*l+e.x*c,i.y=t.y*l+e.y*c,i.z=t.z*l+e.z*c,i}function hm(t,e,i,n,r){let s=i[t]?i[t]:void 0,o=n[t];if(o==null)return;let a=s??e[t],l=o;if(a!==l)return{update:c=>{let h=hi.lerp(a,l,c);r?e[t]=Math.trunc(h):e[t]=h},start:()=>{e[t]=a},end:()=>{e[t]=l}}}function gre(t,e,i,n,r){let s=i[t]?i[t]:void 0,o=n[t];if(!o)return;let a=e[t],l=[...s??a],c=[...o];if(!(l.length!==c.length||Gk(l,c)))return{update:h=>{l.forEach((u,d)=>{let f=hi.lerp(u,c[d],h);e[t][d]=r?Math.trunc(f):f})},start:()=>{Object.assign(e[t],l)},end:()=>{Object.assign(e[t],c)}}}function K7(t,e,i,n){let r=i[t]?i[t]:void 0,s=n[t];if(!s)return;let o=e[t],a=r?new L().fromArray(r):o.clone(),l=new L().fromArray(s);if(!a.equals(l))return{update:c=>{o.lerpVectors(a,l,c)},start:()=>{o.copy(a)},end:()=>{o.copy(l)}}}function NVe(t,e,i,n){let r=i[t]?i[t]:void 0,s=n[t];if(!s)return;let o=e[t],a=r?new $e().fromArray(r):o.clone(),l=new L,c=new Zt,h=new L;a.decompose(l,c,h);let u=new $e().fromArray(s),d=new L,f=new Zt,p=new L;if(u.decompose(d,f,p),!a.equals(u))return{update:m=>{Q7.slerpQuaternions(c,f,m),q7.lerpVectors(l,d,m),Y7.lerpVectors(h,p,m),o.compose(q7,Q7,Y7)},start:()=>{o.compose(l,c,h)},end:()=>{o.compose(d,f,p)}}}function UVe(t,e,i,n,r){let s=i[t]?i[t]:void 0,o=n[t];if(!o)return;let a=e[t],l=s?typeof s=="string"?r.getColor(s).clone():new It().setRGB(s.r,s.g,s.b):a.clone(),c=typeof o=="string"?r.getColor(o).clone():new It().setRGB(o.r,o.g,o.b);if(l.equals(c))return;let h=a.clone();return e[t]=h,{update:u=>{h.lerpColors(l,c,u)},start:()=>{h.copy(l)},end:()=>{h.copy(c)}}}function mf(t,e,i,n){if(typeof e[t]=="number")return hm(t,e,i??{},n);if(Array.isArray(e[t]))return gre(t,e,i??{},n)}function kVe(t,e,i){var o,a,l,c;let n=[],r=t.cameraType==="OrthographicCamera"?(o=e.orthographic)==null?void 0:o.zoom:(a=e.perspective)==null?void 0:a.zoom,s=t.cameraType==="OrthographicCamera"?(l=i.orthographic)==null?void 0:l.zoom:(c=i.perspective)==null?void 0:c.zoom;if(s!==void 0){let h=r??t.zoom,u=s;h!==u&&n.push({update:d=>{t.zoom=hi.lerp(h,u,d),t.updateProjectionMatrix()},start:()=>{t.zoom=h,t.updateProjectionMatrix()},end:()=>{t.zoom=u,t.updateProjectionMatrix()}})}if(i.targetOffset!==void 0){let h=hm("targetOffset",t,e,i);h&&n.push(h)}return n}function zVe(t,e,i,n){if(i.scaleBaked===void 0)return;let r=e.scaleBaked??t.data.geometry.scaleBaked,s=i.scaleBaked;if(jp.isEqual(r,s))return;let o=[];return o.push({update:a=>{t.updateGeometryInteractions({scaleBaked:[hi.lerp(r[0],s[0],a),hi.lerp(r[1],s[1],a),hi.lerp(r[2],s[2],a)]},n),t.invalidateDownstreamBooleanData()},start:()=>{t.updateGeometryInteractions({scaleBaked:r},n),t.invalidateDownstreamBooleanData()},end:()=>{t.updateGeometryInteractions({scaleBaked:s},n),t.invalidateDownstreamBooleanData()}}),o}function GVe(t,e,i){if(!i.extrusion)return;let n=t.extrusion,r=e.extrusion??{},s=i.extrusion,o=[];return yie.forEach(a=>{let l=mf(a,n,r,s);l&&o.push(l)}),o}function HVe(t,e,i,n){let r=[];if(!("geometry"in i))return r;let s=t.geometry.userData.parameters,o="geometry"in e?e.geometry:{},a=i.geometry;if(t instanceof iw){let l=zVe(t,o,a,n);l&&r.push(...l)}else{let l={};if(Object.assign(l,Ud(s,i9)),i9.forEach(c=>{let h=mf(c,l,o,a);h&&r.push(h)}),t instanceof yz){Object.assign(l,{extrusion:{...s.extrusion}});let c=GVe(l,o,a);c&&r.push(...c)}r.length&&r.push({update:c=>{t.updateGeometryInteractions(l,n),t.updateGeometryGroupsIfNeeded()},start:c=>{t.updateGeometryInteractions(l,n),t.updateGeometryGroupsIfNeeded()},end:c=>{t.updateGeometryInteractions(l,n),t.updateGeometryGroupsIfNeeded()}})}return r}function VVe(t,e,i,n){let r=[];if(i.intensity!==void 0){let s=hm("intensity",t,e,i);s&&r.push(s)}if(i.color!==void 0){let s=UVe("color",t,e,i,n);s&&r.push(s)}return r}function jVe(t,e,i,n){let r=[];if(Array.isArray(t.material)){if(!("materials"in i&&i.materials))return r;let s="materials"in e&&e.materials?e.materials:[],o=i.materials;t.material.forEach((a,l)=>{if(!o[l])return;let c=s[l]??{},h=o[l];typeof c=="string"||typeof h=="string"||r.push(...J7(a,c,h,n))})}else{if(!("material"in i&&i.material))return r;let s="material"in e&&e.material?e.material:{},o=i.material;if(typeof s=="string"||typeof o=="string")return r;r.push(...J7(t.material,s,o,n))}return r}function J7(t,e,i,n){var o;let r=[],s=NT(i,n)||!!e.layers&&NT(e,n);r.push($Ve(t,s));for(let a of t.layers){let l=(o=e.layers)==null?void 0:o.data(a.uuid),c=i.layers.data(a.uuid);if(!c||!(a.visible??!0)||!(c.visible??!0))continue;let h=a.getNames().filter(u=>!mie.some(d=>u.includes(d)));for(let u of h)try{let d=a.getValue(u),f;if(u==="colors")f=JVe(a,l,c,u);else if(Array.isArray(d))u==="steps"&&(f=KVe(a,l,c,u));else if(typeof d=="number")f=WVe(a,l,c,u);else{if(typeof d=="boolean")continue;d instanceof he?f=XVe(a,l,c,u):d instanceof L?f=qVe(a,l,c,u):d instanceof wo?f=QVe(a,l,c,u,n):d instanceof It?f=YVe(a,l,c,u,n):"isTexture"in d&&(f=ZVe(a,l,c,u))}f&&(Array.isArray(f)?r.push(...f):r.push(f))}catch(d){console.error(`lerpMaterial: unexpected material layer for ${u}`,d)}}return r}function WVe(t,e,i,n){if(!t.hasValue(n)||!(n in i))return;let r=e?e[n]:t.getValue(n),s=i[n];if(r!==s)return{update:o=>{t.setValue(n,hi.lerp(r,s,o))},start:()=>{t.setValue(n,r)},end:()=>{t.setValue(n,s)}}}function XVe(t,e,i,n){if(!t.hasValue(n)||!(n in i))return;let r=t.getValue(n),s=e?new he().fromArray(e[n]):r.clone(),o=new he().fromArray(i[n]);if(!s.equals(o))return{update:a=>{r.lerpVectors(s,o,a)},start:()=>{r.copy(s)},end:()=>{r.copy(o)}}}function qVe(t,e,i,n){if(!t.hasValue(n)||!(n in i))return;let r=t.getValue(n),s=e?new L().fromArray(e[n]):r.clone(),o=new L().fromArray(i[n]);if(!s.equals(o))return{update:a=>{r.lerpVectors(s,o,a)},start:()=>{r.copy(s)},end:()=>{r.copy(o)}}}function YVe(t,e,i,n,r){if(!t.hasValue(n)||!(n in i))return;let s=e?e[n]:void 0,o=i[n],a=t.getValue(n),l=s?typeof s=="string"?r.getColor(s).clone():new It().setRGB(s.r,s.g,s.b):a.clone(),c=typeof o=="string"?r.getColor(o).clone():new It().setRGB(o.r,o.g,o.b);if(l.equals(c))return;let h=a.clone();return{update:u=>{t.getValue(n)!==h&&t.setValue(n,h),h.lerpColors(l,c,u)},start:()=>{h.copy(l)},end:()=>{h.copy(c)}}}function QVe(t,e,i,n,r){if(!t.hasValue(n)||!(n in i))return;let s=e?e[n]:void 0,o=i[n],a=t.getValue(n),l=s?typeof s=="string"?r.getColor(s).clone():new It().setRGB(s.r,s.g,s.b):a.clone(),c=typeof o=="string"?r.getColor(o).clone():new wo(o.r,o.g,o.b,o.a);if(l.equals(c))return;let h=a.clone();return{update:u=>{t.getValue(n)!==h&&t.setValue(n,h),h.lerpColors(l,c,u)},start:()=>{h.copy(l)},end:()=>{h.copy(c)}}}function KVe(t,e,i,n="steps"){if(!t.hasValue(n)||!(n in i))return;let r=[],s=t.getValue(n),o=e?e[n]:s,a=i[n];for(let l=0;l<s.length;++l){let c=o[l],h=a[l];c!==h&&r.push({update:u=>{s[l]=hi.lerp(c,h,u)},start:()=>{s[l]=c},end:()=>{s[l]=h}})}return r.length?r:void 0}function JVe(t,e,i,n="colors"){if(!t.hasValue(n)||!(n in i))return;let r=[],s=t.getValue(n),o=e?e[n]:s.map(l=>l.toArray()),a=i[n];for(let l=0;l<s.length;++l){let c=[...o[l]],h=[...a[l]];bT.isEqual(c,h)||r.push({update:u=>{s[l].fromArray(bT.lerp(c,h,u))},start:()=>{s[l].fromArray(c)},end:()=>{s[l].fromArray(h)}})}return r.length?r:void 0}function ZVe(t,e,i,n="texture"){if(!t.hasValue(n)||!(n in i))return;let r=t.getNode("mat");if(!r)return;let s=e?e[n]:r,o=i[n],a=[...s.repeat],l=[...s.offset],c=[...o.repeat],h=[...o.offset];if(!Cv.isEqual(a,c)||!Cv.isEqual(l,h))return{update:u=>{r.repeat=Cv.lerp(a,c,u),r.offset=Cv.lerp(l,h,u),r.updateMatrix()},start:()=>{r.repeat=[...a],r.offset=[...l],r.updateMatrix()},end:()=>{r.repeat=[...c],r.offset=[...h],r.updateMatrix()}}}function $Ve(t,e){return{update:()=>{t.transparent=e}}}var Y3=new L,Z7=new Nr;function eje(t,e,i,n){let r=[],s,o,a,l,c,h,u={slide:(e.pathSnapping??t.updatedPathSnapping??t.dataPatched.pathSnapping).slide,offset:(e.pathSnapping??t.updatedPathSnapping??t.dataPatched.pathSnapping).offset};if(c=hm("slide",u,e.pathSnapping??t.updatedPathSnapping??t.dataPatched.pathSnapping,i.pathSnapping??t.dataPatched.pathSnapping),c&&r.push(c),h=hm("offset",u,e.pathSnapping??t.updatedPathSnapping??t.dataPatched.pathSnapping,i.pathSnapping??t.dataPatched.pathSnapping),h&&r.push(h),!c&&!h&&(s=K7("position",t,e,i),s&&r.push(s),o=K7("scale",t,e,i),o&&r.push(o),a=tje(t,e,i,n),a&&r.push(a),l=NVe("hiddenMatrix",t,e,i),l&&r.push(l)),s||o||a||l||c||h){let d=()=>{var f;t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD()),(f=t.parent)!=null&&f.matrixWorldFusedFalse&&(t.matrixWorld.multiplyMatrices(t.parent.matrixWorldFusedFalse,t.matrix),t.matrixWorldNeedsUpdate=!1),Ml(t)&&Ju(t.parent)&&t.invalidateDownstreamBooleanData(!0),t.updatePathSnapping(Object.assign({},e.pathSnapping,u))};r.push({update:d,start:d,end:d})}return r}function tje(t,e,i,n){let r=e!=null&&e.rotation?e.rotation:void 0,s=i.rotation;if(!s)return;let o=r?new L().fromArray(r):new L().setFromEuler(t.rotation),a=new L().fromArray(s);if(o.equals(a))return;let l=Y3.subVectors(a,o);if(n&&l.toArray().every(c=>Math.abs(c)<2*Math.PI)){let c=new Zt().setFromEuler(Z7.setFromVector3(o)),h=new Zt().setFromEuler(Z7.setFromVector3(a));return{update:u=>{FVe(c,h,t.quaternion,u)},start:()=>{t.rotation.setFromVector3(o)},end:()=>{t.rotation.setFromVector3(a)}}}else return{update:c=>{Y3.lerpVectors(o,a,c),t.rotation.setFromVector3(Y3)},start:()=>{t.rotation.setFromVector3(o)},end:()=>{t.rotation.setFromVector3(a)}}}function ije(t,e,i){let n=[];if(!("cloner"in i)||!t.cloner)return n;let r=t.cloner,s="cloner"in e?e.cloner:{},o=i.cloner;cie.forEach(d=>{let f;d==="count"?f=hm("count",r.parameters,s,o,!0):f=mf(d,r.parameters,s??{},o),f&&n.push(f)});let a=nje(r,s,o);a!=null&&a.length&&n.push(...a);let l=rje(r,s,o);l!=null&&l.length&&n.push(...l);let c=sje(r,s,o);c!=null&&c.length&&n.push(...c);let h=oje(r,s,o);h!=null&&h.length&&n.push(...h);let u=aje(r,s,o);return u!=null&&u.length&&n.push(...u),n.length&&n.push({update:()=>{r.update()}}),n}function nje(t,e,i){if(t.parameters.type!=="radial")return;let n=e.radial,r=i.radial;if(!r)return;let s=t.parameters.radial,o=[];return uie.forEach(a=>{let l=mf(a,s,n??{},r);l&&o.push(l)}),o}function rje(t,e,i){if(t.parameters.type!=="linear")return;let n=e.linear,r=i.linear;if(!r)return;let s=[],o=t.parameters.linear;return hie.forEach(a=>{let l=mf(a,o,n??{},r);l&&s.push(l)}),s}function sje(t,e,i){if(t.parameters.type!=="grid")return;let n=e.grid,r=i.grid;if(!r)return;let s=[],o=t.parameters.grid;return die.forEach(a=>{let l;a==="count"?l=gre(a,o,n??{},r,!0):l=mf(a,o,n??{},r),l&&s.push(l)}),s}function oje(t,e,i){if(t.parameters.type!=="toObject")return;let n=e.toObject,r=i.toObject;if(!r)return;let s=[],o=t.parameters.toObject;return fie.forEach(a=>{let l;a==="count"?l=hm(a,o,n??{},r,!0):l=mf(a,o,n??{},r),l&&s.push(l)}),s}function aje(t,e,i){if(!t.parameters.randomness)return;let n=e.randomnessObject,r=i.randomnessObject;if(!r)return;let s=[],o=t.parameters.randomnessObject;return pie.forEach(a=>{let l=mf(a,o,n??{},r);l&&s.push(l)}),s}function $7(t,e,i,n,r){let s=[];return t.data.visible&&s.push(...eje(t,e,i,r)),t.data.visible&&s.push(...ije(t,e,i)),Ml(t)?(t instanceof bo&&t.data.visible&&s.push(...HVe(t,e,i,n)),t.data.visible&&s.push(...jVe(t,e,i,n))):bGe(t)?t.data.visible&&s.push(...VVe(t,e,i,n)):wGe(t)&&s.push(...kVe(t,e,i)),s.length?{update:o=>{s.forEach(a=>a.update(o))},start:o=>{s.forEach(a=>{var l;return(l=a.start)==null?void 0:l.call(a,o)})},end:o=>{s.forEach(a=>{var l;return(l=a.end)==null?void 0:l.call(a,o)})}}:void 0}var eX=new L;function Lz(t,e,i=!1){let n=[];t.traverseChildren(r=>{var l,c,h,u,d;if(i&&((l=r.rigidBody)==null||l.setTranslation(r.position0,!0),(c=r.rigidBody)==null||c.setRotation(r.rotation0,!0),(h=r.rigidBody)==null||h.setLinvel(eX,!0),(u=r.rigidBody)==null||u.setAngvel(eX,!0)),!xi.is(r))return;let s=r.uuid,o=r.data;if(delete r.states,r.uuid===_y)return;let a=!1;n.some(f=>{var p;return(p=t.scene.find(s))==null?void 0:p.isDescendantOf(f)})?a=!0:((d=o.physics)==null?void 0:d.fusedBody)===!0&&o.physics.rigidBody==="dynamic"&&n.push(s),r.data=o,r.currentState=null,r.reversibleToState=null,r.currentTransitionEvent=null;for(let f of o.states){let p={...f.data};t.data.globalPhysics.usePhysics===!0&&o.physics&&(o.physics.rigidBody==="dynamic"||a)&&(f.data.position!==void 0&&delete p.position,f.data.rotation!==void 0&&delete p.rotation,f.data.hiddenMatrix!==void 0&&delete p.hiddenMatrix),r.states||(r.states={}),r.states[f.id]=Ap.patch(o,p)}cje(t.scene,r,null,e,o.events.find(f=>f.data.type==="Follow"||f.data.type==="LookAt")!==void 0),lje(t)})}function lje(t){t.traverseEntity(e=>{for(let i of e.data.events){let n=[];switch(i.data.type){case"Follow":case"MouseHover":case"Scroll":case"MouseDown":case"MouseUp":case"MousePress":case"KeyUp":case"KeyDown":case"KeyPress":case"Collision":n.push(...i.data.actions);break;case"GameControl":for(let r of Object.values(i.data.gameActions))n.push(...r);break;case"DragDrop":n.push(...i.data.dragDropActions.drag,...i.data.dragDropActions.drop);break;case"Conditional":n.push(...i.data.inActions,...i.data.outActions);break}for(let r of n)r.data.type==="Create"&&r.data.hideBase==="Yes"&&(t.scene.find(r.data.object).visible=!1)}})}function cje(t,e,i,n,r=!1){if(e instanceof bo&&e.removeInteractionGeometry(),e.changeSelectedState(i,{scene:t,shared:n},r),e instanceof bo&&e.updateGeometryGroupsIfNeeded(),e instanceof js&&e.updateCameraState(e.dataPatched,{scene:t,shared:n}),e.cloner)for(let s of e.cloner.children)s.playModeVisible=void 0;e.updateVisible()}function vre(t){let e;if(t.easing===5){let{control1:i,control2:n}=t;e=`cubicBezier(
			${i[0]}, ${i[1]}, ${n[0]}, ${n[1]}
		)`}else if(t.easing===6){let{mass:i,stiffness:n,damping:r,velocity:s}=t;e=`spring( ${i}, ${n}, ${r}, ${s} )`}else{let i;switch(t.easing){case 0:i=nd.linear;break;case 1:i=nd.ease;break;case 2:i=nd.easeIn;break;case 3:i=nd.easeOut;break;case 4:i=nd.easeInOut;break;default:i=nd.linear}let[n,r,s,o]=i;e=`cubicBezier( ${n}, ${r}, ${s}, ${o} )`}return{duration:t.duration,easing:e}}function yre(t){let e={delay:0,loop:t.repeat===-1?!0:t.repeat+1};if(t.repeat===0)e.direction="normal",e.rewind=!1;else switch(t.direction){case"pingpong":e.direction="alternate",e.rewind=!1;break;case"pingpong-rewind":e.direction="alternate",e.rewind=!0;break;default:e.direction="normal",e.rewind=!1;break}switch(e.delay=0,e.endDelay=0,e.startOnceDelay=0,e.pingPongDelayCorrection=0,e.pingPongEndDelayCorrection=0,t.delayDirection){case"start-once":e.startOnceDelay=t.delay;break;case"start":e.delay=t.delay;break;case"end":e.endDelay=t.delay;break;case"start-end":case void 0:e.delay=t.delay,e.endDelay=t.delay;break}return e.direction==="alternate"&&(e.delay/=2,e.endDelay/=2,t.delayDirection==="start"?(e.pingPongDelayCorrection=e.delay,typeof e.loop=="number"&&e.loop%2===0&&(e.pingPongEndDelayCorrection=e.delay)):t.delayDirection==="end"?typeof e.loop=="number"&&e.loop%2!==0&&(e.pingPongEndDelayCorrection=e.endDelay):t.delayDirection==="start-end"&&(e.pingPongDelayCorrection=e.delay,e.pingPongEndDelayCorrection=e.endDelay)),e}var uje={type:"beginState"},hje={type:"completeState",isfromEntity:!1},tX=class{constructor(t,e,i,n,r,s){if(this.object=t,this.data=n,this.sharedAssets=r,this.allowSlerp=s,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.dispatchEvent({type:"requestRender"})),this.targets.t===0||this.targets.t===1?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let o=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=o,this.object.dispatchEvent({type:"beginState",state:o}),this.object.traverseEntity(a=>{a!==this.object&&a instanceof js&&a.dispatchEvent(uje)})},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let o=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=o,this.object.dispatchEvent({type:"completeState",state:o}),this.object.traverseEntity(a=>{a!==this.object&&a instanceof js&&a.dispatchEvent(hje)})},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=$7(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},e===void 0){let o=JM(this.object,this.object.currentState===i?this.object.prevState:this.object.currentState);if(!o)throw new Error("Missing property");this.from=o}else{let o=JM(this.object,e);if(!o)throw new Error("Missing property");this.from=o}if(i===void 0)throw new Error("Missing property");{let o=JM(this.object,i);if(!o)throw new Error("Missing property");this.to=o}this.useCurrentState=e===void 0||i===void 0,this.params={targets:this.targets,t:1,autoplay:!1,...yre(n),...vre(n),change:this.onChange},this.callback=$7(this.object,e===void 0?{}:this.from.data,i===void 0?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},Y1=class extends is{constructor(t,e,i){if(super(),this.data=t,this.page=e,this.sharedAssets=i,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.useToggle=!1,this.onTimelineChangeComplete=()=>{var r;this.data.tweens[0].data.direction!=="normal"&&(this.toggleIsForward=!this.toggleIsForward),this.timelineNeedsRebuild!==!1&&((r=this.timeline)==null||r.pause(),this.buildTimeline({isForward:this.toggleIsForward,isRebuild:!0}),this.timeline.play())},!t.object)throw new Error("Missing property");let n=this.page.scene.find(t.object);if(!n)throw new Error("Missing property");if(!n.states)throw new Error("Missing property");if(this.object=n,t.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay=t.tweens[0].data.delayDirection==="start-once"?t.tweens[0].data.delay:0,this.init()}get playing(){return this.tweens.some(t=>t.changeBegan)??!1}init(){this.initialCurrentState=JM(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return this.useToggle?this.initialCurrentState:this.object.currentState}buildTimeline({isForward:t=!0,isRebuild:e=!1}={}){var i,n,r,s;try{let o=yre(this.data.tweens[0].data),a=o.loop;e&&typeof o.loop=="number"&&o.loop--,(i=this.timeline)==null||i.pause(),this.timeline=mre.timeline({autoplay:!1,...o,...a===!0||a>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}});let l=this.tweens.findIndex(c=>c==null?void 0:c.changeBegan);if(this.timelineNeedsRebuild=l!==-1&&(a===!0||a>1),o.pingPongDelayCorrection&&e===!1&&(this.timelineNeedsRebuild=!0),t){let c=l===-1?0:l;for(let h=c;h<this.data.tweens.length-1;h++){let u=this.data.tweens[h],d=this.data.tweens[h+1],f;h===c&&(this.object.wasMovedByUser===!0||((n=this.object.previousAction)==null?void 0:n.playing)===!0)?(f=void 0,this.object instanceof js&&(this.object.wasMovedByUser=!1)):f=u.data.state===void 0?this.currentState:u.data.state;let p=new tX(this.object,f,d.data.state===void 0?this.currentState:d.data.state,d.data,this.sharedAssets,this.data.allowSlerp??!1);l!==-1&&h===c&&Object.assign(p.params,{startOnceDelay:0}),this.tweens[h]=p,this.timeline.add(p.params,this.timeline.duration+(h===c?o.delay:0)+(h===c&&!e?o.pingPongDelayCorrection:0))}this.timeline.duration+=o.endDelay}else{let c=l===-1?this.data.tweens.length-1:l+1;for(let h=c;h>0;h--){let u=this.data.tweens[h],d=this.data.tweens[h-1],f;h===c&&(this.object.wasMovedByUser===!0||((r=this.object.previousAction)==null?void 0:r.playing)===!0)?(f=void 0,this.object instanceof js&&(this.object.wasMovedByUser=!1)):f=u.data.state===void 0?this.currentState:u.data.state;let p=new tX(this.object,f,d.data.state===void 0?this.currentState:d.data.state,u.data,this.sharedAssets,this.data.allowSlerp??!1);l!==-1&&h===c&&Object.assign(p.params,{startOnceDelay:0}),this.tweens[h-1]=p,this.timeline.add(p.params,this.timeline.duration+(h===c?o.endDelay:0))}this.timeline.duration+=o.delay+(e?0:o.pingPongDelayCorrection)}}catch(o){o instanceof Error&&console.error(o.message)}((s=this.object.previousAction)==null?void 0:s.playing)===!0&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(this.playing)return!1;clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{try{this.buildTimeline(),this.timeline.play()}catch(t){t instanceof Error&&console.error(t.message)}},this.startOnceDelay)}pause(){var t;(t=this.timeline)==null||t.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let t=this.data.tweens[0].data.state===void 0?this.initialCurrentState:this.data.tweens[0].data.state;this.object.changeSelectedState(t,{scene:this.page.scene,shared:this.sharedAssets}),this.object.currentState=t}seek(t){var e;this.timeline===void 0&&this.buildTimeline(),(e=this.timeline)==null||e.seek(t*this.timeline.duration)}toggle(t){var e;this.useToggle=!0,clearTimeout(this.timeoutId),this.toggleIsForward=t??!this.toggleIsForward,this.playing?((e=this.timeline)==null||e.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()):this.timeoutId=window.setTimeout(()=>{var i;(i=this.timeline)==null||i.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function JM(t,e){var r;let i,n;if(typeof e=="string"?(i=e,n=(r=t.states)==null?void 0:r[i]):e===null&&(i=null,n=t.data),!(i===void 0||n===void 0))return{id:i,data:n}}var dje={type:"beginState"},iX={type:"completeState",isfromEntity:!1},nX={type:"requestRender"},xre=class extends is{constructor(t,e){super(),this.data=t,this.page=e,this.toggleIsForward=!1,this.useToggle=!1,this.posStart=new L,this.posEnd=new L,this.qStart=new Zt,this.qEnd=new Zt,this.zoomStart=1,this.zoomEnd=1,this.toCamera=this.page.scene.find(t.targetCamera)}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(t=!1){if(!this.data.animate)return;let e={t:0};this.posStart.copy(this.page.activeCamera.position),this.qStart.copy(this.page.activeCamera.quaternion),this.zoomStart=this.page.activeCamera.zoom,this.animation=mre({targets:e,t:1,...vre(this.data),update:()=>{e.t===0&&(this.useToggle&&!this.toggleIsForward?(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera)):(this.posEnd.copy(this.toCamera.position),this.qEnd.copy(this.toCamera.quaternion),this.zoomEnd=this.toCamera.zoom,this.fromCamera=this.page.activeCamera,this.switchCamera(this.toCamera)),this.page.activeCamera.dispatchEvent(dje));let i=this.page.activeCamera;i.position.lerpVectors(this.posStart,this.posEnd,e.t),i.quaternion.slerpQuaternions(this.qStart,this.qEnd,e.t),i.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*e.t,i.wasMovedBySwitchCameraAction=!0,i.updateMatrix(),i.updateMatrixWorld(),i.updateProjectionMatrix(),i.dispatchEvent(nX),e.t===1&&i.dispatchEvent(iX)}})}switchCamera(t){this.page.switchActiveCamera(t),this.page.activeCamera.dispatchEvent({type:"cameraChange",camera:t})}play(){this.playing||this.page.activeCamera!==this.toCamera&&(clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var t;delete this.timeoutId;try{this.data.animate?(this.buildAnimation(),(t=this.animation)==null||t.play()):this.switchCamera(this.toCamera)}catch(e){e instanceof Error&&console.error(e.message)}},this.data.delay*1e3))}pause(){var t;(t=this.animation)==null||t.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(t){var e,i;this.useToggle=!0,clearTimeout(this.timeoutId),this.toggleIsForward=t??!this.toggleIsForward,this.playing?((e=this.animation)==null||e.pause(),this.buildAnimation(!0),(i=this.animation)==null||i.play()):this.timeoutId=window.setTimeout(()=>{var n,r;delete this.timeoutId,this.data.animate?((n=this.animation)==null||n.pause(),this.buildAnimation(),(r=this.animation)==null||r.play()):(this.toggleIsForward?(this.fromCamera=this.page.activeCamera,this.switchCamera(this.toCamera)):this.switchCamera(this.fromCamera),this.page.activeCamera.dispatchEvent(iX),this.page.activeCamera.dispatchEvent(nX))},this.data.delay*1e3)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause(),this.toggleIsForward=!1}},Q1=class extends is{constructor(t,e,i){var a,l,c;super(),this.page=e,this.animationControls=i,this.startOnceDelay=0,this.toggleIsForward=!1;let n=t.object,r=e.scene.find(t.object);r&&Array.isArray(r.identity)&&(n=r.identity[0]),this.data={...t,object:n};let s=this.animationControls.clipIdToAction[t.clipId+"/"+n];this.duration=((a=s==null?void 0:s.getClip())==null?void 0:a.duration)??1;let o=((c=(l=s==null?void 0:s.getClip())==null?void 0:l.tracks[0])==null?void 0:c.times.length)??1/0;this.leftFrameTime=this.data.crop[0]/o*this.duration,this.rightFrameTime=this.data.crop[1]/o*this.duration,this.startOnceDelay=t.delay}get playing(){var t;return((t=this.threeAnimAction)==null?void 0:t.isRunning())??!1}play(t=!1){window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var i;if(this.threeAnimAction=this.animationControls.play(this.data),!this.threeAnimAction)return;this.threeAnimAction.reset(),this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime;let e=this.data.object;Object.entries(this.animationControls.clipIdToAction).forEach(([n,r])=>{let s=n.split("/")[1];this.threeAnimAction!==r&&s===e&&r.isRunning()&&(t?r.fadeOut(.2):r.stop())}),t&&((i=this.threeAnimAction)==null||i.fadeIn(.2))},this.startOnceDelay)}pause(){this.threeAnimAction&&(this.threeAnimAction.paused=!0),window.clearTimeout(this.timeoutId),delete this.timeoutId}stop(){var t;(t=this.threeAnimAction)==null||t.fadeOut(.2)}seek(t){this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction&&(this.threeAnimAction.paused=!0,this.threeAnimAction.time=hi.clamp(this.threeAnimAction.time+1/60*t,this.leftFrameTime,this.rightFrameTime-16e-5),this.animationControls.needsUpdate=!0,this.animationControls.requestRender())}toggle(t,e=!1){this.toggleIsForward=t??!this.toggleIsForward,this.threeAnimAction&&(this.threeAnimAction._loopCount=0),this.playing?this.threeAnimAction&&(this.threeAnimAction.timeScale=this.toggleIsForward?1:-1,this.toggleIsForward?(this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime)):this.timeoutId=window.setTimeout(()=>{var i;if(this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction){this.toggleIsForward?(this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction.time=this.rightFrameTime,this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime),this.threeAnimAction.paused=!1,this.threeAnimAction.timeScale=this.toggleIsForward?1:-1;let n=this.data.clipId.split("/")[1];Object.entries(this.animationControls.clipIdToAction).forEach(([r,s])=>{let o=r.split("/")[1];this.threeAnimAction!==s&&o===n&&s.isRunning()&&(e?s.fadeOut(.2):s.stop())}),e&&((i=this.threeAnimAction)==null||i.fadeIn(.2))}},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){var e;let t=(e=this.animationControls.clipIdToAction[this.data.clipId+"/"+this.data.object])==null?void 0:e.getClip();t&&(t.duration=this.duration),this.pause()}},_re=class{constructor(t,e,i,n){this.data=t,this.page=e,this.eventManager=i,this.shared=n,this.timeOutId=-1,this.scene=e.scene}dispatch(){this.data.target!==this.page.uuid&&(window.clearTimeout(this.timeOutId),this.timeOutId=window.setTimeout(()=>{this.play()},this.data.delay*1e3))}dispose(){window.clearTimeout(this.timeOutId)}play(){if(this.scene.children.every(e=>e.uuid!==this.data.target))return;this.data.transition==="fade"&&this.data.duration>0&&this.eventManager.eventContext.renderer.renderFromSceneForSceneTransitionPass(this.scene,this.scene.activeCamera,this.data.duration*1e3),this.eventManager.deactivate(),this.eventManager.controlsManager.deactivate();let t=this.scene.activeCamera;this.scene.updatePage(this.data.target),this.scene.activePage.switchToPlayCamera(),this.scene.activeCamera.copyViewPlaneSize(t),Lz(this.scene.activePage,this.shared),this.eventManager.activate(),this.eventManager.controlsManager.activate(this.eventManager)}};function il(t,e,i,n,r,s){let o={Audio:[],Video:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[],Animation:[],SceneTransition:[]};return e.forEach(({id:a,data:l})=>{try{l.type==="Audio"?ac[t.type].includes("Audio")&&o.Audio.push(new X1(a,l,s,n)):l.type==="Video"?ac[t.type].includes("Video")&&o.Video.push(new Bz(a,l,s)):l.type==="Link"?ac[t.type].includes("Link")&&o.Link.push(new rVe(l,r)):l.type==="Create"?ac[t.type].includes("Create")&&o.Create.push(new J1(l,i,r.controlsManager)):l.type==="Destroy"?ac[t.type].includes("Destroy")&&o.Destroy.push(new Zne(l,i,r)):l.type==="Reset"?ac[t.type].includes("Reset")&&o.Reset.push(new sVe(i,n,r)):l.type==="Transition"?ac[t.type].includes("Transition")&&o.Transition.push(new Y1(l,i,n)):l.type==="SwitchCamera"?ac[t.type].includes("SwitchCamera")&&o.SwitchCamera.push(new xre(l,i)):l.type==="SceneTransition"?ac[t.type].includes("SceneTransition")&&o.SceneTransition.push(new _re(l,i,r,n)):l.type==="Animation"&&ac[t.type].includes("Animation")&&o.Animation.push(new Q1(l,i,r.animationControls))}catch{}}),o}function oa(t){Object.values(t).forEach(e=>{e.forEach(i=>{(i instanceof X1||i instanceof Bz||i instanceof Q1||i instanceof Y1||i instanceof J1||i instanceof Zne||i instanceof xre||i instanceof _re)&&i.dispose()})})}function fje(t,e){let i;if("material"in t){let n=t.material;Array.isArray(n)?i=t.material[0].layers.find(r=>r.uuid===e):i=t.material.layers.find(r=>r.uuid===e)}if(i)return i.color.texture.image.img instanceof HTMLVideoElement?i.color.texture.image.img:void 0}var wre=new Map,K1=new Map,r0=class{constructor(t,e,i){this.data=e,this.delay=0,this.status="stopped";let{layerId:n,loop:r,volume:s,delay:o}=e;if(this.object=i,n===void 0)throw new Error("Missing property");let a=fje(i,n);a&&(this.videoElement=a,this.videoElement.loop=r===1/0,this.videoElement.autoplay=!0,s!==void 0&&(this.videoElement.volume=s)),o!==void 0&&(this.delay=o),K1.has(i.uuid)?K1.get(i.uuid).push(this):K1.set(i.uuid,[this]),wre.set(t,this),this.pause()}mute(){!this.videoElement||(this.videoElement.muted=!0)}unMute(){!this.videoElement||(this.videoElement.muted=!1)}play(t){if(!this.videoElement)return;let e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);t?(this.mute(),this.delay+=150):e?(this.mute(),window.setTimeout(()=>{this.unMute()},100)):this.unMute(),this.delayTimerId=window.setTimeout(()=>{if(!this.videoElement)return;let i=this.videoElement.play();i!==void 0&&i.then(n=>{}).catch(n=>{this.play()}),this.clearDelay()},this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){!this.videoElement||(this.videoElement.pause(),this.status="paused")}stop(){!this.videoElement||(this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay())}playByToggle(){this.data.toggle==="stop"?this.status==="playing"?this.stop():(this.stop(),this.play()):this.data.toggle==="pause"?this.status==="playing"?this.pause():this.play():(this.stop(),this.play())}dispose(){!this.videoElement||(this.stop(),this.videoElement.muted=!0)}},hF=class{constructor(t){this.data=t}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(t){let e=wre.get(t);!e||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e[this.data.interaction](),this.disposeDelay()},this.data.delay)):e[this.data.interaction]())}pauseAllVideosFromObject(t){let e=K1.get(t);!(e!=null&&e.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(i=>i[this.data.interaction]()),this.disposeDelay()},this.data.delay)):e.forEach(i=>i[this.data.interaction]()))}pauseAllVideos(){let t=[...K1.values()];!t.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(e=>{e.forEach(i=>{i[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):t.forEach(e=>{e.forEach(i=>{i[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},Bz=class{constructor(t,e,i){if(this.data=e,e.interaction==="play")this.interaction=new r0(t,e,i);else if(e.interaction==="pause"||e.interaction==="stop")this.interaction=new hF(e);else throw new Error("Missing property")}dispatchBasic(){this.interaction instanceof r0?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){this.interaction instanceof r0?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},rX=(()=>{let t,e,i,n;function r(a){!t&&!sX()&&(e==null?void 0:e.sharedGameControlGlobals.createdObjects.length)>0&&(t=requestAnimationFrame(s)),a&&(e=a,n=a.requestRender)}function s(a){let l=i?a-i:0,c=e.sharedGameControlGlobals.createdObjects,h=e.sharedGameControlGlobals.nCreatedPerAction,u=c.length,d=0;for(;d<u;){let f=c[d];f.userData.createdTime===void 0&&(f.userData.createdTime=a),f.userData.lifetime===void 0&&f.userData.quantity===void 0||f.userData.lifetime&&a-f.userData.createdTime<f.userData.lifetime||f.userData.quantity&&h[f.userData.actionId]<=f.userData.quantity?(f.userData.velocity&&(f.position.addScaledVector(f.userData.velocity,l/1e3),f.updateMatrix(),n()),d++):(h[f.userData.actionId]>f.userData.quantity&&h[f.userData.actionId]--,c.splice(d,1),f.removeFromParent(),e.sharedGameControlGlobals.rapierWorld&&f.rigidBody?(e.sharedGameControlGlobals.colliderToEntity.delete(f.rigidBody.collider(0).handle),e.sharedGameControlGlobals.rapierWorld.removeRigidBody(f.rigidBody)):(f.bvhGeometry=void 0,e.sharedGameControlGlobals.entitiesWithTransformAnim=e.sharedGameControlGlobals.entitiesWithTransformAnim.filter(p=>p.bvhGeometry!==void 0)),u--,n())}t=d>0?requestAnimationFrame(s):void 0,i=d>0?a:void 0}function o(){sX()?t&&(cancelAnimationFrame(t),t=void 0,i=void 0):r()}return typeof document<"u"&&document.addEventListener("visibilitychange",o),r})();function sX(){return!!document&&document.hidden}var oX=new Zt,pje=new L,mje=new L,J1=class{constructor(t,e,i){this.data=t,this.page=e,this.controlsManager=i,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=hi.generateUUID(),this.dispatch=()=>{this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()},this.dispatchFromStart=()=>{this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))},this.dispatchThrottled=oNe(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{this.intervalId===null&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{if(this.timeoutIdQueue.shift(),this.object===void 0)return;let n=new _s(this.object);if(n.playModeVisible=!0,n.expand(),this.data.coordinateSystem!=="world"){let s=this.data.coordinateSystem,o=this.page.scene.find(s);o&&(o.updateMatrixWorldSVD(),n.hiddenMatrix.copy(o.matrixWorldRigid))}n.position.fromArray(this.data.position),n.rotation.fromArray(this.data.rotation),n.updateMatrix(),this.page.add(n);let r=this.controlsManager.sharedGameControlGlobals;r.createdObjects.push(n),r.nCreatedPerAction[this.uniqueId]===void 0?r.nCreatedPerAction[this.uniqueId]=1:r.nCreatedPerAction[this.uniqueId]++,n.updateWorldMatrix(!0,!0),n.traverseObject(this.traverseObjectCB),rX(),this.controlsManager.requestRender()},this.traverseObjectCB=n=>{var a,l,c,h;n.hasNonUniformScale&&n.updateMatrixWorldSVD();let r;if(this.controlsManager.sharedGameControlGlobals.rapierWorld){if(n instanceof Pl)if(n.objectForSample){if(n.objectForSample.dataPatched.physics.fusedBody)return;r=n.object}else return n.object.dataPatched.physics.fusedBody===!0&&n.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(n instanceof _s)r=n.object;else if(r=n,(a=r.dataPatched.cloner)==null?void 0:a.hideBase)return!0}else{if(n instanceof Pl)return;n instanceof _s?r=n.object:r=n}this.data.destroy==="Time"?n.userData.lifetime=this.data.lifetime*1e3:this.data.destroy==="Quantity"&&(n.userData.quantity=this.data.destroyAfterQuantity,n.userData.actionId=this.uniqueId);let s=new L().fromArray(this.data.velocity),o=r.dataPatched;if(!(o.physics.enabled==="visibility"?!o.visible:!o.physics.enabled)&&(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(n,r,{fromCreate:!0,dynamic:this.data.dynamic}),this.data.destroy==="Collision"&&((l=n.rigidBody)==null||l.collider(0).setActiveEvents(1),n.userData.hasCollisionDestroy=!0),n.matrixWorld.decompose(pje,oX,mje),s.applyQuaternion(oX),this.data.velocity.some(u=>u!==0)&&this.data.dynamic&&((c=n.rigidBody)==null||c.setLinvel(s.divideScalar(this.controlsManager.pixelsPerMeter),!0))):("geometry"in n.object&&this.controlsManager.addBoundsTree(n),this.data.velocity.some(u=>u!==0)&&this.data.dynamic&&(n.userData.velocity=s)),((h=r.dataPatched.physics)==null?void 0:h.fusedBody)===!0))return!0},this.object=this.page.scene.find(this.data.object),rX(i)}dispose(){this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null),this.timeoutIdQueue.forEach(t=>window.clearTimeout(t)),this.dispatchThrottled.cancel(),this.page.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},bre=200,Q3=.02,K3=.3,gje=65;new L;var aX=new L,lX=new L,vje=new L,Xr=new L,Bs=new L,Xh=new L,aM=new $e,J3=new $e,yje=new $e;new $e;var Fo=new Zt,Au=new Zt,fc=new Nr(0,0,0,"YXZ"),xje=new L(1,0,0),yl=new L(0,1,0),_je=new L(0,0,1),Z3=new L(1,1,1),$3=new sa,wje=1,bje=.025,Sje=16e-6,cX=12,Aje=20,Lr=new Ya,Aa=new Zn,Mje={type:"requestRender"},Eje={type:"updateMatrix"},uX=Math.PI/6,dF=class extends is{constructor(t,e,i,n,r,s,o,a,l){var p;super(),this.object=t,this.domElement=e,this.data=i,this.gloabalPhysics=n,this.controlsManager=r,this.cameraFollow=s,this.camera=o,this.page=a,this.sharedAssets=l,this.enableDamping=!0,this.hiddenMatrix0=new $e,this.target0=new L,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.pixelsPerMeter=bre,this.euler0=new Nr(0,0,0,"YXZ"),this.position0Cam=new L,this.quat0Cam=new Zt,this.scale0Cam=new L,this.hiddenMatrix0Cam=new $e,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new Ya(new L(0,-40,0),new L(0,40,0)),matrix:new $e,position:new L,rotation:new Zt},this.euler=new Nr(0,0,0,"YXZ"),this.eulerDelta=new L,this.lastPosition=new L,this.lastCameraQuaternion=new Zt,this.lastCameraPosition=new L,this.PI_2=Math.PI/2,this.prevMouse=new he,this.velocityTarget=new L,this.velocity=new L,this.directionXZ=new L,this.rotVelocityStick=new L,this.rotVelocityTarget=new L,this.rotVelocity=new L,this.rotDirection=new L,this.nonColliderRotOffset=new $e,this.nonColliderPosOffset=new $e,this.firstPointerId=-1,this.rot=new L,this.path=[],this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new $e,this.objectToTarget=new L,this.objectToTarget0=new L,this.objectToCamXZ=new L,this.objectToCamXZ0=new L,this.targetToCamera=new L,this.targetToCamera0=new L,this.cameraPolarAxis0=new L,this.targetPos=new L,this.targetQuat=new Zt,this.lerpFactorPos=new L().setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new Zt,this.objXZQuatInv=new Zt,this.objXZRotMat=new $e,this.isFirstPerson=!1,this.actions={},this.didHit=!1,this.groundVelocity=new L,this.pushedVelocity=new L,this.groundYRotation=0,this.objectRealQuat=new Zt,this.colliderWorldQuat=new Zt,this.groundNormal=new L,this.groundTilt=new Zt,this.groundTiltInv=new Zt,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.navMeshPathDest=null,this.position=new L,this.quaternion=new Zt,this.scale=new L,this.initialAction=!0,this.onPointerDown=m=>{m.target!==this.domElement||this.firstPointerId!==-1||(this.firstPointerId=m.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),this.rotBy!=="keys"&&!qo&&(!C8||P8>=15.5)&&this.domElement.requestPointerLock(),this.prevMouse.set(m.clientX,m.clientY))},this.onPointerUp=m=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),m.pointerType==="mouse"&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=m=>{if(m.pointerId!==this.firstPointerId)return;let v=m.clientX-this.prevMouse.x,g=m.clientY-this.prevMouse.y;this.prevMouse.set(m.clientX,m.clientY),m.pointerType==="mouse"&&this.rotBy!=="keys"&&(C8&&P8<15.5&&!qo?(this.eulerDelta.y=-v*this.mouseOrbitSensitivity,this.eulerDelta.x=-g*this.mouseOrbitSensitivity):(this.eulerDelta.y=-m.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-m.movementY*this.mouseOrbitSensitivity)),m.pointerType!=="mouse"&&this.rotByTouch==="drag"&&(this.eulerDelta.y=-v*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-g*this.mouseOrbitSensitivity*5),this.controlsManager.requestRender()},this.onPointerlockChange=m=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?dF.isLocked=!0:dF.isLocked=!1},this.onPointerlockError=()=>{console.error("SPE.GameControls: Unable to use Pointer Lock API")},this.handleVisibilityChange=()=>{if(document!=null&&document.hidden)for(let m in this.movementState)this.movementState[m]=0},this.onKeyDown=m=>{!(m.target instanceof HTMLInputElement)&&(m.code==="ArrowLeft"||m.code==="ArrowUp"||m.code==="ArrowRight"||m.code==="ArrowDown"||m.code==="Space")&&m.preventDefault();for(let v of this.keyAssignments)if(m.key.toUpperCase()===v[1]||m.key===v[1]){this.movementState[v[0]]=1;break}this.controlsManager.requestRender()},this.onKeyUp=m=>{for(let v of this.keyAssignments)if(m.key.toUpperCase()===v[1]||m.key===v[1]||m.code.slice(3,m.code.length).toUpperCase()===v[1]){this.movementState[v[0]]=0;break}},this.copyVRGamePadValues=(m,v)=>{for(let g=2;g<4;g++){let y=m.axes[g];v===0?g===2?this.movementState.movePosX=y:this.movementState.movePosZ=y:(m.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,g===2?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(y)>=.3&&(this.vrEulerYOffset+=y<0?1:-1),this.movementState.rotPosY=y):this.moveMode==="fly"&&(this.movementState.moveNegY=y))}},this.sharedGameControlGlobals=r.sharedGameControlGlobals,t===o&&(this.isFirstPerson=!0),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.euler0.setFromQuaternion(this.quaternion,"YXZ");let c=this.euler0.clone(),h=c.y;if(this.objectRealQuat.copy(this.quaternion),c.y=0,this.quaternion.setFromEuler(c),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),c.set(0,h,0),this.quaternion.setFromEuler(c),this.rot.setFromEuler(c),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||this.cameraFollow===!0)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),this.cameraFollow===!0){this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy((p=this.camera)==null?void 0:p.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let m=new L(0,0,-1).applyQuaternion(this.camera.quaternion),v=new L().subVectors(this.position,this.camera.position);this.objectToCamXZ.copy(v),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ);let g,y;Math.abs(m.y)<1e-6?(v.y=0,m.y=0,y=v.projectOnVector(m)):v.y/m.y>0?y=m.multiplyScalar(v.y/m.y):y=m.multiplyScalar(v.length()),this.targetToCamera0.copy(y).negate(),g=this.camera.position.clone().add(y),this.objectToTarget0.subVectors(g,this.position);let x=new Nr().setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-x.x,x.x=0,x.z=0,x.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(x)}if(this.object instanceof js&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.rotByTouch=i.rotByTouch??"joystick",this.rotBy=i.rotBy??"keys",this.rotationMode=i.rotationMode??"normal",this.moveMode=i.moveMode??"walk",this.collisionEnabled=i.collisionEnabled,this.speedTranslate=(i.speedTranslate??250)*wje,this.speedOrbit=(i.speedRotate??100)*bje,this.mouseOrbitSensitivity=(i.speedRotate??100)*Sje,this.keyAssignments=i.keyAssignments.map(m=>{let v=[m[0],m[1]];return v[1]==="▲"?v[1]="ArrowUp":v[1]==="◀"?v[1]="ArrowLeft":v[1]==="▼"?v[1]="ArrowDown":v[1]==="▶"?v[1]="ArrowRight":v[1]==="⇧"?v[1]="Shift":v[1]==="↵"?v[1]="Enter":v[1]==="Space"?v[1]=" ":v[1]==="⌘"?v[1]="Meta":v[1]==="Ctrl"?v[1]="Control":v[1]==="Esc"&&(v[1]="Escape"),v}),i.rotBy==="mouse"){let m;m=this.keyAssignments.findIndex(v=>v[0]==="rotNegX"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(v=>v[0]==="rotPosX"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(v=>v[0]==="rotPosY"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(v=>v[0]==="rotNegY"),m!==-1&&(this.keyAssignments[m][1]="")}this.lerpFactorPosStart=1-.02**(1/((i.delayPos[0]??.3)*60)),this.lerpFactorPosEnd=1-.02**(1/((i.delayPos[1]??.3)*60)),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/((i.delayRot[0]??.3)*60)),this.lerpFactorRotEnd=1-.02**(1/((i.delayRot[1]??.3)*60)),this.lerpFactorPosCamera=1-.02**(1/((i.delayPosCamera??.3)*60)),this.lerpFactorRotCamera=1-.02**(1/((i.delayRotCamera??.3)*60)),this.gravity=(this.gloabalPhysics.gravity??X0.defaultData.gravity)*cX,this.usePhysics=this.gloabalPhysics.usePhysics??X0.defaultData.usePhysics,this.jumpPower=i.jumpPower*Aje,this.resetYPosition=this.position.y+Math.abs(i.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=i.alignToGround??!1,this.orientMode=i.autoOrientMove?i.orientMode:"none",this.orientWith=i.orientWith??RT.defaultDataThirdPerson.orientWith,this.slopeThresh=gje*Math.PI/180,i.collider.type==="capsule"?(this.collider.radius=i.collider.radius,this.collider.segment.start.y=i.collider.height/2-i.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=i.collider.height*Q3/this.pixelsPerMeter,this.stepThresh=i.collider.height*K3/this.pixelsPerMeter,this.colliderHeight=i.collider.height):i.collider.type==="sphere"?(this.collider.radius=i.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*i.collider.radius*Q3/this.pixelsPerMeter,this.stepThresh=2*i.collider.radius*K3/this.pixelsPerMeter,this.colliderHeight=i.collider.radius*2):(this.offset=i.collider.height*Q3/this.pixelsPerMeter,this.stepThresh=i.collider.height*K3/this.pixelsPerMeter,this.colliderHeight=i.collider.height),this.collider.type=i.collider.type;let u=new L().fromArray(i.collider.position),d=new Zt().setFromEuler(new Nr().fromArray([...i.collider.rotation,"XYZ"]));this.collider.position.copy(u).multiply(this.scale),this.collider.rotation.copy(d),this.collider.matrix.compose(u,d,Z3),i.cameraXAxis!==void 0&&(this.cameraXAxis=i.cameraXAxis,this.cameraYAxis=i.cameraYAxis,this.minPolarAngle=i.cameraRotXLimits[0],this.maxPolarAngle=i.cameraRotXLimits[1],this.minAzimuthAngleRel=i.cameraRotYLimits[0],this.maxAzimuthAngleRel=i.cameraRotYLimits[1]),this.forwardDir=i.forwardDirection??"-z",this.runMultiplier=i.runMultiplier??2;let f=i.navmesh.destinationHelperRadius*2;f>0&&(this.navMeshPathDest=new co(Aie.create({parameters:{width:f,height:f/10,hollow:.7}}),new ly({color:ms.toHex(i.navmesh.destinationHelperColor),transparent:!0,opacity:i.navmesh.destinationHelperColor.a})),this.navMeshPathDest.material.userData.opacity0=i.navmesh.destinationHelperColor.a),this.activate()}reset(t=!1){if(this.object.hiddenMatrix.copy(this.hiddenMatrix0),t){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity();let e=new Nr().setFromQuaternion(this.quaternion,"YXZ"),i=e.y;this.objectRealQuat.copy(this.quaternion),e.y=0,this.quaternion.setFromEuler(e),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),e.set(0,i,0),this.quaternion.setFromEuler(e),this.rot.setFromEuler(e),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}else this.object instanceof js?this.object.matrixAutoUpdate=!0:this.object.updateMatrix();this.cameraFollow===!0&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.controlsManager.requestRender()}activate(){this.instantiateActions(),this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.addEventListener("visibilitychange",this.handleVisibilityChange)}deactivate(){this.disposeActions(),this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.removeEventListener("visibilitychange",this.handleVisibilityChange)}dispose(){var t;this.deactivate(),(t=this.navMeshPathDest)!=null&&t.parent&&this.page.remove(this.navMeshPathDest)}instantiateActions(){let t=this.data,e=this.page,i=this.sharedAssets,n=this.object;t.gameActions!==void 0&&Object.entries(t.gameActions).forEach(([r,s],o)=>{s.forEach(({id:a,data:l})=>{try{this.actions[r]===void 0&&(this.actions[r]=[]),l.type==="Transition"?this.actions[r].push(new Y1(l,e,i)):l.type==="Animation"?this.actions[r].push(new Q1(l,e,this.controlsManager.eventManager.animationControls)):l.type==="Audio"?this.actions[r].push(new X1(a,l,n,i)):l.type==="Video"?this.actions[r].push(new Bz(a,l,n)):l.type==="Create"&&this.actions[r].push(new J1(l,e,this.controlsManager))}catch{}})}),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"),this.initialAction&&(this.initialAction=!1)}disposeActions(){this.initialAction=!1,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),oa(this.actions)}dispatchStartEvent(t){this.actions[t]!==void 0&&(this.actionState[t]||(this.actionState[t]=!0,this.actions[t].forEach(e=>{e instanceof Y1?e.play():e instanceof Q1?e.play(this.initialAction===!1):e instanceof J1?e.dispatchStart():e instanceof X1&&e.dispatchGameControl("start")})))}dispatchStopEvent(t){this.actions[t]!==void 0&&(!this.actionState[t]||(this.actionState[t]=!1,this.actions[t].forEach(e=>{e instanceof Y1?(e.stop(),e.object.currentState!==null&&e.object.changeSelectedState(null,{scene:this.page.scene,shared:this.sharedAssets})):e instanceof Q1||(e instanceof J1?e.dispatchStop():e instanceof X1&&e.dispatchGameControl("stop"))})))}get colliderWorldPosition(){return Xr.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.position)}update(t,e,i){var a,l,c,h,u,d,f,p,m,v,g;if(this.gravity<0?this.position.y<this.resetYPosition:this.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let n=(this.isFirstFrame?16.6:t)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let r=n*60,s=!1;if(this.usePhysics&&this.collisionEnabled){let y=Bs.set(0,(this.velocity.y===0?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/(10*cX),1)*(this.gravity>0?1:-1):this.velocity.y)*n,0).divideScalar(this.pixelsPerMeter),x=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,y,(a=this.object.rigidBody)==null?void 0:a.collider(0).shape,1,!1,16,void 0,void 0,this.object.rigidBody);if(x){this.onObject=!0,this.groundNormal.set(x.normal2.x,x.normal2.y,x.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(s=!0),((l=x.collider.parent())==null?void 0:l.bodyType())===0&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let b=x.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let S of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(S.rigidBody===b&&S.userData.isFollowingObj!==this.object.uuid){(S.hasNonUniformScale?S.matrixWorldRigid:S.matrixWorld).decompose(Xr,Au,Bs),this.groundVelocity.subVectors(Xr,S.prevT),this.object.getWorldPosition(Bs).add(this.collider.position).sub(Xr),this.groundYRotation=fc.setFromQuaternion(Au).y-S.prevR.y,Xh.copy(Bs).applyAxisAngle(yl,this.groundYRotation),this.groundVelocity.add(Xh.sub(Bs)).divideScalar(n);break}}else this.onObject=!1}if(this.moveMode==="walk"&&this.collisionEnabled&&(this.movementState.jump===1&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*r),this.moveMode==="fly"&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,this.forwardDir==="+z"&&this.directionXZ.multiplyScalar(-1),this.directionXZ.manhattanLength()>0&&(this.path=[]),this.navMeshPathDest){let y=this.navMeshPathDest.material;if(this.moveMode==="walk"&&this.path.length>1){this.navMeshPathDest.position.copy(this.path[this.path.length-1]),this.navMeshPathDest.parent||this.page.add(this.navMeshPathDest);let x=Xr.subVectors(this.path[1],this.position),b=Bs.subVectors(this.path[1],this.path[0]);x.dot(b)<0?this.path.shift():(this.directionXZ.x=b.x,this.directionXZ.z=b.z),y.opacity=y.userData.opacity0}else y.opacity-=.05*y.userData.opacity0,this.navMeshPathDest.material.opacity<=0&&this.navMeshPathDest.parent&&this.page.remove(this.navMeshPathDest)}this.directionXZ.normalize(),this.movementState.run?this.moveForce=this.runMultiplier:this.moveForce=1,this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce,this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce,(this.moveMode==="walk"?this.velocityTarget.x+this.velocityTarget.z===0:this.velocityTarget.manhattanLength()===0)?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.moveMode==="walk"&&(this.lerpFactorPos.y=1),this.didHit===!1&&this.pushedVelocity.manhattanLength()===0||this.usePhysics===!1?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**r),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**r),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**r)):this.velocity.copy(this.velocityTarget),(this.moveMode==="walk"?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.movementState.run?(this.dispatchStopEvent("move"),this.dispatchStartEvent("run")):(this.dispatchStopEvent("run"),this.dispatchStartEvent("move"))));let o=vje.copy(this.velocity);if(this.orientMode!=="none"&&this.isFirstPerson===!1){let y=Bs.copy(o);y.y=0,o.set(0,o.y,y.length()*(this.forwardDir==="+z"?1:-1))}if(this.directionXZ.manhattanLength()>0&&this.orientMode!=="none")if(this.orientWith==="camera"&&this.path.length<=1){let y=Xr;this.camera.getWorldDirection(y);let x=Xh.copy(yl).multiplyScalar(y.dot(yl));y.sub(x);let b=Bs.copy(this.directionXZ);b.x*=-1,this.rot.y=y.angleTo(b)*(y.cross(b).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera}else this.rot.y=(this.path.length>1?0:this.euler.y)+Math.atan2(-this.directionXZ.z,this.directionXZ.x)+Math.PI/2*(this.forwardDir==="+z"?1:-1);if(fc.setFromVector3(this.rot),this.moveMode==="walk"&&(fc.x=0),o.applyEuler(fc),s&&(Au.setFromUnitVectors(yl,this.groundNormal),o.applyQuaternion(Au)),i){let y=fc.set(0,this.vrEulerYOffset*uX,0);i.applyEuler(y),o.x+=i.x,o.z+=i.z,this.nonColliderPosOffset.elements[13]+=i.y*n}if(this.usePhysics===!0){let y=Bs;this.pushedVelocity.set(0,0,0);for(let x of this.sharedGameControlGlobals.entitiesWithTransformAnim){let b=Xh.setFromMatrixPosition(x.matrixWorld).sub(x.prevT).divideScalar(n).divideScalar(this.pixelsPerMeter),S=x.rigidBody.collider(0).castCollider(b,this.object.rigidBody.collider(0),Xr.copy(o).divideScalar(this.pixelsPerMeter),n,!1);b.multiplyScalar(this.pixelsPerMeter);let A=xi.is(x)?x:x.object;if(S!==null&&this.lastHitObj!==A){let E;x instanceof _s&&(E=x);let M=this.sharedGameControlGlobals.entityToCollisionEvents[A.uuid];if(M)for(let T of M)T.data.target==="character"&&(T.dispatch(E),A.dispatchEvent(mF));this.lastHitObj=A}if(S!==null){this.pushedVelocity.copy(b),y.copy(S.normal1).applyQuaternion(x.quaternion);break}}if(this.pushedVelocity.manhattanLength()!==0){let x=y.dot(o);x<0&&o.addScaledVector(y,-x),o.add(this.pushedVelocity)}else o.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),this.rotationMode==="normal"&&(this.movementState.rotPosX||this.movementState.rotNegX)||this.rotationMode==="steer"&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||this.moveMode==="walk")?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,this.rotationMode==="normal"&&(this.movementState.rotPosY||this.movementState.rotNegY)||this.rotationMode==="steer"&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(n),this.rotVelocityStick),this.rotVelocityTarget.manhattanLength()===0?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**r):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**r),this.euler.x+=this.rotVelocity.x*n,this.euler.y+=this.rotVelocity.y*n+this.groundYRotation,this.rotVelocityTarget.y===0&&this.directionXZ.manhattanLength()===0?this.rotationAccumWhenOrientWithCamera=0:(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*n),this.isFirstPerson===!1&&this.orientMode!=="none"&&this.directionXZ.manhattanLength()>0){if(this.orientMode==="radial"){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(yl,this.euler.y-this.euler0.y);let y=Bs.copy(this.objectToCamXZ).normalize(),x=Xh.copy(o).multiplyScalar(n);x.y=0;let b=x.sub(Xr.copy(y).multiplyScalar(x.dot(y))).cross(y).y;this.euler.y-=Math.atan2(b,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*n+this.groundYRotation,this.rotVelocityTarget.y!==0&&(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.euler.y=this.rot.y);if(this.cameraFollow===!0&&(this.moveMode==="walk"?this.cameraXAxis==="Limit"?this.euler.x=hi.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=hi.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):this.cameraXAxis==="Limit"&&(this.euler.x=hi.clamp(this.euler.x,-this.PI_2,this.PI_2))),this.moveMode==="fly"?this.rot.x=this.euler.x:this.isFirstPerson&&(e?(fc.copy(e),fc.y=0):(fc.copy(this.euler),fc.y=0),this.nonColliderRotOffset.makeRotationFromEuler(fc)),e&&(this.moveMode==="walk"?(this.rot.y=e.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(e),this.rot.y+=this.vrEulerYOffset*uX),Fo.setFromAxisAngle(xje,this.rot.x),Au.setFromAxisAngle(yl,this.rot.y),Au.multiply(Fo),Fo.setFromAxisAngle(_je,this.rot.z),Au.multiply(Fo),this.quaternion.copy(Au),this.objectRealQuat.multiplyQuaternions(this.quaternion,this.objXZQuat),this.objectRealQuat.multiply(this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){let y=Bs.copy(o).multiplyScalar(n/this.pixelsPerMeter),x=null;this.didHit=!1;let b=new L;for(let S=0;S<5;S++){let A=y.length(),E=Xh.copy(y).normalize();if(x=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(b),this.colliderWorldQuat,E,(c=this.object.rigidBody)==null?void 0:c.collider(0).shape,A,!1,24,void 0,void 0,this.object.rigidBody),x!==null){this.didHit=!0;let M=this.sharedGameControlGlobals.colliderToEntity.get(x.collider.handle);if(M!==this.lastHitObj&&S===0){this.lastHitObj=M;let U=this.sharedGameControlGlobals.entityToCollisionEvents[M==null?void 0:M.uuid];if(U){for(let F of U)if(F.data.target==="character"){let N=((h=this.sharedGameControlGlobals.rapierWorld)==null?void 0:h.getCollider(x.collider.handle))._parent,W;if(M.cloner){for(let Q of M.cloner.children)if(Q.rigidBody===N){W=Q;break}}F.dispatch(W),M.dispatchEvent(mF)}}}let T=aX.set(x.normal2.x,x.normal2.y,x.normal2.z).applyQuaternion(this.colliderWorldQuat),P=lX.copy(E).multiplyScalar(x.toi).dot(T),R=x.toi;if(R===0&&(this.position.y+=this.offset*this.pixelsPerMeter),P>this.offset&&(R=x.toi*(P-this.offset)/P,b.addScaledVector(E,R)),y.copy(E).multiplyScalar(A-R),Math.acos(-T.y)>this.slopeThresh){let U=this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(b),F=Xh.copy(x.witness2).applyQuaternion(this.colliderWorldQuat);F.y=0;let N=U.add(F);N.y+=this.stepThresh;let W=this.sharedGameControlGlobals.rapierWorld.castShape(N,this.colliderWorldQuat,y,(u=this.object.rigidBody)==null?void 0:u.collider(0).shape,1,!1,24,void 0,void 0,this.object.rigidBody);W!==null&&W.toi===0&&(T.y=0,T.normalize())}y.addScaledVector(T,-y.dot(T))}else{S===0&&this.directionXZ.manhattanLength()!==0&&(this.lastHitObj=null),b.add(y);break}}this.position.addScaledVector(b,this.pixelsPerMeter),(d=this.object.rigidBody)==null||d.setTranslation(Xr.copy(this.position).divideScalar(this.pixelsPerMeter),!0),(f=this.object.rigidBody)==null||f.setRotation(Fo.copy(this.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let y=this.onObject?1:5,x=o.multiplyScalar(n/y);for(let b=0;b<y;b++)this.position.add(x),b===0&&this.checkTrigger(),this.collisionAdjustment(n/y)}else this.position.addScaledVector(o,n);if(this.moveMode==="walk"&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.matrix.compose(this.position,this.quaternion,this.scale),this.object.matrixWorldNeedsUpdate=!0,this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),this.cameraFollow===!0){this.updateFollowArms();let y=this.objectToTarget.add(this.position),x=this.targetToCamera.add(y);aM.lookAt(x,y,yl).setPosition(x),aM.decompose(this.targetPos,this.targetQuat,Xr),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**r),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**r),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraYAxis==="Limit"&&this.orientMode==="cartesian"&&(this.euler.y=hi.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=hi.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.object.dispatchEvent(Eje),this.path.length<2&&this.lastPosition.distanceToSquared(this.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(this.camera===void 0||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate)&&(this.moveMode==="fly"||this.onObject===!0||this.collisionEnabled===!1)&&((m=(p=this.navMeshPathDest)==null?void 0:p.material)==null?void 0:m.opacity)<-.04*((g=(v=this.navMeshPathDest)==null?void 0:v.material)==null?void 0:g.userData.opacity0)?!1:(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.position),this.object.dispatchEvent(Mje),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let t=Fo.setFromAxisAngle(yl,this.cameraYAxis==="Limit"&&this.orientMode!=="radial"?hi.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&this.objectToTarget.applyQuaternion(t);let e;this.cameraXAxis==="Limit"?e=hi.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):e=hi.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let i=Xr.copy(this.cameraPolarAxis0);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&i.applyQuaternion(t);let n=Au.setFromAxisAngle(i,e);this.cameraYAxis!=="Locked"&&this.targetToCamera.applyQuaternion(t),this.cameraXAxis!=="Locked"&&this.targetToCamera.applyQuaternion(n)}groundTiltAdjustment(t){yl.angleTo(t)*180/Math.PI<15||yl.angleTo(t)*180/Math.PI>85?Fo.identity():Fo.setFromUnitVectors(yl,t),this.groundTilt.slerp(Fo,.06),this.groundTiltInv.copy(this.groundTilt).invert()}checkTrigger(){let t;for(let e=0;e<this.sharedGameControlGlobals.triggers.length;e++){let[i,n,r,s]=this.sharedGameControlGlobals.triggers[e];for(let o=0;o<this.sharedGameControlGlobals.entitiesWithTransformAnim.length;o++){let a=this.sharedGameControlGlobals.entitiesWithTransformAnim[o];if(r===a||s.isValidTriggeringObject(xi.is(a)?a:a.object)===!1)continue;let l=J3.copy(r.matrixWorld).decompose(Xr,Fo,Bs).compose(Xr,Fo,Z3).multiply(n),c=aM.copy(a.matrixWorld).invert().multiply(l);i instanceof Zn?t=a.bvhGeometry.boundsTree.intersectsBox(i,c):($3.radius=i,$3.center.setFromMatrixPosition(c),t=a.bvhGeometry.boundsTree.intersectsSphere($3)),t?s.currentIntersectedObjects.indexOf(a)===-1&&(s.currentIntersectedObjects.push(a),s.dispatch(),r.dispatchEvent(B6e)):s.currentIntersectedObjects=s.currentIntersectedObjects.filter(h=>h!==a)}}}collisionAdjustment(t){var r;let e=lX.set(0,0,0);this.object.matrix.compose(this.position,this.quaternion,this.scale);let i=aM.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(Xr,Fo,Bs).compose(Xr,Fo,Z3);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach(s=>{if(s===this.object||s.isDescendantOf(this.object))return;Aa.makeEmpty(),s.updateMatrixWorldSVD();let o=s.matrixWorldRigid,a=J3.copy(o).invert(),l=yje.copy(J3).multiply(i);Lr.copy(this.collider.segment),Lr.start.applyMatrix4(l),Lr.end.applyMatrix4(l);let c=aX.copy(this.position).applyMatrix4(a);Aa.expandByPoint(Lr.start),Aa.expandByPoint(Lr.end),Aa.min.addScalar(-this.collider.radius),Aa.max.addScalar(this.collider.radius),s.bvhGeometry.boundsTree.shapecast({traverseBoundsOrder(h){return h.distanceToPoint(Lr.end)},intersectsBounds:h=>h.intersectsBox(Aa),intersectsTriangle:h=>{let u=Xr,d=Bs,f=h.closestPointToSegment(Lr,u,d);if(f<this.collider.radius){let p=this.collider.radius-f,m=d.sub(u).normalize(),v=Xh.copy(c);v.addScaledVector(m,p);let g=v.applyMatrix4(o).sub(this.position);e.add(g),Lr.start.addScaledVector(m,p),Lr.end.addScaledVector(m,p)}}})}),Aa.makeEmpty(),Lr.copy(this.collider.segment),Lr.start.applyMatrix4(i),Lr.end.applyMatrix4(i),Aa.expandByPoint(Lr.start),Aa.expandByPoint(Lr.end),Aa.min.addScalar(-this.collider.radius),Aa.max.addScalar(this.collider.radius),(r=this.sharedGameControlGlobals.staticMeshBVH)==null||r.shapecast({traverseBoundsOrder(s){return s.distanceToPoint(Lr.end)},intersectsBounds:s=>s.intersectsBox(Aa),intersectsTriangle:s=>{let o=Xr,a=Bs,l=s.closestPointToSegment(Lr,o,a);if(l<this.collider.radius){let c=this.collider.radius-l,h=a.sub(o).normalize();this.alignToGround&&this.groundTiltAdjustment(h),e.addScaledVector(h,c),Lr.start.addScaledVector(h,c),Lr.end.addScaledVector(h,c)}}}),this.onObject=Math.abs(e.y)>Math.abs(t*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let n=Math.max(0,e.length()-1e-5);e.normalize().multiplyScalar(n),this.position.add(e)}},Sre=dF;Sre.isLocked=!1;var Tje=Rw(uee());function Gu(t,e){let i=new Ut;if(!t.getAttribute("position"))return i.setAttribute("position",new yt([],3)),i.setIndex([]),i;let{positions:n,triIndices:r}=v2(t.getAttribute("position"),t.getIndex());return i.setAttribute("position",new yt(n,3)),i.setIndex(r),e&&i.applyMatrix4(e),i}var Cje=new $e,Pje=new $e,pc=[[0,0,0],[0,0,0],[0,0,0]];function Are(t){let e=t.elements;pc[0][0]=e[0],pc[0][1]=e[4],pc[0][2]=e[8],pc[1][0]=e[1],pc[1][1]=e[5],pc[1][2]=e[9],pc[2][0]=e[2],pc[2][1]=e[6],pc[2][2]=e[10];let{u:i,v:n}=(0,Tje.SVD)(pc),r=Cje.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),s=Pje.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1);return r.multiply(s.transpose())}var Dje=class extends ete{constructor(){super(),this.layers.enable(3),this.layers.enable(8)}setFromCamera(t,e){e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,-1).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):e.isPerspectiveCamera?(this.ray.origin.set(t.x,t.y,-1).unproject(e),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):console.error("Raycaster: Unsupported camera type.")}intersectVisibleObjects(t,e=!0,i=[]){return t.forEach(n=>{n.visible&&this.intersectObject(n,e,i)}),i}createRaycastLineHelper(){let t=new ff({color:65280,linewidth:10}),e=new L(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),i=new L(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),n=this.camera.far-this.camera.near,r=new L().addVectors(e,i.multiplyScalar(n)),s=new Ut;return s.setFromPoints([e,r]),new iT(s,t)}},Mre=t=>t instanceof kT||t instanceof n0;function Rje(t,e){return t.distance-e.distance}function Ere(t,e,i){if(!(!zu(e)||!e.visible)){Ml(e)&&e.raycast(t,i);for(let n of e.children)Ere(t,n,i)}}function fF(t,e,i){if(!i.some(r=>VT(t,r)!==void 0))return[];let n=[];return e.children.forEach(r=>Ere(t,r,n)),n.sort(Rje),n}function pF(t){let e=[];if(t.length){let i=t[0].object;zu(i)&&e.push(i);let n=i.parent;for(;n;)Mre(n)&&e.push(n),n=n.parent}return e}function VT(t,e){if(Ml(e)){if(e.visible){let i=[];return e.raycast(t,i),i.length?i[0]:void 0}}else if(Mre(e))return Tre(t,e)}function Tre(t,e){if(!(!zu(e)||!e.visible)){if(Ml(e)){let i=[];if(e.raycast(t,i),i.length)return i[0]}for(let i of e.children){let n=Tre(t,i);if(n)return n}}}function Ije(t,e,i){return{x:(t-(i.left+window.scrollX))/i.width*2-1,y:-((e-(i.top+window.scrollY))/i.height)*2+1}}var Lje=class{constructor(t,e,i,n,r,s,o){this.renderer=t,this.publish=e,this.scene=i,this.getCamera=n,this.sharedAssets=r,this.requestRender=s,this.isExport=o,this.raycaster=new Dje,this.raycasterNeedsUpdate=!0,this._useWindowEvents=!1,this._useWindowEvents=e.mouseEventTarget==="window",this.domElement=t.domElement,this.eventElement=this._useWindowEvents?window:t.domElement}get stopRaycast(){return this.publish.stopRaycast}get page(){return this.scene.activePage}set useWindowEvents(t){this._useWindowEvents=t,this.eventElement=t?window:this.renderer.domElement}get useWindowEvents(){return this._useWindowEvents}updateRaycaster(t){var r;if(!this.raycasterNeedsUpdate)return;this.raycasterNeedsUpdate=!1;let{pageX:e,pageY:i}=((r=t.touches)==null?void 0:r.length)>0?t.touches[0]:t,n=this.domElement.getBoundingClientRect();this.raycaster.setFromCamera(Ije(e,i,n),this.getCamera())}},Cre=(t=>(t[t.keydown=0]="keydown",t[t.keyup=1]="keyup",t[t.pointerdown=2]="pointerdown",t[t.pointerup=3]="pointerup",t[t.pointermove=4]="pointermove",t[t.wheel=5]="wheel",t[t.scroll=6]="scroll",t))(Cre||{}),xh=class{constructor(t){this.eventContext=t,this.domEventsNeeded=new Set,this.hasVideoAction=!1}connect(){}disconnect(){}},Oz=[["start","Start"],["keyDown","KeyDown"],["keyUp","KeyUp"],["mouseDown","MouseDown"],["mouseUp","MouseUp"],["mouseHover","MouseHover"],["collision","Collision"],["lookAt","LookAt"],["follow","Follow"],["scroll","Scroll"]],Pre=t=>{var e;return(e=Oz.find(([i,n])=>n===t))==null?void 0:e[0]},Vw=t=>{var e;return(e=Oz.find(([i])=>i===t))==null?void 0:e[1]},Bje=(t,e)=>{let i=Pre(t);if(i){let n=new CustomEvent(i,{bubbles:!0});return Object.defineProperty(n,"target",{writable:!1,value:e}),n}},Oje=class extends xh{constructor(t){super(t),this.objectsPerEvents=new Map,this.splineEvents={},this.onBeginEvent=i=>{var s;if(!i.eventName||!i.target||i.eventName==="Scroll")return;let n=(s=this.splineEvents[Pre(i.eventName)])==null?void 0:s[i.target.uuid];if(!n)return;i.eventName==="Scroll"&&i.deltaY!==void 0&&Object.assign(n,{deltaY:i.deltaY});let{domElement:r}=this.eventContext;r.dispatchEvent(n)};let{page:e}=this.eventContext;e.traverseEntity(i=>{var n,r;if((n=i.data)!=null&&n.events.length){for(let[s,o]of Oz)if(i.data.events.some(a=>a.data.type===o&&!a.data.disabled)){this.objectsPerEvents.has(s)?(r=this.objectsPerEvents.get(s))==null||r.push(i):this.objectsPerEvents.set(s,[i]);let a={id:i.uuid,name:i.name},l=Bje(o,a),c=this.splineEvents[s];c?c[i.uuid]=l:this.splineEvents[s]={[i.uuid]:l}}}})}connect(){this.objectsPerEvents.forEach(t=>{t.forEach(e=>{e.addEventListener("beginEvent",this.onBeginEvent)})})}disconnect(){this.objectsPerEvents.forEach(t=>{t.forEach(e=>{e.removeEventListener("beginEvent",this.onBeginEvent)})})}},Fje=class{constructor(t,e,i,n,r,s){if(this.id=t,this.data=e,this.object=i,this.entered=!1,this.alreadyPlayedNonTogglingActions=new Set,this.useToggle=e.toggle,(e.type==="KeyDown"||e.type==="KeyUp"||e.type==="KeyPress")&&!e.key)throw new Error("Missing property");this.actions=il(e,e.actions,n,r,s,i)}disconnect(){oa(this.actions)}dispatchHeld(t){this.actions.Create.forEach(e=>{t&&e.dispatchThrottled.cancel(),e.dispatchThrottled()})}dispatch(t=!1){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this?(e.object.currentTransitionEvent=this,e.init()):this.useToggle===!1&&this.alreadyPlayedNonTogglingActions.add(e)}),this.useToggle?(this.actions.Transition.forEach(e=>{e.toggle()}),this.actions.Animation.forEach(e=>{e.toggle()}),this.actions.SwitchCamera.forEach(e=>{e.toggle()})):this.data.type==="MousePress"||this.data.type==="KeyPress"?this.entered||(this.entered=!0,this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.playFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent()),this.actions.Create.forEach(e=>e.dispatchStart())):(this.actions.Transition.some(e=>e.playing)||this.actions.Transition.forEach(e=>{this.alreadyPlayedNonTogglingActions.has(e)===!1&&e.play()}),this.actions.SwitchCamera.some(e=>e.playing)||this.actions.SwitchCamera.forEach(e=>{e.play()}),this.actions.Animation.forEach(e=>{e.play()})),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),t===!1&&this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()})}dispatchRelease(){this.entered&&(this.entered=!1,this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent()),this.actions.Create.forEach(t=>t.dispatchStop()))}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.playFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent())),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()})}},Nje=class extends xh{constructor(t,e){super(t),this.objectsPerTypes={MouseDown:[],MouseUp:[],MousePress:[],KeyDown:[],KeyUp:[],KeyPress:[]},this.canvasMouseEvents=[],this.windowMouseEvents=[],this.eventsPerObjects={MouseDown:{},MouseUp:{},MousePress:{},KeyDown:{},KeyUp:{},KeyPress:{}},this.heldKeys={},this.heldKeysPress={},this._prevObjects=[],this.onWindowMouseDown=r=>{(r.target===this.eventContext.domElement||r.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(s=>{(s.data.type==="MouseDown"||s.data.type==="MousePress")&&s.dispatch()}),this.windowMouseEvents.forEach(s=>{(s.data.type==="MouseDown"||s.data.type==="MousePress")&&s.dispatch()})},this.onWindowMouseUp=r=>{(r.target===this.eventContext.domElement||r.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(s=>{s.data.type==="MouseUp"?s.dispatch():s.data.type==="MousePress"&&s.dispatchRelease()}),this.windowMouseEvents.forEach(s=>{s.data.type==="MouseUp"?s.dispatch():s.data.type==="MousePress"&&s.dispatchRelease()})},this.onMouseDown=r=>{Ot.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseEvent("MouseDown"))},this.onMouseUp=r=>{Ot.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseEvent("MouseUp"))},this.onMousePressDown=r=>{Ot.length>1||(this.eventContext.updateRaycaster(r),this.handleMousePressEvent())},this.onMousePressRelease=r=>{Ot.length>1||(this.eventContext.updateRaycaster(r),this.handleMousePressEvent(!0))},this.onKeyDown=r=>{this.heldKeys[r.key]||(this.handleKeyEvent(r,"KeyDown"),this.handleKeyEventHeld(r,"KeyDown",!0)),this.heldKeys[r.key]=!0},this.onKeyUp=r=>{this.handleKeyEvent(r,"KeyUp"),this.handleKeyEventHeld(r,"KeyUp",!0)},this.onKeyPressDown=r=>{this.heldKeysPress[r.key]?this.handleKeyEventHeld(r,"KeyPress"):(this.handleKeyEvent(r,"KeyPress"),this.handleKeyEventHeld(r,"KeyPress",!0)),this.heldKeysPress[r.key]=!0},this.onKeyPressUp=r=>{this.handleKeyEvent(r,"KeyPress",!0)},this.releaseHeldKey=r=>{delete this.heldKeys[r.key]},this.releaseHeldKeyPress=r=>{delete this.heldKeysPress[r.key]},this._onUserEvent=({eventName:r,target:s,reverse:o})=>{var l,c,h,u;if(!r||!s)return;let a=Vw(r);a&&(a==="MouseDown"||a==="MouseUp"||a==="MousePress"?(s.dispatchEvent({type:"beginEvent",eventName:a}),(c=(l=this.eventsPerObjects[a])==null?void 0:l[s.uuid])==null||c.forEach(d=>{d.dispatchUserEvent(o)})):(a==="KeyDown"||a==="KeyUp"||a==="KeyPress")&&(s.dispatchEvent({type:"beginEvent",eventName:a}),(u=(h=this.eventsPerObjects[a])==null?void 0:h[s.uuid])==null||u.forEach(d=>{d.dispatchUserEvent()})))};let{page:i,sharedAssets:n}=this.eventContext;i.traverseEntity(r=>{var o,a;if(!((o=r.data)!=null&&o.events.length))return;let s=["MouseDown","MouseUp","MousePress","KeyDown","KeyUp","KeyPress"];for(let l of s){let c=this.eventsPerObjects[l];r.data.events.filter(({data:h})=>h.type===l&&h.disabled!==!0).forEach(({id:h,data:u})=>{try{let d=new Fje(h,u,r,i,n,e);d.actions.Video.length&&(this.hasVideoAction=!0),(u.type==="MouseDown"||u.type==="MouseUp"||u.type==="MousePress")&&(u.mode==="Canvas"||u.mode==="Window")?u.mode==="Canvas"&&this.canvasMouseEvents.push(d):c[r.uuid]?c[r.uuid].push(d):c[r.uuid]=[d]}catch{}}),(a=c[r.uuid])!=null&&a.length&&this.objectsPerTypes[l].push(r)}})}connect(){var e,i,n,r,s,o;let{domElement:t}=this.eventContext;this.heldKeys={},this.heldKeysPress={},this.domEventsNeeded.clear(),typeof window<"u"&&(window.addEventListener("pointerdown",this.onWindowMouseDown,{capture:!0}),window.addEventListener("pointerup",this.onWindowMouseUp,{capture:!0})),(e=this.objectsPerTypes.MouseDown)!=null&&e.length&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseDown)),(i=this.objectsPerTypes.MouseUp)!=null&&i.length&&(this.domEventsNeeded.add("pointerup"),t.addEventListener("pointerup",this.onMouseUp)),(n=this.objectsPerTypes.MousePress)!=null&&n.length&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMousePressDown),this.domEventsNeeded.add("pointerup"),t.addEventListener("pointerup",this.onMousePressRelease)),(r=this.objectsPerTypes.KeyDown)!=null&&r.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.releaseHeldKey)),(s=this.objectsPerTypes.KeyUp)!=null&&s.length&&(this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyUp)),(o=this.objectsPerTypes.KeyPress)!=null&&o.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyPressDown),document.addEventListener("keyup",this.releaseHeldKeyPress),this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyPressUp)),Object.entries(this.objectsPerTypes).forEach(([a,l])=>{l.forEach(c=>{c.addEventListener("userEvent",this._onUserEvent)})})}disconnect(){let{domElement:t}=this.eventContext;this.domEventsNeeded.clear(),this.heldKeys={},this.heldKeysPress={},typeof window<"u"&&(window.removeEventListener("pointerdown",this.onWindowMouseDown,{capture:!0}),window.removeEventListener("pointerup",this.onWindowMouseUp,{capture:!0})),t.removeEventListener("pointerdown",this.onMouseDown),t.removeEventListener("pointerdown",this.onMousePressDown),t.removeEventListener("pointerup",this.onMouseUp),t.removeEventListener("pointerup",this.onMousePressRelease),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyPressDown),document.removeEventListener("keyup",this.onKeyPressUp),document.removeEventListener("keyup",this.releaseHeldKey),Object.values(this.eventsPerObjects).forEach(e=>{Object.values(e).forEach(i=>{i.forEach(n=>{n.disconnect()})})}),this.canvasMouseEvents.forEach(e=>{e.disconnect()}),Object.entries(this.objectsPerTypes).forEach(([e,i])=>{i.forEach(n=>{n.removeEventListener("userEvent",this._onUserEvent)})})}handleMouseEvent(t){let{stopRaycast:e,raycaster:i,page:n}=this.eventContext,r=this.objectsPerTypes[t];if(r.length)if(e){let s=fF(i,n,r);pF(s).forEach(o=>{this.eventsPerObjects[t][o.uuid]&&this.handleObjectMouseEventDispatch(o,t)})}else r.forEach(s=>{VT(i,s)&&this.handleObjectMouseEventDispatch(s,t)})}handleMousePressEvent(t=!1){let e="MousePress",i=this.objectsPerTypes[e],n=[];if(i.length){if(!t){let{stopRaycast:r,raycaster:s,page:o}=this.eventContext;if(r){let a=fF(s,o,i);n=pF(a)}else i.forEach(a=>{VT(s,a)&&n.push(a)})}this._prevObjects.length&&this._prevObjects.forEach(r=>{n.includes(r)||this.handleObjectMouseEventDispatchRelease(r,e)}),n.length&&n.forEach(r=>{this.handleObjectMouseEventDispatch(r,e)}),this._prevObjects=n}}handleObjectMouseEventDispatch(t,e){var i,n;t.dispatchEvent({type:"beginEvent",eventName:e}),(n=(i=this.eventsPerObjects[e])==null?void 0:i[t.uuid])==null||n.forEach(r=>{r.dispatch()})}handleObjectMouseEventDispatchRelease(t,e){var i,n;t.dispatchEvent({type:"beginEvent",eventName:e}),(n=(i=this.eventsPerObjects[e])==null?void 0:i[t.uuid])==null||n.forEach(r=>{r.dispatchRelease()})}handleKeyEvent(t,e,i=!1){this.objectsPerTypes[e].forEach(n=>{let r=this.eventsPerObjects[e][n.uuid];r.some(({data:s})=>"key"in s&&s.key===t.key)&&n.dispatchEvent({type:"beginEvent",eventName:e}),r.forEach(s=>{"key"in s.data&&s.data.key===t.key&&(i?s.dispatchRelease():s.dispatch(!0))})})}handleKeyEventHeld(t,e,i=!1){this.objectsPerTypes[e].forEach(n=>{this.eventsPerObjects[e][n.uuid].forEach(r=>{"key"in r.data&&r.data.key===t.key&&r.dispatchHeld(i)})})}},Uje=new L,kje=new L,Dre=class{constructor(t,e,i,n,r){this.actionsIn=il(t,t.inActions,i,n,r,e),this.actionsOut=il(t,t.outActions,i,n,r,e)}disconnect(){oa(this.actionsIn),oa(this.actionsOut)}},zje=class extends Dre{constructor(t,e,i,n,r,s){super(e,i,n,r,s),this.id=t,this.data=e,this.object=i,this.stage="out",this.objects=[],this.onUpdateMatrix=()=>{let c=Uje.setFromMatrixPosition(this.objects[0].matrixWorld),h=kje.setFromMatrixPosition(this.objects[1].matrixWorld),u=c.distanceTo(h)<=this.distance?"in":"out";if(this.stage!==u){let d=u==="in"?this.actionsIn:this.actionsOut;d.Audio.forEach(f=>f.dispatchConditional()),d.Video.forEach(f=>f.dispatchConditional()),d.Link.forEach(f=>f.dispatch()),d.Create.forEach(f=>f.dispatch()),d.Destroy.forEach(f=>f.dispatch()),d.Reset.forEach(f=>f.dispatch()),d.Transition.forEach(f=>{f.object.currentTransitionEvent!==this&&(f.object.currentTransitionEvent=this),f.init()}),d.Transition.forEach(f=>f.play()),d.Animation.forEach(f=>f.play()),d.SwitchCamera.forEach(f=>f.play()),d.SceneTransition.forEach(f=>f.dispatch()),this.stage=u}};let{distance:o,fromObject:a,toObject:l}=e.condition;this.distance=o;for(let c of[a,l]){if(!c)throw new Error("Missing property");let h=n.find(c);if(!h)throw new Error("Missing property");this.objects.push(h)}}connect(){window.setTimeout(()=>{this.objects.forEach(t=>{t.addEventListener("updateMatrix",this.onUpdateMatrix)}),this.onUpdateMatrix()},0)}disconnect(){super.disconnect(),this.stage="out",this.objects.forEach(t=>{t.removeEventListener("updateMatrix",this.onUpdateMatrix)})}},Gje=class extends Dre{constructor(t,e,i,n,r,s){var l;super(e,i,n,r,s),this.id=t,this.data=e,this.object=i,this.onBegin=({target:c,state:h})=>{this.toState!==h&&(this.actionsOut.Audio.forEach(u=>u.dispatchConditional()),this.actionsOut.Video.forEach(u=>u.dispatchConditional()),this.actionsOut.Link.forEach(u=>u.dispatch()),this.actionsOut.Create.forEach(u=>u.dispatch()),this.actionsOut.Destroy.forEach(u=>u.dispatch()),this.actionsOut.Reset.forEach(u=>u.dispatch()),this.actionsIn.Transition.forEach(u=>u.pause()),this.object.currentTransitionEvent=this,this.actionsOut.Transition.forEach(u=>u.play()),this.actionsOut.Animation.forEach(u=>u.play()),this.actionsIn.SwitchCamera.forEach(u=>u.pause()),this.actionsOut.SwitchCamera.forEach(u=>u.play()),this.actionsOut.SceneTransition.forEach(u=>u.dispatch()))},this.onComplete=({target:c,state:h})=>{this.toState===h&&(this.actionsIn.Audio.forEach(u=>u.dispatchConditional()),this.actionsIn.Video.forEach(u=>u.dispatchConditional()),this.actionsIn.Link.forEach(u=>u.dispatch()),this.actionsIn.Create.forEach(u=>u.dispatch()),this.actionsIn.Destroy.forEach(u=>u.dispatch()),this.actionsIn.Reset.forEach(u=>u.dispatch()),this.actionsOut.Transition.forEach(u=>u.pause()),this.actionsOut.Transition.forEach(u=>u.pause()),this.object.currentTransitionEvent=this,this.actionsIn.Transition.forEach(u=>u.play()),this.actionsIn.Animation.forEach(u=>u.play()),this.actionsOut.SwitchCamera.forEach(u=>u.pause()),this.actionsIn.SwitchCamera.forEach(u=>u.play()),this.actionsIn.SceneTransition.forEach(u=>u.dispatch()))};let{condition:o}=e;if(!o.object)throw new Error("Missing property");let a=n.find(o.object);if(!a)throw new Error("Missing property");if(this.toObject=a,o.state&&!((l=this.toObject.states)!=null&&l[o.state]))throw new Error("Missing property");this.toState=o.state}connect(){(this.actionsOut.Audio.length||this.actionsOut.Video.length||this.actionsOut.Create.length||this.actionsOut.Destroy.length||this.actionsOut.Transition.length||this.actionsOut.Animation.length||this.actionsOut.SwitchCamera.length||this.actionsOut.SceneTransition.length)&&this.toObject.addEventListener("beginState",this.onBegin),(this.actionsIn.Audio.length||this.actionsIn.Video.length||this.actionsOut.Create.length||this.actionsIn.Destroy.length||this.actionsIn.Transition.length||this.actionsIn.Animation.length||this.actionsIn.SwitchCamera.length||this.actionsIn.SceneTransition.length)&&this.toObject.addEventListener("completeState",this.onComplete)}disconnect(){super.disconnect(),(this.actionsOut.Audio.length||this.actionsOut.Video.length||this.actionsOut.Create.length||this.actionsOut.Destroy.length||this.actionsOut.Transition.length||this.actionsOut.Animation.length||this.actionsOut.SwitchCamera.length||this.actionsOut.SceneTransition.length)&&this.toObject.removeEventListener("beginState",this.onBegin),(this.actionsIn.Audio.length||this.actionsIn.Video.length||this.actionsOut.Create.length||this.actionsIn.Destroy.length||this.actionsIn.Transition.length||this.actionsIn.Animation.length||this.actionsIn.SwitchCamera.length||this.actionsIn.SceneTransition.length)&&this.toObject.removeEventListener("completeState",this.onComplete)}},Hje=class extends xh{constructor(t,e){super(t),this.eventsPerConditions={Comparison:[],Distance:[],State:[]},this.hasVideoAction=!1;let{page:i,sharedAssets:n}=this.eventContext;i.traverseEntity(r=>{var s;if((s=r.data)!=null&&s.events.length){for(let{id:o,data:a}of r.data.events)if(!a.disabled&&a.type==="Conditional")try{let l;a.condition.type==="Comparison"||(a.condition.type==="Distance"?l=new zje(o,a,r,i,n,e):a.condition.type==="State"&&(l=new Gje(o,a,r,i,n,e))),l&&(this.eventsPerConditions[a.condition.type].push(l),(l.actionsIn.Video.length||l.actionsOut.Video.length)&&(this.hasVideoAction=!0))}catch{}}})}connect(){super.connect(),Object.values(this.eventsPerConditions).forEach(t=>t.forEach(e=>e.connect()))}disconnect(){super.disconnect(),Object.values(this.eventsPerConditions).forEach(t=>t.forEach(e=>e.disconnect()))}},Hx=new L,qh=new L,Wf=new L,hX=new zo,Vje=.01,Ii=new L,yr=new L,dX=new L,Cp=new Zt,eI=new Nr,jje=new $e,tI=new Zr,kg=new L,mc=new L,zg=.2;function iI(t,e){!e||(e[0]<e[1]&&(t.x=Math.min(Math.max(t.x,e[0]),e[1])),e[2]<e[3]&&(t.y=Math.min(Math.max(t.y,e[2]),e[3])),e[4]<e[5]&&(t.z=Math.min(Math.max(t.z,e[4]),e[5])))}var Wje=function(){let t=new $e;return(e,i,n)=>{let r=e.obj;t.copy(r.hiddenMatrix),r.parent!==null&&t.premultiply(r.parent.matrixWorld),t.invert(),r.position.copy(i),e.reference==="global"&&iI(r.position,e.limits),r.position.applyMatrix4(t),e.reference==="parent"?iI(r.position,e.limits):e.reference==="local"&&(Cp.copy(e.quat0).invert(),r.position.sub(e.position0),r.position.applyQuaternion(Cp),iI(r.position,e.limits),Cp.invert(),r.position.applyQuaternion(Cp),r.position.add(e.position0)),t.multiply(n??r.matrixWorld).decompose(Ii,r.quaternion,yr),r.updateMatrix(),r.hasNonUniformScale&&(r.updateMatrixWorld(),r.updateMatrixWorldSVD()),r instanceof Mo&&Ju(r.parent)&&r.invalidateDownstreamBooleanData(!0)}}(),Xje=class{constructor(t,e,i,n,r,s){this.object=t,this.data=e,this.dropDestIds=[],this.activeIdx=null,this.wasDragEventTriggered=!1,this.resetDampingFactor=this.data.resetSpeed===0?1:8/this.data.resetSpeed+1,this.snapDampingFactor=this.data.snapSpeed===0?1:8/this.data.snapSpeed+1,this.actionsDrag=il(e,e.dragDropActions.drag,i,n,r,this.object),this.actionsDrop=il(e,e.dragDropActions.drop,i,n,r,this.object);let o=[];this.data.objects.forEach(a=>{let l=i.find(a);!l||l.data.visible!==!1&&(o.push(l),s[l.uuid]&&s[l.uuid].forEach(c=>{let h=i.find(c);!h||h.data.visible!==!1&&o.push(h)}))}),this.data.dropDestinations.forEach(a=>{let l=i.find(a);!l||l.data.visible!==!1&&(this.dropDestIds.push(l.uuid),s[l.uuid]&&s[l.uuid].forEach(c=>{let h=i.find(c);!h||h.data.visible!==!1&&this.dropDestIds.push(h.uuid)}))}),this.dragItems=o.map(a=>(this.data.planeMode==="locked"&&(a.userData.lockedPlane=!0),a.userData.worldPosition0=new L().setFromMatrixPosition(a.matrixWorld),{obj:a,fromPosition:new L().setFromMatrixPosition(a.matrixWorld),pointStart:new L,pointEnd:new L,paused:!0,currentDampingFactor:this.data.dampingFactor,reset:!1,position0:new L().copy(a.position),quat0:new Zt().copy(a.quaternion),snapped:!1,orientationMatrix:new $e,limits:this.data.limits,reference:this.data.referenceFrame}))}get activeDragItem(){return this.activeIdx!==null?this.dragItems[this.activeIdx]:null}dispose(){oa(this.actionsDrag),oa(this.actionsDrop),this.dragItems.forEach(t=>{t.fromPosition.copy(t.obj.userData.worldPosition0),t.pointStart.copy(t.fromPosition),t.pointEnd.copy(t.pointStart),t.obj.recursiveBBoxNeedsUpdate=!0,t.obj.userData.lockedPlane=void 0,t.obj.position.copy(t.position0),t.obj.quaternion.copy(t.quat0),t.obj.updateMatrix()})}},qje=class extends xh{constructor(t,e){super(t),this.eventManager=e,this.events=[],this.lastDropDestination=null,this.dragTimeout=null,this.onPointerDown=n=>{var a;if(Ot.length>1)return;this.eventContext.updateRaycaster(n);let{raycaster:r,page:s}=this.eventContext,o=s.raycastWithClones(r);if(this.lastDropDestination=null,o.length===0){this.activeEvent=null;return}for(let l of this.events){let c=0;for(let{obj:h,pointEnd:u,pointStart:d}of l.dragItems){if(h===o[0].object||h===o[0].object.object||xi.is(h)&&h.isAncestorOf(o[0].object.uuid)){if(l.activeIdx=c,l.activeDragItem.reset=!1,l.activeDragItem.currentDampingFactor=l.data.dampingFactor,l.activeDragItem.snapped=!1,l.data.cursor==="hand"&&this.setCursor("grabbing"),this.eventManager.controlsManager.usePhysics){l.activeDragItem.obj.rigidBody&&l.activeDragItem.obj.rigidBody.setBodyType(2,!0);let f=l.activeDragItem.obj;h.hasNonUniformScale&&h.updateMatrixWorldSVD(),(f.hasNonUniformScale?f.matrixWorldRigid:f.matrixWorld).decompose(Ii,Cp,yr),eI.setFromQuaternion(Cp),f.prevR===void 0?(f.prevR=eI.clone(),f.prevT=Ii.clone()):(f.prevR.copy(eI),f.prevT.copy(Ii)),this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.push(l.activeDragItem.obj)}this.calcPlaneIntersectPos(h,d,l.data.plane,l.data.referenceFrame),u.copy(d),(this.eventManager.controlsManager.usePhysics&&((a=h.data.physics)==null?void 0:a.rigidBody)==="dynamic"||l.data.drop===!1||l.data.resetOnSnapFail===!1)&&l.activeDragItem.fromPosition.setFromMatrixPosition(l.activeDragItem.obj.matrixWorld),this.activeEvent=l,this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1);return}c++}}this.activeEvent=null},this.onPointerMove=n=>{var a,l,c,h;if(Ot.length>1)return;this.eventContext.updateRaycaster(n);let{raycaster:r,page:s}=this.eventContext,o=s.raycastWithClones(r);if(Ot.length===0){let u=!1;for(let d of this.events){for(let{obj:f}of d.dragItems)if(f===((a=o[0])==null?void 0:a.object)||f===((c=(l=o[0])==null?void 0:l.object)==null?void 0:c.object)||xi.is(f)&&f.isAncestorOf((h=o[0])==null?void 0:h.object.uuid)){switch(u=!0,d.data.cursor){case"hand":this.setCursor("grab");break;case"move":this.setCursor("move");break}break}if(u)break}u||this.setCursor("default");return}if(this.activeEvent&&this.activeEvent.activeDragItem){let u=this.activeEvent.activeDragItem;u.snapped=!1;let d;if(this.activeEvent.data.drop&&(d=o.filter(f=>u.obj!==f.object&&!u.obj.isAncestorOf(f.object.uuid)&&!(f.object instanceof kT)&&(this.activeEvent.data.dropOn==="all"||this.activeEvent.dropDestIds.some(p=>p===f.object.uuid||s.scene.find(p).isAncestorOf(f.object.uuid))))[0]),d){let f=dX.copy(d.face.normal).applyMatrix3(tI.getNormalMatrix(d.object.matrixWorld));if(this.activeEvent.data.snapTo==="center")u.fromPosition.setFromMatrixPosition(d.object.matrixWorld);else if(this.activeEvent.data.snapTo==="surface"){if(u.fromPosition.copy(d.point),this.activeEvent.data.snapSurfaceMode==="bbox"){Ii.copy(f).applyMatrix3(tI.setFromMatrix4(u.obj.matrixWorld).transpose());let p=u.obj;Ii.x>zg?yr.x=-p.recursiveBBox.min.x:Ii.x<-zg&&(yr.x=-p.recursiveBBox.max.x),Ii.y>zg?yr.y=-p.recursiveBBox.min.y:Ii.y<-zg&&(yr.y=-p.recursiveBBox.max.y),Ii.z>zg?yr.z=-p.recursiveBBox.min.z:Ii.z<-zg&&(yr.z=-p.recursiveBBox.max.z),yr.applyMatrix3(tI.invert())}else yr.copy(f).multiplyScalar(this.activeEvent.data.snapSurfaceOffset);u.fromPosition.add(yr)}this.activeEvent.data.autoOrient&&(Ii.set(0,1,0).cross(f),Ii.length()<1e-4&&Ii.set(-1,0,0).cross(f),yr.crossVectors(dX,Ii),u.orientationMatrix.makeBasis(Ii,yr,f)),u.pointStart.copy(u.fromPosition),u.pointEnd.copy(u.pointStart),u.currentDampingFactor=this.activeEvent.snapDampingFactor,u.snapped=!0,this.lastDropDestination!==d.object&&(this.lastDropDestination=d.object,this.activeEvent.actionsDrop.Transition.forEach(p=>{p.play()}),this.activeEvent.actionsDrop.Animation.forEach(p=>{p.play()}),this.activeEvent.actionsDrop.Audio.forEach(p=>{p.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Create.forEach(p=>{p.dispatchThrottled()}))}else u.orientationMatrix.makeRotationFromQuaternion(u.quat0),this.lastDropDestination=null,u.currentDampingFactor=this.activeEvent.data.dampingFactor,this.calcPlaneIntersectPos(u.obj,u.pointEnd,this.activeEvent.data.plane,this.activeEvent.data.referenceFrame),this.activeEvent.actionsDrop.Transition.forEach(f=>{f.stop(),f.object.currentState!==null&&f.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrop.Animation.forEach(f=>{f.stop()}),this.activeEvent.actionsDrop.Audio.forEach(f=>{f.dispatchGameControl("stop")});this.activeEvent.actionsDrag.Create.forEach(f=>{f.dispatchThrottled()}),this.activeEvent.wasDragEventTriggered===!1&&(this.activeEvent.wasDragEventTriggered=!0,this.activeEvent.actionsDrag.Transition.forEach(f=>{f.play()}),this.activeEvent.actionsDrag.Animation.forEach(f=>{f.play()}),this.activeEvent.actionsDrag.Audio.forEach(f=>{f.dispatchGameControl("start")})),this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout(()=>{!this.activeEvent||(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Audio.forEach(f=>{f.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Transition.forEach(f=>{f.stop(),f.object.currentState!==null&&f.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(f=>{f.stop()}))},500),this.updateDragItem(u),u.obj.dispatchEvent({type:"requestRender"})}},this.onPointerUp=n=>{var r;if(this.activeEvent&&this.activeEvent.activeDragItem){this.activeEvent.data.cursor==="hand"&&this.setCursor("grab");let s=((r=this.activeEvent.activeDragItem.obj.data.physics)==null?void 0:r.rigidBody)==="dynamic";this.activeEvent.activeDragItem.snapped===!1&&this.activeEvent.data.drop&&this.activeEvent.data.resetOnSnapFail&&(this.eventManager.controlsManager.usePhysics===!1||!s)&&(this.activeEvent.activeDragItem.reset=this.activeEvent.data.resetOnSnapFail,this.activeEvent.activeDragItem.paused=!1,this.activeEvent.activeDragItem.currentDampingFactor=this.activeEvent.resetDampingFactor),this.eventManager.controlsManager.usePhysics&&s&&(this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.pop(),this.activeEvent.activeDragItem.obj.rigidBody.setBodyType(0,!0),this.activeEvent.activeDragItem.paused=!0),this.activeEvent.wasDragEventTriggered===!0&&(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Transition.forEach(o=>{o.stop(),o.object.currentState!==null&&o.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(o=>{o.stop()}),this.activeEvent.actionsDrag.Audio.forEach(o=>{o.dispatchGameControl("stop")})),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0)}};let i={};t.page.traverseEntity(n=>{n.component&&(i[n.component.uuid]?i[n.component.uuid].push(n.uuid):i[n.component.uuid]=[n.uuid])}),t.page.traverseEntity(n=>{var r;(r=n.data)==null||r.events.filter(s=>s.data.type==="DragDrop"&&!s.data.disabled).forEach(s=>{this.events.push(new Xje(n,s.data,t.page,t.sharedAssets,e,i))})})}connect(){if(!this.events.length)return;this.domEventsNeeded.clear(),this.domEventsNeeded.add("pointerdown");let t=this.eventContext.domElement;t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUp),this.domEventsNeeded.add("pointermove")}disconnect(){if(!this.events.length)return;this.domEventsNeeded.clear();let t=this.eventContext.domElement;t.removeEventListener("pointerdown",this.onPointerDown),t.removeEventListener("pointermove",this.onPointerMove),t.removeEventListener("pointerup",this.onPointerUp),this.events.forEach(e=>e.dispose())}setCursor(t){this.eventContext.domElement.style.cursor=t}onAnimationFrameDamping(){for(let t of this.events)for(let e of t.dragItems)e.paused||this.updateDragItem(e,!0)}calcPlaneIntersectPos(t,e,i,n){let{getCamera:r,raycaster:s}=this.eventContext;r().getWorldDirection(qh),qh.negate();let o=Cp.identity();switch(n==="parent"?jje.multiplyMatrices(t.parent.matrixWorld,t.hiddenMatrix).decompose(Ii,o,yr):n==="local"&&t.matrixWorld.decompose(Ii,o,yr),i){case"x":Ii.set(1,0,0).applyQuaternion(o),kg.copy(qh).cross(Ii),mc.copy(Ii).cross(kg);break;case"y":Ii.set(0,1,0).applyQuaternion(o),kg.copy(qh).cross(Ii),mc.copy(Ii).cross(kg);break;case"z":Ii.set(0,0,1).applyQuaternion(o),kg.copy(qh).cross(Ii),mc.copy(Ii).cross(kg);break;case"xy":mc.set(0,0,1).applyQuaternion(o);break;case"yz":mc.set(1,0,0).applyQuaternion(o);break;case"xz":mc.set(0,1,0).applyQuaternion(o);break;case"adaptive":qh.angleTo(yr.set(0,1,0))>Math.PI/6?(Ii.crossVectors(yr.set(0,1,0),qh),mc.crossVectors(Ii,yr)):mc.set(0,1,0);break;default:mc.copy(qh);break}Wf.setFromMatrixPosition(t.matrixWorld);let a=t.userData.lockedPlane?t.userData.worldPosition0:Wf;if(hX.setFromNormalAndCoplanarPoint(mc,a),!!s.ray.intersectPlane(hX,e)&&(i==="x"||i==="y"||i==="z")){let l=yr.subVectors(e,a).dot(Ii);e.copy(a).addScaledVector(Ii,l)}}updateDragItem(t,e=!1){var i,n;Wf.setFromMatrixPosition(t.obj.matrixWorld),t.reset==="current"?Hx.subVectors(t.fromPosition,Wf).divideScalar(t.currentDampingFactor):t.reset==="original"?(Hx.subVectors(t.obj.userData.worldPosition0,Wf).divideScalar(t.currentDampingFactor),t.fromPosition.copy(t.obj.userData.worldPosition0),t.pointStart.copy(t.fromPosition),t.pointEnd.copy(t.pointStart)):Hx.subVectors(t.pointEnd,t.pointStart).add(t.fromPosition).sub(Wf).divideScalar(t.currentDampingFactor),t.paused=t.currentDampingFactor>1?Hx.length()<Vje:!0,(this.activeEvent&&this.activeEvent.data.dampingFactor===1||e)&&Wje(t,Hx.add(Wf),(i=this.activeEvent)!=null&&i.data.drop&&((n=this.activeEvent)!=null&&n.data.autoOrient)?t.orientationMatrix:null),t.obj.dispatchEvent({type:"beginEvent",eventName:"DragDrop"}),this.eventManager.requestRender()}},Gg=new L,nI=new L,Mu=new L,Eu=new L,fX=new zo,Yje=.01,Qje={type:"requestRender"},Kje=function(){let t=new L,e=new L;return(i,n,r)=>r>0?(t.subVectors(i,n),t.length()<=r?i:e.copy(n).add(t.normalize().multiplyScalar(r))):n}(),pX=function(){let t=new $e;return(e,i)=>{e.position.copy(i),e.parent!==null&&(t.copy(e.parent.matrixWorld).invert(),e.position.applyMatrix4(t)),t.copy(e.hiddenMatrix).invert(),e.position.applyMatrix4(t),e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),e instanceof Mo&&Ju(e.parent)&&e.invalidateDownstreamBooleanData(!0)}}(),Jje=class{constructor(t,e,i,n,r){this.data=t,this.object=e,this.paused=!1,this.currentDampingFactor=1,this.snapComplete=!1,this.isReset=!1,this.worldPosition0=new L,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...lO.defaultData,...t,...t.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},t.target===void 0||t.target==="cursor"||(this.target=i.find(t.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.resetDampingFactor=80/this.data.resetSpeed+1,this.object.getWorldPosition(this.worldPosition0),this.actions=il(t,t.actions,i,n,r,e)}},Zje=class extends xh{constructor(t,e){super(t),this.events=[],this.pairOfEventListeners=[],this.onMouseMove=n=>{if(!(Ot.length>1)){this.eventContext.updateRaycaster(n);for(let r of this.events)r.target===void 0&&this.updateSingleEvent(r)}},this.onMouseEnter=n=>{for(let r of this.events)r.target===void 0&&(r.isReset=!1,r.currentDampingFactor=r.data.dampingFactor)},this.onMouseLeave=n=>{for(let r of this.events)r.target===void 0&&(r.data.resetOnPointerLeave&&(r.isReset=!0,r.currentDampingFactor=r.resetDampingFactor),this.updateSingleEvent(r))},this.onTargetChange=n=>()=>{this.updateSingleEvent(n)};let{page:i}=this.eventContext;i.traverseEntity(n=>{var s,o;let r=(s=n.data)==null?void 0:s.events.find(a=>a.data.type==="Follow"&&!a.data.disabled);r&&(!i.data.globalPhysics.usePhysics||((o=n.dataPatched.physics)==null?void 0:o.rigidBody)!=="dynamic")&&this.events.push(new Jje(r.data,n,i,t.sharedAssets,e))})}connect(){if(!this.events.length)return;let{domElement:t,eventElement:e}=this.eventContext;this.domEventsNeeded.clear(),qo&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),e.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents||(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events)if(i.target!==void 0){let n=i.target,r=this.onTargetChange(i);this.pairOfEventListeners.push([n,r]),n.addEventListener("requestRender",r)}}disconnect(){if(!this.events.length)return;let{domElement:t,eventElement:e}=this.eventContext;this.domEventsNeeded.clear(),qo&&t.removeEventListener("pointerdown",this.onMouseMove),e.removeEventListener("pointermove",this.onMouseMove),t.removeEventListener("pointerenter",this.onMouseEnter),t.removeEventListener("pointerleave",this.onMouseLeave);for(let[i,n]of this.pairOfEventListeners)i.removeEventListener("requestRender",n);for(let i of this.events)i.paused=!0,i.isReset=!1,oa(i.actions)}onAnimationFrameDamping(){for(let t of this.events)t.paused||this.updateSingleEvent(t,!0)}updateSingleEvent(t,e=!1){var o;this.events.forEach(a=>{a.actions.Create.forEach(l=>{l.dispatchThrottled()})});let{plane:i,limitDistance:n,limitDistanceEnabled:r}=t.data;if(t.object.getWorldPosition(Mu),t.isReset)Eu.copy(t.worldPosition0);else if(t.target)t.target.getWorldPosition(Eu);else{let{getCamera:a,raycaster:l}=this.eventContext;if(i==="custom"?(a().getWorldDirection(nI),nI.negate(),Gg.copy(nI)):i==="xy"?Gg.set(0,0,1):i==="xz"?Gg.set(0,1,0):i==="yz"&&Gg.set(1,0,0),fX.setFromNormalAndCoplanarPoint(Gg,Mu),!l.ray.intersectPlane(fX,Eu))return}if(!t.isReset){if(Eu.distanceTo(t.worldPosition0)>n&&r&&t.target)if(t.snapComplete=!1,t.data.snapDelay&&(t.delayFinished=!1,typeof window<"u"&&t.timeoutId!==null&&(window.clearTimeout(t.timeoutId),t.timeoutId=null)),t.wasOutside=!0,t.data.resetAfterDistanceLimit)Eu.copy(t.worldPosition0),t.currentDampingFactor=t.resetDampingFactor;else return;else if(t.wasOutside&&(t.data.snapDelay&&typeof window<"u"&&(t.timeoutId=window.setTimeout(()=>{t.delayFinished=!0,t.paused=!1,this.updateSingleEvent(t)},t.data.snapDelay*1e3)),t.currentDampingFactor=t.data.dampingFactor,t.wasOutside=!1),t.delayFinished===!1)return}t.data.enabledTranslation[0]===!1&&(Eu.x=Mu.x),t.data.enabledTranslation[1]===!1&&(Eu.y=Mu.y),t.data.enabledTranslation[2]===!1&&(Eu.z=Mu.z);let s=Kje(Mu,Eu,t.wasOutside?0:t.data.maxDelta);if(t.currentDampingFactor>1){let a=Gg.subVectors(s,Mu).divideScalar(t.currentDampingFactor);Mu.add(a),e&&pX(t.object,Mu),t.paused=a.length()<Yje}else pX(t.object,s),t.paused=!0;(o=t.object)==null||o.dispatchEvent({type:"beginEvent",eventName:"Follow"}),t.object.dispatchEvent(Qje)}},Vx=new L,lM=new L,jx=new $e,Hg=new Zt,Yh=new Zt,Wx=new L,Xx=new L,Xf=new L,Tu=new L,rI=new zo,$je=1e-6,e6e={type:"requestRender"},t6e={type:"changeRotation"},mX=function(){let t=new $e;return function(e,i){e.parent!==null?t.multiplyMatrices(e.parent.matrixWorld,e.hiddenMatrix):t.copy(e.hiddenMatrix),i.premultiply(Are(t).invert()),e.rotation.setFromRotationMatrix(i),e.updateMatrix(),e instanceof Mo&&Ju(e.parent)&&e.invalidateDownstreamBooleanData(!0)}}(),i6e=class{constructor(t,e,i){this.object=e,this.paused=!1,this.currentDampingFactor=1,this.isReset=!1,this.worldQuaternion0=new Zt,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...cO.defaultData,...t,...t.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},t.target===void 0||t.target==="cursor"||(this.target=i.find(t.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.object.getWorldQuaternion(this.worldQuaternion0),this.resetDampingFactor=80/this.data.resetSpeed+1}},n6e=class extends xh{constructor(t){super(t),this.events=[],this.pairOfEventListeners=[],this.pairOfUserEventListeners=[],this.onMouseMove=i=>{if(!(Ot.length>1)){this._lastMouseEvent=i,this.eventContext.updateRaycaster(i);for(let n of this.events)n.target===void 0&&this.updateSingleEvent(n)}},this.onMouseEnter=i=>{for(let n of this.events)n.target===void 0&&(n.isReset=!1,n.currentDampingFactor=n.data.dampingFactor)},this.onMouseLeave=i=>{for(let n of this.events)n.target===void 0&&(n.data.resetOnPointerLeave&&(n.isReset=!0,n.currentDampingFactor=n.resetDampingFactor),this.updateSingleEvent(n))},this.onScroll=i=>{if(this._lastMouseEvent){let n=new PointerEvent("pointermove",{clientX:this._lastMouseEvent.clientX,clientY:this._lastMouseEvent.clientY,bubbles:!0,cancelable:!0,view:window});this.eventContext.eventElement.dispatchEvent(n)}},this.onTargetChange=i=>()=>{this.updateSingleEvent(i)},this.createUserEventListener=i=>({eventName:n,target:r})=>{if(!n||!r)return;let s=Vw(n);s&&s==="LookAt"&&this.updateSingleEvent(i)};let{page:e}=this.eventContext;e.traverseEntity(i=>{var r,s;let n=(r=i.data)==null?void 0:r.events.find(o=>o.data.type==="LookAt"&&!o.data.disabled);n&&(!e.data.globalPhysics.usePhysics||((s=i.dataPatched.physics)==null?void 0:s.rigidBody)!=="dynamic")&&this.events.push(new i6e(n.data,i,e))})}connect(){if(!this.events.length)return;let{domElement:t,eventElement:e}=this.eventContext;this.domEventsNeeded.clear(),qo&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),e.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents?e.addEventListener("scroll",this.onScroll):(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events){if(i.target!==void 0){let s=this.onTargetChange(i),o=i.target;this.pairOfEventListeners.push([o,s]),o.addEventListener("requestRender",s)}let n=this.createUserEventListener(i),r=i.object;this.pairOfUserEventListeners.push([r,n]),r.addEventListener("userEvent",n)}}disconnect(){if(!this.events.length)return;let{domElement:t,eventElement:e}=this.eventContext;this.domEventsNeeded.clear(),qo&&t.removeEventListener("pointerdown",this.onMouseMove),e.removeEventListener("pointermove",this.onMouseMove),t.removeEventListener("pointerenter",this.onMouseEnter),t.removeEventListener("pointerleave",this.onMouseLeave),e.removeEventListener("scroll",this.onScroll);for(let[i,n]of this.pairOfEventListeners)i.removeEventListener("requestRender",n);for(let[i,n]of this.pairOfUserEventListeners)i.removeEventListener("userEvent",n);for(let i of this.events)i.paused=!0,i.isReset=!1}onAnimationFrameDamping(){for(let t of this.events)t.paused||this.updateSingleEvent(t)}updateSingleEvent(t){var d;let{tilt:e,axis:i,distance:n,plane:r,limitDistance:s,enabledRotation:o,limitDistanceEnabled:a}=t.data,{getCamera:l,raycaster:c}=this.eventContext,{object:h,target:u}=t;if(h.getWorldPosition(Wx),!t.isReset)if(t.target)t.target.getWorldPosition(Xx);else{if(r==="custom"?(l().getWorldDirection(lM),lM.negate(),rI.setFromNormalAndCoplanarPoint(lM,Wx)):(r==="xy"?Vx.set(0,0,1):r==="xz"?Vx.set(0,1,0):r==="yz"&&Vx.set(1,0,0),rI.setFromNormalAndCoplanarPoint(Vx,Wx)),!c.ray.intersectPlane(rI,Xx))return;n>0&&(r==="custom"||r===void 0)&&Xx.addScaledVector(lM,n)}if(t.isReset||(u?e==="target"?Xf.copy(u.up).applyMatrix4(jx.extractRotation(u.matrixWorld)).normalize():o.some(f=>f===!1)?(i==="x"?(Tu.set(0,0,1),o[2]===!1&&Tu.set(0,1,0)):i==="y"?(Tu.set(1,0,0),o[0]===!1&&Tu.set(0,0,1)):(Tu.set(0,1,0),o[1]===!1&&Tu.set(1,0,0)),Xf.copy(Tu).applyQuaternion(t.worldQuaternion0).normalize()):Xf.set(0,1,0):r==="custom"?Xf.set(0,1,0):Xf.copy(Vx)),t.isReset)Yh.copy(t.worldQuaternion0);else if(Wx.distanceTo(Xx)>s&&a&&u)if(t.data.snapDelay&&(t.delayFinished=!1,typeof window<"u"&&t.timeoutId!==null&&(window.clearTimeout(t.timeoutId),t.timeoutId=null)),t.wasOutside=!0,t.data.resetAfterDistanceLimit)Yh.copy(t.worldQuaternion0),t.currentDampingFactor=t.resetDampingFactor;else return;else{if(t.wasOutside&&(t.data.snapDelay&&typeof window<"u"&&(t.timeoutId=window.setTimeout(()=>{t.delayFinished=!0,t.paused=!1,this.updateSingleEvent(t)},t.data.snapDelay*1e3)),t.currentDampingFactor=t.data.dampingFactor,t.wasOutside=!1),t.delayFinished===!1)return;r6e(jx,Xx,Wx,Xf,i,Tu),Yh.setFromRotationMatrix(jx),Hg.setFromUnitVectors(Tu.applyQuaternion(Yh),Xf),o.some(f=>f===!1)&&e!=="target"&&Yh.premultiply(Hg).normalize()}t.currentDampingFactor>1?(h.updateWorldMatrix(!0,!1),Hg.setFromRotationMatrix(Are(h.matrixWorld)),Hg.slerp(Yh,1/t.currentDampingFactor),mX(h,jx.makeRotationFromQuaternion(Hg)),t.paused=8*(1-Hg.dot(Yh))<$je):(mX(h,jx.makeRotationFromQuaternion(Yh)),t.paused=!0),(d=t.object)==null||d.dispatchEvent({type:"beginEvent",eventName:"LookAt"}),h.dispatchEvent(e6e),h.dispatchEvent(t6e)}},Ma=new L,vr=new L,Xn=new L;function r6e(t,e,i,n,r,s){let o=t.elements;Xn.subVectors(e,i),Xn.lengthSq()===0&&(Xn.z=1),Xn.normalize(),vr.crossVectors(n,Xn),vr.lengthSq()===0&&(Math.abs(n.z)===1?Xn.x+=1e-4:Xn.z+=1e-4,Xn.normalize(),vr.crossVectors(n,Xn)),vr.normalize(),Ma.crossVectors(Xn,vr),r==="x"?s.z===1?[vr,Ma,Xn]=[Xn,vr,Ma]:(vr.negate(),[vr,Xn]=[Xn,vr]):r==="y"?s.x===1?[vr,Ma,Xn]=[Ma,Xn,vr]:(vr.negate(),[Ma,Xn]=[Xn,Ma]):s.x===1&&(vr.negate(),[vr,Ma]=[Ma,vr]),o[0]=vr.x,o[4]=Ma.x,o[8]=Xn.x,o[1]=vr.y,o[5]=Ma.y,o[9]=Xn.y,o[2]=vr.z,o[6]=Ma.z,o[10]=Xn.z}var s6e=class{constructor(t,e,i,n,r,s){this.id=t,this.data=e,this.object=i,this.entered=!1,this.actions=il(e,e.actions,n,r,s,i)}disconnect(){oa(this.actions)}dispatchEnter(){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.entered||(this.entered=!0,this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.play()),this.actions.Create.forEach(t=>t.dispatch()),this.actions.Destroy.forEach(t=>t.dispatch()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent()),this.actions.SceneTransition.forEach(t=>t.dispatch()))}dispatchLeave(){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.entered&&(this.entered=!1,this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent()))}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.playFromCurrent()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent())),this.actions.SceneTransition.forEach(e=>e.dispatch())}},o6e=class extends xh{constructor(t,e){super(t),this.eventsPerObjects={},this.objects=[],this._prevObjects=[],this.onMouseDown=r=>{Ot.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseHoverEvent())},this.onMouseUp=r=>{Ot.length>1||this.handleMouseHoverEvent(!0)},this.onMouseMove=r=>{Ot.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseHoverEvent())},this.onUserEvent=({eventName:r,target:s,reverse:o})=>{var l;if(!r||!s)return;let a=Vw(r);a&&a==="MouseHover"&&(s.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(l=this.eventsPerObjects[s.uuid])==null||l.forEach(c=>c.dispatchUserEvent(o)))};let{page:i,sharedAssets:n}=this.eventContext;i.traverseEntity(r=>{var s,o;if(!(!r.visible||!((s=r.data)!=null&&s.events.length))){for(let{id:a,data:l}of r.data.events)if(!l.disabled&&l.type==="MouseHover")try{let c=new s6e(a,l,r,i,n,e);this.eventsPerObjects[r.uuid]?this.eventsPerObjects[r.uuid].push(c):this.eventsPerObjects[r.uuid]=[c]}catch{}(o=this.eventsPerObjects[r.uuid])!=null&&o.length&&this.objects.push(r)}})}connect(){if(!this.objects.length)return;let{domElement:t}=this.eventContext;this.domEventsNeeded.clear(),qo&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseDown),this.domEventsNeeded.add("pointerup"),t.addEventListener("pointerup",this.onMouseUp)),this.domEventsNeeded.add("pointermove"),t.addEventListener("pointermove",this.onMouseMove),this.objects.forEach(e=>{e.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if(!this.objects.length)return;let{domElement:t}=this.eventContext;this.domEventsNeeded.clear(),qo&&(t.removeEventListener("pointerdown",this.onMouseDown),t.removeEventListener("pointerup",this.onMouseUp)),t.removeEventListener("pointermove",this.onMouseMove),Object.values(this.eventsPerObjects).forEach(e=>{e.forEach(i=>{i.disconnect()})}),this.objects.forEach(e=>{e.removeEventListener("userEvent",this.onUserEvent)})}handleMouseHoverEvent(t=!1){let e=[];if(!t){let{stopRaycast:i,raycaster:n,page:r}=this.eventContext;if(i){let s=fF(n,r,this.objects);e=pF(s)}else this.objects.forEach(s=>{VT(n,s)&&e.push(s)})}this._prevObjects.length&&this._prevObjects.forEach(i=>{var n;e.includes(i)||(i.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(n=this.eventsPerObjects[i.uuid])==null||n.forEach(r=>r.dispatchLeave()))}),e.length&&e.forEach(i=>{var n;i.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(n=this.eventsPerObjects[i.uuid])==null||n.forEach(r=>r.dispatchEnter())}),this._prevObjects=e}},a6e=class{constructor(t,e,i,n,r,s){this.id=t,this.data=e,this.object=i,this.scrollCounter=0,this.actions=il(e,e.actions,n,r,s,i)}connect(){this.scrollCounter=0}disconnect(){oa(this.actions)}dispatch(t){this.actions.Transition.forEach(n=>{n.object.currentTransitionEvent!==this&&(n.object.currentTransitionEvent=this,n.init())});let e=t>0?1:-1;this.scrollCounter+=e,this.scrollCounter=Math.min(Math.max(this.scrollCounter,0),this.data.steps);let i=this.scrollCounter/this.data.steps;this.actions.Transition.forEach(n=>n.seek(i)),this.actions.Animation.forEach(n=>n.seek(e)),this.actions.Create.forEach(n=>n.dispatchThrottled())}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>{e.playFromCurrent()}),this.actions.Animation.forEach(e=>{e.playFromCurrent()})),this.actions.Create.forEach(e=>e.dispatchThrottled())}},l6e=class{constructor(t,e,i,n,r,s,o){this.id=t,this.data=e,this.object=i,this.domElement=s,this.eventManager=o,this.scrollStart=0,this.scrollEnd=0,this.actions=il(e,e.actions,n,r,o,i)}computeScrollBounds(){let t=this.domElement.getBoundingClientRect(),e=document.body,i=document.documentElement,n=window.pageYOffset||i.scrollTop||e.scrollTop,r=i.clientTop||e.clientTop||0,s=Math.round(t.top+n-r);if(this.data.startFrom==="enter"){let o=window.innerHeight,a=t.height,l=this.data.enterAnchor,c=l==="top"?o:l==="bottom"?o-a:o-a*.5;this.scrollStart=s-c}else this.scrollStart=0;this.scrollStart+=this.data.startOffset??0,this.scrollEnd=this.scrollStart+(this.data.endAfter??400),this.dispatch({x:window.scrollX,y:window.scrollY})}connect(){this.computeScrollBounds()}disconnect(){oa(this.actions)}handleResize(){this.computeScrollBounds()}dispatch({x:t,y:e}){this.actions.Transition.forEach(r=>{r.object.currentTransitionEvent!==this&&(r.object.currentTransitionEvent=this,r.init())});let i=this.scrollEnd-this.scrollStart,n=Math.min(1,Math.max(0,(e-this.scrollStart)/i));this.actions.Transition.forEach(r=>r.seek(n)),this.actions.Animation.forEach(r=>r.seek(n)),this.actions.Create.forEach(r=>r.dispatchThrottled())}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>{e.playFromCurrent()}),this.actions.Animation.forEach(e=>{e.playFromCurrent()})),this.actions.Create.forEach(e=>e.dispatchThrottled())}},c6e=class extends xh{constructor(t,e){super(t),this.wheelEventsPerObject=new Map,this.scrollEventsPerObject=new Map,this.isInview=!0,this.handleResize=()=>{[...this.scrollEventsPerObject.entries()].forEach(([o,a])=>{a.forEach(l=>l.handleResize())})},this.onScroll=o=>{if(!this.isInview)return;let a={y:window.scrollY,x:window.scrollX};[...this.scrollEventsPerObject.entries()].forEach(([l,c])=>{l.dispatchEvent({type:"beginEvent",eventName:"Scroll",scroll:a}),c.forEach(h=>h.dispatch(a))})},this.onWheel=o=>{!this.isInview||o.ctrlKey||[...this.wheelEventsPerObject.entries()].forEach(([a,l])=>{a.dispatchEvent({type:"beginEvent",eventName:"Scroll",deltaY:o.deltaY}),l.forEach(c=>c.dispatch(o.deltaY))})},this.onUserEvent=({eventName:o,target:a,reverse:l})=>{var h;if(!o||!a)return;let c=Vw(o);c&&c==="Scroll"&&(a.dispatchEvent({type:"beginEvent",eventName:"Scroll"}),(h=this.wheelEventsPerObject.get(a))==null||h.forEach(u=>{u.dispatchUserEvent(l)}))};let{page:i,sharedAssets:n,domElement:r,isExport:s}=this.eventContext;i.traverseEntity(o=>{var a,l,c;if((a=o.data)!=null&&a.events.length){for(let{id:h,data:u}of o.data.events)if(!u.disabled&&u.type==="Scroll")if(u.trigger==="load"||!s){let d=new a6e(h,u,o,i,n,e);this.wheelEventsPerObject.has(o)?(l=this.wheelEventsPerObject.get(o))==null||l.push(d):this.wheelEventsPerObject.set(o,[d])}else{let d=new l6e(h,u,o,i,n,r,e);this.scrollEventsPerObject.has(o)?(c=this.scrollEventsPerObject.get(o))==null||c.push(d):this.scrollEventsPerObject.set(o,[d])}}}),this.intersectionObserver=new IntersectionObserver(o=>{let a=o[0];a&&(this.isInview=a.isIntersecting)},{root:null})}connect(){this.intersectionObserver.observe(this.eventContext.domElement),[...this.wheelEventsPerObject.entries()].forEach(([t,e])=>{e.forEach(i=>i.connect()),t.addEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([t,e])=>{e.forEach(i=>i.connect()),t.addEventListener("userEvent",this.onUserEvent)}),[...this.wheelEventsPerObject.values()].some(t=>t.length)&&(this.domEventsNeeded.add("wheel"),window.addEventListener("wheel",this.onWheel)),[...this.scrollEventsPerObject.values()].some(t=>t.length)&&(this.domEventsNeeded.add("scroll"),window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.handleResize))}disconnect(){window.removeEventListener("wheel",this.onWheel),window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.handleResize),this.intersectionObserver.unobserve(this.eventContext.domElement),this.domEventsNeeded.clear(),[...this.wheelEventsPerObject.entries()].forEach(([t,e])=>{e.forEach(i=>i.disconnect()),t.removeEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([t,e])=>{e.forEach(i=>i.disconnect()),t.removeEventListener("userEvent",this.onUserEvent)})}},u6e=class{constructor(t,e,i,n,r,s){this.id=t,this.data=e,this.object=i,this.actions=il(e,e.actions,n,r,s,i)}disconnect(){oa(this.actions)}dispatch(){this.actions.Transition.forEach(t=>{t.play()}),this.actions.Animation.forEach(t=>{t.play()}),this.actions.SwitchCamera.forEach(t=>{t.play()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatchFromStart()}),this.actions.Destroy.forEach(t=>{t.dispatchFromStart()})}dispatchAfter(t){this.actions.Audio.forEach(e=>{(e.interaction.data.triggerAfter??"any")===t&&(e.interaction instanceof Tp?e.interaction.audioPlayer.play():e.interaction instanceof lF&&e.interaction.dispatch())}),this.actions.Video.forEach(e=>{let i=e.interaction.data.triggerAfter??"autoplay";i===t&&(e.interaction instanceof r0?e.interaction.play(i==="autoplay"):e.interaction instanceof hF&&e.interaction.dispatch())})}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.playFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent())),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch()}),this.actions.Audio.forEach(e=>{e.interaction instanceof Tp?e.interaction.audioPlayer.play():e.interaction instanceof lF&&e.interaction.dispatch()}),this.actions.Video.forEach(e=>{e.interaction instanceof r0?e.interaction.play():e.interaction instanceof hF&&e.interaction.dispatch()})}},h6e=class extends xh{constructor(t,e){super(t),this.eventManager=e,this.eventsPerObject=new Map,this.eventsAfterPerObject=new Map,this.onMouseDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(r=>{r.dispatchAfter("mouseDown")})})},this.onKeyDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(r=>{r.dispatchAfter("keyDown")})})},this.onAny=()=>{let{domElement:i,isExport:n}=this.eventContext;(n?document:i).removeEventListener("pointerdown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([r,s])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),s.forEach(o=>{o.dispatchAfter("any")})})},this.onSceneTransitionAudioVideoPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(r=>{r.actions.Audio.forEach(s=>{s.interaction instanceof Tp&&s.interaction.audioPlayer.play()}),r.actions.Video.forEach(s=>{let o=s.interaction.data.triggerAfter??"autoplay";s.interaction instanceof r0&&s.interaction.play(o==="autoplay")})})})},this.onPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(r=>{r.dispatchAfter("autoplay")})})},this.onUserEvent=({eventName:i,target:n,reverse:r})=>{var o,a;if(!i||!n)return;let s=Vw(i);s&&s==="Start"&&(n.dispatchEvent({type:"beginEvent",eventName:"Start"}),(o=this.eventsPerObject.get(n))==null||o.forEach(l=>{l.dispatchUserEvent(r)}),(a=this.eventsAfterPerObject.get(n))==null||a.forEach(l=>{l.dispatchUserEvent(r)}))}}connect(){let{sharedAssets:t,page:e}=this.eventContext;if(e.traverseEntity(i=>{var n,r,s,o;if((n=i.data)!=null&&n.events.length)for(let{id:a,data:l}of i.data.events){if(l.disabled||l.type!=="Start")continue;let c=new u6e(a,l,i,e,t,this.eventManager);(c.actions.Transition.length||c.actions.Animation.length||c.actions.SwitchCamera.length||c.actions.Create.length||c.actions.Destroy.length||c.actions.SceneTransition.length)&&(this.eventsPerObject.has(i)?(r=this.eventsPerObject.get(i))==null||r.push(c):this.eventsPerObject.set(i,[c])),c.actions.Audio.length&&(this.eventsAfterPerObject.has(i)?(s=this.eventsAfterPerObject.get(i))==null||s.push(c):this.eventsAfterPerObject.set(i,[c])),c.actions.Video.length&&(this.hasVideoAction=!0,this.eventsAfterPerObject.has(i)?(o=this.eventsAfterPerObject.get(i))==null||o.push(c):this.eventsAfterPerObject.set(i,[c]))}}),[...this.eventsAfterPerObject.values()].some(i=>i.length)){if(this.eventManager.activateCount===0){let{domElement:i,isExport:n}=this.eventContext,r=n?document:i;r.addEventListener("pointerdown",this.onMouseDown,{once:!0}),document.addEventListener("keydown",this.onKeyDown,{once:!0}),r.addEventListener("pointerdown",this.onAny),document.addEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([s,o])=>{s.addEventListener("userEvent",this.onUserEvent)})}else this.onSceneTransitionAudioVideoPlay();this.onPlay()}[...this.eventsPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(r=>r.dispatch()),i.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if([...this.eventsAfterPerObject.values()].some(t=>t.length)){let{domElement:t,isExport:e}=this.eventContext,i=e?document:t;i.removeEventListener("pointerdown",this.onMouseDown),document.removeEventListener("keydown",this.onKeyDown),i.removeEventListener("pointerdown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([n,r])=>{n.removeEventListener("userEvent",this.onUserEvent),r.forEach(s=>s.disconnect())})}[...this.eventsPerObject.entries()].forEach(([t,e])=>{t.removeEventListener("userEvent",this.onUserEvent),e.forEach(i=>i.disconnect())}),this.eventsPerObject.clear(),this.eventsAfterPerObject.clear()}},d6e=class{constructor(t,e,i,n,r,s){this.id=t,this.data=e,this.object=i,this.disabled=!1,this.actions=il(e,e.actions,n,r,s,i),this.target=e.target,this.useToggle=e.toggle}disconnect(){oa(this.actions)}dispatch(t){this.disabled||(this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Collision"}),this.useToggle?(this.actions.Transition.forEach(e=>{e.toggle()}),this.actions.Animation.forEach(e=>{e.toggle()})):(this.actions.Transition.forEach(e=>{e.play()}),this.actions.Animation.forEach(e=>{e.play()})),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch(t??!1)}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()}))}},f6e="https://unpkg.com/@splinetool/runtime@0.9.405/build/",p6e="https://unpkg.com/@splinetool/navmesh-wasm@0.9.405/build/",m6e=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import('${f6e}' + 'navmesh.js'),
		fetch('${p6e}' + 'navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,g6e=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import(self.location.origin + '/_libraries/navmesh.js'),
		fetch(self.location.origin + '/_libraries/navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,v6e=`

onmessage = function(messageEvent) {
	const meshData = messageEvent.data;
	const positions = meshData[0];
	const offset = meshData[1];
	const indices = meshData[2];
	const indicesLength = meshData[3];
	const parameters = meshData[4];

	const module = self.module;
	const rc = new module.rcConfig();
	rc.cs = parameters.cs;
	rc.ch = parameters.ch;
	rc.borderSize = parameters.borderSize ? parameters.borderSize : 0;
	rc.tileSize = parameters.tileSize ? parameters.tileSize : 0;
	rc.walkableSlopeAngle = parameters.walkableSlopeAngle;
	rc.walkableHeight = parameters.walkableHeight;
	rc.walkableClimb = parameters.walkableClimb;
	rc.walkableRadius = parameters.walkableRadius;
	rc.maxEdgeLen = parameters.maxEdgeLen;
	rc.maxSimplificationError = parameters.maxSimplificationError;
	rc.minRegionArea = parameters.minRegionArea;
	rc.mergeRegionArea = parameters.mergeRegionArea;
	rc.maxVertsPerPoly = parameters.maxVertsPerPoly;
	rc.detailSampleDist = parameters.detailSampleDist;
	rc.detailSampleMaxError = parameters.detailSampleMaxError;

	if (!self.navMesh) {
		self.navMesh = new module.NavMesh();
	}
	self.navMesh.build(positions, offset, indices, indicesLength, rc);

	const navmeshData = navMesh.getNavmeshData();
	const arrView = new Uint8Array(module.HEAPU8.buffer, navmeshData.dataPointer, navmeshData.size);
	const ret = new Uint8Array(navmeshData.size);
	ret.set(arrView);
	navMesh.freeNavmeshData(navmeshData);

	postMessage(ret);
}
`,y6e=.001,x6e={cs:6,ch:2,walkableSlopeAngle:90,walkableHeight:20,walkableClimb:5,walkableRadius:0,maxEdgeLen:12,maxSimplificationError:1.3,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1},Rre,pi,qr;_Ne.then(t=>{Rre=t,pi=new t.Vec3,qr=new t.Vec3});var _6e=new L,w6e=class{constructor(t=!1,e=!1){this.usePhysics=t,this.isExport=e,this.onPointerDown=i=>{if(Ot.length!==1)return;let{raycaster:n,page:r}=this.eventContext;this.eventContext.updateRaycaster(i);let s=r.raycastWithClones(n);if(s.length!==0){if(this.gameControl){let o=_6e.copy(this.gameControl.colliderWorldPosition);o.y-=this.gameControl.colliderHeight/2,this.gameControl.path=this.computePath(o,s[0].point)}this.eventContext.requestRender()}},this.traverseWithPhysics=(i,n)=>r=>{var d,f,p,m,v,g,y;let s;if(r instanceof Pl)if(r.objectForSample){if(r.objectForSample.dataPatched.physics.fusedBody)return;s=r.object}else return r.object.dataPatched.physics.fusedBody===!0&&r.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(r instanceof _s)s=r.object;else if(s=r,((d=s.dataPatched.cloner)==null?void 0:d.disabled)===!1&&((f=s.dataPatched.cloner)==null?void 0:f.hideBase)&&((p=s.dataPatched.physics)==null?void 0:p.fusedBody)!==!0)return!0;if(n&&!s.userData.navmesh)return;let o=s.dataPatched;if(!o.visible&&((m=o.physics)==null?void 0:m.enabled)!==!0)return!0;r.updateMatrixWorldSVD();let a=jT(o),l=s.userData.hasDestroy,c=s.userData.hasDrag,h=!1,u=!1;for(let x of o.events)x.data.disabled!==!0&&(x.data.type==="GameControl"?h=!0:x.data.type==="Follow"&&(u=!0));if(h||a||u||l||c)return!0;if(this.usePhysics&&((v=o.physics)==null?void 0:v.rigidBody)==="dynamic"){if(this.usePhysics&&((g=o.physics)!=null&&g.fusedBody))return!0}else if("geometry"in r&&r.geometry&&i.push(Gu(r.geometry,r.matrixWorld)),this.usePhysics&&((y=o.physics)==null?void 0:y.fusedBody))return r.traverseObject((x,b)=>{var E,M;if(b===0)return;let S;if(x instanceof Pl)if(x.objectForSample){if(x.objectForSample.dataPatched.physics.fusedBody)return;S=x.object}else return x.object.dataPatched.physics.fusedBody===!0&&x.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(x instanceof _s)S=x.object;else if(S=x,(E=x.dataPatched.cloner)==null?void 0:E.hideBase)return!0;let A=S.dataPatched;if(!A.visible&&((M=A.physics)==null?void 0:M.enabled)!==!0)return!0;"geometry"in x&&x.geometry&&i.push(Gu(x.geometry,x.matrixWorld))}),!0},this.traverseNoPhysics=(i,n)=>r=>{let s;if(r instanceof Pl)return;r instanceof _s?s=r.object:s=r;let o=s.dataPatched;if(o.physics.enabled==="visibility"?!o.visible:!o.physics.enabled)return!0;if(n&&!s.userData.navmesh)return;let a=r.geometry,l=s.userData.hasDestroy===!0,c=s.userData.hasDrag===!0;if(jT(o)||l||c||s.dataPatched.events.some(h=>h.data.disabled!==!0&&h.data.type==="GameControl"))return!0;a&&i.push(Gu(a,r.matrixWorld))},this.navmeshWasm=Rre,this.navMesh=new this.navmeshWasm.NavMesh,this._workerURL=URL.createObjectURL(new Blob([(e?m6e:g6e)+v6e])),this._worker=new Worker(this._workerURL)}init(t,e,i){this.gameControl=e,this.eventContext=i,this.resolution=t.ch,this.setDefaultQueryExtent(new L().setScalar(t.ch*t.walkableRadius*1.2)),this._worker.onmessage=()=>{this.createNavMesh(i.page,t,n=>{this.buildFromNavmeshData(n.data)})},this.eventContext.renderer.domElement.addEventListener("pointerdown",this.onPointerDown)}createNavMesh(t,e,i){e.objects.forEach(l=>{var h;let c=t.scene.find(l);c.traverseEntity(u=>{u.userData.navmesh=!0}),(h=c.cloner)==null||h.traverseObject(u=>{u.userData.navmesh=!0})});let n=[],r=(this.usePhysics?this.traverseWithPhysics:this.traverseNoPhysics)(n,e.zones==="custom");if(t.traverseChildren(r),e.objects.forEach(l=>{var h;let c=t.scene.find(l);c.traverseEntity(u=>{u.userData.navmesh=void 0}),(h=c.cloner)==null||h.traverseObject(u=>{u.userData.navmesh=void 0})}),n.length===0)return!1;let s=Mp(n),{positions:o,triIndices:a}=v2(s.getAttribute("position"),s.getIndex());return this._worker.postMessage([o,o.length/3,a,a.length,{...x6e,...e}]),this._worker.onmessage=i,!0}createDebugNavGeometry(){let t,e,i=this.navMesh.getDebugNavMesh(),n=i.getTriangleCount(),r=new Uint32Array(n*3),s=new Float32Array(n*3*3);for(t=0;t<n*3;t++)r[t]=t;for(t=0;t<n;t++)for(e=0;e<3;e++){let a=i.getTriangle(t).getPoint(e);s[t*9+e*3+0]=a.x,s[t*9+e*3+1]=a.y,s[t*9+e*3+2]=a.z}let o=new Ut;return o.setIndex(new Gt(r,1)),o.setAttribute("position",new Gt(s,3)),o}getClosestPoint(t){return pi.x=t.x,pi.y=t.y,pi.z=t.z,this.navMesh.getClosestPoint(pi)}getClosestPointToRef(t,e){pi.x=t.x,pi.y=t.y,pi.z=t.z;let i=this.navMesh.getClosestPoint(pi);e.set(i.x,i.y,i.z)}getRandomPointAround(t,e){return pi.x=t.x,pi.y=t.y,pi.z=t.z,this.navMesh.getRandomPointAround(pi,e)}getRandomPointAroundToRef(t,e,i){pi.x=t.x,pi.y=t.y,pi.z=t.z;let n=this.navMesh.getRandomPointAround(pi,e);i.set(n.x,n.y,n.z)}moveAlong(t,e){return pi.x=t.x,pi.y=t.y,pi.z=t.z,qr.x=e.x,qr.y=e.y,qr.z=e.z,this.navMesh.moveAlong(pi,qr)}moveAlongToRef(t,e,i){return pi.x=t.x,pi.y=t.y,pi.z=t.z,qr.x=e.x,qr.y=e.y,qr.z=e.z,this.navMesh.moveAlong(pi,qr)}computePath(t,e){let i=this.getClosestPoint(e);qr.x=i.x,qr.y=i.y,qr.z=i.z,this.getClosestPoint(t);let n=this.navMesh.computePath(pi,qr),r=n.getPointCount(),s=[];for(let o=0;o<r;o++){let a=n.getPoint(o);s.push(new L(a.x,a.y,a.z))}return s}createCrowd(t,e){return new b6e(this,t,e)}setDefaultQueryExtent(t){pi.x=t.x,pi.y=t.y,pi.z=t.z,this.navMesh.setDefaultQueryExtent(pi)}getDefaultQueryExtent(){return this.navMesh.getDefaultQueryExtent()}buildFromNavmeshData(t){let e=t.length*t.BYTES_PER_ELEMENT,i=this.navmeshWasm._malloc(e),n=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,i,e);n.set(t);let r=new this.navmeshWasm.NavmeshData;r.dataPointer=n.byteOffset,r.size=t.length,this.navMesh.buildFromNavmeshData(r),this.navmeshWasm._free(n.byteOffset)}getNavmeshData(){let t=this.navMesh.getNavmeshData(),e=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,t.dataPointer,t.size),i=new Uint8Array(t.size);return i.set(e),this.navMesh.freeNavmeshData(t),i}getDefaultQueryExtentToRef(t){let e=this.navMesh.getDefaultQueryExtent();t.set(e.x,e.y,e.z)}dispose(){var t;console.log("dispose nav"),this.navMesh.destroy(),this._worker.terminate(),URL.revokeObjectURL(this._workerURL),(t=this.eventContext)==null||t.renderer.domElement.removeEventListener("pointerdown",this.onPointerDown)}addCylinderObstacle(t,e,i){return pi.x=t.x,pi.y=t.y,pi.z=t.z,this.navMesh.addCylinderObstacle(pi,e,i)}addBoxObstacle(t,e,i){return pi.x=t.x,pi.y=t.y,pi.z=t.z,qr.x=e.x,qr.y=e.y,qr.z=e.z,this.navMesh.addBoxObstacle(pi,qr,i)}removeObstacle(t){this.navMesh.removeObstacle(t)}isSupported(){return this.navmeshWasm!==void 0}},b6e=class{constructor(t,e,i){this.navmeshWasmWrapper=t,this.transforms=[],this.agents=new Array,this.reachRadii=new Array,this._agentDestinationArmed=new Array,this._agentDestination=new Array,this.crowd=new this.navmeshWasmWrapper.navmeshWasm.Crowd(e,i,this.navmeshWasmWrapper.navMesh.getNavMesh())}onReachTarget(t,e){}addAgent(t,e,i){let n=new this.navmeshWasmWrapper.navmeshWasm.dtCrowdAgentParams;n.radius=e.radius,n.height=e.height,n.maxAcceleration=e.maxAcceleration,n.maxSpeed=e.maxSpeed,n.collisionQueryRange=e.collisionQueryRange,n.pathOptimizationRange=e.pathOptimizationRange,n.separationWeight=e.separationWeight,n.updateFlags=7,n.obstacleAvoidanceType=0,n.queryFilterType=0,n.userData=0;let r=this.crowd.addAgent(new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z),n);return this.transforms.push(i),this.agents.push(r),this.reachRadii.push(e.reachRadius?e.reachRadius:e.radius),this._agentDestinationArmed.push(!1),this._agentDestination.push(new L(0,0,0)),r}getAgentPosition(t){return this.crowd.getAgentPosition(t)}getAgentPositionToRef(t,e){let i=this.crowd.getAgentPosition(t);e.set(i.x,i.y,i.z)}getAgentVelocity(t){return this.crowd.getAgentVelocity(t)}getAgentVelocityToRef(t,e){let i=this.crowd.getAgentVelocity(t);e.set(i.x,i.y,i.z)}getAgentNextTargetPath(t){return this.crowd.getAgentNextTargetPath(t)}getAgentNextTargetPathToRef(t,e){let i=this.crowd.getAgentNextTargetPath(t);e.set(i.x,i.y,i.z)}getAgentState(t){return this.crowd.getAgentState(t)}overOffmeshConnection(t){return this.crowd.overOffmeshConnection(t)}agentGoto(t,e){this.crowd.agentGoto(t,new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z));let i=this.agents.indexOf(t);i>-1&&(this._agentDestinationArmed[i]=!0,this._agentDestination[i].set(e.x,e.y,e.z))}agentTeleport(t,e){this.crowd.agentTeleport(t,new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z))}updateAgentParameters(t,e){let i=this.crowd.getAgentParameters(t);e.radius!==void 0&&(i.radius=e.radius),e.height!==void 0&&(i.height=e.height),e.maxAcceleration!==void 0&&(i.maxAcceleration=e.maxAcceleration),e.maxSpeed!==void 0&&(i.maxSpeed=e.maxSpeed),e.collisionQueryRange!==void 0&&(i.collisionQueryRange=e.collisionQueryRange),e.pathOptimizationRange!==void 0&&(i.pathOptimizationRange=e.pathOptimizationRange),e.separationWeight!==void 0&&(i.separationWeight=e.separationWeight),this.crowd.setAgentParameters(t,i)}removeAgent(t){this.crowd.removeAgent(t);let e=this.agents.indexOf(t);e>-1&&(this.agents.splice(e,1),this.transforms.splice(e,1),this.reachRadii.splice(e,1),this._agentDestinationArmed.splice(e,1),this._agentDestination.splice(e,1))}getAgents(){return this.agents}update(t){if(this.navmeshWasmWrapper.navMesh.update(),t<=y6e)return;let e=1/60,i=10;{let n=Math.floor(t/e);n>i&&(n=i),n<1&&(n=1);let r=t/n;for(let s=0;s<n;s++)this.crowd.update(r)}for(let n=0;n<this.agents.length;n++){let r=this.agents[n],s=this.getAgentPosition(r);if(this.transforms[n].copy(s),this._agentDestinationArmed[n]){let o=s.x-this._agentDestination[n].x,a=s.z-this._agentDestination[n].z,l=this.reachRadii[n],c=this._agentDestination[n].y-this.reachRadii[n],h=this._agentDestination[n].y+this.reachRadii[n],u=o*o+a*a;s.y>c&&s.y<h&&u<l*l&&(this.onReachTarget(r,this._agentDestination[n]),this._agentDestinationArmed[n]=!1)}}}setDefaultQueryExtent(t){let e=new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z);this.crowd.setDefaultQueryExtent(e)}getDefaultQueryExtent(){return this.crowd.getDefaultQueryExtent()}getDefaultQueryExtentToRef(t){let e=this.crowd.getDefaultQueryExtent();t.set(e.x,e.y,e.z)}getCorners(t){let e,i=this.crowd.getCorners(t),n=i.getPointCount(),r=[];for(e=0;e<n;e++){let s=i.getPoint(e);r.push(new L(s.x,s.y,s.z))}return r}dispose(){this.crowd.destroy()}};function S6e(t){let e=!1;return t.scene.objects.forEach(i=>{i.data.type==="Page"&&!e&&i.data.publish.gameControlObject&&J_.traverseModuleInstances(t.scene.objects,i.id,(n,r,s)=>{for(let o of s)o.data.type==="GameControl"&&o.data.navmesh.enabled&&(e=!0)})}),e}var A6e={type:"change"},gX={type:"changeZoom"},M6e={type:"changePan"},Vg={type:"start"},jg={type:"end",changed:!0},E6e={type:"end",changed:!1},sI=new Zt,vX=new he,T6e=2*Math.PI,C6e=1e-8,P6e=.01,oI=new L,cM=new he,aI=new L,uM=new Zt,yX=new $e,D6e={type:"requestRender"},Ire=class extends is{constructor(t,e,i={isPlayMode:!1,isExport:!1}){super(),this.object=t,this.domElement=e,this.options=i,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,_a.DOLLY_ROTATE,_a.PAN],this.offset=new L,this.eye=new L,this.lastPosition=new L,this.lastQuaternion=new Zt,this.current=new he,this.overShoot=new he,this.overRatio=new he,this.spherical=new zW,this.sphericalDelta=new zW,this.panOffset=new L,this.panLeftV=new L,this.panUpV=new L,this.panV=new L,this.rotateStart=new he,this.rotateEnd=new he,this.rotateDelta=new he,this.panStart=new he,this.panEnd=new he,this.panDelta=new he,this.dollyStart=new he,this.dollyEnd=new he,this.dollyDelta=new he,this.rotationRangeFactor=new he,this.panRangeFactor=new he,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.resetHoverEffectOnPointerLeave=!1,this.hasChange=!1,this.useWindowEvents=!1,this.isTouchZoom=!0,this.autoRotateSpeed=2,this.dampingFactor=.125,this.zoomSpeed=2,this.rotateSpeed=1,this.panSpeed=1,this.hoverRotatePanStrength=.1,this.thetaIsFree=!1,this.phiIsFree=!1,this.needsUpdate=!0,this.onCameraChange=n=>{this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange),this.object=n.camera,this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)},this.update=()=>{this.object.updateWorldMatrix(!0,!1),this.object.matrixWorld.decompose(aI,uM,oI),this.offset.copy(aI).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&this.state===-1&&this.rotateLeft((this.autoRotateClockwise===!0?1:-1)*this.getAutoRotationAngle()),this.rotationLimitsMode!==0&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),this.rotationLimitsMode!==2&&(this.spherical.phi+=this.sphericalDelta.phi),(this.rotationLimitsMode!==1||this.autoRotate===!0)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),this.panLimitsMode!==0&&(this.target.applyQuaternion(sI.copy(uM).invert()),this.panOffset.applyQuaternion(sI),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion(uM),this.panOffset.applyQuaternion(uM)),this.panLimitsMode===2&&(this.panOffset.y=0),this.panLimitsMode===1&&(this.panOffset.x=0),this.state===-1&&!this.gesture?(this.panOffset.multiplyScalar(1-this.dampingFactor),this.target.add(this.panOffset)):(this.target.add(this.panOffset),this.panOffset.set(0,0,0)),this.offset.setFromSpherical(this.spherical),aI.copy(this.target).add(this.offset),this.object.position.copy(this.target).add(this.offset),this.object.parent&&(yX.copy(this.object.parent.matrixWorld).invert(),this.object.position.applyMatrix4(yX));let n=this.spherical.phi%T6e;return this.eye.copy(this.offset).normalize(),this.object.up.copy(ji.DEFAULT_UP).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),n>0&&n>Math.PI||n<0&&n>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),this.state===-1||this.enableDamping===!0?(this.sphericalDelta.theta*=1-this.dampingFactor,this.sphericalDelta.phi*=1-this.dampingFactor):this.sphericalDelta.set(0,0,0),this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>P6e||8*(1-this.lastQuaternion.dot(this.object.quaternion))>C6e?(this.dispatchEvent(A6e),this.object.dispatchEvent(D6e),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):(this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.object.wasMovedBySwitchCameraAction=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),!1)},this.onPointerDown=n=>{this.enabled!==!1&&(n.pointerType==="touch"||n.pointerType==="pen"&&qo?this.onPointerDownTouch(n):this.onPointerDownMouse(n),this.state!==-1&&(this.isPointerDown=!0,this.dispatchEvent(Vg),this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp),n.stopPropagation(),n.pointerType==="touch"||n.pointerType==="pen"&&qo||this.domElement.setPointerCapture(n.pointerId)))},this.onPointerLeave=n=>{this.resetHoverEffectOnPointerLeave&&!this.useWindowEvents?(this.hoverRotatePanMode===1?(this.sphericalDelta.theta=-this.spherical.theta,this.sphericalDelta.phi=-this.spherical.phi,oI.subVectors(this.position0,this.target0),this.spherical.setFromVector3(oI),this.sphericalDelta.theta+=this.spherical.theta,this.sphericalDelta.phi+=this.spherical.phi,this.sphericalDelta.theta/=8,this.sphericalDelta.phi/=8):this.hoverRotatePanMode===2&&this.panOffset.subVectors(this.target0,this.target).divideScalar(8),this.update()):this.pointerLeaveEvent=n},this.onPointerEnter=n=>{this.resetHoverEffectOnPointerLeave||this.pointerLeaveEvent===void 0?cM.set(n.clientX-this.domElement.clientWidth/2,n.clientY-this.domElement.clientHeight/2):cM.set(n.clientX-this.pointerLeaveEvent.clientX,n.clientY-this.pointerLeaveEvent.clientY),this.hoverRotatePanMode===1?(this.rotateDelta.copy(cM).multiplyScalar(this.rotateSpeed*this.hoverRotatePanStrength).rotateAround(vX,-this.object.angleOffsetFromUp),this.rotateLeft(2*Math.PI*this.rotateDelta.x/this.domElement.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/this.domElement.clientHeight),this.rotateStart.set(n.clientX,n.clientY)):this.hoverRotatePanMode===2&&(this.panDelta.copy(cM).multiplyScalar(this.panSpeed*this.hoverRotatePanStrength),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.set(n.clientX,n.clientY)),this.update()},this.onPointerMove=n=>{this.enabled!==!1&&(n.pointerType==="touch"||n.pointerType==="pen"&&qo?this.onPointerMoveTouch(n):this.onPointerMoveMouse(n),n.stopPropagation())},this.onPointerUp=n=>{this.isPointerDown=!1,Ot.length===0&&(this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)),Ot.length>1&&n.preventDefault(),this.hasChange?this.dispatchEvent(jg):this.dispatchEvent(E6e),this.state=-1,n&&(n.stopPropagation(),n.pointerType==="touch"||n.pointerType==="pen"&&qo||this.domElement.releasePointerCapture(n.pointerId))},this.onPointerDownMouse=n=>{let r;switch(this.useKeyEvents?r=this.mouseButtons[n.button]:r=this.mouseButtonsPlay[n.button],r){case 0:if(n.altKey===!0&&!n.shiftKey&&!TA(n)){if(this.enableRotate===!1)return;this.handleMouseDownRotate(n),this.state=0}else if(this.key===" "){if(this.enablePan===!1)return;this.handleMouseDownPan(n),this.state=2}break;case 4:if(this.enablePan===!1)return;this.handleMouseDownPan(n),this.state=2;break;case 3:if(TA(n)||n.shiftKey){if(this.enablePan===!1)return;this.handleMouseDownPan(n),this.state=2}else{if(this.enableRotate===!1)return;this.handleMouseDownRotate(n),this.state=0}break;case 5:if(TA(n)||n.shiftKey){if(this.enableRotate===!1)return;this.handleMouseDownRotate(n),this.state=0}else{if(this.enablePan===!1)return;this.handleMouseDownPan(n),this.state=2}break;default:this.state=-1}},this.onPointerMoveMouse=n=>{switch(this.state){case 0:if(this.enableRotate===!1)return;this.handleMouseMoveRotate(n);break;case 1:if(this.enableZoom===!1)return;this.handleMouseMoveDolly(n);break;case 2:if(this.enablePan===!1)return;this.handleMouseMovePan(n);break}this.object.wasMovedByUser=!0},this.onPointerDownTouch=n=>{switch(Ot.length>1&&n.preventDefault(),this.touches[Ot.length-1]){case _a.ROTATE:if(this.enableRotate===!1){this.state=-1;return}this.handleTouchStartRotate(),this.state=3;break;case _a.PAN:if(this.enablePan===!1){this.state=-1;return}this.handleTouchStartPan(),this.state=4;break;case _a.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchStartDollyPan(),this.state=5;break;case _a.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}},this.onPointerMoveTouch=n=>{switch(Ot.length>1&&n.preventDefault(),this.state){case 3:if(this.enableRotate===!1)return;this.handleTouchMoveRotate(n),this.update();break;case 4:if(this.enablePan===!1)return;this.handleTouchMovePan(n),this.update();break;case 5:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchMoveDollyPan(n),this.update();break;case 6:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchMoveDollyRotate(n),this.update();break;default:this.state=-1}this.object.wasMovedByUser=!0},this.dispatchEndDebounced=zk(()=>this.dispatchEvent(jg),33),this.onMouseWheel=n=>{this.enabled===!1||this.enableZoom===!1&&this.enablePan===!1||(this.options.isExport===!1&&this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth&&n.preventDefault(),this.dispatchEvent(Vg),this.handleMouseWheel(n),this.dispatchEndDebounced(),this.object.wasMovedByUser=!0)},this.onGesture=n=>{if(n.preventDefault(),this.enabled!==!1&&!Fte)if(n.type==="gesturechange"){if(this.enableZoom===!1||this.isTouchZoom===!1)return;this.dispatchEvent(Vg),n.scale>this.prevScale?this.dollyIn(this.getZoomScale()):n.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=n.scale,this.update(),this.object.wasMovedByUser=!0}else this.dispatchEvent(jg)},this.onContextMenu=n=>{n.preventDefault()},this.onTouchEnd=n=>{n.preventDefault()},this.onKeyDown=n=>{this.enabled!==!1&&(this.key=n.key,n.key===" "&&this.dispatchEvent(Vg))},this.onKeyUp=n=>{this.enabled!==!1&&(this.key=void 0,this.state!==-1&&n.key==="Alt"&&this.onPointerUp(Ot[0]),n.key===" "&&this.dispatchEvent(jg))},this.onPointerHover=n=>{n.pointerType!=="mouse"||this.enabled===!1||this.state!==-1||this.hoverRotatePanMode===2&&this.isPanOverShoot||this.hoverRotatePanMode===1&&this.isRotateOverShoot||(this.isPointerDown=!0,this.hoverRotatePanMode===2?this.handleMouseMovePan(n,this.hoverRotatePanStrength):this.hoverRotatePanMode===1&&this.handleMouseMoveRotate(n,this.hoverRotatePanStrength))},this.onBeginState=()=>{this.enabled=!1,this.needsUpdate=!1},this.onCompleteState=n=>{n.isfromEntity&&this.options.isPlayMode||(this.enabled=!0,this.needsUpdate=!0,this.object.updateUp(),this.object.getTarget(this.target))},this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.quat0=this.object.quaternion.clone(),this.isUpVectorFlipped0=this.object.isUpVectorFlipped,this.offset.copy(this.object.position).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.addEventListenersToCamera()}dispatchEvent(t){t.type==="start"?this.hasChange=!1:this.hasChange=!0,super.dispatchEvent(t)}addEventListenersToCamera(){this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)}removeEventListenersFromCamera(){this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange)}updateUseWindowEvents(t){if(window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("pointermove",this.onPointerHover),this.useWindowEvents=t,this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover)),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}}fromJSON(t,e){this.setEnableDampingSpeed(t.enableDamping),this.enablePan=t.enablePan,this.enableZoom=t.enableZoom,this.enableRotate=t.enableRotate,this.rotationLimitsMode=t.rotationLimitsMode,this.thetaIsFree=t.rotationHorizontalOffset.min===t.rotationHorizontalOffset.max&&t.rotationHorizontalOffset.min===Math.PI,this.phiIsFree=t.rotationVerticalOffset.min===t.rotationVerticalOffset.max&&t.rotationVerticalOffset.min===Math.PI,this.panLimitsMode=t.panLimitsMode,this.panSoftLimit=t.panSoftLimit,this.rotationSoftLimit=t.rotationSoftLimit,this.hoverRotatePanMode=t.hoverRotatePanMode,this.useWindowEvents=e==="window",this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover));let i=t.hoverRotatePanStrength/100;this.hoverRotatePanStrength=i**2,this.zoomLimitsEnabled=t.zoomLimitsEnabled,this.minZoom=t.zoomLimits.min,this.maxZoom=Math.max(t.zoomLimits.min,t.zoomLimits.max),this.minDistance=1e3/t.zoomLimits.max,this.maxDistance=Math.max(this.minDistance,1e3/t.zoomLimits.min),this.autoRotate=t.autoRotate,this.autoRotateSpeed=t.autoRotateSpeed,this.autoRotateClockwise=t.autoRotateClockwise;let n=this.object.getTarget().applyQuaternion(sI.copy(this.object.quaternion).invert());this.minV=-t.panVerticalOffset.min+n.y,this.maxV=t.panVerticalOffset.max+n.y,this.minH=-t.panHorizontalOffset.min+n.x,this.maxH=t.panHorizontalOffset.max+n.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=gc(this.spherical.phi-t.rotationVerticalOffset.min),this.maxPhi=gc(this.spherical.phi+t.rotationVerticalOffset.max),this.minTheta=gc(gc(this.spherical.theta)-t.rotationHorizontalOffset.min),this.maxTheta=gc(gc(this.spherical.theta)+t.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,t.orbitTouches===1&&(this.touches[0]=_a.ROTATE),t.panTouches===1&&(this.touches[0]=_a.PAN),t.orbitTouches===2&&(this.touches[1]=_a.DOLLY_ROTATE),t.panTouches===2&&(this.touches[1]=_a.DOLLY_PAN),t.orbitTouches===3&&(this.touches[2]=_a.ROTATE),t.panTouches===3&&(this.touches[2]=_a.PAN),this.isTouchZoom=t.isTouchZoom,this.resetHoverEffectOnPointerLeave=t.resetHoverEffectOnPointerLeave??!1}connect(){if(this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture),this.domElement.addEventListener("touchend",this.onTouchEnd),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let t=this.useWindowEvents?window:this.domElement;t.addEventListener("pointerleave",this.onPointerLeave),t.addEventListener("pointerenter",this.onPointerEnter)}this.pointerLeaveEvent=void 0}dispose(){this.removeEventListenersFromCamera(),this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)}applyLimits(t,e,i,n,r,s,o,a){this.overShoot.set(0,0);let l,c,h;t instanceof L?(l=t.x,c=t.y,this.current.set(this.target.x,this.target.y),h=!0):(l=t.theta,c=t.phi,this.current.set(gc(this.spherical.theta),gc(this.spherical.phi)),h=!1),i===0&&(this.current.x+=l,this.current.y+=c),(e===3||e===2)&&(!h&&this.isThetaFlipped?this.current.x>n&&this.current.x<0?this.overShoot.x=n-this.current.x:this.current.x<r&&this.current.x>0&&(this.overShoot.x=r-this.current.x):this.current.x>n?this.overShoot.x=n-this.current.x:this.current.x<r&&(this.overShoot.x=r-this.current.x)),(e===3||e===1)&&(this.current.y>s?this.overShoot.y=s-this.current.y:this.current.y<o&&(this.overShoot.y=o-this.current.y)),h||(this.overShoot.x=gc(this.overShoot.x),this.overShoot.y=gc(this.overShoot.y)),i!==0?(this.overRatio.copy(this.overShoot).divide(a),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),i===1&&(this.overRatio.x=xX(Math.abs(this.overRatio.x)),this.overRatio.y=xX(Math.abs(this.overRatio.y))),this.isPointerDown||i===1?i===2&&(this.overRatio.x>.9&&!this.thetaIsFree||this.overRatio.y>.9&&!this.phiIsFree)?this.isPointerDown=!1:(l*this.overShoot.x<0&&!this.thetaIsFree&&(l*=1-this.overRatio.x),c*this.overShoot.y<0&&!this.phiIsFree&&(c*=1-this.overRatio.y)):i===2&&(!h&&(this.overRatio.x>.002&&!this.thetaIsFree||this.overRatio.y>.002&&!this.phiIsFree)||h&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(this.thetaIsFree||(l=this.overShoot.x*.05),this.phiIsFree||(c=this.overShoot.y*.05),h?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):h?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(l+=this.overShoot.x,c+=this.overShoot.y),t instanceof L?(t.x=l,t.y=c):(this.thetaIsFree||(t.theta=l),this.phiIsFree||(t.phi=c))}setEnableDampingSpeed(t){this.enableDamping=t,this.rotateSpeed=t===!0?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(t){this.sphericalDelta.theta-=t}rotateUp(t){this.sphericalDelta.phi-=t}panLeft(t,e){this.panLeftV.setFromMatrixColumn(e,0),this.panLeftV.multiplyScalar(-t),this.panOffset.add(this.panLeftV)}panUp(t,e){this.panUpV.setFromMatrixColumn(e,1),this.panUpV.multiplyScalar(t),this.panOffset.add(this.panUpV)}pan(t,e){let i=this.domElement;if(i&&this.object.isPerspectiveCamera){let n=this.object.position;this.panV.copy(n).sub(this.target);let r=this.panV.length();r*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*t*r/i.clientHeight,this.object.matrixWorld),this.panUp(2*e*r/i.clientHeight,this.object.matrixWorld)}else i&&this.object.isOrthographicCamera&&(this.panLeft(t*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrixWorld),this.panUp(e*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrixWorld));this.dispatchEvent(M6e)}dollyOut(t){this.object.isPerspectiveCamera?this.scale/=t:this.object.isOrthographicCamera&&(this.object.zoom*=t,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(gX)}dollyIn(t){this.object.isPerspectiveCamera?this.scale*=t:this.object.isOrthographicCamera&&(this.object.zoom/=t,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(gX)}zoomOut(t=this.getZoomScale()){this.dispatchEvent(Vg),this.dollyOut(t),this.dispatchEvent(jg)}zoomIn(t=this.getZoomScale()){this.dispatchEvent(Vg),this.dollyIn(t),this.dispatchEvent(jg)}handleMouseDownRotate(t){this.rotateStart.set(t.clientX,t.clientY)}handleMouseDownDolly(t){this.dollyStart.set(t.clientX,t.clientY)}handleMouseDownPan(t){this.panStart.set(t.clientX,t.clientY)}handleMouseMoveRotate(t,e=1){t.movementX!==void 0?this.rotateDelta.set(t.movementX,t.movementY):(this.rotateEnd.set(t.clientX,t.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd)),this.rotateDelta.multiplyScalar(this.rotateSpeed*e).rotateAround(vX,-this.object.angleOffsetFromUp);let i=this.domElement,n=this.useWindowEvents?window.innerHeight:i.clientHeight,r=2*Math.PI*this.rotateDelta.x/n,s=2*Math.PI*this.rotateDelta.y/n;this.rotateLeft(r),this.rotateUp(s),this.update()}handleMouseMoveDolly(t){this.dollyEnd.set(t.clientX,t.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(t,e=1){t.movementX!==void 0?this.panDelta.set(t.movementX,t.movementY):(this.panEnd.set(t.clientX,t.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.panStart.copy(this.panEnd)),this.panDelta.multiplyScalar(this.panSpeed*e),this.pan(this.panDelta.x,this.panDelta.y),this.update()}handleMouseWheel(t){if(mNe===!1&&TA(t)===!1&&R6e(t)===!0){if(this.enablePan===!1)return;this.gesture?(this.panDelta.set(-t.deltaX,-t.deltaY).multiplyScalar(this.panSpeed),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),t.altKey?this.pan(0,this.panDelta.y):t.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.gesture=!1,this.isPointerDown=!1},30)}else{if(this.enableZoom===!1)return;t.deltaY===0?t.deltaX<0?this.dollyIn(this.getZoomScale()):t.deltaX>0&&this.dollyOut(this.getZoomScale()):t.deltaY<0?this.dollyIn(this.getZoomScale()):t.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(Ot.length===2){let t=.5*(Ot[0].pageX+Ot[1].pageX),e=.5*(Ot[0].pageY+Ot[1].pageY);this.rotateStart.set(t,e)}else this.rotateStart.set(Ot[0].pageX,Ot[0].pageY)}handleTouchStartPan(){if(Ot.length===2){let t=.5*(Ot[0].pageX+Ot[1].pageX),e=.5*(Ot[0].pageY+Ot[1].pageY);this.panStart.set(t,e)}else this.panStart.set(Ot[0].pageX,Ot[0].pageY)}handleTouchStartDolly(){let t=Ot[0].pageX-Ot[1].pageX,e=Ot[0].pageY-Ot[1].pageY,i=Math.sqrt(t*t+e*e);this.dollyStart.set(0,i)}handleTouchStartDollyPan(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(t){if(Ot.length===2){let i=a3(t),n=.5*(t.pageX+i.x),r=.5*(t.pageY+i.y);this.rotateEnd.set(n,r)}else{if(t.pointerId!==Ot[0].pointerId)return;this.rotateEnd.set(t.pageX,t.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);let e=this.domElement;e&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/e.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/e.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(t){if(Ot.length===2){let e=a3(t),i=.5*(t.pageX+e.x),n=.5*(t.pageY+e.y);this.panEnd.set(i,n)}else{if(t.pointerId!==Ot[0].pointerId)return;this.panEnd.set(t.pageX,t.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(t){let e=a3(t),i=t.pageX-e.x,n=t.pageY-e.y,r=Math.sqrt(i*i+n*n);this.dollyEnd.set(0,r),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(t){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(t),this.enablePan&&this.handleTouchMovePan(t)}handleTouchMoveDollyRotate(t){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(t),this.enableRotate&&this.handleTouchMoveRotate(t)}};function gc(t){let e=Math.PI*2;for(;t<=-Math.PI;)t+=e;for(;t>Math.PI;)t-=e;return t}function xX(t){return 1-Math.pow(1-t,4)}function R6e(t){return t.wheelDeltaY===0||t.deltaY===0?u2&&t.shiftKey&&Math.abs(t.wheelDeltaX)>=120?!1:t.wheelDeltaX?t.wheelDeltaX===-3*t.deltaX:t.deltaMode===0:t.wheelDeltaY?t.wheelDeltaY===-3*t.deltaY:t.deltaMode===0}var _X=class{constructor(t,e,i,n,r,s){this.id=t,this.data=e,this.object=i,this.currentIntersectedObjects=[],this.disabled=!1,this.actions=il(e,e.actions,n,r,s,i),this.target=e.target,this.useToggle=e.toggle,this.triggeringObjects=e.triggeringObjects.map(o=>n.scene.find(o))}isValidTriggeringObject(t){return this.target==="all"?!0:this.triggeringObjects.some(e=>e===t||e.isAncestorOf(t.uuid)||t.isAncestorOf(e.uuid))}disconnect(){oa(this.actions)}dispatch(){this.disabled||(this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Trigger"}),this.useToggle?(this.actions.Transition.forEach(t=>{t.toggle()}),this.actions.SwitchCamera.forEach(t=>{t.toggle()})):(this.actions.Transition.forEach(t=>{t.play()}),this.actions.SwitchCamera.forEach(t=>{t.play()})),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch(!1)}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}))}},vi;bNe.then(t=>vi=t);var rr=new L,xl=new Zt,Qh=new L,lI=new Nr(0,0,0,"YXZ"),wX=new Nr(0,0,0,"XYZ"),Cu=new L,bX=new L,SX=new L(1,1,1),Wg=new Zt,cI=new $e,I6e=new $e,L6e={type:"updateMatrix"},mF={type:"beginEvent",eventName:"Collision"},B6e={type:"beginEvent",eventName:"Trigger"};function O6e(t){if(J_.physicsEnabled(t.scene.objects))return!0;let e=!1;return t.scene.objects.traverse((i,n)=>{if(n.events){for(let r of n.events)if(r.data.disabled!==!0&&r.data.type==="GameControl"&&r.data.collisionEnabled){e=!0;break}}}),e}var jT=t=>t.states.some(e=>e.data.position!==void 0||e.data.rotation!==void 0||e.data.hiddenMatrix!==void 0||e.data.cloner!==void 0||e.data.pathSnapping!==void 0),F6e=class{constructor(t){this.eventContext=t,this.orbitControlsNeedsUpdate=!0,this.gameControl=null,this.joysticks=[],this.joystickToGameControls=[],this.sharedGameControlGlobals={entitiesWithTransformAnim:[],entityToCollisionEvents:{},colliderToEntity:new Map,triggers:[],gamePads:[],createdObjects:[],nCreatedPerAction:{}},this.sensorToTriggerEvent={},this.eventManager=void 0,this.needsCollisionDetection=!1,this.initializationCounter=-1,this.rigidBodyToMesh=new Map,this.nActiveRigidBodies=0,this.collisionEvents=[],this.isExport=!1,this.processRigidBody=e=>{if(e.bodyType()!==vi.RigidBodyType.Dynamic)return;e.isSleeping()||this.nActiveRigidBodies++;let[i,n,r]=this.rigidBodyToMesh.get(e.handle);if(rr.copy(e.translation()).multiplyScalar(this.pixelsPerMeter),xl.copy(e.rotation()),i.matrixWorld.compose(rr,xl,n),i.hasNonUniformScale&&i.matrixWorld.multiply(i.shearScale),i.dispatchEvent(L6e),r){let s=i.cloner;if(s&&s.objectForSample===void 0){s.matrixWorld.copy(i.matrixWorld);for(let o of s.children)o.updateMatrixWorld(!0)}for(let o of i.children)o.updateMatrixWorld(!0)}},this.handleCollisionEvents=(e,i,n)=>{var o,a,l,c;if(n===!1)return;let r,s;if(this.sensorToTriggerEvent[e]?(r=this.sensorToTriggerEvent[e],s=this.sharedGameControlGlobals.colliderToEntity.get(i)):this.sensorToTriggerEvent[i]&&(r=this.sensorToTriggerEvent[i],s=this.sharedGameControlGlobals.colliderToEntity.get(e)),r&&s&&r.isValidTriggeringObject(s)){r.dispatch();return}for(let h=this.sharedGameControlGlobals.createdObjects.length-1;h>=0;h--){let u=this.sharedGameControlGlobals.createdObjects[h];if(u.userData.hasCollisionDestroy&&(((o=u.rigidBody)==null?void 0:o.collider(0).handle)===e||((a=u.rigidBody)==null?void 0:a.collider(0).handle)===i)){this.sharedGameControlGlobals.createdObjects.splice(h,1),u.removeFromParent(),requestAnimationFrame(()=>{var d;return(d=this.sharedGameControlGlobals.rapierWorld)==null?void 0:d.removeRigidBody(u.rigidBody)});break}}if(((l=this.gameControl)==null?void 0:l.object)===this.sharedGameControlGlobals.colliderToEntity.get(e)){let h=this.sharedGameControlGlobals.colliderToEntity.get(i),u=this.sharedGameControlGlobals.entityToCollisionEvents[h.uuid];if(u===void 0)return;for(let d of u)d.data.target==="character"&&this.dispatchCollisionEvent(d,h,i)}else if(((c=this.gameControl)==null?void 0:c.object)===this.sharedGameControlGlobals.colliderToEntity.get(i)){let h=this.sharedGameControlGlobals.colliderToEntity.get(e),u=this.sharedGameControlGlobals.entityToCollisionEvents[h.uuid];if(u===void 0)return;for(let d of u)d.data.target==="character"&&this.dispatchCollisionEvent(d,h,e)}else{let h=this.sharedGameControlGlobals.colliderToEntity.get(e),u=this.sharedGameControlGlobals.entityToCollisionEvents[h.uuid];if(u!==void 0)for(let p of u)p.data.target==="scene"&&this.dispatchCollisionEvent(p,h,e);let d=this.sharedGameControlGlobals.colliderToEntity.get(i),f=this.sharedGameControlGlobals.entityToCollisionEvents[d==null?void 0:d.uuid];if(f!==void 0)for(let p of f)p.data.target==="scene"&&this.dispatchCollisionEvent(p,d,i)}},this.isExport=t.isExport,this.sharedAssets=t.sharedAssets,this.renderer=t.renderer,this.requestRender=t.requestRender,this.domElement=this.renderer.domElement,this.pixelsPerMeter=bre,this.gravity=this.page.data.globalPhysics.gravity}get page(){return this.eventContext.page}attachVRControllers(t){t.forEach(e=>{e.addEventListener("connected",i=>{"gamepad"in i.data&&"axes"in i.data.gamepad&&this.sharedGameControlGlobals.gamePads.push(i.data.gamepad)})})}markIsDestroyTarget(){this.page.traverseVisibleEntity(t=>{var i,n;let e=t.dataPatched;for(let r of e.events){if(r.data.disabled===!0)continue;let s=(n=(i=r.data.actions)==null?void 0:i.find(o=>o.data.type==="Destroy"))==null?void 0:n.data;if(s)for(let o of s.objects){let a=this.page.scene.find(o);a&&(a.userData.hasDestroy=!0)}}})}markIsDragObject(){this.page.traverseVisibleEntity(t=>{let e=t.dataPatched;for(let i of e.events)if(!(i.data.disabled===!0||i.data.type!=="DragDrop"))for(let n of i.data.objects){let r=this.page.scene.find(n);r&&(r.userData.hasDrag=!0)}})}initBVH(){let t=[];if(this.page.traverseChildren(e=>{var a,l;let i;if(e instanceof Pl)return;e instanceof _s?i=e.object:i=e;let n=i.dataPatched;if(((a=n.physics)==null?void 0:a.enabled)==="visibility"?!n.visible:!((l=n.physics)!=null&&l.enabled))return!0;let r=e.geometry,s=i.userData.hasDestroy===!0,o=i.userData.hasDrag===!0;if(jT(n)||s||o||i.dataPatched.events.some(c=>c.data.disabled!==!0&&c.data.type==="GameControl"))return e.updateMatrixWorldSVD(),this.addBoundsTree(e),!0;r&&t.push(Gu(r,e.matrixWorld))}),t.length>0){let e=Mp(t,!1);this.sharedGameControlGlobals.staticMeshBVH=new V1(e)}}addRigidBody(t,e,i){let n=[],r="geometry"in t?t.geometry:void 0,s=e.dataPatched;if((r==null?void 0:r.getAttribute("position"))!==void 0&&n.push(Gu(r,t.shearScale)),s.physics.fusedBody){let o=this.gatherChildrenGeom(t,n);t.traverseObject(o),t.children.forEach(l=>l.updateMatrixWorld(!0));let a=t.cloner;a&&a.objectForSample===void 0&&s.physics.rigidBody==="dynamic"&&(a.traverseObject(o),a.children.forEach(l=>l.updateMatrixWorld(!0)))}if(n.length>0){let o,a=!i.fromCreate&&s.physics.rigidBody==="dynamic"||i.fromCreate&&i.dynamic;a?(o=vi.RigidBodyDesc.dynamic(),o.setLinearDamping(s.physics.damping).setAngularDamping(s.physics.damping).setAdditionalMass(1e-9).setGravityScale(s.physics.gravityScale).enabledRotations(...s.physics.enabledRotation).enabledTranslations(...s.physics.enabledTranslation)):(i.hasTransformAnim||i.hasFollow||i.hasDrag)&&!i.fromCreate?(o=vi.RigidBodyDesc.kinematicPositionBased(),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(t)):o=vi.RigidBodyDesc.fixed();let l=Mp(n);(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(rr,xl,Qh),t.position0=rr.clone().divideScalar(this.pixelsPerMeter),t.rotation0=xl.clone(),rr.divideScalar(this.pixelsPerMeter),o.setTranslation(rr.x,rr.y,rr.z).setRotation(xl),r?l==null||l.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter):l==null||l.scale(Qh.x/this.pixelsPerMeter,Qh.y/this.pixelsPerMeter,Qh.z/this.pixelsPerMeter);let c=this.sharedGameControlGlobals.rapierWorld.createRigidBody(o);a&&this.rigidBodyToMesh.set(c.handle,[t,Qh.clone(),s.physics.fusedBody]);let h=!(s.geometry===void 0||s.geometry.type==="SubdivGeometry"||s.geometry.type==="NonParametricGeometry"||s.geometry.type==="BooleanGeometry"||s.geometry.type==="VectorGeometry"||s.geometry.type==="StarGeometry"||s.geometry.type==="RectangleGeometry"||s.geometry.type==="EllipseGeometry"||s.geometry.type==="TriangleGeometry"||s.geometry.type==="TorusGeometry"||s.geometry.type==="HelixGeometry");try{this.addCollider(c,s.physics,l,e,h)}catch{try{this.addCollider(c,s.physics,l,e,!1)}catch(u){console.error(u)}}t.rigidBody=c}}addBoundsTree(t){var i;let e=[];if(((i=t.geometry)==null?void 0:i.getAttribute("position"))!==void 0&&e.push(Gu(t.geometry,t.shearScale)),t.traverseObject(this.gatherChildrenGeom(t,e)),t.children.forEach(n=>n.updateMatrixWorld(!0)),e.length>0){let n=Mp(e,!1);t.bvhGeometry=n,t.bvhGeometry.boundsTree=new V1(n),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(t)}}addCollider(t,e,i,n,r=!0){var a,l;if((i==null?void 0:i.getAttribute("position").count)===0||((a=i==null?void 0:i.getIndex())==null?void 0:a.count)===0)return;let s;i&&(e.colliderType==="trimesh"?s=vi.ColliderDesc.trimesh(i.getAttribute("position").array,i.getIndex().array):s=vi.ColliderDesc.convexMesh(i.getAttribute("position").array,r?i.getIndex().array:void 0)),s.setFrictionCombineRule(vi.CoefficientCombineRule.Average).setRestitutionCombineRule(vi.CoefficientCombineRule.Average).setDensity(e.density).setFriction(e.friction).setRestitution(e.restitution);let o=this.sharedGameControlGlobals.rapierWorld.createCollider(s,t);this.sharedGameControlGlobals.colliderToEntity.set(o.handle,n),(l=this.sharedGameControlGlobals.entityToCollisionEvents[n.uuid])!=null&&l.some(c=>c.target==="scene")&&o.setActiveEvents(vi.ActiveEvents.COLLISION_EVENTS)}gatherChildrenGeom(t,e){return(i,n)=>{var a;if(n===0)return;let r;if(i instanceof Pl)if(i.objectForSample){if(i.objectForSample.dataPatched.physics.fusedBody)return;r=i.object}else return i.object.dataPatched.physics.fusedBody===!0&&i.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(i instanceof _s)r=i.object;else if(r=i,(a=r.dataPatched.cloner)==null?void 0:a.hideBase)return!0;let s=r.dataPatched;if(s.physics.enabled==="visibility"?!s.visible:!s.physics.enabled)return!0;n===1?t.hasNonUniformScale?i.matrixWorld.multiplyMatrices(t.shearScale,i.hiddenMatrix):i.matrixWorld.copy(i.hiddenMatrix):i.matrixWorld.multiplyMatrices(i.parent.matrixWorld,i.hiddenMatrix),i.matrixWorld.multiply(i.matrix);let o=i.geometry;(o==null?void 0:o.getAttribute("position"))!==void 0&&e.push(Gu(o,i.matrixWorld))}}activate(t){var d,f;this.eventManager=t,this.usePhysics=this.page.data.globalPhysics.usePhysics;let e=this.page.playCamera,i=!1,n=5,r=8,s=9,o="drag",a=this.page.data.publish.gameControlObject,l=a!==null?this.page.find(a):null,c=null;if(l)for(let p of l.data.events){if(p.data.disabled||p.data.type!=="GameControl")break;let m=l;for(;this.usePhysics&&((d=m=m.parent)==null?void 0:d.parent)!==null&&!((f=m.data.physics)!=null&&f.fusedBody););p.data.collisionEnabled&&(this.needsCollisionDetection=!0),c===null&&(c=p.data)}if(l&&c){i=i||c.camera===e.uuid||l.uuid===e.uuid;let p=new Sre(l,this.renderer.domElement,c,this.eventContext.page.data.globalPhysics,this,l.uuid!==e.uuid&&c.camera===e.uuid,e,this.page,this.sharedAssets);this.gameControl=p,c.keyAssignments,n=c.joystickPosLoc,r=c.joystickRotLoc,s=c.jumpTouchButtonLoc,o=c.rotByTouch,qo&&c.touchControl&&(this.joystickToGameControls[n]="pos",c.moveMode==="walk"&&(this.joystickToGameControls[s]="jmp"),o==="joystick"&&(this.joystickToGameControls[r]="rot"))}if(this.gameControl&&this.gameControl.data.navmesh.enabled){let p=this.gameControl.data;if(!this.navigationMeshWrapper){this.navigationMeshWrapper=new w6e(this.usePhysics,this.isExport);let m;p.collider.type==="sphere"?m=p.collider.radius*2:m=p.collider.height,m=Math.floor(m/p.navmesh.ch-1),this.navigationMeshWrapper.init({...p.navmesh,walkableHeight:m},this.gameControl,this.eventContext)}}if(i===!1){let{enableRotate:p,enablePan:m,enableZoom:v,autoRotate:g,hoverRotatePanMode:y}=this.eventManager.publish.orbitControls;(p||m||v||g||y!==0)&&(this.orbitControls=new Ire(e,this.renderer.domElement,{isExport:this.isExport,isPlayMode:!0}),this.orbitControls.addEventListener("change",this.requestRender),this.orbitControls.addEventListener("end",this.requestRender),this.orbitControls.addEventListener("start",this.requestRender),this.orbitControls.fromJSON(this.eventManager.publish.orbitControls,this.eventManager.publish.mouseEventTarget),this.orbitControls.useKeyEvents=!1,this.orbitControls.addEventListenersToCamera(),this.orbitControls.connect(),this.orbitControls.update())}let h=this.renderer.domElement.width/this.renderer.getPixelRatio(),u=this.renderer.domElement.height/this.renderer.getPixelRatio();this.joystickToGameControls.forEach((p,m)=>{let v=document.body.appendChild(document.createElement("div")),[g,y,x]=this.eventManager.eventContext.publish.joystickSizeAndXYOffset[m],b=(h-5*g)/4+g,S={},A=p==="jmp",E=A?0:g;m<10?(m<5?S.top=E/2:S.bottom=E/2,S.left=E/2+m%5*b):m===10?(S.left=E/2,S.top=u/2):(S.right=E/2,S.top=u/2),S.top?S.top-=y[1]:S.bottom+=y[1],S.left?S.left+=y[0]:S.right-=y[0];for(let P in S)S[P]+="px";if(A){let P=v.appendChild(document.createElement("div"));Object.assign(P.style,S,{position:"absolute",width:g+"px",height:g+"px",backgroundColor:`rgba(255,255,255,${x==="show"?.4:0})`,zIndex:"9999",borderRadius:g+"px",border:x==="show"?"solid 2px rgba(0, 0, 0, .1)":"none",display:"flex",alignItems:"center",justifyContent:"center",touchAction:"none"});let R=g/16*16*.4;x==="show"&&(P.innerHTML=`
						<svg width="${R}" height="${g*.4}" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path d="M2 10L8 4L14 10" stroke="black" stroke-opacity="40%" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
					`),P.addEventListener("pointerdown",()=>{this.gameControl.movementState.jump=1,this.requestRender()}),P.addEventListener("touchend",U=>U.preventDefault()),this.joysticks[m]=[void 0,v];return}let M={zone:v,mode:"static",position:S,size:g};x==="hide"&&(M.restOpacity=0);let T=$5e.create(M);T.on("move",(P,R)=>{let U=this.gameControl;p==="pos"?R.force<.2?U.moveForce=0:(U.movementState.movePosZ=Math.sin(-R.angle.radian),U.movementState.movePosX=Math.cos(-R.angle.radian),R.force>1.2?U.movementState.run=1:U.movementState.run=0,R.force<.3?U.moveForce=(R.force-.2)/.1:U.moveForce=1):p==="rot"&&(R.force<.2?U.rotForce=0:(U.movementState.rotPosX=R.vector.y,U.movementState.rotPosY=-R.vector.x,R.force<.3?U.rotForce=(R.force-.2)/.1:U.rotForce=1)),this.requestRender()}),T.on("end",(P,R)=>{let U=this.gameControl;p==="pos"?(U.movementState.movePosZ=0,U.movementState.movePosX=0,U.moveForce=1):p==="rot"&&(U.movementState.rotPosX=0,U.movementState.rotPosY=0,U.rotForce=1)}),this.joysticks[m]=[T,v]}),this.markIsDestroyTarget(),this.markIsDragObject(),this.rebuildBVH(),this.initializationCounter++,window.setTimeout(()=>{this.collisionEvents.forEach(p=>p.disabled=!1)},80)}initPhysics(){var o;(o=this.sharedGameControlGlobals.rapierWorld)==null||o.free(),this.sharedGameControlGlobals.rapierWorld=new vi.World(new vi.Vector3(0,this.gravity,0)),this.events=new vi.EventQueue(!0);let t=[],e=[];if(this.page.traverseChildren(a=>{var g,y,x,b;let l;if(a instanceof Pl)if(a.objectForSample){if(a.objectForSample.dataPatched.physics.fusedBody)return;l=a.object}else return a.object.dataPatched.physics.fusedBody===!0&&a.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(a instanceof _s)l=a.object;else if(l=a,((g=l.dataPatched.cloner)==null?void 0:g.disabled)===!1&&((y=l.dataPatched.cloner)==null?void 0:y.hideBase)&&((x=l.dataPatched.physics)==null?void 0:x.fusedBody)!==!0)return!0;let c=l.dataPatched,h;for(let S of c.events)S.data.disabled!==!0&&S.data.type==="GameControl"&&(h=S.data);if(!c.physics||(c.physics.enabled==="visibility"?!c.visible:!c.physics.enabled))return!0;a.updateMatrixWorldSVD();let u=jT(c),d=!1,f=l.userData.hasDestroy,p=l.userData.hasDrag,m=!1;for(let S of c.events)if(S.data.disabled!==!0){if(S.data.type==="Collision"){d=!0;let A=new d6e(S.id,S.data,l,this.page,this.sharedAssets,this.eventManager);A.disabled=!0,this.collisionEvents.push(A),this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]&&this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].every(E=>E.id!==S.id)?this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].push(A):this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]=[A]}else if(S.data.type==="Follow"){m=!0;let A=S.data.target;a.traverseVisible(E=>{E.userData.isFollowingObj=A})}}c.physics.rigidBody==="dynamic"&&c.physics.fusedBody===!1&&(a.matrixWorldFusedFalse=a.matrixWorld.clone());let v=a.geometry;if(h!==void 0){let S=vi.RigidBodyDesc.kinematicPositionBased();(a.hasNonUniformScale?a.matrixWorldRigid:a.matrixWorld).decompose(rr,xl,Qh),a.position0=rr.clone().divideScalar(this.pixelsPerMeter),a.rotation0=xl.clone(),rr.divideScalar(this.pixelsPerMeter),S.setTranslation(rr.x,rr.y,rr.z).setRotation(xl);let A=this.sharedGameControlGlobals.rapierWorld.createRigidBody(S);a.rigidBody=A;let E;h.collider.type==="sphere"?E=vi.ColliderDesc.ball(h.collider.radius/this.pixelsPerMeter):h.collider.type==="capsule"?E=vi.ColliderDesc.capsule((h.collider.height/2-h.collider.radius)/this.pixelsPerMeter,h.collider.radius/this.pixelsPerMeter):E=vi.ColliderDesc.cuboid(h.collider.width/this.pixelsPerMeter/2,h.collider.height/this.pixelsPerMeter/2,h.collider.depth/this.pixelsPerMeter/2),E.setFrictionCombineRule(vi.CoefficientCombineRule.Average).setRestitutionCombineRule(vi.CoefficientCombineRule.Average).setDensity(c.physics.density).setFriction(c.physics.friction).setRestitution(c.physics.restitution);let M=this.sharedGameControlGlobals.rapierWorld.createCollider(E,A);this.sharedGameControlGlobals.colliderToEntity.set(M.handle,l),rr.fromArray(h.collider.position).multiply(Qh.setFromMatrixScale(l.matrixWorld)).divideScalar(this.pixelsPerMeter),M.setTranslationWrtParent(rr);let T=new Zt().setFromEuler(new Nr().setFromVector3(new L().fromArray(h.collider.rotation)));M.setRotationWrtParent(T),M.setActiveEvents(vi.ActiveEvents.COLLISION_EVENTS),this.generateSensorColliderDescs(l,!0)}else c.physics.rigidBody==="dynamic"||u||m||f||p||d?(this.addRigidBody(a,l,{hasFollow:m,hasTransformAnim:u,hasDrag:p}),this.generateSensorColliderDescs(l,c.physics.fusedBody)):(v&&t.push(Gu(v,a.matrixWorld)),c.physics.fusedBody&&a.traverseObject((S,A)=>{var P;if(A===0)return;let E;if(S instanceof Pl)if(S.objectForSample){if(S.objectForSample.dataPatched.physics.fusedBody)return;E=S.object}else return S.object.dataPatched.physics.fusedBody===!0&&S.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(S instanceof _s)E=S.object;else if(E=S,(P=E.dataPatched.cloner)==null?void 0:P.hideBase)return!0;let M=E.dataPatched;if(M.physics.enabled==="visibility"?!M.visible:!M.physics.enabled)return!0;let T=S.geometry;(T==null?void 0:T.getAttribute("position"))!==void 0&&t.push(Gu(T,S.matrixWorld))}),this.generateSensorColliderDescs(l,c.physics.fusedBody,e));if(((b=c.physics)==null?void 0:b.fusedBody)===!0||h)return!0}),t.length===0)return;let i=Mp(t);i.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter);let n=vi.RigidBodyDesc.fixed(),r=this.sharedGameControlGlobals.rapierWorld.createRigidBody(n),s=vi.ColliderDesc.trimesh(i.getAttribute("position").array,i.getIndex().array).setFrictionCombineRule(vi.CoefficientCombineRule.Multiply).setRestitutionCombineRule(vi.CoefficientCombineRule.Multiply).setFriction(1).setRestitution(1);this.sharedGameControlGlobals.rapierWorld.createCollider(s,r);for(let[a,l]of e){let c=this.sharedGameControlGlobals.rapierWorld.createCollider(a,r);this.sensorToTriggerEvent[c.handle]=l}}updatePositions(){return this.nActiveRigidBodies=0,this.sharedGameControlGlobals.rapierWorld.forEachRigidBody(this.processRigidBody),this.nActiveRigidBodies>0}rebuildBVH(){this.usePhysics?(this.gameControl===null||this.needsCollisionDetection)&&this.initPhysics():(this.page.traverseEntity(t=>{for(let e of t.dataPatched.events)if(e.data.type==="Trigger"&&e.data.disabled!==!0){let i=new _X(e.id,e.data,t,this.page,this.sharedAssets,this.eventManager),n=new $e().compose(Cu.fromArray(e.data.position),Wg.setFromEuler(wX.fromArray(e.data.rotation)),SX);if(e.data.triggerZone==="box"){let r=new Zn;r.min.fromArray(e.data.size).multiplyScalar(-.5),r.max.fromArray(e.data.size).multiplyScalar(.5),this.sharedGameControlGlobals.triggers.push([r,n,t,i])}else this.sharedGameControlGlobals.triggers.push([e.data.radius,n,t,i])}}),this.needsCollisionDetection&&this.initBVH())}disconnectEvents(){this.collisionEvents.forEach(t=>t.disconnect()),this.sharedGameControlGlobals.triggers.forEach(t=>t[3].disconnect()),this.sharedGameControlGlobals.triggers.length=0}deactivate(){var t,e,i,n;this.page.traverse(r=>{let s=r;s.matrixWorldFusedFalse&&(s.matrixWorldFusedFalse=void 0),s.rigidBody&&(s.rigidBody=void 0),s.position0&&(s.position0=void 0),s.rotation0&&(s.rotation0=void 0)}),(t=this.sharedGameControlGlobals.rapierWorld)==null||t.free(),this.sharedGameControlGlobals.rapierWorld=void 0,this.sharedGameControlGlobals.staticMeshBVH=void 0,this.sharedGameControlGlobals.entitiesWithTransformAnim=[],this.disconnectEvents(),(e=this.gameControl)==null||e.reset(),(i=this.gameControl)==null||i.dispose(),this.gameControl=null,this.initializationCounter=-1,this.joysticks.forEach(([r,s])=>{r==null||r.destroy(),s.remove()}),this.joystickToGameControls=[],this.joysticks=[],this.orbitControls&&(this.orbitControls.dispose(),this.orbitControls=void 0),(n=this.navigationMeshWrapper)==null||n.dispose(),this.navigationMeshWrapper=void 0;for(let r of Object.values(this.sharedGameControlGlobals.entityToCollisionEvents))r.forEach(s=>s.disconnect());this.sharedGameControlGlobals.entityToCollisionEvents={},this.page.updateMatrixWorld(!0)}update(t,e,i){var r;let n=!0;if(this.orbitControls!==void 0&&this.orbitControls.needsUpdate&&(n=!this.orbitControls.update()),this.initializationCounter>=0&&this.initializationCounter<2?(this.initializationCounter++,n=!1):this.initializationCounter===2&&this.gameControl&&(n=!this.gameControl.update(t,e,i)&&n),this.usePhysics){for(let s of this.sharedGameControlGlobals.entitiesWithTransformAnim){(s.hasNonUniformScale?s.matrixWorldRigid:s.matrixWorld).decompose(rr,xl,Qh),lI.setFromQuaternion(xl);let o=s;o.prevR===void 0?(o.prevR=lI.clone(),o.prevT=rr.clone()):(o.prevR.copy(lI),o.prevT.copy(rr)),s.rigidBody.setNextKinematicTranslation(rr.divideScalar(this.pixelsPerMeter)),s.rigidBody.setNextKinematicRotation(xl)}this.sharedGameControlGlobals.rapierWorld.step(this.events),(r=this.events)==null||r.drainCollisionEvents(this.handleCollisionEvents),n=!this.updatePositions()&&n}return n}dispatchCollisionEvent(t,e,i){var s;let n=((s=this.sharedGameControlGlobals.rapierWorld)==null?void 0:s.getCollider(i))._parent,r;if(e.cloner){for(let o of e.cloner.children)if(o.rigidBody===n){r=o;break}}t.dispatch(r),e.dispatchEvent(mF)}updateUseWindowEvents(t){var e;(e=this.orbitControls)==null||e.updateUseWindowEvents(t)}generateSensorColliderDescs(t,e,i){let n=I6e.copy(t.matrixWorld).invert();t.traverseEntity((r,s)=>{if(e===!1&&s===1)return!0;for(let o of r.dataPatched.events)if(o.data.type==="Trigger"&&o.data.disabled!==!0){let a=new _X(o.id,o.data,r,this.page,this.sharedAssets,this.eventManager),l;if(o.data.triggerZone==="box"?l=vi.ColliderDesc.cuboid(...o.data.size.map(c=>c/(2*this.pixelsPerMeter))):l=vi.ColliderDesc.ball(o.data.radius/this.pixelsPerMeter),l.setDensity(0).setSensor(!0).setActiveEvents(vi.ActiveEvents.COLLISION_EVENTS),Cu.fromArray(o.data.position),Wg.setFromEuler(wX.fromArray(o.data.rotation)),cI.compose(Cu,Wg,SX).premultiply(r.matrixWorld),i?(cI.decompose(Cu,Wg,bX),l.setActiveCollisionTypes(vi.ActiveCollisionTypes.KINEMATIC_FIXED|vi.ActiveCollisionTypes.DYNAMIC_FIXED)):(cI.premultiply(n).decompose(Cu,Wg,bX),t.rigidBody.bodyType()===vi.RigidBodyType.Dynamic||(t.rigidBody.bodyType()===vi.RigidBodyType.Fixed?l.setActiveCollisionTypes(vi.ActiveCollisionTypes.KINEMATIC_FIXED|vi.ActiveCollisionTypes.DYNAMIC_FIXED):l.setActiveCollisionTypes(vi.ActiveCollisionTypes.KINEMATIC_KINEMATIC|vi.ActiveCollisionTypes.DYNAMIC_KINEMATIC))),Cu.divideScalar(this.pixelsPerMeter),l.setTranslation(Cu.x,Cu.y,Cu.z),l.setRotation(Wg),i)i.push([l,a]);else{let c=this.sharedGameControlGlobals.rapierWorld.createCollider(l,t.rigidBody);this.sensorToTriggerEvent[c.handle]=a}}})}};function N6e(t){let e=this._clip.duration,i=this._clip.start??0,n=this.loop,r=this.time+t,s=this._loopCount,o=n===sk;if(t===0)return s===-1?r:o&&(s&1)===1?e-(r-i):r;if(n===vee){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=e)r=e;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(s===-1&&(t>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=e||r<i){let a=Math.floor((r-i)/(e-i));r-=(e-i)*a,s+=Math.abs(a);let l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,o||(r=t>0?e:i,this.repetitions===1&&(r=e)),this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(l===1){let c=t<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return e-(r-i)}return r}var AX=!1,U6e=class{constructor(t,e,i,n){this.scene=t,this.requestRender=e,this.updateDisplayProgress=i,this.animationInspectorState=n,this.clipIdToAction={},this.activeClip=null,this.needsUpdate=!1,this.addClip=r=>{r.data.type==="Empty"&&r.data.animations&&r.data.animations.forEach((s,o)=>{let a=s[0]+"/";if(Array.isArray(r.identity)?a+=r.identity[0]:a+=r.uuid,this.clipIdToAction[a])return;let l=jB.parse(JSON.parse(s[2]));r.animations[o]=l;let c=this.mixer.clipAction(l,r);AX===!1&&(Object.getPrototypeOf(c)._updateTime=N6e,AX=!0),c.clampWhenFinished=!0,this.clipIdToAction[a]=c})},this.mixer=new HPe(t),this.scene.traverseEntity(this.addClip)}deleteClip(t,e){let i=this.scene.find(e);if(!i)return;let n=i.animations.find(s=>s.uuid===t);if(!n)return;let r=this.clipIdToAction[t];!r||(r.stop(),this.mixer.uncacheClip(n),delete this.clipIdToAction[t],i.animations=i.animations.filter(s=>s.uuid!==t))}get isPlaying(){return Object.values(this.clipIdToAction).some(t=>t.isRunning())}playFromInspector(t){this.mixer.stopAllAction();let e=this.clipIdToAction[t];!e||(e.play(),this.activeClip=e.getClip(),this.requestRender())}onExitPlayMode(){Object.values(this.clipIdToAction).forEach(t=>{t.repetitions=1/0,t.loop=yee}),this.mixer.stopAllAction(),this.requestRender()}play(t){let e=t.clipId+"/"+t.object,i=this.clipIdToAction[e];if(i)return t&&(t.repeat>=0&&(i.repetitions=t.repeat+1),t.direction==="pingpong"&&t.repeat!==0&&(i.loop=sk)),i.play(),i.paused=!1,this.requestRender(),i}resumeFromInspector(t){let e=this.clipIdToAction[t];!e||(e.play(),e.paused=!1,this.requestRender())}pauseFromInspector(t){let e=this.clipIdToAction[t];!e||(e.paused=!0)}stop(){this.mixer.stopAllAction(),this.requestRender()}update(t){var e;if(this.needsUpdate)this.needsUpdate=!1;else if(this.isPlaying===!1||(e=this.animationInspectorState)!=null&&e.isScrubbing)return;this.mixer.update(t/1e3),this.activeClip&&this.updateDisplayProgress(Math.round(this.mixer.time/this.activeClip.duration*this.maxFrames%this.maxFrames)),this.requestRender()}get maxFrames(){var t,e;return((e=(t=this.activeClip)==null?void 0:t.tracks[0])==null?void 0:e.times.length)??0}setProgressFromInspector(t,e){if(!this.clipIdToAction[e])return;this.activeClip!==this.clipIdToAction[e].getClip()&&this.playFromInspector(e);let i=this.clipIdToAction[e].paused;this.clipIdToAction[e].paused=!1,this.mixer.setTime(Math.min(this.maxFrames?t/this.maxFrames:0,.9999)*this.activeClip.duration),this.requestRender(),i&&(this.clipIdToAction[e].paused=!0)}},uI=new WeakMap,k6e=class extends xk{constructor(t){super(t),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(t){return this.decoderPath=t,this}setDecoderConfig(t){return this.decoderConfig=t,this}setWorkerLimit(t){return this.workerLimit=t,this}load(t,e,i,n){let r=new WB(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(t,s=>{this.decodeDracoFile(s,e).catch(n)},i,n)}decodeDracoFile(t,e,i,n){let r={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!i};return this.decodeGeometry(t,r).then(e)}decodeGeometry(t,e){let i=JSON.stringify(e);if(uI.has(t)){let a=uI.get(t);if(a.key===i)return a.promise;if(t.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let n,r=this.workerNextTaskID++,s=t.byteLength,o=this._getWorker(r,s).then(a=>(n=a,new Promise((l,c)=>{n._callbacks[r]={resolve:l,reject:c},n.postMessage({type:"decode",id:r,taskConfig:e,buffer:t},[t])}))).then(a=>this._createGeometry(a.geometry));return o.catch(()=>!0).then(()=>{n&&r&&this._releaseTask(n,r)}),uI.set(t,{key:i,promise:o}),o}_createGeometry(t){let e=new Ut;t.index&&e.setIndex(new Gt(t.index.array,1));for(let i=0;i<t.attributes.length;i++){let n=t.attributes[i],r=n.name,s=n.array,o=n.itemSize;e.setAttribute(r,new Gt(s,o))}return e}_loadLibrary(t,e){let i=new WB(this.manager);return i.setPath(this.decoderPath),i.setResponseType(e),i.setWithCredentials(this.withCredentials),new Promise((n,r)=>{i.load(t,n,void 0,r)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let t=typeof WebAssembly!="object"||this.decoderConfig.type==="js",e=[];return t?e.push(this._loadLibrary("draco_decoder.js","text")):(e.push(this._loadLibrary("draco_wasm_wrapper.js","text")),e.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(e).then(i=>{let n=i[0];t||(this.decoderConfig.wasmBinary=i[1]);let r=z6e.toString(),s=["/* draco decoder */",n,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(t,e){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let n=new Worker(this.workerSourceURL);n._callbacks={},n._taskCosts={},n._taskLoad=0,n.postMessage({type:"init",decoderConfig:this.decoderConfig}),n.onmessage=function(r){let s=r.data;switch(s.type){case"decode":n._callbacks[s.id].resolve(s);break;case"error":n._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(n)}else this.workerPool.sort(function(n,r){return n._taskLoad>r._taskLoad?-1:1});let i=this.workerPool[this.workerPool.length-1];return i._taskCosts[t]=e,i._taskLoad+=e,i})}_releaseTask(t,e){t._taskLoad-=t._taskCosts[e],delete t._callbacks[e],delete t._taskCosts[e]}debug(){console.log("Task load: ",this.workerPool.map(t=>t._taskLoad))}dispose(){for(let t=0;t<this.workerPool.length;++t)this.workerPool[t].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}};function z6e(){let t,e;onmessage=function(o){let a=o.data;switch(a.type){case"init":t=a.decoderConfig,e=new Promise(function(h){t.onModuleLoaded=function(u){h({draco:u})},DracoDecoderModule(t)});break;case"decode":let l=a.buffer,c=a.taskConfig;e.then(h=>{let u=h.draco,d=new u.Decoder,f=new u.DecoderBuffer;f.Init(new Int8Array(l),l.byteLength);try{let p=i(u,d,f,c),m=p.attributes.map(v=>v.array.buffer);p.index&&m.push(p.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:p},m)}catch(p){console.error(p),self.postMessage({type:"error",id:a.id,error:p.message})}finally{u.destroy(f),u.destroy(d)}});break}};function i(o,a,l,c){let h=c.attributeIDs,u=c.attributeTypes,d,f,p=a.GetEncodedGeometryType(l);if(p===o.TRIANGULAR_MESH)d=new o.Mesh,f=a.DecodeBufferToMesh(l,d);else if(p===o.POINT_CLOUD)d=new o.PointCloud,f=a.DecodeBufferToPointCloud(l,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!f.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());let m={index:null,attributes:[]};for(let v in h){let g=self[u[v]],y,x;if(c.useUniqueIDs)x=h[v],y=a.GetAttributeByUniqueId(d,x);else{if(x=a.GetAttributeId(d,o[h[v]]),x===-1)continue;y=a.GetAttribute(d,x)}m.attributes.push(r(o,a,d,v,g,y))}return p===o.TRIANGULAR_MESH&&(m.index=n(o,a,d)),o.destroy(d),m}function n(o,a,l){let c=l.num_faces()*3,h=c*4,u=o._malloc(h);a.GetTrianglesUInt32Array(l,h,u);let d=new Uint32Array(o.HEAPF32.buffer,u,c).slice();return o._free(u),{array:d,itemSize:1}}function r(o,a,l,c,h,u){let d=u.num_components(),f=l.num_points()*d,p=f*h.BYTES_PER_ELEMENT,m=s(o,h),v=o._malloc(p);a.GetAttributeDataArrayForAllPoints(l,u,m,p,v);let g=new h(o.HEAPF32.buffer,v,f).slice();return o._free(v),{name:c,array:g,itemSize:d}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}var _d;function G6e(){return _d||(_d=new k6e,_d.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload()),_d.decoderPending}async function H6e(t){if(_d){let e={attributeIDs:_d.defaultAttributeIDs,attributeTypes:_d.defaultAttributeTypes,useUniqueIDs:!1},i;try{i=await _d.decodeGeometry(new Int8Array(t).buffer,e)}catch(n){console.error(n)}if(i)return{index:i.index?{array:i.index.array}:void 0,attributes:Object.entries(i.attributes).map(([n,r])=>({name:n,itemSize:r.itemSize,array:r.array}))}}return null}async function V6e(t,e){let[i,n]=Kte(oO.deserialize(new Uint8Array(t)));BUe(i);let r=[];i.scene.objects.traverse((s,o)=>{o.type==="Mesh"&&o.geometry.type==="NonParametricGeometry"&&o.geometry.data.draco!==void 0&&r.push(o)}),r.length&&await G6e();for(let s of r){let o=await H6e(Hr(s.geometry.data.draco));if(o){o.index&&(s.geometry.data.index={array:o.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let a={};o.attributes.forEach(({name:l,array:c,itemSize:h})=>{a[l]={array:c,itemSize:h,type:"Float32Array",normalized:!1}}),s.geometry.data.attributes=a,s.geometry.data.draco=void 0}}return e&&e(i),n.result().data}var MX=Object.keys(Cre).filter(t=>isNaN(Number(t))),j6e=class{constructor(t,e,i,n){this.publish=t,this.controlsManager=e,this.animationControls=i,this.eventContext=n,this.isEnable=!1,this._isPaused=!1,this.activateCount=0,this.onResetRaycaster=()=>{this.eventContext.raycasterNeedsUpdate=!0},this.onTouchMovePreventScroll=r=>{(r.touches.length>1||this.preventTouchScroll)&&r.preventDefault()},this.onMouseWheelPreventScroll=r=>{this.preventScroll&&r.preventDefault()},this.stopRaycast=t.stopRaycast,this.preventScroll=t.preventScroll,this.preventTouchScroll=t.preventTouchScroll,this.hideCursor=t.hideCursor,this.requestRender=n.requestRender}activate(){if(this.handlers={Spline:new Oje(this.eventContext),Conditional:new Hje(this.eventContext,this),Start:new h6e(this.eventContext,this),Basic:new Nje(this.eventContext,this),MouseHover:new o6e(this.eventContext,this),Scroll:new c6e(this.eventContext,this),Follow:new Zje(this.eventContext,this),DragDrop:new qje(this.eventContext,this),LookAt:new n6e(this.eventContext)},this.isPaused)return;let{page:t,domElement:e,eventElement:i}=this.eventContext;this.hideCursor&&(e.style.cursor="none"),this.isEnable=!0,t.traverseEntity(n=>{n.addEventListener("requestRender",this.requestRender)}),Object.values(this.handlers).forEach(n=>n.connect()),MX.forEach(n=>{(Object.values(this.handlers).some(r=>r.domEventsNeeded.has(n))||n==="pointerdown"&&this.controlsManager.navigationMeshWrapper)&&(e.addEventListener(n,this.onResetRaycaster),i.addEventListener(n,this.onResetRaycaster))}),e.addEventListener("wheel",this.onMouseWheelPreventScroll),e.addEventListener("touchmove",this.onTouchMovePreventScroll),this.activateCount++}deactivate(){var i;let{page:t,domElement:e}=this.eventContext;this.isEnable=!1,e.style.cursor="",Object.values(this.handlers).forEach(n=>n.disconnect()),(i=this.controlsManager.gameControl)==null||i.disposeActions(),this.controlsManager.disconnectEvents(),t.traverseEntity(n=>{n.removeEventListener("requestRender",this.requestRender)}),MX.forEach(n=>{e.removeEventListener(n,this.onResetRaycaster)}),e.removeEventListener("touchmove",this.onTouchMovePreventScroll),e.removeEventListener("wheel",this.onMouseWheelPreventScroll),this.animationControls.onExitPlayMode()}get isPaused(){return this._isPaused}pause(){this._isPaused=!0,this.deactivate()}resume(){this._isPaused=!1,this.activate()}reset(){this.deactivate(),this.activate(),this.controlsManager.page.updateMatrixWorld(!0),this.controlsManager.rebuildBVH()}updateUseWindowEvents(t){let e=this.isEnable;e&&this.deactivate(),this.eventContext.useWindowEvents=t,e&&this.activate()}},W6e=class{constructor(t,e,i,n,r){this._aspect=1,this.enableResponsive=!1,this._renderer=t,this._camera=e,this._frameSize=new he().copy(i),this._editorSize=new he().copy(n),this._aspect=e.aspect,this._fov=r??e.fov}set frameSize(t){this._frameSize.copy(t)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y)}updateViewport(){if(!this._renderer||!this._camera||this._camera.cameraType!=="PerspectiveCamera")return;let t=this._frameSize.x,e=this._frameSize.y,i=this._editorSize.y;this._aspect=t/e,e<=i&&(this._camera.zoom*=i/e),this._renderer.setViewport(0,0,t,e)}updateCamera(){if(this._camera)if(this._camera.cameraType==="PerspectiveCamera"){let t=this._frameSize.y,e=this._editorSize.y,i=this._fov;if(t>e){let n=X6e(t,1080,2160,1,15)/100;i*=t/e,i*=1-n}this._camera.aspect=this._aspect,this._camera.fov=i,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y,this.enableResponsive)}setCamera(t){this._camera=t,this._aspect=t.aspect,this._fov=t.fov}revert(){let t=window.innerWidth,e=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,t,e),this._renderer.setSize(t,e)),this._camera&&(this._camera.aspect=t/e,this._camera.fov=this._fov,this._camera.setViewplaneSize(t,e,this.enableResponsive),this._camera.updateProjectionMatrix())}};function X6e(t,e,i,n,r){return(t-e)/(i-e)*(r-n)+n}var q6e=class{get sharedAssets(){return this.shared}constructor(t,e={}){this.shared=new dz(t.shared,e),this.scene=new wz(t.scene,this.sharedAssets)}reset(t,e){this.scene.clearScene(),this.sharedAssets.reset(t.shared),this.scene.resetAfterClear(t.scene,this.sharedAssets)}resetPersonalCameraFromDocumentData(){for(let t of this.scene.children)t instanceof Vd&&t.personalCamera.updateState(t.data.camera,{scene:this.scene,shared:this.shared})}dispose(){this.scene.dispose(),this.shared.dispose()}gc(){this.shared.geometryCache.startGc(),this.shared.geometryCache2.startGc(),this.scene.traverseEntity(t=>{t instanceof bo&&t.markGeometryAsReachable(this.shared)}),this.shared.geometryCache.endGc(),this.shared.geometryCache2.endGc()}},Y6e=class{constructor({x:t=10,y:e=10}){this._startTime=0;let i=document.getElementById("spe-perfs");i?this.element=i:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left=`${t}px`,this.element.style.top=`${e}px`}dispose(){var t;(t=this.element.parentElement)==null||t.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let t=performance.now()-this._startTime;this.element.innerHTML=t.toFixed(3)+" ms"}};function Q6e(t){let e;if(t.index)for(let i=0;i<t.index.array.length;i+=3)e=t.index.array[i],t.index.array[i]=t.index.array[i+2],t.index.array[i+2]=e}function Z1(t){return t instanceof iw?"SubdivObject":t.geometry.type==="NonParametricGeometry"?"NonParametric":"Mesh"}function K6e(t,e){let i={};return t.traverseEntity(n=>{var l;if(!n.visible||!(n instanceof Mo)||n.type!=="Mesh"||Array.isArray(n.material)||n.states&&Object.keys(n.states).length)return;let r=n.parent;for(;r;){if(r instanceof Mo&&n.states&&Object.keys(n.states).length)return;r=r.parent}let s=n.material.uuid,o=e.shared.materials[s];if(o){if(!ea.isMergable(o))return}else{let c=(l=e.scene.objects.get(n.uuid))==null?void 0:l.data;if(c&&"material"in c&&typeof c.material!="string"){if(!ea.isMergable(c.material))return;s=ea.getHash(c.material)}}i[s]||(i[s]={});let a=i[s][Z1(n)];if(a){if(a.push(n),n.cloner)for(let c of n.cloner.children)a.push(c)}else if(i[s][Z1(n)]=[n],n.cloner)for(let c of n.cloner.children)i[s][Z1(n)].push(c)}),i}function J6e(t){let e=0;return Object.values(t).forEach(i=>{Object.values(i).forEach(n=>{let r=n.length;r>e&&(e=r)})}),e}function Z6e(t,e){let i=K6e(e,t),n=J6e(i),r=new Array(n),s=0,o=new Array(n),a=0,l=new Array(n),c=0,h=new Array(n),u=0;for(let[d,f]of Object.entries(i))for(let p of Object.values(f)){if(a=0,c=0,p.forEach(v=>{v instanceof Mo&&(o[a++]=v.geometry.clone(),l[c++]=v)}),c<2)continue;for(let v=0;v<c;v++)l[v].updateWorldMatrix(!0,!1),o[v].applyMatrix4(l[v].matrixWorld),l[v].matrixWorld.determinant()<0&&Q6e(o[v]);let m=Mp(o.slice(0,a),!1);if(m){let v;switch(d){case"SubdivObject":{console.warn("Turning subdiv object into mesh"),v=new co(m,l[0].material);break}default:{v=new co(m,l[0].material);break}}v.castShadow=l[0].castShadow,v.receiveShadow=l[0].receiveShadow,e.add(v);let g=y=>{u=0;for(let x of y)x.children&&g(x.children),x instanceof Mo&&(Array.isArray(x.material)||i[x.material.uuid]&&i[x.material.uuid][Z1(x)]&&i[x.material.uuid][Z1(x)].length>1||(h[u++]=x));for(let x=0;x<u;x++)e.attach(h[x])};for(let y=0;y<c;y++){let x=l[y];g(x.children),r[s++]=x}}}for(let d=0;d<s;d++)r[d].removeFromParent()}var $6e=Rw(PSe(),1),eWe=new he;function tWe(t){let e="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.";t.endsWith(".spline")?console.warn(e+" The .spline files are only meant to be used by the Editor."):t.endsWith(".splinecode")||console.warn(e)}var iWe=class{constructor(t,{renderOnDemand:e,renderMode:i="auto"}={}){this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._isPaused=!1,this._renderRequested=!1,this._skipRender=!1,this._lastTime=performance.now(),this.time=performance.now(),this.dt=0,this.currentTAAFrame=0,this.disposed=!1,this._requestRenderAutoMode=()=>{this._skipRender=!1},this.requestRender=()=>{this._renderRequested=!0},this.render=n=>{var r,s,o,a,l,c,h,u,d,f,p;if(this.time=n,this.dt=this.time-this._lastTime,this._lastTime=this.time,(r=this._perfs)==null||r.start(),!this._renderer){(s=this._perfs)==null||s.end();return}if(!this._isPaused&&(this.renderMode==="manual"&&!this._renderRequested||this.renderMode==="auto"&&this._skipRender)){(o=this._perfs)==null||o.end();return}if(this._renderRequested=!1,this._skipRender=!0,this._controls&&(this._skipRender=this._controls.update(this.dt)),this._eventManager&&((a=this._eventManager.handlers)!=null&&a.Start.hasVideoAction||(l=this._eventManager.handlers)!=null&&l.Basic.hasVideoAction||(c=this._eventManager.handlers)!=null&&c.Conditional.hasVideoAction)&&(this._skipRender=!1),(h=this._animationControls)==null||h.update(this.dt),this._skipRender?(this.currentTAAFrame++,this.currentTAAFrame<32?this._skipRender=!1:this.currentTAAFrame=0):this.currentTAAFrame=0,this._scene&&this._scene.activeCamera!==this._camera&&(this._camera=this._scene.activeCamera),this._eventManager&&(this._eventManager.isEnable||this._eventManager.activate(),((u=this._eventManager.handlers)==null?void 0:u.Follow).onAnimationFrameDamping(),((d=this._eventManager.handlers)==null?void 0:d.LookAt).onAnimationFrameDamping(),((f=this._eventManager.handlers)==null?void 0:f.DragDrop).onAnimationFrameDamping()),this._scene&&this._camera){if(this._scene.pathConstraints.applyConstraints(this._scene),this._renderer.sceneTransitionTimeRemaining>0){this._renderer.sceneTransitionTimeRemaining-=this.dt;let m=1-this._renderer.sceneTransitionTimeRemaining/this._renderer.sceneTransitionDuration;this._renderer.pipeline.sceneTransitionPass.uniforms.mixRatio.value=m,this._skipRender=!1}else this._renderer.pipeline.sceneTransitionFromTexture=null;this._renderer.renderSplineScene(this._scene,this._camera)}this.canvas.dispatchEvent(this._renderedEvent),(p=this._perfs)==null||p.end()},this._resize=()=>{var n,r,s;!this._renderer||(this._viewportMode===1&&this._frameView&&(this._frameView.frameSize=eWe.set(this._viewportWidth,this._viewportHeight)),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._camera=(n=this._scene)==null?void 0:n.activeCamera,this._camera&&((r=this._frameView)==null||r.setCamera(this._camera),(s=this._frameView)==null||s.updateCamera(),this._camera.cameraType==="PerspectiveCamera"&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()),this._requestRenderAutoMode())},this._debouncedResize=zk(this._resize,10),this.canvas=t,this.renderMode=e?"auto":i,this._renderedEvent=new CustomEvent("rendered",{bubbles:!0}),Object.defineProperty(this._renderedEvent,"target",{writable:!1,value:this}),window.location.search.includes("perfs")&&(this._perfs=new Y6e({x:10,y:10})),yNe(t)}async load(t,e){tWe(t),this.disposed=!1;let i=await(await fetch(t,e)).arrayBuffer();await this.start(i)}async start(t,{interactive:e=!0}={}){var s,o,a;if(this.disposed)return;let i=await V6e(t);this._data=i,i.version&&(0,$6e.default)(i.version,"0.9.405")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/runtime to the latest version."),await Promise.all([y7(i)&&Lze(),eGe(i)&&Dze(),J_.physicsEnabled(i.scene.objects)&&SNe(),p7(i)&&G4e(),S6e(i)&&wNe()].filter(Boolean)),(s=this._eventManager)==null||s.deactivate(),(o=this._controls)==null||o.deactivate(),(a=this._scene)==null||a.dispose();let n=new q6e(i);if(n.resetPersonalCameraFromDocumentData(),this._scene=n.scene,this._sharedAssetsManager=n.sharedAssets,this._camera=this._scene.activeCamera,window.location.search.includes("merge-geometries")){let l=performance.now();Z6e(i,n.scene);let c=performance.now();console.log("Merged geometries in ",c-l," ms")}y7(i)&&this._scene.traverse(l=>{Ju(l)&&l.recomputeBoolean()}),this._sharedAssetsManager.setRequestRender(()=>{var l;this._requestRenderAutoMode(),(l=this._scene)==null||l.traverse(c=>{c instanceof Pl&&c.pendingMediaLoad&&c.update()})});let r=Object.keys(i.shared.fonts).map(l=>this._sharedAssetsManager.getFont(l).loadingPromise);if(Promise.all(r).then(()=>{n.scene.markNeedsUpdateRendererDirty(),this._requestRenderAutoMode()}),p7(i)&&O6e(i)&&await Promise.all(r),this._scene.rewriteEventsBeforeGoToPlayMode(),Lz(this._scene.activePage,this._sharedAssetsManager),this._renderer||(this._renderer=new P5e({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._renderer.hdTransmission=i.scene.publish.hdTransmission===!0,this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.pipeline.addEventListener("smaaloaded",this._requestRenderAutoMode)),i.scene.blueNoiseTextureData!==void 0&&this._renderer.pipeline.updateBlueNoiseTexture(i.scene.blueNoiseTextureData),this._frameView)this._frameView.setCamera(this._camera);else{let l=Object.values(i.frames)[0];l.preset==="fullscreen"?(this._viewportMode=1,this.canvas.style.display="block",this.canvas.parentElement&&(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%"),this.canvas.parentElement&&(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%")):(this._viewportMode=2,this._viewportWidth=l.size[0],this._viewportHeight=l.size[1],this.canvas.style.width=`${this._viewportWidth}px`,this.canvas.style.height=`${this._viewportHeight}px`),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._frameView=new W6e(this._renderer,this._camera,new he(this._viewportWidth,this._viewportHeight),new he(window.innerWidth,window.innerHeight)),this._frameView.enableResponsive=(l.allowResponsive??!1)&&l.preset==="fullscreen"}if(e){let l=new Lje(this._renderer,this.data.scene.publish,this._scene,()=>this._scene.activeCamera,this._sharedAssetsManager,this._requestRenderAutoMode,!0);this._scene.updateMatrixWorld(!0),this._controls=new F6e(l),this._animationControls=new U6e(this._scene,this._requestRenderAutoMode),this._eventManager=new j6e(i.scene.publish,this._controls,this._animationControls,l),this._controls.activate(this._eventManager)}this._resize(),this.dt===0&&(this.render(performance.now()),this._renderer.setAnimationLoop(this.render)),this._resizeObserverTimeout=setTimeout(()=>{!this._resizeObserver&&this.canvas.parentElement&&(this._resizeObserver=new ResizeObserver(()=>{this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this._debouncedResize()}),this._resizeObserver.observe(this.canvas.parentElement))},300)}findObjectById(t){var i;let e=(i=this._scene)==null?void 0:i.getObjectByProperty("uuid",t);return this._createProxyObject(e)}findObjectByName(t){var i;let e=(i=this._scene)==null?void 0:i.getObjectByName(t);return this._createProxyObject(e)}getAllObjects(){var e;let t=[];return(e=this._scene)==null||e.traverseEntity(i=>{if(i.uuid!==_y&&!(i instanceof Vd)){let n=this._createProxyObject(i);n&&t.push(n)}}),t}getSplineEvents(){var t;return((t=this._eventManager)==null?void 0:t.handlers.Spline).splineEvents}emitEvent(t,e){var i;(i=this.findObjectById(e)||this.findObjectByName(e))==null||i.emitEvent(t)}emitEventReverse(t,e){var i;(i=this.findObjectById(e)||this.findObjectByName(e))==null||i.emitEventReverse(t)}addEventListener(t,e){this.canvas.addEventListener(t,e)}removeEventListener(t,e){this.canvas.removeEventListener(t,e)}setZoom(t){var e,i;((e=this._controls)==null?void 0:e.orbitControls)instanceof Ire&&((i=this._controls)==null||i.orbitControls.zoomOut(t))}get eventManager(){return this._eventManager}get controls(){return this._controls}setSize(t,e){this._viewportWidth=t,this._viewportHeight=e,this._viewportMode=2,this._resize()}setBackgroundColor(t){var o;let{r:e,g:i,b:n,a:r}={r:0,g:0,b:0,a:1},s=new wo(e,i,n,r);try{s.setStyle(t)}catch{console.error("This is not a valid css color",t)}(o=this._scene)==null||o.activePage.setBackgroundColor(s),this._requestRenderAutoMode()}dispose(){var t,e,i,n,r,s,o;this.disposed=!0,(t=this._eventManager)==null||t.deactivate(),(e=this._scene)==null||e.dispose(),(i=this._sharedAssetsManager)==null||i.dispose(),this._proxyObjectCache.forEach(a=>{KW.unsubscribe(a)}),(n=this._renderer)==null||n.setAnimationLoop(null),(r=this._renderer)==null||r.dispose(),this._renderer=void 0,(s=this._sharedAssetsManager)==null||s.dispose(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0),this._resizeObserverTimeout!==void 0&&clearTimeout(this._resizeObserverTimeout),this.canvas.style.width="",this.canvas.style.height="",this.canvas.removeAttribute("width"),this.canvas.removeAttribute("height"),this._frameView&&(this._frameView=void 0),(o=this._controls)==null||o.deactivate(),xNe(this.canvas)}get isStopped(){return this._isPaused}stop(){var t,e,i;this._isPaused||((t=this._renderer)==null||t.setAnimationLoop(null),this._isPaused=!0,(e=this._eventManager)==null||e.pause(),(i=this._controls)!=null&&i.orbitControls&&(this._controls.orbitControls.enabled=!1))}play(){var t,e,i;!this._isPaused||(this._isPaused=!1,(t=this._eventManager)==null||t.resume(),(e=this._controls)!=null&&e.orbitControls&&(this._controls.orbitControls.enabled=!0),(i=this._renderer)==null||i.setAnimationLoop(this.render))}setGlobalEvents(t){var e;(e=this._eventManager)==null||e.updateUseWindowEvents(t)}get data(){return this._data}_createProxyObject(t){var r;if(t==null)return;if(this._proxyObjectCache.has(t.uuid))return this._proxyObjectCache.get(t.uuid);let e;t.traverseAncestors(s=>{s instanceof Vd&&(e=s.name)});let i={name:t.name,uuid:t.uuid,visible:t.visible,intensity:t.intensity,position:t.position,rotation:t.rotation,scale:t.scale,type:t.data.type,page:e,parentUuid:t.parent instanceof Vd||t instanceof wz||(r=t.parent)==null?void 0:r.uuid,emitEvent(s){t.dispatchEvent({type:"userEvent",eventName:s})},emitEventReverse(s){t.dispatchEvent({type:"userEvent",eventName:s,reverse:!0})}},n=KW(i,(s,o)=>{var a;typeof t[s]!="object"&&((a=Object.getOwnPropertyDescriptor(t,s))!=null&&a.writable)&&(t[s]=o),this._requestRenderAutoMode(),t.updateMatrix()});return this._proxyObjectCache.set(t.uuid,n),n}},hM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},gF={},nWe={get exports(){return gF},set exports(t){gF=t}},qx={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EX;function rWe(){if(EX)return qx;EX=1;var t=Ul,e=Symbol.for("react.element"),i=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,r=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,c){var h,u={},d=null,f=null;c!==void 0&&(d=""+c),l.key!==void 0&&(d=""+l.key),l.ref!==void 0&&(f=l.ref);for(h in l)n.call(l,h)&&!s.hasOwnProperty(h)&&(u[h]=l[h]);if(a&&a.defaultProps)for(h in l=a.defaultProps,l)u[h]===void 0&&(u[h]=l[h]);return{$$typeof:e,type:a,key:d,ref:f,props:u,_owner:r.current}}return qx.Fragment=i,qx.jsx=o,qx.jsxs=o,qx}(function(t){t.exports=rWe()})(nWe);const vF=gF.jsx;var sWe="Expected a function",TX=0/0,oWe="[object Symbol]",aWe=/^\s+|\s+$/g,lWe=/^[-+]0x[0-9a-f]+$/i,cWe=/^0b[01]+$/i,uWe=/^0o[0-7]+$/i,hWe=parseInt,dWe=typeof hM=="object"&&hM&&hM.Object===Object&&hM,fWe=typeof self=="object"&&self&&self.Object===Object&&self,pWe=dWe||fWe||Function("return this")(),mWe=Object.prototype,gWe=mWe.toString,vWe=Math.max,yWe=Math.min,hI=function(){return pWe.Date.now()};function xWe(t,e,i){var n,r,s,o,a,l,c=0,h=!1,u=!1,d=!0;if(typeof t!="function")throw new TypeError(sWe);e=CX(e)||0,yF(i)&&(h=!!i.leading,u="maxWait"in i,s=u?vWe(CX(i.maxWait)||0,e):s,d="trailing"in i?!!i.trailing:d);function f(A){var E=n,M=r;return n=r=void 0,c=A,o=t.apply(M,E),o}function p(A){return c=A,a=setTimeout(g,e),h?f(A):o}function m(A){var E=A-l,M=A-c,T=e-E;return u?yWe(T,s-M):T}function v(A){var E=A-l,M=A-c;return l===void 0||E>=e||E<0||u&&M>=s}function g(){var A=hI();if(v(A))return y(A);a=setTimeout(g,m(A))}function y(A){return a=void 0,d&&n?f(A):(n=r=void 0,o)}function x(){a!==void 0&&clearTimeout(a),c=0,n=l=r=a=void 0}function b(){return a===void 0?o:y(hI())}function S(){var A=hI(),E=v(A);if(n=arguments,r=this,l=A,E){if(a===void 0)return p(l);if(u)return a=setTimeout(g,e),f(l)}return a===void 0&&(a=setTimeout(g,e)),o}return S.cancel=x,S.flush=b,S}function yF(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function _We(t){return!!t&&typeof t=="object"}function wWe(t){return typeof t=="symbol"||_We(t)&&gWe.call(t)==oWe}function CX(t){if(typeof t=="number")return t;if(wWe(t))return TX;if(yF(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=yF(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(aWe,"");var i=cWe.test(t);return i||uWe.test(t)?hWe(t.slice(2),i?2:8):lWe.test(t)?TX:+t}var bWe=xWe;function SWe(t){return e=>{t.forEach(i=>{typeof i=="function"?i(e):i!=null&&(i.current=e)})}}const AWe=[],MWe={width:"100%",height:"100%"},EWe=ye.forwardRef(function({className:t,children:e,debounceTime:i=300,ignoreDimensions:n=AWe,parentSizeStyles:r,enableDebounceLeadingCall:s=!0,resizeObserverPolyfill:o,...a},l){const c=ye.useRef(null),h=ye.useRef(0),[u,d]=ye.useState({width:0,height:0,top:0,left:0}),f=ye.useMemo(()=>{const p=Array.isArray(n)?n:[n];return bWe(m=>{d(v=>Object.keys(v).filter(g=>v[g]!==m[g]).every(g=>p.includes(g))?v:m)},i,{leading:s})},[i,s,n]);return ye.useEffect(()=>{const p=o||window.ResizeObserver,m=new p(v=>{v.forEach(g=>{const{left:y,top:x,width:b,height:S}=(g==null?void 0:g.contentRect)??{};h.current=window.requestAnimationFrame(()=>{f({width:b,height:S,top:x,left:y})})})});return c.current&&m.observe(c.current),()=>{window.cancelAnimationFrame(h.current),m.disconnect(),f.cancel()}},[f,o]),vF("div",{style:{...MWe,...r},ref:SWe([l,c]),className:t,...a,children:e({...u,ref:c.current,resize:f})})});ye.forwardRef(({scene:t,style:e,onMouseDown:i,onMouseUp:n,onMouseHover:r,onKeyDown:s,onKeyUp:o,onStart:a,onLookAt:l,onFollow:c,onWheel:h,onLoad:u,renderOnDemand:d=!0,...f},p)=>{const m=ye.useRef(null),[v,g]=ye.useState(!0);return ye.useEffect(()=>{g(!0);let y;const x=[{name:"mouseDown",cb:i},{name:"mouseUp",cb:n},{name:"mouseHover",cb:r},{name:"keyDown",cb:s},{name:"keyUp",cb:o},{name:"start",cb:a},{name:"lookAt",cb:l},{name:"follow",cb:c},{name:"scroll",cb:h}];if(m.current){y=new iWe(m.current,{renderOnDemand:d});async function b(){await y.load(t);for(let S of x)S.cb&&y.addEventListener(S.name,S.cb);g(!1),u==null||u(y)}b()}return()=>{for(let b of x)b.cb&&y.removeEventListener(b.name,b.cb);y.dispose()}},[t]),vF(EWe,{ref:p,parentSizeStyles:e,debounceTime:50,...f,children:()=>vF("canvas",{ref:m,style:{display:v?"none":"block"}})})});const TWe=()=>rt.jsxs(ale,{children:[rt.jsx("div",{children:rt.jsx(iSe,{})}),rt.jsxs("div",{className:"relative z-0 bg-primary",children:[rt.jsx(vSe,{}),rt.jsx(p_e,{}),rt.jsx(w_e,{})]})]});dI.createRoot(document.getElementById("root")).render(rt.jsx(Ul.StrictMode,{children:rt.jsx(TWe,{})}))});export default CWe();
